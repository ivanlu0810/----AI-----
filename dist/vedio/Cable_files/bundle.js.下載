window.__BUNDLE_SIZE_KB=null,(()=>{var e,t,i={1:(e,t,i)=>{"use strict";i.d(t,{B:()=>a});var r=i(592),n=i(634);const s=["iframe","style","meta","script","link","br","hr"];class a{static createAdWrapperElements(e,t,i,n){const o=a.wrapAdString(n,t.useShadowRoot()),l=function(){let e=o.children;a.shadowRootIsSupported()&&t.useShadowRoot()&&(e=o.querySelector(".tlod").children);return(0,r.I6)(e,c)}();return{adWrapper:function(){let n;e.customOptions.unwrappedUnit?((0,r.pb)(o.children,d).forEach(e=>{l.appendChild(e)}),n=l):n=o;n.setAttribute("plid",e.id),i.templateId&&n.setAttribute("tlid",i.templateId);return(0,r.c3)(t.getParams().additional_data.adid,n),n}(),adWrapperWithDims:l};function c(e){return-1===s.indexOf(a.getTagNameLower(e))}function d(e){return"script"===a.getTagNameLower(e)}}static getTagNameLower(e){const t=e&&e.tagName;return t&&t.toLowerCase&&t.toLowerCase()}static shadowRootIsSupported(){return document.head.createShadowRoot||document.head.attachShadow}static wrapAdString(e,t=!1){let i;return a.shadowRootIsSupported()&&t?(i=document.createElement(n.gi),i.adContent=e):(i=document.createElement("div"),i.innerHTML=e,i.style.display="inline",i.className="tlod"),i}}},124:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(705),n=i(201);class s{static listen({eventController:e,errorHandler:t}){this.VAST_CODE_LEVELS||(this.VAST_CODE_LEVELS={[s.VAST_ERROR_XML_PARSING]:t.ERROR,[s.VAST_ERROR_VAST_SCHEMA]:t.ERROR,[s.VAST_TRAFFICKING_ERROR]:t.ERROR,[s.VAST_UNEXPECTED_DURATION_ERROR]:t.WARNING,[s.VAST_WRAPPER_ERROR]:t.ERROR,[s.VAST_WRAPPER_TIMEOUT]:t.ERROR,[s.VAST_TOO_MANY_REDIRECTS]:t.ERROR,[s.VAST_NO_ADS_AFTER_WRAPPER]:t.ERROR,[s.VAST_LINEAR_ERROR]:t.ERROR,[s.VAST_MEDIA_NOT_FOUND]:t.ERROR,[s.VAST_MEDIA_LOAD_TIMEOUT]:t.ERROR,[s.VAST_MEDIA_ASSET_MISMATCH]:t.ERROR,[s.VAST_PROBLEM_DISPLAYING_MEDIA_FILE]:t.ERROR,[s.VAST_UNDEFINED_ERROR]:t.ERROR,[s.VAST_VPAID_ERROR]:t.ERROR}),e.on(n.Io,(e,i={})=>{const r=s.VAST_CODE_MAP[e],n=this.VAST_CODE_LEVELS[e];if(void 0===r)t.fireError({category:"VAST Unknown Error",error:"invalid vast error code",level:t.ERROR});else{const s=r+(i.message?" "+i.message:"");t.fireError({category:"VAST Error",error:e+": "+s,level:n,diagnosticContext:{errorCode:e,...i.diagnosticContext},block:this.ERROR_BLOCK})}})}}(0,r.A)(s,"VAST_ERROR_XML_PARSING",100),(0,r.A)(s,"VAST_ERROR_VAST_SCHEMA",101),(0,r.A)(s,"VAST_TRAFFICKING_ERROR",200),(0,r.A)(s,"VAST_UNEXPECTED_DURATION_ERROR",202),(0,r.A)(s,"VAST_WRAPPER_ERROR",300),(0,r.A)(s,"VAST_WRAPPER_TIMEOUT",301),(0,r.A)(s,"VAST_TOO_MANY_REDIRECTS",302),(0,r.A)(s,"VAST_NO_ADS_AFTER_WRAPPER",303),(0,r.A)(s,"VAST_LINEAR_ERROR",400),(0,r.A)(s,"VAST_MEDIA_NOT_FOUND",401),(0,r.A)(s,"VAST_MEDIA_LOAD_TIMEOUT",402),(0,r.A)(s,"VAST_MEDIA_ASSET_MISMATCH",403),(0,r.A)(s,"VAST_PROBLEM_DISPLAYING_MEDIA_FILE",405),(0,r.A)(s,"VAST_UNDEFINED_ERROR",900),(0,r.A)(s,"VAST_VPAID_ERROR",901),(0,r.A)(s,"ERROR_BLOCK","video"),(0,r.A)(s,"VAST_CODE_MAP",{[s.VAST_ERROR_XML_PARSING]:"XML Parsing error.",[s.VAST_ERROR_VAST_SCHEMA]:"VAST schema validation error.",[s.VAST_TRAFFICKING_ERROR]:"Trafficking error. Media player received an Ad type that it was not expecting and/or cannot play",[s.VAST_UNEXPECTED_DURATION_ERROR]:"Media player expecting different duration.",[s.VAST_WRAPPER_ERROR]:"General Wrapper error.",[s.VAST_WRAPPER_TIMEOUT]:"Timeout of VAST URI provided in Wrapper element, or of VAST URI provided in a subsequent Wrapper element.",[s.VAST_TOO_MANY_REDIRECTS]:"Wrapper limit reached, as defined by the media player. Too many Wrapper responses have been received with no InLine response.",[s.VAST_NO_ADS_AFTER_WRAPPER]:"No VAST response after one or more Wrappers.",[s.VAST_LINEAR_ERROR]:"General Linear error. Media player is unable to display the Linear Ad.",[s.VAST_MEDIA_NOT_FOUND]:"File not found. Unable to find Linear/MediaFile from URI.",[s.VAST_MEDIA_LOAD_TIMEOUT]:"Timeout of MediaFile URI.",[s.VAST_MEDIA_ASSET_MISMATCH]:"Couldn't find MediaFile that is supported by this media player, based on the attributes of the MediaFile element.",[s.VAST_PROBLEM_DISPLAYING_MEDIA_FILE]:"Problem displaying MediaFile. Media player found a MediaFile with supported type but couldn't display it.",[s.VAST_UNDEFINED_ERROR]:"Undefined error.",[s.VAST_VPAID_ERROR]:"General VPAID error."}),(0,r.A)(s,"VAST_CODE_LEVELS",null)},201:(e,t,i)=>{"use strict";i.d(t,{$9:()=>r,$w:()=>p,A2:()=>le,BU:()=>ee,Bj:()=>u,E4:()=>$,FM:()=>x,Gz:()=>he,HF:()=>B,HX:()=>Q,Hz:()=>l,Io:()=>V,JH:()=>D,KG:()=>Z,Kp:()=>_,MX:()=>ie,Mj:()=>z,NK:()=>oe,Ol:()=>A,PW:()=>te,Qc:()=>J,RY:()=>b,Rb:()=>E,SR:()=>j,Wz:()=>c,XR:()=>de,Yk:()=>Y,Yy:()=>G,ZJ:()=>C,Zc:()=>X,_E:()=>N,_J:()=>re,_Z:()=>h,aI:()=>P,c2:()=>K,cC:()=>w,d2:()=>q,de:()=>y,e8:()=>se,fD:()=>v,hV:()=>a,iD:()=>ce,j5:()=>H,jK:()=>m,jY:()=>R,kB:()=>ae,nc:()=>g,oD:()=>n,pt:()=>U,qb:()=>O,te:()=>k,tr:()=>o,u:()=>W,uD:()=>L,uT:()=>S,uc:()=>M,vs:()=>ne,wQ:()=>T,wf:()=>d,xE:()=>I,zK:()=>s,zX:()=>f,ze:()=>F});const r="log",n="mute",s="unmute",a="ended",o="play",l="pause",c="complete",d="playerReady",h="vpaidFallback",u="autoplayFallback",p="triggerFallbacks",m="cancelFallbacks",g="csrReady",f="csrUpdate",v="csrVideoDimsUpdate",_="csrOverlayOffsetUpdate",y="forceCsrUpdate",A="adOnPage",I="clickThrough",w="positionUpdate",E="videoStart",C="firstQuartile",b="midpoint",T="thirdQuartile",S="complete",M="vpaid.AdLog",R="vpaid.AdImpression",P="vpaid.AdPlaying",D="vpaid.AdStarted",x="vpaid.AdVideoComplete",N="vpaid.AdVideoFirstQuartile",L="vpaid.AdVideoMidpoint",O="vpaid.AdVideoStart",k="vpaid.AdVideoThirdQuartile",j="vpaid.AdClickThru",F="playtime_change",V="vastVideoError",H="vpaidBlockedError",B="vpaidNonBlockedError",W="scroll",U="transform",z="transitionEnd",G="goRight",q="goLeft",Y="onTriggerEnter",Z="onTriggerExit",Q="onAdchoicesEnter",X="onAdchoicesExit",J="clickPause",K="clickPlay",$="twoSecondViewable",ee="notViewableTracker",te="trackClick",ie="firstPlay",re="mouseenter",ne="mouseleave",se="auctionResponse",ae="auctionComplete",oe="passthru",le="adExpanded",ce="noRoomForExpansion",de="resizeReady",he="resizeUpdate"},309:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(980);const n={setStyle:s,setStyleProperties:function(e,t){if(!Array.isArray(t))throw new r.A("arg2 of setStyleProperties must be an array");for(let i=0;i<t.length;i++)s(e,t[i][0],t[i][1]);return e},getPropertyValue:function(e,t){return window.getComputedStyle(e).getPropertyValue(t)}};function s(e,t,i){if(!e)throw new r.A("Tried to set style "+t+" to "+i+" on an invalid element.");if(!e.style)throw new r.A("Failed to set styles on "+e.nodeName);e.style.setProperty(t,i,"important")}},329:(e,t,i)=>{"use strict";i.d(t,{$j:()=>m,Er:()=>o,Im:()=>f,Ol:()=>n,Pl:()=>s,Rh:()=>y,Rt:()=>I,V4:()=>E,Z_:()=>r,Zn:()=>g,_d:()=>_,dK:()=>b,dQ:()=>T,f0:()=>c,f6:()=>v,ib:()=>M,lB:()=>p,lC:()=>A,oF:()=>d,oO:()=>a,oc:()=>h,re:()=>S,rk:()=>l,uR:()=>u,wk:()=>w,xw:()=>C});const r="r",n="aop",s="ev",a="evv",o="ev1",l="eev",c="sce",d="pmd",h="pe",u="ctar",p="dr",m="tua",g={DRM_ADVERTISER:1,DRM_PUBLISHER:2,DRM_DEFAULT:3,DRM_NO_MACRO:4},f="tpt",v={TPT_IMPRESSION:1,TPT_VIEWABILITY:2,TPT_NON_VIEWABILITY:3,TPT_UNDETERMINED_VIEWABILITY:4,TPT_JAVASCRIPT:5,TPT_CLICK:6,TPT_MISC:7},_={CT_UNKNOWN:0,CT_NATIVE_OVER_DISPLAY:1,CT_NATIVE_OVER_NATIVE:2,CT_VIDEO:3,CT_BANNER:4,CT_COMPOSITE_VIDEO_OVER_VIDEO:5,CT_COMPONENT_SPOT_OVER_NATIVE:6,CT_PICTURE_IN_PICTURE_OVER_VIDEO:7},y={VDES_FIRE_START:1,VDES_FIRE_COMPLETE:2,VDES_FIRE_QUARTILE:3,VDES_FIRE_INTERVAL:4},A="eee",I="ec",w="em",E="ci",C="vpa",b="evd",T="px",S="tpvpx",M="tl-third-party-slot"},370:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(201),n=i(980),s=i(592),a=i(634);const o=a.hj+"dummy-img",l="REC";const c=function({placement:e,environment:t,creative:i,asyncUtil:c,eventController:d}){let h,u,p,m=!1;return{render:function(o){p=o;const{state:m,domRefs:y}=p;if(m.isBackgroundImage&&(i.formatManager.isImage()||i.formatManager.isCinemagraph()))return void(y.mainImageCsrEl=y.mainImage);const A=y.mainImage;y.mainImageCsrEl||(y.mainImageCsrEl=function(e,r){const n=i.getParams().render_options_bm,o=t.renderOptionsMap,c=i.getParams().template_component_url,d=(0,s.jx)(n,o.gda_iframe),h=(0,s.jx)(n,o.img_tag_csr),u=function(e){return e===l}(c);if(d)return function(){const e=i.getParams().allImages[0].img_frame,t=document.createElement("div");return t.innerHTML=e,t.firstChild}();if(h||u)return function(e,t){const i=document.createElement("div");i.style.setProperty("width",t.imageWidth+"px","important"),i.style.setProperty("height",t.imageHeight+"px","important"),i.style.setProperty("display","flex"),i.style.setProperty("align-items","center"),i.style.setProperty("justify-content","center");const r=document.createElement("img");return r.classList.add(a.hj+"csr-img"),r.setAttribute("src",e),r.style.setProperty("max-width","100%"),r.style.setProperty("max-height","100%"),i.appendChild(r),i}(e,r);return f(e,r)}(A.src,e));if(u=y.mainImageCsrEl,u.classList.add(a.hj+"csr"),h=_(t.tlImageAddr,e.imageWidth,e.imageHeight,A.className,A.id,document),v(h,A.style),!A||!A.parentNode)throw new n.A("render failed: sourceEl element not on dom");A.parentNode.insertBefore(h,A),c.addResizeListener(g),(0,s.en)(u,A),d.on(r.de,g),d.on(r.MX,g)},createMainImageCsrDiv:f};function g(){h&&d.publish(r.zX,function(){if(!m)return{width:0,height:0};h.style.setProperty("display","","important");const e=h.ownerDocument.defaultView,t=e?e.getComputedStyle(h):getComputedStyle(h);!function(e,t){["width","height","float","margin","margin-top","margin-right","margin-bottom","margin-left","max-width","max-height","padding","padding-top","padding-right","padding-bottom","padding-left","border","border-top","border-right","border-bottom","border-left"].forEach(i=>{t[i]&&e.style.setProperty(i,t[i],"important")});""===t.position||"static"===t.position?e.style.setProperty("position","relative","important"):e.style.setProperty("position",t.position,"important")}(u,t);const i=parseFloat(t.width),r=parseFloat(t.height);return h.style.setProperty("display","none","important"),{width:i,height:r}}())}function f(e,t){const r=i.isWhitePillarBoxingColorWhite(i.getParams()),n=document.createElement("div");return n.style.setProperty("width",t.imageWidth+"px","important"),n.style.setProperty("height",t.imageHeight+"px","important"),n.style.setProperty("background-size","contain","important"),n.style.setProperty("background-position","center","important"),n.style.setProperty("background-repeat","no-repeat","important"),n.style.setProperty("background-image","url("+e+")","important"),r&&n.style.setProperty("background-color",a.lm.WHITE),n}function v(e,t={}){let i,r=0;for(;t[r];)i=t[r],e.style.setProperty(i,t[i],"important"),r++}function _(e,t,i,n="",a="",l){const c=l.createElement("img");return c.className=n+" "+o,c.id=a,c.style.setProperty("display","none","important"),p.promises.push(new Promise(e=>{c.onload=()=>{m=!0,d.publish(r.nc),g(),e()}})),c.src=function(e,t,i){return(0,s.sT)("//"+e+"/blank?width="+t+"&height="+i)}(e,t,i),c}}},384:(e,t,i)=>{"use strict";i.d(t,{O:()=>n,R:()=>s});const r=300;function n(e,t,i){let n=!1,s=null;i.listen(e,"mouseenter",function(){n=!0,s=i.timeoutWrap(()=>{n&&t()},r)}),i.listen(e,"mouseleave",function(){clearTimeout(s),n=!1})}function s(e){e&&window.open(e,"_blank")}},388:(e,t,i)=>{"use strict";i.d(t,{An:()=>a,BS:()=>v,HY:()=>d,KH:()=>u,Lj:()=>m,OM:()=>A,U9:()=>y,a8:()=>g,k$:()=>o,lX:()=>p,mR:()=>f,np:()=>l,qr:()=>r,sT:()=>_,t:()=>I,tf:()=>c,vQ:()=>w,w_:()=>s,xR:()=>h,xn:()=>n});const r=23019,n=60003,s=20230703,a=20240498,o=20240718,l=65846956,c=65846957,d=20250120,h=20250114,u=2025030062,p=20250306,m=20250507,g=20250508,f=20250624,v=20250718,_=20250812,y=202508252,A=20250825,I=202508271,w=202508272},389:(e,t,i)=>{"use strict";i.d(t,{A:()=>n,d:()=>r});const r=i(634).hj+"video",n={vpaidZIndex:1e9,nonVpaidZIndex:1,type:{vast:1,vpaid:2}}},432:(e,t,i)=>{"use strict";i.d(t,{A:()=>l,R:()=>o});var r=i(634),n=i(592);const s=r.hj+"img-src-place-holder",a=r.hj+"img-srcset-place-holder",o=r.hj+"cta-macro";class l{constructor(e){this._errorHandler=e,this._templateDetail={string:""},this._chosenTemplate=null,this._templateWrapEl=null,this._templateId=0,this._hasCtaMacro=!1,this._hasIsiMacro=!1}get templateDetail(){return this._templateDetail}get chosenTemplate(){return this._chosenTemplate}get templateWrapEl(){return this._templateWrapEl}get templateId(){return this._templateId}get hasCtaMacro(){return this._hasCtaMacro}get hasIsiMacro(){return this._hasIsiMacro}parse(e){const t=l.makeTemplateWrapEl(l.getTransformedMacroSrcAttrs(e)),i=l.markElements(t),r=i.innerHTML;(0,n.z8)(i),this._templateDetail.string=l.getInterpolatedMacroSrcAttrs(r),this._templateWrapEl=t,this._chosenTemplate=i,this._hasIsiMacro=l.hasISIMacro(r)}static markElements(e){return e&&1===e.nodeType?(l.isClickThroughEl(e)&&e.classList.add(r.hj+"clickthrough-url"),l.isLogoEl(e)&&e.classList.add(r.hj+"logo-img"),l.isSubHeadlineEl(e)&&e.classList.add(r.hj+"sub-headline"),l.isCtaMacroEl(e)&&(e.classList.add(o),this._hasCtaMacro=!0),[].forEach.call(e.childNodes,t=>{3===t.nodeType&&r.iX.forEach(i=>{t.textContent.toLowerCase().indexOf("%%%"+i+"%%%")>-1&&e.classList.add(""+r.hj+i)}),l.markElements(t)}),e):e}static isClickThroughEl(e){if(!e||!e.tagName||!e.href)return!1;const t=e.tagName.toLowerCase(),i=e.href.toLowerCase();return"a"===t&&i.indexOf("%%%clickthrough_url%%%")>-1}static isLogoEl(e){if(!e||!e.tagName||!e.getAttribute(s))return!1;const t=e.tagName.toLowerCase(),i=e.getAttribute(s).toLowerCase();return"img"===t&&i.indexOf("%%%logo_image_url%%%")>-1}static isSubHeadlineEl(e){return e&&e.tagName&&e.innerHTML&&"%%%subheadline%%%"===e.innerHTML.toLowerCase()}static isCtaMacroEl(e){return e&&e.innerHTML&&"%%%cta%%%"===e.innerHTML.toLowerCase().trim()}static hasISIMacro(e){const t=new RegExp("%%%isi_url%%%","gi");return null!==e.match(t)}static getTransformedMacroSrcAttrs(e){return e.replace(/src([="'\s]+%%%)/gi,s+"$1").replace(/srcset([="'\s]+%%%)/gi,a+"$1")}static getInterpolatedMacroSrcAttrs(e){const t=new RegExp(s,"g"),i=new RegExp(a,"g");return e.replace(t,"src").replace(i,"srcset")}static makeTemplateWrapEl(e){const t=document.createElement("div");return t.innerHTML=e,t}static hasMacro(e){return-1!==(null==e?void 0:e.indexOf("%%%"))}getAltTemplateId(e,t,i){return+i||+t||+e}getAltTemplate(e,t){if(isNaN(Number(t)))return{};if(!e)return this.errNoAltTemplates(),{};const i=(0,n.I6)(e,e=>e.id===t);if(!i)return this.errTemplateNotFound(t),{};const{id:r,...s}=i;this._templateId=r;const a={width:s.maxWidth,height:s.maxHeight,aspectRatio:s.aspectRatio};return{templateId:r,...s,templateResizeConstraints:a}}errNoAltTemplates(){this._errorHandler.fireError({category:"Template Code Retrieval",error:"templateId specified but no templates found on placement. Default templateCode used.",level:this._errorHandler.WARNING})}errTemplateNotFound(e){const t="Cannot find templateCode with id = "+e+" in templateList. Default templateCode used";this._errorHandler.fireError({category:"Template Code Retrieval",error:t,level:this._errorHandler.WARNING})}}},490:(e,t,i)=>{"use strict";i.d(t,{A:()=>m});var r=i(592),n=i(329);class s{static build(e,t,i){let n=e;t.useNewRenderMethodFriendlyFrame&&(n=s._removeSmartFlex(e));const a=s.getImageUrlKey(t),o=(0,r.sT)(t[a]);o&&(t[a]=o);const l=t[a],c=s.parseSizedImgMacros(n,l);Object.assign(t,c);let d=t.cta;if(!d){const e="Learn more";d=i.cta||e}const h=this.parseDisclosure(n,t,i,arguments[3]);return s.interpolate(n,{...t,inv_code:i.invCode,disclosure:h,cta:d})}static parseDisclosure(e,t,i,r){var s;let a=null===(s=t.disclosure)||void 0===s?void 0:s.text;a||(a=i.disclosure);const o=new RegExp("%%%DISCLOSURE%%%","gi");return e.match(o)||(r.disclosure={render_method:n.Zn.DRM_NO_MACRO,text:this.getDisclosureText(e)}),a}static getDisclosureText(e){if(!e)return"No template found";const t=new RegExp("(Sponsored|by|From|Patrocinado|Sponsorisé|Von)(\\w|\\s+){1,8}(%%%ADVERTISER_NAME%%%)","gi"),i=e.match(t);return i&&i[0]||""}static parseSizedImgMacros(e,t){const i=(0,r.o_)(t),n=e.match(/%%%IMAGE_URL_\d+_X_\d+%%%/gi)||[],s={};return n.forEach(e=>{const n=e.slice(3,-3),a=n.split("_");if("data"===i.protocol)s[n]=t;else{i.host.indexOf("img.3lift")>=0&&(i.queryKey.width=a[2],i.queryKey.height=a[4]);const e=(o=i.queryKey,Object.keys(o).map(e=>e+"="+o[e]).join("&"));s[n]=(0,r.sT)("//"+i.host+i.path+"?"+e)}var o}),s}static interpolate(e,t){let i=this._createMacroMap(t);return i=this._clearMissingShoppableMacros(i),this._replaceMacros(e,i)}static _replaceMacros(e,t){let i,r,n=e;return Object.keys(t).forEach(s=>{var a;i=t[s],r=new RegExp("%%%"+s+"%%%","gi"),e.match(r)&&(n=n.replace(r,(a=i,()=>a)))}),n}static _createMacroMap(e){const t={};return e.allImages&&Array.isArray(e.allImages)&&e.allImages.forEach((e,i)=>{e&&Object.keys(e).forEach(r=>{t["asset_"+i+"_"+r]=e[r]})}),{...e,...t}}static _clearMissingShoppableMacros(e){const t={...e},i=["caption","customer_review","customer_star_rating","price","strikeout_price"];let r=0;t.allImages&&Array.isArray(t.allImages)&&(r=t.allImages.length);for(let n=0;n<r;n++)i.forEach(i=>{const r="asset_"+n+"_"+i;e[r]||(t[r]="")});return t}static getImageUrlKey(e){const t=Object.keys(e);let i,r;for(r=0;r<t.length;r+=1)if(i=t[r],"image_url"===i.toLowerCase())return i;return null}static _removeSmartFlex(e){return e.replace(/smartFlex\(\);/g,"")}}var a=i(432);const o={init:function({adWrapper:e,creative:t,analytics:i,asyncUtil:n,domRefs:s,errorHandler:o}){const l=t.getVastTag(),c=l&&l.getVastClickThroughUrl(),d=function(e,t){const i="tl-cta",n=t+"_cta",s="tl-cta-macro";let a=e.getElementsByClassName(i);a.length||(a=e.getElementsByClassName(n));a.length||(a=e.getElementsByClassName(s));return(0,r.uN)(a)}(e,t.placement.invCode),h=t.params.clickthrough_url||c,u=t.isFullyClickable()&&t.isVpaid();h||u?(s.ctaElList=d,d.forEach(e=>{(e=>{n.listen(e,"click",()=>{i.fireEEE("click_cta")})})(e),function(e,t){if(e.className.includes(a.R))t.ctaMacro=e;else{const r=e.childNodes;for(let e=0;e<r.length;e++){var i;null!==(i=r[e].classList)&&void 0!==i&&i.contains(a.R)&&(t.ctaMacro=r[e])}}}(e,s)})):t.formatManager.isHighImpactVideo()?(0,r.XM)(.01,()=>{o.fireError({category:"Cta Initialization",error:"No clickthrough present for HIVE cta",level:o.INFO})}):(d.forEach(r.vw),(0,r.XM)(.01,()=>{o.fireError({category:"Cta Initialization",error:"Cta removed. No clickthrough present and we are not proxying clicks to vpaid.",level:o.INFO})}))}};var l=i(634);const c={init:function(e,t){if(!t.params.logo_image_url){const t=e.getElementsByClassName(l.hj+"logo-img")[0];t&&(t.src=l.CK,(0,r.vw)(t));const i=e.getElementsByClassName(l.hj+"logo")[0];i&&(0,r.vw)(i)}}},d={init:function(e,t){const i=e.getElementsByClassName(l.hj+"sub-headline");if(!t.params.subheadline&&i.length>0){const e=i[0];e&&(0,r.vw)(e)}}};const h=d;var u=i(606),p=i(1);const m=function({environment:e,placement:t,creative:i,templateCode:n,analytics:a,asyncUtil:d,errorHandler:m}){const g=i.getParams();let f=null,v=null;return{render:function(e){var A,I,w;v=e.domRefs;const E=s.build(n.templateDetail.string,g,t,a),C=p.B.createAdWrapperElements(t,i,n,E);v.adWrapper=C.adWrapper,v.adWrapperWithDims=C.adWrapperWithDims,f||(f=function(){const e=v.adWrapper.getElementsByTagName("img");return _((0,r.pb)(e,y))}()||function(){const e=v.adWrapper.getElementsByTagName("*"),t=(0,r.o_)(g.image_url);return(0,r.I6)(e,i);function i(e){const i=e.style&&e.style["background-image"],r=e.hasAttribute&&e.hasAttribute("data-background");return i&&i.match(t.query)||r&&r.match(t.query)}}());v.mainImage=f,!1===(null===(A=f)||void 0===A?void 0:A.complete)&&f.addEventListener("load",()=>{(0,r.XO)(u.A.IMAGE_LOAD_TIME,performance.now())});"div"===p.B.getTagNameLower(f)&&(e.state.isBackgroundImage=!0);"img"===p.B.getTagNameLower(f)&&g.image_srcset_2x&&!f.getAttribute("srcset")&&t.imageWidth<=l.Ol&&t.imageHeight<=l.Ol&&(null===(I=g.customization)||void 0===I||!I.reveal)&&f.setAttribute("srcset",g.image_srcset_2x);if(c.init(v.adWrapper,i),o.init({adWrapper:v.adWrapper,creative:i,analytics:a,asyncUtil:d,domRefs:v,errorHandler:m}),h.init(v.adWrapper,i),!g.clickthrough_url){const e=v.adWrapper.getElementsByClassName(l.hj+"clickthrough-url");for(let t=0;t<e.length;t++)e[t].removeAttribute("href"),e[t].removeAttribute("target")}if(""===(null===(w=a.disclosure)||void 0===w?void 0:w.text)){var b,T;const e=t.invCode+"_sponsor",i=(null===(b=v.adWrapper.getElementsByClassName(e)[0])||void 0===b||null===(T=b.textContent)||void 0===T?void 0:T.trim())||"";a.disclosure.text=i}const S=v.adWrapper.getElementsByClassName("tl_clickthrough")[0];v.mainClickTarget=S||v.adWrapperWithDims;const M=v.adWrapper.getElementsByClassName("tl-heading")[0];v.heading=M,v.caption=v.adWrapper.getElementsByClassName("tl-caption")[0]},_bestImage:_};function _(e){return e.sort(function(e,i){const r="none"===t(e),n="none"===t(i),s=!r&&!n;if(r&&n||s){const t=e.width*e.height,r=i.width*i.height;return isNaN(t)?1:isNaN(r)?-1:r-t}if(r)return 1;return-1})[0];function t(e){return e&&e.style&&e.style.display}}function y(t){const i=[g.image_url,e.tlImageAddr];return t.src&&i.some(e=>(0,r.uv)(t.src,e))}}},523:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var r=i(384);class n{constructor({analytics:e,asyncUtil:t}){this.analytics=e,this.asyncUtil=t}init(e){(0,r.O)(e.domRefs.adWrapperWithDims,()=>this.mouseover(),this.asyncUtil)}mouseover(){this.analytics.mouseover()}}},541:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(705),n=i(329),s=i(980),a=i(645);class o{constructor({firePix:e,lifecycleManager:t,urlParams:i,dependenciesResolver:r}){this.firePix=e,this.lifecycleManager=t,this.urlParams=i,this.previousErrorMap={},this.dependenciesResolver=r}get ERROR(){return 1}get WARNING(){return 2}get INFO(){return 3}fireError({category:e,error:t,level:i,diagnosticContext:r={},block:n,sampleRate:s=1,ref:o}){if(Math.random()>s)return;const l=n||this.lifecycleManager.getPhase();if(this._appendDefaultDiagnosticContext(r),this.urlParams.debugFlag)return void a.A.warn(t,l,i,r);if(t.stack){const e={stack:t.stack};Object.assign(r,e)}let c=t instanceof Error?t.message:t;e&&(c="["+e+"]: "+c),this._logEbError(c,l,i,r,o)}_appendDefaultDiagnosticContext(e){var t,i,r,n,s,a,o,l,c,d,h,u,p,m;const g=this.dependenciesResolver(),f={_placementId:null==g||null===(t=g.placement)||void 0===t?void 0:t.id,_creativeId:null==g||null===(i=g.creative)||void 0===i||null===(r=i.creativePayload)||void 0===r||null===(n=r.ad)||void 0===n||null===(s=n.ext)||void 0===s||null===(a=s.tlAdditionalData)||void 0===a?void 0:a.crid,_templateId:null==g||null===(o=g.placement)||void 0===o?void 0:o.templateId,_buyerId:null==g||null===(l=g.creative)||void 0===l||null===(c=l.creativePayload)||void 0===c||null===(d=c.ad)||void 0===d||null===(h=d.ext)||void 0===h||null===(u=h.tlAdditionalData)||void 0===u?void 0:u.bmid,_formatId:null==g||null===(p=g.formatManager)||void 0===p?void 0:p.formatId,_usingNewIbRenderMethod:null==g||null===(m=g.creative)||void 0===m?void 0:m.hasResizedIframe};Object.assign(e,f)}decorate(e){let t=!1;const i=this;return function(...r){try{return e.apply(this,r)}catch(e){t||(t=!0,i.fireError({error:e,level:e instanceof s.A?e.errorLevel:void 0}))}return null}}_logEbError(e,t,i,r,s){const a={e,block:t,lvl:i,dc:r?JSON.stringify(r):""};return this._isFirstOfType(t,i)?this._recordError(t,i):a.dup=1,s&&(a.ref=s),this.firePix.fireEB(n.f0,a),this}_isFirstOfType(e,t){return!(this.previousErrorMap[e]&&this.previousErrorMap[e][t])}_recordError(e,t){this.previousErrorMap[e]||(this.previousErrorMap[e]={}),this.previousErrorMap[e][t]=!0}}(0,r.A)(o,"ERROR",1),(0,r.A)(o,"WARNING",2),(0,r.A)(o,"INFO",3)},567:(e,t,i)=>{"use strict";i.d(t,{A:()=>D});var r=i(592);const n=function(e){const t=(0,r.ey)(e.supportedDomRefs),i=(0,r.ey)(e.initState);return Object.seal(t),Object.seal(i),{domRefs:t,state:i,csrOptions:{},promises:[]}};var s=i(201);var a=i(309),o=i(980),l=i(634),c=i(687);const d={[l.NW]:function(e,t,i){a.A.setStyleProperties(e,[["top",i],["right","auto"],["bottom","auto"],["left",t]])},[l.NE]:function(e,t,i){a.A.setStyleProperties(e,[["top",i],["right",t],["bottom","auto"],["left","auto"]])},[l.SE]:function(e,t,i){a.A.setStyleProperties(e,[["top","auto"],["right",t],["bottom",i],["left","auto"]])},[l.SW]:function(e,t,i){a.A.setStyleProperties(e,[["top","auto"],["right","auto"],["bottom",i],["left",t]])}};var h=i(705);const u=l.c6+"edaa/",p=u+"OBA_TRANS.png",m={fr:u+"OBA_FRANCE.png",bg:u+"OBA_BULGARIA.png",cs:u+"OBA_CZECH.png",da:u+"OBA_DENMARK.png",fi:u+"OBA_FINLAND.png",de:u+"OBA_GERMANY.png",el:u+"OBA_GREEK.png",hu:u+"OBA_HUNGARY.png",en:u+"OBA_UK.png",it:u+"OBA_ITALY.png",nl:u+"OBA_NETHERLANDS.png",no:u+"OBA_NORWAY.png",pl:u+"OBA_POLAND.png",ro:u+"OBA_ROMANIA.png",sk:u+"OBA_SLOVAKIA.png",es:u+"OBA_SPAIN.png",sv:u+"OBA_SWEDEN.png"},g=l.hj+"adchoices";class f{constructor(e,t,i){(0,h.A)(this,"domRefs",void 0),(0,h.A)(this,"adchoicesIcon",void 0),(0,h.A)(this,"expandedAdchoicesIcon",void 0),this.creative=e,this.positionService=t,this.eventController=i}render({domRefs:e,state:t}){if(this.domRefs=e,this.state=t,e.adchoices=this.createAdchoices(),this.eventController.on(s.zX,()=>this.updateAdchoices()),this.eventController.on(s.HX,()=>this.onAdChoicesEnter()),this.eventController.on(s.Zc,()=>this.onAdChoicesExit()),this.creative.alignAdChoicesToPlacement()){const t=this.createAdchoices();e.adchoices=t,this.placeAdChoicesInTemplate(t)}}onAdChoicesEnter(){this.showEdaaText()}onAdChoicesExit(){this.showEdaaIcon()}createAdchoices(){const e=this.createAdChoicesElement();e.className=g;return a.A.setStyleProperties(e,[["z-index",(0,c.f)(this.creative,c.B.ADCHOICES)],["position",this.creative.alignAdChoicesToPlacement()?"relative":"absolute"],["margin","initial"],["min-height","initial"],["cursor","pointer"]])}createAdChoicesElement(){const e=a.A.setStyleProperties(document.createElement("div"),[["padding","1px"],["display","inline-block"],["background","rgba(204, 204, 204, 0.5)"],["width","initial"],["height","initial"],["float",this.creative.alignAdChoicesToPlacement()?"right":"none"]]);return this.adchoicesIcon=document.createElement("img"),this.adchoicesIcon.className=l.hj+"edaa-icon",this.adchoicesIcon.src=p,this.expandedAdchoicesIcon=document.createElement("img"),this.expandedAdchoicesIcon.className=l.hj+"edaa-text",this.expandedAdchoicesIcon.src=this.getEdaaAdchoicesTextUrl(),e.appendChild(this.adchoicesIcon),e.appendChild(this.expandedAdchoicesIcon),this.showEdaaIcon(),e}showEdaaIcon(){a.A.setStyle(this.adchoicesIcon,"display","block"),a.A.setStyle(this.expandedAdchoicesIcon,"display","none")}showEdaaText(){a.A.setStyle(this.expandedAdchoicesIcon,"display","block"),a.A.setStyle(this.adchoicesIcon,"display","none")}updateAdchoices(){const e=this.showAdChoices()?"inline":"none";a.A.setStyle(this.domRefs.adchoices,"display",e)}showAdChoices(){return!(!this.doesImageAreaSupportAdChoices(this.domRefs.mainImageCsrEl)&&!this.creative.formatManager.isAmazon())&&!(this.creative.formatManager.isAutoplayVideo()&&(this.state.isEnded||!this.state.isPlaying))}doesImageAreaSupportAdChoices(e){const t=this.positionService.getElDims(e);return t.width*t.height>=15e3}createContainer(e){const t=document.createElement("div");return t.className=l.hj+"template-ad-choices",a.A.setStyle(t,"z-index",""+c.B.ADCHOICES),a.A.setStyle(t,"position","absolute"),t.appendChild(e),t}placeAdChoicesInTemplate(e){const t=this.domRefs.adWrapperWithDims,i=this.createContainer(e),r=t.getBoundingClientRect();return a.A.setStyle(i,"top",r.top+"px"),a.A.setStyle(i,"right",r.right+"px"),a.A.setStyle(i,"width","fit-content"),t.appendChild(i),t}getEdaaAdchoicesTextUrl(){const e=navigator.language.slice(0,2);return m[e]||m.en}}const v=l.c6+"political_adchoices/",_=v+"POLITICAL_TRANS.png",y={en:{path:v+"OBA_UK.png",width:72,height:18},es:{path:v+"OBA_SPAIN.png",width:98,height:18}};class A extends f{createAdChoicesElement(){const e=a.A.setStyleProperties(document.createElement("div"),[["padding","2px"],["display","inline-block"],["background","rgba(204, 204, 204, 0.7)"],["width","initial"],["height","initial"],["float",this.creative.formatManager.isComponentMedia()?"right":"none"]]);return this.adchoicesIcon=document.createElement("img"),this.adchoicesIcon.className=l.hj+"political-icon",this.adchoicesIcon.src=_,this.expandedAdchoicesIcon=document.createElement("img"),this.expandedAdchoicesIcon.className=l.hj+"political-icon-expanded",this.expandedAdchoicesIcon.src=this.getPoliticalAdchoicesImageUrl(),e.appendChild(this.adchoicesIcon),e.appendChild(this.expandedAdchoicesIcon),this.showPoliticalIcon(),e}onAdChoicesEnter(){}onAdChoicesExit(){}getPoliticalAdchoicesImageUrl(){const e=navigator.language.slice(0,2);return this.asset=y[e]||y.en,this.asset.path}showPoliticalIcon(){this.imageAreaSupportsExpandedAdChoices()?(a.A.setStyle(this.expandedAdchoicesIcon,"display","block"),a.A.setStyle(this.adchoicesIcon,"display","none")):(a.A.setStyle(this.adchoicesIcon,"display","block"),a.A.setStyle(this.expandedAdchoicesIcon,"display","none"))}imageAreaSupportsExpandedAdChoices(){return this.asset.width*this.asset.height<this.creative.placement.imageWidth*this.creative.placement.imageHeight/10}}const I=function({creative:e,positionService:t,eventController:i}){let r,n;return{render:function(s){({domRefs:r,state:n}=s);const a=r.adWrapper.querySelector("."+w);a?(r.adchoices=a,n.isAdChoiceFromTemplate=!0):e.isPoliticalAdChoices()?new A(e,t,i).render(s):new f(e,t,i).render(s)}}},w=l.hj+"adchoices";const E=function({creative:e,eventController:t}){const i=e.getParams();let n,o,d,h,u,p,m,g=null;return{render:function(v){if(m=v,!A())return;o=(0,r.o_)("?"+i.img_server_params),d=parseInt(o.queryKey.minLogoPct,10),h=parseInt(o.queryKey.maxLogoPct,10),n=parseInt(o.queryKey.logo_width,10),u=i.logo_image_url,p=i.logo_width,g=function(){const n=document.createElement("img");return n.className=l.hj+"logo",(0,r.ZK)(n),a.A.setStyleProperties(n,[["z-index",(0,c.f)(e,c.B.NON_VIDEO_LOGO)],["position","absolute"]]),a.A.setStyle(n,"display","none"),n.onload=()=>{t.publish(s.de),a.A.setStyle(n,"display","block")},n.src=i.logo_image_url,n}(),t.on(s.zX,f),m.domRefs.logo=g},_getLogoDims:v};function f(e){if(g&&g.naturalHeight&&e.width&&e.height){const{width:t,height:i}=e,{naturalWidth:s,naturalHeight:a}=g,o=v({imgWidth:t,imgHeight:i,logoAspectRatio:s/a,scaleFactor:C,logoWidth:n,minLogoPct:d,maxLogoPct:h});(0,r.sH)(g,o.width,o.height);const l=(0,r.Ti)(u,o.width,p);(0,r.r8)(g.src,l)||(g.src=l)}}function v({imgWidth:e,imgHeight:t,logoAspectRatio:i,logoWidth:r,minLogoPct:n,maxLogoPct:s,scaleFactor:a}){let o={};if(r)return o.width=r,o.height=r*(1/i),_(o,i,{imgWidth:e,imgHeight:t});if(o.width=e*a,o.height=o.width*(1/i),o.width/e<o.height/t&&(o.height=t*a,o.width=o.height*i),function(e,t){if(isNaN(e)&&isNaN(t))return!1;const i=isNaN(e)?0:e,r=isNaN(t)?100:t;return i<=r&&i>=0&&i<=100&&r>=0&&r<=100}(n,s)){const r=e*t,a=o.width*o.height;a<r*(n/100)?(o.width=Math.sqrt(r*i*(n/100)),o.height=o.width/i):a>r*(s/100)&&(o.width=Math.sqrt(r*i*(s/100)),o.height=o.width/i)}return o=_(o,i,{imgWidth:e,imgHeight:t}),o.width=Math.round(o.width),o.height=Math.round(o.height),o}function _(e,t,{imgWidth:i,imgHeight:r}){const n={...e};return y(n,{imgWidth:i,imgHeight:r})&&(n.width=i*b,n.height=n.width*(1/t),y(n,{imgWidth:i,imgHeight:r})&&(n.height=r*b,n.width=n.height*t)),n}function y({width:e,height:t},{imgWidth:i,imgHeight:r}){return e>i/2||t>r/2}function A(){return i.logo_image_url&&!e.formatManager.isPharma()&&!e.isVast()&&!e.formatManager.isComponentImage()&&!e.formatManager.isComponentVideo()&&!e.formatManager.isComponentCarousel()&&!e.formatManager.isDocAds()&&!e.formatManager.isAmazon()}},C=.25,b=.5;const T="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0ic3ZnLWlubGluZS0tZmEgZmEtY2hldnJvbi1yaWdodCBmYS13LTEwIiBhcmlhLWhpZGRlbj0idHJ1ZSIgZm9jdXNhYmxlPSJmYWxzZSIgZGF0YS1wcmVmaXg9ImZhcyIgZGF0YS1pY29uPSJjaGV2cm9uLXJpZ2h0IiByb2xlPSJpbWciIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDMyMCA1MTIiIGRhdGEtZmEtaTJzdmc9IiIgc3R5bGU9IndpZHRoOiA4cHg7CiAgICBtYXgtd2lkdGg6IDEwMCU7CiAgICBsaW5lLWhlaWdodDogMTBweDsKICAgIGZsb2F0OiByaWdodDsiPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0yODUuNDc2IDI3Mi45NzFMOTEuMTMyIDQ2Ny4zMTRjLTkuMzczIDkuMzczLTI0LjU2OSA5LjM3My0zMy45NDEgMGwtMjIuNjY3LTIyLjY2N2MtOS4zNTctOS4zNTctOS4zNzUtMjQuNTIyLS4wNC0zMy45MDFMMTg4LjUwNSAyNTYgMzQuNDg0IDEwMS4yNTVjLTkuMzM1LTkuMzc5LTkuMzE3LTI0LjU0NC4wNC0zMy45MDFsMjIuNjY3LTIyLjY2N2M5LjM3My05LjM3MyAyNC41NjktOS4zNzMgMzMuOTQxIDBMMjg1LjQ3NSAyMzkuMDNjOS4zNzMgOS4zNzIgOS4zNzMgMjQuNTY4LjAwMSAzMy45NDF6Ij48L3BhdGg+PC9zdmc+Cgo=",S=function({placement:e,creative:t,asyncUtil:i,analytics:n,docInfo:o,eventController:l}){return{render:function({domRefs:r}){if(o=r.ctaMacro,!o&&t.isDemandSideCtaTextOptIn()){const o=function(i){const r=document.createElement("div");return r.className=e.invCode+"_sponsor_tag",r.innerText=i,r.appendChild(function(){const t=document.createElement("span");let i=document.createElement("img");return i.className=e.invCode+"_sponsor_tag_arrow",i.src=T,i=a.A.setStyleProperties(i,[["width","8px"],["max-width","100%"],["line-height","15px"],["float","right"],["margin-top","3px"]]),t.appendChild(i),t}()),a.A.setStyleProperties(r,[["display","block"],["font-family","'Open Sans', sans-serif"],["font-size","12px"],["font-weight","normal"],["font-style","normal"],["color","#fff"],["text-transform","none"],["letter-spacing","normal"],["text-decoration","none"],["text-align","left"],["padding","5px"],["background","rgba(40,103,178,.7)"],["width","100%"],["z-index",(0,c.f)(t,c.B.CTA_OVERLAY)],["float","left"],["position","relative"],["box-sizing","border-box"],["pointer-events","all"],["cursor","pointer"]])}(t.getParams().cta);i.listen(o,"click",()=>{n.fireEEE("click_cta")}),r.mainImageCsrEl?l.on(s.zX,e=>{e.height&&d(r)}):d(r),r.ctaOverlay=o}var o}};function d(e){const t=e.adWrapper.clientHeight;(0,r.uN)(e.ctaElList).forEach(t=>{(0,r.vw)(t),e.ctaElList.pop()});const i=t-e.adWrapper.clientHeight;i&&function(e,t){if(o.canAccessTop){if(o.window.frameElement){const{frameElement:t}=o.window,i=a.A.getPropertyValue(t,"height"),r=parseInt(i,10);r&&a.A.setStyle(t,"height",r-e+"px")}}else{const i=a.A.getPropertyValue(t,"top"),r=(parseInt(i,10)||0)+e/2;a.A.setStyle(t,"top",r+"px"),a.A.setStyle(t,"position","absolute")}}(i,e.adWrapper)}};const M=1,R=2,P=3;const D=function(e,t){const{positionService:i,featureConfigs:s}=t,a={initState:function(){const t=s.reduce((e,t)=>Object.assign(e,t.initState),(0,r.ey)(e.initState));return{...x,...t}}(),supportedDomRefs:h("supportedDomRefs",N)},l=n(a),c=h("renderers",L),d=h("eventManagers",O);return{render:function(){e=c,e.forEach(e=>e(t).render(l)),i.setAdContainer(l.domRefs.adWrapperWithDims);var e;const n=(0,r.QE)(Object.keys(l.domRefs),a.supportedDomRefs);if(n.length>0)throw new o.A("domRefs invalid. Unmatched keys: "+n.join(", "));return Object.freeze(l.domRefs),u(),Promise.all(l.promises).then(()=>l)},context:l};function h(t,i){return s.reduce((e,i)=>e.concat(i[t]),e[t]).concat(i)}function u(){d.forEach(e=>new e(t).init(l))}},x={isAdChoiceFromTemplate:!1,isBackgroundImage:!1,imageBoxingOffsetX:0,imageBoxingOffsetY:0,logoOffsetX:0,logoOffsetY:0,visibleImageWidth:0,visibleImageHeight:0},N=["adchoices","adWrapper","adWrapperWithDims","logo","mainClickTarget","mainImage","mainImageCsrEl","overlayContainer","innerOverlayContainer","ctaOverlay","ctaElList","ctaMacro","templateComponent","heading","caption"],L=[E,I,S,({creative:e,errorHandler:t,asyncUtil:i,eventController:n,cornerElementsConfig:h,urlParams:u,docInfo:p,environment:m})=>{let g=null,f=null,v=null,_=null,y=null,A=null,I=null;return{render:function(d){g=d,({domRefs:f,state:v}=g),h.domRefs=f,h.state=v;f.mainImageCsrEl?function(){let t;if(_=T(),e.isVast()){if(t=f.video,t.parentElement.appendChild(_),n.on(s.fD,P),e.formatManager.isHighImpactVideo()){const t=function(){const t=document.createElement("div");return t.className=l.hj+"progress",f.progressBar=t,a.A.setStyleProperties(t,[["display","block"],["background-color","rgb(252, 85, 20)"],["height","3px"],["transition","all .3s linear"],["position","relative"],["z-index",(0,c.f)(e,c.B.VIDEO_PROGRESS_BAR)]]),t.style.setProperty("width","0"),t}();w(),_.appendChild(t)}}else{if(t=f.mainImageCsrEl,!t)throw new o.A("createCreativeContentOverlay failed: creativeContent element not on dom");f.mainImageCsrEl.insertBefore(_,f.mainImageCsrEl.firstElementChild)}n.on(s.Kp,b),n.on(s.zX,C),f.ctaOverlay&&(y||w(),e.formatManager.isWindow()||e.formatManager.isCarousel()?a.A.setStyle(_,"position","absolute"):a.A.setStyle(_,"position","relative"),_.appendChild(f.ctaOverlay));E(h.create())}():function(){_=T(),E(h.create()),i.addResizeListener(M),f.mainImage&&f.mainImage.addEventListener("load",R);f.ctaOverlay&&e(f.ctaOverlay);function e(e){a.A.setStyle(e,"bottom","0px"),a.A.setStyle(e,"position","absolute"),_.appendChild(e),n.on(s.Ol,()=>{setTimeout(()=>{if(h.insertedLogoCorner.includes("S"))return t.fireError({category:"Cta Overlay Element Handling",error:"Cta overlay not rendered because it would cover logo.",level:t.WARNING}),(0,r.vw)(f.ctaOverlay),f.ctaOverlay=null,void(h.corners[h.insertedLogoCorner]=null);const{height:i}=e.getBoundingClientRect();h.corners[l.SE]&&a.A.setStyle(f[h.corners[l.SE]],"bottom",i+"px"),h.corners[l.SW]&&a.A.setStyle(f[h.corners[l.SW]],"bottom",i+"px")},0)})}}();(function(){const t=p.topDocument.createElement("IMG");t.style.setProperty("display","none","important"),t.onload=()=>{var t,r,n;I=function(){const t=document.createElement("div");return t.className=l.hj+"highlight",a.A.setStyle(t,"position","absolute"),a.A.setStyle(t,"pointer-events","none"),a.A.setStyle(t,"box-sizing","border-box"),a.A.setStyle(t,"border","5px solid yellow"),a.A.setStyle(t,"z-index",(0,c.f)(e,c.B.HIGHLIGHT)),t}(),null===(t=f)||void 0===t||null===(r=t.adWrapperWithDims)||void 0===r||null===(n=r.parentNode)||void 0===n||n.appendChild(I),S(I),i.addResizeListener(()=>{S(I)},!1)},t.src="//"+m.ebPath+"/highlight",u.tlHighlight&&(t.src+="?tl_highlight="+u.tlHighlight);document.body.appendChild(t)})(),function(){if(u.tlDiagnosticData){var t,r,n;const s=function(){const t=document.createElement("div");return t.className=l.hj+"diagnostic-data",a.A.setStyle(t,"position","absolute"),a.A.setStyle(t,"pointer-events","none"),a.A.setStyle(t,"box-sizing","border-box"),a.A.setStyle(t,"z-index",(0,c.f)(e,c.B.DIAGNOSTIC_DATA)),a.A.setStyle(t,"background-color","rgba(204, 204, 204, 0.5)"),a.A.setStyle(t,"padding","8px"),a.A.setStyle(t,"font-family","Consolas, monospace"),a.A.setStyle(t,"color","yellow"),a.A.setStyle(t,"font-size","10px"),a.A.setStyle(t,"word-wrap","break-word"),t}();!function(t){var i,r,n,s,a,o,l,c;const d=[["Placement ID",null==e||null===(i=e.placement)||void 0===i?void 0:i.id],["Inventory Code",null==e||null===(r=e.placement)||void 0===r?void 0:r._invCode],["Template ID",null==e||null===(n=e.placement)||void 0===n?void 0:n._templateId],["Creative ID",null==e||null===(s=e.creativePayload)||void 0===s||null===(a=s.ad)||void 0===a||null===(o=a.ext)||void 0===o||null===(l=o.tlAdditionalData)||void 0===l?void 0:l.crid],["Format ID",null==e||null===(c=e.formatManager)||void 0===c?void 0:c.formatId],["New IB Render Method",null==e?void 0:e.hasResizedIframe]];d.forEach(([e,i])=>{const r=document.createElement("div");r.innerHTML="<strong>"+e+":</strong> "+i+"<br>",t.appendChild(r)}),console.log("tl: Diagnostic data overlay created with data:",JSON.stringify(d),f.adWrapper)}(s),null===(t=f)||void 0===t||null===(r=t.adWrapperWithDims)||void 0===r||null===(n=r.parentNode)||void 0===n||n.appendChild(s),S(s),i.addResizeListener(()=>{S(s)},!1)}}(),f.overlayContainer=_}};function w(){y=T(),y.className=l.hj+"inner-transparent",a.A.setStyle(y,"position","relative"),f.innerOverlayContainer=y,_.appendChild(y)}function E(e){try{if(0===e.length)return;const t=y||_;e.forEach(e=>{!function({element:e,corner:t,xOffsetPx:i,yOffsetPx:r},n){n.appendChild(e),a.A.setStyle(e,"pointer-events","all"),d[t](e,i,r)}(e,t),function(e){e.callback&&e.callback()}(e)})}catch(e){t.fireError({category:"Corner Elements Placement",error:e,level:t.ERROR})}}function C(e){var t;e.height&&(A=e,_.offsetHeight&&_.offsetHeight!==(null===(t=f.ctaOverlay)||void 0===t?void 0:t.offsetHeight)||(a.A.setStyle(_,"width",e.width+"px"),a.A.setStyle(_,"height",e.height+"px")),f.ctaOverlay&&x(f.ctaOverlay))}function b(e){a.A.setStyle(_,"top",e.y+"px"),a.A.setStyle(_,"left",e.x+"px"),A&&(a.A.setStyle(_,"height",A.height-2*e.y+"px"),a.A.setStyle(_,"width",A.width-2*e.x+"px"))}function T(){const e=document.createElement("div");return e.className=l.hj+"transparent",a.A.setStyle(e,"position","absolute"),a.A.setStyle(e,"pointer-events","none"),e}function S(e){var t,i;const r=null===(t=f)||void 0===t||null===(i=t.adWrapperWithDims)||void 0===i?void 0:i.getBoundingClientRect();r&&(a.A.setStyle(e,"top",r.top+"px"),a.A.setStyle(e,"left",r.left+"px"),a.A.setStyle(e,"width",r.width+"px"),a.A.setStyle(e,"height",r.height+"px"))}function M(){D();const e=f.mainImage;e&&e.complete&&R()}function R(){D();const e=f.mainImage.getBoundingClientRect(),t=_.parentElement.getBoundingClientRect(),i=f.adWrapper.style.scale||1,r=(e.top-t.top)/i,n=(e.left-t.left)/i;a.A.setStyle(_,"top",r+"px"),a.A.setStyle(_,"left",n+"px"),a.A.setStyle(_,"width",e.width/i+"px"),a.A.setStyle(_,"height",e.height/i+"px")}function P(e){a.A.setStyle(_,"width",e.width+"px"),a.A.setStyle(_,"height",e.height+"px"),f.progressBar&&x(f.progressBar)}function D(){if(null===_.parentElement){(function(e){let i=e;const r=a.A.getPropertyValue(i,"position");["static","","relative"].indexOf(r)<0?i=document.body:a.A.setStyle(i,"position","relative");i!==e&&t.fireError({category:"Overlay Container Parent Setup",error:"Invalid position style set on ad wrapper",level:t.WARNING});return i})(f.adWrapperWithDims).appendChild(_)}return _.parentElement}function x(e){const t=_.offsetHeight-e.offsetHeight;a.A.setStyle(y,"height",t+"px")}}],O=[class{constructor({creative:e,eventController:t,asyncUtil:i}){this.creative=e,this.eventController=t,this.asyncUtil=i,this.params=e.getParams(),this.adchoicesUrl=this.params.adchoices_url}init({domRefs:e,state:t}){const i=e.adchoices;this.asyncUtil.listen(i,"click",()=>this.onClick(),!1,!0),t.isAdChoiceFromTemplate||(this.asyncUtil.listen(i,"mouseenter",()=>this.eventController.publish(s.HX),!1,!0),this.asyncUtil.listen(i,"mouseleave",()=>this.eventController.publish(s.Zc),!1,!0))}onClick(){window.open(this.adchoicesUrl,"popup","width=650,height=316")}},class{constructor({analytics:e,eventController:t,docInfo:i}){this.analytics=e,this.eventController=t,this.docInfo=i,this.ctaRenderMethod=M,this.ctaRenderText=""}init({domRefs:e}){var t;e.ctaOverlay?this._buildOverlayRenderResult(e.ctaOverlay):e.ctaMacro?this._buildTemplateRenderResult(e.ctaMacro,this.docInfo.window):(null===(t=e.ctaElList)||void 0===t?void 0:t.length)>0&&this._buildEmptyMacroRenderResult(e.ctaElList);const{ctaRenderMethod:i,ctaRenderText:r}=this;this.analytics.ctaRenderResult({cta_render_method:i,cta_render_text:r})}_buildTemplateRenderResult(e,t){e&&(0,r.B7)(e,t)&&(this.ctaRenderMethod=R,this.ctaRenderText=e.innerText)}_buildOverlayRenderResult(e){this.ctaRenderMethod=P,this.ctaRenderText=e.innerText}_buildEmptyMacroRenderResult(e){this.ctaRenderMethod=M,this.ctaRenderText=e[0].innerText}}]},592:(e,t,i)=>{"use strict";i.d(t,{$y:()=>ce,B7:()=>$,BE:()=>v,Et:()=>u,FQ:()=>L,Gz:()=>U,Hl:()=>x,I6:()=>q,IY:()=>C,Kt:()=>g,M8:()=>Q,Nt:()=>Z,QE:()=>d,RD:()=>M,Ti:()=>j,Vp:()=>X,XM:()=>_,XO:()=>re,XU:()=>h,Y1:()=>D,ZK:()=>l,bQ:()=>ne,bf:()=>T,c3:()=>K,dv:()=>R,en:()=>k,ey:()=>c,gf:()=>ie,h:()=>f,hb:()=>V,j7:()=>y,js:()=>S,jx:()=>o,km:()=>N,nF:()=>O,nv:()=>B,o_:()=>w,pW:()=>le,pb:()=>Y,qA:()=>E,r8:()=>z,sH:()=>F,sT:()=>b,th:()=>p,uN:()=>J,ub:()=>G,uv:()=>W,vC:()=>te,vF:()=>I,vV:()=>ee,vw:()=>m,xO:()=>a,xo:()=>P,ye:()=>A,z8:()=>H});var r=i(309),n=i(634),s=i(980);function a(...e){const t=[].slice.call(e);return Object.assign.apply(null,t.map(function(e){const t={};return Object.keys(e).forEach(i=>{(function(e){return"_"!==e[0]})(i)&&(t[i]=e[i])}),t}))}function o(e,t){return!!e&&!!(e&2**t)}function l(e){return r.A.setStyle(e,"display","inline"),r.A.setStyle(e,"box-sizing","content-box"),r.A.setStyle(e,"-webkit-box-sizing","content-box"),r.A.setStyle(e,"-moz-box-sizing","content-box"),r.A.setStyle(e,"padding","0"),r.A.setStyle(e,"border","0"),r.A.setStyle(e,"margin","0"),r.A.setStyle(e,"float","none"),r.A.setStyle(e,"outline","none"),r.A.setStyle(e,"object-fit","fill"),r.A.setStyle(e,"background","none"),e}function c(e){if("object"==typeof(t=e)&&!Array.isArray(t)&&null!==t)return e;var t;if(Array.isArray(e))return e.reduce(function(e=null){return(t,i)=>(t[i]=e,t)}(null),{});throw new TypeError("invalid arguments, objectify takes an object or an array")}function d(e,t){const i=e.filter(n.bind(null,t)),r=t.filter(n.bind(null,e));return i.concat(r);function n(e,t){return-1===e.indexOf(t)}}function h(e){return Math.floor((e+1)*Math.random())}function u(e){return!isNaN(e)&&"number"==typeof e}function p(e,t,i){if(r=e,parseFloat(r)!==parseInt(r,10)||!u(r))throw new TypeError("arg 0 of updateCopyAndHref must be an integer");var r,s;if(s=t,!("object"==typeof Node?s instanceof Node:s&&"object"==typeof s&&"number"==typeof s.nodeType&&"string"==typeof s.nodeName))throw new TypeError("arg 1 of updateCopyAndHref must be DOM element");if(!Array.isArray(i))throw new TypeError("arg 2 of updateCopyAndHref must be an array");n.iX.forEach(r=>{const s=t.getElementsByClassName(""+n.hj+r);for(let t=0;t<s.length;t++)s[t].textContent=i[e][r]});const a=t.getElementsByClassName(n.hj+"clickthrough-url");for(let t=0;t<a.length;t++)a[t].href=i[e].clickthrough_url}function m(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function g(e,t){return isNaN(e)&&isNaN(t)?NaN:isNaN(e)?t:isNaN(t)?e:Math.min(e,t)}function f(e,t){let i=!1;return function(...r){i||e.apply(t||null,r),i=!0}}function v(e){return[...e].reverse()}function _(e,t){Math.random()<e&&t()}function y(e,t,i={},r=!0,n="?"){!1!==r&&(i.cb=A(5));const s=I(function(e){const t={};return Object.keys(e).forEach(i=>{const r=e[i];null!=r&&(t[i]=r)}),t}(i));return b("//"+e.replace(/\/$/,"")+"/"+t+n+s)}function A(e){if(e<1)return NaN;if(1===e)return Math.floor(10*Math.random());const t=10**(e-1);return Math.floor(9*Math.random()*t)+t}function I(e){return Object.keys(e).map(t=>t+"="+encodeURIComponent(e[t])).join("&")}function w(e){const t=w.options,i=t.parser[t.strictMode?"strict":"loose"].exec(e),r={};let n=14;for(;n--;)r[t.key[n]]=i[n]||"";return r[t.q.name]={},r[t.key[12]].replace(t.q.parser,(e,i,n)=>{i&&(r[t.q.name][i]=n)}),r}function E(e){if(!e)return e;const t=w(e);let i="";return""!==t.port&&(i=":"+t.port),"//"+t.host+i+t.relative}function C(e){Object.keys(e).forEach(t=>null==e[t]&&delete e[t])}function b(e){return e?"data:"===e.substring(0,5)?e:function(e){if(e.indexOf("3lift.")>=0||e.indexOf("triplelift.")>=0)return"https:";const t=w(e);if("http"===t.protocol||"https"===t.protocol)return t.protocol+":";try{return window.location.protocol}catch(e){return"https:"}}(e)+E(e):e}function T(){return!!document.getElementById(n.hj+"app")}function S(e=""){return e.toUpperCase()}w.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};const M=(e,t="GET",i=null)=>new Promise((r,n)=>{e||n(new s.A("No uri provided to ajax"));const a=new XMLHttpRequest,o=performance?performance.now():0;a.open(t,e,!0),a.addEventListener("load",e=>{try{if(i){const e=(performance?performance.now():0)-o,t=a.responseText?a.responseText.length:0;i(e?8*t/(e/1e3)/1024:0)}}catch(e){}a.status>=200&&a.status<300?r(e):n(a.statusText)}),a.addEventListener("error",e=>n(e)),a.send()}),R=e=>Object.keys(e).reduce((t,i)=>{const r=e[i];return t[i]="number"==typeof r?Math.round(r):r,t},{}),P=e=>(r.A.setStyle(e,"display","none"),r.A.setStyle(e,"width",0),r.A.setStyle(e,"height",0),e);function D(e,t){if(!e)return"";if(!t)return e;if(e.length<=t)return e;const i=e.slice(0,t);return-1!==i.lastIndexOf("&")?i.slice(0,i.lastIndexOf("&")):i}function x(e,t,i){const r=i.createEvent("Event");if(!r.initEvent)throw new s.A("triggerEvent could not call initEvent");r.initEvent(t,!0,!0);try{e.dispatchEvent(r)}catch(e){throw new s.A("triggerEvent could not dispatch an uninitialized event")}}function N(e={}){const t={};return Object.keys(e).forEach(i=>{t[i]=encodeURIComponent(e[i])}),t}function L(e){if(!e)return NaN;const t=e.split("."),i=t[0].split(":"),r=parseInt(t[1],10)||0;return 60*parseInt(i[0],10)*60*1e3+60*parseInt(i[1],10)*1e3+1e3*parseInt(i[2],10)+r}function O(e,t){let i,r=0;return(...n)=>{i&&clearTimeout(i),i=setTimeout(e.bind(null,...n),t);const s=Date.now();s-r>t&&(r=s,e(...n))}}function k(e,t){if(!t||!t.parentElement)throw new s.A("swapElement failed: oldEl element not on dom");t.parentElement.insertBefore(e,t),t.parentElement.removeChild(t)}function j(e,t,i){if(!e||!t)return e;if(e.indexOf("images.3lift")<0)return e;if(i&&i<t)return e;let r;r=t<=100?"_w90":t<=200?"_w192":t<=350?"_w300":t<=650?"_w600":"";const n=e.split(".");return n[n.length-2]+=r,n.join(".")}function F(e,t,i,r="px"){e.style.setProperty("width",t+r,"important"),e.style.setProperty("min-width",t+r,"important"),e.style.setProperty("max-width",t+r,"important"),e.style.setProperty("height",i+r,"important"),e.style.setProperty("min-height",i+r,"important"),e.style.setProperty("max-height",i+r,"important")}function V(e,t){return e.split("&").filter(e=>-1===e.indexOf(t+"=")).join("&")}function H(e){for(;e.lastChild;)e.removeChild(e.lastChild)}function B(e){if(e<0)return NaN;let t,i,r,n,s=e;return t=Math.floor(s/36e5),s-=36e5*t,i=Math.floor(s/6e4),s-=6e4*i,r=Math.floor(s/1e3),n=s-1e3*r,t=t<10?"0"+t:t,i=i<10?"0"+i:i,r=r<10?"0"+r:r,n<10?n="00"+n:n<100&&(n="0"+n),t+":"+i+":"+r+"."+n}function W(e,t){return-1!==e.indexOf(t)}function U(){let e=!1;try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(e=!0)}catch(t){navigator.mimeTypes&&void 0!==navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(e=!0)}return e}function z(e,t){const i=/^https?:/i;return e.replace(i,"")===t.replace(i,"")}function G(e,t){return!!e&&(Object.keys(e).forEach(i=>{t(i,e[i])}),!0)}function q(e,t){if(!e)return!1;for(let i=0;i<e.length;i++)if(t(e[i]))return e[i];return!1}function Y(e,t){if(!e)return[];const i=[];for(let r=0;r<e.length;r++)t(e[r])&&i.push(e[r]);return i}function Z(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function Q(e,t){if(!Array.isArray(e))return[];if(0===t)return[];if(e.length<t)return e;const i=e.slice(),r=[];for(let n=0;n<t;n++){const t=Math.floor(Math.random()*i.length);r.push(e.indexOf(i.splice(t,1)[0]))}return r.sort().map(t=>e[t])}function X(e){const t=n.yl;let i=e;return t.forEach(e=>{const{regex:t}=e;t.test(i)&&(i=i.replace(t,""))}),i}function J(e){return e?[].slice.call(e):[]}function K(e,t){e&&(t.ownerDocument.getElementById(e)||t.setAttribute("id",e))}function $(e,t){return"none"!==t.getComputedStyle(e).display}function ee(e){const t=new URLSearchParams(e);if(!t)return{};const i={};return t.forEach((e,t)=>{i[t]=e}),i}function te(e){return e?Array.isArray(e)?0===e.length?null:e[0]:e:null}function ie(e){return!isNaN(e)&&"number"==typeof e}const{setData:re,getData:ne,getAllData:se,cleanData:ae,cleanAllData:oe}=(()=>{const e={};return{setData:(t,i)=>{e[t]=i},getData:t=>e[t],cleanData:t=>delete e[t],getAllData:()=>({...e}),cleanAllData:()=>{Object.keys(e).forEach(t=>delete e[t])}}})();function le(e){const t=function(e){const t=function(e){return("string"==typeof e?e:e.templateCode)||""}(e);return("undefined"!=typeof TextEncoder?(new TextEncoder).encode(t).length:unescape(encodeURIComponent(t)).length)||0}(e);return t/1024}function ce(e,t,i,r=1){let n=0,s=null,a=[];return function(...o){n>=t||(Math.random()<=r&&a.push(o),null===s&&(s=setTimeout(()=>{n++,i(a),a=[],s=null},e)))}}},606:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(705),n=i(201),s=i(388);class a{constructor({settings:e,ttjStartTime:t=0,revision:i,isTestEnv:r},{eventController:n,firePix:s}){this.ttjStartTime=t,this.revision=i,this.eventController=n,this.firePix=s,this.formatId=null,this.isHeaderBidding=!1,this.lastMetricTime=0,this.bundleSize="undefined"!=typeof window&&null!==window.__BUNDLE_SIZE_KB&&void 0!==window.__BUNDLE_SIZE_KB?parseFloat(window.__BUNDLE_SIZE_KB):0,this.shouldLog=t>0&&!r&&Math.random()<=e.benchmarkLogRate,this.logSize(a.BUNDLE_SIZE,this.bundleSize),this._setupListeners()}log(e,t=performance.now()){if(this.shouldLog){const i=t-this.ttjStartTime,r=this.lastMetricTime?t-this.lastMetricTime:0;this.lastMetricTime=t,this._logPerformanceDyn(e,i,r),this._logPerformanceEB(e,i,r)}}logSize(e,t){this.shouldLog&&this._logPerformanceSizeEB(e,t)}setFormatId(e){this.formatId=e}setIsHeaderBidding(e){this.isHeaderBidding=e}_logPerformanceDyn(e,t,i){const r={string2:this.revision,string3:this.isHeaderBidding?"header"+e.replace(/^./,e=>e.toUpperCase()):e,long1:s.xn,long2:t,long3:i};this.firePix.fireDyn(r)}_logPerformanceEB(e,t,i){t<=15e3&&this.firePix.firePerf({type:e,timeSinceStart:t,timeSinceLast:i,clientSideAuction:!this.isHeaderBidding,formatId:this.formatId})}_logPerformanceSizeEB(e,t){this.firePix.firePerf({type:e,timeSinceStart:0,timeSinceLast:0,size:t,clientSideAuction:!this.isHeaderBidding,formatId:this.formatId})}_setupListeners(){this.eventController.on(n.e8,e=>{var t,i;const r=null===(t=e.ad)||void 0===t||null===(i=t.ext)||void 0===i?void 0:i.tlFormatId;this.setFormatId(r)})}}(0,r.A)(a,"BUNDLE_LOAD_TIME","bundleLoadTime"),(0,r.A)(a,"AUCTION_START","auctionStart"),(0,r.A)(a,"AUCTION_RESPONSE","auctionResponse"),(0,r.A)(a,"RENDER","render"),(0,r.A)(a,"AD_ON_PAGE","adOnPage"),(0,r.A)(a,"BUNDLE_SIZE","bundleSize"),(0,r.A)(a,"TEMPLATE_SIZE","templateSize"),(0,r.A)(a,"IMAGE_LOAD_TIME","imageLoadTime"),(0,r.A)(a,"VIDEO_LOAD_TIME","videoLoadTime")},634:(e,t,i)=>{"use strict";i.d(t,{CK:()=>h,Ct:()=>l,L6:()=>_,NE:()=>s,NG:()=>C,NW:()=>n,Ol:()=>A,Rv:()=>E,SE:()=>a,SW:()=>o,T:()=>m,aD:()=>f,c6:()=>r,ds:()=>I,eY:()=>c,gi:()=>p,hj:()=>u,iX:()=>d,ic:()=>w,lm:()=>g,pj:()=>v,yl:()=>y});const r="https://ib.3lift.com/static/buttons/",n="NW",s="NE",a="SE",o="SW",l=0,c="https://optout.aboutads.info",d=["heading","caption"],h="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",u="tl-",p=u+"wrapper",m="https://darkroom-api.prod.triplelift.net",g={BLACK:"#000",WHITE:"#fff"},f={KEEP_VIDEO_VISIBLE_BEFORE_PLAY:1,SKIP_ZERO_DIMENSION_RESIZE:2,ENFORCE_MIN_IFRAME_DIMENSIONS:4,RESIZE_BEFORE_AOP:8,IFRAME_RENDER_NO_RESIZE:16},v={DYNAMIC_CONTENT:1,NATIVE_ADS:2,DV_BLOCKING:3},_="https://images.3lift.com/5333898.jpg",y=[{regex:/{clickurl}/gi,level:0},{regex:/{clickurl_enc}/gi,level:1},{regex:/{clickurl_dbl_enc}/gi,level:2}],A=600,I={logo:1,cta:2,overlay:3,end_card:4,feature:5,skin:6,image_position_1:7,image_position_2:8,image_position_3:9,image_position_4:10,image_position_5:11,other_image_positions:12,product_1:13,product_2:14,product_3:15,product_4:22,product_5:23,product_6:24,product_7:25,product_8:26,product_9:27,product_10:28,main:16,headline:17,caption:18,cta_1:19,cta_2:20,cta_3:21},w={hiveCta:I.cta,endCard:I.end_card,endCardCta:I.cta,endCardFeature:I.feature,overlay:I.overlay,featureImg:I.feature,skin:I.skin,videoLogo:I.logo,product1:I.product_1,product2:I.product_2,product3:I.product_3,product4:I.product_4,product5:I.product_5,product6:I.product_6,product7:I.product_7,product8:I.product_8,product9:I.product_9,product10:I.product_10,mainClickTarget:I.main,heading:I.headline,caption:I.caption,cta1:I.cta_1,cta2:I.cta_2,cta3:I.cta_3},E={VIDEO_PILLARBOX:1,COMPONENT_PARALLAX:2},C={DT_PLATFORM:0,DT_DISPLAY:1,DT_PHONE:2,DT_TABLET:3,DT_CONNECTED_TV:4}},645:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(705),n=i(201);class s{constructor({environment:e,bundleStartTime:t},{eventController:i,urlParams:n}){(0,r.A)(this,"auctionId","none"),(0,r.A)(this,"formatName","none"),(0,r.A)(this,"_log",(e,...t)=>{console.log(this._makeLogString(e,t))}),this.environment=e,this.bundleStartTime=t,this.eventController=i,n.debugLog&&this._setupListeners()}_setupListeners(){this.eventController.on(n.$9,this._log),this.eventController.on(n.e8,e=>{var t,i,r,n,s;this.auctionId=null===(t=e.ad)||void 0===t||null===(i=t.ext)||void 0===i||null===(r=i.tlAdditionalData)||void 0===r?void 0:r.aid;const a=(null===(n=e.ad)||void 0===n||null===(s=n.ext)||void 0===s?void 0:s.tlFormatId)||e.settings.format_id;this.formatName=this._getFormatName(a)})}_getFormatName(e){return Object.keys(this.environment.formats).find(t=>this.environment.formats[t]===e)}_makeLogString(e,t){return"["+this.formatName+"]["+this.auctionId+"]["+this._getTimeSinceStartMS()+"ms]["+e+"]"+(t.length>0?JSON.stringify(t):"")}_getTimeSinceStartMS(){return performance.now()-this.bundleStartTime}static warn(e,...t){console.warn("tl: "+(e.stack||e),{...t})}}},646:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(705),n=i(201);class s{constructor({docInfo:e,domRefs:t,errorHandler:i,eventController:r,pageInfo:n,vastTag:s}){this.docInfo=e,this.domRefs=t,this.errorHandler=i,this.eventController=r,this.pageInfo=n,this.vastTag=s}run(){try{var e;const t=null===(e=this.pageInfo.getOmidSessionClient())||void 0===e?void 0:e.default,i=this.vastTag.getAdVerifications(),r=this.domRefs.video||this.domRefs.adWrapperWithDims,a=this.vastTag.getLinear();if(t&&i.length>0){const e=t.AdEvents,o=t.AdSession,l=t.Partner,c=t.Context,d=t.VerificationScriptResource,h=t.VastProperties,u=t.MediaEvents,p=this.docInfo.topWindow.location.href,m=new l(s.partnerName,s.partnerVersion),g=new c(m,i.map(e=>new d(e.javascriptResource,e.vendor,e.verificationParameters)),p);g.setVideoElement(r),g.setServiceWindow(this.docInfo.topWindow);const f=new o(g),v=new e(f);try{f.setCreativeType("video")}catch(e){}try{f.setImpressionType("beginToRender")}catch(e){}if(!f.isSupported())return!1;f.start(),f.registerSessionObserver(e=>{if("sessionStart"===e.type){var t;const e=null===(t=a.getAttribute("skipoffset"))||void 0===t?void 0:t.trim(),i=new h(!!e,e,!0,"standalone");v.loaded(i),v.impressionOccurred()}else"sessionError"===e.type||e.type});const _=new u(f);return this.eventController.on(n.Rb,()=>{_.start(a.getAttribute("duration"),r.volume)}),this.eventController.on(n.ZJ,()=>{_.firstQuartile()}),this.eventController.on(n.RY,()=>{_.midpoint()}),this.eventController.on(n.wQ,()=>{_.thirdQuartile()}),this.eventController.on(n.uT,()=>{_.complete(),f.finish()}),r.addEventListener("volumechange",()=>{_.volumeChange(r.volume)}),r.addEventListener("click",()=>{_.adUserInteraction("click")}),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","msfullscreenchange"].forEach(e=>{r.addEventListener(e,()=>{const e=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullScreen?"fullscreen":"normal";_.playerStateChange(e)})}),!0}return!1}catch(e){return this.errorHandler.fireError({category:"OmidJsManager",error:e,level:this.errorHandler.WARNING}),!1}}}(0,r.A)(s,"partnerName","TripleLift"),(0,r.A)(s,"partnerVersion","1.0.0"),(0,r.A)(s,"omidPartner",s.partnerName+"/"+s.partnerVersion)},687:(e,t,i)=>{"use strict";i.d(t,{B:()=>r,f:()=>n});const r={VIDEO_CONTROL:0,VIDEO_CLICK_BLOCK:0,VIDEO_LOGO:0,CAROUSEL_CIRCLE:1,NON_VIDEO_LOGO:1,CAROUSEL_ARROW:2,ADCHOICES:3,CTA_OVERLAY:3,REVEAL_TRIGGER:3,REVEAL_WRAPPER:4,REVEAL_CLOSE:5,VIDEO_PROGRESS_BAR:6,VIDEO_END_FRAME:7,PSA:8,HIGHLIGHT:9,DIAGNOSTIC_DATA:10},n=(e,t)=>e.getBaseZIndex()+t},704:(e,t,i)=>{"use strict";i.d(t,{Ay:()=>o,G_:()=>s,nI:()=>a});var r=i(705),n=i(201);const s={init:1,running:2,finished:3,success:4,fail:5},a={FIRST:1,SECOND:2};class o{constructor(e){(0,r.A)(this,"conditions",{}),(0,r.A)(this,"success",!1),(0,r.A)(this,"state",s.init),(0,r.A)(this,"priority",void 0),(0,r.A)(this,"fireFallbackCondition",void 0),this.eventController=e,this.fireFallbackCondition={fireFallbackAuction:!0},this.addCondition(this.fireFallbackCondition),this.playUnsubscribe=this.eventController.once(n.jK,()=>{this.avoidFallbackFunction()})}addCondition(e){this.conditions={...this.conditions,...e}}modifyCondition(e){const[t,i]=Object.entries(e)[0];void 0!==this.conditions[t]&&(this.conditions[t]=i)}avoidFallbackFunction(){this.fireFallbackCondition.fireFallbackAuction=!1,this.modifyCondition(this.fireFallbackCondition)}conditionsMet(){return Object.values(this.conditions).every(e=>e)}setCallback(e){this.callback=e}finish(){this.success?this.state=s.success:this.state=s.fail}verifySuccess(){this.success=!0}async run(){this.state=s.running,await this.callback(),this.finish()}destroy(){this.conditions={},this.state=s.init,this.playUnsubscribe()}}},705:(e,t,i)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function s(e,t,i){return(t=n(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,{A:()=>s})},743:(e,t,i)=>{"use strict";i.d(t,{PT:()=>d,vr:()=>c});i(309);const r="height",n="width",s=(e,t,i)=>{const s=i===r?n:r;if(!t[i]||!e[i])return{height:0,width:0};const a=e[i]/t[i];return{[i]:e[i],[s]:t[s]*a}},a=(e,t)=>s(e,t,r),o=(e,t)=>s(e,t,n),l=({height:e,width:t},{height:i,width:r})=>i<=e&&r<=t,c=(e,t)=>{const i=a(e,t);return l(e,i)?i:o(e,t)},d=(e,t)=>{if(!e.height||!t.height)return{x:0,y:0};const i=a(e,t);return l(e,i)?((e,t)=>({x:Math.ceil((e.width-t.width)/2)||0,y:0}))(e,i):((e,t)=>{const i=o(e,t);return{x:0,y:Math.ceil((e.height-i.height)/2)||0}})(e,t)}},754:()=>{(function(){"use strict";var e=window.Document.prototype.createElement,t=window.Document.prototype.createElementNS,i=window.Document.prototype.importNode,r=window.Document.prototype.prepend,n=window.Document.prototype.append,s=window.DocumentFragment.prototype.prepend,a=window.DocumentFragment.prototype.append,o=window.Node.prototype.cloneNode,l=window.Node.prototype.appendChild,c=window.Node.prototype.insertBefore,d=window.Node.prototype.removeChild,h=window.Node.prototype.replaceChild,u=Object.getOwnPropertyDescriptor(window.Node.prototype,"textContent"),p=window.Element.prototype.attachShadow,m=Object.getOwnPropertyDescriptor(window.Element.prototype,"innerHTML"),g=window.Element.prototype.getAttribute,f=window.Element.prototype.setAttribute,v=window.Element.prototype.removeAttribute,_=window.Element.prototype.toggleAttribute,y=window.Element.prototype.getAttributeNS,A=window.Element.prototype.setAttributeNS,I=window.Element.prototype.removeAttributeNS,w=window.Element.prototype.insertAdjacentElement,E=window.Element.prototype.insertAdjacentHTML,C=window.Element.prototype.prepend,b=window.Element.prototype.append,T=window.Element.prototype.before,S=window.Element.prototype.after,M=window.Element.prototype.replaceWith,R=window.Element.prototype.remove,P=window.HTMLElement,D=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML"),x=window.HTMLElement.prototype.insertAdjacentElement,N=window.HTMLElement.prototype.insertAdjacentHTML,L=new Set;function O(e){var t=L.has(e);return e=/^[a-z][.0-9_a-z]*-[-.0-9_a-z]*$/.test(e),!t&&e}"annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" ").forEach(function(e){return L.add(e)});var k=document.contains?document.contains.bind(document):document.documentElement.contains.bind(document.documentElement);function j(e){var t=e.isConnected;if(void 0!==t)return t;if(k(e))return!0;for(;e&&!(e.__CE_isImportDocument||e instanceof Document);)e=e.parentNode||(window.ShadowRoot&&e instanceof ShadowRoot?e.host:void 0);return!(!e||!(e.__CE_isImportDocument||e instanceof Document))}function F(e){var t=e.children;if(t)return Array.prototype.slice.call(t);for(t=[],e=e.firstChild;e;e=e.nextSibling)e.nodeType===Node.ELEMENT_NODE&&t.push(e);return t}function V(e,t){for(;t&&t!==e&&!t.nextSibling;)t=t.parentNode;return t&&t!==e?t.nextSibling:null}function H(e,t,i){for(var r=e;r;){if(r.nodeType===Node.ELEMENT_NODE){var n=r;t(n);var s=n.localName;if("link"===s&&"import"===n.getAttribute("rel")){if(r=n.import,void 0===i&&(i=new Set),r instanceof Node&&!i.has(r))for(i.add(r),r=r.firstChild;r;r=r.nextSibling)H(r,t,i);r=V(e,n);continue}if("template"===s){r=V(e,n);continue}if(n=n.__CE_shadowRoot)for(n=n.firstChild;n;n=n.nextSibling)H(n,t,i)}r=r.firstChild?r.firstChild:V(e,r)}}function B(){var e=!(null==le||!le.noDocumentConstructionObserver),t=!(null==le||!le.shadyDomFastWalk);this.m=[],this.g=[],this.j=!1,this.shadyDomFastWalk=t,this.I=!e}function W(e,t,i,r){var n=window.ShadyDOM;if(e.shadyDomFastWalk&&n&&n.inUse){if(t.nodeType===Node.ELEMENT_NODE&&i(t),t.querySelectorAll)for(e=n.nativeMethods.querySelectorAll.call(t,"*"),t=0;t<e.length;t++)i(e[t])}else H(t,i,r)}function U(e,t){e.j&&W(e,t,function(t){return z(e,t)})}function z(e,t){if(e.j&&!t.__CE_patched){t.__CE_patched=!0;for(var i=0;i<e.m.length;i++)e.m[i](t);for(i=0;i<e.g.length;i++)e.g[i](t)}}function G(e,t){var i=[];for(W(e,t,function(e){return i.push(e)}),t=0;t<i.length;t++){var r=i[t];1===r.__CE_state?e.connectedCallback(r):Z(e,r)}}function q(e,t){var i=[];for(W(e,t,function(e){return i.push(e)}),t=0;t<i.length;t++){var r=i[t];1===r.__CE_state&&e.disconnectedCallback(r)}}function Y(e,t,i){var r=(i=void 0===i?{}:i).J,n=i.upgrade||function(t){return Z(e,t)},s=[];for(W(e,t,function(t){if(e.j&&z(e,t),"link"===t.localName&&"import"===t.getAttribute("rel")){var i=t.import;i instanceof Node&&(i.__CE_isImportDocument=!0,i.__CE_registry=document.__CE_registry),i&&"complete"===i.readyState?i.__CE_documentLoadHandled=!0:t.addEventListener("load",function(){var i=t.import;if(!i.__CE_documentLoadHandled){i.__CE_documentLoadHandled=!0;var s=new Set;r&&(r.forEach(function(e){return s.add(e)}),s.delete(i)),Y(e,i,{J:s,upgrade:n})}})}else s.push(t)},r),t=0;t<s.length;t++)n(s[t])}function Z(e,t){try{var i=t.ownerDocument,r=i.__CE_registry,n=r&&(i.defaultView||i.__CE_isImportDocument)?ne(r,t.localName):void 0;if(n&&void 0===t.__CE_state){n.constructionStack.push(t);try{try{if(new n.constructorFunction!==t)throw Error("The custom element constructor did not produce the element being upgraded.")}finally{n.constructionStack.pop()}}catch(e){throw t.__CE_state=2,e}if(t.__CE_state=1,t.__CE_definition=n,n.attributeChangedCallback&&t.hasAttributes()){var s=n.observedAttributes;for(n=0;n<s.length;n++){var a=s[n],o=t.getAttribute(a);null!==o&&e.attributeChangedCallback(t,a,null,o,null)}}j(t)&&e.connectedCallback(t)}}catch(e){X(e)}}function Q(i,r,n,s){var a=r.__CE_registry;if(a&&(null===s||"http://www.w3.org/1999/xhtml"===s)&&(a=ne(a,n)))try{var o=new a.constructorFunction;if(void 0===o.__CE_state||void 0===o.__CE_definition)throw Error("Failed to construct '"+n+"': The returned value was not constructed with the HTMLElement constructor.");if("http://www.w3.org/1999/xhtml"!==o.namespaceURI)throw Error("Failed to construct '"+n+"': The constructed element's namespace must be the HTML namespace.");if(o.hasAttributes())throw Error("Failed to construct '"+n+"': The constructed element must not have any attributes.");if(null!==o.firstChild)throw Error("Failed to construct '"+n+"': The constructed element must not have any children.");if(null!==o.parentNode)throw Error("Failed to construct '"+n+"': The constructed element must not have a parent node.");if(o.ownerDocument!==r)throw Error("Failed to construct '"+n+"': The constructed element's owner document is incorrect.");if(o.localName!==n)throw Error("Failed to construct '"+n+"': The constructed element's local name is incorrect.");return o}catch(a){return X(a),r=null===s?e.call(r,n):t.call(r,s,n),Object.setPrototypeOf(r,HTMLUnknownElement.prototype),r.__CE_state=2,r.__CE_definition=void 0,z(i,r),r}return z(i,r=null===s?e.call(r,n):t.call(r,s,n)),r}function X(e){var t="",i="",r=0,n=0;e instanceof Error?(t=e.message,i=e.sourceURL||e.fileName||"",r=e.line||e.lineNumber||0,n=e.column||e.columnNumber||0):t="Uncaught "+String(e);var s=void 0;void 0===ErrorEvent.prototype.initErrorEvent?s=new ErrorEvent("error",{cancelable:!0,message:t,filename:i,lineno:r,colno:n,error:e}):((s=document.createEvent("ErrorEvent")).initErrorEvent("error",!1,!0,t,i,r),s.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{configurable:!0,get:function(){return!0}})}),void 0===s.error&&Object.defineProperty(s,"error",{configurable:!0,enumerable:!0,get:function(){return e}}),window.dispatchEvent(s),s.defaultPrevented||console.error(e)}function J(){var e=this;this.g=void 0,this.F=new Promise(function(t){e.l=t})}function K(e){var t=document;this.l=void 0,this.h=e,this.g=t,Y(this.h,this.g),"loading"===this.g.readyState&&(this.l=new MutationObserver(this.G.bind(this)),this.l.observe(this.g,{childList:!0,subtree:!0}))}function $(e){e.l&&e.l.disconnect()}function ee(e){this.s=new Map,this.u=new Map,this.C=new Map,this.A=!1,this.B=new Map,this.o=function(e){return e()},this.i=!1,this.v=[],this.h=e,this.D=e.I?new K(e):void 0}function te(e,t){if(!O(t))throw new SyntaxError("The element name '"+t+"' is not valid.");if(ne(e,t))throw Error("A custom element with name '"+t+"' has already been defined.");if(e.A)throw Error("A custom element is already being defined.")}function ie(e,t,i){var r;e.A=!0;try{var n=i.prototype;if(!(n instanceof Object))throw new TypeError("The custom element constructor's prototype is not an object.");var s=function(e){var t=n[e];if(void 0!==t&&!(t instanceof Function))throw Error("The '"+e+"' callback must be a function.");return t},a=s("connectedCallback"),o=s("disconnectedCallback"),l=s("adoptedCallback"),c=(r=s("attributeChangedCallback"))&&i.observedAttributes||[]}catch(e){throw e}finally{e.A=!1}return i={localName:t,constructorFunction:i,connectedCallback:a,disconnectedCallback:o,adoptedCallback:l,attributeChangedCallback:r,observedAttributes:c,constructionStack:[]},e.u.set(t,i),e.C.set(i.constructorFunction,i),i}function re(e){if(!1!==e.i){e.i=!1;for(var t=[],i=e.v,r=new Map,n=0;n<i.length;n++)r.set(i[n],[]);for(Y(e.h,document,{upgrade:function(i){if(void 0===i.__CE_state){var n=i.localName,s=r.get(n);s?s.push(i):e.u.has(n)&&t.push(i)}}}),n=0;n<t.length;n++)Z(e.h,t[n]);for(n=0;n<i.length;n++){for(var s=i[n],a=r.get(s),o=0;o<a.length;o++)Z(e.h,a[o]);(s=e.B.get(s))&&s.resolve(void 0)}i.length=0}}function ne(e,t){var i=e.u.get(t);if(i)return i;if(i=e.s.get(t)){e.s.delete(t);try{return ie(e,t,i())}catch(e){X(e)}}}function se(e,t,i){function r(t){return function(i){for(var r=[],n=0;n<arguments.length;++n)r[n]=arguments[n];n=[];for(var s=[],a=0;a<r.length;a++){var o=r[a];if(o instanceof Element&&j(o)&&s.push(o),o instanceof DocumentFragment)for(o=o.firstChild;o;o=o.nextSibling)n.push(o);else n.push(o)}for(t.apply(this,r),r=0;r<s.length;r++)q(e,s[r]);if(j(this))for(r=0;r<n.length;r++)(s=n[r])instanceof Element&&G(e,s)}}void 0!==i.prepend&&(t.prepend=r(i.prepend)),void 0!==i.append&&(t.append=r(i.append))}function ae(e){function i(t,i){Object.defineProperty(t,"innerHTML",{enumerable:i.enumerable,configurable:!0,get:i.get,set:function(t){var r=this,n=void 0;if(j(this)&&(n=[],W(e,this,function(e){e!==r&&n.push(e)})),i.set.call(this,t),n)for(var s=0;s<n.length;s++){var a=n[s];1===a.__CE_state&&e.disconnectedCallback(a)}return this.ownerDocument.__CE_registry?Y(e,this):U(e,this),t}})}function r(t,i){t.insertAdjacentElement=function(t,r){var n=j(r);return t=i.call(this,t,r),n&&q(e,r),j(t)&&G(e,r),t}}function n(t,i){function r(t,i){for(var r=[];t!==i;t=t.nextSibling)r.push(t);for(i=0;i<r.length;i++)Y(e,r[i])}t.insertAdjacentHTML=function(e,t){if("beforebegin"===(e=e.toLowerCase())){var n=this.previousSibling;i.call(this,e,t),r(n||this.parentNode.firstChild,this)}else if("afterbegin"===e)n=this.firstChild,i.call(this,e,t),r(this.firstChild,n);else if("beforeend"===e)n=this.lastChild,i.call(this,e,t),r(n||this.firstChild,null);else{if("afterend"!==e)throw new SyntaxError("The value provided ("+String(e)+") is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'.");n=this.nextSibling,i.call(this,e,t),r(this.nextSibling,n)}}}p&&(Element.prototype.attachShadow=function(t){if(t=p.call(this,t),e.j&&!t.__CE_patched){t.__CE_patched=!0;for(var i=0;i<e.m.length;i++)e.m[i](t)}return this.__CE_shadowRoot=t}),m&&m.get?i(Element.prototype,m):D&&D.get?i(HTMLElement.prototype,D):function(e,t){e.j=!0,e.g.push(t)}(e,function(e){i(e,{enumerable:!0,configurable:!0,get:function(){return o.call(this,!0).innerHTML},set:function(e){var i="template"===this.localName,r=i?this.content:this,n=t.call(document,this.namespaceURI,this.localName);for(n.innerHTML=e;0<r.childNodes.length;)d.call(r,r.childNodes[0]);for(e=i?n.content:n;0<e.childNodes.length;)l.call(r,e.childNodes[0])}})}),Element.prototype.setAttribute=function(t,i){if(1!==this.__CE_state)return f.call(this,t,i);var r=g.call(this,t);f.call(this,t,i),i=g.call(this,t),e.attributeChangedCallback(this,t,r,i,null)},Element.prototype.setAttributeNS=function(t,i,r){if(1!==this.__CE_state)return A.call(this,t,i,r);var n=y.call(this,t,i);A.call(this,t,i,r),r=y.call(this,t,i),e.attributeChangedCallback(this,i,n,r,t)},Element.prototype.removeAttribute=function(t){if(1!==this.__CE_state)return v.call(this,t);var i=g.call(this,t);v.call(this,t),null!==i&&e.attributeChangedCallback(this,t,i,null,null)},_&&(Element.prototype.toggleAttribute=function(t,i){if(1!==this.__CE_state)return _.call(this,t,i);var r=g.call(this,t);return null!==r!==(i=_.call(this,t,i))&&e.attributeChangedCallback(this,t,r,i?"":null,null),i}),Element.prototype.removeAttributeNS=function(t,i){if(1!==this.__CE_state)return I.call(this,t,i);var r=y.call(this,t,i);I.call(this,t,i);var n=y.call(this,t,i);r!==n&&e.attributeChangedCallback(this,i,r,n,t)},x?r(HTMLElement.prototype,x):w&&r(Element.prototype,w),N?n(HTMLElement.prototype,N):E&&n(Element.prototype,E),se(e,Element.prototype,{prepend:C,append:b}),function(e){function t(t){return function(i){for(var r=[],n=0;n<arguments.length;++n)r[n]=arguments[n];n=[];for(var s=[],a=0;a<r.length;a++){var o=r[a];if(o instanceof Element&&j(o)&&s.push(o),o instanceof DocumentFragment)for(o=o.firstChild;o;o=o.nextSibling)n.push(o);else n.push(o)}for(t.apply(this,r),r=0;r<s.length;r++)q(e,s[r]);if(j(this))for(r=0;r<n.length;r++)(s=n[r])instanceof Element&&G(e,s)}}var i=Element.prototype;void 0!==T&&(i.before=t(T)),void 0!==S&&(i.after=t(S)),void 0!==M&&(i.replaceWith=function(t){for(var i=[],r=0;r<arguments.length;++r)i[r]=arguments[r];r=[];for(var n=[],s=0;s<i.length;s++){var a=i[s];if(a instanceof Element&&j(a)&&n.push(a),a instanceof DocumentFragment)for(a=a.firstChild;a;a=a.nextSibling)r.push(a);else r.push(a)}for(s=j(this),M.apply(this,i),i=0;i<n.length;i++)q(e,n[i]);if(s)for(q(e,this),i=0;i<r.length;i++)(n=r[i])instanceof Element&&G(e,n)}),void 0!==R&&(i.remove=function(){var t=j(this);R.call(this),t&&q(e,this)})}(e)}B.prototype.connectedCallback=function(e){var t=e.__CE_definition;if(t.connectedCallback)try{t.connectedCallback.call(e)}catch(e){X(e)}},B.prototype.disconnectedCallback=function(e){var t=e.__CE_definition;if(t.disconnectedCallback)try{t.disconnectedCallback.call(e)}catch(e){X(e)}},B.prototype.attributeChangedCallback=function(e,t,i,r,n){var s=e.__CE_definition;if(s.attributeChangedCallback&&-1<s.observedAttributes.indexOf(t))try{s.attributeChangedCallback.call(e,t,i,r,n)}catch(e){X(e)}},J.prototype.resolve=function(e){if(this.g)throw Error("Already resolved.");this.g=e,this.l(e)},K.prototype.G=function(e){var t=this.g.readyState;for("interactive"!==t&&"complete"!==t||$(this),t=0;t<e.length;t++)for(var i=e[t].addedNodes,r=0;r<i.length;r++)Y(this.h,i[r])},ee.prototype.H=function(e,t){var i=this;if(!(t instanceof Function))throw new TypeError("Custom element constructor getters must be functions.");te(this,e),this.s.set(e,t),this.v.push(e),this.i||(this.i=!0,this.o(function(){return re(i)}))},ee.prototype.define=function(e,t){var i=this;if(!(t instanceof Function))throw new TypeError("Custom element constructors must be functions.");te(this,e),ie(this,e,t),this.v.push(e),this.i||(this.i=!0,this.o(function(){return re(i)}))},ee.prototype.upgrade=function(e){Y(this.h,e)},ee.prototype.get=function(e){if(e=ne(this,e))return e.constructorFunction},ee.prototype.whenDefined=function(e){if(!O(e))return Promise.reject(new SyntaxError("'"+e+"' is not a valid custom element name."));var t=this.B.get(e);if(t)return t.F;t=new J,this.B.set(e,t);var i=this.u.has(e)||this.s.has(e);return e=-1===this.v.indexOf(e),i&&e&&t.resolve(void 0),t.F},ee.prototype.polyfillWrapFlushCallback=function(e){this.D&&$(this.D);var t=this.o;this.o=function(i){return e(function(){return t(i)})}},ee.prototype.define=ee.prototype.define,ee.prototype.upgrade=ee.prototype.upgrade,ee.prototype.get=ee.prototype.get,ee.prototype.whenDefined=ee.prototype.whenDefined,ee.prototype.polyfillDefineLazy=ee.prototype.H,ee.prototype.polyfillWrapFlushCallback=ee.prototype.polyfillWrapFlushCallback;var oe={};var le=window.customElements;function ce(){var t=new B;!function(t){function i(){var i=this.constructor,r=document.__CE_registry.C.get(i);if(!r)throw Error("Failed to construct a custom element: The constructor was not registered with `customElements`.");var n=r.constructionStack;if(0===n.length)return n=e.call(document,r.localName),Object.setPrototypeOf(n,i.prototype),n.__CE_state=1,n.__CE_definition=r,z(t,n),n;var s=n.length-1,a=n[s];if(a===oe)throw Error("Failed to construct '"+r.localName+"': This element was already constructed.");return n[s]=oe,Object.setPrototypeOf(a,i.prototype),z(t,a),a}i.prototype=P.prototype,Object.defineProperty(HTMLElement.prototype,"constructor",{writable:!0,configurable:!0,enumerable:!1,value:i}),window.HTMLElement=i}(t),function(e){Document.prototype.createElement=function(t){return Q(e,this,t,null)},Document.prototype.importNode=function(t,r){return t=i.call(this,t,!!r),this.__CE_registry?Y(e,t):U(e,t),t},Document.prototype.createElementNS=function(t,i){return Q(e,this,i,t)},se(e,Document.prototype,{prepend:r,append:n})}(t),se(t,DocumentFragment.prototype,{prepend:s,append:a}),function(e){function t(t,i){Object.defineProperty(t,"textContent",{enumerable:i.enumerable,configurable:!0,get:i.get,set:function(t){if(this.nodeType===Node.TEXT_NODE)i.set.call(this,t);else{var r=void 0;if(this.firstChild){var n=this.childNodes,s=n.length;if(0<s&&j(this)){r=Array(s);for(var a=0;a<s;a++)r[a]=n[a]}}if(i.set.call(this,t),r)for(t=0;t<r.length;t++)q(e,r[t])}}})}Node.prototype.insertBefore=function(t,i){if(t instanceof DocumentFragment){var r=F(t);if(t=c.call(this,t,i),j(this))for(i=0;i<r.length;i++)G(e,r[i]);return t}return r=t instanceof Element&&j(t),i=c.call(this,t,i),r&&q(e,t),j(this)&&G(e,t),i},Node.prototype.appendChild=function(t){if(t instanceof DocumentFragment){var i=F(t);if(t=l.call(this,t),j(this))for(var r=0;r<i.length;r++)G(e,i[r]);return t}return i=t instanceof Element&&j(t),r=l.call(this,t),i&&q(e,t),j(this)&&G(e,t),r},Node.prototype.cloneNode=function(t){return t=o.call(this,!!t),this.ownerDocument.__CE_registry?Y(e,t):U(e,t),t},Node.prototype.removeChild=function(t){var i=t instanceof Element&&j(t),r=d.call(this,t);return i&&q(e,t),r},Node.prototype.replaceChild=function(t,i){if(t instanceof DocumentFragment){var r=F(t);if(t=h.call(this,t,i),j(this))for(q(e,i),i=0;i<r.length;i++)G(e,r[i]);return t}r=t instanceof Element&&j(t);var n=h.call(this,t,i),s=j(this);return s&&q(e,i),r&&q(e,t),s&&G(e,t),n},u&&u.get?t(Node.prototype,u):function(e,t){e.j=!0,e.m.push(t)}(e,function(e){t(e,{enumerable:!0,configurable:!0,get:function(){for(var e=[],t=this.firstChild;t;t=t.nextSibling)t.nodeType!==Node.COMMENT_NODE&&e.push(t.textContent);return e.join("")},set:function(e){for(;this.firstChild;)d.call(this,this.firstChild);null!=e&&""!==e&&l.call(this,document.createTextNode(e))}})})}(t),ae(t),window.CustomElementRegistry=ee,t=new ee(t),document.__CE_registry=t,Object.defineProperty(window,"customElements",{configurable:!0,enumerable:!0,value:t})}le&&!le.forcePolyfill&&"function"==typeof le.define&&"function"==typeof le.get||ce(),window.__CE_installPolyfill=ce}).call(self)},980:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var r=i(705),n=i(541);class s extends Error{constructor(e,t=n.A.ERROR){super(e),(0,r.A)(this,"errorLevel",null),this.errorLevel=t}}}},r={};function n(e){var t=r[e];if(void 0!==t)return t.exports;var s=r[e]={exports:{}};return i[e](s,s.exports,n),s.exports}n.m=i,n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,i)=>(n.f[i](e,t),t),[])),n.u=e=>e+".js",n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="ib1419:",n.l=(i,r,s,a)=>{if(e[i])e[i].push(r);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var h=c[d];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==t+s){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=i),e[i]=[r];var u=(t,r)=>{o.onerror=o.onload=null,clearTimeout(p);var n=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach(e=>e(r)),t)return t(r)},p=setTimeout(u.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=u.bind(null,o.onerror),o.onload=u.bind(null,o.onload),l&&document.head.appendChild(o)}},n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="",(()=>{var e={23:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var s=new Promise((i,n)=>r=e[t]=[i,n]);i.push(r[2]=s);var a=n.p+n.u(t),o=new Error;n.l(a,i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,r[1](o)}},"chunk-"+t,t)}};var t=(t,i)=>{var r,s,a=i[0],o=i[1],l=i[2],c=0;if(a.some(t=>0!==e[t])){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(l)l(n)}for(t&&t(i);c<a.length;c++)s=a[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},i=self.tlJsonp1419=self.tlJsonp1419||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),(()=>{"use strict";n(754);var e=n(329),t=n(634),i=n(388),r=n(592),s=n(201);const a={click_cta:1,page_flip_left:2,page_flip_right:3,scroll:4,mute:5,unmute:6,expand:7,collapse:8,click_paused:9,transition_up:10,transition_down:11,direction_change:12,reveal_trigger:13,pause:14,resume:15,fullscreen:16,fullscreen_exit:17,skip:18,zoom:19,pan:20},o=2,l=3;class c{constructor({environment:e,pageInfo:t,placement:i,dco:r},{creative:n,lifecycleManager:s,thirdPartyAnalytics:a,payableEventEmitter:o,firePix:l,errorHandler:c,asyncUtil:d,eventController:h,gdpr:u}){this.pageInfo=t,this.environment=e,this.asyncUtil=d,this.creative=n,this.priceMacroValue=n.params.additional_data.pr,this.lifecycleManager=s,this.thirdPartyAnalytics=a,this.payableEventEmitter=o,this.firePix=l,this.fireEB=l.fireEB.bind(l),this.errorHandler=c,this.viewedCreativeElements={},this.hasFired={render:!1,play:!1,playAttempt:!1,onePxViewable:!1,viewable:!1,inFocus:!1,tlUidAudit:!1},this.eventController=h,this.placement=i,this.dco=r,this.gdpr=u,this.loadCreativeParams()}loadCreativeParams(){var e;this.thirdPartyAnalytics.billOrWait(),this.creativeParams=this.creative.params.additional_data||{},this.creativeParams.caid=this.creative.params.asset_id,this.creativeParams.unid=0;const{retailerId:t,skus:i}=this.creative.params;this.rParams={...this.creativeParams,...(0,r.km)(this.pageInfo.get()),rr:null!==(e=this.dco)&&void 0!==e&&e.isFallback?"creative_dco_fallback":"creative",fid:this.creative.params.format_id||0,rb:this.creative.params.render_options_bm||0,g:this.creative.params.ghost?1:0,tmplid:this.placement.templateId,rid:t||0},Array.isArray(i)&&i.length>0&&(this.rParams.skus=i.join(","));const n=this.environment.formats;this.creative.params.format_id===n.video&&(this.videoLengthMS=1e3*this.creative.params.length_seconds),this.disclosure=this.creative.params.disclosure,this.passedUid=this.creative.params.passedTlUid}render(){if(!this.hasFired.render)try{const t=()=>{this.errorHandler.fireError({category:"Analytics Render",error:"render tracker error",level:this.errorHandler.INFO})};this.fireEB(e.Z_,this.rParams,t),this.thirdParty(),this.payableEventEmitter.render(),this.hasFired.render=!0,this.lifecycleManager.setPhaseAfterRender(this.creative.formatManager.isAutoplayVideo()),setTimeout(()=>{this._domRefs&&this._positionService&&this._logVisibilityAndSqueeze(this._domRefs,this._positionService,"render")},100)}catch(e){this.errorHandler.fireError({category:"Analytics Render",error:"analytics error",level:this.errorHandler.ERROR,diagnosticContext:{errorMessage:e.toString()}})}}auditTlUid(){if(!this.passedUid||this.hasFired.tlUidAudit)return;this.hasFired.tlUidAudit=!0;let t=this.getEngagementParams();t||(t={}),t.ptuid=this.passedUid,t.pubId=this.placement.publisherId,this.fireEB(e.$j,t)}viewable(){if(this.hasFired.viewable)return;this.hasFired.viewable=!0;const t=this.rParams.skus?{...this.getEngagementParams(),skus:this.rParams.skus}:this.getEngagementParams();this.fireEB(e.Pl,t),this.thirdPartyAnalytics.fireViewable(),this.payableEventEmitter.viewable(),this._domRefs&&this._positionService&&this._logVisibilityAndSqueeze(this._domRefs,this._positionService,"viewable")}adOnPage(){this.fireEB(e.Ol,this.rParams)}onePxViewable(){this.hasFired.onePxViewable||(this.hasFired.onePxViewable=!0,this.fireEB(e.Er,this.getEngagementParams()),this.thirdPartyAnalytics.fireOnePxViewable(),this.payableEventEmitter.onePxViewable())}elementViewable(t,i){this.viewedCreativeElements[t]||(this.fireEB(e.rk,this.getEngagementParams({creativeElementId:t,imagePosition:i})),this.viewedCreativeElements[t]=!0)}twoSecondViewable(){this.fireEB(e.oO)}playAttempt(){this.hasFired.playAttempt||(this.hasFired.playAttempt=!0,this.fireEB(e.xw,{format_id:this.creative.params.format_id||0,tactic_id:this.creative.params.additional_data.tid||0,dmp_ids:this.creative.params.additional_data.dmp_ids||"",ceid:this.creative.params.image_id||0}))}getEngagementParams({creativeElementId:e,imagePosition:t=0,assetTypeId:i,sku:r}={}){const n=e||this.creative.params.image_id||0,{rid:s}=this.rParams,a={...this.creativeParams,cepos:t,ceid:n};return s&&(a.rid=s),null!=r&&(a.skus=r),i&&(a.atid=i),a}mouseover(t,i){this.fireEB(e.wk,this.getEngagementParams({creativeElementId:t,imagePosition:i}))}click({creativeElementId:t,imagePosition:i,assetTypeId:r,sku:n}={}){"AUDIT"!==this.priceMacroValue&&(this.fireEB(e.Rt,this.getEngagementParams({creativeElementId:t,imagePosition:i,assetTypeId:r,sku:n})),this.thirdPartyAnalytics.fireClick(i),this.fireClickDyn(),this.fireUserTrackingPixel(3006))}fireClickDyn(){var e,t,r,n,s,a,o,l,c,d,h,u,p,m,g,f,v;const _={placementId:null===(e=this.placement)||void 0===e?void 0:e.id,creativeId:null===(t=this.creative)||void 0===t||null===(r=t.creativePayload)||void 0===r||null===(n=r.ad)||void 0===n||null===(s=n.ext)||void 0===s||null===(a=s.tlAdditionalData)||void 0===a?void 0:a.crid,tactic:null===(o=this.creative)||void 0===o||null===(l=o.creativePayload)||void 0===l||null===(c=l.ad)||void 0===c||null===(d=c.ext)||void 0===d||null===(h=d.tlAdditionalData)||void 0===h?void 0:h.tid,templateId:null===(u=this.placement)||void 0===u?void 0:u.templateId,userAgent:null===(p=this.pageInfo)||void 0===p||null===(m=p.docInfo)||void 0===m||null===(g=m.navigator)||void 0===g?void 0:g.userAgent},y={string2:JSON.stringify(_),string3:this._getUrlWithoutParams(null===(f=this.pageInfo)||void 0===f||null===(v=f.cachedPageInfo)||void 0===v?void 0:v.ref),long1:i.mR};this.firePix.fireDyn(y)}async fireUserTrackingPixel(t){const i={add:t},r=await this.getCmpConsentString();r&&(i.cmp_cs=r),this.fireEB(e.dQ,i)}async getCmpConsentString(){var e,t;return this.gdpr?(await this.gdpr.getCMPData(),null===(e=this.gdpr)||void 0===e||null===(t=e.cmpData)||void 0===t?void 0:t.consentString):null}getRedirectClickUrl(t,i){const r=this.getEngagementParams({creativeElementId:t,imagePosition:i});return this.firePix.getEBUrl(e.Rt,r)+"&rdir="}appendThirdPartyJs(e){this.creative.params.ghost||this.thirdPartyAnalytics.appendJsOnPassthru(e)}duration(t,i,n,a,o){const l=c.getVideoLength(i,n);if(isNaN(t)||!l.value)return;const d={...this.creativeParams,duration:t,video_length:l.value,vlt:l.type,vsrc:a,isvp:this.creative.isVpaid()};t>0&&!this.hasFired.play&&(this.thirdPartyAnalytics.firePlay(),this.payableEventEmitter.videoStart(),this.hasFired.play=!0,this.eventController.publish(s.jK),d.start=1,this.hasFired.playAttempt||this.playAttempt(),this.lifecycleManager.setPhaseAfterVideoStart()),(0,r.Et)(o)&&o>=.5&&(d.iv=1),this.fireEB(e.dK,d)}static getVideoLength(e,t){let i,r;return e&&e>0?(i=e,r=o):(i=t,r=l),{value:i,type:r}}play(){this.fireUserTrackingPixel(3007)}ctaRenderResult(t){this.fireEB(e.uR,t)}disclosureRenderResult(){if(this.disclosure){const t={disclosure_render_method:this.disclosure.render_method,disclosure_render_text:this.disclosure.text};this.fireEB(e.lB,t)}}thirdParty(){this.creative.params.ghost||(this.creative.formatManager.isCarousel()?this.thirdPartyAnalytics.fireCarouselImpression():this.thirdPartyAnalytics.fireImpression())}fireEEE(t,i=1){this.fireEB(e.lC,{eid:a[t],unid:this.creativeParams.unid||0,ev:i})}fireGpidInvestigationPixel(e){var t,r,n,s,a,o,l,c,d,h,u,p,m,g,f,v,_;const y=this._getElementXPath(null==e?void 0:e.adWrapper),A={placementId:null===(t=this.placement)||void 0===t?void 0:t.id,creativeId:null===(r=this.creative)||void 0===r||null===(n=r.creativePayload)||void 0===n||null===(s=n.ad)||void 0===s||null===(a=s.ext)||void 0===a||null===(o=a.tlAdditionalData)||void 0===o?void 0:o.crid,templateId:null===(l=this.placement)||void 0===l?void 0:l.templateId,buyerId:null===(c=this.creative)||void 0===c||null===(d=c.creativePayload)||void 0===d||null===(h=d.ad)||void 0===h||null===(u=h.ext)||void 0===u||null===(p=u.tlAdditionalData)||void 0===p?void 0:p.bmid,userAgent:null===(m=this.pageInfo)||void 0===m||null===(g=m.docInfo)||void 0===g||null===(f=g.navigator)||void 0===f?void 0:f.userAgent,gpid:null===(v=this.creative)||void 0===v?void 0:v.getPassedGpid(),xpath:y.length>950?y.slice(-950):y},I={string2:JSON.stringify(A),string3:this._getUrlWithoutParams(null===(_=this.pageInfo)||void 0===_?void 0:_.cachedPageInfo.ref),long1:i.Lj,long2:this.videoPlayed?1:0,long3:this.adStartedByVpaid?1:0};this.firePix.fireDyn(I)}initializeVisibilityLogging(e,t,i){this._domRefs=e,this._positionService=t,this._browserDetector=i,this._initialLogTime||(this._initialLogTime=performance.now()),this._logVisibilityAndSqueeze(e,t,"init"),this._setupPeriodicVisibilityChecks()}_setupPeriodicVisibilityChecks(){[1e3,3e3,5e3,1e4].forEach(e=>{setTimeout(()=>{if(this._domRefs&&this._positionService){const t=e/1e3;this._logVisibilityAndSqueeze(this._domRefs,this._positionService,"periodic_"+t+"s")}},e)})}fireCTRInvestigationPixel(e,t,i,r){this.creative.formatManager.isComponentVideo()&&this.eventController.on(s.Gz,()=>{this.initializeVisibilityLogging(e,t,i),this._logResizeInfo(e,t,i,r)})}_logResizeInfo(e,t,n,s){var a,o,l,c,d,h;const{adWrapperWithDims:u,video:p,mainImage:m}=e,g=p||m,f=g&&t.getElDims(g),v=(null==g?void 0:g.src)||(null==g||null===(a=g.source)||void 0===a?void 0:a.src)||"",_=null===(o=this.pageInfo)||void 0===o||null===(l=o.docInfo)||void 0===l||null===(c=l.window)||void 0===c?void 0:c.frameElement,y=_&&t.getElDims(_),A=this.pageInfo.docInfo.navigator.userAgent,I=n.getBrowserInfo(A),w=t.getElDims(u),E=t.getElDims(u.parentElement),C={placementId:this.pageInfo.placement.id,creativeId:this.creative.params.additional_data.crid,deviceType:n.getDeviceType(),browser:Object.keys(I).filter(e=>!0===I[e]).join(","),inventoryType:(0,r.bf)()?"App":"Web",tacticId:this.creative.params.additional_data.tid,publisherURL:this._getUrlWithoutParams(null===(d=this.pageInfo)||void 0===d||null===(h=d.cachedPageInfo)||void 0===h?void 0:h.ref)},b={string2:JSON.stringify(C),string3:JSON.stringify({iframe_w:null==y?void 0:y.width,iframe_h:null==y?void 0:y.height,template_w:E.width,template_h:E.height,ad_w:w.width,ad_h:w.height,media_w:(null==f?void 0:f.width)||(null==g?void 0:g.naturalWidth),media_h:(null==f?void 0:f.height)||(null==g?void 0:g.naturalHeight),media_src:encodeURIComponent(v),newRenderMethodEnabled:!!s}),long1:i.a8,long2:this.creative.params.format_id,long3:this.creative.params.template_id};this.firePix.fireDyn(b)}_logVisibilityAndSqueeze(e,t,r){try{var n,s,a,o,l;const c=performance.now(),d=Math.round(c/1e3*100)/100,h=this._initialLogTime?Math.round((c-this._initialLogTime)/1e3*100)/100:0,{adWrapperWithDims:u,video:p,mainImage:m}=e,g=null===(n=this.pageInfo)||void 0===n||null===(s=n.docInfo)||void 0===s||null===(a=s.window)||void 0===a?void 0:a.frameElement,f={trigger:r,timing:{timestamp:Date.now(),secondsSincePageLoad:d,secondsSinceInit:h,performanceNow:c},placementId:this.pageInfo.placement.id,creativeId:this.creative.params.additional_data.crid,iframe:this._getIframeVisibilityInfo(g,t),adWrapper:this._getElementVisibilityInfo(u,t,"adWrapper"),media:this._getElementVisibilityInfo(p||m,t,"media"),parentContainer:this._getElementVisibilityInfo(null==u?void 0:u.parentElement,t,"parentContainer"),page:this._getPageVisibilityInfo()},v={string2:JSON.stringify(f),string3:JSON.stringify({userAgent:this.pageInfo.docInfo.navigator.userAgent,url:this._getUrlWithoutParams(null===(o=this.pageInfo)||void 0===o||null===(l=o.cachedPageInfo)||void 0===l?void 0:l.ref),trigger:r,timing:f.timing}),long1:i.BS,long2:this.creative.params.format_id,long3:this.creative.params.template_id};this.firePix.fireDyn(v),this.environment.debug&&this.errorHandler.fireError({category:"Visibility And Squeeze Error",error:"Visibility Debug - "+r+" ("+d+"s)",level:this.errorHandler.INFO,diagnosticContext:f})}catch(e){this.errorHandler.fireError({category:"Visibility And Squeeze Error",error:"Visibility Logging Error",level:this.errorHandler.ERROR,diagnosticContext:{errorMessage:e.toString()}})}}_getIframeVisibilityInfo(e,t){if(!e)return{exists:!1,reason:"no_frame_element"};const i=t.getElDims(e),r=window.getComputedStyle(e),n=e.getBoundingClientRect();return{exists:!0,dimensions:i,boundingRect:{width:n.width,height:n.height,top:n.top,left:n.left,bottom:n.bottom,right:n.right},style:{display:r.display,visibility:r.visibility,opacity:r.opacity,position:r.position,zIndex:r.zIndex,overflow:r.overflow,maxWidth:r.maxWidth,maxHeight:r.maxHeight,minWidth:r.minWidth,minHeight:r.minHeight,transform:r.transform},attributes:{width:e.getAttribute("width"),height:e.getAttribute("height"),style:e.getAttribute("style"),class:e.getAttribute("class"),id:e.getAttribute("id")},isHidden:this._isElementHidden(e),isSqueezed:this._isElementSqueezed(e,i)}}_getElementVisibilityInfo(e,t,i){if(!e)return{exists:!1,elementType:i,reason:"no_element"};const r=t.getElDims(e),n=window.getComputedStyle(e),s=e.getBoundingClientRect();return{exists:!0,elementType:i,dimensions:r,boundingRect:{width:s.width,height:s.height},style:{display:n.display,visibility:n.visibility,opacity:n.opacity,position:n.position,zIndex:n.zIndex,overflow:n.overflow,maxWidth:n.maxWidth,maxHeight:n.maxHeight,width:n.width,height:n.height},isHidden:this._isElementHidden(e),isSqueezed:this._isElementSqueezed(e,r),parentHidden:!!e.parentElement&&this._isElementHidden(e.parentElement)}}_getPageVisibilityInfo(){return{documentHidden:document.hidden,visibilityState:document.visibilityState,windowFocused:document.hasFocus(),viewport:{width:window.innerWidth,height:window.innerHeight}}}_isElementHidden(e){if(!e)return!0;const t=window.getComputedStyle(e),i=e.getBoundingClientRect(),r={displayNone:"none"===t.display,visibilityHidden:"hidden"===t.visibility,opacityZero:0===parseFloat(t.opacity),zeroWidth:0===i.width,zeroHeight:0===i.height,offScreen:i.bottom<0||i.right<0||i.left>window.innerWidth||i.top>window.innerHeight};return!!(r.displayNone||r.visibilityHidden||r.opacityZero||r.zeroWidth&&r.zeroHeight)&&{...r,overall:!0}}_isElementSqueezed(e,t){if(!e||!t)return!1;const i=e.getBoundingClientRect(),r=i.width<200,n=i.height<150;if(!(r||n))return!1;const s=window.getComputedStyle(e);return{squeezed:!0,widthSqueezed:r,heightSqueezed:n,actualSize:{width:i.width,height:i.height},expectedMinSize:{width:200,height:150},hasMaxWidthConstraint:s.maxWidth&&"none"!==s.maxWidth,hasMaxHeightConstraint:s.maxHeight&&"none"!==s.maxHeight,maxWidthValue:s.maxWidth,maxHeightValue:s.maxHeight,parentConstraints:this._getParentConstraints(e)}}_getParentConstraints(e){const t=[];let i=e.parentElement,r=0;for(;i&&r<2;){const e=window.getComputedStyle(i),n=i.getBoundingClientRect();(n.width<300||n.height<200||"none"!==e.maxWidth||"none"!==e.maxHeight||"hidden"===e.overflow)&&t.push({level:r,tagName:i.tagName,className:i.className,size:{width:n.width,height:n.height},maxWidth:e.maxWidth,maxHeight:e.maxHeight,overflow:e.overflow,position:e.position}),i=i.parentElement,r++}return t}_getUrlWithoutParams(e){try{if(!e)return"";const t=new URL(e);return t.origin+t.pathname}catch(e){return""}}_getElementXPath(e){let t=e;const i=[];for(;t&&1===t.nodeType;){var r,n,s,a;let e=1,o=t.previousSibling;for(;o;)1===o.nodeType&&o.nodeName===t.nodeName&&e++,o=o.previousSibling;const l=(null===(r=t.nodeName)||void 0===r?void 0:r.toLowerCase())+"["+e+"]";i.unshift(l),t=t.parentElement||(null===(n=t)||void 0===n||null===(s=n.ownerDocument)||void 0===s||null===(a=s.defaultView)||void 0===a?void 0:a.frameElement)}return"/"+i.join("/")}static sendAdReadySignal(){if(function(){const e=document.getElementById(t.hj+"app");return e&&e.classList.contains("ad-ready-signal")}()){const e=document.createElement("IFRAME");e.setAttribute("src","js-3lift:ad_ready"),document.documentElement.appendChild(e),e.parentNode.removeChild(e)}}get disclosure(){return this._disclosure}set disclosure(e){this._disclosure=e}}class d{constructor({placement:e,environment:t,specifiedTacticId:i,isAdServing:r,rev:n,gdpr:s,docInfo:a,isFallback:o,fallbackBannerSize:l},{pageInfo:c,asyncUtil:d,urlParams:h,firePix:u,errorHandler:p}){this.placement=e,this.environment=t,this.urlParams=h,this.pageInfo=c,this.docInfo=a,this.asyncUtil=d,this.isAdServing=r,this.rev=n,this.specifiedTacticId=i,this.gdpr=s,this.isFallback=o,this.fallbackBannerSize=l,this.firePix=u,this.errorHandler=p}async buildAuctionPath(){const e=this.getAuctionHostName(this.isAdServing&&this.specifiedTacticId);return this.buildDefaultAuctionPath(e)}getAuctionHostName(e=!1){const{environment:{tlxStagingRate:t,tlxHost:i}}=this;let n=i;return t&&Math.random()<t&&(n="staging-"+n),this.urlParams.forceBidUrl?(0,r.sT)("//"+this.environment.qaHost+"/qa"):this.urlParams.tlBidUrl?(0,r.sT)("//"+this.urlParams.tlBidUrl):e?(0,r.sT)("//"+n+"/web/adserving"):(0,r.sT)("//"+n+"/web/auction")}async buildDefaultAuctionPath(e){const{customOptions:{numCreatives:t=1}}=this.placement,i=["inv_code="+encodeURIComponent(this.placement.invCode),"referrer="+encodeURIComponent(this.pageInfo.get().ref),"rev="+encodeURIComponent(this.rev),"fe="+encodeURIComponent((0,r.Gz)()?"1":"0"),"ft="+encodeURIComponent(this.pageInfo.getFrameType()),"cb="+(0,r.ye)(10)];if(this.isAdServing&&this.specifiedTacticId&&(i.push("tid="+encodeURIComponent(this.specifiedTacticId)),i.push("n="+encodeURIComponent(t.toString()))),this.placement.demandEnabled||this.urlParams.debugFlag||i.push("dd=1"),this.isFallback){this.firePix.auctionId&&i.push("original_auction_id="+encodeURIComponent(this.firePix.auctionId));const{width:e,height:t}=this.fallbackBannerSize,r=e+"x"+t;d.hasValidSize(e,t)?i.push("size="+r):this.errorHandler.fireError({category:"Default Auction Path Builder",error:"Invalid size for fallback auction",level:this.errorHandler.WARNING,diagnosticContext:{size:r}})}return this.needsAqp()&&i.push(d.getAqpParam()),this.gdpr&&(await this.gdpr.getCMPData(),this.gdpr.cmpData&&(i.push("gdpr="+encodeURIComponent(this.gdpr.cmpData.gdprApplies)),this.gdpr.cmpData.consentString&&i.push("cmp_cs="+encodeURIComponent(this.gdpr.cmpData.consentString)),this.gdpr.cmpData.gppString&&i.push("gpp="+encodeURIComponent(this.gdpr.cmpData.gppString)),this.gdpr.cmpData.gppApplicableSections&&i.push("gpp_sid="+encodeURIComponent(this.gdpr.cmpData.gppApplicableSections)))),this.urlParams.tlPreviewId&&i.push("tl_preview_id="+this.urlParams.tlPreviewId),this.urlParams.tpPreviewId&&i.push("tp_preview_id="+this.urlParams.tpPreviewId),e+"?"+i.join("&")}needsAqp(){return this.placement.invCode.indexOf("msn_infeed_")>-1&&0===this.docInfo.document.getElementsByClassName("xnetvidplayer").length}static getAqpParam(){return"aqp="+encodeURIComponent(JSON.stringify({_id:{$oid:"0"},format_target:{action:"include",items:[{id:8}]}}))}static hasValidSize(e,t){return e&&t}}class h{constructor({placement:e,docInfo:t,browserInfo:i,isAdServing:r,auctionIframe:n},{serveDefault:s,errorHandler:a,eventController:o,asyncUtil:l}){this.placement=e,this.docInfo=t,this.browserInfo=i,this.isAdServing=r,this.auctionIframe=n,this.serveDefault=s,this.errorHandler=a,this.eventController=o,this.asyncUtil=l}onError(e,t){this.errorHandler&&this.errorHandler.fireError({category:"Auction Runner",error:e,level:t})}fireAuction(e){const t=this.auctionIframe;try{const i=t.contentWindow.document.createElement("SCRIPT");i.referrerPolicy="no-referrer-when-downgrade",i.src=e,t.contentWindow.document.body.appendChild(i)}catch(e){this.onError(e,this.errorHandler.ERROR)}const i=this.placement.timeoutDuration,r=this.asyncUtil.timeoutWrap(()=>{this.serveDefault.serve("auction_timeout")},i);this.eventController.once(s.kB,()=>{clearTimeout(r)})}run(e){this.criteoGuard=!1;const t=t=>{if(this.criteoGuard)return;this.criteoGuard=!0;const i=this.rtusTimeout;if(i&&(this.docInfo.window.clearTimeout(i),this.rtusTimeout=!1),t&&"OK"===t.status){const i=encodeURIComponent(t.userid);this.fireAuction(e+"&criteo_id="+i)}else this.fireAuction(e)},i=()=>{this.criteoGuard||(this.criteoGuard=!0,this.fireAuction(e))};if(this.browserInfo.isSafari&&!this.isAdServing){const e=this.auctionIframe.contentWindow,r=e.document,n="tl_criteo_rtus";e[n]=t;const s=r.createElement("SCRIPT");r.body.appendChild(s),s.onerror=i,s.src="//gum.criteo.com/sync?c=157&r=2&j="+n,this.rtusTimeout=setTimeout(i,150)}else this.fireAuction(e)}}class u{constructor(e,t){const i=t.hookFinder.getDtjTacticId();e.isAdServing=!!i,e.specifiedTacticId=t.urlParams.tlDynId||i,this.config=e,this.dependencies=t,this.placement=e.placement,this.serveDefault=t.serveDefault,this.asyncUtil=t.asyncUtil,this.eventController=t.eventController}async getCreative(){const e=1.5*this.placement.timeoutDuration,t=this.asyncUtil.timeoutWrap(()=>{this.serveDefault.serve("global_timeout")},e),i=new Promise(e=>{this.eventController.once(s.e8,i=>{e(i),clearTimeout(t)})}),r=this.initAuctionRunner(),n=this.initAuctionPathBuilder(),a=await n.buildAuctionPath();return r.run(a),i}initAuctionRunner(){return new h(this.config,this.dependencies)}initAuctionPathBuilder(){return new d(this.config,this.dependencies)}}class p{constructor(e){this.userAgent=e}getUserAgent(){return this.userAgent}isMobile(){return this.userAgent.match(/blackberry|ipod|iphone|ipad|android/i)}isIos(){return/ipod|iphone|ipad/i.test(this.userAgent)}isSafari(){return/safari/i.test(this.userAgent)&&!/chrome|chromium|crios/i.test(this.userAgent)}isChrome(){return/chrome/i.test(this.userAgent)&&!/edg|opr|chromium/i.test(this.userAgent)}isFirefox(){return/firefox/i.test(this.userAgent)}isIpad(){return this.userAgent.match(/ipad/i)}isEdge(){return/Edg/.test(this.userAgent)}isConnectedTV(){return this.userAgent.match(/smart-tv|smarttv|hbbtv|appletv|googletv|netcast|viera|aquos|tizen|webos|roku|hisense|letv|boxee|android\s?tv|aftb|aftt|aftm|firetv|bravia|sony\s?tv|samsungtv/i)}checkIsFacebook(){return this.userAgent.indexOf("FBAV/")>-1}getBrowserInfo(){const e=this.isMobile(),t=this.isIpad();return{isMobile:e,isSafari:!!this.isSafari(),isIpad:t,isIos:!!this.isIos(),isEdge:!!this.isEdge(),isSmallScreen:e||t,isFacebook:this.checkIsFacebook(),isChrome:!!this.isChrome(),isFirefox:!!this.isFirefox()}}getDeviceType(){const e=this.userAgent.toLowerCase();return"unknown"===e?"Unknown":this.isMobile()?"Mobile":this.isIpad()||e.includes("android")&&!e.includes("mobile")?"Tablet":"Desktop"}getDeviceTypeId(e){if(this.isConnectedTV())return t.NG.DT_CONNECTED_TV;return{Unknown:t.NG.DT_PLATFORM,Mobile:t.NG.DT_PHONE,Tablet:t.NG.DT_TABLET,Desktop:t.NG.DT_DISPLAY}[e]||t.NG.DT_PLATFORM}}class m{constructor(){this._auctionIframe=null}get(){return this._auctionIframe}create(e){const t=e.document;this._auctionIframe=(0,r.xo)(t.createElement("IFRAME")),t.body||t.documentElement.appendChild(t.createElement("body"));const i=new Promise((e,t)=>{const i=r=>{try{r.target.removeEventListener("load",i);const t=r.target.contentWindow.document;t.open(),t.write("<html><head></head><body></body></html>"),t.close(),e(r.target)}catch(e){t(e)}};this._auctionIframe.addEventListener("load",i)});return t.body.appendChild(this._auctionIframe),i}}var g=n(705),f=n(980);const v="init",_="post_render",y="dco",A="resize";class I{constructor({eventController:e}){(0,g.A)(this,"phase",v),e.on(s.e8,()=>this.setPhaseAfterAuction())}setPhaseAfterInit(){this.phase="auction"}setPhaseAfterAuction(){this.phase="render"}setPhaseAfterRender(e){this.phase=e?"video":_}setPhaseAfterVideoStart(){this.phase=_}setPhaseAfterPostRender(){this.phase="render_validation"}getPhase(){return this.phase}}const w="DCO_PARSE",E="DCO_VALIDATION";class C extends f.A{constructor(e,t,i){var r;let n="";const s=null==i||null===(r=i.assets)||void 0===r?void 0:r.sku;Array.isArray(s)&&s.length>0?n=" [SKUs: "+s.join(", ")+"]":"string"==typeof s&&s.trim()&&(n=" [SKU: "+s+"]");super(t+": "+e+n),(0,g.A)(this,"_failedValidations",[]),(0,g.A)(this,"_assets",[]),(0,g.A)(this,"errorBlock","dco"),i&&(this._failedValidations=i.failedValidations||[],this._assets=i.assets||[])}get failedValidations(){return this._failedValidations}get assets(){return this._assets}}const b=["kervinteractive.com","api.kervinteractive.com"],T=["amazon-adsystem.com","aax-us-pdx.amazon-adsystem.com","aax-us-east.amazon-adsystem.com"],S=(e,t)=>t.includes((0,r.o_)(e).host);function M(e){return S(e,b)}function R(e){try{const t=new URL(e).hostname;return!("3lift.com"!==t&&!t.endsWith(".3lift.com"))||("3liftd.co"===t||t.endsWith(".3liftd.co"))}catch(e){return!1}}const P="doDco";const D=class{constructor(e,t,i,r,n){this.settings=e,this.frame=t,this.env=i,this.formatManager=r,this.urlParams=n}fetch(){const e=this.frame.contentWindow,t=e.document,i=t.createElement("script"),r=this._getTagUrl();return new Promise((n,s)=>{e[P]=n,e.onerror=e=>s(new C("dco jsonp error: "+e,w)),i.onerror=()=>s(new C("dco script failed to load",w)),setTimeout(()=>{s(new C("dco jsonp timeout",w))},1e4),i.src=r,t.body.appendChild(i)})}_getTagUrl(){if(this.urlParams.debugFlag&&this.urlParams.tlAssetsURL)return this.urlParams.tlAssetsURL;const e=this.settings.dco_tag_url.trim();if(this.formatManager.isAmazon()||this.formatManager.isAmazonBrandedVideo()){if(this.urlParams.debugFlag&&!this.urlParams.adPreview)return e;const t=encodeURIComponent(e);return(0,r.sT)("//"+this.env.tlxHost+"/dco?assetsUrl="+t+"&useWrapDco=true")}if(M(e)){const t=encodeURIComponent(e);return(0,r.sT)("//"+this.env.tlxHost+"/dco?assetsUrl="+t+"&useApiKey=true")}if(R(e))return this._getTripleliftDcoUrl(e);const t=this._getCommerceGridOverrideUrl(e);return t||e.replace("${dcomacro}",P)}_getCommerceGridOverrideUrl(e){try{const t=new URL(e);return("criteo.com"===t.hostname||t.hostname.endsWith(".criteo.com"))&&t.searchParams.has("callback")?t.searchParams.get("callback")?null:(t.searchParams.set("callback","doDco"),t.toString()):null}catch(e){return null}}_getTripleliftDcoUrl(e){var t,i;if(null==this||null===(t=this.settings)||void 0===t||null===(i=t.additional_data)||void 0===i||!i.aid)return e;try{const t=new URL(e);return t.searchParams.has("aid")?e:(t.searchParams.append("aid",this.settings.additional_data.aid),t.toString())}catch(t){return e}}};class x{constructor(e){(0,g.A)(this,"asset_id",void 0),(0,g.A)(this,"image_id",void 0),(0,g.A)(this,"image_url",void 0),(0,g.A)(this,"image_width",void 0),(0,g.A)(this,"image_height",void 0),(0,g.A)(this,"heading",void 0),(0,g.A)(this,"caption",void 0),(0,g.A)(this,"cta",void 0),(0,g.A)(this,"clickthrough_url",void 0),(0,g.A)(this,"click_tracker_encoding_level",void 0),(0,g.A)(this,"index",void 0),(0,g.A)(this,"img_server_params",void 0),(0,g.A)(this,"impression_pixels",void 0),(0,g.A)(this,"viewability_pixels",void 0),(0,g.A)(this,"js_trackers",void 0),(0,g.A)(this,"clickthrough_pixels",void 0),(0,g.A)(this,"omidTracker",void 0),(0,g.A)(this,"length_seconds",void 0),(0,g.A)(this,"cc_url",void 0),(0,g.A)(this,"vast_xml",void 0),(0,g.A)(this,"img_frame",void 0),(0,g.A)(this,"animation_variants",void 0),(0,g.A)(this,"image_render_params",void 0),(0,g.A)(this,"banner_width",void 0),(0,g.A)(this,"banner_height",void 0),(0,g.A)(this,"banner_markup",void 0),(0,g.A)(this,"end_card",void 0),(0,g.A)(this,"feature",void 0),(0,g.A)(this,"background",void 0),(0,g.A)(this,"splash",void 0),(0,g.A)(this,"prv_sample_rate",void 0),this.cta=null==e?void 0:e.cta}}const N=1,L=2,O=3,k=4,j=6,F=7,V=10,H=12,B=500,W=501,U=502,z=503,G=504,q=505,Y=506,Z=507,Q=508,X=511,J=512,K=513,$=531,ee=532,te=533,ie=534,re=535,ne=1,se=3,ae=500,oe=501,le=502,ce=503,de=504,he=507,ue=512,pe=513,me=1,ge=2,fe=2,ve=3,_e=501,ye=555,Ae={TRACKER_EVENT_IMPRESSION:1,TRACKER_EVENT_VIEWABLE_MRC50:2,TRACKER_EVENT_VIEWABLE_MRC100:3,TRACKER_EVENT_VIEWABLE_VIDEO50:4,TRACKER_EVENT_OMID:555},Ie=1,we=2,Ee=7;class Ce extends x{_correctPrices(){if(!this.price||!this.strikeout_price)return;const e=parseFloat(this.price.toString().replace(/[^0-9.-]+/g,""));if(parseFloat(this.strikeout_price.toString().replace(/[^0-9.-]+/g,""))<e){const e=this.price;this.price=this.strikeout_price,this.strikeout_price=e}}populateAssets(e,t){for(let i=0;i<(null==e?void 0:e.length);i++){const r=e[i];r.title?this.heading=r.title.text:r.data?this.populateDataAsset(r,t):r.image||r.img?this.populateImageAsset(r,t):r.video?this.populateVideoAsset(r):r.link&&(this.clickthrough_url=r.link.url,this.clickthrough_pixels=r.link.trkr||r.link.clicktrackers)}}getMultiIndex(e){var t,i;const r=null==e||null===(t=e.ext)||void 0===t?void 0:t.tlMultiIndex,n=null==e||null===(i=e.ext)||void 0===i?void 0:i.index;return r||n||0}getOnlyMultiIndexElements(e,t){return null==e?void 0:e.filter(e=>t===this.getMultiIndex(e))}populateDataAsset(e,t){const i=e.data.value,r=e.data.type;if(e.data&&e.data.privacy)this.privacy_url=e.data.privacy;else if(e.data&&e.data.link)this.clickthrough_url=e.data.link;else if(r===L)this.caption=i;else if(r===V)this.subheadline=i;else if(r===H)this.cta=i;else if(r===U)this.img_frame=i;else if(r===j)this.price=i,this._correctPrices();else if(r===z)this.location=i;else if(r===te)i.text&&i.render_method?this.disclosure=i:(t.disclosure||(t.disclosure={}),t.disclosure.text=i);else if(r===ie)t.disclosure.render_method=i;else if(r===$)t.isi_url=i;else if(r===ee)t.customization=JSON.parse(i);else if(r===N)t.advertiser_name=i,this.advertiser_name=i;else if(r===B||r===Q)this.customer_review=i;else if(r===W)this.product_name=i;else if(r===G)this.date=i;else if(r===q)this.time=i;else if(r===re)t.template_component_url=i;else if(r===Z)try{var n,s,a,o,l,c;this.deal_badge=JSON.parse(i),this.deal_badge_label_text=null===(n=this.deal_badge.label)||void 0===n?void 0:n.text,this.deal_badge_label_color=null===(s=this.deal_badge.label)||void 0===s?void 0:s.color,this.deal_badge_label_background_color=null===(a=this.deal_badge.label)||void 0===a?void 0:a.backgroundColor,this.deal_badge_messaging_text=null===(o=this.deal_badge.messaging)||void 0===o?void 0:o.text,this.deal_badge_messaging_color=null===(l=this.deal_badge.messaging)||void 0===l?void 0:l.color,this.deal_badge_messaging_background_color=null===(c=this.deal_badge.messaging)||void 0===c?void 0:c.backgroundColor}catch(e){this.deal_badge=i}else if(r===k)this.likes=i,this.customer_review=i;else if(r===Y||r===F)this.strikeout_price=i,this._correctPrices();else if(r===O)this.customer_star_rating=i;else if(r===X){const e=i;var d,h;if(e)this.climate_pledge_text=null===(d=e["climate-pledge-friendly-logo"])||void 0===d?void 0:d.text,this.climate_pledge_img=null===(h=e["climate-pledge-friendly-logo"])||void 0===h?void 0:h.img}else r===J?this.coupon=i:r===K&&(this.sku=i)}populateImageAsset(e,t){const i=e.image||e.img,r=i.ext,n=i.type;n===se?this.populateMainImageAsset(i,r,t):n===ne?(this.logo_image_url=i.url,this.logo=i.url,t&&this.populateLogoAsset(t,i,r)):n===ae?this.end_card=i.url:n===oe?this.background=i.url:n===le?this.feature=i.url:n===ce?this.splash=i.url:n===de||n===ue?(this.logo_2=i.url,this.secondary_logo=i.url):n===pe?this.logo_3=i.url:n===he&&(this.end_card_advertiser=i.url)}populateLogoAsset(e,t,i){e.logo_image_url=t.url,e.logo_width=t.w,e.logo_height=t.h,e.alt_logo_image_url=null==i?void 0:i.altUrl}populateVideoAsset(e){var t,i;if(this.vast_xml=e.video.curl||e.video.adm||e.video.vasttag,this.creative_type="vast",null!=e&&null!==(t=e.video)&&void 0!==t&&null!==(i=t.ext)&&void 0!==i&&i.tlVideo){const t=e.video.ext.tlVideo;this.length_seconds=t.durationMs/1e3,this.cc_url=t.closedCaptionUrl,this.use_vast_clickthrough=t.useVastClickthrough}}populateMainImageAsset(e,t,i){if(i.template_component_url&&(e.url=function(e,t){return(0,r.sT)("//"+t.environment.tlImageAddr+"/box?width="+e.w+"&height="+e.h+"&url="+encodeURIComponent(e.url))}(e,i)),this.image_url=e.url,e.w&&(this.image_width=e.w),e.h&&(this.image_height=e.h),null!=t&&t.tlImage){var n;const e=t.tlImage;if(e.imageId>0&&(this.image_id=e.imageId),e.renderParameters){this.image_render_params=e.renderParameters;const t=[];Object.entries(e.renderParameters).forEach(([e,i])=>this.addValue(t,e,i)),this.img_server_params=t.join("&")}if(e.focalRectangle){const t=e.focalRectangle,i={};i.x1=t.topLeftX,i.x2=t.topLeftX+t.width,i.y1=t.topLeftY,i.y2=t.topLeftY+t.height,this.focal_box=i}(null===(n=e.animationVariants)||void 0===n?void 0:n.length)>0&&(this.animation_variants=e.animationVariants)}this.image_id||(this.image_id=this.getClientSideRenderId())}addValue(e,t,i){i&&e.push(t+"="+encodeURIComponent(i))}getClientSideRenderId(){return-1}initializeEventTrackers(){this.impression_pixels||(this.impression_pixels=[]),this.js_trackers||(this.js_trackers=[]),null==this.viewability_pixels&&(this.viewability_pixels=[]),null==this.clickthrough_pixels&&(this.clickthrough_pixels=[])}}class be extends Ce{constructor(e,t,i){super(i),this.index=t,this.parseTopLevelFields(e);const r=this.getOnlyMultiIndexElements(e.assets||e.asset,t),n=this.getOnlyMultiIndexElements(e.eventtrackers||e.event,t);this.populateAssets(r,i),this.populateEvents(n)}parseTopLevelFields(e){try{this.addLink(e),this.addPrivacy(e)}catch(e){throw new f.A("error parsing top level fields for DCO assets")}}addLink(e){const t=e.link;if(!t)return;t.url&&(this.clickthrough_url=t.url);const i=t.trkr||t.clicktrackers;i&&0!==i.length&&(this.clickthrough_pixels=i)}addPrivacy(e){e.privacy&&(this.privacy_url=e.privacy)}populateEvents(e){this.initializeEventTrackers();for(let t=0;t<(null==e?void 0:e.length);t++){const i=e[t];i.method===we?this.js_trackers.push(i.url):i.method===Ie&&i.event===Ae.TRACKER_EVENT_IMPRESSION?this.impression_pixels.push(i.url):i.method===Ie&&[Ae.TRACKER_EVENT_VIEWABLE_MRC50,Ae.TRACKER_EVENT_VIEWABLE_MRC100,Ae.TRACKER_EVENT_VIEWABLE_VIDEO50].includes(i.event)&&this.viewability_pixels.push(i.url)}}}const Te=class{constructor(e,t){this.dcoProtocol=e,this.settings=t}create(e){if(t.pj.NATIVE_ADS!==this.dcoProtocol)throw new C("invalid dco_protocol",w);try{var i;let t=this._createAssets(e);if(null!=e&&null!==(i=e.ext)&&void 0!==i&&i.carousel){const i=this._createCarouselAssets(e,t[0]);t=t.concat(i)}return t.map(e=>this._augmentAsset(e))}catch(e){throw new C("error parsing DCO payload: "+e.message,w)}}_createCarouselAssets(e,t){return this._getCarouselExtensionAssets(e.ext.carousel).map(e=>({...t,...e}))}_createAssets(e){const t=this._extractProductCount(e),i=[];for(let n=0;n<=t;n++){const t=new be(e,n,this.settings);(0,r.IY)(t),i.push(t)}return i}_extractProductCount(e){const t=this._extractAssetProductCount(e),i=this._extractTopLevelProductCount(e);return Math.max(t,i)}_extractAssetProductCount(e){let t=0;const i=(null==e?void 0:e.assets)||(null==e?void 0:e.asset);return null==i||i.forEach(e=>{var i,r;let n=0;null!=e&&null!==(i=e.ext)&&void 0!==i&&i.tlMultiIndex&&(n=e.ext.tlMultiIndex),null!=e&&null!==(r=e.ext)&&void 0!==r&&r.index&&(n=e.ext.index),t<n&&(t=n)}),t}_extractTopLevelProductCount(e){var t;return null!=e&&null!==(t=e.ext)&&void 0!==t&&t.tlMultiCount?e.ext.tlMultiCount:0}_getCarouselExtensionAssets(e){const t=e.map(e=>this._fromCarousel(e));return t.sort((e,t)=>e.position<t.position?-1:1),t.map(e=>delete e.position),t}_fromCarousel(e){const t={};if(null==e.position)throw new C("missing position for carousel asset",w);if(t.position=e.position,null==e.image_url)throw new C("missing image url for carousel asset",w);return t.image_url=e.image_url,null!=e.heading&&(t.heading=e.heading),null!=e.caption&&(t.caption=e.caption),null!=e.clickthrough_url&&(t.clickthrough_url=e.clickthrough_url),t}_augmentAsset(e){return e.image_id=-1,e.asset_id=-1,e.img_server_params="",e}},Se=["clickthrough_pixels","viewability_pixels","impression_pixels","js_trackers"];const Me=class{constructor(e,t,i){this.settings=t,this.adcomAssets=e,this.debugFlag=i}mergeFieldsConditionally(e){return this.settings.useRetailMediaDco&&(R(this.settings.dco_tag_url)||this.debugFlag)?this._mergeFields(e):e}_mergeFields(e){return e.map((e,t)=>{const i=this.adcomAssets[t]||null;let r={...e};return e&&e.image_url||(r={...i}),r})}mergeEvents(e){return{assets:e.map(e=>this._mergeOrRemoveTrackerFields(this.adcomAssets,e))}}_mergeOrRemoveTrackerFields(e,t){const i={...t};return Se.forEach(t=>{var r;Array.isArray(e)&&e[0]&&Array.isArray(e[0][t])&&(i[t]=null===(r=i[t])||void 0===r?void 0:r.concat(e[0][t]));const n=Array.isArray(i[t]),s=Array.isArray(this.settings[t]);n&&s?(i[t]=i[t].concat(this.settings[t]),delete this.settings[t]):s&&delete i[t],i[t]&&(i[t]=Array.from(new Set(i[t])))}),i}};function Re(e,t){return t.reduce((t,i)=>(typeof e[i.field]===i.type&&e[i.field].length>=i.minLength||(t.isValid=!1,t.failedFields.push(i.field)),t),{isValid:!0,failedFields:[]})}const Pe={validate:function(e){if("object"!=typeof e)return{isValid:!1,failedFields:[]};return Re(e,De)}},De=[{field:"heading",type:"string",minLength:1},{field:"image_url",type:"string",minLength:1},{field:"clickthrough_url",type:"string",minLength:1}];const xe={validate:function(e){if("object"!=typeof e)return{isValid:!1,failedFields:[]};const t=Re(e,Ne);if(!t.isValid)return t;return Le(e.vast_xml,t)}},Ne=[{field:"advertiser_name",type:"string",minLength:1},{field:"clickthrough_url",type:"string",minLength:1},{field:"heading",type:"string",minLength:1},{field:"vast_xml",type:"string",minLength:1}];function Le(e,t){return e.startsWith("<")&&e.endsWith(">")||e.startsWith("http")||(t.isValid=!1,t.failedFields.push("vast_xml")),t}const Oe={validate:function(e){if("object"!=typeof e)return{isValid:!1,failedFields:[]};return Re(e,ke)}},ke=De.filter(e=>"caption"!==e.field);const je={validate:function(e){if("object"!=typeof e)return{isValid:!1,failedFields:[]};return Re(e,Fe)}},Fe=[{field:"image_url",type:"string",minLength:1},{field:"product_name",type:"string",minLength:1}];const Ve={validate:function(e){if("object"!=typeof e)return{isValid:!1,failedFields:[]};if(0===e.index)return Re(e,He);return je.validate(e)}},He=[{field:"image_url",type:"string",minLength:1},{field:"clickthrough_url",type:"string",minLength:1}];const Be={validate:function(e){if("object"!=typeof e)return{isValid:!1,failedFields:[]};if(0===e.index){const t=Re(e,We);return t.isValid?Le(e.vast_xml,t):t}return je.validate(e)}},We=[{field:"vast_xml",type:"string",minLength:1},{field:"clickthrough_url",type:"string",minLength:1}];const Ue={getValidator:function(e,t){const i=t.getFormats();if(t.isShoppableMedia()&&e===i.component_image)return Ve;if(t.isShoppableMedia()&&e===i.component_video)return Be;if(t.isAmazon())return Oe;if(e===i.image||e===i.carousel)return Pe;if(e===i.autoplay)return xe;return Pe}};const ze=class{constructor(e,t,i){this.renderFormat=e,this.formatManager=t,this.settings=i,this.validator=Ue.getValidator(e,t)}validate(e){const t=e.map(e=>this.validator.validate(e));if(t.some(e=>!e.isValid)){const i=t.filter(e=>!e.isValid).map(e=>e.failedFields.join(", "));throw new C("dco asset invalid",E,{assets:e,failedValidations:i})}return e}},Ge=0,qe=1;class Ye{constructor({assets:e,settings:t,frame:i,env:r,formatManager:n,urlParams:s},{errorHandler:a}){(0,g.A)(this,"errAndFallBackOrDefault",e=>{this._isFallback=qe,this._retailerId="",this._skus=[];const t=e.toString(),i=e.errorBlock,r={dco_tag_url:this.settings.dco_tag_url,failed_validations:e.failedValidations,assets:{skus:this._skus}};if(e.payload&&(r.payload=e.payload),!this._useFallbackAssets())throw this.errorHandler.fireError({category:"DCO Payload Retrieval",error:t,level:this.errorHandler.ERROR,diagnosticContext:r,block:i}),new f.A("invalid DCO payload and no fallback creative");return this.errorHandler.fireError({category:"DCO Payload Retrieval",error:t,level:this.errorHandler.WARNING,diagnosticContext:r,block:i}),{assets:this.assets}}),this.assets=e,this.frame=i,this.settings=t,this.errorHandler=a,this.env=r,this.formatManager=n,this._isFallback=Ge,this.urlParams=s,this._retailerId="",this._skus=[],this.payloadFetcher=new D(t,i,r,n,s),this.assetFactory=new Te(t.dco_protocol,t),this.assetMerger=new Me(e,t,s.debugFlag),this.assetValidator=new ze(t.format_id,n,t)}getOptimizedAsset(){return this.payloadFetcher.fetch().then(e=>(this.extractRetailerId(e),this.assetFactory.create(e))).then(e=>this.assetMerger.mergeFieldsConditionally(e)).then(e=>this.assetValidator.validate(e)).then(e=>this.assetMerger.mergeEvents(e)).then(e=>this.extractProductSkus(e)).catch(e=>this.errAndFallBackOrDefault(e))}_useFallbackAssets(){return this.assets&&this.assets.length>0}extractRetailerId(e){var t,i;null!=e&&null!==(t=e.ext)&&void 0!==t&&t.retailer_id&&(this._retailerId=null==e||null===(i=e.ext)||void 0===i?void 0:i.retailer_id)}extractProductSkus(e){const t=Array.isArray(null==e?void 0:e.assets)?e.assets:[];return this._skus=t.map(e=>e.sku).filter(e=>null!=e&&""!==e),e}get isFallback(){return this._isFallback}get retailerId(){return this._retailerId}get skus(){return this._skus}}var Ze=n(645);class Qe{constructor({scriptWindow:e}){this.window=e,this._document=e.document;try{this.topDocument=top.document,this._topWindow=top,this.canAccessTop=!0}catch(e){this.topDocument=window.document,this._topWindow=window,this.canAccessTop=!1}try{this._topWindow.navigator?this.navigator=this._topWindow.navigator:this.navigator=navigator}catch(e){this.navigator=navigator}}get document(){return this._document||this.topDocument}get frameElement(){var e;return frameElement||(null===(e=this.window)||void 0===e?void 0:e.frameElement)}get topWindow(){return this._topWindow||window}get canAccessElementsFromPoint(){return!(!this.topDocument.elementsFromPoint&&!this.topDocument.msElementsFromPoint)}getElementsFromPoint(e,t){let i=null;if(this.topDocument.elementsFromPoint)i=this.topDocument.elementsFromPoint(e,t);else if(this.topDocument.msElementsFromPoint){const n=this.topDocument.msElementsFromPoint(e,t);i=(0,r.uN)(n)}return i||[]}isInFocus(){return!(!this.window.navigator.userAgent.indexOf("MSIE")&&!this.topDocument.hasFocus())}}class Xe{constructor({adserverHostName:e,bundleRoot:t,cookieDomain:i,dynamicPath:r,ebPath:n,formats:s,numUserSyncPixels:a,qaHost:o,renderOptionsMap:l,tlImageAddr:c,tlxHost:d,ttjHostName:h}){this._adserverHostName=e,this._bundleRoot=t,this._cookieDomain=i,this._dynamicPath=r,this._ebPath=n,this._formats=s,this._numUserSyncPixels=a,this._qaHost=o,this._renderOptionsMap=l,this._tlImageAddr=c,this._tlxHost=d,this._ttjHostName=h}get adserverHostName(){return this._adserverHostName}get bundleRoot(){return this._bundleRoot}get cookieDomain(){return this._cookieDomain}get dynamicPath(){return this._dynamicPath}get ebPath(){return this._ebPath}get formats(){return this._formats}get numUserSyncPixels(){return this._numUserSyncPixels}get qaHost(){return this._qaHost}get renderOptionsMap(){return this._renderOptionsMap}get tlImageAddr(){return this._tlImageAddr}get tlxHost(){return this._tlxHost}get ttjHostName(){return this._ttjHostName}}var Je=n(541);class Ke{constructor(){(0,g.A)(this,"events",{})}on(e,t){return this._subscribe(e,t,!1)}once(e,t){return this._subscribe(e,t,!0)}off(e,t){if(!this.events[e]||0===this.events[e].length)return;const i=this.events[e].filter(e=>e.eventHandler!==t);this.events[e]=[...i],0===this.events[e].length&&(this.events={...this.events,eventName:[]})}destroy(){this.events={}}publish(e,...t){this._publishEvent(e,...t),this._publishLog(e,...t)}_subscribe(e,t,i){return Object.prototype.hasOwnProperty.call(this.events,e)||(this.events[e]=[]),this.events[e]=[...this.events[e],{eventHandler:t,once:i}],()=>this.off(e,t)}_publishEvent(e,...t){this.events[e]&&this.events[e].length>0&&this.events[e].forEach(i=>{i.eventHandler(...t),i.once&&this.off(e,i.eventHandler)})}_publishLog(e,...t){this._publishEvent(s.$9,e,...t)}onWithOffEvent(e,t,i){const r=this.on(e,i);this.on(t,r)}}class $e{constructor({docInfo:e,rev:t,placement:i,debugFlag:r,ebPath:n,auctionId:s=null,shouldLogThirdPartyPixel:a,dependenciesResolver:o},{eventController:l,formatManager:c,lifecycleManager:d}){this.docInfo=e,this.rev=t,this.placement=i,this.debugFlag=r,this.ebPath=n,this.eventController=l,this.auctionId=s,this.formatManager=c,this.shouldLogThirdPartyPixel=a,this.lifecycleManager=d,this.dependenciesResolver=o,this._setupListeners()}fireModernPixel(e,t){if(!e)return;const i=this._useModernPixel();let r=!1;if(i&&this._shouldUseNavigatorBeacon()){const t=this._appendFlagIfCaptureTool(e);r=navigator.sendBeacon(t)}r||(i?this.fireImageFallback(e,t):this.fire(e,t))}fireImageFallback(e,t){if(!e)return;const i=new this.docInfo.topDocument.defaultView.Image;"function"==typeof t&&i.addEventListener("error",()=>t()),i.src=this._appendFlagIfCaptureTool(e)}fire(e,t){if(!e)return;const i=this.docInfo.topDocument.createElement("IMG");"function"==typeof t&&i.addEventListener("error",()=>t()),i.src=this._appendFlagIfCaptureTool(e)}_useModernPixel(){var e,t;const i=this.dependenciesResolver();return!(null==i||null===(e=i.creative)||void 0===e||null===(t=e.params)||void 0===t||!t.useNavigatorBeacon)}_shouldUseNavigatorBeacon(){var e;const t=null==this||null===(e=this.docInfo)||void 0===e?void 0:e.navigator;return t&&(null==t?void 0:t.sendBeacon)}fireEB(e,t={},i){const r=this.getEBUrl(e,t);this.fireModernPixel(r,i)}getEBUrl(e,t){const i={inv_code:this.placement.invCode,aid:this.auctionId,rev:this.rev};return(0,r.j7)(this.ebPath,e,{...i,...t})}fireDyn(e){const t={...{long1:null,long2:null,long3:null,string1:this.auctionId,string2:null,string3:null},...e},i=(0,r.j7)(this.ebPath,"dyn",t);this.fire(i)}firePerf(e){const t={rev:this.rev,type:e.type,time_since_start:e.timeSinceStart,time_since_last:e.timeSinceLast,size:e.size,client_side_auction:+e.clientSideAuction,fid:e.formatId},i=(0,r.j7)(this.ebPath,"perf",t);this.fire(i)}setAuctionId(e){return this.auctionId=e,this}getAuctionId(){return this.auctionId}logThirdPartyTracker(t,i){const r={trackerType:t,revision:this.rev,format:this.formatManager.getFormat(),connectionType:this.formatManager.getConnectionType(),tptSrc:this._appendFlagIfCaptureTool(i)};if(this.shouldLogThirdPartyPixel){if(!this.isValidUrl(r.tptSrc)){const t={e:"Invalid third-party tracker URL",block:this.lifecycleManager.getPhase(),lvl:Je.A.WARNING,dc:JSON.stringify({tptSrc:r.tptSrc?r.tptSrc:""})};return void this.fireEB(e.f0,t)}this.fireEB(e.Im,r)}}_setupListeners(){this.eventController.on(s.e8,e=>{var t,i,r;this.setAuctionId(null===(t=e.ad)||void 0===t||null===(i=t.ext)||void 0===i||null===(r=i.tlAdditionalData)||void 0===r?void 0:r.aid)})}_appendFlagIfCaptureTool(e){return this.formatManager.isCaptureToolUrl()?this._appendTlTestQueryParam(e):e}_appendTlTestQueryParam(e){try{const t=new URL(e);return t.searchParams.set("tl_test","true"),"/"===t.pathname?t.origin+t.search:t.toString()}catch(t){return e}}isValidUrl(e){try{return new URL(e),!0}catch(e){return!1}}}class et{constructor({auctionFrameWindow:e,errorDecorator:t}){this.auctionFrameWindow=e,this.decorator=t,this.thirdPartyMessage=!1}handleRocketfuel(e){const t=this.auctionFrameWindow.document.createElement("iframe");(0,r.xo)(t),t.src="about:blank",this.auctionFrameWindow.document.body.appendChild(t);const i=t.contentWindow.document;return i.open(),i.write(e),i.close(),t}newWriter(e){let t,i,n,s,a,o,l,c,d,h;const u=()=>{for(i=o.contentWindow.document,i.open(),i.write('<script>window.addEventListener("message",function(msg){window.parent.postMessage(msg.data,"*");});<\/script>'),d=0;d<h;d++){const e=c[d];e.text.length?i.write("<script>"+e.text+"<\/script>"):e.getAttribute&&e.getAttribute("data-dv3-creative-fetch")?i.write(e.outerHTML):(t=(0,r.o_)(e.src),n=t.queryKey,s=t.host,"ad.turn.com"===s&&n.cid&&(a=n.cid,o.setAttribute("data-ext-creative-id",a)),i.write('<script type="text/javascript" src="'+e.src+'"><\/script>'))}i.close(),o.removeEventListener("load",u)};try{if(e.indexOf("rfitag")>0)return void this.handleRocketfuel(e);if(l=this.auctionFrameWindow.document.createElement("div"),l.style.display="none",this.auctionFrameWindow.document.body.appendChild(l),l.innerHTML=e,c=l.getElementsByTagName("script"),h=c.length,0===h)return;o=this.auctionFrameWindow.document.createElement("iframe"),(0,r.xo)(o),o.className="tl_ext_iframe",o.addEventListener("load",u),this.auctionFrameWindow.document.body.appendChild(o)}catch(e){throw new f.A("newWriter failed: "+e.message)}}setListeners(){this.auctionFrameWindow.addEventListener("message",this.decorator(this._onmessage.bind(this))),this.auctionFrameWindow.document.write=()=>{}}_onmessage(e){if(!e||!e.data||!e.data.match)return;if(e.data.match("get_3p")||e.data.match("get_ext")||e.data.match("get_unit_2")){if(this.thirdPartyMessage)return;this.thirdPartyMessage=!0;const t=this.auctionFrameWindow.document.createElement("SCRIPT");t.textContent=e.data,this.auctionFrameWindow.document.body.appendChild(t)}}}class tt{constructor(){this.allRenderedAssets=tt.allRenderedAssets}dispatchIfUnique(e,t,i,r){this.allRenderedAssets[i]=this.allRenderedAssets[i]||[],this._areAssetsUnique(i,r)?(t(),this._trackAssets(i,r)):e.serve("redundant_asset")}_areAssetsUnique(e,t){return t.every(t=>this._isAssetUnique(e,t))}_isAssetUnique(e,t){return!this.allRenderedAssets[e][t]}_trackAssets(e,t){t.forEach(t=>this._trackAsset(e,t))}_trackAsset(e,t){this.allRenderedAssets[e][t]=!0}}(0,g.A)(tt,"allRenderedAssets",{});class it{constructor({placement:e,auctionIframe:t},{eventController:i,serveDefault:r,firePix:n,errorDecorator:s,errorHandler:a}){this.placement=e,this.auctionIFrameWindow=t.contentWindow,this.eventController=i,this.defaultServer=r,this.firePix=n,this.errorDecorator=s,this.errorHandler=a,this.isUnitGenerated=!1}getCreativeJSON2(e,t){this.passthru(e.pixel,t)}get3PUnit(e,t,i,r,n,s){this.passthru(t,s)}getExtUnit(e,t){this.passthru(t)}passthru(e,t){this.eventController.publish(s.NK,e,t)}dynamicCreativeRender(e){if(!e)throw new f.A("Missing auction response payload");this.isUnitGenerated||(this.isUnitGenerated=!0,this.eventController.publish(s.e8,e))}serveConditional(e,t){if(this.placement.customOptions.uniqueBrands||this.placement.customOptions.uniqueCreatives){const i=new tt,r=Object.keys(t)[0],n=t[r];i.dispatchIfUnique(this.defaultServer,e,r,n)}else{const e="serveConditional response received with no uniqueness constraints";this.errorHandler.fireError({category:"JSON Creative Fetch",error:e,level:this.errorHandler.ERROR}),this.defaultServer.adRendered=!0}}serveDefault(e,t){this.defaultServer.serve(e,t)}registerAuctionListeners(){const e={get_unit_2:this.wrap(this.getCreativeJSON2),get_3p_unit:this.wrap(this.get3PUnit),get_ext_unit:this.wrap(this.getExtUnit),dynamicCreativeRender:this.wrap(this.dynamicCreativeRender),serveViewable:this.wrap(this.serveConditional),serveConditional:this.wrap(this.serveConditional),serveDefault:this.wrap(this.serveDefault)};Object.assign(this.auctionIFrameWindow,e)}wrap(e){const t=this,i=this.errorDecorator(e);return(...e)=>(t.eventController.publish(s.kB),i.apply(t,e))}}var rt=n(309);const nt="tl_id";class st{constructor({placement:e,environment:t,docInfo:i,settings:r,currentScript:n},{errorHandler:s}){this.placement=e,this.docInfo=i,this.environment=t,this.errorHandler=s,this.settings=r,this.currentScript=n||this._getTLScript(),this.cachedHook=null}getHook(e=!1){return null===this.cachedHook&&(this.cachedHook=this._findHook(e)),this.cachedHook}_findHook(e=!1){let t=this.currentScript;try{const i=this.docInfo.window;i===top||!i.frameElement||this.placement.customOptions.friendlyIframeRender||e||(t=this.isInActiveViewElement()?st.getTopFrame(i,"data-google-container-id"):st.getTopFrame(i))}catch(e){}let i=+this.placement.replaceParent;for(;i;)t=t.parentNode,i--;if(!t)throw new f.A("could not find hook");return t.tagName||(t=this.tlScript),t}_getTLScript(){const e=[].slice.call(this.docInfo.document.getElementsByTagName("script")).find(e=>this._isValidTLScript(e));return e?(e.setAttribute(nt,Math.round(1e5*Math.random())),e):null}_isValidTLScript(e){const t=e.getAttribute(nt);return st.scriptSrcContains(e,this.environment.ttjHostName)&&st.scriptSrcContains(e,this.placement.invCode)&&!t}getAuctionResponsePseudoId(){return!!this.currentScript&&this.currentScript.getAttribute("data-auction-response-id")}getHeaderBiddingAuctionResponse(){const e=this.getAuctionResponsePseudoId();return this.docInfo.window["tl_auction_response_"+e]||null}getForcedTemplateCode(){return this.docInfo.window.tl_template_code||null}getTagTemplateId(){return!!this.currentScript&&this.currentScript.getAttribute("data-template-id")}_getScriptPath(){const e=this.getScriptSrc();return(0,r.o_)(e).path}getDtjTacticId(){const e=this._getScriptPath().split("/");return"dtj"===e[1]?e[3]:void 0}getScriptSrc(){return this.currentScript?this.currentScript.getAttribute("data-src")||this.currentScript.src:""}styleHook(e){var t;const i=this.getHook(e),r="iframe"===(null==i||null===(t=i.tagName)||void 0===t?void 0:t.toLowerCase()),n=!this.placement.customOptions.friendlyIframeRender&&!e,s=this.placement.customOptions.activeView,a=this.isInActiveViewElement(),o=r&&n&&(s||a&&this.canAbsolutelyPositionFrame(i));o&&Math.random()<this.settings.activeviewLogRate&&this.errorHandler.fireError({category:"Hook Styling",error:"activeView",level:this.errorHandler.INFO}),o?(this.allowAbsolutePositioning(i),this.positionFrameBehindAd(i)):this.hideHook(i)}canAbsolutelyPositionFrame(e){const t=e.parentElement,i=this.hasDefaultPosition(t)&&this.hasOffset(t);if(!t||i){const e="Cannot absolutely position ActiveView iframe. Parent is undefined, or has static position and offsets";return this.errorHandler.fireError({category:"Iframe Positioning",error:e,level:this.errorHandler.WARNING}),!1}return!0}hasDefaultPosition(e){const t=rt.A.getPropertyValue(e,"position");return["static",""].indexOf(t)>-1}hasOffset(e){return!!["top","bottom","left","right"].find(t=>{const i=rt.A.getPropertyValue(e,t);return parseFloat(i)>0})}positionFrameBehindAd(e){rt.A.setStyle(e,"position","absolute"),rt.A.setStyle(e,"visibility","hidden"),rt.A.setStyle(e,"top","0px"),rt.A.setStyle(e,"left","0px"),rt.A.setStyle(e,"pointer-events","none")}allowAbsolutePositioning(e){const t=e.parentElement;this.hasDefaultPosition(t)&&rt.A.setStyle(t,"position","relative")}isInActiveViewElement(){return!!(this.currentScript&&this.currentScript.parentElement&&this.currentScript.parentElement.classList.contains("GoogleActiveViewElement"))}hideHook(e){rt.A.setStyle(e,"display","none"),rt.A.setStyle(e,"visibility","hidden"),rt.A.setStyle(e,"width","0px"),rt.A.setStyle(e,"height","0px")}getSupplySourceId(){return this.currentScript?this.currentScript.getAttribute("data-ss-id"):null}static getTopFrame(e,t){let i,r=e,n=!1;for(;r!==top&&!n;)try{r.frameElement&&(i=r.frameElement),r=r.parent,t&&i.getAttribute(t)&&(n=!0)}catch(e){break}return i}static scriptSrcContains(e,t){if(!t)return!1;const{src:i}=e,r=e.getAttribute("data-src"),n=i&&i.indexOf(t)>-1,s=r&&r.indexOf(t)>-1;return!(!n&&!s)}}class at{static needsBusting(e,t){return!!e.iframeBuster&&!function(e){let t;try{t=e&&e===top}catch(e){t=!1}return t}(t)}static bust(e,t){const i=(0,r.o_)(e.referrer),n=encodeURIComponent(e.URL),s=e.createElement("iframe");if(s.src=(0,r.sT)("//"+i.host+"/doubleclick/TLIframe.html?docsrc="+n+"&script_src="+encodeURIComponent(t)),s.width=0,s.height=0,s.style.display="none",!at._hasBody(e)){const t=e.createElement("body");e.firstElementChild.appendChild(t)}e.body.appendChild(s)}static _hasBody(e){return!!e.body}}class ot{constructor(){try{jQuery(),this.jQueryPresent=!0}catch(e){this.jQueryPresent=!1}}layout(e){this.jQueryPresent&&(this._layoutMasonry(),this._layoutIsotope(e))}_layoutMasonry(){let e=jQuery(".masonry");e.length||(e=null),e&&e.length>1&&(e=jQuery(e[0])),e||jQuery.each(jQuery("*"),(t,i)=>{jQuery.data(i,"masonry")&&(e=jQuery(i))}),e&&e.data("masonry")&&(e.masonry("reloadItems"),e.masonry())}_layoutIsotope(e){if(jQuery.fn.isotope){let t=jQuery(".isotope");if(1!==t.length){let i=e;for(;i.parentNode;)jQuery.data(jQuery(i.parentNode),"isotope")?t=jQuery(i.parentNode):i=i.parentNode}t.data("isotope")||(t=!1),t&&t.isotope("reloadItems").isotope({sortBy:"original-order"})}}}const lt=1,ct=2,dt=3,ht=4;class ut{constructor({creativePayload:e,firePix:t}){this._payableEvent=e.settings.payable_event,this._formatId=e.settings.format_id,this._tacticId=e.settings.additional_data.tid||0,this._firePix=t}render(){this._payableEvent===lt&&this._fire()}viewable(){this._payableEvent===ct&&this._fire()}onePxViewable(){this._payableEvent===dt&&this._fire()}videoStart(){this._payableEvent===ht&&this._fire()}_fire(){this._firePix.fireEB(e.oc,{peid:this._payableEvent,fid:this._formatId,tid:this._tacticId})}}class pt{constructor(){this.forcedBidResponse=null,this.forcedTemplateCode=null}async fetchAdpreviewInfo(e){const i=t.T+"/render-info-public?hash="+e;try{const e=await fetch(i);if(!e.ok)throw new Error("Could not fetch adpreview information: Status "+e.status);const t=await e.json();this.forcedBidResponse=JSON.parse(t.forced_bid_response),this.forcedTemplateCode=t.forced_template_code}catch(e){Ze.A.warn(e)}}}class mt{constructor({activeView:e=!1,defaultHeadingOverride:t="",disableOutstreamVideoBehavior:i=!1,disclosureOverride:r,friendlyIframeRender:n=!1,isAmp:s=!1,maxUserSyncs:a=10,numCreatives:o=1,playButtonUrl:l="",uniqueBrands:c=!1,uniqueCreatives:d=!1,unwrappedUnit:h=!1,videoZIndexOverride:u=null,videoErrorFallbackOptOut:p=!1,safeFrameResizingOptOut:m=!1}){this._activeView=e,this._defaultHeadingOverride=t,this._disableOutstreamVideoBehavior=i,this._disclosureOverride=r,this._friendlyIframeRender=n,this._isAmp=s,this._maxUserSyncs=a,this._numCreatives=o,this._playButtonUrl=l,this._uniqueBrands=c,this._uniqueCreatives=d,this._unwrappedUnit=h,this._videoZIndexOverride=u,this._videoErrorFallbackOptOut=p,this._safeFrameResizingOptOut=m}get activeView(){return this._activeView}get defaultHeadingOverride(){return this._defaultHeadingOverride}get disableOutstreamVideoBehavior(){return this._disableOutstreamVideoBehavior}get disclosureOverride(){return this._disclosureOverride}get friendlyIframeRender(){return this._friendlyIframeRender}set friendlyIframeRender(e){this._friendlyIframeRender=e}get isAmp(){return this._isAmp}get maxUserSyncs(){return this._maxUserSyncs}get numCreatives(){return this._numCreatives}get playButtonUrl(){return this._playButtonUrl}get uniqueBrands(){return this._uniqueBrands}get uniqueCreatives(){return this._uniqueCreatives}get unwrappedUnit(){return this._unwrappedUnit}set unwrappedUnit(e){this._unwrappedUnit=e}get videoZIndexOverride(){return this._videoZIndexOverride}get videoErrorFallbackOptOut(){return this._videoErrorFallbackOptOut}get safeFrameResizingOptOut(){return this._safeFrameResizingOptOut}set safeFrameResizingOptOut(e){this._safeFrameResizingOptOut=e}}class gt{constructor({async:e,captionCharacterLimit:t,headingCharacterLimit:i,cta:r,customOptions:n={},defaultCode:s,demandEnabled:a,dvPlacementId:o,disclosure:l,id:c=0,iframeBuster:d,iframeWrap:h,imageHeight:u,imageWidth:p,invCode:m,logoBlackList:g,provenTemplate:f,publisherId:v=0,replaceParent:_,sharingEnabled:y,staging:A,templateCode:I,templates:w,timeoutDuration:E,viewabilityTestingInfo:C={},templateId:b=0,maxHeight:T,maxWidth:S}){this._async=e,this._captionCharacterLimit=t,this._headingCharacterLimit=i,this._cta=r,this._customOptions=new mt({...n}),this._defaultCode=s,this._demandEnabled=a,this._disclosure=l||gt.DEFAULT_DISCLOSURE,this._dvPlacementId=o,this._id=c,this._iframeBuster=d,this._iframeWrap=h,this._imageHeight=u,this._imageWidth=p,this._invCode=m,this._logoBlackList=g,this._provenTemplate=f,this._publisherId=v,this._replaceParent=_,this._sharingEnabled=y,this._staging=A,this._templateCode=I,this._templates=w,this._timeoutDuration=E||1e4,this._viewabilityTestingInfo=C,this._templateId=b,this._placementResizeConstraints={height:T,width:S},this._templateResizeConstraints=null}get async(){return this._async}get captionCharacterLimit(){return this._captionCharacterLimit}get headingCharacterLimit(){return this._headingCharacterLimit}get customOptions(){return this._customOptions}get cta(){return this._cta}get defaultCode(){return this._defaultCode}get demandEnabled(){return this._demandEnabled}get disclosure(){return this._disclosure}set disclosure(e){this._disclosure=e}get dvPlacementId(){return this._dvPlacementId}get id(){return this._id}get iframeBuster(){return this._iframeBuster}get iframeWrap(){return this._iframeWrap}get imageHeight(){return this._imageHeight}set imageHeight(e){this._imageHeight=e}get imageWidth(){return this._imageWidth}set imageWidth(e){this._imageWidth=e}get invCode(){return this._invCode}get logoBlackList(){return this._logoBlackList}get provenTemplate(){return this._provenTemplate}set provenTemplate(e){this._provenTemplate=e}get publisherId(){return this._publisherId}set replaceParent(e){this._replaceParent=e}get replaceParent(){return this._replaceParent}get sharingEnabled(){return this._sharingEnabled}get staging(){return this._staging}get templateCode(){return this._templateCode}set templateCode(e){this._templateCode=e}get templates(){return this._templates}get timeoutDuration(){return this._timeoutDuration}get viewabilityTestingInfo(){return this._viewabilityTestingInfo}get templateId(){return this._templateId}set templateId(e){this._templateId=e}get templateResizeConstraints(){return this._templateResizeConstraints}set templateResizeConstraints(e){this._templateResizeConstraints=e}get placementResizeConstraints(){return this._placementResizeConstraints}set placementResizeConstraints(e){this._placementResizeConstraints=e}}(0,g.A)(gt,"DEFAULT_CTA","See more"),(0,g.A)(gt,"DEFAULT_DISCLOSURE","Sponsored by");var ft=n(1);const vt=e=>{if("SCRIPT"===e.tagName&&e.className!==t.hj+"third-party")e.parentNode.replaceChild((e=>{const t=document.createElement("SCRIPT");t.text=e.innerHTML;let i=e.attributes.length-1;for(;i>=0;i--)t.setAttribute(e.attributes[i].name,e.attributes[i].value);return t})(e),e);else{let t=0;const i=e.childNodes;for(;t<i.length;)vt(i[t++])}return e};class _t{constructor(e){this.document=e.document,this.window=e.window}wrapAd(e,t){return ft.B.wrapAdString(e,t)}static insertAd(e,t,i){if(!t||!t.parentNode)throw new f.A("insertAd failed: hook element not on dom");const r=t.parentNode;!i||t.ownerDocument!==r&&"head"!==r.tagName.toLowerCase()?t.parentNode.insertBefore(e,t):t.ownerDocument.body.appendChild(e),vt(e)}static insertAdInIframe(e,t){if(!t||!t.parentNode)throw new f.A("insertAd failed: hook element not on dom");const i="iframe"===t.tagName.toLowerCase()?t.contentDocument:t.ownerDocument;if(!i)throw new f.A("insertAd failed: target document not found");i.body.appendChild(e),vt(e)}static serveDefaultFrame(e,t){if(!t)throw new f.A("serveDefaultFrame: tried to write default code but doc is unavailable");"complete"!==t.readyState&&t.open(),t.write(e),t.close()}}const yt=-1;function At({adWrapperWithDims:t,mainContent:i,positionService:n,pageInfo:s,bundleStartTime:a,firePix:o,errorHandler:l,adSlotId:c}){const d=n.getElDims(t),h=n.getElDims(i),u={ad_w:d.width,ad_h:d.height,img_w:h.width,img_h:h.height,render_time:Date.now()-a,ft:s.getFrameType(),plid:s.placement.id};if(s.isClientAware()){const e=n.getClientDims();u.client_w=e.width,u.client_h=e.height}else u.client_w=yt,u.client_h=yt;if(s.isPositionAware()){const e=function(e,t,i,r){let n,s;try{const r=e.ownerDocument.defaultView.top.document.body,a=i.getBoundingRect(r);n=t.top-a.top,s=t.left-a.left}catch(e){r.fireError({category:"Ad Positioning Retrieval",error:"could not access top when getting ad position",level:r.WARNING}),n=yt,s=yt}return{top:n,left:s}}(t,n.getBoundingRect(t),n,l);u.pos_left=e.left,u.pos_top=e.top}else u.pos_left=yt,u.pos_top=yt;c&&(u.asid=c),o.fireEB(e.oF,(0,r.dv)(u))}class It{constructor({hookFinder:e,docInfo:t,defaultCode:i,pageInfo:r,isFallback:n,urlParams:s},{firePix:a,asyncUtil:o,errorHandler:l}){this.hookFinder=e,this.docInfo=t,this.defaultCode=i,this.pageInfo=r,this.isFallback=n,this.firePix=a,this.asyncUtil=o,this.userSync=null,this.hasDefaulted=!1,this.adRendered=!1,this.errorHandler=l,this.urlParams=s}serve(t,i){if(this.hasDefaulted||this.adRendered)return;this.hasDefaulted=!0,It.renderDefault(this.defaultCode,this.hookFinder,this.docInfo,this.urlParams);const n={...(0,r.km)(this.pageInfo.get()),rr:t};i&&this.firePix.setAuctionId(i),this.firePix.fireEB(e.Z_,n),this.isFallback&&this.errorHandler.fireError({category:"Ad Positioning Retrieval",error:"Fallback auction failed to return creative",level:this.errorHandler.INFO}),this.userSync&&this.userSync.doSyncIfAllDone()}setUserSync(e){this.userSync=e}setIsFallback(e){this.isFallback=e}setDefaulted(){this.hasDefaulted=!0}static renderDefault(e,t,i,r){if(e)if(i.window!==top)_t.serveDefaultFrame(e,i.window.document);else{const n=new _t(i).wrapAd(e,r.forceShadowRoot);_t.insertAd(n,t.getHook())}}}class wt{constructor(e={}){this._settings=e;const t=this._settings.third_party_pixel_log_rate||0;this.shouldLogThirdPartyPixelData=Math.random()<t}get placementCategorizationRate(){return this._settings.placement_categorization_rate||0}get prvSampleRate(){return this._settings.prv_sample_rate||0}get pmdLogRate(){return this._settings.pmd_log_rate||0}get benchmarkLogRate(){return this._settings.benchmark_log_rate||0}get performanceMonitoringRate(){return this._settings.performance_monitoring_rate||.1}get performanceLoggingStrategy(){return this.getPerformanceLoggingStrategy()}getPerformanceLoggingStrategy(e){if(e&&e.tlLogCoordinated)return"COORDINATED";const t=Math.random(),i=this._settings.coordinated_performance_rate||.001,r=this._settings.benchmark_only_rate||.01,n=this._settings.performance_only_rate||.001;return t<i?"COORDINATED":t<i+r?"BENCHMARK_ONLY":t<i+r+n?"PERFORMANCE_ONLY":"NONE"}get activeviewLogRate(){return this._settings.activeview_log_rate||0}get ignoreSafeframeErrors(){return this._settings.ignore_safeframe_errors||0}get shouldLogThirdPartyPixel(){return this.shouldLogThirdPartyPixelData}get getCta(){return this._settings.cta||"Learn More"}}var Et=n(432),Ct=n(646);const bt={ias:2,dv:3,adelaide:12};class Tt{constructor({docInfo:e,placement:t,mainImage:i,adDIV:r,tacticDetails:n={},formatId:s,bundle:a,dealId:o,domain:l},{browserDetector:c,creative:d,firePix:h,errorHandler:u,urlParams:p}){this.docInfo=e,this.placement=t,this.mainImage=i,this.adDIV=r,this.viewabilityElement=r,this.browserDetector=c,this.creative=d,this.tacticDetails=n,this.formatId=s,this.firePix=h,this.errorHandler=u,this.bundle=a,this.dealId=o,this.domain=l,this.urlParams=p}appendTags(e){const t=this.addViewabilityTestJS(e,window),i=this.getIntegrations();for(let e=0;e<t.length;e++){const r=t[e];let n=!1;for(let e=0;e<i.length;e++)if(r&&r.match&&r.match(i[e].regex))try{i[e].action(r),n=!0;break}catch(e){this.errorHandler.fireError({error:e,level:this.errorHandler.WARNING,category:"Third Party Analytics Tags Append"})}n||this.defaultAction(r)}}getViewabilityID(){return this.viewabilityID||(this.viewabilityElement.id?this.viewabilityID=this.viewabilityElement.id:(this.viewabilityID="tltpvid_"+Math.round(1e5*Math.random()),this.viewabilityElement.id=this.viewabilityID)),this.viewabilityID}getViewabilityClass(){if(!this.viewabilityClass){if(this.viewabilityClass="tltpvclass_"+Math.round(1e5*Math.random()),!this.viewabilityElement||!this.viewabilityElement.classList)throw new f.A("getViewabilityClass failed: invalid viewabilityElement",this.errorHandler.WARNING);this.viewabilityElement.classList.add(this.viewabilityClass)}return this.viewabilityClass}appendScriptVE(e){const t=this.create3pScript(),i=this.mainImage;if(!i||!i.parentNode)throw new f.A("appendScriptVE failed: ve element not on dom");if(i.nextSibling)i.parentNode.insertBefore(t,i.nextSibling);else{const e=this.docInfo.document.createElement("IMG");e.style.display="none",i.parentNode.insertBefore(e,i),e.parentNode.insertBefore(i,e),e.parentNode.insertBefore(t,i.nextSibling),e.parentNode.removeChild(e)}t.src=e}appendScriptAd(e){const t=this.create3pScript();this.safeAppendScriptAd(t),t.src=e}safeAppendScriptAd(e){ft.B.shadowRootIsSupported()&&this.creative.useShadowRoot()?(this.add3pScriptSlot(this.adDIV),this.add3pScriptDiv(this.adDIV.parentNode.parentNode.host,e)):this.adDIV.appendChild(e)}defaultAction(e){const t=this.create3pScript();this.viewabilityElement.appendChild(t),t.src=e}create3pScript(){const e=this.docInfo.document.createElement("SCRIPT");return e.className=t.hj+"third-party",e}add3pScriptSlot(t){let i=t.querySelector("slot[name="+e.ib+"]");i||(i=this.docInfo.document.createElement("slot"),i.name=e.ib,t.appendChild(i))}add3pScriptDiv(t,i){let r=t.querySelectorHost("div[slot="+e.ib+"]");r||(r=this.docInfo.document.createElement("div"),r.slot=e.ib,t.appendChild(r)),r.appendChild(i)}interpolateDimensions(e){const t=this.mainImage.getBoundingClientRect();return e.replace("[WIDTH]",t.width).replace("[HEIGHT]",t.height).replace("[CONTAINER_ID]",this.getViewabilityID())}getIntegrations(){const e=this;return[{regex:/cdn\.adnxs/,action(t){e.appendScriptAd(t.replace("%native_dom_id%",e.getViewabilityID()))}},{regex:/cdn\.doubleverify/,action(t){var i;const r=t.replace("[TL_DEAL_ID]",encodeURIComponent(e.dealId||(null===(i=e.urlParams)||void 0===i?void 0:i.tlDealId))).replace("[TL_AUCTION_ID]",e.tacticDetails.aid).replace("[TL_CRID]",e.creative?e.creative.getExternalCreativeId():"").replace("[TL_PLACEMENT_ID]",e.placement.id).replace("[TL_DEVICE]",e.browserDetector.getDeviceTypeId(e.browserDetector.getDeviceType())).replace("[TL_TACTIC]",e.tacticDetails.tid).replace("[TL_PUBLISHER_ID]",e.placement.publisherId).replace("[TL_UA]",e.browserDetector.getUserAgent()).replace("[TL_BUNDLE]",encodeURIComponent(e.bundle)).replace("[TL_PAGE_URL]",encodeURIComponent(e.domain)).replace("[TL_DSP]",e.tacticDetails.bmid).replace("[TL_FORMAT_ID]",e.formatId).replace("[TL_GPID]",e.creative?e.creative.getPassedGpid():"").replace("[TL_TAG_ID]",e.creative?e.creative.getPassedTagId():"");e.appendScriptAd(r)}},{regex:/anId=931708/,action:t=>{e.appendScriptAd(t)}},{regex:/adsafeprotected/,action(t){const{tacticDetails:i}=e,r=void 0!==e.tacticDetails.advid;e.appendScriptVE(t.replace("$!{AD_ID}",e.placement.id).replace("$!{ADVERTISER_ID}",r?i.advid:"0").replace("$!{INSERTION_ORDER_ID}",r?i.ioid:i.bmid).replace("[TLVIEW_ID]",e.getViewabilityID()))}},{regex:/licdn/,action(t){e.appendScriptVE(t)}},{regex:/voicefive/,action(t){const i=t.replace("[PLACEMENT_ID]",e.placement.placementID).replace("[TLVIEW_ID]",e.getViewabilityID());e.appendScriptVE(i)}},{regex:/c\.betrad/,action(t){e.appendScriptAd(e.interpolateDimensions(t))}},{regex:/choices\.truste/,action(t){e.appendScriptAd(e.interpolateDimensions(t))}},{regex:/ybp\.yahoo/,action(t){e.appendScriptAd(t.replace("TLVIEW_ID",e.getViewabilityID()))}},{regex:/h6\.msn/,action(t){e.appendScriptAd(t.replace("TLVIEW_ID",e.getViewabilityID()))}},{regex:/fk\.unicornengine/,action(t){e.appendScriptAd(t.replace("TLVIEW_ID",e.getViewabilityID()).replace("PLACEMENT_ID",e.placement.id).replace("TIMESTAMP",Date.now()))}},{regex:/q\.adrta/,action(t){const i="[DIV_ID]",r=e.getViewabilityID(),n=t.includes(i)?t.replace(i,r):t+";divid="+r;e.appendScriptAd(n)}},{regex:/[a-z]+.adlooxtracking/,action(t){e.appendScriptAd(t.replace("[TLVIEW_ID]",e.getViewabilityID()))}},{regex:/asid=757a4107/,action(t){e.appendScriptAd(t.replace("[TLVIEW_ID]",e.getViewabilityID()))}},{regex:/asid=ha908adb/,action(t){let i=t.replace("[format_id]",e.formatId).replaceAll("[placement_id]",e.placement.id).replace("[TLVIEW_ID]",e.getViewabilityID());e.domain&&(i=i.replace("[domain]",encodeURIComponent(e.domain))),e.bundle&&(i=i.replace("[bundle]",encodeURIComponent(e.bundle))),e.dealId&&(i=i.replace("[deal_id]",encodeURIComponent(e.dealId))),e.appendScriptAd(i)}},{regex:/ts\.amazon-adsystem\.com/,action(t){const i=t.replace("[CONTAINERID]",e.getViewabilityID());e.creative.formatManager.isAmazonBrandedVideo()&&e.appendScriptAd(i)}}]}replaceIASMacros(e){let t=e;if(this.tacticDetails&&this.tacticDetails.aid&&(t=t.replace("[TL_AUCTION_ID]",this.tacticDetails.aid)),this.placement&&this.placement.id&&(t=t.replace("[TL_PLACEMENT_ID]",this.placement.id)),"function"==typeof this.creative.getAdSlotId&&this.creative.getAdSlotId()&&(t=t.replace("[TL_ADSLOT_ID]",this.creative.getAdSlotId())),this.browserDetector&&"function"==typeof this.browserDetector.getUserAgent&&this.browserDetector.getUserAgent()&&(t=t.replace("[TL_UA]",this.browserDetector.getUserAgent())),this.formatId&&(t=t.replace("[TL_FORMAT]",this.formatId)),this.placement&&this.placement.invCode&&(t=t.replace("[TL_PLACEMENT_NAME]",this.placement.invCode)),this.urlParams.tlTacticId?t=t.replace("[TL_TACTIC]",this.urlParams.tlTacticId):this.tacticDetails.tid&&(t=t.replace("[TL_TACTIC]",this.tacticDetails.tid)),this.browserDetector&&"function"==typeof this.browserDetector.getUserAgent&&"function"==typeof this.browserDetector.getDeviceType&&"function"==typeof this.browserDetector.getDeviceTypeId){const e=this.browserDetector.getDeviceType(),i=this.browserDetector.getDeviceTypeId(e);i&&(t=t.replace("[TL_DEVICE]",i))}return this.urlParams.tlDealId?t=t.replace("[TL_DEAL_ID]",encodeURIComponent(this.urlParams.tlDealId)):this.dealId&&(t=t.replace("[TL_DEAL_ID]",encodeURIComponent(this.dealId))),this.tacticDetails.bmid&&(t=t.replace("[TL_DSP]",this.tacticDetails.bmid)),this.placement&&this.placement.publisherId&&(t=t.replace("[TL_PUBLISHER_ID]",this.placement.publisherId)),this.creative&&(this.urlParams.tlCreativeId?t=t.replace("[TL_CRID]",this.urlParams.tlCreativeId):"function"==typeof this.creative.getExternalCreativeId&&this.creative.getExternalCreativeId()&&(t=t.replace("[TL_CRID]",this.creative.getExternalCreativeId())),"function"==typeof this.creative.getPassedGpid&&this.creative.getPassedGpid()&&(t=t.replace("[TL_GPID]",this.creative.getPassedGpid())),"function"==typeof this.creative.getPassedTagId&&this.creative.getPassedTagId()&&(t=t.replace("[TL_TAG_ID]",this.creative.getPassedTagId())),"function"==typeof this.creative.getParentId&&this.creative.getParentId()&&(t=t.replace("[TL_PARENT_ID]",this.creative.getParentId()))),t}handleIASDrops(e,t,i,r){t.ias&&this.addIASPixel(e,r,t,i)}addIASPixel(t,i,r,n){const s=i+"//pixel.adsafeprotected.com/jload?anId=931708&campId=[TL_FORMAT]&placementId=[TL_PLACEMENT_ID]&asid=[TL_ADSLOT_ID]&pubCreative=[TL_CRID]&pubOrder=[TL_TACTIC]&custom=[TL_DEAL_ID]&custom2=[TL_DEVICE]&custom3=[TL_UA]&custom4=[TL_PARENT_ID]&custom5=[TL_PLACEMENT_NAME]&custom6=[TL_PUBLISHER_ID]&custom7=[TL_DSP]&custom8=[TL_GPID]&custom9=[TL_TAG_ID]&adsafe_par&impId=[TL_AUCTION_ID]";t.push(this.replaceIASMacros(s)),n.vid=bt.ias,n.sr=r.ias,this.firePix.fireEB(e.re,n)}addClassToAnchors(e,t){const i=e.getElementsByTagName("a");if(i&&0!==i.length)for(let e=0;e<i.length;e++)i[e].classList.add(t)}labelAnchorTags(e){this.adDIV&&e.forEach(e=>{e.attr&&e.attr["data-tgt"]&&this.addClassToAnchors(this.adDIV,e.attr["data-tgt"])})}addViewabilityTestJS(t,i){const r=this.creative.getParams(),n=r.viewability||{},s=r.javascripts,a={pid:this.placement.id,unid:r.additional_data.unid||0};let o=i,l=null;try{do{"http:"!==o.location.protocol&&"https:"!==o.location.protocol||(l=o.location.protocol),o=o.parent}while(null===l&&o.parent&&o!==o.parent)}catch(e){l="https:"}if(null===l&&(l="https:"),Array.isArray(s))try{s.forEach(e=>{const t=this.create3pScript();t.src=e.src,t.async="async",Object.entries(e.attr).forEach(([e,i])=>{t.setAttribute(e,i)}),this.safeAppendScriptAd(t)})}catch(e){this.errorHandler.fireError({category:"Third Party JS Viewability",error:"HUMAN: Couldn't drop sonar JS tag",level:this.errorHandler.WARNING,diagnosticContext:{message:e.message}})}finally{this.labelAnchorTags(s)}if(this.creative.formatManager.isAutoplayVideo()&&!this.creative.formatManager.isComponentVideo())return Object.keys(n).forEach(t=>{n[t]&&(a.vid=bt[t],a.sr=n[t],this.firePix.fireEB(e.re,a))}),t;if(this.handleIASDrops(t,n,a,l),n.adelaide&&(t.push(l+"//aam.a47b.com/aam?asid=ha908adb&st=[domain]&ra=[cachebuster]&pl=[placement_id]&did=[deal_id]&li=[format_id]&nid=[bundle]&io=[campaign]&iid=[impid]&gdprc=${GDPR_CONSENT_1019}&gdpr=${GDPR}&edst=[placement_id]&pelc=[TLVIEW_ID]"),a.vid=bt.adelaide,a.sr=n.adelaide,this.firePix.fireEB(e.re,a)),n.dv){[2,8,9,11,17,19].includes(this.formatId)||t.push(l+"//cdn.doubleverify.com/dvtp_src.js?ctx=34922342&cmp=DV1475451&sid=triplelift&plc=TL-IQMBFV-DISPJS&adsrv=0&advid=3891363&autt=1&dvtagver=6.1.src&ppid=352&audeal=[TL_DEAL_ID]&auevent=[TL_AUCTION_ID]&aucrtv=[TL_CRID]&auplc=[TL_PLACEMENT_ID]&auxch=[AUCTION_EXCHANGE_ID]&audvc=[TL_DEVICE]&aulitem=[TL_TACTIC]&pltfrm=[TL_PUBLISHER_ID]&aufilter2=IQMBFV&auip=[TL_IP]&DVPX_PP_AUCTION_UA=[TL_UA]&aubndl=[TL_BUNDLE]&turl=[TL_PAGE_URL]&c1=[TL_DSP]&c2=[TL_FORMAT_ID]&c3=[TL_GPID]&auadid=[TL_TAG_ID]&gdpr=${GDPR}&gdpr_consent=${GDPR_CONSENT_126}"),a.vid=bt.dv,a.sr=n.dv,this.firePix.fireEB(e.re,a)}return t}}const St=1,Mt=2,Rt=0,Pt=1,Dt=2,xt=3,Nt=4,Lt=6;class Ot{constructor({docInfo:e,pageInfo:t,placement:i,settings:r},{browserDetector:n,creative:a,auctionIframeWriterOverride:o,firePix:l,errorHandler:c,eventController:d,formatManager:h,urlParams:u}){(0,g.A)(this,"browserDetector",void 0),(0,g.A)(this,"firePix",void 0),(0,g.A)(this,"auctionIframeWriterOverride",void 0),(0,g.A)(this,"macros",void 0),(0,g.A)(this,"settings",void 0),(0,g.A)(this,"formatManager",void 0),(0,g.A)(this,"docInfo",void 0),(0,g.A)(this,"placement",void 0),(0,g.A)(this,"errorHandler",void 0),(0,g.A)(this,"creative",void 0),(0,g.A)(this,"creativeParams",void 0),(0,g.A)(this,"shouldWaitForPassthru",!0),(0,g.A)(this,"passthruClickTracker",null),(0,g.A)(this,"passthruTimer",null),(0,g.A)(this,"thirdPartyJS",null),(0,g.A)(this,"hasBilled",!1),(0,g.A)(this,"isCachedAppendJsEvent",!1),(0,g.A)(this,"numClicks",0),(0,g.A)(this,"cachedTrackers",[]),(0,g.A)(this,"cachedCarouselIndexes",[]),(0,g.A)(this,"firedThirdPartyTrackers",new Set),this.docInfo=e,this.pageInfo=t,this.placement=i,this.browserDetector=n,this.creative=a,this.creativeParams=a.getParams(),this.firePix=l,this.auctionIframeWriterOverride=o,this.errorHandler=c,this.eventController=d,this.settings=r,this.formatManager=h,this.domRefs=null,this.urlParams=u,d.on(s.NK,(...e)=>this.passthru(...e)),d.on(s.Ol,e=>{this.domRefs=e})}passthru(e,t){if(!this.shouldWaitForPassthru)return;this.shouldWaitForPassthru=!1,clearTimeout(this.passthruTimer),this.passthruClickTracker=(0,r.Vp)(e),this.macros="string"==typeof t?JSON.parse(t):t,this.macros=this.replaceAllDisplayClickMacros(this.macros),this.fireAllCachedTrackers(),this.expandAllClickThroughMacros();this.creativeParams.nob_passthru&&this.creative.getVastTag()&&this.macros&&this.expandVastTrackers()}expandTracker(e){e.textContent=this._expandMacros(this.macros,e.textContent)}expandVastTrackers(){const e=this.creative.getVastTag();e.addExpandClickTrackersListener(()=>{try{const t={impressions:e.getImpressionTrackers(),mediaFiles:e.getMediaFiles(),clickTrackers:e.getVideoClickTrackers(),clickthrough:e.getVastClickThrough(),assortedTrackers:e.getAssortedTrackers()};Object.keys(t).forEach(e=>{Array.isArray(t[e])?t[e].forEach(e=>this.expandTracker(e)):t[e]&&this.expandTracker(t[e])})}catch(e){this.errorHandler.fireError({category:"Third Party Analytics Vast Tracker Expansion",error:e,level:this.errorHandler.ERROR})}})}fireAllCachedTrackers(){this.firePreviousClicks(),this.fireCachedTrackers(),this.fireCachedJs()}expandAllClickThroughMacros(){const e="clickthrough_url";this.creativeParams={...this.creativeParams,[e]:this.expandClickThroughMacro(this.creativeParams),allImages:this.creativeParams.allImages.map(t=>({...t,[e]:this.expandClickThroughMacro(t)}))}}expandClickThroughMacro(e){const t=this._expandMacros(this.macros,e.origClickThroughUrl);return this.creative.expandAndRedirectClickThrough(e,t)}replaceAllDisplayClickMacros(e){const t=e;if(null!=t){Object.keys(t).forEach(e=>{const i=t[e],n=(0,r.Vp)(i);t[e]=n})}return t}fireCachedTrackers(){this.cachedTrackers.map(e=>({tracker:this._expandMacros(this.macros,e.tracker),trackerType:e.trackerType})).forEach(e=>{this.firePix.logThirdPartyTracker(e.trackerType,e.tracker),this.firePix.fire(e.tracker)})}fireCachedJs(){this.isCachedAppendJsEvent&&this._appendJs()}firePreviousClicks(){const t=this._expandMacros(this.macros,this.passthruClickTracker);for(let i=0;i<this.numClicks;i++)this.firePix.logThirdPartyTracker(e.f6.TPT_CLICK,t),this.firePix.fire(t)}billOrWait(){const e=this.creativeParams.billable_event;e&&e!==Rt&&e!==Pt||this.bill()}bill(){this.hasBilled||(this.hasBilled=!0,this.creativeParams.billable_pixel&&this.firePix.fire(this.creativeParams.billable_pixel),this.creativeParams.nob_passthru?this._startPassthruTimer():(this.shouldWaitForPassthru=!1,this.fireAllCachedTrackers()),this.creativeParams.ad_markup&&this.auctionIframeWriterOverride.newWriter(this.creativeParams.ad_markup))}fire3pTracker(e,t){if(this.shouldWaitForPassthru)this.cacheTracker(e,t);else{const i=this._expandMacros(this.macros,e);this.firePix.logThirdPartyTracker(t,i),this.firePix.fire(i)}}cacheTracker(e,t){this.cachedTrackers.push({tracker:e,trackerType:t})}markTrackerAsFiredAndTestIfDuplicate(e){const t=e&&!this.firedThirdPartyTrackers.has(e);return this.firedThirdPartyTrackers.add(e),t}fireImpression(){const t=this.creativeParams.impression_pixels||[];this.creativeParams.allImages.reduce((e,t)=>e.concat(t.thirdPartyTrackers.impressionPixels),t).filter(this.markTrackerAsFiredAndTestIfDuplicate.bind(this)).forEach(t=>this.fire3pTracker.bind(this)(t,e.f6.TPT_IMPRESSION))}fireCarouselImpression(t=0){if(!this.cachedCarouselIndexes.includes(t)){this.cachedCarouselIndexes.push(t);(this.creative.getAllImages()[t].thirdPartyTrackers.impressionPixels||[]).forEach(t=>{this.fire3pTracker.bind(this)(t,e.f6.TPT_IMPRESSION)})}}fireClick(t){let i;this.numClicks++,i=t?this.creativeParams.allImages[t]:this.creativeParams;let r=i.thirdPartyTrackers.clickPixels;this.passthruClickTracker&&(r=r.concat([this.passthruClickTracker])),this.creativeParams.billable_event===Nt&&this.bill(),r.forEach(t=>this.fire3pTracker.bind(this)(t,e.f6.TPT_CLICK))}fireViewable(){this.creativeParams.billable_event===Dt&&this.bill();const t=this.creativeParams.viewability_pixels||[];this.creativeParams.allImages.reduce((e,t)=>e.concat(t.thirdPartyTrackers.viewabilityPixels),t).filter(this.markTrackerAsFiredAndTestIfDuplicate.bind(this)).forEach(t=>this.fire3pTracker.bind(this)(t,e.f6.TPT_VIEWABILITY))}fireOnePxViewable(){this.creativeParams.billable_event===Lt&&this.bill()}firePlay(){this.creativeParams.billable_event===xt&&this.bill()}appendJsOnPassthru(e){const t=this.pageInfo.get().ref,i=(0,r.o_)(t).host;this.thirdPartyJS=new Tt({docInfo:this.docInfo,placement:this.placement,mainImage:e,adDIV:this.domRefs.adWrapperWithDims,tacticDetails:this.creativeParams.additional_data,formatId:this.creativeParams.format_id,bundle:(0,r.vC)(this.creativeParams.bundle),dealId:this.creativeParams.deal_id,domain:i},{browserDetector:this.browserDetector,creative:this.creative,firePix:this.firePix,errorHandler:this.errorHandler,urlParams:this.urlParams}),this.shouldWaitForPassthru?this.isCachedAppendJsEvent=!0:this._appendJs()}_appendJs(){const t=this.creativeParams.js_trackers||[],i=this.creativeParams.allImages.reduce((e,t)=>e.concat(t.thirdPartyTrackers.jsTrackers),t).filter(this.markTrackerAsFiredAndTestIfDuplicate.bind(this));this._handleAdVerifications(i),i.forEach(t=>{this.firePix.logThirdPartyTracker(e.f6.TPT_JAVASCRIPT,t)}),this.thirdPartyJS.appendTags(i.map(e=>this._expandMacros(this.macros,e)))}_supportsOmid(){return!!this.creativeParams&&!!this.creativeParams.omid}_handleAdVerifications(e){var t;if(this._fireRejectedAdVerificationEvents(),this._fireUnsupportedAdVerificationEvents(),!this._supportsOmid())return;const i=null===(t=this.creative.getVastTag())||void 0===t?void 0:t.getAdVerifications();if(!i||(null==i?void 0:i.length)<=0)return;new Ct.A({docInfo:this.docInfo,domRefs:this.domRefs,errorHandler:this.errorHandler,eventController:this.eventController,pageInfo:this.pageInfo,vastTag:this.creative.getVastTag()}).run()||i.forEach(t=>{e.push(t.url)})}_fireRejectedAdVerificationEvents(){var e;if(this._supportsOmid())return;const t=null===(e=this.creative.getVastTag())||void 0===e?void 0:e.vastParser.getVerificationTrackers(e=>e.querySelector('JavaScriptResource[apiFramework="omid"]'));this._fireAdVerificationEvents(t,St)}_fireUnsupportedAdVerificationEvents(){var e;const t=null===(e=this.creative.getVastTag())||void 0===e?void 0:e.vastParser.getVerificationTrackers(e=>!e.querySelector('JavaScriptResource[apiFramework="omid"]'));this._fireAdVerificationEvents(t,Mt)}_fireAdVerificationEvents(e,t){e&&Array.isArray(e)&&e.forEach(e=>{if(!e)return;const i=e.replace("[REASON]",t);this.firePix.fire(i)})}_expandMacros(e,t){if(!e||!t)return t;let i=t;(0,r.ub)(e,(e,t)=>{try{let n=e;if("%"===e[0]&&"{"===e[1])n="$"+e.slice(1);else if("%"===e[0]&&"["===e[1])n="{"+e.slice(2,e.length-1)+"}";else if("$"===e[0]&&"{"===e[1])n=e[0]+e.slice(1,e.length);else if("$"===e[0]&&"!TL"===e.slice(1,4)&&"{"===e[4]){const t="!";n=e[0]+t+e.slice(4,e.length)}else n=e[0]+e.slice(3,e.length);n=new RegExp((0,r.Nt)(n),"g"),i=i.replace(n,t)}catch(e){this.errorHandler.fireError({category:"Third Party Analytics Macros Expansion",error:e,level:this.errorHandler.WARNING})}});const n=this._containsMacroPlaceholder(i);return n&&this.errorHandler.fireError({category:"Third Party Analytics Macros Expansion",error:"Macros were not expanded",level:this.errorHandler.WARNING,diagnosticContext:{missingMacros:n},sampleRate:.01}),i}_containsMacroPlaceholder(e){return e.match(/%%%.*?%%%|\$?\{.*?\}/g)}_startPassthruTimer(){this.passthruTimer=setTimeout(()=>{this.errorHandler.fireError({category:"Third Party Analytics Passthru Timer",error:"Passthru invocation timed out",level:this.errorHandler.ERROR})},8e3)}}class kt{constructor({placement:e,environment:t,topWindow:i,debugFlag:r,gdpr:n}){this.placement=e,this.environment=t,this.window=i,this.debugFlag=r,this.gdpr=n,this.tlSyncDone=!1,this.window._tlTagsPending=(this.window._tlTagsPending||0)+1}async doSync(){if(this.tlSyncDone)return;this.tlSyncDone=!0;const e={},{maxUserSyncs:t}=this.placement.customOptions;if(t&&(e.max=t),this.debugFlag&&(e.debug=1),this.gdpr){await this.gdpr.getCMPData();const t=this.gdpr.cmpData;if(t&&t.gdprApplies&&!t.tripleliftConsent)return;if(t){const i=this.getGdprParams(t);Object.assign(e,i)}}this.fireUserSync(e)}getGdprParams(e){const t={};return t.gdpr=!!e.gdprApplies,e.consentString&&(t.cmp_cs=e.consentString),e.gppString&&(t.gpp=e.gppString),e.gppApplicableSections&&e.gppApplicableSections.length>0&&(t.gpp_sid=e.gppApplicableSections.join(",")),t}fireUserSync(e){const t=document.createElement("iframe");t.addEventListener("load",r.vw.bind(null,t)),t.src=(0,r.j7)(this.environment.ebPath,"sync",e),(0,r.xo)(t),document.body.appendChild(t)}doSyncIfAllDone(){if(0===--this.window._tlTagsPending)if("complete"===this.window.document.readyState)this.doSync();else{const e=this;this.window.addEventListener("load",()=>{e.doSync()},!1)}}}class jt{constructor(e,t){this.errorDecorator=e,this.topWindow=t}isFunction(e){return"function"==typeof e}addScrollListener(e=window,t){let i=t;return this.isFunction(this.errorDecorator)&&(i=this.errorDecorator(i)),e.addEventListener("DOMContentLoaded",i,!1),e.addEventListener("load",i,!1),e.addEventListener("scroll",i,!1),e.addEventListener("resize",i,!1),i}addDocumentFontListener(){var e,t;null===(e=document)||void 0===e||null===(t=e.fonts)||void 0===t||t.addEventListener("loadingdone",()=>{this.topWindow.dispatchEvent(new Event("resize"))})}addResizeListener(e){let t=e;return this.isFunction(this.errorDecorator)&&(t=this.errorDecorator(t)),this.topWindow.addEventListener("DOMContentLoaded",t,!1),this.topWindow.addEventListener("load",t,!1),this.topWindow.addEventListener("resize",t,!1),t}listen(e,t,i,r,n){let s=i;return this.isFunction(this.errorDecorator)&&(s=this.errorDecorator(s)),n&&(s=this.decorateStopAndPrevent(s)),e.addEventListener(t,s,r),s}decorateStopAndPrevent(e){return function(t,...i){t.stopPropagation(),t.preventDefault(),e.apply(this,i)}}timeoutWrap(e,t){const i=this.isFunction(this.errorDecorator)?this.errorDecorator(e):e;return setTimeout(i,t)}}class Ft{constructor({placement:e,docInfo:t},{positionService:i,errorHandler:r,eventController:n,asyncUtil:s}){this.placement=e,this.docInfo=t,this.document=t.document,this.window=t.window,this.positionService=i,this.errorHandler=r,this.eventController=n,this.asyncUtil=s,this.listeners=[],this.listenerTimeoutId=0}listenForPercentageAdViewability(e,t){const i=Ft.getRequiredPct(e);let r=0;this.setListener({handler:t,condition:()=>{const e=0!==r;if(this.docInfo.isInFocus()&&e&&performance.now()-r>=1e3)return!0;const t=this.positionService.getAdPctInView()>=i;return t&&!e?r=performance.now():!t&&r&&(r=0),!1}})}listenForOnePxAdViewability(e){const t=()=>this.docInfo.isInFocus()&&this.positionService.getAdPctInView()>0;this.setListener({handler:e,condition:t});const i=()=>{t()&&(this.eventController.off(s.cC,i),e())};this.eventController.on(s.cC,i)}listenForFullAdViewability(e){this.setListener({handler:e,condition:()=>1===this.positionService.getAdPctInView()})}static getRequiredPct(e){return e.clientWidth*e.clientHeight>=242500?.3:.5}setListener(e){this.listeners.push(e),this.listen()}listen(){if(this.listenerTimeoutId>0)return;const e=()=>{this.listeners=this.listeners.filter(e=>!e.condition()||(e.handler(),!1)),this.listeners.length>0?this.listenerTimeoutId=this.asyncUtil.timeoutWrap(e,100):this.listenerTimeoutId=0};this.listenerTimeoutId=this.asyncUtil.timeoutWrap(e,100)}}var Vt=n(606);class Ht{constructor({settings:e,revision:t,isTestEnv:i,ttjStartTime:r=0},{eventController:n,firePix:s,errorHandler:a,formatManager:o}){this.settings=e,this.revision=t,this.isTestEnv=i||!1,this.ttjStartTime=r,this.eventController=n,this.firePix=s,this.errorHandler=a,this.formatManager=o,this.observers=new Map,this.metrics=new Map,this.observationCount=0,this.formatId=null,this.isHeaderBidding=!1,this.templateResourcesLoading=new Map,this.maxRegistrationAge=3e4,this.registrationCleanupInterval=null,this.assetMemoryUsage={totalTransferSize:0,totalDecodedSize:0,byType:{javascript:{transferSize:0,decodedSize:0,count:0},css:{transferSize:0,decodedSize:0,count:0},image:{transferSize:0,decodedSize:0,count:0},font:{transferSize:0,decodedSize:0,count:0},video:{transferSize:0,decodedSize:0,count:0},other:{transferSize:0,decodedSize:0,count:0}}},this.domMemoryTracking={createdElements:new Set,totalNodes:0},this.domObserver=null,this._checkBrowserSupport()&&this._initialize()}_initialize(){try{this._setupResourceObserver(),this._setupLongTaskObserver(),this._setupDOMMemoryTracking(),this._setupEventListeners(),this._setupRegistrationCleanup(),this.trackMilestone("performance_monitor_init")}catch(e){this._handleError("Failed to initialize PerformanceMonitor",e)}}_checkBrowserSupport(){return!!(window.PerformanceObserver&&window.performance&&window.performance.mark&&window.performance.measure)}_setupResourceObserver(){if(!PerformanceObserver.supportedEntryTypes.includes("resource"))return;const e=new PerformanceObserver(e=>{const t=e.getEntries();this._processResourceEntries(t)});e.observe({entryTypes:["resource"]}),this.observers.set("resource",e)}_setupLongTaskObserver(){if(!PerformanceObserver.supportedEntryTypes.includes("longtask"))return;const e=new PerformanceObserver(e=>{const t=e.getEntries();this._processLongTaskEntries(t)});e.observe({entryTypes:["longtask"]}),this.observers.set("longtask",e)}_setupEventListeners(){this.eventController.on(s.e8,e=>{var t,i;const r=null===(t=e.ad)||void 0===t||null===(i=t.ext)||void 0===i?void 0:i.tlFormatId;this.setFormatId(r),this.trackMilestone("auction_response_received"),this._registerCreativeAssets(e),this.formatManager.isAutoplayVideo()?this.eventController.on(s.tr,()=>{this.trackMilestone("video_play"),this._measureAdLoadSequence()}):this.eventController.on(s.Ol,()=>{this.trackMilestone("ad_on_page"),this._measureAdLoadSequence()});setTimeout(()=>{this._logApplicationMemoryUsage()},3e3)})}trackMilestone(e,t={}){try{const{timestamp:i=Math.round(performance.now()),timeSinceStart:r,timeSinceLast:n,source:s="performance_monitor",additionalData:a={},createPerformanceMark:o=!0}=t;if(o)try{const t="benchmark"===s?"benchmark_"+e:"tlpm_"+e;performance.getEntriesByName(t,"mark").length>0?this.isTestEnv&&console.log("Skipping duplicate performance mark: "+t):performance.mark(t)}catch(t){this._handleError("Failed to mark event: "+e,t)}this.metrics.has("milestones")||this.metrics.set("milestones",[]);const l=this.metrics.get("milestones"),c={name:e,timestamp:i,source:s};let d;if(r&&r>0&&(c.timeSinceStart=Math.round(r)),n&&n>0)d=n;else{const e=this._calculateTimeSinceLast(i);e>0&&(d=e)}if(d>0&&(c.timeSinceLast=d),a&&Object.keys(a).length>0&&(c.additionalData=a),"benchmark"!==s){const e=this._getQuickMemorySnapshot();e&&(e.totalAssetSize>0||e.assetCount>0||e.jsHeapUsed)&&(c.memorySnapshot=e)}l.push(c),this._logMilestone(e,i,a,s)}catch(t){this._handleError("Failed to track milestone: "+e,t)}}captureBenchmarkMilestone(e,t,i,r){this.trackMilestone(e,{timestamp:t,timeSinceStart:i,timeSinceLast:r,source:"benchmark",createPerformanceMark:!0})}_calculateTimeSinceLast(e){try{const t=this.metrics.get("milestones")||[];if(0===t.length)return 0;return e-t[t.length-1].timestamp}catch(e){return 0}}_logMilestone(e,t,i,r="performance_monitor"){const n={name:e,timestamp:t,source:r};i&&Object.keys(i).length>0&&(n.additionalData=i);const s={};this.formatId&&(s.formatId=this.formatId),!1!==this.isHeaderBidding&&(s.isHeaderBidding=this.isHeaderBidding),this.observationCount>0&&(s.observationCount=this.observationCount),Object.keys(s).length>0&&(n.context=s),this._logMetric("milestone",n)}_getQuickMemorySnapshot(){try{const e={timestamp:Math.round(performance.now()),assetCount:Object.values(this.assetMemoryUsage.byType).reduce((e,t)=>e+t.count,0),totalAssetSize:this.assetMemoryUsage.totalTransferSize};return window.performance.memory&&(e.jsHeapUsed=window.performance.memory.usedJSHeapSize),e.totalAssetSize>0||e.assetCount>0||e.jsHeapUsed>0?e:null}catch(e){return null}}_processResourceEntries(e){const t={tracked:0,skipped:0,registered:0};e.forEach(e=>{if(this._shouldSkipEntry(e))return void t.skipped++;const i=this._isKnownTemplateResource(e.name),r=this._isApplicationResource(e);if(!i&&!r)return void t.skipped++;t.tracked++,i&&t.registered++;const n=this._trackAssetMemory(e),s={name:e.name,type:this._getResourceType(e),duration:Math.round(e.duration),transferSize:n.transferSize,encodedBodySize:e.encodedBodySize||0,decodedBodySize:n.decodedSize,domainLookupTime:e.domainLookupEnd-e.domainLookupStart,connectTime:e.connectEnd-e.connectStart,requestTime:e.responseStart-e.requestStart,responseTime:e.responseEnd-e.responseStart};this._logMetric(Ht.METRICS.RESOURCE_LOAD,s),i&&this.templateResourcesLoading.delete(this._normalizeUrl(e.name))})}_processLongTaskEntries(e){e.forEach(e=>{if(e.duration>=Ht.THRESHOLDS.LONG_TASK_MS){var t;const i={duration:Math.round(e.duration),startTime:Math.round(e.startTime),attribution:(null===(t=e.attribution)||void 0===t?void 0:t.map(e=>({name:e.name,entryType:e.entryType,startTime:Math.round(e.startTime),duration:Math.round(e.duration)})))||[]};this._logMetric(Ht.METRICS.LONG_TASK,i)}})}_logApplicationMemoryUsage(){const e=this.calculateEstimatedAppMemory();this._logMetric(Ht.METRICS.IB_MEMORY_USAGE,e)}_measureAdLoadSequence(){try{const e=performance.getEntriesByType("mark").filter(e=>e.name.startsWith("tlpm_")||e.name.startsWith("benchmark_")),t=this.metrics.get("milestones")||[];if(0===t.length&&0===e.length)return;const i=this._createOptimizedSequenceData(e,t);this._logMetric(Ht.METRICS.AD_LOAD_SEQUENCE,i)}catch(e){this._handleError("Failed to measure ad load sequence",e)}}_createOptimizedSequenceData(e,t){const i={};if(e.length>0){const r=this._analyzeLoadSequence(e,t);i.totalLoadTime=Math.round(r.totalLoadTime),i.criticalPathDuration=Math.round(r.criticalPathDuration);const n=r.bottlenecks.filter(e=>"high"===e.severity);n.length>0&&(i.criticalBottlenecks=n.map(e=>({type:e.type,duration:Math.round(e.duration),severity:e.severity})))}const r=this._getKeyMilestones(t);return r.length>0&&(i.keyMilestones=r),i.meta={milestoneCount:t.length,observationCount:this.observationCount},i}_getKeyMilestones(e){const t=["auction_response_received","render_start","render_complete","ad_on_page","resources_loaded"];return e.filter(e=>t.includes(e.name)).slice(0,5).map(e=>({name:e.name,timestamp:Math.round(e.timestamp),timeFromTTJ:e.timeFromTTJ?Math.round(e.timeFromTTJ):void 0})).filter(e=>void 0!==e.timeFromTTJ)}_analyzeLoadSequence(e,t){const i={totalLoadTime:0,criticalPathDuration:0,parallelLoadingEfficiency:0,bottlenecks:[],phaseBreakdown:{}};if(0===e.length)return i;const r=e[0],n=e[e.length-1];return i.totalLoadTime=n.startTime-r.startTime,i.phaseBreakdown=this._identifyLoadingPhases(e),i.bottlenecks=this._identifyBottlenecks(e,t),i.parallelLoadingEfficiency=this._calculateParallelEfficiency(),i.criticalPathDuration=this._calculateCriticalPath(e),i}_identifyLoadingPhases(e){const t={initialization:{start:null,end:null,duration:0},resourceLoading:{start:null,end:null,duration:0},rendering:{start:null,end:null,duration:0},completion:{start:null,end:null,duration:0}};return e.forEach(e=>{const i=e.name.replace("tlpm_","");i.includes("init")||i.includes("start")?(t.initialization.start||(t.initialization.start=e.startTime),t.initialization.end=e.startTime):i.includes("resource")||i.includes("load")?(t.resourceLoading.start||(t.resourceLoading.start=e.startTime),t.resourceLoading.end=e.startTime):i.includes("render")||i.includes("display")?(t.rendering.start||(t.rendering.start=e.startTime),t.rendering.end=e.startTime):(i.includes("complete")||i.includes("finish"))&&(t.completion.start||(t.completion.start=e.startTime),t.completion.end=e.startTime)}),Object.keys(t).forEach(e=>{const i=t[e];i.start&&i.end&&(i.duration=i.end-i.start)}),t}_identifyBottlenecks(e,t){const i=[];for(let t=1;t<e.length;t++){const r=e[t-1],n=e[t],s=n.startTime-r.startTime;s>Ht.THRESHOLDS.BOTTLENECK_THRESHOLD_MS&&i.push({type:"milestone_gap",description:"Long gap between "+r.name+" and "+n.name,duration:s,severity:s>Ht.THRESHOLDS.SEVERE_BOTTLENECK_MS?"high":"medium"})}const r=1024*Ht.THRESHOLDS.LARGE_RESOURCE_KB,n=Object.values(this.assetMemoryUsage.byType).filter(e=>e.transferSize>r);return n.length>0&&i.push({type:"large_resources",description:n.length+" large resources detected",resourceCount:n.length,severity:"medium"}),t.length,i}_calculateParallelEfficiency(){const e=Object.values(this.assetMemoryUsage.byType).reduce((e,t)=>e+t.count,0),t=this.assetMemoryUsage.totalTransferSize;if(0===e)return 1;const i=t/e,r=Math.min(e/3,1),n=1-i/1048576;return Math.min(r*n,1)}_calculateCriticalPath(e){if(e.length<2)return 0;const t=e[0];return e[e.length-1].startTime-t.startTime}trackRenderEvent(e,t=performance.now()){try{const i=Math.round(performance.now()),r=Math.round(t),n={eventName:e,duration:Math.round(i-t),startTime:r,endTime:i};this._logMetric(Ht.METRICS.RENDER_PERFORMANCE,n)}catch(t){this._handleError("Failed to track render event: "+e,t)}}trackDOMPerformance(e,t){const i=Math.round(performance.now());try{const r=t(),n=Math.round(performance.now()),s={operation:e,duration:n-i,startTime:i,endTime:n};return this._logMetric(Ht.METRICS.DOM_PERFORMANCE,s),r}catch(t){throw this._handleError("DOM operation failed: "+e,t),t}}setFormatId(e){this.formatId=e}setIsHeaderBidding(e){this.isHeaderBidding=e}_logMetric(e,t){if(!(this.observationCount>=Ht.THRESHOLDS.MAX_OBSERVATIONS)){this.observationCount++;try{if(this.isTestEnv)console.log("PerformanceMonitor:",{type:"pm_"+e,timeSinceStart:Math.round(performance.now()-(this.ttjStartTime||0)),clientSideAuction:!this.isHeaderBidding,formatId:this.formatId,revision:this.revision,data:t});else{const r={type:"pm_"+e,timeSinceStart:Math.round(performance.now()-(this.ttjStartTime||0)),timeSinceLast:0,clientSideAuction:!this.isHeaderBidding,formatId:this.formatId};this.firePix.firePerf(r),t.formatId=this.formatId,t.clientSideAuction=!this.isHeaderBidding,t.revision=this.revision,this.firePix.fireDyn({string2:e,string3:JSON.stringify(t),long1:i.sT,long2:Math.round(performance.now()-(this.ttjStartTime||0))})}}catch(e){this._handleError("Failed to log performance metric",e)}}}_shouldSkipEntry(e){if(e.name.startsWith("data:")||e.name.startsWith("blob:"))return!0;return!("video"===e.initiatorType)&&e.transferSize<100}_getResourceType(e){const t=e.name.toLowerCase(),i=e.initiatorType;return"img"===i||/\.(jpg|jpeg|png|gif|webp|svg)(\?|$)/i.test(t)?"image":"script"===i||/\.js(\?|$)/i.test(t)?"script":"link"===i||/\.css(\?|$)/i.test(t)?"stylesheet":"video"===i||/\.(mp4|webm|ogg|avi|mov|m4v|m3u8|mpd)(\?|$)/i.test(t)||t.includes("videoplayback")||t.includes("stream")||t.includes("manifest")?"video":"fetch"===i||"xmlhttprequest"===i?"xhr":i||"other"}_handleError(e,t){this.errorHandler&&this.errorHandler.fireError({error:"PerformanceMonitor: "+e+" - "+t.message,level:this.errorHandler.WARNING})}_setupRegistrationCleanup(){this.registrationCleanupInterval=setInterval(()=>{this._cleanupOldRegistrations()},1e4)}registerTemplateResource(e,t={}){const i=this._normalizeUrl(e);this.templateResourcesLoading.set(i,{registeredAt:Math.round(performance.now()),type:t.type||"unknown",source:t.source||"template",phase:t.phase||"render",assetId:t.assetId,...t})}_isKnownTemplateResource(e){const t=this._normalizeUrl(e);return this.templateResourcesLoading.has(t)}_normalizeUrl(e){try{const t=new URL(e);return t.protocol+"//"+t.host+t.pathname}catch(t){return e.toLowerCase()}}_registerCreativeAssets(e){e.assets&&e.assets.forEach(e=>{e.image_url&&this.registerTemplateResource(e.image_url,{type:"creative_image",source:"auction_response",assetId:e.asset_id,phase:"creative_load"}),e.background_image&&this.registerTemplateResource(e.background_image,{type:"background_image",source:"creative_asset",assetId:e.asset_id})})}_isApplicationResource(e){const t=e.name.toLowerCase();try{const i=new URL(t).hostname.toLowerCase();if("3lift.com"===i||i.endsWith(".3lift.com")||"3liftd.co"===i||i.endsWith(".3liftd.co"))return!0;if(/\/(bundle|video-bundle|es5-bundle|es5-video-bundle)\.js$/i.test(t)||/\/\d+\.(bundle|chunk)\.js$/i.test(t))return!0;if("img.3lift.com"===i||i.endsWith(".img.3lift.com"))return!0;if(("fetch"===e.initiatorType||"xmlhttprequest"===e.initiatorType)&&(i.includes("3lift")||i.includes("triplelift")))return!0;if(this.isTestEnv){if(!(t.includes("video")||t.includes(".mp4")||t.includes(".webm")||t.includes("stream")||t.includes(".m3u8")))return!0}return!1}catch(e){return t.includes("3lift")||t.includes("triplelift")}}_cleanupOldRegistrations(){const e=Math.round(performance.now()),t=[];this.templateResourcesLoading.forEach((i,r)=>{e-i.registeredAt>this.maxRegistrationAge&&t.push(r)}),t.forEach(e=>{this.templateResourcesLoading.delete(e)})}_trackAssetMemory(e){try{const t=e.transferSize||0,i=e.decodedBodySize||e.encodedBodySize||0,r=this._getAssetType(e.name);this.assetMemoryUsage.totalTransferSize+=t,this.assetMemoryUsage.totalDecodedSize+=i,this.assetMemoryUsage.byType[r]||(this.assetMemoryUsage.byType[r]={transferSize:0,decodedSize:0,count:0});const n=this.assetMemoryUsage.byType[r];return n.transferSize+=t,n.decodedSize+=i,n.count++,{transferSize:t,decodedSize:i}}catch(t){return{transferSize:e.transferSize||0,decodedSize:e.decodedBodySize||0}}}_getAssetType(e){try{const t=e.toLowerCase();return/\.(js)(\?|$)|javascript/i.test(t)?"javascript":/\.(css)(\?|$)|stylesheet/i.test(t)?"css":/\.(png|jpg|jpeg|gif|webp|svg)(\?|$)/i.test(t)?"image":/\.(woff2?|ttf|otf)(\?|$)|font/i.test(t)?"font":/\.(mp4|webm|ogg|avi|mov|m4v|m3u8|mpd)(\?|$)|video|stream|videoplayback|manifest/i.test(t)?"video":"other"}catch(e){return"other"}}_setupDOMMemoryTracking(){const e=new MutationObserver(e=>{this._processDOMMutations(e)});e.observe(document,{childList:!0,subtree:!0,attributes:!1,characterData:!1}),this.observers.set(Ht.METRICS.MEMORY_IMPACT,e)}_processDOMMutations(e){e.forEach(e=>{"childList"===e.type&&e.addedNodes.forEach(e=>{e.nodeType===Node.ELEMENT_NODE&&this._isApplicationElement(e)&&this.domMemoryTracking.createdElements.add(e)})})}_isApplicationElement(e){return!(!e.hasAttribute||!Array.from(e.classList).some(e=>e.startsWith(t.hj)))}calculateEstimatedAppMemory(){try{const e=this.assetMemoryUsage,t={};return Object.entries(e.byType).forEach(([e,i])=>{i.count>0&&(t[e]=i)}),{totalTransferSize:e.totalTransferSize,totalDecodedSize:e.totalDecodedSize,assets:t,domElements:this.domMemoryTracking.createdElements.size}}catch(e){return{totalTransferSize:0,totalDecodedSize:0}}}destroy(){try{this.observers.forEach(e=>{e.disconnect()}),this.observers.clear(),this.registrationCleanupInterval&&(clearInterval(this.registrationCleanupInterval),this.registrationCleanupInterval=null),this.templateResourcesLoading.clear(),this.domMemoryTracking&&this.domMemoryTracking.createdElements.clear();try{performance.getEntriesByType("mark").filter(e=>e.name.startsWith("tlpm_")).forEach(e=>{performance.clearMarks(e.name)})}catch(e){}}catch(e){this._handleError("Failed to destroy PerformanceMonitor",e)}}}(0,g.A)(Ht,"METRICS",{RESOURCE_LOAD:"resourceLoad",LONG_TASK:"longTask",GLOBAL_MEMORY_USAGE:"globalMemoryUsage",IB_MEMORY_USAGE:"ibMemoryUsage",MEMORY_IMPACT:"memoryImpact",DOM_PERFORMANCE:"domPerformance",RENDER_PERFORMANCE:"renderPerformance",AD_LOAD_SEQUENCE:"adLoadSequence"}),(0,g.A)(Ht,"THRESHOLDS",{LONG_TASK_MS:59e3,LARGE_RESOURCE_KB:100,MAX_OBSERVATIONS:20,BOTTLENECK_THRESHOLD_MS:200,SEVERE_BOTTLENECK_MS:500});class Bt{constructor(e){this.benchmark=e,this.laps=[],this.lastMetricTimeBeforeFirstLap=0,this.justEnteredALap=!1}log(e,t=performance.now()){if(this.benchmark.shouldLog){this._updateBenchmarkLastMetricTime();const i=this._transposeToFirstLap(t);this.benchmark.log(e,i)}}_transposeToFirstLap(e){if(this.laps.length){const t=this.laps[0];return e-this.laps[this.laps.length-1]+t}return e}_updateBenchmarkLastMetricTime(){this.justEnteredALap&&(this.benchmark.lastMetricTime=this.lastMetricTimeBeforeFirstLap,this.justEnteredALap=!1)}startLap(e=performance.now()){this.laps.length||(this.lastMetricTimeBeforeFirstLap=this.benchmark.lastMetricTime),this.laps.push(e),this.justEnteredALap=!0}}const Wt=(e,t)=>{let i=parseInt(t,10),r=e;for(isNaN(i)&&(i=1);i--;)r=encodeURIComponent(r);return r},Ut=(e,t,i)=>{const{focalBox:r}=e,n={};if(!r)return null;const s=(e,t,i)=>Math.round(e/t*i);return n.x1=s(r.x1,e.image_width,t),n.x2=s(r.x2,e.image_width,t),n.y1=s(r.y1,e.image_height,i),n.y2=s(r.y2,e.image_height,i),n},zt=(e,t)=>{const i=parseInt(t,10);let r=e;if(!e||!i||i<3)return e;const n=e.match(/(.*)(<a.*>)(.*)(<\/a>)(.*)/);return n?((e,t)=>{let i=e[1],r=e[2],n=e[3],s=e[4],a=e[5],o=i.length+n.length+a.length-t+3;return o<=3||(o<=a.length?a=a.substr(0,a.length-o)+"...":o<=a.length+n.length?(o-=a.length,n=n.substr(0,n.length-o)+"...",a=""):(o-=a.length+n.length,i=i.substr(0,i.length-o)+"...",r="",n="",s="",a="")),i+r+n+s+a})(n,i):(i<e.length&&(r=e.substr(0,i-3)+"..."),r)};class Gt{constructor({creativePayload:e,environment:t,placement:i,pageInfo:r,isSmallScreen:n,clickTrackerDTJ:s,debug:a,templateDetail:o,tlImageId:l,errorHandler:c,formatManager:d,firePix:h,forceShadowRoot:u,renderOptionsBMOverride:p,adPreview:m}){(0,g.A)(this,"firePix",void 0),(0,g.A)(this,"params",null),(0,g.A)(this,"creativePayload",null),(0,g.A)(this,"formatManager",null),(0,g.A)(this,"environment",null),(0,g.A)(this,"placement",null),(0,g.A)(this,"isSmallScreen",null),(0,g.A)(this,"clickTrackerDTJ",null),(0,g.A)(this,"pageInfo",null),(0,g.A)(this,"debug",!1),this.creativePayload=e,this.environment=t,this.placement=i,this.isSmallScreen=n,this.clickTrackerDTJ=s,this.pageInfo=r,this.debug=a,this.templateDetail=o,this.tlImageId=l,this.params=null,this.errorHandler=c,this.insertedLogoCorner=null,this.formatManager=d,this.firePix=h,this.forceShadowRoot=u,this.renderOptionsBMOverride=p,this.hasResizedIframe=!1,this.adPreview=m,this.initParams()}initParams(){let e=this.creativePayload.assets;e=e.map(e=>this.processClickThroughUrl(e)),e=e.map(e=>this._appendThirdPartyTrackers(e)),e=e.map(e=>((e,t,i=100)=>{const r={caption:zt(e.caption,t),heading:zt(e.heading,i)};return{...e,...r}})(e,this.placement.captionCharacterLimit,this.placement.headingCharacterLimit)),this.params=this.makeParams(e)}makeParams(e){var i,n;const s=((e,t)=>{if(t){const i=e.find(e=>parseInt(t,10)===e.image_id);if(i)return i}return e.find(e=>e.impression_pixels)||e[0]})(e,this.tlImageId),a={...this.creativePayload.settings,...s};var o,l;return a.js_trackers=this.creativePayload.settings.js_trackers,a.impression_pixels=this.creativePayload.settings.impression_pixels,a.viewability_pixels=this.creativePayload.settings.viewability_pixels,a.allImages=e,a.heading=this._getHeading(a),a.caption=this._getCaption(a),a.advertiser_name=this._getAdvertiserName(a),a.isCSR=(o=a.client_side_render,l=a.image_id,o||+l<0),a.adchoices_url=(({adchoices_url:e})=>(0,r.qA)(e)||t.eY)(a),a.logo_image_url=(e=>{const t=e.logo_image_url||e.light_logo_url;return(0,r.qA)(t)})(a),a.render_options_bm=this.renderOptionsBMOverride||a.render_options_bm||0,a.orig_image_url=a.image_url,a.banner_height=a.banner_height||(null===(i=this.creativePayload.settings)||void 0===i?void 0:i.banner_height),a.banner_width=a.banner_width||(null===(n=this.creativePayload.settings)||void 0===n?void 0:n.banner_width),a.imageServerParams=(0,r.vV)(a.img_server_params),delete a.image_render_params,s&&s.template_component_url&&(a.isTemplateComponentRender=!0,a.isPillarBoxingColorWhite=this.isWhitePillarBoxingColorWhite(a)),a}setImageUrlAndSrcSet(){const{processedImageUrl:e,srcSet:t}=this._getProcessedImageUrlAndSrcSet();this.params.image_url=e,this.params.image_srcset_2x=t}_getAdvertiserName(e){const{disclosureOverride:t}=this.placement.customOptions;return"Advertising Partner"===e.advertiser_name&&"string"==typeof t?(this.placement.disclosure=t,""):e.advertiser_name}_getHeading(e){const{defaultHeadingOverride:t}=this.placement.customOptions;return i=e.heading,r="sponsored video",(n=t)&&i&&i.toLowerCase()===r?n:i||"";var i,r,n}_getCaption(e){return e.caption}doesFormatUseTemplateImgTag(){return[this.environment.formats.image,this.environment.formats.native_lite,this.environment.formats.video,this.environment.formats.component_image,this.environment.formats.nrec_component_image].indexOf(this.formatManager.getFormat())>-1}_getProcessedImageUrlAndSrcSet(){let e=null,i=null;if(this.formatManager.isCinemagraph())e=this._determineAnimatedUrl(this.params);else if(this.params.image_url&&this.doesFormatUseTemplateImgTag())if(this.params.isCSR)e=this.params.image_url;else{const{width:t,height:r}=this._getDimensions(this.params.image_width,this.params.image_height),n={url:this.params.orig_image_url,imgServerParams:this.params.img_server_params,tlImgAddr:this.environment.tlImageAddr,placementWidth:t,placementHeight:r,logoBlackList:this.placement.logoBlackList,noLogo:!this.insertedLogoCorner,templateDetail:this.templateDetail};e=this.createDynamicImageURL(n),i=this._createImageSrcset({...n,placementWidth:2*this.placement.imageWidth,placementHeight:2*this.placement.imageHeight})}else e=t.CK;return{processedImageUrl:e,srcSet:i}}_getDimensions(e,t){let i=this.placement.imageWidth,r=this.placement.imageHeight;return(i<e||r<t)&&(i*=2,r*=2),{width:i,height:r}}expandAndRedirectClickThrough(e,t=null){if(!e.origClickThroughUrl)return;const i=this.creativePayload.settings.additional_data,n=e.asset_id||this.creativePayload.settings.asset_id,s=i.tid,a=this.expandFirstPartyMacros(s,n,this.clickTrackerDTJ);let o=null===t?e.origClickThroughUrl:t;o=this.expandFirstPartyMacros(s,n,o),o=((e,t)=>{if(e)return decodeURIComponent(e)+encodeURIComponent(t);return t})(a,o),o=((e={},t,i)=>{const n={tl_clickthrough:!0,redir:i,tluid:e.uid,...e};return(0,r.j7)(t,"pass",n)})(i,this.environment.ebPath,o);return e.clickthrough_url=o,o}processClickThroughUrl(e){const t=e,i=t.clickthrough_url||this.creativePayload.settings.clickthrough_url;return t.origClickThroughUrl=i,i&&(t.clickthrough_url=this.expandAndRedirectClickThrough(t)),t}expandFirstPartyMacros(e,t,i){if(!i)return null;let n=i;const s=this.pageInfo.get().ref,a=(0,r.o_)(s).host;n=n.replace(/\[domain]/gi,a),n=n.replace(/\[placement_id]/gi,this.placement.id),n=n.replace(/\[campaign]/gi,e),n=n.replace(/\[ad]/gi,t),n=n.replace(/\[timestamp]/gi,(new Date).getTime()),n=n.replace(/%time%/gi,(new Date).getTime()),n=(0,r.Vp)(n);const o=1e10;return n=n.replace(/\[cachebuster]/gi,(0,r.XU)(o)),n=n.replace(/\[random_number]/gi,(0,r.XU)(o)),n=n.replace(/\${cachebuster}/gi,(0,r.XU)(o)),n=n.replace(/{isfallback}/gi,this.creativePayload.settings.isFallbackAssets),n}expandOpenRTBMacros(e){if(!e)return null;let t=e;const i=this.creativePayload.settings.additional_data.aid,r=this.creativePayload.settings.additional_data.bc;return t=t.replace(/\${AUCTION_ID}/gi,i),t=t.replace(/\${AUCTION_PRICE}/gi,r),t}createDynamicImageURL(e){const{url:t,tlImgAddr:i,placementWidth:n,placementHeight:s}=e;let a=e.imgServerParams||"",o=e.logoBlackList||"";e.noLogo&&(a=(0,r.hb)(a,"lp"),o="NW,NE,SE,SW"),this.formatManager.isPharma()&&(o="");const l=[],c=this.templateDetail.width||("0"===n?NaN:n),d=this.templateDetail.height||("0"===s?NaN:s);var h;(l.push("width="+c),l.push("height="+d),l.push("url="+encodeURIComponent(t)),l.push("logo_exclude="+o),this.insertedLogoCorner&&l.push("lp="+this.insertedLogoCorner),this.formatManager.isPharma())&&l.push("lp="+(null===(h=this.params.imageServerParams)||void 0===h?void 0:h.lp));return(0,r.sT)("//"+i+"/?"+l.join("&")+"&"+a)}getAllDynamicImageURLS(){const e=this.placement.imageWidth,t=this.placement.imageHeight;return this.params.allImages.map(i=>{if(+i.image_id<0)return{src:i.image_url};return{src:this.createDynamicImageURL({url:i.image_url,imgServerParams:i.img_server_params,noLogo:!this.insertedLogoCorner,tlImgAddr:this.environment.tlImageAddr,placementHeight:t,placementWidth:e}),srcset:this._createImageSrcset({url:i.image_url,imgServerParams:i.img_server_params,noLogo:!this.insertedLogoCorner,tlImgAddr:this.environment.tlImageAddr,placementWidth:2*this.placement.imageWidth,placementHeight:2*this.placement.imageHeight})}})}isVast(){return!1}useShadowRoot(){return this.params.use_shadow_root||this.forceShadowRoot}postRenderImpressionTracking(){return this.params.post_render_impression_tracking}getExperimentBitmask(){return this.params.ib_experiment_bitmask||0}isAdChoicesOptOut(){const e=this.params.render_options_bm,t=this.environment.renderOptionsMap;return!!(0,r.jx)(e,t.adchoices_opt_out)}isDemandSideCtaTextOptIn(){const e=this.params.render_options_bm,t=this.environment.renderOptionsMap;return!!(0,r.jx)(e,t.cta_overlay)}shouldVideoPauseOutOfView(){const e=this.params.render_options_bm,t=this.environment.renderOptionsMap,i=this.placement.customOptions.disableOutstreamVideoBehavior,n=(0,r.jx)(e,t.video_pause_out_view);return i||n}isWhitePillarBoxingColorWhite(e){const t=e.render_options_bm,i=this.environment.renderOptionsMap;return(0,r.jx)(t,i.pillar_boxing_color_white)}isPoliticalAdChoices(){const e=this.params.render_options_bm,t=this.environment.renderOptionsMap;return!!(0,r.jx)(e,t.political_adchoices)}isLargeMuteButton(){const e=this.params.render_options_bm,t=this.environment.renderOptionsMap;return!!(0,r.jx)(e,t.large_mute_btn)}isFullyClickable(){const e=this.params.render_options_bm,t=this.environment.renderOptionsMap;return!!(0,r.jx)(e,t.override_vpaid_clickblock)}getParams(){return this.params}getAssets(){return this.creativePayload.assets}getBaseZIndex(){return t.Ct}getVastTag(){return null}getPassedGpid(){return this.creativePayload.settings.passed_gpid}getPassedTagId(){return this.creativePayload.settings.passed_tag_id}getExternalCreativeId(){return this.creativePayload.settings.external_creative_id}getAdpreviewHash(){return this.creativePayload.settings.adpreview_hash}getParentId(){return this.creativePayload.settings.parent_id}getAdSlotId(){return this.params.asid}needsViewabilityAwareness(){return this.formatManager.isScroll()||this.formatManager.isWindow()}hasClickThrough(){return!!this.params.clickthrough_url}isComponentMedia(){return!this.isTemplateComponent()&&this.formatManager.isComponentMedia()}isTemplateComponent(){var e,t,i,r,n;return null!=(null===(e=this.creativePayload)||void 0===e||null===(t=e.ad)||void 0===t||null===(i=t.display)||void 0===i||null===(r=i.native)||void 0===r||null===(n=r.ext)||void 0===n?void 0:n.amazonTemplateIndicator)}hasVideoPillarboxFeature(){return this.params.renderQualityExp===t.Rv.VIDEO_PILLARBOX&&this.formatManager.isAutoplayVideo()}hasParallaxFeature(){return!this.adPreview&&this.useResizeService()&&this.pageInfo.isFriendlyFrameRender()&&!this.placement.templateResizeConstraints?(this.errorHandler.fireError({category:"Creative Parallax",error:"Fallback to parallax due to missing templateResizeConstraints",level:this.errorHandler.WARNING}),!0):this.params.renderQualityExp===t.Rv.COMPONENT_PARALLAX}alignAdChoicesToPlacement(){return this.formatManager.isComponentMedia()||this.formatManager.isDocAds()||this.formatManager.isAmazon()}_appendThirdPartyTrackers(e){const t=this.creativePayload.settings.additional_data.tid,i=e.asset_id||this.creativePayload.settings.asset_id,r=this.expandFirstPartyMacros.bind(this,t,i),n=this.creativePayload.settings,s=e.clickthrough_pixels||n.clickthrough_pixels||[],a=e.js_trackers||[],o=e.viewability_pixels||[];let l=e.impression_pixels||[];const c=this._getClickTracker(e);c&&s.push(c);const d=e.third_party_duplicate_rate||n.third_party_duplicate_rate;d&&Math.random()<d&&(l=(e=>{if(!e)return[];const t=e.slice();for(let e=0;e<t.length;e++)t[e].indexOf("?")>-1?t[e]+="&tlcb=${CACHEBUSTER}":t[e]+="?tlcb=${CACHEBUSTER}";return e.concat(t)})(l));const h={clickPixels:s.map(r),impressionPixels:l.map(r),viewabilityPixels:o.map(r),jsTrackers:a.map(r)};return Object.assign(e,{thirdPartyTrackers:h})}_determineAnimatedUrl(e){if(!e.animation_variants||!e.animation_variants.length||this.debug)return e.image_url;const t=e.animation_variants;let i,r=100*Math.round((this.placement.imageWidth+100)/100),n=r&&t.indexOf(r)>-1;if(!n&&this.isSmallScreen&&(r=Math.max.apply(null,t),n=!0),n){const t=Math.round(e.image_height/e.image_width*r);Object.assign(e,{focal_box:Ut(e,r,t)},{image_width:r,image_height:t}),i=e.image_url.replace(".gif","_a"+r+".gif")}else i=e.image_url;return i}_createImageSrcset(e){return this.createDynamicImageURL(e)+" 2x"}_getClickTracker(e){let t,i;return e.click_tracker_url?(t=e.click_tracker_encoding_level,i=e.click_tracker_url):(t=this.creativePayload.settings.click_tracker_encoding_level,i=this.creativePayload.settings.click_tracker_url),i&&t>0?Wt(i,t):i}useResizeService(){return this.pageInfo.isFriendlyFrame()||this.pageInfo.isFriendlyFrameRender()?this.params.useNewRenderMethodFriendlyFrame:!!this.pageInfo.isSafeFrame()&&this.params.useNewRenderMethodSafeFrame}forceIframeRender(){return!!(this.getExperimentBitmask()&t.aD.IFRAME_RENDER_NO_RESIZE)||this.useResizeService()&&this.hasResizedIframe}}class qt extends Gt{initParams(){var e;super.initParams(),(null===(e=this._getCarouselWeights())||void 0===e?void 0:e.length)>0?this._setAllImagesWeighted():this.formatManager.isDocAds()?this._setDocAdsAllImages(this.getDocAdsLastPageText()):this.formatManager.isComponentCarousel()?this._setAllImagesComponentCarousel():this._setAllImages()}getAllImages(){return this.allImages}isDocAdsCreative(){var e,t,i,r,n;return!(null===(e=this.creativePayload)||void 0===e||null===(t=e.ad)||void 0===t||null===(i=t.display)||void 0===i||null===(r=i.native)||void 0===r||null===(n=r.ext)||void 0===n||!n.docAds)}isDownloadNowDocAds(){var e,t,i,r,n,s;return!(null===(e=this.creativePayload)||void 0===e||null===(t=e.ad)||void 0===t||null===(i=t.display)||void 0===i||null===(r=i.native)||void 0===r||null===(n=r.ext)||void 0===n||null===(s=n.docAds)||void 0===s||!s.download_obj)}getDocAdsLastPageText(){var e,t,i,r,n,s,a;return null===(e=this.creativePayload)||void 0===e||null===(t=e.ad)||void 0===t||null===(i=t.display)||void 0===i||null===(r=i.native)||void 0===r||null===(n=r.ext)||void 0===n||null===(s=n.docAds)||void 0===s||null===(a=s.gated_obj)||void 0===a?void 0:a.last_page_text}getDocAdsClickTracker(){return this.creativePayload.ad.display.native.link.url}_setAllImages(){this.allImages=(0,r.M8)(this.params.allImages,10)}_setAllImagesComponentCarousel(){this.params.allImages.length>11?this.allImages=this.params.allImages.slice(0,11):this.allImages=this.params.allImages}_setAllImagesWeighted(){this._validateImageIds(),this._validateWeight(),this._validateWeightsSum();const e=this._chooseFirstImage();this._swapFirstImage(e),this.allImages=this.params.allImages.slice(0,10)}_chooseFirstImage(){const e=this._getCarouselWeights(),t=this._getWeightsSum(),i=Math.random()*t;let r=0;return e.find((t,n)=>(r+=e[n].weight,i<r))}_getWeightsSum(){return this._getCarouselWeights().reduce((e,t)=>e+t.weight,0)}_getCarouselWeights(){var e,t;return null===(e=this.params)||void 0===e||null===(t=e.customization)||void 0===t?void 0:t.carousel_weights}_validateImageIds(){const e=this._getCarouselWeights().map(e=>e.image_id),t=this.params.allImages.map(e=>e.image_id);e.every(e=>t.includes(e))||this.errorHandler.fireError({category:"Carousel Image Validation",error:"There are image_ids in carousel_weights that do not map to an image in the creative.",level:this.errorHandler.WARNING})}_validateWeightsSum(){const e=this._getWeightsSum();(e<.99||e>1.01)&&this.errorHandler.fireError({category:"Carousel Weights Validation",error:"Carousel_weights do not sum to 1 within a tolerance of 1%",level:this.errorHandler.WARNING})}_validateWeight(){this._getCarouselWeights().forEach(e=>{e.weight||(e.weight=0,this.errorHandler.fireError({category:"Carousel Weights Validation",error:"Image id: "+e.image_id+" does not have an associated weight, defaulted to 0.",level:this.errorHandler.WARNING}))})}_swapFirstImage(e){const t=this.params.allImages.findIndex(t=>t.image_id===e.image_id),i=this.params.allImages[t];this.params.allImages[t]=this.params.allImages[0],this.params.allImages[0]=i}_setDocAdsAllImages(e){if(this.allImages=this.params.allImages,e){var t,i,n,s,a,o,l,c,d,h;const e=parseInt((null===(t=this.creativePayload)||void 0===t||null===(i=t.ad)||void 0===i||null===(n=i.display)||void 0===n||null===(s=n.native)||void 0===s||null===(a=s.ext)||void 0===a?void 0:a.docAds.display_size.width)||100,10),u=parseInt((null===(o=this.creativePayload)||void 0===o||null===(l=o.ad)||void 0===l||null===(c=l.display)||void 0===c||null===(d=c.native)||void 0===d||null===(h=d.ext)||void 0===h?void 0:h.docAds.display_size.height)||100,10);this.allImages.push({...this.allImages[0],thirdPartyTrackers:{clickPixels:[],impressionPixels:[],viewabilityPixels:[],jsTrackers:[]},image_url:(0,r.sT)("//"+this.environment.tlImageAddr+"/blank?width="+e+"&height="+u)})}}}var Yt=n(389);class Zt extends Gt{constructor(e){super(e),this.vastTag=null}getVastTag(){return this.vastTag}setVastTag(e){this.vastTag=e}isVast(){return!0}isVpaid(){return this.vastTag.isVpaid()}getBaseZIndex(){return this.vastTag&&this.vastTag.isVpaid()?this.placement.customOptions.videoZIndexOverride||Yt.A.vpaidZIndex:Yt.A.nonVpaidZIndex}needsViewabilityAwareness(){return this.formatManager.isAutoplayVideo()}isVpaidAndNoClickthrough(){return!(!this.vastTag.isVpaid()||!this.formatManager.isAutoplayVideo()||this.hasClickThrough())}hasClickThrough(){return!(!super.hasClickThrough()&&!this.vastTag.getVastClickThroughUrl())}}class Qt{static create(e){const{formatManager:t}=e;let i;return i=t.isCarousel()?new qt(e):t.isVideo()?new Zt(e):new Gt(e),i}}const Xt={assets:[{asset_id:0,image_id:0,image_url:t.L6,image_w_over_h:1.7778,clickthrough_url:"http://www.doubleverify.com",heading:"",caption:"",cv_version:1,img_server_params:"v=0&cv_version=1"}],settings:{format_id:1,tactic_id:0,line_item_id:0,insertion_order_id:0,creative_library_id:0,advertiser_name:"Sponsor",additional_data:{clid:0,ioid:0,liid:0,tid:0,advid:0,bmid:0,aid:1}}},Jt="allowCreative",Kt="blockCreative";class $t{constructor(e,{errorHandler:t}){this.creativePayload=e,this.iframe=$t.makeIframe(),this.errorHandler=t}callDV(){const e=this._makeScriptsString();return this.iframe.contentWindow.document.open(),this.iframe.contentWindow.document.write(e),this.iframe.contentWindow.document.close(),this._handler().catch(e=>(this._onError(e),this._overwriteCreativePayloadWithPSA()))}_handler(){return new Promise((e,t)=>{this.iframe.contentWindow.onerror=e=>{t(e)},setTimeout(()=>{t(new f.A("DoubleVerify timeout"))},1e4),this.iframe.contentWindow[Kt]=()=>{this.errorHandler.fireError({category:"DoubleVerify Blocking",error:"DoubleVerify blocked creative, PSA displayed",level:this.errorHandler.INFO}),this._overwriteCreativePayloadWithPSA(),e()},this.iframe.contentWindow[Jt]=e})}_onError(e){this.errorHandler.fireError({category:"DoubleVerify Blocking",error:e,level:this.errorHandler.ERROR})}_overwriteCreativePayloadWithPSA(){this.creativePayload.settings=Xt.settings,this.creativePayload.assets=Xt.assets}static makeIframe(){const e=document.createElement("iframe");return e.style.display="none",document.body.appendChild(e),e}_makeScriptsString(){const{dco_tag_url:e}=this.creativePayload.settings;return'\n      <script type="text/adtag"><script type="text/javascript">'+Jt+'();</scr+ipt><\/script>\n      <script type="text/passback"><script type="text/javascript">'+Kt+'();</scr+ipt><\/script>\n      <script onerror="(function(el){el.onerror=\'this._onerror})(this)" type="text/javascript" src="'+e+'"><\/script>\n    '}}const ei="__cmp",ti="__gpp",ii="__tcfapi",ri="tl: CMP timeout";class ni{constructor({win:e,isProxyNeeded:t,errorHandler:i,firePix:r}){(0,g.A)(this,"cmpTimeout",void 0),(0,g.A)(this,"eventListenerResolve",void 0),(0,g.A)(this,"eventListenerRegistered",void 0),(0,g.A)(this,"firePix",void 0),(0,g.A)(this,"reportError",void 0),this.win=e,this._isProxyNeeded=t,this._errorHandler=i,this._gdprCmpData={tripleliftConsent:!1},this.firePix=r,this.reportError=!0,this.registerEventListener()}static isCmpDataValid(e,t){return ti===t?"object"==typeof e:"object"==typeof e&&"boolean"==typeof e.gdprApplies}static getTcfapiWindow(e,t){let i=e;try{for(;i;){var r,n;if(null!==(r=i)&&void 0!==r&&null!==(n=r.frames)&&void 0!==n&&n.__tcfapiLocator)return i;if(i===window.top)break;i=i.parent}}catch(e){t.fireError({category:"TCF API Locator",error:"Error getting _tcfapiLocator: "+e,level:Je.A.INFO,sampleRate:ni.ERROR_SAMPLE_RATE})}return null}static getCmpApiWindow(e,t){return"function"==typeof e[ei]||"function"==typeof e[ii]||"function"==typeof e[ti]?e:ni.getTcfapiWindow(e,t)}get cmpData(){return this._gdprCmpData}async registerEventListener(){try{"function"==typeof this.win[ti]?await this.registerGPPEventListener():"function"==typeof this.win[ei]||"function"==typeof this.win[ii]&&await this.registerTCEventListener()}catch(e){this._asyncErrorHandler(e)}}async registerGPPEventListener(){const e=this.handleCmpData.bind(this);await this.addCmpEventListener(()=>this.win[ti]("addEventListener",e))}async registerTCEventListener(){const e=this.handleCmpData.bind(this);await this.addCmpEventListener(()=>this.win[ii]("addEventListener",null,e))}async addCmpEventListener(e){let t;return new Promise((i,r)=>{t=setTimeout(()=>r(ri),1e3),this.eventListenerResolve=i,e()}).then(()=>{clearTimeout(t)}).catch(e=>this._asyncErrorHandler(e))}handleCmpData(e,t){var i;if("boolean"==typeof t&&!t){if(this.reportError)throw this.reportError=!1,new f.A("There was an error in the publisher CMP API: could not add event listener",Je.A.INFO);return}this.eventListenerResolve&&(this.eventListenerResolve(),this.eventListenerResolve=void 0,this.eventListenerRegistered=!0);const r=null==e||null===(i=e.vendor)||void 0===i?void 0:i.consents;this.applyCmpData(e,r)}async getCMPData(){if("boolean"!=typeof this._gdprCmpData.gdprApplies)try{if(this.eventListenerRegistered)return;await this.checkGdprCompliance()}catch(e){this._errorHandler.fireError({category:"CMP Data Retrieval",error:"Error getting gdpr CMPData: "+e.message,level:Je.A.INFO,sampleRate:ni.ERROR_SAMPLE_RATE})}}async checkGdprCompliance(){try{let n,s;if("function"==typeof this.win[ti])n=await this.callCmp(ti,"getGPPData",null);else if("function"==typeof this.win[ei]){var e;n=await this.callCmp(ei,"getConsentData",null),s=null===(e=await this.callCmp(ei,"getVendorConsents",null))||void 0===e?void 0:e.vendorConsents}else if("function"==typeof this.win[ii]){var t,i;this._isProxyNeeded&&this.createParentProxy();const e=(0,r.bf)()?"getInAppTCData":"getTCData";n=await this.callCmp(ii,e,2),s=null===(t=n)||void 0===t||null===(i=t.vendor)||void 0===i?void 0:i.consents}this.applyCmpData(n,s)}catch(e){throw new f.A("There was an error in the publisher CMP API: "+(e.message?e.message:e),Je.A.INFO)}finally{clearTimeout(this.cmpTimeout)}}applyCmpData(e,t){e&&(this._gdprCmpData=Object.assign(this._gdprCmpData,{gdprApplies:!!e.gdprApplies,consentString:e.consentData||e.tcString,gppString:this.getGPPString(e),gppApplicableSections:this.getGPPApplicableSections(e)}),t&&"boolean"==typeof t[28]&&(this._gdprCmpData.tripleliftConsent=t[28]))}getGPPString(e){let t=e;return t.pingData&&(t=t.pingData),t.gppString}getGPPApplicableSections(e){let t=e;return t.pingData&&(t=t.pingData),t.applicableSections}async callCmp(e,t,i){return new Promise((r,n)=>{if(this.cmpTimeout=setTimeout(()=>n(ri),1e3),e===ti){r(this.win[e](t))}else this.win[e](t,i,r)}).then(i=>ni.isCmpDataValid(i,e)?i:(this._errorHandler.fireError({category:"CMP API Call",error:"CMP "+t+" command did not return a valid consent object",level:Je.A.INFO,diagnosticContext:i,sampleRate:ni.ERROR_SAMPLE_RATE}),null)).catch(e=>this._asyncErrorHandler(e))}createParentProxy(){const e={};var t;t=this.win,window[ii]=function(i,r,n,s){const a=""+Math.random(),o={__tcfapiCall:{command:i,parameter:s,version:r,callId:a}};e[a]=n,t.postMessage(o,"*")},window.addEventListener("message",function(t){let i={};try{i="string"==typeof t.data?JSON.parse(t.data):t.data}catch(e){throw new f.A("Invalid data from CMP API",Je.A.INFO)}const r=i.__tcfapiReturn;r&&"function"==typeof e[r.callId]&&(e[r.callId](r.returnValue,r.success),e[r.callId]=null)},!1)}_asyncErrorHandler(e){const t=e.message||("string"==typeof e?e:"Unknown error"),i="object"!=typeof e||e instanceof Error?{}:e;t!==ri&&this._errorHandler.fireError({category:"GDPR Async Error",error:t,level:Je.A.INFO,diagnosticContext:i,sampleRate:ni.ERROR_SAMPLE_RATE})}}(0,g.A)(ni,"ERROR_SAMPLE_RATE",.005);const si=0,ai=1,oi=2,li=3,ci=4,di=5,hi=6,ui=7,pi=[si,ui,ai,ci,hi,li],mi=[si,ai,ui],gi=[si,ui,ai,ci,hi,di,li],fi=[di,oi,ci,hi,li];class vi{constructor({docInfo:e,placement:t}){this.docInfo=e,this.placement=t,this.cachedApis={},this.cachedPageInfo=null,this.cachedFrameType=null}get(){if(this.cachedPageInfo)return this.cachedPageInfo;let e,t;return this.docInfo.canAccessTop?(t=(0,r.o_)(this.docInfo.topDocument.referrer).host,t="undefined"===t?"":t,e=this.docInfo.topDocument.URL):(t="can't access top document",e=this.placement.customOptions.isAmp?this.getAmpReferrer():this.docInfo.document.referrer),e=(0,r.Y1)(e,600),this.cachedPageInfo={domain:this.docInfo.document.domain,ref:e,pr:t||"un"},this.cachedPageInfo}getAmpReferrer(){let e;const t=(0,r.o_)(this.docInfo.document.URL);let i;try{i=JSON.parse(t.anchor)}catch(e){i={}}const n=(0,r.o_)(this.docInfo.document.referrer),s={...t.queryKey,...n.queryKey,...i};return e=s.url?decodeURIComponent(s.url):s._context&&s._context.canonicalUrl?s._context.canonicalUrl:s.top?decodeURIComponent(s.top):s.loc?decodeURIComponent(s.loc):s.iu?decodeURIComponent(s.iu):this.docInfo.document.referrer,e}getFrameType(){return null!==this.cachedFrameType||(this.cachedFrameType=this._determineFrameType()),this.cachedFrameType}_determineFrameType(){return this.getAmpApi()?ci:this.getMraidApi()?hi:this.getSafeFrameApi()?di:(0,r.bf)()?li:this.docInfo.canAccessTop?this.docInfo.document===this.docInfo.topWindow.document?si:this.placement.customOptions.friendlyIframeRender?ui:ai:oi}isNoFrame(){return this.getFrameType()===si}isUnfriendlyFrame(){return this.getFrameType()===oi}isFriendlyFrame(){return this.getFrameType()===ai}isFriendlyFrameRender(){return this.getFrameType()===ui}isClientAware(){return pi.indexOf(this.getFrameType())>-1}isPositionAware(){return mi.indexOf(this.getFrameType())>-1}isViewabilityAware(){return gi.indexOf(this.getFrameType())>-1}isSandboxed(){return fi.indexOf(this.getFrameType())>-1}isAmp(){return this.getFrameType()===ci}isWebview(){return this.getFrameType()===li}isMraid(){return this.getFrameType()===hi}isSafeFrame(){return this.getFrameType()===di}getSafeFrameApi(){const e=this._getApi("$sf");return e&&e.ext?e:null}getAmpApi(){const e=this._getApi("context");return e&&e.observeIntersection?e:null}getMraidApi(){return this._getApi("mraid")}getOmidSessionClient(){return this._getApi("OmidSessionClient")}_getApi(e){return void 0===this.cachedApis[e]&&(this.cachedApis[e]=this._findApi(e,this.docInfo.window)),this.cachedApis[e]}_findApi(e,t,i=0){if(i>=5)return null;try{if(t[e])return t[e]}catch(e){return null}return this._findApi(e,t.parent,i+1)}}class _i{constructor(e,t){Object.assign(this,e),this.formats=e,this.formatId=null,this.creativePayload=null,t.on(s.e8,e=>{var t;this.formatId=(null==e||null===(t=e.settings)||void 0===t?void 0:t.format_id)||e.ad.ext.tlFormatId,this.creativePayload=e})}setCreativePayload(e){var t;this.creativePayload=e,this.formatId=(null==e||null===(t=e.settings)||void 0===t?void 0:t.format_id)||e.ad.ext.tlFormatId}setFormat(e){this.formatId=e}getFormat(){return this.formatId}getFormats(){return this.formats}getFormatName(e){return Object.keys(this.formats).find(t=>this.formats[t]===e)}isAmazon(){var e,t;return!!(this.formatId===this.component_image&&null!==(e=this.creativePayload)&&void 0!==e&&null!==(t=e.settings)&&void 0!==t&&t.template_component_url||this.formatId===this.nrec_component_image)}isAmazonBrandedVideo(){var e,t;const i=null===(e=this.creativePayload)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.dco_tag_url;return!!i&&!(!this.isBrandedVideo()||(r=i,!S(r,T)));var r}isBanner(){return this.formatId===this.header_direct_banner}isCarousel(){return this.formatId===this.carousel||this.formatId===this.component_carousel}isDocAds(){var e,t,i,r,n;return!(null===(e=this.creativePayload)||void 0===e||null===(t=e.ad)||void 0===t||null===(i=t.display)||void 0===i||null===(r=i.native)||void 0===r||null===(n=r.ext)||void 0===n||!n.docAds)}isCaptureToolUrl(){var e,t,i,r;if(null!=this&&null!==(e=this.creativePayload)&&void 0!==e&&null!==(t=e.settings)&&void 0!==t&&t.forced_bid)return!0;const n=null===(i=this.creativePayload)||void 0===i||null===(r=i.settings)||void 0===r?void 0:r.dco_tag_url;return!!n&&this.isCaptureToolForce(n)}isCaptureToolForce(e){return this.queryParamIsTrue(e,"tl_test")}isShoppableMedia(){var e,t;const i=null===(e=this.creativePayload)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.dco_tag_url;if(!i)return!1;return M(i)||R(i)||this.isShoppableMediaForce(i)}isShoppableMediaForce(e){return this.queryParamIsTrue(e,"forceShoppableMedia")}isShoppableMediaAutoResizeTemplate(){var e,t;return this.isShoppableMedia()&&445961===(null===(e=this.creativePayload)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.template_id)}queryParamIsTrue(e,t){try{return"true"===new URLSearchParams(new URL(e).searchParams).get(t)}catch(e){return!1}}isImage(){return[this.image,this.native_lite,this.component_image,this.nrec_component_image].indexOf(this.formatId)>-1}isCinemagraph(){return this.formatId===this.cinemagraph}isScroll(){return this.formatId===this.scroll}isWindow(){return this.formatId===this.skylight}isPharma(){return this.formatId===this.pharma}isHdx(){return this.formatId===this.header_direct_banner}isHdConnection(){return this.formatId===this.header_direct_banner||this.formatId===this.header_direct_instream_video||this.formatId===this.header_direct_app_video||this.formatId===this.component_based_spot}isNativeLite(){return this.formatId===this.native_lite}isComponentImage(){return this.formatId===this.component_image}isComponentVideo(){return this.formatId===this.component_video}isComponentCarousel(){return this.formatId===this.component_carousel&&!this.isDocAds()}isComponentMedia(){return this.isComponentImage()||this.isComponentVideo()||this.isComponentCarousel()}isClickToPlayVideo(){return this.formatId===this.video}isBrandedVideo(){return this.formatId===this.autoplay}isHighImpactVideo(){return this.formatId===this.high_impact_video}isVideo(){return this.isClickToPlayVideo()||this.isBrandedVideo()||this.isHighImpactVideo()||this.isComponentVideo()}isAutoplayVideo(){return this.isBrandedVideo()||this.isHighImpactVideo()||this.isComponentVideo()}getConnectionType(){var t,i;return(null===(t=this.creativePayload)||void 0===t||null===(i=t.settings)||void 0===i?void 0:i.external_creative_type_id)||e._d.CT_UNKNOWN}shouldLogSizeData(){return this.formatId===this.image||this.formatId===this.video||this.formatId===this.cinemagraph||this.formatId===this.carousel||this.formatId===this.scroll||this.formatId===this.skylight||this.formatId===this.pharma||this.formatId===this.autoplay||this.formatId===this.component_image||this.formatId===this.component_video||this.formatId===this.component_carousel||this.formatId===this.nrec_component_image}isMainImageHeightCheckExemptFormat(){return this.formatId===this.carousel||this.formatId===this.scroll||this.formatId===this.component_carousel}}const yi=function(e={},t){return{setAdContainer:function(t){e.adContainer=t},getElDims:function(e){if(!e)throw new f.A("getElDims: no element present");const t=e.getBoundingClientRect();return{width:t.width,height:t.height}},_publishUpdate:function(){t.publish(s.cC)}}};const Ai={getRectPctInView:function(e,t){const i=t.width,r=t.height,n=e.width,s=e.height,a=n*s,o=n+Math.min(0,e.left)+Math.min(0,i-e.right),l=s+Math.min(0,e.top)+Math.min(0,r-e.bottom),c=o*l;return Math.max(0,c/a)},getDefaultBoundingClientRect:function(){return{width:0,height:0,x:0,y:0,top:0,bottom:0,left:0,right:0}},sumRects:function(e,t){return{width:e.width,height:e.height,x:e.x+t.x,y:e.y+t.y,top:e.top+t.top,bottom:e.bottom+t.top,left:e.left+t.left,right:e.right+t.left}}};const Ii=function(e,i){const n={getAdBoundingRect:a,getBoundingRect:o,getClientDims:l,getAdPctInView:function(){var i,r,s;if((null===(i=e.creativePayload)||void 0===i||null===(r=i.settings)||void 0===r?void 0:r.ib_experiment_bitmask)&t.aD.IFRAME_RENDER_NO_RESIZE||(null===(s=e.formatManager)||void 0===s?void 0:s.isAmazon())){const t=c(n.adContainer,e.win);return Ai.getRectPctInView(t,l())}return Ai.getRectPctInView(a(),l())},getElPctInView:function(i){var r,n,s;if((null===(r=e.creativePayload)||void 0===r||null===(n=r.settings)||void 0===n?void 0:n.ib_experiment_bitmask)&t.aD.IFRAME_RENDER_NO_RESIZE||(null===(s=e.formatManager)||void 0===s?void 0:s.isAmazon())){const t=c(i,e.win);return Ai.getRectPctInView(t,l())}return Ai.getRectPctInView(o(i),l())}},s=yi(n,i);return e.asyncUtil.addScrollListener(e.win,s._publishUpdate),(0,r.xO)({},s,n);function a(){return n.adContainer.getBoundingClientRect()}function o(e){return e.getBoundingClientRect()}function l(){return{width:e.win.innerWidth,height:e.win.innerHeight}}function c(e,t){let i=e.ownerDocument.defaultView;const r=e.getBoundingClientRect();if(!i||!r)return{width:0,height:0,top:0,left:0,right:0,bottom:0,x:0,y:0};let n=r.top+i.scrollY,s=r.left+i.scrollX;const a=r.width,o=r.height;try{for(;i!==t;){const e=i.frameElement;if(!e)break;const t=e.getBoundingClientRect();i=i.parent,n+=t.top+i.scrollY,s+=t.left+i.scrollX}}catch(e){}const l=n-t.scrollY,c=s-t.scrollX;return{width:a,height:o,top:l,left:c,right:c+a,bottom:l+o,x:c,y:l}}};const wi=function(){let e={width:0,height:0},t=Ai.getDefaultBoundingClientRect();return{getAdBoundingRect:i,getBoundingRect:r,getClientDims:n,getAdPctInView:function(){return Ai.getRectPctInView(i(),n())},getElPctInView:function(e){return Ai.getRectPctInView(r(e),n())},_update:function(i,r){t=i,e=r}};function i(){return t}function r(e){const i=e.getBoundingClientRect();return t?Ai.sumRects(i,t):i}function n(){return e}};const Ei=function(e,t){const i=yi({},t),n=wi();return e.win._tlWebViewUpdatePosition=function(e,t){if(!s(e,t))return;n._update(e,t),i._publishUpdate()},(0,r.xO)({},i,n);function s(e,t){return!(!e||!t)&&(i=n.getAdBoundingRect(),!a(Ci,i,e)||(r=n.getClientDims(),!a(bi,r,t)));var i,r}function a(e,t,i){return!e.some(e=>t[e]!==i[e])}},Ci=["width","height","x","y","top","bottom","left","right"],bi=["width","height"];const Ti=function(e,t){const n=yi({},t),s=wi(),a=e.pageInfo.getAmpApi();return function(){try{var t,r,n,s;const a=null==e||null===(t=e.pageInfo)||void 0===t||null===(r=t.docInfo)||void 0===r||null===(n=r.window)||void 0===n||null===(s=n.context)||void 0===s?void 0:s.ni;if(a){const t=JSON.parse(a).attributes._context.ampcontextVersion;e.firePix.fireDyn({long1:i.np,string2:t,string3:"amp"})}}catch(t){e.firePix.fireDyn({long1:i.tf,string2:t.message,string3:"amp"})}}(),a.observeIntersection(function(e){e.forEach(e=>{const t={width:e.rootBounds.width,height:e.rootBounds.height};s._update(e.boundingClientRect,t),n._publishUpdate()})}),(0,r.xO)({},n,s)};const Si=function(e){const t=e.pageInfo.getMraidApi(),i=e.errorHandler;return Object.keys(Mi).reduce(function(e,n){let s=t[n];const a=Mi[n];a.adapters&&(s=function(e,t,i){return function(...r){let n=t.apply(e,r);return i.adapters.filter(Boolean).forEach(e=>{n=e(n)}),n}}(t,s,a));a.validator&&(s=function(e,t,i){return function(...r){const n=t.apply(e,r);i.mraidResult=n;return(0,i.validator)(n),n}}(t,s,a));return s=function(e,t,n,s){const a=(0,r.h)(i.fireError,i),o="mraid api error. function: "+n+", e: ";return function(...r){let n;try{n=t.apply(e,r)}catch(e){a({error:o+e,level:i.INFO,diagnosticContext:s.mraidResult}),n=s.defaultReturn}return n}}(t,s,n,a),e[n]=s,e},{})},Mi={getState:{validator:function(e){if(Ri(e),"string"!=typeof e)throw new f.A("response is not a string value")},adapters:[function(e){if(null!=e&&"object"==typeof e&&"string"==typeof e.state)return e.state;return e}],defaultReturn:"default"},isViewable:{validator:function(e){if(Ri(e),"boolean"!=typeof e)throw new f.A("response is not a boolean value")},adapters:[function(e){if("string"==typeof e){const t=e.trim().toLowerCase();if("true"===t||"yes"===t)return!0;if("false"===t||"no"===t)return!1}else if("number"==typeof e){if(1===e)return!0;if(0===e)return!1}return e}],defaultReturn:!1},getCurrentPosition:{validator:function(e){if(Ri(e),"number"!=typeof e.width||"number"!=typeof e.height||"number"!=typeof e.x||"number"!=typeof e.y)throw new f.A("response width, height, x and y fields must be numbers")},adapters:[function(e){if(null!=e&&void 0!==e.xPos&&void 0!==e.yPos&&void 0!==e.width&&void 0!==e.height)return{width:e.width,height:e.height,x:e.xPos,y:e.yPos};return e}],defaultReturn:{width:0,height:0,x:0,y:0}},getScreenSize:{validator:function(e){if(Ri(e),"number"!=typeof e.width||"number"!=typeof e.height)throw new f.A("response width and height fields must be numbers")},defaultReturn:{width:0,height:0}},addEventListener:{},getVersion:{validator:function(e){if(Ri(e),"string"!=typeof e)throw new f.A("version is not a string value")},adapters:[function(e){if("appnexus"===e)return"3.0";return e}],defaultReturn:""}};function Ri(e){if(null==e)throw new f.A("response is null or undefined")}const Pi=function(e,t){const{placement:n,firePix:s,analytics:a,errorHandler:o,win:l}=e,c=(0,r.h)(o.fireError,o),d=Si(e),h=yi({},t),u=wi();let p,m=0;const g=-1!==Ni.indexOf(n.invCode);let f,v;"loading"===d.getState()?d.addEventListener("ready",_):_();return(0,r.xO)(h,u,{getAdPctInView:function(){if(y())return m;return u.getAdPctInView()},getElPctInView:function(e){if(y())return m;return u.getElPctInView(e)}});function _(){s.fireDyn({long1:2e3,string2:d.getVersion(),string3:n.invCode}),l.MRAID_ENV&&s.fireDyn({long1:i.U9,string2:n.invCode,string3:JSON.stringify(l.MRAID_ENV)}),g&&(v=function(){const e=50;return(0,r.$y)(1e3,1,t=>{const r=t.length;let a=t;if(r>e){const t=(r-1)/(e-1);a=Array.from({length:e},(e,i)=>a[Math.round(i*t)])}s.fireDyn({long1:i.t,long2:r,string2:n.invCode,string3:JSON.stringify(a)})})}(),d.addEventListener("exposureChange",v)),y()?d.addEventListener("exposureChange",A):d.isViewable()&&I(!0),d.addEventListener("viewableChange",I)}function y(){return"3.0"===d.getVersion()&&!g}function A(e){let t=0;if("object"==typeof e&&null!==e&&"exposedPercentage"in e&&"number"==typeof e.exposedPercentage)t=e.exposedPercentage;else{if("number"!=typeof e)return void c({error:xi+"exposureChange event passed non-numeric value",level:o.INFO,diagnosticContext:JSON.stringify(t)});t=e}m=t/100,w()}function I(e){e&&a.onePxViewable(),y()||(g&&!f&&(f=function(){const e=(0,r.$y)(650,1,e=>{s.fireDyn({long1:i.vQ,string2:n.invCode,string3:JSON.stringify(e)})});return(t,i)=>{e({p:t,d:i})}}()),w(),e?p=setInterval(w,Di):clearInterval(p))}function w(){if(!y()){const e=d.getCurrentPosition(),t=d.getScreenSize();g&&f&&f(e,t);const i={width:e.width,height:e.height,x:e.x,y:e.y,top:e.y,bottom:e.y+e.height,left:e.x,right:e.x+e.width};u._update(i,t)}h._publishUpdate()}},Di=200,xi="mraid api error. ",Ni=["Metrozone_App_Infeed_OB","Metrozone_App_Android_Interstitial_OB","Metrozone_App_Android_Interstitial_Native_OB","Vinted_Android_300x250_fixed","CallApp_Contacts_Android_300x250_OB"];const Li=function({firePix:e,pageInfo:t,placement:n,environment:s,errorHandler:a,settings:o,creativePayload:l},c){var d;const h=s.formats,u=[h.image,h.autoplay,h.header_direct_banner,h.native_lite],p=t.getSafeFrameApi();!function(){try{var t,r;const n=p.ver||(null==p||null===(t=p.host)||void 0===t||null===(r=t.Config)||void 0===r?void 0:r.ver);e.fireDyn({long1:i.np,string2:n,string3:"safeframe"})}catch(e){}}();const m=parseInt(null==l||null===(d=l.settings)||void 0===d?void 0:d.format_id,10),g=o.ignoreSafeframeErrors&&u.includes(m),v={getAdBoundingRect:function(){throw new f.A("getAdBoundingRect is not supported in a safeFrame environment")},getBoundingRect:function(){throw new f.A("getBoundingRect is not supported in a safeFrame environment")},getClientDims:function(){throw new f.A("getClientDims is not supported in a safeFrame environment")},getAdPctInView:function(){return p.ext.inViewPercentage()/100},getElPctInView:function(){throw new f.A("getElPctInView is not supported in a safeFrame environment")}},_=yi(v,c);try{const e=p.ext.geom();p.ext.register(e.self.w,e.self.h,e=>{"geom-update"===e&&_._publishUpdate()})}catch(e){if(!g)throw e;a.fireError({category:"SafeFrame Position Service Initialization",error:"Ignoring $sf error: "+e.message,level:a.WARNING}),setInterval(()=>{_._publishUpdate()},1e3)}4913===n.publisherId&&setInterval(()=>{_._publishUpdate()},1e3);return(0,r.xO)({},_,v)};const Oi=function({asyncUtil:e,win:t},i){let n=!0;const s={getAdBoundingRect:o,getBoundingRect:l,getClientDims:c,getAdPctInView:function(){return Ai.getRectPctInView(o(),c())},getElPctInView:function(e){return Ai.getRectPctInView(l(e),c())}},a=yi(s,i);return e.addScrollListener(t.top,a._publishUpdate),(0,r.xO)({},a,s);function o(){const t=s.adContainer.ownerDocument.defaultView?s.adContainer.ownerDocument.defaultView.frameElement:null;return t?(n&&(e.addScrollListener(t.contentDocument,a._publishUpdate),n=!1),t.getBoundingClientRect()):Ai.getDefaultBoundingClientRect()}function l(e){const t=e.getBoundingClientRect(),i=o();return Ai.sumRects(t,i)}function c(){const e=t.top;return{width:e.innerWidth,height:e.innerHeight}}};const ki=function(e,t){const{pageInfo:i}=e;let n;n=i.isMraid()?Pi(e,t):i.isWebview()?Ei(e,t):i.isAmp()?Ti(e,t):i.isSafeFrame()?Li(e,t):i.isFriendlyFrameRender()?Oi(e,t):Ii(e,t);const s=(0,r.QE)(Object.keys(n),ji);if(s.length>0)throw new f.A("positionService invalid. Unmatched keys: "+s.join(", "));return n},ji=["getAdBoundingRect","getAdPctInView","getBoundingRect","getClientDims","getElDims","getElPctInView","setAdContainer"];var Fi=n(567),Vi=n(490);const Hi=function(){return{render:function(e){const t=e.domRefs.mainImage,i=t&&(t.complete||t.naturalWidth>0);t&&"IMG"===t.tagName&&!i&&e.promises.push(new Promise(e=>{t.addEventListener("load",e)}))}}};var Bi=n(370),Wi=n(743);const Ui=function({creative:e,docInfo:t,eventController:i}){let r,n,a;return{render:function(l){r=l.state,n=e.getParams(),function(){const e=t.document;if(n&&n.image_height&&n.image_width)a={width:n.image_width,height:n.image_height};else{const t=e.createElement("img");t.src=n.image_url,a={width:t.naturalWidth,height:t.naturalHeight}}}(),i.on(s.zX,o)}};function o(e){if(n.isCSR){const{x:t,y:i}=(0,Wi.PT)(e,a);r.logoOffsetX=t,r.logoOffsetY=i}else r.logoOffsetX=zi,r.logoOffsetY=zi}},zi=0;var Gi=n(523),qi=n(384);class Yi{constructor({analytics:e,asyncUtil:t,creative:i}){this.analytics=e,this.asyncUtil=t,this.creative=i}init(e){const i=e.domRefs;Object.entries(t.ic).forEach(([e,t])=>{const r=i[e],n=()=>{(0,qi.R)(this.creative.params.clickthrough_url),this.analytics.click({assetTypeId:t})};r&&!this.creative.isComponentMedia()&&(this.asyncUtil.listen(r,"click",n,!1,!0),rt.A.setStyle(r,"cursor","pointer"))})}}const Zi={create:function(e){return new Fi.A({renderers:function(){const{creative:t}=e,i=t.getParams(),r=i.customization&&i.customization.reveal||i.isCSR,n=!t.insertedLogoCorner&&r,s=[Vi.A,Hi];r&&s.push(Bi.A);n&&s.push(Ui);return s}(),eventManagers:[Gi.A,Yi],initState:{},supportedDomRefs:[]},e)}};const Qi={name:"imageRendererFactoryLoader",isSupported:function(e){return e.formatManager.isImage()},load:function(){return new Promise(e=>{e({default:Zi})})}};const Xi=function({creative:e,eventController:t,docInfo:i}){const n=e.getParams();let a,o,l,c;return{render:function(e){a=e,c=i.document.createElement("img"),c.src=n.image_url,t.on(s.zX,d)},_getZoomValues:h};function d(e){const{noCrop:i,no_crop:d}=(0,r.o_)("?"+n.img_server_params).queryKey,u=!(!parseInt(i,10)&&!parseInt(d,10))?{x1:0,x2:n.image_width,y1:0,y2:n.image_height}:n.focal_box;let p,m;if(u){const t=e.width,i=e.height;!function(e,t,i,s){if(t===o&&i===l)return;o=t,l=i;const c=n.image_width,d=n.image_height,u=h(t,i,c,d,s);rt.A.setStyle(e,"background-repeat","no-repeat"),rt.A.setStyle(e,"background-size",u.scaledImgWidth+"px"),rt.A.setStyle(e,"background-position",u.offsetX+"px "+u.offsetY+"px");const{state:p}=a;p.visibleImageWidth=(0,r.Kt)(u.scaledImgWidth,t),p.visibleImageHeight=(0,r.Kt)(u.scaledImgHeight,i),p.imageBoxingOffsetX=Math.max(Math.floor((t-p.visibleImageWidth)/2),0),p.imageBoxingOffsetY=Math.max(Math.floor((i-p.visibleImageHeight)/2),0)}(a.domRefs.mainImageCsrEl,t,i,u),p=a.state.visibleImageWidth,m=a.state.visibleImageHeight}else g=a.domRefs.mainImageCsrEl,rt.A.setStyle(g,"background-position","center"),rt.A.setStyle(g,"background-size","contain"),rt.A.setStyle(g,"background-repeat","no-repeat"),rt.A.setStyle(g,"text-align","left"),rt.A.setStyle(g,"background-color","#FFFFFF");var g;p||m||(p=c.naturalWidth,m=c.naturalHeight),p&&m&&t.publish(s.Kp,(0,Wi.PT)(e,{width:p,height:m}))}function h(e,t,i,r,n){const s=function(e){const{adWidth:t,adHeight:i,imgWidth:r,imgHeight:n,focalWidth:s,focalHeight:a}=e,o=Math.max(t/r,i/n),l=Math.min(t/s,i/a);return Math.min(o,l)}({adWidth:e,adHeight:t,imgWidth:i,imgHeight:r,focalWidth:n.x2-n.x1,focalHeight:n.y2-n.y1}),a=Math.ceil(s*i),o=Math.ceil(s*r),l={};Object.keys(n).forEach(e=>{const t=n[e];l[e]=Math.floor(s*t)});return{scaledImgWidth:a,scaledImgHeight:o,offsetX:u(e,a,l.x1,l.x2),offsetY:u(t,o,l.y1,l.y2)}}function u(e,t,i,r){if(e>t)return Math.round((e-t)/2);const n=Math.round((e-i-r)/2);return n>0?0:n+t<e?e-t:n}};const Ji={create:function(e){const t=[Vi.A,Xi,Bi.A],i=e.creative.params;!(0,r.o_)("?"+i.img_server_params).queryKey.noCrop&&i.focal_box||t.push(Ui);const n=[Gi.A,Yi];return new Fi.A({renderers:t,eventManagers:n,initState:{},supportedDomRefs:[]},e)}};const Ki={name:"cinemagraphRendererFactoryLoader",isSupported:function(e){return e.formatManager.isCinemagraph()},load:function(){return new Promise(e=>{e({default:Ji})})}};const $i={name:"carouselRendererFactoryLoader",isSupported:function(e){return e.formatManager.isCarousel()},load:function(){return n.e(897).then(n.bind(n,771))}};const er=1200;class tr{static isXml(e=""){return e.includes("<VAST")&&e.includes("<Ad")}static hasRootErrorNode(e){return!(!e||e.includes("<Ad"))&&null!=e.match(/<VAST[^>]+><Error/)}static getAdAspectRatio(e){return parseFloat((e.width/e.height).toFixed(2))}static sortByAspectRatio(e,t,i){const r=tr.getAdAspectRatio(i),n=e=>r===e,s=tr.parsedAspectRatio(e),a=tr.parsedAspectRatio(t),o=n(s),l=n(a);return o&&l?tr.sortByClosestDims(e,t,i):o&&!l?-1:l&&!o?1:tr.sortByAspectRatioDistance(e,t,i)}static sortByAspectRatioDistance(e,t,i){const r=tr.getAdAspectRatio(i),n=tr.parsedAspectRatio(e),s=tr.parsedAspectRatio(t),a=e=>Math.abs(e-r),o=a(n),l=a(s);return o<l?-1:l<o?1:tr.sortByClosestDims(e,t,i)}static sortMediaBySize(e,t,i){const r={width:i.imageWidth,height:i.imageHeight},n=tr.dimsLessThanPlacement(e,r),s=tr.dimsLessThanPlacement(t,r);return!n&&s?-1:n&&!s?1:tr.sortByAspectRatio(e,t,r)}static orderBestMediaFiles(e){const t=[],i=[],r=[],n=[],s=(e,t)=>"desc"===t?e.sort((e,t)=>t.getAttribute("bitrate")-e.getAttribute("bitrate")):e.sort((e,t)=>e.getAttribute("bitrate")-t.getAttribute("bitrate"));return e.forEach(e=>{const s=ir(e,"bitrate");s?s>=400&&s<er?t.push(e):s<er?i.push(e):n.push(e):r.push(e)}),s(i,"desc"),s(n),[...t,...i,...n,...r]}static dimsLessThanPlacement(e,t){const i=ir(e,"height");return ir(e,"width")<t.width||i<t.height}static parsedAspectRatio(e){const t=ir(e,"height"),i=ir(e,"width");return t?parseFloat((i/t).toFixed(2)):0}static distanceByDims(e,t){return{width:Math.abs(ir(e,"width")-t.width),height:Math.abs(ir(e,"height")-t.height)}}static sortByClosestDims(e,t,i){const r=tr.distanceByDims(e,i),n=tr.distanceByDims(t,i),s=r.width<n.width&&r.height<n.height,a=r.width>n.width&&r.height>n.height;return s?-1:a?1:tr.sortByBestDeskTopBitRate(e,t)}static sortByBestDeskTopBitRate(e,t){const i=ir(e,"bitrate"),r=ir(t,"bitrate");if(i&&r){const e=i>=400&&i<er,t=r>=400&&r<er;return e&&!t?-1:!e&&t?1:r-i}return i?1:-1}static byBestBitrateMobile(e,t,i){const r=e=>Math.abs(ir(e,"bitrate")-750),n=ir(e,"bitrate"),s=ir(t,"bitrate");return n===s?tr.sortMediaBySize(e,t,i):!n&&s?1:!s&&n?-1:r(e)-r(t)}}function ir(e,t){return parseInt(e.getAttribute(t),10)}class rr{constructor(e){let t;if(!window.DOMParser)throw new f.A("DOMParser API unavailable");t=new DOMParser,this.xmlDocument=t.parseFromString(e,"application/xml")}validateVastXml(){this._validateVastXml()}querySelector(e){return this.xmlDocument.querySelector(e)}querySelectorAll(e){return this.xmlDocument.querySelectorAll(e)}createElement(e){return this.xmlDocument.createElement(e)}createCDATASection(e){return this.xmlDocument.createCDATASection(e)}_validateVastXml(){const e=()=>{if(!this.querySelector("VASTAdTagURI"))throw new f.A("Missing VASTAdTagURI element")},t=()=>{if(!this.querySelector("Creative"))throw new f.A("Missing Creative element(s)");if(!!!this.querySelector("Linear"))throw new f.A("Missing Linear element(s)")};if(!this.querySelector("VAST"))throw new f.A("Missing VAST element");if(!this.querySelector("Ad"))throw new f.A("Missing Ad element");if(this.querySelector("Wrapper"))e();else{if(!this.querySelector("InLine"))throw new f.A("Missing InLine and Wrapper element");t()}}}var nr=n(124);const sr=new Promise(()=>{});class ar{constructor({eventController:e,firePix:t}){(0,g.A)(this,"timeoutID",void 0),(0,g.A)(this,"vastWrapperBreadcrumbs",[]),(0,g.A)(this,"impressionTrackers",[]),(0,g.A)(this,"assortedTrackers",[]),(0,g.A)(this,"videoClickTrackers",[]),(0,g.A)(this,"adVerifications",[]),(0,g.A)(this,"expandMacros",void 0),(0,g.A)(this,"expandOpenRTBMacros",void 0),(0,g.A)(this,"viewableImpressionsTrackers",void 0),this.eventController=e,this.firePix=t,this.bandwidth=null}async getVastXml(e,t){this.expandMacros=t=>e.expandFirstPartyMacros(e.params.additional_data.tid,e.params.asset_id,t),this.expandOpenRTBMacros=t=>e.expandOpenRTBMacros(t);const i=e.params.vast_xml;return tr.hasRootErrorNode(i)?(this.handleErrorNode(i,t),sr):tr.isXml(i)?this._parseVastContent(i,e.formatManager.isAmazonBrandedVideo(),e):this._fetchVast(i)}handleErrorNode(e,t){let i="";try{i=new rr(e).querySelector("VAST Error").textContent}catch(e){}t.fireError({category:"VAST Parser Error Node",error:"No Ad VAST XML: VAST-level contains an Error node",level:Je.A.ERROR,diagnosticContext:{error_uri:i}})}async _fetchVast(e){const t=this.expandMacros(e);this.vastWrapperBreadcrumbs.push({url:e,expandedUrl:t});try{this._startRedirectTimeout();const e=await(0,r.RD)(t,"GET",e=>{this.bandwidth=e});this._clearRedirectTimeout();const i=e.target.responseText;return this._parseVastContent(i)}catch(e){this._clearRedirectTimeout();const t="Wrapper redirect failed. Possible causes include 404s and CORS errors";return this._vastWrapperError(t),sr}}async _parseVastContent(e,t=!1,i){if(!e)throw new f.A("Missing vastXml");let r;try{let i=e;t&&(i=this.expandOpenRTBMacros(e)),r=new rr(i),r.validateVastXml()}catch(e){return this.eventController.publish(s.Io,nr.A.VAST_ERROR_VAST_SCHEMA,{message:e.message}),sr}try{const e=r.querySelector("Ad InLine"),t=r.querySelector("Ad Wrapper");if(this._collectImpressionTrackers(e||t),this._collectAdVerifications(e||t),this._collectViewableImpressionTrackers(e||t),t){if(this._collectCreativeTrackers(t),this._hasExceededRedirectLimit())return sr;try{return await this._fetchVast(t.querySelector("VASTAdTagURI").textContent)}catch(e){this._clearRedirectTimeout(),this.eventController.publish(s.Io,nr.A.VAST_WRAPPER_ERROR)}}if(e){var n;const e=r.querySelector("VideoClicks"),t=null==i||null===(n=i.params)||void 0===n?void 0:n.clickthrough_url;return!e&&t&&(this.eventController.publish(s.Io,nr.A.VAST_UNDEFINED_ERROR,{message:"VideoClicks missing from VAST XML, injecting clickthrough from creative",level:Je.A.WARNING,diagnosticContext:{hasVideoClicks:!1,clickthroughUrl:t,vastHasInline:!0}}),r=this._ensureVideoClicks(r,t)),r}}catch(e){this.eventController.publish(s.Io,nr.A.VAST_WRAPPER_ERROR)}return sr}getImpressionTrackers(e){return[...[].slice.call(e.querySelectorAll("Impression")),...this.impressionTrackers]}getVideoClickTrackers(e){return[...[].slice.call(e.querySelectorAll("ClickTracking")),...this.videoClickTrackers]}getAssortedTrackers(e){return[...[].slice.call(e.querySelectorAll("TrackingEvents Tracking")),...this.assortedTrackers]}getAdVerifications(){return this.adVerifications}getVerificationTrackers(e){const t=this.adVerifications;if(!t||1!==t.length)return[];const i=t[0].querySelectorAll("Verification");if(!i)return[];const r=[];return i.forEach(t=>{if(!e(t))return;const i=t.querySelectorAll("Tracking");i&&i.forEach(e=>{e&&e.textContent&&r.push(e.textContent.trim())})}),r}_collectAdVerifications(e){this.adVerifications.push(...e.querySelectorAll("AdVerifications"))}getBreadcrumbs(){return this.vastWrapperBreadcrumbs}_collectImpressionTrackers(e){const t=[].slice.call(e.querySelectorAll("Impression"));t.length&&(this.impressionTrackers=[...this.impressionTrackers,...t])}_collectCreativeTrackers(e){const t=[].slice.call(e.querySelectorAll("TrackingEvents Tracking")),i=[].slice.call(e.querySelectorAll("ClickTracking"));this.assortedTrackers=[...this.assortedTrackers,...t],this.videoClickTrackers=[...this.videoClickTrackers,...i]}getViewableImpressionTrackers(){return this.viewableImpressionsTrackers}_collectViewableImpressionTrackers(e){var t;if(null!==(t=e.querySelectorAll("ViewableImpression"))&&void 0!==t&&t.length){const t=e.querySelectorAll("Viewable")[0],i=e.querySelectorAll("NotViewable")[0],r=e.querySelectorAll("ViewUndetermined")[0];this.viewableImpressionsTrackers={viewable:t,notViewable:i,viewUndetermined:r}}}_startRedirectTimeout(){this.timeoutID=setTimeout(()=>{this.eventController.publish(s.Io,nr.A.VAST_WRAPPER_TIMEOUT)},5e3)}_clearRedirectTimeout(){clearTimeout(this.timeoutID)}_hasExceededRedirectLimit(){return this.getBreadcrumbs().length>=10&&(this.eventController.publish(s.Io,nr.A.VAST_TOO_MANY_REDIRECTS),!0)}_vastWrapperError(e){this.eventController.publish(s.Io,nr.A.VAST_WRAPPER_ERROR,{message:e,diagnosticContext:{...this.vastWrapperBreadcrumbs}})}_ensureVideoClicks(e,t){try{const i=e.querySelector("Linear");if(!i)return e;const r=e.createElement("VideoClicks"),n=e.createElement("ClickThrough"),s=e.createCDATASection(t);n.appendChild(s),r.appendChild(n);const a=i.querySelector("MediaFiles");return a&&a.parentNode?a.parentNode.insertBefore(r,a):i.appendChild(r),e}catch(t){return e}}_getBandwidth(){return this.bandwidth}}const or={"video/mp4":!0};class lr{constructor({placement:e,environment:{renderOptionsMap:t},settings:i},{creative:r,firePix:n,asyncUtil:a,eventController:o,errorHandler:l,browserDetector:c}){this.placement=e,this.renderOptionsMap=t,this.settings=i,this.creativeObj=r,this.asyncUtil=a,this.errorHandler=l,this.firePix=n,this.browserDetector=c,this.errorCode=null,this.connectionDynFired=!1,this.vastXmlResponseTime=null,this.vastParser=new ar({eventController:o,firePix:n}),this.vastXml=null,this.InLine=null,this.Creative=null,o.on(s.Io,e=>{this.errorCode=e})}async getVastXml(){const e=performance?performance.now():0;this.vastXml=await this.vastParser.getVastXml(this.creativeObj,this.errorHandler),this.InLine=this.vastXml.querySelector("InLine");const t=performance?performance.now():0;this.vastXmlResponseTime=t-e,this.Creative=this.InLine.querySelector("Creative"),this.vastObtained=!0,this.expandClickTrackers()}addExpandClickTrackersListener(e){this.expandClickTrackersCallback=e,this.expandClickTrackers()}expandClickTrackers(){this.vastObtained&&this.expandClickTrackersCallback&&this.expandClickTrackersCallback()}getAdParameters(){const e=this.Creative.querySelector("AdParameters");return e?e.textContent:null}getAdSystem(){const e=this.InLine.querySelector("AdSystem");return e?e.textContent:null}getDurationMS(){const e=this.Creative.querySelector("Duration")||{};return(0,r.FQ)(e.textContent)}getVastClickThrough(){return this.Creative.querySelector("ClickThrough")}getVastClickThroughUrl(){const e=this.getVastClickThrough();return e?e.textContent:null}getMediaFiles(e=this.Creative){return[].slice.call(e.querySelectorAll("MediaFile"))}getAdVerifications(){let e=this.vastParser.getAdVerifications();return e=e.filter(e=>e.querySelector('JavaScriptResource[apiFramework="omid"]')),e.map(e=>{var t,i;const n=null===(t=e.querySelector("JavaScriptResource"))||void 0===t?void 0:t.textContent.trim(),s=null===(i=e.querySelector("VerificationParameters"))||void 0===i?void 0:i.textContent.trim();return{javascriptResource:n,verificationParameters:s,vendor:e.querySelector("Verification").getAttribute("vendor").trim(),url:s?n+"?"+(0,r.vF)(s):n}})}getLinear(){return this.Creative.querySelector("Linear")}getImpressionTrackers(){return this.vastParser.getImpressionTrackers(this.getLinear())}getVideoClickTrackers(){return this.vastParser.getVideoClickTrackers(this.getLinear())}getAssortedTrackers(){return this.vastParser.getAssortedTrackers(this.getLinear())}getVastWrapperBreadcrumbs(){return this.vastParser.getBreadcrumbs()}getViewableImpressionTrackers(){return this.vastParser.getViewableImpressionTrackers()}useNextVpaidCreative(){const e=this._getNextVpaidCreative();return e&&(this.Creative=e),e}_getNextVpaidCreative(){const e=[].slice.call(this.InLine.querySelectorAll("Creative")),t=e.indexOf(this.Creative);return e.slice(t+1).find(e=>this._getJavascriptVpaid(e).length>0)}chooseBestMediaFiles({useBitrate:e=!1}={}){const t=this.isVpaid()?this._getJavascriptVpaid():this._getSupportedMediaFiles();if(!t.length)return this.getMediaFiles();if(e)return t.sort((e,t)=>tr.byBestBitrateMobile(e,t,this.placement)).slice(0,1);const n=t.slice().sort((e,t)=>tr.sortMediaBySize(e,t,this.placement)),s=tr.orderBestMediaFiles(n),a=()=>{if(!this.connectionDynFired)try{var e,t;const r=this.browserDetector.getBrowserInfo(),n={placementId:this.placement.id,placementInvCode:this.placement.invCode,creativeId:this.creativeObj.params.additional_data.crid,browser:Object.keys(this.browserDetector.getBrowserInfo()).filter(e=>!0===r[e]).join(","),device:this.browserDetector.getDeviceType(),networkSpeed:(null===(e=navigator)||void 0===e||null===(t=e.connection)||void 0===t?void 0:t.effectiveType)||"unknown",renderedCreativeBitRate:s[0].getAttribute("bitrate"),estimatedBandwidthInKbsFromVast:this.vastParser._getBandwidth(),isVpaid:this.isVpaid(),vastXmlResponseTime:this.vastXmlResponseTime,mediaFile:s[0].outerHTML.replace(/\s+/g,""),hasMultipleFiles:s.length>1};this.firePix.fireDyn({long1:i.OM,string2:JSON.stringify(n)}),this.connectionDynFired=!0}catch(e){}};return(0,r.XM)(.001,()=>a()),s}_getJavascriptVpaid(e=this.Creative){return this.getMediaFiles(e).filter(e=>{const t="VPAID"===e.getAttribute("apiFramework"),i=e.getAttribute("type");return t&&("application/x-javascript"===i||"application/javascript"===i)})}_getSupportedMediaFiles(){return this.getMediaFiles().filter(e=>or[e.getAttribute("type")])}isVpaid(){const e=[].slice.call(this.Creative.querySelectorAll("MediaFile"));return!!e.length&&e.some(e=>"VPAID"===e.getAttribute("apiFramework"))}}const cr={name:"videoRendererFactoryLoader",isSupported:function(e){return e.isVast()},load:async function({placement:e,environment:t,settings:i,creative:r,firePix:s,errorHandler:a,eventController:o,asyncUtil:l,browserDetector:c}){const d=new lr({placement:e,environment:t,settings:i},{creative:r,eventController:o,firePix:s,asyncUtil:l,errorHandler:a,browserDetector:c});return r.setVastTag(d),nr.A.listen({errorHandler:a,eventController:o}),await d.getVastXml(),n.e(263).then(n.bind(n,631))}};const dr={name:"scrollRendererFactoryLoader",isSupported:function(e){return e.formatManager.isScroll()},load:function(){return n.e(148).then(n.bind(n,120))}};const hr={name:"windowRendererFactoryLoader",isSupported:function(e){return e.formatManager.isWindow()},load:function(){return n.e(607).then(n.bind(n,961))}};const ur=function({creative:e,eventController:i,analytics:n,firePix:a,errorHandler:o}){const{banner_markup:l,banner_height:c,banner_width:d}=e.params;return{render:function(t){const n=t.domRefs,a=function(){const t=h(),n=document.createElement("iframe");n.className=mr,n.height=c,n.width=d,n.frameBorder="0",n.scrolling="no",n.marginHeight="0",n.marginWidth="0",n.tabIndex=-1,n.setAttribute("allowtransparency","true"),n.setAttribute("hidefocus","true");const a=()=>{try{var i;const l=null===(i=n.contentWindow)||void 0===i?void 0:i.document;if(l.open(),e.useShadowRoot()){const i="<!DOCTYPE html><html><head></head><body></body></html>",r=ft.B.wrapAdString(t,e.useShadowRoot());l.write(i),l.body.appendChild(r)}else{var r,s;const i="<!DOCTYPE html><html><head></head><body>"+t+"</body></html>";l.write(i),pr===(null==e||null===(r=e.params)||void 0===r||null===(s=r.additional_data)||void 0===s?void 0:s.biid)&&o.fireError({category:"Banner Renderer Friendly Iframe",error:"Content written to iframe",diagnosticContext:i,block:"bannerRenderer",level:Je.A.INFO})}l.close(),n.removeEventListener("load",a)}catch(e){o.fireError({category:"Banner Renderer Friendly Iframe",error:"Error writing content to iframe.",block:"br_writeContent",diagnosticContext:e,level:o.ERROR})}};return i.on(s.Ol,()=>{var e,t;"complete"===(null===(e=n.contentWindow)||void 0===e||null===(t=e.document)||void 0===t?void 0:t.readyState)?a():n.addEventListener("load",a)}),(0,r.c3)(e.params.additional_data.adid,n),n}();return n.adWrapper=a,n.adWrapperWithDims=a,n.mainImage=a,n},_expandClickMacro:h};function h(){const i=e.params.additional_data.pr,r=e.params.additional_data.biid;let s="";"AUDIT"!==i?s=n.getRedirectClickUrl():a.fireDyn({long1:r,string2:"AUDIT_DYN"});const o=t.yl;let c=l;return o.forEach(e=>{const{regex:t,level:i}=e;if(t.test(c)){const e=Wt(s,i);c=c.replace(t,e)}}),c}},pr="7942",mr=t.hj+"iframe";const gr={create:function(e){return new Fi.A({renderers:[ur],eventManagers:[Gi.A],initState:{},supportedDomRefs:[]},e)}};const fr={load:function({placement:e,environment:t,settings:i,creative:r,firePix:n,errorHandler:s,eventController:a,asyncUtil:o,browserDetector:l}){const c=function(e,t){const i=e.find(e=>e.isSupported(t));void 0===i&&function(){throw new f.A("Supported renderer factory not found.")}();return i}(vr,r),d=function(e,t){return e.filter(e=>e.isSupported(t))}(_r,r).map(e=>e.load()),h=c.load({placement:e,environment:t,settings:i,creative:r,firePix:n,errorHandler:s,eventController:a,asyncUtil:o,browserDetector:l});return d.unshift(h),Promise.all(d)}},vr=[Qi,Ki,$i,cr,dr,{name:"pharmaRendererFactoryLoader",isSupported:function(e){return e.formatManager.isPharma()},load:function(){return n.e(788).then(n.bind(n,418))}},hr,{name:"bannerRendererFactoryLoader",isSupported:function(e){return e.formatManager.isBanner()},load:function(){return new Promise(e=>{e({default:gr})})}}],_r=[{name:"revealConfigFactoryLoader",isSupported:function(e){return e.params.customization&&e.params.customization.reveal},load:function(){return n.e(896).then(n.bind(n,155))}},{name:"shoppableMediaConfigFactoryLoader",isSupported:function(e){return e.isComponentMedia()&&!e.formatManager.isDocAds()&&e.formatManager.isShoppableMedia()},load:function(){return n.e(195).then(n.bind(n,465))}},{name:"componentMediaConfigFactoryLoader",isSupported:function(e){return e.isComponentMedia()&&!e.formatManager.isDocAds()&&!e.formatManager.isShoppableMedia()},load:function(){return n.e(540).then(n.bind(n,161))}},{name:"pillarboxingConfigFactoryLoader",isSupported:function(e){return e.hasVideoPillarboxFeature()},load:function(){return n.e(886).then(n.bind(n,256))}},{name:"parallaxConfigFactoryLoader",isSupported:function(e){return e.hasParallaxFeature()},load:function(){return n.e(738).then(n.bind(n,738))}},{name:"templateComponentConfigFactoryLoader",isSupported:function(e){return e.isTemplateComponent()},load:function(){return n.e(834).then(n.bind(n,832))}}];class yr{constructor({topWindow:e}){const t=e.document,i=[t.URL,t.referrer,window.document.URL,window.document.referrer].find(yr.isTripleLiftTest);if(this.debugFlag=!!i,i){const e=(0,r.o_)(i),{tl_image_id:t,tl_template_id:n,tl_force_shadow_root:s,tid:a,tl_dyn_id:o,tl_scu_id:l,tl_preview_id:c,tp_preview_id:d,tl_debug_log:h,view_type:u,render_options_bm:p,tl_image_width:m,tl_image_height:g,tl_tactic_id:f,tl_creative_id:v,tl_deal_id:_,tlBidUrl:y,tl_is_adobe:A,tl_highlight:I,tl_max_width:w,tl_max_height:E,tl_diagnostic_data:C,aurl:b,tlLogCoordinated:T}=e.queryKey;this.tlImageId=t,this.tlTemplateId=n||a,this.forceShadowRoot=!!s,this.debugLog=!!h,this.tlBidUrl=!!y&&decodeURIComponent(y),this.forceBidUrl=!!(c||d||this._isCaptureToolForcedRender(u)),this.adPreview=!!(c||d||this._isAdPreview(u)||this._isCaptureToolForcedRender(u)),this.renderOptionsBM=parseInt(p,10)||0,this.thirdPartyAdPreview=!!d,this.tlPreviewId=c,this.tpPreviewId=d,this.tlDynId=o||l,this.tlImageWidth=m,this.tlImageHeight=g,this.tlTacticId=f,this.tlCreativeId=v,this.tlDealId=_,this.tlIsAdobe=A,this.tlHighlight=I,this.tlMaxWidth=w,this.tlMaxHeight=E,this.tlDiagnosticData=C,this.tlLogCoordinated=T,this.tlAssetsURL=b?decodeURIComponent(b):null}}_isCaptureToolLiveRender(e){return e&&"captureToolLive"===e}_isCaptureToolForcedRender(e){return e&&"captureTool"===e}_isAdPreview(e){return e&&!this._isCaptureToolLiveRender(e)&&!this._isCaptureToolForcedRender(e)}hasForcedDimensions(){return!(!this.tlMaxWidth||!this.tlMaxHeight)}getForcedDimensions(){const e=Number(this.tlMaxWidth),t=Number(this.tlMaxHeight);return{placementDims:{width:e,height:t},templateDims:{width:e,height:t,aspectRatio:e/t}}}static isTripleLiftTest(e){return"string"==typeof e&&e.toLowerCase().includes("triplelifttest=true")}}var Ar=n(704);class Ir extends Ar.Ay{constructor(e){super(e),this.priority=Ar.nI.SECOND}async run(){this.eventController.publish(s.Bj),super.run()}}class wr{constructor(e){(0,g.A)(this,"eventController",void 0),(0,g.A)(this,"runners",[]),this.eventController=e,e.on(s.$w,()=>this.runFallbacks())}addManager(e){const t=this.runners.findIndex(t=>t.priority===e.priority);-1!==t?this.runners.splice(t,1,e):this.runners.push(e)}async runFallback(e){e.state===Ar.G_.init&&e.conditionsMet()&&await e.run()}async runFallbacks(){this.runners.sort((e,t)=>e.priority-t.priority);for(let e=0;e<this.runners.length&&(await this.runFallback(this.runners[e]),!this.runners[e].success);e++);}}class Er extends x{constructor(e,t){super(t),this.banner_markup=e.adm,this.banner_width=null==e?void 0:e.w,this.banner_height=null==e?void 0:e.h}}class Cr extends Ce{constructor(e,t,i){super(i),this.index=t;const r=this.getOnlyMultiIndexElements(e.native.asset,t),n=this.getOnlyMultiIndexElements(e.event,t);this.populateAssets(r,i),this.populateEvents(n)}populateEvents(e){this.initializeEventTrackers();for(let t=0;t<(null==e?void 0:e.length);t++){const i=e[t],r=i.type,n=i.method;if(r===fe)n===me?this.impression_pixels.push(i.url):n===ge&&this.js_trackers.push(i.url);else if(r===ve&&n===me)this.viewability_pixels.push(i.url);else if(r===_e&&n===me)this.clickthrough_pixels.push(i.url);else if(r===ye&&n===ge){const e=i.ext;let t=null;(e.omidVendorKey||e.omidVerificationParameter.length>0)&&(t={omidVendorKey:e.omidVendorKey,omidVerificationParameter:e.omidVerificationParameter}),this.omidTracker={event:Ae.TRACKER_EVENT_OMID,method:we,url:i.url,ext:t}}}}}class br{constructor(t,i,r){var n,s;(0,g.A)(this,"format_id",void 0),(0,g.A)(this,"additional_data",void 0),(0,g.A)(this,"template_id",void 0),(0,g.A)(this,"customization",void 0),(0,g.A)(this,"payable_event",void 0),(0,g.A)(this,"billable_event",void 0),(0,g.A)(this,"billable_pixel",void 0),(0,g.A)(this,"adchoices_url",void 0),(0,g.A)(this,"client_side_render",void 0),(0,g.A)(this,"nob_passthru",void 0),(0,g.A)(this,"render_options_bm",void 0),(0,g.A)(this,"creativeAssetId",void 0),(0,g.A)(this,"viewability",void 0),(0,g.A)(this,"prv_sample_rate",void 0),(0,g.A)(this,"dco_tag_url",void 0),(0,g.A)(this,"dco_protocol",void 0),(0,g.A)(this,"banner_width",void 0),(0,g.A)(this,"banner_height",void 0),(0,g.A)(this,"external_creative_type_id",void 0),(0,g.A)(this,"disclosure",void 0),(0,g.A)(this,"ib_experiment_bitmask",void 0),(0,g.A)(this,"cta",void 0),(0,g.A)(this,"isi_url",void 0),(0,g.A)(this,"logo_image_url",void 0),(0,g.A)(this,"logo_width",void 0),(0,g.A)(this,"logo_height",void 0),(0,g.A)(this,"alt_logo_image_url",void 0),(0,g.A)(this,"advertiser_name",void 0),(0,g.A)(this,"ad_markup",void 0),(0,g.A)(this,"customer_review",void 0),(0,g.A)(this,"product_name",void 0),(0,g.A)(this,"location",void 0),(0,g.A)(this,"date",void 0),(0,g.A)(this,"time",void 0),(0,g.A)(this,"template_component_url",void 0),(0,g.A)(this,"deal_id",void 0),(0,g.A)(this,"environment",void 0),this.environment=r,this.format_id=t.tlFormatId,this.additional_data=t.tlAdditionalData,this.template_id=t.templateId,this.customization=t.customization,this.payable_event=t.payableEvent,this.billable_event=t.billableEvent,this.billable_pixel=t.billablePixel,this.adchoices_url=t.adchoicesUrl,this.client_side_render=t.clientSideRender,this.nob_passthru=t.nobPassthru,this.render_options_bm=t.renderOptionsBm,this.use_shadow_root=t.useShadowRoot,this.creativeAssetId=t.creativeAssetId,this.viewability=t.viewability,this.forced_bid=t.forcedBid,this.prv_sample_rate=t.prvSampleRate,this.dco_tag_url=t.dcoTagUrl,this.dco_protocol=t.dcoProtocol,this.banner_width=t.bannerWidth,this.banner_height=t.bannerHeight,this.disclosure={text:"Learn more",render_method:e.Zn.DRM_DEFAULT},this.customer_review=t.customerReview,this.product_name=t.productName,this.deal_id=t.dealId,this.impression_pixels=t.impression_pixels,this.js_trackers=t.jsPixels,this.viewability_pixels=t.viewabilityPixels,this.omid=void 0,this.bundle=void 0,null!==(n=this.viewability)&&void 0!==n&&n.adelaide&&(this.additional_data||(this.additional_data={}),this.additional_data.adelaide=this.viewability.adelaide),i&&null!=this&&null!==(s=this.additional_data)&&void 0!==s&&s.ts&&(this.additional_data.ts=Math.floor(Date.now()/1e3)),this.renderQualityExp=t.renderQualityExp,this.passedTlUid=t.passedTlUid,this.external_creative_type_id=t.externalCreativeTypeId,this.useNewRenderMethodSafeFrame=t.useNewRenderMethodSafeFrame,this.useNewRenderMethodFriendlyFrame=t.useNewRenderMethodFriendlyFrame,this.useNavigatorBeacon=t.useNavigatorBeacon,this.passed_tag_id=t.passedTagId,this.passed_gpid=t.passedGpid,this.external_creative_id=t.externalCreativeId,this.adpreview_hash=t.adpreviewHash,this.parent_id=t.parentId,this.javascripts=t.javascripts,this.useRetailMediaDco=t.useRetailMediaDco,this.ib_experiment_bitmask=t.ibExperimentBitmask}}class Tr extends x{constructor(e,t){var i,r;super(t),this.vast_xml=e.curl?e.curl:e.adm,this.creative_type="vast",this.length_seconds=this.getDuration(e),this.cc_url=null===(i=e.ext)||void 0===i||null===(r=i.tlVideo)||void 0===r?void 0:r.closedCaptionUrl}getDuration(e){var t;const i=null===(t=e.ext)||void 0===t?void 0:t.tlVideo;let r=0;return r=null!=i&&i.durationMs?i.durationMs()/1e3:e.dur,r}}class Sr{constructor(e,t,i,r){this.display=e.display,this.video=e.video,this.assets=[],this.settings=new br(e.ext,t,r),this.video?this.populateVideoAssets():i?this.populateBannerAssets():this.display&&this.display.native&&(this.populateNativeAssets(e),this.populateNativeSettings(e)),this.addBundle(e)}populateNativeAssets(e){var t;const i=e.display;let r=1;null!==(t=i.native.ext)&&void 0!==t&&t.tlMultiCount&&(r=i.native.ext.tlMultiCount);const n=i.native.link;for(let t=0;t<r;t++){var s;const r=new Cr(i,t,this.settings);this.assets.push(r),n&&this.setLink(r,n),r.asset_id=null===(s=e.ext)||void 0===s?void 0:s.creativeAssetId}}setLink(e,t){!t.url||e.clickthrough_url&&""!==e.clickthrough_url||(e.clickthrough_url=t.url);const i=t.trkr||t.clicktrackers;!i||0===i.length||e.clickthrough_pixels&&0!==e.clickthrough_pixels.length||(e.clickthrough_pixels=i)}populateNativeSettings(e){var t,i,r,n,s,a,o,l,c,d,h,u,p,m,g;this.settings.ad_markup=null==e||null===(t=e.display)||void 0===t?void 0:t.adm,this.settings.adchoices_url=null==e||null===(i=e.display)||void 0===i?void 0:i.priv,this.settings.dco_protocol=null==e||null===(r=e.display)||void 0===r||null===(n=r.native)||void 0===n||null===(s=n.ext)||void 0===s?void 0:s.tlDcoProtocol,this.settings.dco_tag_url=null==e||null===(a=e.display)||void 0===a||null===(o=a.native)||void 0===o||null===(l=o.ext)||void 0===l?void 0:l.assetsurl,this.settings.javascripts=null==e||null===(c=e.display)||void 0===c||null===(d=c.native)||void 0===d||null===(h=d.ext)||void 0===h?void 0:h.javascripts,this.settings.template_component_url=null==e||null===(u=e.display)||void 0===u||null===(p=u.native)||void 0===p||null===(m=p.ext)||void 0===m?void 0:m.amazonTemplateIndicator;const f=null==e||null===(g=e.display)||void 0===g?void 0:g.api;null!=f&&Array.isArray(f)&&this.addOmid(f)}addOmid(e){e.some(e=>e===Ee)&&(this.settings.omid=1)}populateVideoAssets(){const e=new Tr(this.video,this.settings);this.assets.push(e)}populateBannerAssets(){const e=new Er(this.display,this.settings);this.assets.push(e)}addBundle(e){const t=null==e?void 0:e.bundle;t&&(this.settings.bundle=t)}}class Mr{constructor({ad:e},t,i,r,n){if(e)try{this.ad=new Sr(e,i,r,n)}catch(i){t.fireError({category:"ACDOM Ad Parsing",error:"Error parsing assets to DCR: "+i.toString(),level:t.ERROR,diagnosticContext:e})}}getAssets(){var e;return null===(e=this.ad)||void 0===e?void 0:e.assets}getSettings(){var e;return null===(e=this.ad)||void 0===e?void 0:e.settings}}class Rr{constructor(e){this.errorHandler=e.errorHandler,this.eventController=e.eventController,this.settings=e.settings,this.pageInfo=e.pageInfo,this.viewabilityController=e.viewabilityController,this.templateCode=e.templateCode,this.browserInfo=e.browserInfo,this.formatManager=e.formatManager,this.creativeParams=e.creativeParams,this.domRefs=e.domRefs}getResizeDimensions(e){var t,i,n;let s=(0,r.gf)(null===(t=e.templateDims)||void 0===t?void 0:t.width)?e.templateDims.width:null,a=(0,r.gf)(null===(i=e.templateDims)||void 0===i?void 0:i.height)?e.templateDims.height:null;const o=(0,r.gf)(null===(n=e.templateDims)||void 0===n?void 0:n.aspectRatio)?e.templateDims.aspectRatio:null;if(!o||0===o)return{width:0,height:0,aspectRatio:0};if(e.placementDims){const t=e.placementDims.width,i=e.placementDims.height;(0,r.gf)(t)&&(s=(0,r.gf)(s)?Math.min(s,t):t,a=Math.floor(s/o)),(0,r.gf)(i)&&(a=(0,r.gf)(a)?Math.min(a,i):i,s=Math.floor(a*o))}const l=e.deviceWidth;(0,r.gf)(l)&&(s=(0,r.gf)(s)?Math.min(s,l):l,a=Math.floor(s/o)),(0,r.gf)(s)?a=Math.floor(s/o):(0,r.gf)(a)?s=Math.floor(a*o):(s=0,a=0);return{width:s,height:a,aspectRatio:o,scale:this.calculateScale(s,a,e.templateDims)}}calculateScale(e,t,i){let r=1;return e&&i.width?r=e/i.width:t&&i.height&&(r=t/i.height),Math.min(Math.round(100*r)/100,1)}getExpandDimensions(e,t){const i={top:0,left:0,right:0,bottom:0};if(t.width>=0)if(t.width<=e.right)i.right=t.width;else if(t.width<=e.left)i.left=t.width;else{if(!(t.width<=e.right+e.left))return null;i.left=e.left,i.right=t.width-e.left}if(t.height>=0)if(t.height<=e.bottom)i.bottom=t.height;else if(t.height<=e.top)i.top=t.height;else{if(!(t.height<=e.top+e.bottom))return null;i.top=e.top,i.bottom=t.height-e.top}return i}_validConstraints(e){var t,i,n;const s=(0,r.gf)(null===(t=e.templateDims)||void 0===t?void 0:t.aspectRatio)&&(0,r.gf)(null===(i=e.templateDims)||void 0===i?void 0:i.width)&&(0,r.gf)(null===(n=e.templateDims)||void 0===n?void 0:n.height);if(!s){var a,o,l,c;const t=null===(a=this.pageInfo)||void 0===a||null===(o=a.placement)||void 0===o?void 0:o.templateId;this.errorHandler.fireError({category:"New IB Render Method Constraints Validation",error:"Missing or invalid constraints for template "+t,level:this.errorHandler.WARNING,block:A,diagnosticContext:{resizeConstraints:e,placementId:null===(l=this.pageInfo)||void 0===l||null===(c=l.placement)||void 0===c?void 0:c.id,templateId:t}})}return s}canResize(){return this.pageInfo.isFriendlyFrameRender()}resize(e){throw new Error("resize method not implemented")}_validateDimensions(e){var t,i,r,n;return!(e.width<250||e.height<90)||(this.errorHandler.fireError({category:"New IB Render Method Dimensions Validation",error:"invalid dimensions",level:this.errorHandler.WARNING,block:A,diagnosticContext:{dimensions:e,placementId:null===(t=this.pageInfo)||void 0===t||null===(i=t.placement)||void 0===i?void 0:i.id,templateId:null===(r=this.pageInfo)||void 0===r||null===(n=r.placement)||void 0===n?void 0:n.templateId}}),!1)}_logResizeDyn(e){(0,r.XM)(.5,()=>{var t,r,n,s,a,o;const l={string2:JSON.stringify(e),string3:null===(t=this.pageInfo)||void 0===t||null===(r=t.placement)||void 0===r?void 0:r.invCode,long1:i.xR,long2:null===(n=this.pageInfo)||void 0===n||null===(s=n.placement)||void 0===s?void 0:s.id,long3:null===(a=this.pageInfo)||void 0===a||null===(o=a.placement)||void 0===o?void 0:o.templateId};this.errorHandler.firePix.fireDyn(l)})}startResize(e){var t,i,r,n;if(this.shouldPreventResize(e))return this.errorHandler.fireError({category:"New IB Render Method Resize Start",error:"cannot resize",level:this.errorHandler.WARNING,block:A,diagnosticContext:{resizeConstraints:e,placementId:null===(t=this.pageInfo)||void 0===t||null===(i=t.placement)||void 0===i?void 0:i.id,templateId:null===(r=this.pageInfo)||void 0===r||null===(n=r.placement)||void 0===n?void 0:n.templateId}}),!1;const s=this.getResizeDimensions(e);return!!this._validateDimensions(s)&&(this.resize(s),this._logResizeDyn(s),!0)}shouldPreventResize(e){return this.formatManager.isHdConnection()||!this.canResize()||!this._validConstraints(e)}}class Pr extends Rr{constructor(e){super(e),(0,g.A)(this,"isFixedWidthLogged",!1),this.eventController=e.eventController}canResize(){return this.pageInfo.isFriendlyFrame()||this.pageInfo.isFriendlyFrameRender()}resize(e){var i;(((null===(i=this.creativeParams)||void 0===i?void 0:i.ib_experiment_bitmask)||0)&t.aD.RESIZE_BEFORE_AOP)>0?(this.smartFlex(this.pageInfo.placement,e),this.eventController.publish(s.Gz,e),this.eventController.publish(s.zX,e)):this.eventController.on(s.Ol,()=>{this.smartFlex(this.pageInfo.placement,e),this.eventController.publish(s.Gz,e),this.eventController.publish(s.zX,e)})}_compareDimensions(e,t,i={}){const r=t.clientHeight,n=t.clientWidth,s=i.offsetHeight,a=i.offsetWidth,o=i.querySelector("[data-tl-template]")||{},l=o.offsetHeight||0,c=o.offsetWidth||0,d=.05*r,h=.15*r,u=.015*r,p=.015*n,m=(i,o,d={})=>{var h,u,p,m,g;this.errorHandler.fireError({category:"New IB Render Method Dimensions Validation",error:i,level:o,block:A,diagnosticContext:{dimensions:e,placementId:null===(h=this.pageInfo)||void 0===h||null===(u=h.placement)||void 0===u?void 0:u.id,templateId:null===(p=this.pageInfo)||void 0===p||null===(m=p.placement)||void 0===m?void 0:m.templateId,iframeId:t.id,frameHeight:r,frameWidth:n,frameType:null===(g=this.pageInfo)||void 0===g?void 0:g.getFrameType(),tlodHeight:s,tlodWidth:a,templateWidth:c,templateHeight:l,...d}})};r&&n?(this._checkForHiddenElements(t,i,m),(r<s||r<l)&&(s&&s-r>h||l&&l-r>h?m("High - Template or ad container is larger than iframe",this.errorHandler.WARNING):s&&s-r>d&&s-r<=h||l&&l-r>d&&l-r<=h?m("Moderate - Template or ad container is larger than iframe",this.errorHandler.WARNING):(s&&s-r>0&&s-r<=d||l&&l-r>0&&l-r<=d)&&m("Low - Template or ad container is larger than iframe",this.errorHandler.WARNING)),(s&&r-s>u||l&&r-l>u)&&m("Iframe height is larger than template height",this.errorHandler.INFO),(a&&n-a>p||c&&n-c>p)&&m("Iframe width is larger than template width",this.errorHandler.INFO)):m("Iframe dimensions are zero",this.errorHandler.WARNING)}_checkForHiddenElements(e,t,i){const r=[];if(r.push({element:e,name:"iframe"}),t){r.push({element:t,name:"tlod-container"});const e=t.querySelector(".tl_ut");e&&r.push({element:e,name:"tlod-main-"+e.id,id:e.id});["[data-tl-template]",".tl-wrapper",".tl-image",".tl-video",".tl-content"].forEach(e=>{t.querySelectorAll(e).forEach((t,i)=>{r.push({element:t,name:e.replace(/[[\].]/g,"")+"-"+i,id:t.id||e+"-"+i})})})}r.forEach(({element:e,name:t,id:r})=>{if(!e)return;const n=e.getBoundingClientRect(),s=window.getComputedStyle(e);0!==n.width&&0!==n.height||i("Element "+t+" has zero dimensions",this.errorHandler.WARNING,{elementId:r||e.id,height:n.height,width:n.width}),"none"===s.display&&i("Element "+t+" is hidden (display: none)",this.errorHandler.WARNING,{elementId:r||e.id}),"hidden"===s.visibility&&i("Element "+t+" is hidden (visibility: hidden)",this.errorHandler.WARNING,{elementId:r||e.id}),0===parseFloat(s.opacity)&&i("Element "+t+" is hidden (opacity: 0)",this.errorHandler.WARNING,{elementId:r||e.id}),(n.left<-9999||n.top<-9999)&&i("Element "+t+" is positioned off-screen",this.errorHandler.WARNING,{elementId:r||e.id})})}resizeFrame(e,t){try{const i=e.width,r=e.height,n=this.domRefs.adWrapper;this.copyPublisherFontStyle(t),this._isAutoresizable()?this._resizeAutoresizableFrame(t,i,r,n):(t.style.border="0",t.setAttribute("frameborder","none"),this._setHeight(t,r),this._setWidth(t,i)),setTimeout(()=>{this._compareDimensions(e,t,n)},100)}catch(e){var i,r,n,s,a,o;this.errorHandler.fireError({category:"New IB Render Method Frame Resize",error:"Iframe resize failed",level:this.errorHandler.WARNING,block:A,diagnosticContext:{placementId:null===(i=this.pageInfo)||void 0===i||null===(r=i.placement)||void 0===r?void 0:r.id,templateId:null===(n=this.pageInfo)||void 0===n||null===(s=n.placement)||void 0===s?void 0:s.templateId,formatId:null===(a=this.formatManager)||void 0===a?void 0:a.formatId,frameType:null===(o=this.pageInfo)||void 0===o?void 0:o.getFrameType(),error:e.message}})}}copyPublisherFontStyle(e){var t;const i=null===(t=this.pageInfo.docInfo)||void 0===t?void 0:t.topDocument;if(i){const t=this.pageInfo.docInfo._topWindow.getComputedStyle(i.body),r=null==t?void 0:t.fontFamily;r&&(e.contentDocument.body.style.fontFamily=r)}}resizeOuterIframe(e,t,i){i.style.width=e,i.style.height=t}logError(e){this.errorHandler.fireError({category:"New IB Render Method",error:e,level:this.errorHandler.INFO,block:A,ref:encodeURIComponent(document.URL)})}checkParents(e,t){const i=t.imageHeight;let r=e.parentElement,n=1;for(;r&&n<=3;){r.getBoundingClientRect().height<i&&this.shouldResizeElement(r,n)&&this.resizeOuterIframe("auto","auto",r),r=r.parentElement,n++}}_getFixedWidth(e){const t=e.style.width||e.width||getComputedStyle(e).width||"";return!t.includes("px")||isNaN(t.slice(0,t.length-2))?NaN:parseInt(t.slice(0,t.length-2),10)}_getFrameElement(){return frameElement||this.pageInfo.docInfo.window.frameElement}shouldResizeElement(e,t){switch(t){case 1:return/google_ads_iframe_/.test(e.id);case 2:return/div-gpt-ad-/.test(e.id);default:return!1}}smartFlex(e,t){try{const d=this._getFrameElement();if(null!==d){if(null!==d.ownerDocument.defaultView.frameElement){const i=d.ownerDocument.defaultView.frameElement;this.resizeFrame(t,i),this.checkParents(i,e)}this.resizeFrame(t,d),this.checkParents(d,e),this._applyMinimumDimensionsExperiment(d)}else{var i,r,n,s,a,o,l,c;this.errorHandler.fireError({category:"New IB Render Method Smart Flex",error:"Not in friendly iframe",level:this.errorHandler.WARNING,block:A,diagnosticContext:{dimensions:t,placementId:null===(i=this.pageInfo)||void 0===i||null===(r=i.placement)||void 0===r?void 0:r.id,templateId:null===(n=this.pageInfo)||void 0===n||null===(s=n.placement)||void 0===s?void 0:s.templateId,creativeId:null===(a=this.creativeParams)||void 0===a||null===(o=a.additional_data)||void 0===o?void 0:o.crid,formatId:null===(l=this.formatManager)||void 0===l?void 0:l.formatId,frameType:null===(c=this.pageInfo)||void 0===c?void 0:c.getFrameType()}})}}catch(t){this.logError(t),this._fallbackResize(e.templateResizeConstraints)}}_applyMinimumDimensionsExperiment(e){var i;((null===(i=this.creativeParams)||void 0===i?void 0:i.ib_experiment_bitmask)||0)&t.aD.ENFORCE_MIN_IFRAME_DIMENSIONS&&(e.style.minWidth="300px",e.style.minHeight="300px")}_fallbackResize(e){var t;const i=this._getFrameElement(),r=i.getBoundingClientRect();let n=1;const s=null===(t=i.contentDocument)||void 0===t?void 0:t.querySelector(".tlod");e.width>r.width&&(n=Math.min(n,r.width/e.width),s.style.transformOrigin="left"),e.height>r.height&&(n=Math.min(n,r.height/e.height),s.style.transformOrigin="top"),s&&(s.style.display="inline-block",s.style.scale=n)}_isAutoresizable(){return this.formatManager.isAmazon()||this.formatManager.isShoppableMediaAutoResizeTemplate()}_calculateAutoresizableHeight(e){let t=e.scrollHeight;const i=this.pageInfo.placement;return i.placementResizeConstraints.height&&(t=Math.min(t,i.placementResizeConstraints.height)),t}_setWidth(e,t){t<200||(e.style.width=t+"px",e.style.setProperty("width",t+"px","important"))}_setHeight(e,t){t<90||(e.removeAttribute("height"),e.style.height=t+"px",e.style.setProperty("height",t+"px","important"))}_resizeAutoresizableFrame(e,t,i,r){const n=this.pageInfo.docInfo.window.innerHeight/100,s=r.querySelector("style");null!=s&&s.sheet&&n>0&&Array.from(s.sheet.cssRules).forEach(e=>{":host, :root"===e.selectorText&&e.style.setProperty("--parent-vh",n+"px")}),r&&(this._setWidth(e,t),setTimeout(()=>{const t=this._calculateAutoresizableHeight(r)+2;t>90?this._setHeight(e,t):this._setHeight(e,i)},100))}}const Dr="safeFrameResize";class xr extends Rr{constructor(e){super(e),(0,g.A)(this,"errAndFallBackOrDefault",e=>{const t=e.toString();if(this.errorHandler.fireError({category:"New IB Render Method Fallback",error:t,level:this.errorHandler.ERROR,block:Dr}),!this.performPillarboxing())throw this.errorHandler.fireError({category:"New IB Render Method Fallback",error:t,level:this.errorHandler.ERROR,block:Dr}),new f.A("SafeFrame resize and fallback error")}),this.safeFrameApi=this.pageInfo.getSafeFrameApi()}canResize(){return this.pageInfo.isSafeFrame()}expand(e,t){const i={t:e.top,l:e.left,r:e.right,b:e.bottom,push:t};this.safeFrameApi.ext.expand(i),this.eventController.publish(s.A2)}registerListener(e){this.safeFrameApi.ext.register(e.self.w,e.self.h,e=>{})}resize(e){this.viewabilityController.listenForFullAdViewability(()=>{this.handleResize(e)})}handleResize(e){try{const t=this.safeFrameApi&&this.safeFrameApi.ext;if(!t)throw new Error("SafeFrame API not available");const i=t.geom(),r=(null==i?void 0:i.exp)||{},n={top:r.t,left:r.l,right:r.r,bottom:r.b},a={width:e.width-i.self.w,height:e.height-i.self.h},o=this.getExpandDimensions(n,a);o?(this.registerListener(i),this.expand(o,this.supportsPush(t))):this.eventController.publish(s.iD)}catch(e){this.errAndFallBackOrDefault(e)}}supportsPush(e){const t=e&&e.supports();return t&&t["exp-push"]}performPillarboxing(){return!0}}const Nr=function(e){var t,i,r;const{pageInfo:n,placement:s}=e;let a;n.isMraid()||n.isWebview()||n.isAmp()||(n.isSafeFrame()&&null!==(t=e.creativeParams)&&void 0!==t&&t.useNewRenderMethodSafeFrame&&!s.customOptions.safeFrameResizingOptOut?a=new xr(e):(n.isFriendlyFrame()||n.isFriendlyFrameRender())&&(null!==(i=e.creativeParams)&&void 0!==i&&i.useNewRenderMethodFriendlyFrame||null!==(r=e.urlParams)&&void 0!==r&&r.hasForcedDimensions())&&(a=new Pr(e)));return a};const Lr="revealTrigger",Or="logo",kr="adchoices",jr="muteButton",Fr="blacklisted",Vr=[t.NE,t.NW,t.SE,t.SW],Hr=Vr;class Br{constructor({creative:e,placement:i,browserInfo:r,errorHandler:n,hasCtaMacro:s}){this.creative=e,this.placement=i,this.browserInfo=r,this.toConfig=this.toConfig.bind(this),this.errorHandler=n,this.hasCtaMacro=s,this.insertedLogoCorner="",this.domRefs=null,this.state=null,this.corners={[t.NW]:null,[t.NE]:null,[t.SE]:null,[t.SW]:null},this.blackListCorners(),this.elements=[{name:jr,isNeeded:()=>!!this.domRefs[jr],getCorner:()=>this.getMuteCorner(),getElement:()=>this.domRefs[jr].el,getOffsets:()=>this.getMuteOffsets()},{name:Lr,isNeeded:()=>!!this.domRefs[Lr],getCorner:()=>this._getElementCorner(Lr)||this.getRevealCorner(),getElement:()=>this.domRefs[Lr],getOffsets:()=>this.getDefaultOffsets(),getCallback:(e,t)=>this.getRevealCallback(e,t)},{name:Or,isNeeded:()=>this.needsLogo(),getCorner:()=>this._getElementCorner(Or)||this.getLogoCorner(),getElement:()=>this.domRefs[Or]||this.domRefs.videoLogo,getOffsets:()=>this.getLogoOffsets()},{name:kr,isNeeded:()=>this.needsAdChoices(),getElement:()=>this.domRefs[kr],getCorner:()=>this.getAdChoicesCorner(),getOffsets:()=>this.getDefaultOffsets(),getCallback:(e,t)=>this.getAdChoicesCallback(e,t)}],this.setLogoCornerForImageServer(),this.creative.insertedLogoCorner=this.insertedLogoCorner,this.creative.setImageUrlAndSrcSet()}create(){return this.elements.filter(e=>e.isNeeded()).slice(0,4).map(this.toConfig)}toConfig(e){const t={};t.element=e.getElement(),t.corner=e.getCorner();const{xOffsetPx:i,yOffsetPx:r}=e.getOffsets();return t.xOffsetPx=i,t.yOffsetPx=r,"function"==typeof e.getCallback&&(t.callback=e.getCallback(t.element,t.corner)),this.corners[t.corner]=e.name,t}_getElementCorner(e){var t;return null===(t=Object.entries(this.corners).filter(([,t])=>t===e)[0])||void 0===t?void 0:t.shift()}getAlignment(){return this.creative.isVast()||this.creative.formatManager.isCinemagraph()?Br.CREATIVE_CONTENT:Br.MAIN_IMAGE_SLOT}getRevealCorner(){const e=this.getPreferredRevealCorner();return this.getPreferredOrEmptyCorner(this.getEmptyCorners(),e,!0)}getAdChoicesCorner(){return this.getPreferredOrEmptyCorner(this.getEmptyCorners(),Hr,!0)}getLogoCorner(){const e=this.getLogoPreferredCorner()||t.NW;return this.getPreferredOrEmptyCorner(this.getEmptyCorners(),[e],!1)}getLogoPreferredCorner(){return this.getImgServerArgs().queryKey.lp}getImgServerArgs(){const e=this.creative.getParams();return(0,r.o_)("?"+e.img_server_params)}setLogoCornerForImageServer(){var e;let t="";const i=this.creative.getParams();if(!(!this.hasCtaMacro&&this.creative.isDemandSideCtaTextOptIn())&&(null===(e=i.imageServerParams)||void 0===e?void 0:e.logo)&&!this.creative.formatManager.isPharma()&&!this.creative.formatManager.isAutoplayVideo()&&!this.creative.formatManager.isCinemagraph()&&!this.creative.formatManager.isWindow()){var r,n;null!==(r=i.customization)&&void 0!==r&&r.reveal&&(this.corners[this.getRevealCorner()]=Lr);t=this.getPreferredOrEmptyCorner(this.getEmptyCorners(),[null===(n=i.imageServerParams)||void 0===n?void 0:n.lp],!1),Vr.includes(t)&&(this.insertedLogoCorner=t,this.corners[t]=Or)}}getMuteCorner(){return this.creative.formatManager.isHighImpactVideo()?this.getPreferredOrEmptyCorner(this.getEmptyCorners(),[t.SE],!0):this.getPreferredOrEmptyCorner(this.getEmptyCorners(),[t.SW],!0)}needsAdChoices(){return!(this.creative.alignAdChoicesToPlacement()||this.state.isAdChoiceFromTemplate||this.creative.isAdChoicesOptOut())}needsLogo(){if(this.areAllCornersLogoBlacklisted()||this._getElementCorner(Or))return!1;if(this.creative.isVast()){const e=this.browserInfo.isMobile,i=this.creative.params.logo_image_url,r=this.placement.logoBlackList||"",n=t.NW,s=-1===r.indexOf(n);return i&&s&&!e&&!!this.domRefs.videoLogo}return!!this.domRefs[Or]}getEmptyCorners(){return Object.keys(this.corners).filter(e=>null===this.corners[e])}getBlackListedCorners(){return Object.keys(this.corners).filter(e=>this.corners[e]===Fr)}blackListCorners(){const{logoBlackList:e}=this.placement;if(e){(0,r.js)(e).split(",").forEach(e=>{this.corners[e]=Fr})}}areAllCornersLogoBlacklisted(){return Object.values(this.corners).every(e=>e===Fr)}getPreferredOrEmptyCorner(e,t,i){let n=t.find(t=>e.indexOf((0,r.js)(t))>-1);return!n&&i&&(n=t.find(e=>this.getBlackListedCorners().indexOf((0,r.js)(e))>-1)),n||this.getEmptyCorners()[0]}getPreferredRevealCorner(){var e;let i=[t.SW,t.SE,t.NW,t.NE];const n=null===(e=this.creative.getParams().customization.reveal.trigger)||void 0===e?void 0:e.corner;return n&&(i=i.filter(e=>e!==(0,r.js)(n)),i.unshift((0,r.js)(n))),i}getRevealCallback(e,i){const r={[t.NW]:{PEELBACK_URL:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDUiIGhlaWdodD0iNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgdHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgLTEgMCA0NSkiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTAgMGw0NSA0NUgweiIvPjxyZWN0IGZpbGw9IiMwMDAiIHg9IjEwIiB5PSIxNCIgd2lkdGg9IjIxIiBoZWlnaHQ9IjIyIiByeD0iMiIvPjxwYXRoIGQ9Ik0yNy40NzkgMTcuMjI1YS44MTYuODE2IDAgMCAwLS41OC0uMjM2SDE3LjYxYS44MTYuODE2IDAgMCAwLS41OC4yMzYuODI3LjgyNyAwIDAgMCAwIDEuMTZsMi4zMjIgMi4zMjMtMi4wMzIgMi4wMzFjLTIuOTc1IDIuOTc2LTYuMTUgNy4yMDItNC4yODEgMTEuNTkzLjU4IDEuMzQyIDEuNTI0IDIuNDg1IDIuNTQgMy41IDEuMjcgMS4yNyAzLjU2NCAyLjI5NiA1LjI0MiAyLjk0LjMwOS4xMDkuNjk5LjI5OSAxLjAyNS4zNTMuMTU0LjAyOC4yODEuMDI4LjQwOC0uMS4xODItLjE4LjE0Ni0uNDM1LS4wMjctLjYwNy0uMTQ1LS4xNDUtLjM0NS0uMjcyLS40OTktLjQwOC0uMzk5LS4zNDUtLjc4OS0uNjk5LTEuMTYtMS4wNy00LjMyNy00LjMyNy0yLjUxMy03LjY0NyAxLjM5Ni0xMS41NTZsMi4wMzItMi4wMzIgMi4zMjIgMi4zMjJhLjgyNy44MjcgMCAwIDAgMS4xNjEgMCAuODE2LjgxNiAwIDAgMCAuMjM2LS41OHYtOS4yODlhLjgxNi44MTYgMCAwIDAtLjIzNi0uNTh6IiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPg=="},[t.NE]:{PEELBACK_URL:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDUiIGhlaWdodD0iNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgdHJhbnNmb3JtPSJyb3RhdGUoMTgwIDIyLjUgMjIuNSkiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTAgMGw0NSA0NUgweiIvPjxyZWN0IGZpbGw9IiMwMDAiIHg9IjEwIiB5PSIxNCIgd2lkdGg9IjIxIiBoZWlnaHQ9IjIyIiByeD0iMiIvPjxwYXRoIGQ9Ik0yNy40NzkgMTcuMjI1YS44MTYuODE2IDAgMCAwLS41OC0uMjM2SDE3LjYxYS44MTYuODE2IDAgMCAwLS41OC4yMzYuODI3LjgyNyAwIDAgMCAwIDEuMTZsMi4zMjIgMi4zMjMtMi4wMzIgMi4wMzFjLTIuOTc1IDIuOTc2LTYuMTUgNy4yMDItNC4yODEgMTEuNTkzLjU4IDEuMzQyIDEuNTI0IDIuNDg1IDIuNTQgMy41IDEuMjcgMS4yNyAzLjU2NCAyLjI5NiA1LjI0MiAyLjk0LjMwOS4xMDkuNjk5LjI5OSAxLjAyNS4zNTMuMTU0LjAyOC4yODEuMDI4LjQwOC0uMS4xODItLjE4LjE0Ni0uNDM1LS4wMjctLjYwNy0uMTQ1LS4xNDUtLjM0NS0uMjcyLS40OTktLjQwOC0uMzk5LS4zNDUtLjc4OS0uNjk5LTEuMTYtMS4wNy00LjMyNy00LjMyNy0yLjUxMy03LjY0NyAxLjM5Ni0xMS41NTZsMi4wMzItMi4wMzIgMi4zMjIgMi4zMjJhLjgyNy44MjcgMCAwIDAgMS4xNjEgMCAuODE2LjgxNiAwIDAgMCAuMjM2LS41OHYtOS4yODlhLjgxNi44MTYgMCAwIDAtLjIzNi0uNTh6IiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPg=="},[t.SE]:{PEELBACK_URL:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDUiIGhlaWdodD0iNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgdHJhbnNmb3JtPSJtYXRyaXgoLTEgMCAwIDEgNDUgMCkiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZmlsbD0iIzAwMCIgZD0iTTAgMGw0NSA0NUgweiIvPjxyZWN0IGZpbGw9IiMwMDAiIHg9IjEwIiB5PSIxNCIgd2lkdGg9IjIxIiBoZWlnaHQ9IjIyIiByeD0iMiIvPjxwYXRoIGQ9Ik0yNy40NzkgMTcuMjI1YS44MTYuODE2IDAgMCAwLS41OC0uMjM2SDE3LjYxYS44MTYuODE2IDAgMCAwLS41OC4yMzYuODI3LjgyNyAwIDAgMCAwIDEuMTZsMi4zMjIgMi4zMjMtMi4wMzIgMi4wMzFjLTIuOTc1IDIuOTc2LTYuMTUgNy4yMDItNC4yODEgMTEuNTkzLjU4IDEuMzQyIDEuNTI0IDIuNDg1IDIuNTQgMy41IDEuMjcgMS4yNyAzLjU2NCAyLjI5NiA1LjI0MiAyLjk0LjMwOS4xMDkuNjk5LjI5OSAxLjAyNS4zNTMuMTU0LjAyOC4yODEuMDI4LjQwOC0uMS4xODItLjE4LjE0Ni0uNDM1LS4wMjctLjYwNy0uMTQ1LS4xNDUtLjM0NS0uMjcyLS40OTktLjQwOC0uMzk5LS4zNDUtLjc4OS0uNjk5LTEuMTYtMS4wNy00LjMyNy00LjMyNy0yLjUxMy03LjY0NyAxLjM5Ni0xMS41NTZsMi4wMzItMi4wMzIgMi4zMjIgMi4zMjJhLjgyNy44MjcgMCAwIDAgMS4xNjEgMCAuODE2LjgxNiAwIDAgMCAuMjM2LS41OHYtOS4yODlhLjgxNi44MTYgMCAwIDAtLjIzNi0uNTh6IiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPg=="},[t.SW]:{PEELBACK_URL:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDUiIGhlaWdodD0iNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMCAwbDQ1IDQ1SDB6Ii8+PHJlY3QgZmlsbD0iIzAwMCIgeD0iMTAiIHk9IjE0IiB3aWR0aD0iMjEiIGhlaWdodD0iMjIiIHJ4PSIyIi8+PHBhdGggZD0iTTI3LjQ3OSAxNy4yMjVhLjgxNi44MTYgMCAwIDAtLjU4LS4yMzZIMTcuNjFhLjgxNi44MTYgMCAwIDAtLjU4LjIzNi44MjcuODI3IDAgMCAwIDAgMS4xNmwyLjMyMiAyLjMyMy0yLjAzMiAyLjAzMWMtMi45NzUgMi45NzYtNi4xNSA3LjIwMi00LjI4MSAxMS41OTMuNTggMS4zNDIgMS41MjQgMi40ODUgMi41NCAzLjUgMS4yNyAxLjI3IDMuNTY0IDIuMjk2IDUuMjQyIDIuOTQuMzA5LjEwOS42OTkuMjk5IDEuMDI1LjM1My4xNTQuMDI4LjI4MS4wMjguNDA4LS4xLjE4Mi0uMTguMTQ2LS40MzUtLjAyNy0uNjA3LS4xNDUtLjE0NS0uMzQ1LS4yNzItLjQ5OS0uNDA4LS4zOTktLjM0NS0uNzg5LS42OTktMS4xNi0xLjA3LTQuMzI3LTQuMzI3LTIuNTEzLTcuNjQ3IDEuMzk2LTExLjU1NmwyLjAzMi0yLjAzMiAyLjMyMiAyLjMyMmEuODI3LjgyNyAwIDAgMCAxLjE2MSAwIC44MTYuODE2IDAgMCAwIC4yMzYtLjU4di05LjI4OWEuODE2LjgxNiAwIDAgMC0uMjM2LS41OHoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+"}},{trigger:n}=this.creative.getParams().customization.reveal;return"peelback"===n.type?()=>e.setAttribute("src",r[i].PEELBACK_URL):"info_icon"===n.type?()=>e.setAttribute("src","data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzUiIGhlaWdodD0iMzUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBmaWxsLW9wYWNpdHk9Ii44MTUiIGZpbGw9IiMwMDAiIGQ9Ik0wIDBoMzV2MzVIMHoiLz48cGF0aCBkPSJNMjEuNjY3IDI1LjMxM3YtMi42MDVhLjUwNy41MDcgMCAwIDAtLjE0Ny0uMzc0LjUwNy41MDcgMCAwIDAtLjM3NC0uMTQ2aC0xLjU2M3YtOC4zMzRhLjUwNy41MDcgMCAwIDAtLjE0Ni0uMzc0LjUwNy41MDcgMCAwIDAtLjM3NS0uMTQ3aC01LjIwOGEuNTA3LjUwNyAwIDAgMC0uMzc0LjE0Ny41MDcuNTA3IDAgMCAwLS4xNDcuMzc0djIuNjA0YzAgLjE1Mi4wNS4yNzcuMTQ3LjM3NWEuNTA3LjUwNyAwIDAgMCAuMzc0LjE0NmgxLjU2M3Y1LjIwOWgtMS41NjNhLjUwNy41MDcgMCAwIDAtLjM3NC4xNDYuNTA3LjUwNyAwIDAgMC0uMTQ3LjM3NHYyLjYwNWMwIC4xNTEuMDUuMjc2LjE0Ny4zNzRhLjUwNy41MDcgMCAwIDAgLjM3NC4xNDZoNy4yOTJhLjUwNy41MDcgMCAwIDAgLjM3NC0uMTQ2LjUwNy41MDcgMCAwIDAgLjE0Ny0uMzc1em0tMi4wODQtMTMuNjE3VjguNzJhLjYyNi42MjYgMCAwIDAtLjE0Ni0uNDI4LjQ3NS40NzUgMCAwIDAtLjM3NS0uMTY3aC0zLjEyNWEuNDc1LjQ3NSAwIDAgMC0uMzc0LjE2Ny42MjYuNjI2IDAgMCAwLS4xNDYuNDI4djIuOTc2YzAgLjE3NC4wNDguMzE3LjE0Ni40MjhhLjQ3NS40NzUgMCAwIDAgLjM3NC4xNjhoMy4xMjZhLjQ3NS40NzUgMCAwIDAgLjM3NC0uMTY4LjYyNi42MjYgMCAwIDAgLjE0Ni0uNDI4ek0zMCAxNy41YzAgMi4yNjgtLjU1OSA0LjM2LTEuNjc2IDYuMjc0YTEyLjQ0NCAxMi40NDQgMCAwIDEtNC41NSA0LjU1QzIxLjg2IDI5LjQ0IDE5Ljc2OCAzMCAxNy41IDMwcy00LjM2LS41NTktNi4yNzQtMS42NzZhMTIuNDQ0IDEyLjQ0NCAwIDAgMS00LjU1LTQuNTVDNS41NiAyMS44NiA1IDE5Ljc2OCA1IDE3LjVzLjU1OS00LjM2IDEuNjc2LTYuMjc0YTEyLjQ0NCAxMi40NDQgMCAwIDEgNC41NS00LjU1QzEzLjE0IDUuNTYgMTUuMjMyIDUgMTcuNSA1czQuMzYuNTU5IDYuMjc0IDEuNjc2YTEyLjQ0NCAxMi40NDQgMCAwIDEgNC41NSA0LjU1QzI5LjQ0IDEzLjE0IDMwIDE1LjIzMiAzMCAxNy41eiIgZmlsbD0iI0ZGRiIvPjwvZz48L3N2Zz4="):null}getAdChoicesCallback(e,i){const r={[t.NW]:"border-bottom-right-radius",[t.NE]:"border-bottom-left-radius",[t.SE]:"border-top-left-radius",[t.SW]:"border-top-right-radius"};return()=>rt.A.setStyle(e,r[i],"8px")}getLogoOffsets(){let e,t;const i=this.getImgServerArgs().queryKey,r=parseInt(i.logo_y_pct,10),n=parseInt(i.logo_x_pct,10);isNaN(n)&&isNaN(r)?(e=parseInt(i.lox,10),t=parseInt(i.loy,10)):({xOffsetPx:e,yOffsetPx:t}=this.getLogoOffsetsFromPercentage(n,r));const s=isNaN(e)&&isNaN(t);this.creative.formatManager.isCinemagraph()&&s&&(e=10,t=10);const{finalOffsetX:a,finalOffsetY:o}=this.getFinalLogoOffsets();return{xOffsetPx:(e||0)+a+"px",yOffsetPx:(t||0)+o+"px"}}pct2Px(e,t){return Math.floor(.01*e*t)}getLogoOffsetsFromPercentage(e,t){let i,r;this.state.visibleImageWidth||this.state.visibleImageHeight?(i=this.state.visibleImageWidth,r=this.state.visibleImageHeight):(i=this.placement.imageWidth,r=this.placement.imageHeight);return{xOffsetPx:this.pct2Px(e,i),yOffsetPx:this.pct2Px(t,r)}}getFinalLogoOffsets(){return this.state.imageBoxingOffsetX||this.state.imageBoxingOffsetY?{finalOffsetX:this.state.imageBoxingOffsetX,finalOffsetY:this.state.imageBoxingOffsetY}:this.state.logoOffsetX||this.state.logoOffsetY?{finalOffsetX:this.state.logoOffsetX,finalOffsetY:this.state.logoOffsetY}:{finalOffsetX:0,finalOffsetY:0}}getMuteOffsets(){return{xOffsetPx:"5px",yOffsetPx:"5px"}}getDefaultOffsets(){return{xOffsetPx:"0px",yOffsetPx:"0px"}}}(0,g.A)(Br,"CREATIVE_CONTENT","creativeContent"),(0,g.A)(Br,"MAIN_IMAGE_SLOT","mainImageSlot");class Wr extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"});const e=document.createElement("style");e.textContent="\n        :host { \n          all: initial \n        }\n        .tlod {\n          /*need to do this for... historical reasons...*/\n          display: inline;\n        }\n      ",this.shadowRoot.appendChild(e);const t=document.createElement("div");t.className="tlod",this.shadowRoot.appendChild(t)}set adContent(e){const t=this.shadowRoot.querySelector(".tlod");t.innerHTML=e;(new DOMParser).parseFromString(e,"text/html").querySelectorAll("script").forEach(e=>{const i=document.createElement("script");[...e.attributes].forEach(e=>{i.setAttribute(e.name,e.value)}),e.textContent&&(i.textContent=e.textContent),t.appendChild(i)})}getElementsByClassName(e){return this.shadowRoot.querySelectorAll("."+e)}getElementsByTagName(e){return this.shadowRoot.querySelectorAll(e)}querySelector(e){return this.shadowRoot.querySelector(e)}querySelectorAll(e){return this.shadowRoot.querySelectorAll(e)}querySelectorHost(e){return HTMLElement.prototype.querySelector.call(this,e)}}class Ur{constructor(e){this.docInfo=e,this.mraidEnv=null}checkAndLoadMraid(){return this.mraidEnv=this.findMraidEnv(),this.mraidEnv&&this.isMraid3()&&this.injectMraidScript(),!!this.mraidEnv}findMraidEnv(){const e=this.getAccessibleWindows();for(let t=0;t<e.length;t++)try{const i=e[t];if(i.MRAID_ENV&&this.isValidMraidEnv(i.MRAID_ENV))return i.MRAID_ENV}catch(e){break}return null}getAccessibleWindows(){const e=[];let t=this.docInfo.window||window;for(let i=0;i<3&&t;i++){e.push(t);try{if(t===t.parent)break;t=t.parent}catch(e){break}}return e}isValidMraidEnv(e){return!(!e||"string"!=typeof e.version||"string"!=typeof e.sdk||"string"!=typeof e.sdkVersion)}isMraid3(){return this.mraidEnv&&parseFloat(this.mraidEnv.version)>=3}injectMraidScript(){const e=this.docInfo.document||document,t=e.createElement("script");t.src="mraid.js";const i=e.head||e.body||e.getElementsByTagName("body")[0];i&&i.appendChild(t)}getSdkInfo(){return this.mraidEnv?{sdk:this.mraidEnv.sdk,sdkVersion:this.mraidEnv.sdkVersion,version:this.mraidEnv.version}:null}}const zr={run:async(...e)=>{try{await async function(e){window.performance&&performance.now||(window.performance=window.performance||{},window.performance.now=Date.now);const i=performance.now(),{cacheHit:a,revision:o="un",scriptWindow:l}=e;let{currentScript:d}=e;const h=o.slice(0,7);let g,_,w,E,C,b,T,S,M,R,P,D,x,N,L,O,k,j,F,V,B,W,U,z,G,q,Y,Z,Q,X,J,K,$,ee,te,ie,re,ne,ae,oe,le,ce=!1,de=!1;const he=()=>{g=new Ke,_=new I({eventController:g}),w=new Qe({scriptWindow:l}),E=new yr({topWindow:w.topWindow}),C=E.debugFlag,b=new Xe(e.environment),T=Oe(e.placement,{urlParams:E}),S=new wt(e.settings),L=new _i(e.environment.formats,g),M=new $e({docInfo:w,rev:h,placement:T,debugFlag:C,ebPath:b.ebPath,auctionId:oe,shouldLogThirdPartyPixel:S.shouldLogThirdPartyPixel,dependenciesResolver:()=>({creative:ee})},{eventController:g,formatManager:L,lifecycleManager:_}),R=new Ze.A({environment:b,bundleStartTime:i},{eventController:g,urlParams:E});const r=S.getPerformanceLoggingStrategy(E),n=["COORDINATED","BENCHMARK_ONLY"].includes(r),s=["COORDINATED","PERFORMANCE_ONLY"].includes(r);D=s?new Ht({settings:S,ttjStartTime:e.ttjStartTime,revision:h,isTestEnv:!!C},{eventController:g,firePix:M,errorHandler:null,formatManager:L}):{trackRenderEvent:()=>{},trackDOMPerformance:(e,t)=>t(),setFormatId:()=>{},setIsHeaderBidding:()=>{},destroy:()=>{},registerTemplateResource:()=>{},captureBenchmarkMilestone:()=>{},trackMilestone:()=>{},errorHandler:null},P=n?new Vt.A({settings:S,ttjStartTime:e.ttjStartTime,revision:h,isTestEnv:!!C,shouldLog:!0},{eventController:g,firePix:M,performanceMonitor:D}):{log:()=>{},logSize:()=>{},setFormatId:()=>{},setIsHeaderBidding:()=>{}},j=new Je.A({firePix:M,urlParams:E,lifecycleManager:_,dependenciesResolver:()=>({placement:T,formatManager:L,creative:ee})}),void 0!==D.errorHandler&&(D.errorHandler=j),F=j.decorate.bind(j),k=new st({placement:T,environment:b,docInfo:w,settings:S,currentScript:d},{errorHandler:j}),x=new Bt(P),N=new wr(g),customElements.get(t.gi)||customElements.define(t.gi,Wr);new Ur(w).checkAndLoadMraid()},ue=()=>{if(_.setPhaseAfterInit(),W=e.auctionResponse||k.getHeaderBiddingAuctionResponse(),W&&(P.setIsHeaderBidding(!0),g.publish(s.e8,W),Le()),!W&&k.getAuctionResponsePseudoId()){const e=k.getSupplySourceId();j.fireError({category:"Native Ad Initialization",error:"Header bidding response not found for supply source: "+e,level:Je.A.ERROR})}a||P.log(Vt.A.BUNDLE_LOAD_TIME,i),V=new vi({docInfo:w,placement:T}),B=new jt(F,w.topWindow),B.addDocumentFontListener(),at.needsBusting(T,w.window)&&at.bust(w.document,k.getScriptSrc())},pe=()=>{const e=k.getDtjTacticId(),t=ni.getCmpApiWindow(w.topWindow,j);t&&(U=new ni({win:t,isProxyNeeded:t!==w.topWindow,errorHandler:j,firePix:M})),z=new It({hookFinder:k,docInfo:w,defaultCode:T.defaultCode,pageInfo:V,isFallback:ce,urlParams:E},{firePix:M,asyncUtil:B,errorHandler:j}),e||(T.demandEnabled||C||W?(0,r.bf)()||(G=new kt({placement:T,environment:b,topWindow:w.topWindow,debugFlag:E.debugFlag,gdpr:U}),z.setUserSync(G)):z.serve("demand_disabled"))},me=()=>{const{navigator:e}=w;if(!e)throw new f.A("setBrowserInfo failed: no navigator");q=new p(e.userAgent),Y=q.getBrowserInfo()},ge=()=>{Z=ki({win:w.topWindow,pageInfo:V,placement:T,environment:b,browserInfo:Y,errorHandler:j,firePix:M,analytics:ie,asyncUtil:B,settings:S,creativePayload:W},g),Q=new Ft({placement:T,docInfo:w},{positionService:Z,eventController:g,errorHandler:j,asyncUtil:B})},ve=()=>{try{if(!ee.useResizeService()&&!E.hasForcedDimensions())return;de=!0,O=Nr({pageInfo:V,errorHandler:j,settings:S,eventController:g,viewabilityController:Q,creativeParams:ee.getParams(),templateCode:$,browserInfo:Y,formatManager:L,placement:T,urlParams:E});let e={templateDims:T.templateResizeConstraints,placementDims:T.placementResizeConstraints,deviceWidth:Y.isMobile?screen.width:void 0};E.hasForcedDimensions()&&(e=E.getForcedDimensions()),ee.hasResizedIframe=O.startResize(e)}catch(n){var e,t,i,r;ee.hasResizedIframe=!1,j.fireError({category:"New IB Render Method",error:"triggerResize error: "+n.toString(),level:j.ERROR,block:A,diagnosticContext:{placementId:null===(e=V)||void 0===e||null===(t=e.placement)||void 0===t?void 0:t.id,templateId:null===(i=V)||void 0===i||null===(r=i.placement)||void 0===r?void 0:r.templateId}})}},_e=async()=>{x.startLap(),X=await(new m).create(w),J=new et({auctionFrameWindow:X.contentWindow,errorDecorator:F}),J.setListeners();if(new it({placement:T,auctionIframe:X},{eventController:g,serveDefault:z,firePix:M,errorDecorator:F,errorHandler:j}).registerAuctionListeners(),!W||ce){const e={auctionIframe:X,browserInfo:Y,docInfo:w,environment:b,gdpr:U,placement:T,rev:h,isFallback:ce};ce&&(e.fallbackBannerSize=Fe());const t=new u(e,{errorDecorator:F,errorHandler:j,eventController:g,firePix:M,pageInfo:V,serveDefault:z,hookFinder:k,urlParams:E,asyncUtil:B});x.log(Vt.A.AUCTION_START),W=await t.getCreative(),x.log(Vt.A.AUCTION_RESPONSE),Le()}},ye=async()=>{te=new pt;const e=W.settings.adpreview_hash;e&&await te.fetchAdpreviewInfo(e),te.forcedBidResponse&&(W=te.forcedBidResponse,L.setCreativePayload(W),Le())},Ae=async()=>{const{settings:{dco_tag_url:e,dco_protocol:i}}=W;if(e&&i===t.pj.DV_BLOCKING){const e=new $t(W,{errorHandler:j});return void await e.callDV()}if(e){K=new Ye({assets:W.assets,settings:W.settings,frame:X,env:b,formatManager:L,urlParams:E},{errorHandler:j});try{const e=await K.getOptimizedAsset();W.assets=e.assets,W.settings.isFallbackAssets=K.isFallback,W.settings.retailerId=K.retailerId,W.settings.skus=K.skus,e.assets.length>0&&e.assets[0].privacy_url&&(W.settings.adchoices_url=e.assets[0].privacy_url)}catch(e){j.fireError({category:"DCO Fetching",error:"Failed to serve DCO",level:j.ERROR,block:y}),z.serve("dco_error")}}L.isDocAds()&&(await(async e=>{var t,i;const n=e.ad.display.native.ext.docAds;let s,a;try{a=JSON.parse(n.docAdsString),s=await async function(e){return JSON.parse((await(0,r.RD)(e,"GET")).target.responseText).pages}(a.documentManifest.link)}catch(e){throw new f.A("Error fetching doc ads pages")}e.ad.display.native.ext.docAds=a;const o=parseInt(null===(t=a.gated_obj)||void 0===t?void 0:t.num_gated_preview_pages,10)||s.length,l=n.docAdsWidth,c=n.docAdsHeight,d=a.media_view_tracker,h=(null===(i=a.download_obj)||void 0===i?void 0:i.download_url)||e.ad.display.native.link.url,u=[],p=[];for(let t=0;t<o;t++){const i={tlMultiIndex:t},r={image:{url:s[t],w:l,h:c,type:se},ext:i},a={type:fe,method:1,url:d+"&cprg="+(t+1)+"&ml="+o,ext:i},m={link:{url:h},ext:i},g={data:{value:n.cta_text,type:H},ext:i},f=e.ad.display.native.asset.map(e=>({...e,ext:i})),v=e.ad.display.event.map(e=>({...e,ext:{...e.ext,...i}}));u.push(r,g,m,...f),p.push(a,...v)}e.ad.display.native.asset=u,e.ad.display.event=p,e.ad.display.native.ext.tlMultiCount=o})(W),Le())},Ie=()=>{z.adRendered=!0,$=new Et.A(j);const t=$.getAltTemplateId(W.settings.template_id,k.getTagTemplateId(),E.tlTemplateId),i=$.getAltTemplate(T.templates,t);if(i.templateCode)if(L.isHdx())Et.A.hasMacro(i.templateCode)||Object.assign(T,i);else{if(!Et.A.hasMacro(i.templateCode))throw new f.A("Format not HDX and template code is not valid.");Object.assign(T,i)}const r=te.forcedTemplateCode||e.templateCode||k.getForcedTemplateCode();r&&(T.templateCode=r),T.provenTemplate&&(T.customOptions.unwrappedUnit=!1,T.customOptions.friendlyIframeRender=!0),$.parse(T.templateCode)},we=()=>{const e=k.currentScript&&(0,r.o_)(k.currentScript.src).queryKey.ct;if(!$)throw new f.A("templateCode is not valid");if(ee=Qt.create({environment:b,placement:T,pageInfo:V,isSmallScreen:Y.isSmallScreen,clickTrackerDTJ:e,debug:C,creativePayload:W,templateDetail:$.templateDetail,tlImageId:E.tlImageId,errorHandler:j,formatManager:L,firePix:M,forceShadowRoot:E.forceShadowRoot,renderOptionsBMOverride:E.renderOptionsBM,adPreview:E.adPreview}),le=new Br({creative:ee,placement:T,browserInfo:Y,errorHandler:j,hasCtaMacro:$.hasCtaMacro}),ee.formatManager.isHdx()&&(T.customOptions.friendlyIframeRender=!0,T.replaceParent=0),ee.formatManager.isNativeLite()&&(T.customOptions.unwrappedUnit=!1,T.customOptions.friendlyIframeRender=!0,T.replaceParent=0),!Et.A.hasMacro(T.templateCode)&&!ee.formatManager.isHdx())throw new f.A("Format not HDX and template code is not valid.");!V.isViewabilityAware()&&ee.needsViewabilityAwareness()&&j.fireError({category:"Creative Initialization",error:"Position aware format served to unfriendly frame",level:j.WARNING})},Ee=()=>{ne=new ut({creativePayload:W,firePix:M}),re=new Ot({docInfo:w,pageInfo:V,placement:T,settings:S},{browserDetector:q,creative:ee,auctionIframeWriterOverride:J,firePix:M,errorHandler:j,eventController:g,formatManager:L,urlParams:E}),ie=new c({environment:b,pageInfo:V,placement:T,dco:K},{creative:ee,lifecycleManager:_,thirdPartyAnalytics:re,payableEventEmitter:ne,firePix:M,errorHandler:j,asyncUtil:B,eventController:g,stopwatch:x,gdpr:U})},Ce=async()=>{const e=performance.now();x.log(Vt.A.RENDER);try{ie.render()}catch(e){j.fireError({error:"analytics error: "+e.toString(),level:j.ERROR})}k.styleHook(ee.forceIframeRender());const t={placement:T,environment:b,settings:S,creative:ee,firePix:M,errorHandler:j,eventController:g,asyncUtil:B,browserDetector:q},i=await fr.load(t),n=i[0].default,a=i.slice(1).map(e=>e.default).map(e=>e.create()),o={creative:ee,placement:T,environment:b,browserInfo:Y,pageInfo:V,docInfo:w,analytics:ie,asyncUtil:B,templateCode:$,positionService:Z,firePix:M,errorHandler:j,eventController:g,viewabilityController:Q,featureConfigs:a,fallbackManager:N,cornerElementsConfig:le,formatManager:L,stopwatch:x,urlParams:E},l=n.create(o),d=await l.render();ae=d.domRefs,O&&(O.domRefs=ae),D.trackDOMPerformance("append_ad_wrapper",()=>{$.chosenTemplate.appendChild(ae.adWrapper)});const h=(0,r.pW)($);P.logSize(Vt.A.TEMPLATE_SIZE,h);const{childNodes:u}=$.templateWrapEl,p=ee.useResizeService(),m=ee.forceIframeRender(),f=T.customOptions.friendlyIframeRender;for(let e=0;e<u.length;e++){const t=u[e];if(1===t.nodeType){const e=k.getHook(m);D.trackDOMPerformance("insert_ad_node",()=>{p||m?_t.insertAdInIframe(t,e):_t.insertAd(t,e,f)})}}(0,r.Hl)(w.topWindow,"resize",document),ie.fireCTRInvestigationPixel(ae,Z,q,de),x.log(Vt.A.AD_ON_PAGE),D.trackRenderEvent("render_complete",e),P.log(Vt.A.IMAGE_LOAD_TIME,(0,r.bQ)(Vt.A.IMAGE_LOAD_TIME)),P.log(Vt.A.VIDEO_LOAD_TIME,(0,r.bQ)(Vt.A.VIDEO_LOAD_TIME)),ie.adOnPage(),ie.fireGpidInvestigationPixel(ae),g.publish(s.Ol,ae),g.publish(s.XR,ae),c.sendAdReadySignal()},be=()=>{const e=ae.mainImageCsrEl||ae.mainImage,{adWrapperWithDims:t}=ae;if(ie.appendThirdPartyJs(e),ie.disclosureRenderResult(),ie.auditTlUid(),G&&G.doSyncIfAllDone(),V.isViewabilityAware()){if(window.IntersectionObserver&&window.IntersectionObserverEntry&&"isIntersecting"in window.IntersectionObserverEntry.prototype&&!V.isMraid()){let e=null;const i=Ft.getRequiredPct(t),r={0:(e,t)=>{e[0].isIntersecting&&w.isInFocus()&&(ie.onePxViewable(),t.disconnect())},[i]:(t,i)=>{t[0].isIntersecting&&w.isInFocus()?e=setTimeout(()=>{ie.viewable(),i.disconnect()},1e3):e&&clearTimeout(e)}};Object.entries(r).forEach(([e,i])=>{const r={threshold:parseFloat(e)};new IntersectionObserver(i,r).observe(t)})}Q.listenForPercentageAdViewability(t,ie.viewable.bind(ie)),Q.listenForOnePxAdViewability(ie.onePxViewable.bind(ie))}const n=.05,s=ee.formatManager.isHighImpactVideo()?n:S.pmdLogRate;(0,r.XM)(s,()=>{var r,n,s,a,o;const l=null===(r=ee)||void 0===r||null===(n=r.creativePayload)||void 0===n||null===(s=n.ad)||void 0===s||null===(a=s.ext)||void 0===a||null===(o=a.tlAdditionalData)||void 0===o?void 0:o.asid,c=1e3;B.timeoutWrap(()=>{At({adWrapperWithDims:t,mainContent:e,positionService:Z,pageInfo:V,bundleStartTime:i,firePix:M,errorHandler:j,adSlotId:l})},c)})},Te=()=>{(new ot).layout(k.getHook())},Se=async()=>{const e=async()=>{const e=new(0,(await n.e(128).then(n.bind(n,811))).default)({placement:T,docInfo:w,domRefs:ae,errorHandler:j,pageInfo:V,firePix:M,browserDetector:q,newRenderMethodEnabled:de,creative:ee});Q.listenForPercentageAdViewability(ae.adWrapperWithDims,()=>{e.run()})};(0,r.XM)(S.placementCategorizationRate,()=>{e()})},Me=async()=>{const e=async()=>{const e=new(0,(await n.e(889).then(n.bind(n,387))).default)({docInfo:w,domRefs:ae,errorHandler:j,pageInfo:V,analytics:ie,creative:ee,newRenderMethodEnabled:de});Q.listenForPercentageAdViewability(ae.adWrapperWithDims,()=>{e.run()})},t={342:1,746:1},i=S.prvSampleRate,s=(ee.getParams().prv_sample_rate||0)/100,a=t[T.publisherId]||0,o=T.customOptions.friendlyIframeRender||ee.useResizeService()?1:Math.max(i,s,a);(0,r.XM)(o,()=>{_.setPhaseAfterPostRender(),e()})},Re=()=>{g.destroy(),D&&D.destroy(),d=k.currentScript,oe=M.auctionId,he(),ue()},Pe=async e=>{ce=!0,z.setIsFallback(ce),Re(),_.setPhaseAfterInit(),await _e(),await ye(),await Ae(),z.hasDefaulted||(Ie(),we(),Ee(),ge(),e.conditionsMet()?(ae.adWrapper.parentNode.removeChild(ae.adWrapper),await Ce(),be(),Te(),await Se(),await Me(),e.verifySuccess()):j.fireError({category:"Autoplay Fallback",error:"Fallback render avoided",level:j.WARNING}),e.destroy())},De=()=>{const e=new Ir(g);e.setCallback(()=>Pe(e)),N.addManager(e)},xe=()=>{T.customOptions.videoErrorFallbackOptOut||!ee.formatManager.isBrandedVideo()&&!ee.formatManager.isHighImpactVideo()||De()},Ne=async()=>{he(),ue(),pe(),me(),await _e(),await ye(),await Ae(),z.hasDefaulted||(Ie(),we(),Ee(),ge(),ve(),await Ce(),be(),Te(),await Se(),await Me(),xe())};try{await Ne()}catch(e){if(j)try{j.fireError({category:"Main Execution",error:e,level:j.ERROR})}catch(e){ke(e)}else ke(e)}function Le(){const e=new Mr(W,j,E.forceBidUrl,L.isBanner(),b),t=e.getAssets();t&&(W.assets=t);const i=e.getSettings();i&&(W.settings=i)}function Oe(e,t){const i={};t.urlParams.adPreview&&(i.friendlyIframeRender=!0);const r=new gt({...e,customOptions:{...e.customOptions,...i}});return t.urlParams.tlImageWidth&&t.urlParams.tlImageHeight&&(r.imageWidth=t.urlParams.tlImageWidth,r.imageHeight=t.urlParams.tlImageHeight),r}function ke(e){const t={e:"Critical: "+(e.message||e),lvl:1};t.inv_code=je(()=>T.invCode,null),t.aid=je(()=>M.auctionId,null),t.rev=je(()=>h,null),t.block=je(()=>_.getPhase(),v),console.error("tl: "+(e.stack||e),t);const i=je(()=>w.topDocument,document),n=je(()=>b.ebPath,"eb2.3lift.com");i.createElement("IMG").src=(0,r.j7)(n,"sce",t)}function je(e,t){try{return e()}catch(e){return t}}function Fe(){let e={width:0,height:0};return ee.params.banner_width&&ee.params.banner_height&&(e={width:ee.params.banner_width,height:ee.params.banner_height}),e}}(...e)}catch(e){const t=encodeURIComponent("Fatal: "+(e.message||e));document.createElement("IMG").src="//eb2.3lift.com/sce?lvl=1&block=init&e="+t}}};const Gr="5379d9fc99c59d23d390fd73342dd46fc74cc723",qr=window._tlImpressionBusLoader;n.p=qr.getPublicPath(Gr),qr.onload(zr,Gr)})()})();