window.adthrive.core = {"partners":[{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"33across","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.985},{"name":"pmp","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.6},{"name":"instream","type":"percent","value":0.995}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_amazon","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.7},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_appnexus","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.65},{"name":"pmp","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.6},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_blis","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.5},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_cadent","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.95},{"name":"stickyOutstream","type":"percent","value":0.4},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_gumgum","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.97},{"name":"stickyOutstream","type":"percent","value":0.45},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_ix","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.97},{"name":"stickyOutstream","type":"percent","value":0.4},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_medianet","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.92}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_ogury","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.45},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_openx","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.98},{"name":"stickyOutstream","type":"percent","value":0.6},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_pubmatic","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.6},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_rubicon","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.96}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_seedtag","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"stickyOutstream","type":"percent","value":0.55},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_sharethrough","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"stickyOutstream","type":"percent","value":0.35},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_triplelift","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.96},{"name":"stickyOutstream","type":"percent","value":0.55},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_unruly","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.3},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_verizon","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.75},{"name":"instream","type":"percent","value":0.95}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_verve","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.65},{"name":"instream","type":"percent","value":0.99}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_yieldmo","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.6},{"name":"stickyOutstream","type":"percent","value":0.59},{"name":"instream","type":"percent","value":0.9}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"adform","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.01},{"name":"instream","type":"percent","value":0.01}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"aidem_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":1},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"amx","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"outstream","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.8},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"appnexus","enabled":true},{"secondary":false,"cpm":[{"name":"stickyOutstream","type":"percent","value":0.8},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"connatix","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"conversant","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.97},{"name":"stickyOutstream","type":"percent","value":0.8},{"name":"instream","type":"percent","value":0.98}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"crit_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.7},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"criteo","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.01},{"name":"pmp","type":"percent","value":0.01}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"flipp","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.35},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"G-TRUSTX-b827d08da2714822","type":"percent","value":1}]},{"name":"stickyOutstream","type":"percent","value":0.45}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"grid","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.4},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"g-trustx-69dcdccd456a4d4a","type":"percent","value":1}]}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"gridvid","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.97},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"gumgum","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.01},{"name":"stickyOutstream","type":"percent","value":0.01},{"name":"instream","type":"percent","value":0.01}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"improve_ss","enabled":false},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.98},{"name":"outstream","type":"percent","value":0.98},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"9311192021991","type":"percent","value":0.97},{"name":"9311192021992","type":"percent","value":0.97},{"name":"20701262024997","type":"flat","value":1},{"name":"20701262024998","type":"flat","value":1},{"name":"502908152024991","type":"percent","value":0.95},{"name":"502908152024992","type":"percent","value":0.95},{"name":"502908152024993","type":"percent","value":0.95},{"name":"502908152024994","type":"percent","value":0.95},{"name":"PAN57412092024991","type":"flat","value":2.6},{"name":"PAN57412092024992","type":"flat","value":2.6},{"name":"PAN9912192024991","type":"flat","value":2.6},{"name":"PAN9912192024991","type":"percent","value":0.95},{"name":"PAN9912192024992","type":"flat","value":2.6},{"name":"PAN9912192024992","type":"percent","value":0.95},{"name":"BB9912192024991","type":"flat","value":3.6},{"name":"BB9912192024991","type":"percent","value":0.95},{"name":"BB9912192024992","type":"flat","value":3.6},{"name":"BB9912192024992","type":"percent","value":0.95},{"name":"6411202024991","type":"percent","value":0.95},{"name":"6411202024992","type":"percent","value":0.95},{"name":"1611202024993","type":"percent","value":0.95},{"name":"1611202024994","type":"percent","value":0.95},{"name":"391601082025992","type":"percent","value":0.95},{"name":"391601082025994","type":"percent","value":0.95},{"name":"323801102025991","type":"percent","value":0.95},{"name":"323801102025992","type":"percent","value":0.95},{"name":"260301102025991","type":"percent","value":0.95},{"name":"260301092025991","type":"percent","value":0.95},{"name":"260301092025992","type":"percent","value":0.95},{"name":"260301092025993","type":"percent","value":0.95},{"name":"260301092025994","type":"percent","value":0.95},{"name":"504501092025992","type":"percent","value":0.95},{"name":"504501092025991","type":"percent","value":0.95},{"name":"504501092025993","type":"percent","value":0.95},{"name":"504501092025994","type":"percent","value":0.95},{"name":"504501102025991","type":"percent","value":0.95},{"name":"795301152025991","type":"percent","value":0.95},{"name":"795301152025992","type":"percent","value":0.95},{"name":"260301212025991","type":"percent","value":0.95},{"name":"260301212025992","type":"percent","value":0.95},{"name":"260301212025993","type":"percent","value":0.95},{"name":"260301212025994","type":"percent","value":0.95},{"name":"260301212025995","type":"percent","value":0.95},{"name":"504501212025991","type":"percent","value":0.95},{"name":"504501212025992","type":"percent","value":0.95},{"name":"504501212025993","type":"percent","value":0.95},{"name":"504501212025994","type":"percent","value":0.95},{"name":"504501212025995","type":"percent","value":0.95},{"name":"795301232025991","type":"percent","value":0.95},{"name":"795301232025992","type":"percent","value":0.95},{"name":"303207242023993","type":"percent","value":1},{"name":"VDR548502192025991","type":"flat","value":3.6},{"name":"VDR548502192025991","type":"percent","value":0.95},{"name":"BB320803262025991","type":"flat","value":3.6},{"name":"BB320803262025992","type":"flat","value":3.6},{"name":"BB9904152025991","type":"flat","value":3.6},{"name":"BB9904152025992","type":"flat","value":3.6},{"name":"BB9904152025993","type":"flat","value":3.6},{"name":"BB9904152025994","type":"flat","value":3.6},{"name":"825204302025991","type":"percent","value":0.95},{"name":"9904092025995","type":"flat","value":0.05},{"name":"9904092025996","type":"flat","value":0.05},{"name":"9904092025991","type":"flat","value":0.05},{"name":"9904092025992","type":"flat","value":0.05},{"name":"9904092025993","type":"flat","value":0.05},{"name":"9904092025994","type":"flat","value":0.05},{"name":"9906032025991","type":"flat","value":0.05},{"name":"9906032025992","type":"flat","value":0.05},{"name":"PAN457406092025991","type":"flat","value":2.6},{"name":"PAN457406092025992","type":"flat","value":2.6}]},{"name":"stickyOutstream","type":"percent","value":0.7},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"ix","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.98},{"name":"outstream","type":"percent","value":0.98},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"323801102025991","type":"percent","value":0.95},{"name":"323801102025992","type":"percent","value":0.95},{"name":"504501092025992","type":"percent","value":0.95},{"name":"504501092025991","type":"percent","value":0.95},{"name":"504501092025993","type":"percent","value":0.95},{"name":"504501092025994","type":"percent","value":0.95},{"name":"504501102025991","type":"percent","value":0.95},{"name":"795301152025991","type":"percent","value":0.95},{"name":"795301152025992","type":"percent","value":0.95},{"name":"504501212025991","type":"percent","value":0.95},{"name":"504501212025992","type":"percent","value":0.95},{"name":"504501212025993","type":"percent","value":0.95},{"name":"504501212025994","type":"percent","value":0.95},{"name":"504501212025995","type":"percent","value":0.95},{"name":"795301232025991","type":"percent","value":0.95},{"name":"795301232025992","type":"percent","value":0.95},{"name":"BB913503072025991","type":"flat","value":3.6},{"name":"BB913503072025992","type":"flat","value":3.6},{"name":"PAN913503072025993","type":"flat","value":2.6},{"name":"PAN913503072025994","type":"flat","value":2.6}]},{"name":"stickyOutstream","type":"percent","value":0.7},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"ix_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"outstream","type":"percent","value":1},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"kargo","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"outstream","type":"percent","value":0.99},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"krgo_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.75}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"nativo","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"stickyOutstream","type":"percent","value":0.8},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"ntvo_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"ogury","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.95},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"OX-caf-ypSBrR","type":"flat","value":1}]},{"name":"stickyOutstream","type":"percent","value":0.5},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"openx","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.95},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"OX-caf-ypSBrR","type":"flat","value":1}]},{"name":"stickyOutstream","type":"percent","value":0.53},{"name":"instream","type":"percent","value":0.95}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"opnx_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"ozone","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"outstream","type":"percent","value":1},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"PM-QBFB-1491","type":"percent","value":0.85},{"name":"PM-SCOD-9158","type":"percent","value":0.85},{"name":"PM-ISBW-4350","type":"percent","value":0.85},{"name":"PM-KZOE-9119","type":"percent","value":0.85},{"name":"PM-ULDD-8757","type":"percent","value":0.85},{"name":"PM-GEIE-0271","type":"percent","value":0.85},{"name":"PM-WFRI-7773","type":"percent","value":0.85},{"name":"PM-CAJR-3848","type":"percent","value":0.85},{"name":"PM-UQAP-5062","type":"percent","value":0.85},{"name":"PM-UICF-0360","type":"percent","value":0.85},{"name":"PM-RTDT-2662","type":"percent","value":0.85},{"name":"PM-VSKI-9959","type":"percent","value":0.85},{"name":"PM-DDIS-7631","type":"percent","value":0.85},{"name":"PM-HIDA-3239","type":"percent","value":0.85},{"name":"PM-VVQG-2371","type":"percent","value":0.85},{"name":"PM-KZUM-4456","type":"percent","value":0.85},{"name":"PM-ODII-3311","type":"percent","value":0.85},{"name":"PM-WHVG-2369","type":"percent","value":0.85},{"name":"PM-GWWP-3609","type":"percent","value":0.85},{"name":"PM-OKDF-9459","type":"percent","value":0.85},{"name":"PM-LPUY-3631","type":"percent","value":0.85},{"name":"PM-SWTT-0936","type":"percent","value":0.85},{"name":"PM-SQYG-3496","type":"percent","value":0.85},{"name":"PM-FXFR-1947","type":"percent","value":0.85},{"name":"PM-UJXC-9054","type":"percent","value":0.85},{"name":"PM-TIYC-8006","type":"percent","value":0.85},{"name":"PM-TITY-8788","type":"percent","value":0.85},{"name":"PM-URCT-6163","type":"percent","value":0.85},{"name":"PM-DVAF-8245","type":"percent","value":0.85}]},{"name":"stickyOutstream","type":"percent","value":0.75},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"pubm_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"outstream","type":"percent","value":1},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"PM-WBUD-7484","type":"percent","value":0.95},{"name":"PM-RDZV-6197","type":"percent","value":0.95},{"name":"PM-PZJT-8450","type":"percent","value":0.95},{"name":"PM-KHSU-8994","type":"percent","value":0.95},{"name":"PM-KQDM-8416","type":"percent","value":0.85},{"name":"PM-QBFB-1491","type":"percent","value":0.85},{"name":"PM-VPHR-7435","type":"percent","value":0.85},{"name":"PM-SCOD-9158","type":"percent","value":0.85},{"name":"PM-GFEB-2837","type":"percent","value":0.85},{"name":"PM-ISBW-4350","type":"percent","value":0.85},{"name":"PM-SION-2536","type":"percent","value":0.85},{"name":"PM-KZOE-9119","type":"percent","value":0.85},{"name":"PM-CDGX-8332","type":"percent","value":0.85},{"name":"PM-ULDD-8757","type":"percent","value":0.85},{"name":"PM-FCGM-3602","type":"percent","value":0.85},{"name":"PM-GEIE-0271","type":"percent","value":0.85},{"name":"PM-WEYA-7606","type":"percent","value":0.85},{"name":"PM-WFRI-7773","type":"percent","value":0.85},{"name":"PM-XLNY-4568","type":"percent","value":0.85},{"name":"PM-CAJR-3848","type":"percent","value":0.85},{"name":"PM-UGMS-1573","type":"percent","value":0.85},{"name":"PM-UQAP-5062","type":"percent","value":0.85},{"name":"PM-KOWN-6036","type":"percent","value":0.85},{"name":"PM-UICF-0360","type":"percent","value":0.85},{"name":"PM-DBKB-7129","type":"percent","value":0.85},{"name":"PM-RTDT-2662","type":"percent","value":0.85},{"name":"PM-EEXO-4604","type":"percent","value":0.85},{"name":"PM-VSKI-9959","type":"percent","value":0.85},{"name":"PM-DDIS-7631","type":"percent","value":0.85},{"name":"PM-BDJP-1583","type":"percent","value":0.85},{"name":"PM-HIDA-3239","type":"percent","value":0.85},{"name":"PM-BSAO-7238","type":"percent","value":0.85},{"name":"PM-VVQG-2371","type":"percent","value":0.85},{"name":"PM-SUSL-6647","type":"percent","value":0.85},{"name":"PM-KZUM-4456","type":"percent","value":0.85},{"name":"PM-JAQO-5410","type":"percent","value":0.85},{"name":"PM-ODII-3311","type":"percent","value":0.85},{"name":"PM-GLOA-2282","type":"percent","value":0.85},{"name":"PM-WHVG-2369","type":"percent","value":0.85},{"name":"PM-CYHH-5286","type":"percent","value":0.85},{"name":"PM-GWWP-3609","type":"percent","value":0.85},{"name":"PM-VEIR-0386","type":"percent","value":0.85},{"name":"PM-OKDF-9459","type":"percent","value":0.85},{"name":"PM-IZQR-0692","type":"percent","value":0.85},{"name":"PM-LPUY-3631","type":"percent","value":0.85},{"name":"PM-ALAH-9592","type":"percent","value":0.85},{"name":"PM-SWTT-0936","type":"percent","value":0.85},{"name":"PM-WOMQ-9438","type":"percent","value":0.85},{"name":"PM-SQYG-3496","type":"percent","value":0.85},{"name":"PM-NIUT-2026","type":"percent","value":0.85},{"name":"PM-FXFR-1947","type":"percent","value":0.85},{"name":"PM-IHXN-5498","type":"percent","value":0.85},{"name":"PM-UJXC-9054","type":"percent","value":0.85},{"name":"PM-JYFD-2663","type":"percent","value":0.85},{"name":"PM-TIYC-8006","type":"percent","value":0.85},{"name":"PM-PCHI-7693","type":"percent","value":0.85},{"name":"PM-TITY-8788","type":"percent","value":0.85},{"name":"PM-YWHX-0933","type":"percent","value":0.85},{"name":"PM-URCT-6163","type":"percent","value":0.85},{"name":"PM-UVVF-2116","type":"percent","value":0.85},{"name":"PM-DVAF-8245","type":"percent","value":0.85}]},{"name":"stickyOutstream","type":"percent","value":0.75},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"pubmatic","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.01},{"name":"instream","type":"percent","value":0.01}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"resetdigital","enabled":false},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.01},{"name":"instream","type":"percent","value":0.01}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"rise","enabled":false},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.01}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"rtbhouse","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.96},{"name":"outstream","type":"percent","value":0.96},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"1509070","type":"percent","value":0.85},{"name":"1509072","type":"percent","value":0.85},{"name":"1623874","type":"percent","value":0.85},{"name":"1751662","type":"percent","value":0.85},{"name":"1751664","type":"percent","value":0.85},{"name":"1751666","type":"percent","value":0.85},{"name":"1751668","type":"percent","value":0.85},{"name":"1751670","type":"percent","value":0.85},{"name":"1751672","type":"percent","value":0.85},{"name":"1751674","type":"percent","value":0.85},{"name":"1751676","type":"percent","value":0.85},{"name":"1751678","type":"percent","value":0.85},{"name":"1751680","type":"percent","value":0.85},{"name":"1751682","type":"percent","value":0.85},{"name":"1751684","type":"percent","value":0.88},{"name":"1751686","type":"percent","value":0.85},{"name":"1751688","type":"percent","value":0.88},{"name":"1751690","type":"percent","value":0.85},{"name":"1751692","type":"percent","value":0.88},{"name":"1751694","type":"percent","value":0.85},{"name":"1751696","type":"percent","value":0.88},{"name":"1751698","type":"percent","value":0.85},{"name":"1751700","type":"percent","value":0.88},{"name":"1751702","type":"percent","value":0.88},{"name":"1751706","type":"percent","value":0.88},{"name":"1751708","type":"percent","value":0.85},{"name":"1751710","type":"percent","value":0.88},{"name":"1751712","type":"percent","value":0.85},{"name":"1751714","type":"percent","value":0.88},{"name":"1751716","type":"percent","value":0.85},{"name":"1751718","type":"percent","value":0.85},{"name":"1792390","type":"percent","value":0.85},{"name":"1909612","type":"percent","value":0.9},{"name":"1910078","type":"percent","value":0.9},{"name":"1913794","type":"percent","value":0.9},{"name":"1914770","type":"percent","value":0.9},{"name":"1915132","type":"percent","value":0.9},{"name":"1915136","type":"percent","value":0.9},{"name":"1915534","type":"percent","value":0.9},{"name":"1915928","type":"percent","value":0.9},{"name":"1915930","type":"percent","value":0.9},{"name":"1916326","type":"percent","value":0.9},{"name":"1916722","type":"percent","value":0.9},{"name":"1917116","type":"percent","value":0.9},{"name":"1917120","type":"percent","value":0.9},{"name":"1917122","type":"percent","value":0.9},{"name":"1917124","type":"percent","value":0.9},{"name":"1917126","type":"percent","value":0.9},{"name":"1917128","type":"percent","value":0.9},{"name":"1917130","type":"percent","value":0.9},{"name":"1917136","type":"percent","value":0.88},{"name":"1917138","type":"percent","value":0.88},{"name":"1917142","type":"percent","value":0.9},{"name":"1917144","type":"percent","value":0.9},{"name":"2076190","type":"percent","value":0.9},{"name":"2256280","type":"percent","value":0.9},{"name":"2256286","type":"percent","value":0.9},{"name":"2356286","type":"percent","value":0.9},{"name":"2394816","type":"percent","value":0.9},{"name":"2394818","type":"percent","value":0.9},{"name":"2734898","type":"percent","value":0.9},{"name":"2734902","type":"percent","value":0.9},{"name":"2734904","type":"percent","value":0.9},{"name":"2734908","type":"percent","value":0.9},{"name":"2734910","type":"percent","value":0.9},{"name":"2734914","type":"percent","value":0.9},{"name":"2734918","type":"percent","value":0.9},{"name":"2734920","type":"percent","value":0.9},{"name":"2734922","type":"percent","value":0.9},{"name":"2734924","type":"percent","value":0.9},{"name":"2734926","type":"percent","value":0.9},{"name":"2734928","type":"percent","value":0.9},{"name":"2734930","type":"percent","value":0.9},{"name":"2734932","type":"percent","value":0.9},{"name":"2734934","type":"percent","value":0.9},{"name":"2734936","type":"percent","value":0.9},{"name":"2734938","type":"percent","value":0.9},{"name":"2734940","type":"percent","value":0.9},{"name":"2734942","type":"percent","value":0.9},{"name":"2734944","type":"percent","value":0.9},{"name":"2734946","type":"percent","value":0.9},{"name":"2734948","type":"percent","value":0.9},{"name":"2734950","type":"percent","value":0.9},{"name":"2734952","type":"percent","value":0.9},{"name":"2734954","type":"percent","value":0.9},{"name":"2734956","type":"percent","value":0.9},{"name":"2734958","type":"percent","value":0.9},{"name":"2734960","type":"percent","value":0.9},{"name":"2734962","type":"percent","value":0.9},{"name":"2734964","type":"percent","value":0.9},{"name":"2734966","type":"percent","value":0.9},{"name":"2734968","type":"percent","value":0.9},{"name":"2734970","type":"percent","value":0.9},{"name":"2734972","type":"percent","value":0.9},{"name":"2734974","type":"percent","value":0.9},{"name":"2734976","type":"percent","value":0.9},{"name":"2824402","type":"percent","value":0.9},{"name":"2825204","type":"percent","value":0.9},{"name":"2990692","type":"percent","value":0.85},{"name":"2990750","type":"percent","value":0.88},{"name":"2990752","type":"percent","value":0.88},{"name":"2990756","type":"percent","value":0.85},{"name":"2990760","type":"percent","value":0.85},{"name":"2990762","type":"percent","value":0.85},{"name":"2990764","type":"percent","value":0.88},{"name":"2990766","type":"percent","value":0.85},{"name":"2990768","type":"percent","value":0.88},{"name":"2990770","type":"percent","value":0.88},{"name":"2990772","type":"percent","value":0.85},{"name":"3331634","type":"percent","value":0.85},{"name":"3427182","type":"percent","value":0.88},{"name":"3494148","type":"percent","value":0.9},{"name":"3494152","type":"percent","value":0.9},{"name":"3548098","type":"percent","value":0.85},{"name":"3561446","type":"percent","value":0.9},{"name":"3561448","type":"percent","value":0.9},{"name":"3766690","type":"percent","value":0.85},{"name":"3769100","type":"percent","value":0.95},{"name":"3769114","type":"percent","value":0.95},{"name":"3771346","type":"flat","value":2.6},{"name":"3771346","type":"percent","value":0.85},{"name":"3773930","type":"percent","value":0.95},{"name":"3773940","type":"percent","value":0.95},{"name":"3775844","type":"percent","value":0.95},{"name":"3775846","type":"percent","value":0.95},{"name":"3777796","type":"percent","value":0.95},{"name":"3777798","type":"percent","value":0.95},{"name":"3781560","type":"percent","value":0.85},{"name":"3782740","type":"percent","value":0.85},{"name":"3785356","type":"percent","value":0.85},{"name":"3785372","type":"percent","value":0.98},{"name":"3785374","type":"percent","value":0.98},{"name":"3786320","type":"percent","value":0.7},{"name":"3788982","type":"percent","value":0.85},{"name":"3789904","type":"percent","value":0.95},{"name":"3789906","type":"percent","value":0.95},{"name":"3789908","type":"percent","value":0.95},{"name":"3789910","type":"percent","value":0.95},{"name":"3789912","type":"percent","value":0.95},{"name":"3791994","type":"percent","value":0.9},{"name":"3791996","type":"percent","value":0.9},{"name":"3795840","type":"percent","value":0.85},{"name":"3795842","type":"percent","value":0.85},{"name":"3795846","type":"percent","value":0.85},{"name":"3795848","type":"percent","value":0.85},{"name":"3796850","type":"percent","value":0.85},{"name":"3796852","type":"percent","value":0.85},{"name":"3796856","type":"percent","value":0.85},{"name":"3796858","type":"percent","value":0.85},{"name":"3804310","type":"flat","value":2.6},{"name":"3804310","type":"percent","value":0.85},{"name":"3804318","type":"flat","value":2.6},{"name":"3804318","type":"percent","value":0.85},{"name":"3804322","type":"flat","value":2.6},{"name":"3804322","type":"percent","value":0.85},{"name":"3804346","type":"percent","value":0.85},{"name":"3804350","type":"percent","value":0.85},{"name":"3806000","type":"percent","value":0.85},{"name":"3806898","type":"percent","value":0.9},{"name":"3806910","type":"percent","value":0.9},{"name":"3806912","type":"percent","value":0.9},{"name":"3806914","type":"percent","value":0.9},{"name":"3806916","type":"percent","value":0.9},{"name":"3806918","type":"percent","value":0.9},{"name":"3806920","type":"percent","value":0.9},{"name":"3806922","type":"percent","value":0.9},{"name":"3806924","type":"percent","value":0.9},{"name":"3806926","type":"percent","value":0.9},{"name":"3806928","type":"percent","value":0.9},{"name":"3806932","type":"percent","value":0.9},{"name":"3806934","type":"percent","value":0.9},{"name":"3806936","type":"percent","value":0.9},{"name":"3806938","type":"percent","value":0.9},{"name":"3806944","type":"percent","value":0.9},{"name":"3806950","type":"percent","value":0.9},{"name":"3806954","type":"percent","value":0.9},{"name":"3808872","type":"percent","value":0.95},{"name":"3809720","type":"percent","value":0.95},{"name":"3809726","type":"percent","value":0.95},{"name":"3809728","type":"percent","value":0.95},{"name":"3809730","type":"percent","value":0.95},{"name":"3809758","type":"percent","value":0.95},{"name":"3809760","type":"percent","value":0.95},{"name":"3809762","type":"percent","value":0.95},{"name":"3809764","type":"percent","value":0.95},{"name":"3809766","type":"percent","value":0.95},{"name":"3809768","type":"percent","value":0.95},{"name":"3810612","type":"percent","value":0.95},{"name":"3810614","type":"percent","value":0.95},{"name":"3810616","type":"percent","value":0.95},{"name":"3810618","type":"percent","value":0.95},{"name":"3810840","type":"percent","value":0.9},{"name":"3810842","type":"percent","value":0.9},{"name":"3810844","type":"percent","value":0.9},{"name":"3812436","type":"percent","value":0.85}]},{"name":"stickyOutstream","type":"percent","value":0.7},{"name":"instream","type":"percent","value":0.97}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"rubi_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.95},{"name":"outstream","type":"percent","value":0.95},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"1509070","type":"percent","value":0.85},{"name":"1509072","type":"percent","value":0.85},{"name":"1623874","type":"percent","value":0.85},{"name":"1688128","type":"percent","value":0.98},{"name":"1751440","type":"percent","value":0.85},{"name":"1751442","type":"percent","value":0.85},{"name":"1751444","type":"percent","value":0.85},{"name":"1751448","type":"percent","value":0.85},{"name":"1751450","type":"percent","value":0.85},{"name":"1751452","type":"percent","value":0.85},{"name":"1751454","type":"percent","value":0.85},{"name":"1751456","type":"percent","value":0.85},{"name":"1751472","type":"percent","value":0.85},{"name":"1751474","type":"percent","value":0.85},{"name":"1751476","type":"percent","value":0.85},{"name":"1751478","type":"percent","value":0.85},{"name":"1751480","type":"percent","value":0.85},{"name":"1751482","type":"percent","value":0.85},{"name":"1751632","type":"percent","value":0.85},{"name":"1751634","type":"percent","value":0.85},{"name":"1751636","type":"percent","value":0.85},{"name":"1751638","type":"percent","value":0.88},{"name":"1751640","type":"percent","value":0.85},{"name":"1751642","type":"percent","value":0.85},{"name":"1751644","type":"percent","value":0.85},{"name":"1751646","type":"percent","value":0.85},{"name":"1751648","type":"percent","value":0.85},{"name":"1751650","type":"percent","value":0.85},{"name":"1751652","type":"percent","value":0.85},{"name":"1751654","type":"percent","value":0.85},{"name":"1751656","type":"percent","value":0.85},{"name":"1751660","type":"percent","value":0.85},{"name":"1751662","type":"percent","value":0.85},{"name":"1751664","type":"percent","value":0.85},{"name":"1751666","type":"percent","value":0.85},{"name":"1751668","type":"percent","value":0.85},{"name":"1751670","type":"percent","value":0.85},{"name":"1751672","type":"percent","value":0.85},{"name":"1751674","type":"percent","value":0.85},{"name":"1751676","type":"percent","value":0.85},{"name":"1751678","type":"percent","value":0.85},{"name":"1751680","type":"percent","value":0.85},{"name":"1751682","type":"percent","value":0.85},{"name":"1751684","type":"percent","value":0.88},{"name":"1751686","type":"percent","value":0.85},{"name":"1751688","type":"percent","value":0.88},{"name":"1751690","type":"percent","value":0.85},{"name":"1751692","type":"percent","value":0.88},{"name":"1751694","type":"percent","value":0.85},{"name":"1751696","type":"percent","value":0.88},{"name":"1751698","type":"percent","value":0.85},{"name":"1751700","type":"percent","value":0.88},{"name":"1751702","type":"percent","value":0.88},{"name":"1751706","type":"percent","value":0.88},{"name":"1751708","type":"percent","value":0.85},{"name":"1751710","type":"percent","value":0.88},{"name":"1751712","type":"percent","value":0.85},{"name":"1751714","type":"percent","value":0.88},{"name":"1751716","type":"percent","value":0.85},{"name":"1751718","type":"percent","value":0.85},{"name":"1792390","type":"percent","value":0.85},{"name":"1792400","type":"percent","value":0.85},{"name":"1813144","type":"percent","value":0.85},{"name":"1909612","type":"percent","value":0.9},{"name":"1910078","type":"percent","value":0.9},{"name":"1913794","type":"percent","value":0.9},{"name":"1914770","type":"percent","value":0.9},{"name":"1915132","type":"percent","value":0.9},{"name":"1915136","type":"percent","value":0.9},{"name":"1915534","type":"percent","value":0.9},{"name":"1915928","type":"percent","value":0.9},{"name":"1915930","type":"percent","value":0.9},{"name":"1916326","type":"percent","value":0.9},{"name":"1916722","type":"percent","value":0.9},{"name":"1917116","type":"percent","value":0.9},{"name":"1917120","type":"percent","value":0.9},{"name":"1917122","type":"percent","value":0.9},{"name":"1917124","type":"percent","value":0.9},{"name":"1917126","type":"percent","value":0.9},{"name":"1917128","type":"percent","value":0.9},{"name":"1917130","type":"percent","value":0.9},{"name":"1917132","type":"percent","value":0.88},{"name":"1917134","type":"percent","value":0.88},{"name":"1917136","type":"percent","value":0.88},{"name":"1917138","type":"percent","value":0.88},{"name":"1917142","type":"percent","value":0.9},{"name":"1917144","type":"percent","value":0.9},{"name":"2076190","type":"percent","value":0.9},{"name":"2256280","type":"percent","value":0.9},{"name":"2256286","type":"percent","value":0.9},{"name":"2270364","type":"percent","value":0.98},{"name":"2270368","type":"percent","value":0.98},{"name":"2270374","type":"percent","value":0.98},{"name":"2302618","type":"percent","value":0.88},{"name":"2302620","type":"percent","value":0.88},{"name":"2302622","type":"percent","value":0.88},{"name":"2356286","type":"percent","value":0.9},{"name":"2394816","type":"percent","value":0.9},{"name":"2394818","type":"percent","value":0.9},{"name":"2569122","type":"percent","value":0.85},{"name":"2734898","type":"percent","value":0.9},{"name":"2734902","type":"percent","value":0.9},{"name":"2734904","type":"percent","value":0.9},{"name":"2734908","type":"percent","value":0.9},{"name":"2734910","type":"percent","value":0.9},{"name":"2734914","type":"percent","value":0.9},{"name":"2734918","type":"percent","value":0.9},{"name":"2734920","type":"percent","value":0.9},{"name":"2734922","type":"percent","value":0.9},{"name":"2734924","type":"percent","value":0.9},{"name":"2734926","type":"percent","value":0.9},{"name":"2734928","type":"percent","value":0.9},{"name":"2734930","type":"percent","value":0.9},{"name":"2734932","type":"percent","value":0.9},{"name":"2734934","type":"percent","value":0.9},{"name":"2734936","type":"percent","value":0.9},{"name":"2734938","type":"percent","value":0.9},{"name":"2734940","type":"percent","value":0.9},{"name":"2734942","type":"percent","value":0.9},{"name":"2734944","type":"percent","value":0.9},{"name":"2734946","type":"percent","value":0.9},{"name":"2734948","type":"percent","value":0.9},{"name":"2734950","type":"percent","value":0.9},{"name":"2734952","type":"percent","value":0.9},{"name":"2734954","type":"percent","value":0.9},{"name":"2734956","type":"percent","value":0.9},{"name":"2734958","type":"percent","value":0.9},{"name":"2734960","type":"percent","value":0.9},{"name":"2734962","type":"percent","value":0.9},{"name":"2734964","type":"percent","value":0.9},{"name":"2734966","type":"percent","value":0.9},{"name":"2734968","type":"percent","value":0.9},{"name":"2734970","type":"percent","value":0.9},{"name":"2734972","type":"percent","value":0.9},{"name":"2734974","type":"percent","value":0.9},{"name":"2734976","type":"percent","value":0.9},{"name":"2735402","type":"percent","value":0.85},{"name":"2735404","type":"percent","value":0.85},{"name":"2824402","type":"percent","value":0.9},{"name":"2825204","type":"percent","value":0.9},{"name":"2990692","type":"percent","value":0.85},{"name":"2990750","type":"percent","value":0.88},{"name":"2990752","type":"percent","value":0.88},{"name":"2990756","type":"percent","value":0.85},{"name":"2990760","type":"percent","value":0.85},{"name":"2990762","type":"percent","value":0.85},{"name":"2990764","type":"percent","value":0.88},{"name":"2990766","type":"percent","value":0.85},{"name":"2990768","type":"percent","value":0.88},{"name":"2990770","type":"percent","value":0.88},{"name":"2990772","type":"percent","value":0.85},{"name":"3286020","type":"percent","value":0.85},{"name":"3317338","type":"percent","value":0.95},{"name":"3317342","type":"percent","value":0.95},{"name":"3331634","type":"percent","value":0.85},{"name":"3427182","type":"percent","value":0.88},{"name":"3464904","type":"percent","value":0.95},{"name":"3464906","type":"percent","value":0.95},{"name":"3494148","type":"percent","value":0.9},{"name":"3494152","type":"percent","value":0.9},{"name":"3532524","type":"percent","value":0.95},{"name":"3532624","type":"percent","value":0.95},{"name":"3548098","type":"percent","value":0.85},{"name":"3561446","type":"percent","value":0.9},{"name":"3561448","type":"percent","value":0.9},{"name":"3577514","type":"percent","value":0.95},{"name":"3577516","type":"percent","value":0.95},{"name":"3577518","type":"percent","value":0.95},{"name":"3577520","type":"percent","value":0.95},{"name":"3577522","type":"percent","value":0.95},{"name":"3577524","type":"percent","value":0.95},{"name":"3578846","type":"percent","value":0.95},{"name":"3578870","type":"percent","value":0.95},{"name":"3626028","type":"percent","value":0.85},{"name":"3626030","type":"percent","value":0.85},{"name":"3626032","type":"percent","value":0.85},{"name":"3626038","type":"percent","value":0.85},{"name":"3652906","type":"percent","value":0.95},{"name":"3691624","type":"percent","value":0.95},{"name":"3691626","type":"percent","value":0.95},{"name":"3744900","type":"percent","value":0.95},{"name":"3744902","type":"percent","value":0.95},{"name":"3766636","type":"percent","value":0.95},{"name":"3766638","type":"percent","value":0.95},{"name":"3766640","type":"percent","value":0.95},{"name":"3766646","type":"percent","value":0.95},{"name":"3766690","type":"percent","value":0.85},{"name":"3769100","type":"percent","value":0.95},{"name":"3769110","type":"percent","value":0.95},{"name":"3769114","type":"percent","value":0.95},{"name":"3769116","type":"percent","value":0.95},{"name":"3771346","type":"flat","value":2.6},{"name":"3771346","type":"percent","value":0.85},{"name":"3772558","type":"percent","value":0.85},{"name":"3772566","type":"percent","value":0.85},{"name":"3772882","type":"percent","value":0.95},{"name":"3772884","type":"percent","value":0.95},{"name":"3772888","type":"percent","value":0.95},{"name":"3773468","type":"percent","value":0.85},{"name":"3773470","type":"percent","value":0.85},{"name":"3773474","type":"percent","value":0.85},{"name":"3773476","type":"percent","value":0.85},{"name":"3773494","type":"percent","value":0.95},{"name":"3773496","type":"percent","value":0.95},{"name":"3773498","type":"percent","value":0.95},{"name":"3773500","type":"percent","value":0.95},{"name":"3773502","type":"percent","value":0.95},{"name":"3773504","type":"percent","value":0.95},{"name":"3773506","type":"percent","value":0.95},{"name":"3773508","type":"percent","value":0.95},{"name":"3773510","type":"percent","value":0.95},{"name":"3773516","type":"percent","value":0.95},{"name":"3773930","type":"percent","value":0.95},{"name":"3773940","type":"percent","value":0.95},{"name":"3773944","type":"percent","value":0.95},{"name":"3775844","type":"percent","value":0.95},{"name":"3775846","type":"percent","value":0.95},{"name":"3776064","type":"percent","value":0.95},{"name":"3776066","type":"percent","value":0.95},{"name":"3776068","type":"percent","value":0.95},{"name":"3776070","type":"percent","value":0.95},{"name":"3776072","type":"percent","value":0.95},{"name":"3776074","type":"percent","value":0.95},{"name":"3776152","type":"percent","value":0.95},{"name":"3776154","type":"percent","value":0.95},{"name":"3776156","type":"percent","value":0.95},{"name":"3776158","type":"percent","value":0.95},{"name":"3776618","type":"percent","value":0.95},{"name":"3776620","type":"percent","value":0.95},{"name":"3777796","type":"percent","value":0.95},{"name":"3777798","type":"percent","value":0.95},{"name":"3778892","type":"percent","value":0.95},{"name":"3778894","type":"percent","value":0.95},{"name":"3778896","type":"percent","value":0.95},{"name":"3778900","type":"percent","value":0.95},{"name":"3778902","type":"percent","value":0.95},{"name":"3778904","type":"percent","value":0.95},{"name":"3778906","type":"percent","value":0.95},{"name":"3778908","type":"percent","value":0.95},{"name":"3778912","type":"percent","value":0.95},{"name":"3778914","type":"percent","value":0.95},{"name":"3778916","type":"percent","value":0.95},{"name":"3778918","type":"percent","value":0.95},{"name":"3779114","type":"percent","value":0.85},{"name":"3779118","type":"percent","value":0.85},{"name":"3779120","type":"percent","value":0.85},{"name":"3779122","type":"percent","value":0.85},{"name":"3781560","type":"percent","value":0.85},{"name":"3782740","type":"percent","value":0.85},{"name":"3783146","type":"percent","value":0.95},{"name":"3783148","type":"percent","value":0.95},{"name":"3783588","type":"percent","value":0.85},{"name":"3783758","type":"percent","value":0.95},{"name":"3783760","type":"percent","value":0.95},{"name":"3783762","type":"percent","value":0.95},{"name":"3783764","type":"percent","value":0.95},{"name":"3783766","type":"percent","value":0.95},{"name":"3783768","type":"percent","value":0.95},{"name":"3783770","type":"percent","value":0.95},{"name":"3783772","type":"percent","value":0.95},{"name":"3783774","type":"percent","value":0.95},{"name":"3783776","type":"percent","value":0.95},{"name":"3783778","type":"percent","value":0.95},{"name":"3783780","type":"percent","value":0.95},{"name":"3784862","type":"percent","value":0.85},{"name":"3785356","type":"percent","value":0.85},{"name":"3785372","type":"percent","value":0.98},{"name":"3785374","type":"percent","value":0.98},{"name":"3786320","type":"percent","value":0.7},{"name":"3786326","type":"percent","value":0.85},{"name":"3786328","type":"flat","value":2.6},{"name":"3786328","type":"percent","value":0.85},{"name":"3786482","type":"percent","value":0.85},{"name":"3786484","type":"percent","value":0.85},{"name":"3788980","type":"percent","value":0.85},{"name":"3788982","type":"percent","value":0.85},{"name":"3789904","type":"percent","value":0.95},{"name":"3789906","type":"percent","value":0.95},{"name":"3789908","type":"percent","value":0.95},{"name":"3789910","type":"percent","value":0.95},{"name":"3789912","type":"percent","value":0.95},{"name":"3791994","type":"percent","value":0.9},{"name":"3791996","type":"percent","value":0.9},{"name":"3793184","type":"percent","value":0.85},{"name":"3794974","type":"flat","value":2.6},{"name":"3794974","type":"percent","value":0.85},{"name":"3794976","type":"flat","value":2.6},{"name":"3794976","type":"percent","value":0.85},{"name":"3794978","type":"percent","value":0.85},{"name":"3794980","type":"percent","value":0.85},{"name":"3795380","type":"flat","value":0.5},{"name":"3795382","type":"flat","value":0.75},{"name":"3795838","type":"percent","value":0.85},{"name":"3795840","type":"percent","value":0.85},{"name":"3795842","type":"percent","value":0.85},{"name":"3795844","type":"percent","value":0.85},{"name":"3795846","type":"percent","value":0.85},{"name":"3795848","type":"percent","value":0.85},{"name":"3799340","type":"percent","value":0.85},{"name":"3800300","type":"flat","value":0.5},{"name":"3800338","type":"flat","value":0.5},{"name":"3800340","type":"flat","value":0.5},{"name":"3800344","type":"flat","value":0.5},{"name":"3800346","type":"flat","value":0.5},{"name":"3800748","type":"percent","value":0.85},{"name":"3801546","type":"percent","value":0.85},{"name":"3801548","type":"percent","value":0.85},{"name":"3804310","type":"flat","value":2.6},{"name":"3804310","type":"percent","value":0.85},{"name":"3804318","type":"flat","value":2.6},{"name":"3804318","type":"percent","value":0.85},{"name":"3804322","type":"flat","value":2.6},{"name":"3804322","type":"percent","value":0.85},{"name":"3804346","type":"percent","value":0.85},{"name":"3804350","type":"percent","value":0.85},{"name":"3805186","type":"flat","value":2.6},{"name":"3805186","type":"percent","value":0.85},{"name":"3806000","type":"percent","value":0.85},{"name":"3806898","type":"percent","value":0.9},{"name":"3806910","type":"percent","value":0.9},{"name":"3806912","type":"percent","value":0.9},{"name":"3806914","type":"percent","value":0.9},{"name":"3806916","type":"percent","value":0.9},{"name":"3806918","type":"percent","value":0.9},{"name":"3806920","type":"percent","value":0.9},{"name":"3806922","type":"percent","value":0.9},{"name":"3806924","type":"percent","value":0.9},{"name":"3806926","type":"percent","value":0.9},{"name":"3806928","type":"percent","value":0.9},{"name":"3806932","type":"percent","value":0.9},{"name":"3806934","type":"percent","value":0.9},{"name":"3806936","type":"percent","value":0.9},{"name":"3806938","type":"percent","value":0.9},{"name":"3806944","type":"percent","value":0.9},{"name":"3806950","type":"percent","value":0.9},{"name":"3806954","type":"percent","value":0.9},{"name":"3808872","type":"percent","value":0.95},{"name":"3809720","type":"percent","value":0.95},{"name":"3809726","type":"percent","value":0.95},{"name":"3809728","type":"percent","value":0.95},{"name":"3809730","type":"percent","value":0.95},{"name":"3809758","type":"percent","value":0.95},{"name":"3809760","type":"percent","value":0.95},{"name":"3809762","type":"percent","value":0.95},{"name":"3809764","type":"percent","value":0.95},{"name":"3809766","type":"percent","value":0.95},{"name":"3809768","type":"percent","value":0.95},{"name":"3810612","type":"percent","value":0.95},{"name":"3810614","type":"percent","value":0.95},{"name":"3810616","type":"percent","value":0.95},{"name":"3810618","type":"percent","value":0.95},{"name":"3810840","type":"percent","value":0.9},{"name":"3810842","type":"percent","value":0.9},{"name":"3810844","type":"percent","value":0.9},{"name":"3812436","type":"percent","value":0.85}]},{"name":"stickyOutstream","type":"percent","value":0.7},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"rubicon","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"seedtag","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.97},{"name":"stickyOutstream","type":"percent","value":0.85},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"share_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.9},{"name":"stickyOutstream","type":"percent","value":0.85},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"sharethrough","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.83},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"stackadapt","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.98}],"s2s":[],"bidder_name":"teads","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"outstream","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.65},{"name":"instream","type":"percent","value":0.98}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"tripl_ss","enabled":true},{"secondary":true,"cpm":[{"name":"default","type":"percent","value":1},{"name":"outstream","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.65},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"triplelift","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.95},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"opath-192-1-1xp5kjuyqd","type":"flat","value":0.05},{"name":"opath-192-1-0wnry1o4v7","type":"flat","value":0.05},{"name":"opath-192-1-zg76pd36n7","type":"flat","value":0.05},{"name":"opath-192-1-94bwcov1yw","type":"flat","value":0.05},{"name":"opath-192-1-b39525vs4e","type":"flat","value":0.05},{"name":"opath-192-1-bmrt132xdj","type":"flat","value":0.05},{"name":"opath-192-1-dk4u379mru","type":"flat","value":0.05},{"name":"opath-192-1-ldm7nks9tq","type":"flat","value":0.05}]},{"name":"stickyOutstream","type":"percent","value":0.7},{"name":"instream","type":"percent","value":0.95}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"ttd","enabled":true},{"secondary":false,"cpm":[{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"under_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.99}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"undertone","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":0.98},{"name":"outstream","type":"percent","value":0.98},{"name":"instream","type":"percent","value":0.99}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"unruly","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"pmp","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.7},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"yah_ss","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"pmp","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.65},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"yahoossp","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.85},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"yieldmo","enabled":true},{"secondary":false,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[{"s2s_value":0,"media_type":"display"},{"s2s_value":0,"media_type":"video"}],"bidder_name":"chicory","enabled":true}],"liveIntent":[{"bidder":"tripl_ss","month":8,"day":29,"multiplier":99.51884135027186,"browser":"Chrome"},{"bidder":"ttd","month":8,"day":29,"multiplier":99.83033770059001,"browser":"Chrome"},{"bidder":"undertone","month":8,"day":29,"multiplier":99.39877291831135,"browser":"Chrome"},{"bidder":"appnexus","month":8,"day":29,"multiplier":98.91950714886421,"browser":"Chrome"},{"bidder":"connatix","month":8,"day":29,"multiplier":98.58846600770018,"browser":"Chrome"},{"bidder":"cri","month":8,"day":29,"multiplier":86.52750867206697,"browser":"Chrome"},{"bidder":"ogury","month":8,"day":29,"multiplier":99.82163112978655,"browser":"Chrome"},{"bidder":"ope","month":8,"day":29,"multiplier":86.52750867206697,"browser":"Chrome"},{"bidder":"openx","month":8,"day":29,"multiplier":99.8669740591736,"browser":"Chrome"},{"bidder":"ix","month":8,"day":29,"multiplier":99.59128038274577,"browser":"Chrome"},{"bidder":"ix_ss","month":8,"day":29,"multiplier":99.9271099364278,"browser":"Chrome"},{"bidder":"nativo","month":8,"day":29,"multiplier":99.28823111127629,"browser":"Chrome"},{"bidder":"opnx_ss","month":8,"day":29,"multiplier":99.2484165373527,"browser":"Chrome"},{"bidder":"ozone","month":8,"day":29,"multiplier":99.20494399112137,"browser":"Chrome"},{"bidder":"pubm","month":8,"day":29,"multiplier":86.52750867206697,"browser":"Chrome"},{"bidder":"unruly","month":8,"day":29,"multiplier":99.96703528584206,"browser":"Chrome"},{"bidder":"yah_ss","month":8,"day":29,"multiplier":99.9593510192112,"browser":"Chrome"},{"bidder":"yahoossp","month":8,"day":29,"multiplier":98.25928253231478,"browser":"Chrome"},{"bidder":null,"month":8,"day":29,"multiplier":98.67049530374774,"browser":"Chrome"},{"bidder":"pubm_ss","month":8,"day":29,"multiplier":99.19395854812674,"browser":"Chrome"},{"bidder":"pubmatic","month":8,"day":29,"multiplier":99.59076669315301,"browser":"Chrome"},{"bidder":"share_ss","month":8,"day":29,"multiplier":99.97716673362078,"browser":"Chrome"},{"bidder":"sharethrough","month":8,"day":29,"multiplier":99.18953635873365,"browser":"Chrome"},{"bidder":"crit_","month":8,"day":29,"multiplier":86.52750867206697,"browser":"Chrome"},{"bidder":"crit_ss","month":8,"day":29,"multiplier":99.6352343340414,"browser":"Chrome"},{"bidder":"gridvid","month":8,"day":29,"multiplier":86.52750867206697,"browser":"Chrome"},{"bidder":"gumgum","month":8,"day":29,"multiplier":99.26712270350683,"browser":"Chrome"},{"bidder":"a_rubicon","month":8,"day":29,"multiplier":98.67144391650655,"browser":"Chrome"},{"bidder":"a_unruly","month":8,"day":29,"multiplier":98.84381334185008,"browser":"Chrome"},{"bidder":"a_verve","month":8,"day":29,"multiplier":98.14110004711931,"browser":"Chrome"},{"bidder":"a_appnexus","month":8,"day":29,"multiplier":99.9428755655523,"browser":"Chrome"},{"bidder":"a_cadent","month":8,"day":29,"multiplier":96.79872690060482,"browser":"Chrome"},{"bidder":"a_gumgum","month":8,"day":29,"multiplier":98.09007645258045,"browser":"Chrome"},{"bidder":"a_openx","month":8,"day":29,"multiplier":99.82421006781834,"browser":"Chrome"},{"bidder":"a_pubmatic","month":8,"day":29,"multiplier":99.05921715692796,"browser":"Chrome"},{"bidder":"a_cadent","month":8,"day":29,"multiplier":97.73332498218858,"browser":"Not Chrome"},{"bidder":"a_medianet","month":8,"day":29,"multiplier":99.71434117762696,"browser":"Not Chrome"},{"bidder":"a_openx","month":8,"day":29,"multiplier":98.60280576640345,"browser":"Not Chrome"},{"bidder":"33across","month":8,"day":29,"multiplier":94.4654684393814,"browser":"Not Chrome"},{"bidder":"a_amazon","month":8,"day":29,"multiplier":99.26111669381905,"browser":"Not Chrome"},{"bidder":"a_appnexus","month":8,"day":29,"multiplier":99.23821318311259,"browser":"Not Chrome"},{"bidder":"pubm_ss","month":8,"day":29,"multiplier":99.30789425484764,"browser":"Not Chrome"},{"bidder":"pubmatic","month":8,"day":29,"multiplier":99.21331665900254,"browser":"Not Chrome"},{"bidder":"sharethrough","month":8,"day":29,"multiplier":99.81892426005247,"browser":"Not Chrome"},{"bidder":"teads","month":8,"day":29,"multiplier":98.89191662163114,"browser":"Not Chrome"},{"bidder":"crit_ss","month":8,"day":29,"multiplier":99.99965954266365,"browser":"Not Chrome"},{"bidder":"grid","month":8,"day":29,"multiplier":99.45938964872465,"browser":"Not Chrome"},{"bidder":"tripl_ss","month":8,"day":29,"multiplier":99.63577883158074,"browser":"Not Chrome"},{"bidder":"undertone","month":8,"day":29,"multiplier":99.5500208091599,"browser":"Not Chrome"},{"bidder":"unruly","month":8,"day":29,"multiplier":99.54865077165505,"browser":"Not Chrome"},{"bidder":"yah_ss","month":8,"day":29,"multiplier":99.615816298368,"browser":"Not Chrome"},{"bidder":"yahoossp","month":8,"day":29,"multiplier":99.02267382307427,"browser":"Not Chrome"},{"bidder":null,"month":8,"day":29,"multiplier":99.43591618835525,"browser":"Not Chrome"},{"bidder":"gridvid","month":8,"day":29,"multiplier":86.52750867206697,"browser":"Not Chrome"},{"bidder":"ix_ss","month":8,"day":29,"multiplier":99.78577171132136,"browser":"Not Chrome"},{"bidder":"kargo","month":8,"day":29,"multiplier":99.79672813979984,"browser":"Not Chrome"},{"bidder":"opnx_ss","month":8,"day":29,"multiplier":99.42390646701897,"browser":"Not Chrome"},{"bidder":"a_pubmatic","month":8,"day":29,"multiplier":99.6432887685803,"browser":"Not Chrome"},{"bidder":"a_triplelift","month":8,"day":29,"multiplier":99.930932524952,"browser":"Not Chrome"},{"bidder":"a_yieldmo","month":8,"day":29,"multiplier":98.49283869803726,"browser":"Not Chrome"},{"bidder":"appnexus","month":8,"day":29,"multiplier":99.41591475416092,"browser":"Not Chrome"}],"predictiveAnalysis":[{"mobile":"1","error_rate":"0.9598607038123167","hb_crid":"7819625","chrome":"0","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9301953818827708","hb_crid":"7819625","chrome":"0","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9552730162333977","hb_crid":"7819627","chrome":"1","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9304511278195489","hb_crid":"7819627","chrome":"1","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9590899969900673","hb_crid":"2662_193964_t23679780","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9839939024390244","hb_crid":"2662_193964_t23679802","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9569199457259159","hb_crid":"2662_193964_t23978916","chrome":"1","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9134771064050256","hb_crid":"2662_193964_t23978916","chrome":"1","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9573938734255948","hb_crid":"2662_193964_t23264694","chrome":"0","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9503184713375796","hb_crid":"39776927","chrome":"0","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9538543770043948","hb_crid":"2662_193964_t23978906","chrome":"1","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9554685847260419","hb_crid":"2662_193964_t23679802","chrome":"1","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9625880281690141","hb_crid":"2662_193964_t23978916","chrome":"0","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9981644640234949","hb_crid":"7790437","chrome":"1","bidder":"opnx_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9785855677523844","hb_crid":"7790437","chrome":"1","bidder":"opnx_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9014939627532574","hb_crid":"37945511","chrome":"0","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9641762731650372","hb_crid":"37945511","chrome":"0","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9596753076721655","hb_crid":"2662_193964_t23978916","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9651752767527675","hb_crid":"7847504","chrome":"1","bidder":"gumgum","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9814727954971857","hb_crid":"7847504","chrome":"1","bidder":"gumgum","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9861613351877607","hb_crid":"7790437","chrome":"1","bidder":"yah_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9603819585534336","hb_crid":"7790437","chrome":"1","bidder":"yah_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9551927158211816","hb_crid":"2662_193964_t23978906","chrome":"1","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9914454648383444","hb_crid":"7789677","chrome":"0","bidder":"pubmatic","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9592550893101665","hb_crid":"7789677","chrome":"0","bidder":"pubmatic","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9574197120708748","hb_crid":"37945296","chrome":"0","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9604906802612713","hb_crid":"588963096183819704","chrome":"1","bidder":"openx","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9559042705646317","hb_crid":"2662_193964_t23679780","chrome":"0","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9575766871165644","hb_crid":"7789677","chrome":"1","bidder":"pubmatic","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9924651872575825","hb_crid":"7789677","chrome":"1","bidder":"pubmatic","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9434529400713884","hb_crid":"2662_193964_t23264694","chrome":"1","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9607805624641286","hb_crid":"2662_193964_t23264694","chrome":"1","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9566449202119514","hb_crid":"37945511","chrome":"0","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9641737147201368","hb_crid":"7847500","chrome":"1","bidder":"gumgum","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9788712011577424","hb_crid":"7847500","chrome":"1","bidder":"gumgum","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9600676911319158","hb_crid":"37945511","chrome":"1","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9106772990886496","hb_crid":"37945511","chrome":"1","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9574499195788858","hb_crid":"7789677","chrome":"1","bidder":"pubmatic","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9886758266646535","hb_crid":"7789677","chrome":"1","bidder":"pubmatic","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9646468120228351","hb_crid":"aix08s6b","chrome":"0","bidder":"ttd","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9547125229719087","hb_crid":"2662_193964_t23679780","chrome":"1","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9925746809165877","hb_crid":"7789677","chrome":"1","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9614203327662019","hb_crid":"7789677","chrome":"1","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9839773798303487","hb_crid":"wh7xvn9n","chrome":"0","bidder":"openx","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9181329067907518","hb_crid":"3658_136236_t24105193","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9100605361775728","hb_crid":"3658_136236_t24105193","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9579324888020072","hb_crid":"2662_193964_t23978906","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9577952074856009","hb_crid":"37945296","chrome":"1","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9685218316328997","hb_crid":"37945296","chrome":"0","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9566391811202729","hb_crid":"2662_193964_t23978916","chrome":"1","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.902772250961666","hb_crid":"3ul2y478","chrome":"0","bidder":"ttd","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9893048128342246","hb_crid":"7790437","chrome":"0","bidder":"yah_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9646030696922964","hb_crid":"7790437","chrome":"0","bidder":"yah_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9559735638027453","hb_crid":"39776927","chrome":"0","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.965274649107607","hb_crid":"tronq3zh","chrome":"0","bidder":"ttd","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9186337625178826","hb_crid":"8341_230212_t24311696","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9858538719556658","hb_crid":"7847504","chrome":"0","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9629629629629629","hb_crid":"7847504","chrome":"0","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9589472178515234","hb_crid":"2662_193964_t23679780","chrome":"1","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9797543657647284","hb_crid":"7847503","chrome":"1","bidder":"gumgum","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9625754147812972","hb_crid":"7847503","chrome":"1","bidder":"gumgum","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9563582870219026","hb_crid":"2662_193964_t22713182","chrome":"0","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9582278481012658","hb_crid":"2662_193964_t22713166","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9556634476871365","hb_crid":"2662_193964_t23679802","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9579797843210168","hb_crid":"37945296","chrome":"1","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9549829705316156","hb_crid":"39776927","chrome":"1","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9271365743492215","hb_crid":"7819627","chrome":"0","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9587020648967551","hb_crid":"7819627","chrome":"0","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9802618721907368","hb_crid":"2662_193964_t23264694","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9666602428213529","hb_crid":"2662_193964_t23264694","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9658787555210406","hb_crid":"2662_193964_t23978906","chrome":"0","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9573256397390868","hb_crid":"2662_193964_t23978906","chrome":"1","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"1.0","hb_crid":"24506129","chrome":"0","bidder":"opnx_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9697503057784672","hb_crid":"2662_193964_t23679780","chrome":"0","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9645899448805746","hb_crid":"2662_193964_t23445870","chrome":"0","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9185092318212902","hb_crid":"2662_193964_t23445872","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9614650441422095","hb_crid":"2662_193964_t23445872","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9539328196652622","hb_crid":"39776927","chrome":"1","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9174828323764495","hb_crid":"3ul2y478","chrome":"0","bidder":"ttd","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9985400206114737","hb_crid":"3657_17602_t23818165","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9950363714163457","hb_crid":"3657_17602_t23818165","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9207600281491907","hb_crid":"3658_136236_t24105193","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.912922132291376","hb_crid":"3658_136236_t24105193","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9554572864321608","hb_crid":"2662_193964_t23679780","chrome":"1","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9717341482047365","hb_crid":"2662_193964_t23679802","chrome":"0","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9911403831366387","hb_crid":"7784605","chrome":"0","bidder":"yah_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9651018946546","hb_crid":"7784605","chrome":"0","bidder":"yah_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9576939624265022","hb_crid":"2662_193964_t23978916","chrome":"1","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.913168330370573","hb_crid":"2662_193964_t23978916","chrome":"1","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9143148322358106","hb_crid":"7758135","chrome":"0","bidder":"share_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9628858170800985","hb_crid":"2662_193964_t22713168","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9770911541053037","hb_crid":"7847504","chrome":"1","bidder":"gumgum","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9619977255496588","hb_crid":"7847504","chrome":"1","bidder":"gumgum","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9313339888561127","hb_crid":"7819625","chrome":"1","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9543240973971453","hb_crid":"7819625","chrome":"1","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9573314938904217","hb_crid":"39776927","chrome":"0","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9595616024187453","hb_crid":"2662_193964_t23445872","chrome":"0","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9672496771921587","hb_crid":"7847503","chrome":"1","bidder":"gumgum","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9765347238682153","hb_crid":"7847503","chrome":"1","bidder":"gumgum","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9583223562885295","hb_crid":"37945511","chrome":"1","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9007527733755943","hb_crid":"37945511","chrome":"1","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.953364309069007","hb_crid":"2662_193964_t23679802","chrome":"1","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.975609756097561","hb_crid":"7784605","chrome":"1","bidder":"opnx_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9960083634290059","hb_crid":"7784605","chrome":"1","bidder":"opnx_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9586801876797336","hb_crid":"2662_193964_t23679780","chrome":"1","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9895002099958001","hb_crid":"7789677","chrome":"0","bidder":"pubmatic","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9773230088495575","hb_crid":"7789677","chrome":"0","bidder":"pubmatic","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.951791004578508","hb_crid":"2662_193964_t23679802","chrome":"1","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9228629705173373","hb_crid":"35329744","chrome":"0","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9033487612306017","hb_crid":"35329744","chrome":"0","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9982904263877715","hb_crid":"3657_17602_t23818165","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9941912869303956","hb_crid":"3657_17602_t23818165","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.992323283910816","hb_crid":"7789677","chrome":"0","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9614795800021649","hb_crid":"7789677","chrome":"0","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9536776404356871","hb_crid":"2662_193964_t23679802","chrome":"0","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.960021551724138","hb_crid":"2662_193964_t23445870","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9153395664235077","hb_crid":"2662_193964_t23445870","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9806807727690893","hb_crid":"2662_193964_t23978916","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9554646798498684","hb_crid":"2662_193964_t23978916","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9587948874010955","hb_crid":"7784605","chrome":"1","bidder":"yah_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.987710828265095","hb_crid":"7784605","chrome":"1","bidder":"yah_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9810333024604357","hb_crid":"2662_193964_t23679780","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9870804306523115","hb_crid":"7789677","chrome":"1","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9617425644822906","hb_crid":"7789677","chrome":"1","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9653520088462956","hb_crid":"588963096183819704","chrome":"1","bidder":"opnx_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9626781695423856","hb_crid":"2662_193964_t23679802","chrome":"1","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9716153127917834","hb_crid":"33996294","chrome":"1","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9829964103532968","hb_crid":"33996294","chrome":"1","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"1.0","hb_crid":"24506129","chrome":"0","bidder":"opnx_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9577433628318585","hb_crid":"2662_193964_t22713182","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9756719972779857","hb_crid":"7789677","chrome":"0","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9862424763542562","hb_crid":"7789677","chrome":"0","bidder":"pubm_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9644963571180757","hb_crid":"7847500","chrome":"1","bidder":"gumgum","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9793330201972757","hb_crid":"7847500","chrome":"1","bidder":"gumgum","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9675629534784465","hb_crid":"l2sh0d8a","chrome":"0","bidder":"ttd","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9064078439140338","hb_crid":"2662_193964_t23264694","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9587261680284936","hb_crid":"2662_193964_t23264694","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9026128266033254","hb_crid":"2662_193964_t23978906","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9785058977719528","hb_crid":"2662_193964_t23978906","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9501490800669042","hb_crid":"2662_193964_t23978906","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.953729750703269","hb_crid":"2662_193964_t23978916","chrome":"1","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9419616076784643","hb_crid":"52912199","chrome":"0","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9506583926138944","hb_crid":"52912199","chrome":"0","bidder":"ix_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9548545796556215","hb_crid":"2662_193964_t23978916","chrome":"0","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9545587015490842","hb_crid":"2662_193964_t23978906","chrome":"0","bidder":"tripl_ss","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.9584265394842358","hb_crid":"2662_193964_t23978906","chrome":"1","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"0","error_rate":"0.908247340212783","hb_crid":"2662_193964_t23978906","chrome":"1","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9561416960588867","hb_crid":"2662_193964_t23264763","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"},{"mobile":"1","error_rate":"0.9011417834947246","hb_crid":"2662_193964_t23264763","chrome":"0","bidder":"triplelift","report_date":"2025-08-29"}],"country":"TW","region":"TXG","coreExperiments":[{"variants":[{"value":"off","weight":100},{"value":"extrashort","weight":0},{"value":"short","weight":0},{"value":"medium","weight":0},{"value":"long","weight":0},{"value":"mix","weight":0}],"type":"weightedChoice","lookupKey":"ADC","key":"AdDurationControl","abgroup":"adc"},{"variants":[{"value":"b","weight":0},{"value":"w","weight":100},{"value":"g25","weight":0}],"type":"weightedChoice","lookupKey":"TCMB2","key":"TopCenterMobileBackground","abgroup":"tcmb2"},{"variants":[{"value":"animatedFooter","weight":50},{"value":"expandableFooter","weight":50},{"value":"inRecipeRecommendationDesktop","weight":50},{"value":"inRecipeRecommendationMobile","weight":50},{"value":"largeFormatsDesktop","weight":50},{"value":"largeFormatsMobile","weight":50},{"value":"nativeDesktopContent","weight":50},{"value":"nativeDesktopRecipe","weight":50},{"value":"nativeDesktopSidebar","weight":50},{"value":"nativeMobileContent","weight":50},{"value":"nativeMobileRecipe","weight":50},{"value":"nativeDesktopHeader","weight":50},{"value":"nativeDesktopBelowPost","weight":50},{"value":"nativeMobileHeader","weight":50},{"value":"nativeMobileBelowPost","weight":50},{"value":"outstreamDesktop","weight":50},{"value":"outstreamMobile","weight":50},{"value":"sponsorTileDesktop","weight":50},{"value":"sponsorTileMobile","weight":50},{"value":"expandableCatalogAdsDesktop","weight":50},{"value":"expandableCatalogAdsMobile","weight":50},{"value":"miniscroller","weight":50},{"value":"interscroller","weight":50}],"type":"multivalueBernoulliTrial","lookupKey":"AT1","key":"AdType","abgroup":"at1"},{"variants":[{"value":0.5,"weight":90},{"value":1,"weight":10}],"type":"weightedChoice","lookupKey":"RRAV2","key":"ReduceRenderAboveViewport","abgroup":"rrav2"},{"variants":[{"value":"1,8","weight":0},{"value":"","weight":100}],"type":"weightedChoice","lookupKey":"ATD2","key":"AdTypeDays","abgroup":"atd2"},{"variants":[{"value":50,"weight":34},{"value":250,"weight":33},{"value":500,"weight":33}],"type":"weightedChoice","lookupKey":"MDLE1","key":"mdle","abgroup":"mdle1"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"RVPS","key":"ReducedVideoPlayerSize","abgroup":"rvps"},{"variants":[{"weight":90}],"type":"bernoulliTrial","lookupKey":"WL","key":"WakeLock","abgroup":"wl"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"PLFX","key":"PlaylistFix","abgroup":"plfx"},{"variants":[{"weight":95}],"type":"bernoulliTrial","lookupKey":"DELLOAD","key":"EnableDelayLoading","abgroup":"delload"},{"variants":[{"weight":99.5}],"type":"bernoulliTrial","lookupKey":"AMZN","key":"Amazon","abgroup":"amzn"},{"variants":[{"value":1.5,"weight":25},{"value":2,"weight":25},{"value":3,"weight":25},{"value":4,"weight":25}],"type":"weightedChoice","lookupKey":"FTO","key":"FloorBootstrap","abgroup":"fto"},{"variants":[{"value":1.5,"weight":25},{"value":2,"weight":25},{"value":3,"weight":25},{"value":4,"weight":25}],"type":"weightedChoice","lookupKey":"MTO","key":"MarmaladeBootstrap","abgroup":"mto"},{"variants":[{"weight":99}],"type":"bernoulliTrial","lookupKey":"OWSO","key":"OutstreamWithSOExperiment","abgroup":"owso"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"PBM","key":"Playbackmethod","abgroup":"pbm"},{"variants":[{"value":30,"weight":100},{"value":15,"weight":0},{"value":10,"weight":0}],"type":"weightedChoice","lookupKey":"VMAXDUR","key":"VideoDuration","abgroup":"vmaxdur"},{"variants":[{"value":"all","weight":0},{"value":"adx","weight":100},{"value":"off","weight":0}],"type":"weightedChoice","lookupKey":"INTERS","key":"Interstitial","abgroup":"inters"},{"variants":[{"value":"all","weight":0},{"value":"adx","weight":90},{"value":"off","weight":10}],"type":"weightedChoice","lookupKey":"INTERS5","key":"InterstitialAlt","abgroup":"inters5"},{"variants":[{"value":"off","weight":50},{"value":"45","weight":45},{"value":"4","weight":4},{"value":"1","weight":1}],"type":"weightedChoice","lookupKey":"AYP","key":"ayp","abgroup":"ayp"},{"variants":[{"value":"both","weight":0},{"value":"client","weight":2},{"value":"server","weight":98}],"type":"weightedChoice","lookupKey":"KRGODRVID","key":"KargoVideo","abgroup":"krgodrvid"},{"variants":[{"value":"none","weight":98.9},{"value":"roxot","weight":0},{"value":"ay","weight":1},{"value":"generic","weight":0.1}],"type":"weightedChoice","lookupKey":"PBA2","key":"Analytics2","abgroup":"pba2"},{"variants":[{"value":0,"weight":20},{"value":5,"weight":20},{"value":10,"weight":20},{"value":25,"weight":20},{"value":50,"weight":20}],"type":"weightedChoice","lookupKey":"KWL","key":"KeywordLength","abgroup":"kwl"},{"variants":[{"value":1,"weight":34},{"value":2,"weight":33},{"value":3,"weight":33}],"type":"weightedChoice","lookupKey":"KPML","key":"KeywordPhraseMaxLength","abgroup":"kpml"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"RCB","key":"RaptiveCreativeBlock","abgroup":"rcb"},{"variants":[{"value":"both","weight":50},{"value":"client","weight":0},{"value":"server","weight":50}],"type":"weightedChoice","lookupKey":"YAHOODR","key":"YahooSSP","abgroup":"yahoodr"},{"variants":[{"value":"both","weight":99},{"value":"server","weight":0},{"value":"client","weight":1}],"type":"weightedChoice","lookupKey":"IXDR","key":"IndexExchangeDoubleRequest","abgroup":"ixdr"},{"variants":[{"value":"both","weight":0},{"value":"client","weight":100},{"value":"server","weight":0}],"type":"weightedChoice","lookupKey":"YAHOODR1","key":"YahooSSP1","abgroup":"yahoodr1"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"LOGFLTR","key":"LoggerFilter","abgroup":"logfltr"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"RPM","key":"RaptivePlayerMobile","abgroup":"rpm"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"RPD","key":"RaptivePlayerDesktop","abgroup":"rpd"},{"variants":[{"value":10,"weight":85},{"value":15,"weight":5},{"value":20,"weight":5},{"value":25,"weight":5}],"type":"weightedChoice","lookupKey":"RPSPDBT","key":"staleBufferTime","abgroup":"rpspdbt"},{"variants":[{"value":"tc","weight":0},{"value":"bl","weight":0},{"value":"br","weight":0},{"value":"off","weight":100}],"type":"weightedChoice","lookupKey":"SPLTV2","key":"VideoCollapsedLocations","abgroup":"spltv2"},{"variants":[{"value":900000,"weight":0,"abvalue":"900"},{"value":600000,"weight":0,"abvalue":"600"},{"value":300000,"weight":0,"abvalue":"300"},{"value":10000,"weight":0,"abvalue":"10"},{"value":-1,"weight":0,"abvalue":"tdoc"},{"value":0,"weight":100}],"type":"weightedChoice","lookupKey":"RPTD","key":"RaptiveTearDownPlayer","abgroup":"rptd"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"RPM_TEST","key":"RaptivePlayerMobile_test","abgroup":"rpm_test"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"RPD_TEST","key":"RaptivePlayerDesktop_test","abgroup":"rpd_test"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"RPM_TEST2","key":"RaptivePlayerMobile_test2","abgroup":"rpm_test2"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"RPD_TEST2","key":"RaptivePlayerDesktop_test2","abgroup":"rpd_test2"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"FLDG","key":"FledgeGPT","abgroup":"fldg"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"FLDGLOG","key":"FledgeLogging","abgroup":"fldglog"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"AED1","key":"AdExpansion","abgroup":"aed1"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"ESSA","key":"EnhancedStickySidebarAds","abgroup":"essa"},{"variants":[{"value":50,"weight":40},{"value":1000,"weight":20},{"value":3000,"weight":20},{"value":5000,"weight":20}],"type":"weightedChoice","lookupKey":"DEFTIMER3","key":"DelayLoading","abgroup":"deftimer3"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"WVTLS","key":"WebVitals","abgroup":"wvtls"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"WVTLSCLS","key":"WebVitals_CLSRefactor","abgroup":"wvtlscls"},{"variants":[{"weight":1}],"type":"bernoulliTrial","lookupKey":"SENS_OFF","key":"SensOff","abgroup":"sens_off"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"RTBF","key":"RtbHouseExperiment","abgroup":"rtbf"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"SAB","key":"BidLimit","abgroup":"sab"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"DGC","key":"DelayGamCall","abgroup":"dgc"},{"variants":[{"weight":95}],"type":"bernoulliTrial","lookupKey":"JWB","key":"JwBoost","abgroup":"jwb"},{"variants":[{"weight":10}],"type":"bernoulliTrial","lookupKey":"LOGCLS","key":"LayoutShift","abgroup":"logcls"},{"variants":[{"value":5000,"weight":40,"abvalue":"5s"},{"value":10000,"weight":40,"abvalue":"10s"},{"value":15000,"weight":20,"abvalue":"15s"}],"type":"weightedChoice","lookupKey":"VAST_TO","key":"VastTimeout","abgroup":"vast_to"},{"variants":[{"value":15000,"weight":60,"abvalue":"15s"},{"value":18000,"weight":20,"abvalue":"18s"},{"value":20000,"weight":20,"abvalue":"20s"}],"type":"weightedChoice","lookupKey":"VASTTOISV","key":"VastTimeoutISV","abgroup":"vasttoisv"},{"variants":[{"value":"mOinGM9MTu5v-Lto835XLhlrSPY","weight":85,"abvalue":"main"},{"value":"HNS5BPofqNhjJ0uaex6oavjNklg","weight":5,"abvalue":"1"},{"value":"8bGsXqcT6wQIoFOgjoW97C-Xeb8","weight":5,"abvalue":"2"},{"value":"wyN88rwU6FImxcXgha7IWE-FzsE","weight":5,"abvalue":"test"}],"type":"weightedChoice","lookupKey":"CNFTP","key":"ConfiantProperty","abgroup":"cnftp"},{"variants":[{"value":"ct","weight":10},{"value":"rt","weight":80},{"value":"both","weight":10}],"type":"weightedChoice","lookupKey":"CB","key":"CreativeBlocking","abgroup":"cb8"},{"variants":[{"value":0,"weight":25},{"value":1000,"weight":25},{"value":2000,"weight":25},{"value":3000,"weight":25}],"type":"weightedChoice","lookupKey":"HBTT","key":"HBTTracking","abgroup":"hbtt"},{"variants":[{"value":3000,"weight":80,"abvalue":"3s"},{"value":2000,"weight":10,"abvalue":"2s"},{"value":1000,"weight":10,"abvalue":"1s"}],"type":"weightedChoice","lookupKey":"VASTTOOSV","key":"VastTimeoutOSV","abgroup":"vasttoosv"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"SRE","key":"SlotResize","abgroup":"sre"},{"variants":[{"weight":25}],"type":"bernoulliTrial","lookupKey":"ADDENS","key":"AdDensity","abgroup":"addens"},{"variants":[{"weight":99}],"type":"bernoulliTrial","lookupKey":"BMETRICS","key":"BrandMetrics","abgroup":"bmetrics"},{"variants":[{"weight":95}],"type":"bernoulliTrial","lookupKey":"REBUILDSLOT","key":"RefreshRebuild","abgroup":"rebuildslot"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"NLSENTRCKR","key":"NielsenTracker","abgroup":"nlsentrckr"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"VADV","key":"AdvancePlaylistExperiment","abgroup":"vadv"},{"variants":[{"weight":95}],"type":"bernoulliTrial","lookupKey":"TPCAPI","key":"TopicsAPI","abgroup":"tpcapi"},{"variants":[{"weight":10}],"type":"bernoulliTrial","lookupKey":"CRTVMON","key":"CreativeMonitoring","abgroup":"crtvmon"},{"variants":[{"value":"1.00","weight":25},{"value":"1.50","weight":25},{"value":"2.00","weight":25},{"value":"2.50","weight":25}],"type":"weightedChoice","lookupKey":"FAF","key":"FasterAdsFloors","abgroup":"faf"},{"variants":[{"value":700,"weight":50},{"value":500,"weight":50}],"type":"weightedChoice","lookupKey":"ESSAM","key":"EnhancedStickySidebarAdsMargin","abgroup":"essam"},{"variants":[{"value":"rubi","weight":0},{"value":"rapml","weight":1},{"value":"cm","weight":0},{"value":"fbmag","weight":0},{"value":"fbrap","weight":98},{"value":"none","weight":1}],"type":"weightedChoice","lookupKey":"FLRML1","key":"Floors","abgroup":"flrml1"},{"variants":[{"value":"1_1","weight":19},{"value":"1_2","weight":19},{"value":"1_3","weight":19},{"value":"1_4","weight":19},{"value":"1_5","weight":19},{"value":"off","weight":5}],"type":"weightedChoice","lookupKey":"TTDDEALFLR","key":"TTDDealFloor","abgroup":"ttddealflr"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"AMZN_HOLD_LOAD","key":"AmazonHoldLoad","abgroup":"amzn_hold_load"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"RMOS1","key":"OneVideoStream","abgroup":"rmos1"},{"variants":[{"value":900000,"weight":5,"abvalue":"900"},{"value":600000,"weight":5,"abvalue":"600"},{"value":300000,"weight":5,"abvalue":"300"},{"value":-1,"weight":5,"abvalue":"tdoc"},{"value":0,"weight":80}],"type":"weightedChoice","lookupKey":"MGTDTW","key":"TearDownPlayer","abgroup":"mgtdtw"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"AMZN_HOLD_DISP","key":"AmazonHoldDisplay","abgroup":"amzn_hold_disp"},{"variants":[{"weight":95}],"type":"bernoulliTrial","lookupKey":"HCGP","key":"HemCaptureGatedPrint","abgroup":"hcgp"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"DAJTO","key":"DisableAjaxTimeout","abgroup":"dajto"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"SMAD300","key":"RemoveLargeSidebar","abgroup":"smad300"},{"variants":[{"value":0,"weight":85,"abvalue":"0s"},{"value":1000,"weight":5,"abvalue":"1s"},{"value":2000,"weight":5,"abvalue":"2s"},{"value":3000,"weight":5,"abvalue":"3s"}],"type":"weightedChoice","lookupKey":"SOCBDE","key":"StickyOutstreamCloseButtonTimeout","abgroup":"socbde"},{"variants":[{"value":10000,"weight":20,"abvalue":"10"},{"value":15000,"weight":60,"abvalue":"15"},{"value":20000,"weight":20,"abvalue":"20"}],"type":"weightedChoice","lookupKey":"REQTO","key":"JwRequestTimeout","abgroup":"reqTo"},{"variants":[{"weight":3}],"type":"bernoulliTrial","lookupKey":"ADDUR","key":"LogAdDuration","abgroup":"addur"},{"variants":[{"value":"ix","weight":99.5},{"value":"mn","weight":96},{"value":"ox","weight":99},{"value":"pu","weight":95},{"value":"un","weight":90},{"value":"ma","weight":99},{"value":"sh","weight":90},{"value":"st","weight":90},{"value":"sb","weight":99},{"value":"sv","weight":75},{"value":"tl","weight":99},{"value":"yh","weight":0},{"value":"mg","weight":99},{"value":"xr","weight":99},{"value":"ot","weight":75},{"value":"ax","weight":100},{"value":"ch","weight":100},{"value":"cr","weight":100},{"value":"gg","weight":100},{"value":"kg","weight":100},{"value":"td","weight":100},{"value":"ym","weight":90},{"value":"im","weight":95}],"type":"multivalueBernoulliTrial","lookupKey":"DOBA","key":"DisplayOpenBidderExperiment","abgroup":"doba"},{"variants":[{"value":"ax","weight":100},{"value":"ix","weight":95},{"value":"mn","weight":99},{"value":"ox","weight":90},{"value":"pu","weight":95},{"value":"un","weight":95},{"value":"ma","weight":95},{"value":"sx","weight":100},{"value":"tl","weight":99},{"value":"yh","weight":80},{"value":"sh","weight":60},{"value":"ym","weight":55},{"value":"mg","weight":99},{"value":"xr","weight":99},{"value":"gg","weight":95},{"value":"ot","weight":75},{"value":"sv","weight":75},{"value":"im","weight":95}],"type":"multivalueBernoulliTrial","lookupKey":"VOBA","key":"VideoOpenBidderExperiment","abgroup":"voba"},{"variants":[{"value":"ix","weight":80},{"value":"ma","weight":80},{"value":"mn","weight":90},{"value":"ox","weight":80},{"value":"pu","weight":80},{"value":"sh","weight":90},{"value":"tl","weight":90},{"value":"ts","weight":90}],"type":"multivalueBernoulliTrial","lookupKey":"UID1BS","key":"UID1BidderSupression","abgroup":"uid1bs"},{"variants":[{"weight":95}],"type":"bernoulliTrial","lookupKey":"TTDUID1BS","key":"TTDUID1BidderSupression","abgroup":"ttduid1bs"},{"variants":[{"value":2,"weight":97},{"value":3,"weight":3}],"type":"weightedChoice","lookupKey":"OSP","key":"OutstreamPlacementExperiment","abgroup":"osp"},{"variants":[{"value":2,"weight":0},{"value":3,"weight":100}],"type":"weightedChoice","lookupKey":"OSP2","key":"OutstreamPlacementExperiment2","abgroup":"osp2"},{"variants":[{"value":0.8,"weight":25},{"value":1,"weight":25},{"value":1.2,"weight":25},{"value":1.4,"weight":25}],"type":"weightedChoice","lookupKey":"FLRMLTP","key":"SingleFloorMultiplier","abgroup":"flrmltp"},{"variants":[{"value":1.25,"weight":5},{"value":1.3,"weight":15},{"value":1.35,"weight":59},{"value":1.4,"weight":15},{"value":1.45,"weight":5},{"value":"off","weight":1}],"type":"weightedChoice","lookupKey":"BPFLMULT2","key":"LazyFloorMultiplier","abgroup":"bpflmult3"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"MGNCRBN","key":"MagniteCarbon","abgroup":"mgncrbn"},{"variants":[{"weight":90}],"type":"bernoulliTrial","lookupKey":"TS","key":"TrafficShaping","abgroup":"ts"},{"variants":[{"weight":10}],"type":"bernoulliTrial","lookupKey":"ADLIFECYC","key":"LogAdLifeCycle","abgroup":"adlifecyc"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"SOFC","key":"StickyOutstreamFooterCollision","abgroup":"sofc"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"FAN","key":"FooterAnchorAd","abgroup":"fan"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"NOSVP","key":"OutstreamRendererExperiment","abgroup":"nosvp"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"SOSPP","key":"StickyOutstreamOnStickyPlayerPages","abgroup":"sospp"},{"variants":[{"value":60000,"weight":34},{"value":90000,"weight":33},{"value":120000,"weight":33}],"type":"weightedChoice","lookupKey":"OPR","key":"OutstreamPlayerRefreshFailsafe","abgroup":"opr"},{"variants":[{"weight":1}],"type":"bernoulliTrial","lookupKey":"SIDP","key":"SharedIdPlugin","abgroup":"sidp"},{"variants":[{"weight":1}],"type":"bernoulliTrial","lookupKey":"DOFRE","key":"DisplayBackupRenderer","abgroup":"dofre"},{"variants":[{"value":"strict","weight":0},{"value":"relaxed","weight":100},{"value":"off","weight":0}],"type":"weightedChoice","lookupKey":"DCO","key":"DemandChain","abgroup":"dco"},{"variants":[{"value":1.3,"weight":25},{"value":1.5,"weight":25},{"value":1.7,"weight":25},{"value":"off","weight":25}],"label":"RPBS","type":"weightedChoice","lookupKey":"OAT","key":"RPBSOptimizedActionTime","abgroup":"oat"},{"variants":[{"value":100,"weight":25},{"value":200,"weight":50,"abvalue":"off"},{"value":300,"weight":25}],"type":"weightedChoice","lookupKey":"S2SBUFF","key":"S2SBuffer","abgroup":"s2sbuff"},{"variants":[{"value":0,"weight":85},{"value":1,"weight":5},{"value":500,"weight":5},{"value":1000,"weight":5}],"type":"weightedChoice","lookupKey":"ADT","key":"AuctionDelay","abgroup":"adt"},{"variants":[{"value":400,"weight":33},{"value":500,"weight":34},{"value":600,"weight":33}],"type":"weightedChoice","lookupKey":"ADT3","key":"AuctionDelay_2","abgroup":"adt3"},{"variants":[{"weight":25,"value":"on5"},{"weight":25,"value":"on7"},{"weight":25,"value":"on10"},{"weight":25,"value":"off"}],"type":"weightedChoice","lookupKey":"TCKSCROLL","key":"TrackScrollExperiment","abgroup":"tckscroll"},{"variants":[{"weight":90,"value":[5,7,10]},{"weight":10,"value":"off"}],"type":"weightedChoice","lookupKey":"TCKSCROLL2","key":"TrackScrollExperiment2","abgroup":"tckscroll2"},{"variants":[{"value":1,"weight":97},{"value":1.1,"weight":1},{"value":1.2,"weight":1},{"value":1.3,"weight":1}],"type":"weightedChoice","lookupKey":"REFVIDFLR","key":"FloorsInstreamRefresh","abgroup":"refvidflr"},{"variants":[{"value":0.4,"weight":25},{"value":0.5,"weight":25},{"value":0.6,"weight":25},{"value":0.7,"weight":25}],"type":"weightedChoice","lookupKey":"SESFLRSO","key":"SessionFloorStickyOutstreamPercentileExperiment","abgroup":"sesflrso"},{"variants":[{"value":0.6,"weight":10},{"value":0.7,"weight":10},{"value":0.75,"weight":10},{"value":0.8,"weight":50},{"value":0.85,"weight":10},{"value":0.9,"weight":10}],"type":"weightedChoice","lookupKey":"SESFLRDIS","key":"SessionFloorDisplayPercentileExperiment","abgroup":"sesflrdis"},{"variants":[{"value":0.6,"weight":20},{"value":0.7,"weight":60},{"value":0.8,"weight":20}],"type":"weightedChoice","lookupKey":"SESFLRVID2","key":"SessionFloorVideoPercentileExperiment","abgroup":"sesflrvid2"},{"variants":[{"value":0,"weight":5},{"value":1.1,"weight":10},{"value":1.2,"weight":10},{"value":1.3,"weight":10},{"value":1.4,"weight":10},{"value":"ml","weight":55}],"type":"weightedChoice","lookupKey":"REFSOFLR","key":"FloorsStickyOutstreamRefresh","abgroup":"refsoflr"},{"variants":[{"value":0,"weight":33},{"value":1,"weight":33},{"value":1.5,"weight":34}],"type":"weightedChoice","lookupKey":"SOCON","key":"SuppressOutreamSlowConnection","abgroup":"socon"},{"variants":[{"weight":25}],"type":"bernoulliTrial","lookupKey":"UPL","key":"UserPageDataLogging","abgroup":"upl"},{"variants":[{"weight":1}],"type":"bernoulliTrial","lookupKey":"AOS","key":"AdditionalOutstreamUnitsExperiment","abgroup":"aos"},{"variants":[{"weight":10}],"type":"bernoulliTrial","lookupKey":"DATAPRIV","key":"UserPageDataPrivacyLogging","abgroup":"datapriv"},{"variants":[{"value":500,"weight":25},{"value":1000,"weight":25},{"value":1500,"weight":25},{"value":2000,"weight":25}],"type":"weightedChoice","lookupKey":"FAITE","key":"FasterAdsInitialTimeoutExperiment","abgroup":"faite"},{"variants":[{"value":2000,"weight":10},{"value":2100,"weight":15},{"value":2200,"weight":50},{"value":2300,"weight":15},{"value":2400,"weight":10}],"type":"weightedChoice","lookupKey":"ITO_DF","key":"InitialTimeoutDesktopFastExperiment","abgroup":"ito_df"},{"variants":[{"value":2600,"weight":10},{"value":2700,"weight":15},{"value":2800,"weight":50},{"value":2900,"weight":15},{"value":3000,"weight":10}],"type":"weightedChoice","lookupKey":"ITO_DS","key":"InitialTimeoutDesktopSlowExperiment","abgroup":"ito_ds"},{"variants":[{"value":2400,"weight":10},{"value":2500,"weight":15},{"value":2600,"weight":50},{"value":2700,"weight":15},{"value":2800,"weight":10}],"type":"weightedChoice","lookupKey":"ITO_DN","key":"InitialTimeoutDesktopUnknownExperiment","abgroup":"ito_dn"},{"variants":[{"value":"off","weight":90},{"value":"nobid","weight":5},{"value":"always","weight":4},{"value":"bid","weight":1}],"label":"RPBS","type":"weightedChoice","lookupKey":"RRB","key":"RPBSReRequestBidders","abgroup":"rrb"},{"variants":[{"value":2400,"weight":10},{"value":2500,"weight":15},{"value":2600,"weight":50},{"value":2700,"weight":15},{"value":2800,"weight":10}],"type":"weightedChoice","lookupKey":"ITO_MF","key":"InitialTimeoutMobileFastExperiment","abgroup":"ito_mf"},{"variants":[{"value":2600,"weight":10},{"value":2700,"weight":15},{"value":2800,"weight":50},{"value":2900,"weight":15},{"value":3000,"weight":10}],"type":"weightedChoice","lookupKey":"ITO_MS","key":"InitialTimeoutMobileSlowExperiment","abgroup":"ito_ms"},{"variants":[{"value":2600,"weight":10},{"value":2700,"weight":15},{"value":2800,"weight":50},{"value":2900,"weight":15},{"value":3000,"weight":10}],"type":"weightedChoice","lookupKey":"ITO_MN","key":"InitialTimeoutMobileUnknownExperiment","abgroup":"ito_mn"},{"variants":[{"value":"on","weight":0},{"value":"off","weight":60},{"value":"vpr","weight":30},{"value":"dbc","weight":10}],"type":"weightedChoice","lookupKey":"IROE","key":"InstreamRerequestOnError","abgroup":"iroe"},{"variants":[{"value":"on","weight":0},{"value":"off","weight":5},{"value":"vpr","weight":0},{"value":"vpr2","weight":95}],"type":"weightedChoice","lookupKey":"RIROE","key":"RaptiveInstreamRerequestOnError","abgroup":"riroe"},{"variants":[{"value":"on","weight":0},{"value":"off","weight":5},{"value":"vpr","weight":0},{"value":"vpr2","weight":95},{"value":"dbc","weight":0}],"type":"weightedChoice","lookupKey":"IROE2","key":"InstreamRerequestOnError2","abgroup":"iroe2"},{"variants":[{"value":"id5Id","weight":5},{"value":"identityLink","weight":1},{"value":"pairId","weight":1},{"value":"unifiedId","weight":90},{"value":"unifiedId2","weight":1},{"value":"sharedId","weight":1},{"value":"criteo","weight":5},{"value":"connectId","weight":5},{"value":"fabrickId","weight":99},{"value":"FTrackId","weight":95},{"value":"33acrossId","weight":5},{"value":"liveIntentId","weight":1},{"value":"linkedInAdsId","weight":10},{"value":"lotamePanoramaId","weight":5},{"value":"raptiveDcn1Uid1Id","weight":5},{"value":"merkleId","weight":25},{"value":"merkuryId","weight":5},{"value":"teadsId","weight":10}],"type":"multivalueBernoulliTrial","lookupKey":"IDHO","key":"IDHO","abgroup":"idho"},{"variants":[{"value":"all","weight":95},{"value":"li_iiq","weight":1},{"value":"li_id5","weight":1},{"value":"li_only","weight":0.5},{"value":"iiq_id5","weight":1},{"value":"iiq_only","weight":0.5},{"value":"id5_only","weight":0.5},{"value":"none","weight":0.5}],"type":"weightedChoice","lookupKey":"AUDT","key":"AudienceTargeting","abgroup":"audt"},{"variants":[{"value":"US","weight":90},{"value":"CA","weight":90}],"type":"multivalueBernoulliTrial","lookupKey":"UIDCOHO","key":"UidCoHO","abgroup":"uidcoho"},{"variants":[{"weight":95}],"type":"bernoulliTrial","lookupKey":"IDGUID3","key":"IdGraphUid2","abgroup":"idguid3"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"3pgaun","key":"3pgaun","abgroup":"3pgaun"},{"variants":[{"weight":98}],"type":"bernoulliTrial","lookupKey":"IDGLR","key":"IdGraphLiveRamp","abgroup":"idglr"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"AYUSRMC","key":"AYUserSyncReplaceMacro","abgroup":"ayusrmc"},{"variants":[{"value":"aidem","weight":100},{"value":"amx","weight":99},{"value":"appnexus","weight":1},{"value":"connatix","weight":75},{"value":"conversant","weight":1},{"value":"criteo","weight":1},{"value":"gridvid","weight":1},{"value":"gumgum","weight":50},{"value":"improvedigital","weight":75},{"value":"ix","weight":0.5},{"value":"openx","weight":1},{"value":"pubmatic","weight":1},{"value":"resetdigital","weight":100},{"value":"rubicon","weight":1},{"value":"sharethrough","weight":1},{"value":"stackadapt","weight":1},{"value":"triplelift","weight":1},{"value":"ttd","weight":1},{"value":"unruly","weight":1},{"value":"undertone","weight":10},{"value":"yahoossp","weight":1},{"value":"kargo","weight":1},{"value":"33across","weight":100},{"value":"onetag","weight":10},{"value":"adform","weight":95},{"value":"nativo","weight":1}],"type":"multivalueBernoulliTrial","lookupKey":"VBHO2","key":"VBHO2","abgroup":"vbho3"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"VBHORISE","key":"VBHORise","abgroup":"vbhorise"},{"variants":[{"value":"33across","weight":25},{"value":"aidem","weight":100},{"value":"amx","weight":1},{"value":"appnexus","weight":1},{"value":"connatix","weight":75},{"value":"conversant","weight":10},{"value":"criteo","weight":1},{"value":"grid","weight":10},{"value":"gumgum","weight":5},{"value":"kargo","weight":1},{"value":"improvedigital","weight":75},{"value":"ix","weight":0.5},{"value":"nativo","weight":1},{"value":"openx","weight":1},{"value":"ozone","weight":1},{"value":"pubmatic","weight":1},{"value":"resetdigital","weight":100},{"value":"rtbhouse","weight":100},{"value":"rubicon","weight":1},{"value":"sharethrough","weight":5},{"value":"stackadapt","weight":1},{"value":"teads","weight":1},{"value":"triplelift","weight":0.5},{"value":"ttd","weight":1},{"value":"undertone","weight":1},{"value":"unruly","weight":1},{"value":"yahoossp","weight":1},{"value":"yieldmo","weight":1},{"value":"adform","weight":95},{"value":"flipp","weight":100},{"value":"ogury","weight":1}],"type":"multivalueBernoulliTrial","lookupKey":"HBHO2","key":"HBHO2","abgroup":"hbho3"},{"label":"RPBS","variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"BPS","key":"BiddersPerStage","abgroup":"bps"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"HBHORISE","key":"HBHORise","abgroup":"hbhorise"},{"variants":[{"value":"af","weight":6},{"value":"ef","weight":6},{"value":"inrr","weight":6},{"value":"lf","weight":6},{"value":"ntvs","weight":6},{"value":"ntvc","weight":6},{"value":"ntvr","weight":6},{"value":"ntvh","weight":6},{"value":"ntvbp","weight":6},{"value":"osv","weight":6},{"value":"st","weight":6},{"value":"eca","weight":6},{"value":"msr","weight":6},{"value":"intr","weight":6},{"value":"slh","weight":6},{"value":"control","weight":10}],"type":"weightedChoice","lookupKey":"ATDH2","key":"AdTypeDaysHoldout2","abgroup":"atdh2"},{"variants":[{"value":["animatedFooter"],"weight":6},{"value":["expandableFooter"],"weight":6},{"value":["inRecipeRecommendationDesktop","inRecipeRecommendationMobile"],"weight":6},{"value":["largeFormatsDesktop","largeFormatsMobile"],"weight":6},{"value":["nativeDesktopSidebar"],"weight":6},{"value":["nativeDesktopContent","nativeMobileContent"],"weight":6},{"value":["nativeDesktopRecipe","nativeMobileRecipe"],"weight":6},{"value":["nativeDesktopHeader","nativeMobileHeader"],"weight":6},{"value":["nativeDesktopBelowPost","nativeMobileBelowPost"],"weight":6},{"value":["outstreamDesktop","outstreamMobile"],"weight":6},{"value":["sponsorTileDesktop","sponsorTileMobile"],"weight":6},{"value":["expandableCatalogAdsDesktop","expandableCatalogAdsMobile"],"weight":6},{"value":["miniscroller"],"weight":6},{"value":["interscroller"],"weight":6},{"value":["skylineHeader"],"weight":6},{"value":["control"],"weight":10}],"type":"weightedChoice","lookupKey":"ATDH","key":"AdTypeDaysHoldout","abgroup":"atdh"},{"variants":[{"value":"animatedFooter","weight":0},{"value":"expandableFooter","weight":0},{"value":"miniscroller","weight":0},{"value":"interscroller","weight":0}],"type":"multivalueBernoulliTrial","lookupKey":"ATHMB","key":"AdTypeHoldout","abgroup":"athmb"},{"variants":[{"value":"33across","weight":0},{"value":"appnexus","weight":0},{"value":"conversant","weight":0},{"value":"criteo","weight":0},{"value":"grid","weight":0},{"value":"gridvid","weight":0},{"value":"gumgum","weight":0},{"value":"kargo","weight":0},{"value":"improvedigital","weight":100},{"value":"ix","weight":0},{"value":"nativo","weight":0},{"value":"openx","weight":0},{"value":"ogury","weight":0},{"value":"pubmatic","weight":0},{"value":"resetdigital","weight":0},{"value":"rtbhouse","weight":0},{"value":"rubicon","weight":0},{"value":"sharethrough","weight":0},{"value":"teads","weight":0},{"value":"triplelift","weight":0},{"value":"ttd","weight":0},{"value":"undertone","weight":0},{"value":"unruly","weight":0},{"value":"yahoossp","weight":0},{"value":"yieldmo","weight":0},{"value":"onetag","weight":0}],"type":"multivalueBernoulliTrial","lookupKey":"ALLBHO","key":"AllBidderHO","abgroup":"allbho"},{"variants":[{"value":"amzn","weight":25},{"value":"gumgum","weight":25},{"value":"kargo","weight":25},{"value":"sharethrough","weight":25},{"value":"teads","weight":25},{"value":"triplelift","weight":25},{"value":"undertone","weight":25},{"value":"yieldmo","weight":25}],"type":"multivalueBernoulliTrial","lookupKey":"SFBHO","key":"SFBHO","abgroup":"sfbho"},{"variants":[{"value":"33across","weight":100},{"value":"appnexus","weight":5},{"value":"amx","weight":100},{"value":"connatix","weight":100},{"value":"conversant","weight":100},{"value":"grid","weight":100},{"value":"gumgum","weight":2},{"value":"improve_ss","weight":100},{"value":"pubm_ss","weight":100},{"value":"resetdigital","weight":100},{"value":"under_ss","weight":100},{"value":"unruly","weight":100},{"value":"yieldmo","weight":100},{"value":"adform","weight":100},{"value":"aidem_ss","weight":100},{"value":"gridnat","weight":100},{"value":"rubi_ss","weight":100},{"value":"flipp","weight":100},{"value":"rise","weight":100},{"value":"tripl_ss","weight":100},{"value":"rubiv_ss","weight":100},{"value":"opnx_ss","weight":100},{"value":"share_ss","weight":100},{"value":"crit_ss","weight":100},{"value":"ntvo_ss","weight":100},{"value":"ogury","weight":100}],"type":"multivalueBernoulliTrial","lookupKey":"PBS2S","key":"S2S","abgroup":"pbs2s"},{"variants":[{"value":"33across","weight":100},{"value":"appnexus","weight":5},{"value":"connatix","weight":100},{"value":"conversant","weight":100},{"value":"grid","weight":100},{"value":"gumgum","weight":2},{"value":"improve_ss","weight":100},{"value":"pubm_ss","weight":100},{"value":"resetdigital","weight":100},{"value":"under_ss","weight":100},{"value":"unruly","weight":100},{"value":"yieldmo","weight":100},{"value":"adform","weight":100},{"value":"aidem_ss","weight":100},{"value":"gridnat","weight":100},{"value":"rubi_ss","weight":100},{"value":"flipp","weight":100},{"value":"rise","weight":100},{"value":"amx","weight":100},{"value":"tripl_ss","weight":100},{"value":"rubiv_ss","weight":100},{"value":"opnx_ss","weight":100},{"value":"sharethrough","weight":100},{"value":"share_ss","weight":100},{"value":"crit_ss","weight":100},{"value":"ntvo_ss","weight":100},{"value":"ogury","weight":100}],"type":"multivalueBernoulliTrial","lookupKey":"PBS2S4","key":"S2S4","abgroup":"pbs2s4"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"EUE","key":"EUEndpoint","abgroup":"eue"},{"variants":[{"value":"33across","weight":100},{"value":"appnexus","weight":5},{"value":"conversant","weight":100},{"value":"grid","weight":100},{"value":"gumgum","weight":2},{"value":"improve_ss","weight":100},{"value":"openx","weight":1},{"value":"pubm_ss","weight":100},{"value":"resetdigital","weight":100},{"value":"under_ss","weight":100},{"value":"unruly","weight":100},{"value":"yieldmo","weight":100},{"value":"adform","weight":100},{"value":"connatix","weight":100},{"value":"aidem_ss","weight":100},{"value":"gridnat","weight":100},{"value":"rubi_ss","weight":100},{"value":"flipp","weight":100},{"value":"rise","weight":100},{"value":"amx","weight":100},{"value":"tripl_ss","weight":100},{"value":"rubiv_ss","weight":100},{"value":"opnx_ss","weight":100},{"value":"share_ss","weight":100},{"value":"crit_ss","weight":100},{"value":"ttd","weight":100}],"type":"multivalueBernoulliTrial","lookupKey":"PBS2S2","key":"S2S2","abgroup":"pbs2s2"},{"variants":[{"value":"33across","weight":100},{"value":"appnexus","weight":5},{"value":"connatix","weight":100},{"value":"conversant","weight":100},{"value":"grid","weight":100},{"value":"gumgum","weight":2},{"value":"improve_ss","weight":100},{"value":"openx","weight":100},{"value":"pubm_ss","weight":100},{"value":"resetdigital","weight":100},{"value":"under_ss","weight":100},{"value":"unruly","weight":100},{"value":"yieldmo","weight":100},{"value":"adform","weight":100},{"value":"aidem_ss","weight":100},{"value":"gridnat","weight":100},{"value":"rubi_ss","weight":100},{"value":"flipp","weight":100},{"value":"rise","weight":100},{"value":"tripl_ss","weight":100},{"value":"rubiv_ss","weight":100},{"value":"amx","weight":100},{"value":"opnx_ss","weight":100},{"value":"share_ss","weight":100},{"value":"crit_ss","weight":100},{"value":"ntvo_ss","weight":100},{"value":"ogury","weight":100}],"type":"multivalueBernoulliTrial","lookupKey":"PBS2S3","key":"S2S3","abgroup":"pbs2s3"},{"variants":[{"value":"s1","weight":50},{"value":"s2","weight":50}],"type":"weightedChoice","lookupKey":"MXB","key":"MutuallyExclusiveBidders","abgroup":"mxb"},{"variants":[{"value":0,"weight":20},{"value":50,"weight":16},{"value":200,"weight":16},{"value":500,"weight":16},{"value":1000,"weight":16},{"value":2000,"weight":16}],"type":"weightedChoice","lookupKey":"ABT1","key":"AmazonBootstrapTimeoutExperiment","abgroup":"abt1"},{"variants":[{"value":2,"weight":50},{"value":3,"weight":50}],"type":"weightedChoice","lookupKey":"USYNCTRIG","key":"UserSyncTrigger","abgroup":"usynctrig"},{"variants":[{"value":1,"weight":25},{"value":3,"weight":25},{"value":5,"weight":25},{"value":7,"weight":25}],"type":"weightedChoice","lookupKey":"CSYNC_LIM","key":"UserSyncLimit","abgroup":"csync_lim"},{"variants":[{"value":100,"weight":33},{"value":150,"weight":34},{"value":200,"weight":33}],"type":"weightedChoice","lookupKey":"REFDEB","key":"RefreshUserIdsDebounce","abgroup":"refdeb"},{"variants":[{"weight":5}],"type":"bernoulliTrial","lookupKey":"FOREX","key":"CurrencyConversion","abgroup":"forex"},{"variants":[{"weight":5}],"type":"bernoulliTrial","lookupKey":"CFIP_BRHO","key":"CFIpBidReqHoldout","abgroup":"cfip_brho_2"},{"variants":[{"weight":95}],"type":"bernoulliTrial","lookupKey":"CFIP_IDPHO","key":"CFIdParHoldout","abgroup":"cfip_idpho"},{"variants":[{"weight":20}],"type":"bernoulliTrial","lookupKey":"LRSS","key":"LiverampSecureSignals","abgroup":"lrss"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"OTKE","key":"OptTknEndpoint","abgroup":"otke"},{"variants":[{"value":"US","weight":100},{"value":"CA","weight":100},{"value":"GB","weight":100},{"value":"UK","weight":100},{"value":"AU","weight":100}],"type":"multivalueBernoulliTrial","lookupKey":"OPTCA","key":"OptableCountryAllowlist","abgroup":"optca"},{"variants":[{"value":"US-VT","weight":100},{"value":"US-NE","weight":100},{"value":"US-LA","weight":100},{"value":"US-MO","weight":100},{"value":"CA-QC","weight":100}],"type":"multivalueBernoulliTrial","lookupKey":"OPTCRB","key":"OptableCountryRegionBlocklist","abgroup":"optcrb"},{"variants":[{"weight":70}],"type":"bernoulliTrial","lookupKey":"ROGID5HEM","key":"OptableId5ResolveHems","abgroup":"rog_id5hem"},{"label":"RPBS","variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"NLF","key":"RPBSNoLeftovers","abgroup":"nlf"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"OPTID5RRT","key":"OptableId5ResolveRouteTest","abgroup":"optid5rrt"},{"variants":[{"weight":99}],"type":"bernoulliTrial","lookupKey":"SDKLI","key":"LiveIntentHem","abgroup":"sdkli"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"SDKLIR","key":"LiveIntentUid2Hem","abgroup":"sdklir"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"SPA","key":"SinglePageAppSupport","abgroup":"spa"},{"variants":[{"weight":99}],"type":"bernoulliTrial","lookupKey":"S2SPARAM","key":"OrtbEnrich","abgroup":"s2sparam"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"JTTE","key":"JumpToTracker","abgroup":"jtte"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"CSP","key":"ContentSpecificPlaylists","abgroup":"csp"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"SPA_636BB77B4A063E2C3E3686FB","key":"SinglePageAppSupport_636bb77b4a063e2c3e3686fb","abgroup":"spa_636bb77b4a063e2c3e3686fb"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"SPA_62A8F1D2540A6E420AB16977","key":"SinglePageAppSupport_62a8f1d2540a6e420ab16977","abgroup":"spa_62a8f1d2540a6e420ab16977"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"SCATCVE","key":"StickyContainerAdsTopCenterVideoDependency","abgroup":"scatcve"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"SSAU","key":"SlickstreamAdUnits","abgroup":"ssau"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"SSFF","key":"StickySidebarFeatureFlag","abgroup":"ssff"},{"variants":[{"value":"20sc","weight":80},{"value":"20s","weight":10},{"value":"off","weight":10}],"type":"weightedChoice","lookupKey":"MULTIREFAUC","key":"MultistagePrebidAuction","abgroup":"multirefauc"},{"variants":[{"value":"10s1","weight":0},{"value":"10s2","weight":0},{"value":"off","weight":100}],"type":"weightedChoice","lookupKey":"MULTIREFAUCV","key":"MultistagePrebidAuctionV","abgroup":"multirefaucv"},{"variants":[{"value":"10s1","weight":2},{"value":"10s2","weight":2},{"value":"off","weight":96}],"type":"weightedChoice","lookupKey":"MULTIREFAUCV2","key":"MultistagePrebidAuctionV2","abgroup":"multirefaucv2"},{"variants":[{"value":"10s1","weight":0},{"value":"10s2","weight":100},{"value":"off","weight":0}],"type":"weightedChoice","lookupKey":"MVIOS","key":"MultistagePrebidAuctionVideoNonIosExperiment","abgroup":"mvios"},{"variants":[{"value":"a1","weight":0},{"value":"a2","weight":0},{"value":"b1","weight":0},{"value":"b2","weight":100}],"type":"weightedChoice","lookupKey":"ARS","key":"AYRPBSStages","abgroup":"ars"},{"variants":[{"value":20,"weight":34},{"value":30,"weight":33},{"value":40,"weight":33}],"type":"weightedChoice","lookupKey":"LCBPE","key":"LimitContentBidPoolExperiment","abgroup":"lcbpe"},{"variants":[{"value":5,"weight":25},{"value":10,"weight":25},{"value":15,"weight":25},{"value":20,"weight":25}],"type":"weightedChoice","lookupKey":"LVBPE","key":"LimitVideoBidPoolExperiment","abgroup":"lvbpe"},{"label":"RPBS","variants":[{"value":550,"weight":20},{"value":450,"weight":20},{"value":400,"weight":20},{"value":350,"weight":20},{"value":"off","weight":20}],"type":"weightedChoice","lookupKey":"RTA","key":"RPBSReduceTimeoutAdjustment","abgroup":"rta"},{"variants":[{"value":"none","weight":1},{"value":"8.30.0","weight":99}],"type":"weightedChoice","lookupKey":"JWPV","key":"JWPVersionExperiment","abgroup":"jwpv"},{"variants":[{"value":10000,"weight":70},{"value":15000,"weight":7},{"value":20000,"weight":7},{"value":25000,"weight":10},{"value":1000,"weight":3},{"value":2000,"weight":3}],"type":"weightedChoice","lookupKey":"AINV","key":"AdInViewExperiment","abgroup":"ainv"},{"variants":[{"value":1000,"weight":100}],"type":"weightedChoice","lookupKey":"AINV2","key":"AdInViewExperiment_2","abgroup":"ainv2"},{"variants":[{"value":10000,"weight":50},{"value":5000,"weight":50}],"type":"weightedChoice","lookupKey":"AINVI","key":"AdInViewIOS","abgroup":"ainvi"},{"variants":[{"value":"noref","weight":25},{"value":20,"weight":25},{"value":30,"weight":25},{"value":"off","weight":25}],"type":"weightedChoice","lookupKey":"ASR_RE","key":"ASRInViewRefreshExperiment","abgroup":"asr_re"},{"variants":[{"weight":1}],"type":"bernoulliTrial","lookupKey":"DOVH","key":"DetectOverlappingHeader","abgroup":"dovh"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"VCSU","key":"VideoCollapseScrollUp","abgroup":"vcsu"},{"variants":[{"value":"off","weight":0},{"value":"1","weight":100},{"value":"2","weight":0}],"type":"weightedChoice","lookupKey":"COSUFTC","key":"VideoCollapseScrollUpTopCenter","abgroup":"cosuftc"},{"variants":[{"weight":90}],"type":"bernoulliTrial","lookupKey":"INTCFG","key":"InterstitialConfig","abgroup":"intcfg"},{"variants":[{"value":"Continuing without bids","weight":99},{"value":"xhr timeout after","weight":99},{"value":"marmaladeResponseLoaded","weight":90},{"value":"_initializeHls","weight":90}],"type":"multivalueBernoulliTrial","lookupKey":"DSLE","key":"DialDownLogsExperiment","abgroup":"dsle"},{"variants":[{"value":"Continuing without bids","weight":100},{"value":"xhr timeout after","weight":100},{"value":"SlotRenderEnded::adImpression","weight":99},{"value":"RaptivePlayer::_initializeHls","weight":100},{"value":"RaptivePlayer::_initializeHlsOrMp4","weight":100},{"value":"in response for appnexus adapter: unknown","weight":100}],"type":"multivalueBernoulliTrial","lookupKey":"DSLE2","key":"DialDownLogsExperiment2","abgroup":"dsle2"},{"variants":[{"value":"Continuing without bids","weight":100},{"value":"xhr timeout after","weight":100},{"value":"SlotRenderEnded::adImpression","weight":90},{"value":"RaptivePlayer::_initializeHls","weight":100},{"value":"RaptivePlayer::_initializeHlsOrMp4","weight":100},{"value":"in response for appnexus adapter: unknown","weight":100}],"type":"multivalueBernoulliTrial","lookupKey":"DSLE3","key":"DialDownLogsExperiment3","abgroup":"dsle3"},{"variants":[{"weight":90}],"type":"bernoulliTrial","lookupKey":"IPLIN","key":"IOSPlayInline","abgroup":"iplin"},{"variants":[{"weight":1}],"type":"bernoulliTrial","lookupKey":"CSL","key":"ContentSizeLogging","abgroup":"csl"},{"variants":[{"value":0.9,"weight":96},{"value":0.85,"weight":1},{"value":0.8,"weight":1},{"value":0.75,"weight":1},{"value":0,"weight":1}],"type":"weightedChoice","lookupKey":"VPRED_1","key":"PredictiveAnalysis","abgroup":"vpred_1"},{"variants":[{"value":0.6,"weight":95},{"value":"off","weight":5}],"type":"weightedChoice","lookupKey":"DSLLV","key":"DynamicSlotLazyLoadViewability","abgroup":"dsllv"},{"variants":[{"value":"off","weight":25},{"value":"ingredients","weight":25},{"value":"seeRecipe","weight":25},{"value":"quickView","weight":25}],"type":"weightedChoice","lookupKey":"RQV","key":"RecipeQuickView","abgroup":"rqv"},{"variants":[{"value":{"protocols":[1,2,3,4,5,6,7,8],"value":"all","scope":"all"},"weight":55},{"value":{"protocols":[2,3,5,6,7,8],"value":"nv1","scope":"all"},"weight":15},{"value":{"protocols":[1,2,3,5,6,7,8],"value":"allr","scope":"limited"},"weight":15},{"value":{"protocols":[2,3,5,6,7,8],"value":"nv1r","scope":"limited"},"weight":15}],"type":"weightedChoice","lookupKey":"PROTO","key":"Protocols","abgroup":"proto"},{"variants":[{"value":"off","weight":30},{"value":"7.30","weight":50},{"value":"5.10","weight":10},{"value":"3.00","weight":5},{"value":"1.40","weight":5}],"type":"weightedChoice","lookupKey":"DCSLL_SS2","key":"DCSLLSiteSpecific","abgroup":"dcsll_ss2"},{"variants":[{"value":"5","weight":100}],"type":"weightedChoice","lookupKey":"DCSLL_MED","key":"DCSLLMediumCPMTarget","abgroup":"dcsll_med"},{"variants":[{"weight":5}],"type":"bernoulliTrial","lookupKey":"SOBLP","key":"StickyOutstreamBottomLeftExperiment","abgroup":"soblp"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"ATCRL","key":"AdsToContentRatioLogging","abgroup":"atcrl"},{"variants":[{"weight":80}],"type":"bernoulliTrial","lookupKey":"SHTLI","key":"SharethroughLiveIntent","abgroup":"shtli"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"PALE","key":"ParallaxAdLogError","abgroup":"pale"},{"variants":[{"value":1800,"weight":10},{"value":2100,"weight":10},{"value":2400,"weight":10},{"value":2700,"weight":60},{"value":3000,"weight":10}],"type":"weightedChoice","lookupKey":"DSSMH","key":"DynamicSidebarSlotsMinHeight","abgroup":"dssmh"},{"variants":[{"value":[640,360],"weight":20},{"value":[854,480],"weight":20},{"value":[960,540],"weight":20},{"value":[1280,720],"weight":20},{"value":[1920,1080],"weight":20}],"type":"weightedChoice","lookupKey":"ISV","key":"InstreamSizeValue","abgroup":"isv"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"ISR","key":"InstreamSizeRefresh","abgroup":"isr"},{"variants":[{"value":3,"weight":25},{"value":4,"weight":25},{"value":6,"weight":25},{"value":8,"weight":25}],"type":"weightedChoice","lookupKey":"DSSC2","key":"DynamicSidebarSlotsCap","abgroup":"dssc3"},{"variants":[{"value":0,"weight":25},{"value":1,"weight":25},{"value":2,"weight":25},{"value":3,"weight":25}],"type":"weightedChoice","lookupKey":"SOIR","key":"StickyOutstreamIOSRefresh","abgroup":"soir"},{"variants":[{"value":"ats","weight":1},{"value":"cmscr","weight":1},{"value":"mrk","weight":1},{"value":"nlsn","weight":1},{"value":"conf","weight":1},{"value":"hawk","weight":1},{"value":"tgtaff","weight":1},{"value":"amz","weight":1},{"value":"pbmss","weight":1}],"type":"multivalueBernoulliTrial","lookupKey":"TKHO_2","key":"TKHO","abgroup":"tkho_2"},{"label":"RPBS","variants":[{"value":"msp","weight":0},{"value":"mat","weight":10},{"value":"drb","weight":10},{"value":"btt","weight":10},{"value":"rrb","weight":10},{"value":"nbr","weight":10}],"type":"multivalueBernoulliTrial","lookupKey":"RFF","key":"RPBSFeatureFlags","abgroup":"rff"},{"variants":[{"value":"control","weight":0},{"value":"topLeft","weight":100},{"value":"topLeftAboveAd","weight":0}],"type":"weightedChoice","lookupKey":"FCP","key":"FooterCloseButtonLocation","abgroup":"fcp"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"RPBS","key":"RaptivePrebidServerExperiment","abgroup":"rpbs"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"RPBSP","key":"RaptivePrebidServerProxyExperiment","abgroup":"rpbsp"},{"variants":[{"value":"orcl","weight":0},{"value":"east","weight":0},{"value":"west","weight":50},{"value":"mag","weight":0},{"value":"ay","weight":50}],"type":"weightedChoice","lookupKey":"RRPBS68","key":"RaptiveRegionalPrebidServerExperiment3","abgroup":"rrpbs68"},{"variants":[{"value":"all","weight":99},{"value":"west","weight":1},{"value":"ay","weight":0}],"type":"weightedChoice","lookupKey":"PBSMC","key":"PrebidServerMultiCall","abgroup":"pbsmc"},{"variants":[{"value":"off","weight":0},{"value":"20s","weight":100}],"type":"weightedChoice","lookupKey":"MULTISERVERAUC","key":"RaptivePBSMultistageAuctionExperiment","abgroup":"multiserverauc"},{"variants":[{"value":0,"weight":20},{"value":2,"weight":20},{"value":4,"weight":20},{"value":6,"weight":20},{"value":8,"weight":20}],"label":"RPBS","type":"weightedChoice","lookupKey":"R_DR","key":"RPBSDoubleRequestExperiment","abgroup":"r_dr"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"MRBF","key":"MidrollBugFixExperiment","abgroup":"mrbf"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"PRM","key":"PageRefreshMonitorExperiment","abgroup":"prm"},{"variants":[{"weight":25,"value":0},{"weight":25,"value":60},{"weight":25,"value":150},{"weight":25,"value":300}],"type":"weightedChoice","lookupKey":"TTLMBC","key":"MinBidCacheTTLExperiment","abgroup":"ttlmbc"},{"variants":[{"value":0,"weight":25},{"value":1000,"weight":25},{"value":2500,"weight":25},{"value":5000,"weight":25}],"type":"weightedChoice","lookupKey":"LITO","key":"LiveIntentTimeOutExperiment","abgroup":"lito"},{"variants":[{"value":100,"weight":100}],"type":"weightedChoice","lookupKey":"LAT","key":"LazyLoadThreshold","abgroup":"lat"},{"variants":[{"value":"ix","weight":100},{"value":"ttd","weight":100}],"type":"multivalueBernoulliTrial","lookupKey":"PRBI","key":"PriorityBiddersExperiment","abgroup":"prbi"},{"variants":[{"value":"ss","weight":100},{"value":"g_td","weight":100},{"value":"g_mw","weight":100},{"value":"g_td:pubm","weight":100},{"value":"g_mw:pubm","weight":100},{"value":"g_mw:id5id","weight":100},{"value":"g_td:id5id","weight":100},{"value":"g_td-pubm","weight":100},{"value":"g_mw-pubm","weight":100},{"value":"g_mw-id5id","weight":100},{"value":"g_td-id5id","weight":100},{"value":"ra_gpid","weight":100},{"value":"ra_shid","weight":100},{"value":"ra_lpid","weight":100},{"value":"ra_rcid","weight":100},{"value":"nl","weight":100},{"value":"url","weight":100},{"value":"urlh","weight":100},{"value":"api","weight":100},{"value":"grwm","weight":100},{"value":"cki","weight":100},{"value":"l","weight":100},{"value":"o","weight":100},{"value":"c","weight":100},{"value":"l_i","weight":100},{"value":"ot","weight":100},{"value":"slickstream","weight":100},{"value":"unknown","weight":100},{"value":"undefined","weight":100},{"value":"urlhck","weight":100},{"value":"sdkli","weight":100},{"value":"sdklir","weight":100}],"type":"multivalueBernoulliTrial","lookupKey":"HEMSA","key":"hemSourceAllowlist","abgroup":"hemsa"},{"variants":[{"value":"11","weight":1},{"value":"1911","weight":25},{"value":"21","weight":1},{"value":"169","weight":72},{"value":"43","weight":1}],"type":"weightedChoice","lookupKey":"NTVRAT","key":"NativeRatio","abgroup":"ntvrat"},{"variants":[{"value":20,"weight":20},{"value":23,"weight":20},{"value":25,"weight":20},{"value":28,"weight":20},{"value":30,"weight":20}],"type":"weightedChoice","lookupKey":"NTVRTL","key":"NativeRecipeTitleLength","abgroup":"ntvrtl"},{"variants":[{"weight":90}],"type":"bernoulliTrial","lookupKey":"SSPUS","key":"SSPUserSync","abgroup":"sspus"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"PAAPI","key":"PaapiExperiment","abgroup":"paapi"},{"variants":[{"value":500,"weight":100}],"type":"weightedChoice","lookupKey":"PAAPIBTO","key":"PaapiBuyerTimeout","abgroup":"paapi_bto"},{"variants":[{"value":500,"weight":100}],"type":"weightedChoice","lookupKey":"PAAPISTO","key":"PaapiSellerTimeout","abgroup":"paapi_sto"},{"variants":[{"value":500,"weight":100}],"type":"weightedChoice","lookupKey":"PAAPIRTO","key":"PaapiReportingTimeout","abgroup":"paapi_rto"},{"variants":[{"value":"ec3","weight":90},{"value":"arl","weight":5},{"value":"off","weight":5}],"type":"weightedChoice","lookupKey":"IXNT","key":"IxNativeExperiment","abgroup":"ixnt"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"MGBTFF","key":"MagniteBotTraffic","abgroup":"mgbtff"},{"variants":[{"value":"none","weight":40},{"value":"idl","weight":20},{"value":"li_uid2","weight":20},{"value":"lpid","weight":20}],"type":"weightedChoice","lookupKey":"1ST_EID2","key":"FirstEidExperiment","abgroup":"1st_eid2"},{"variants":[{"value":"er3","weight":33},{"value":"arl","weight":33},{"value":"off","weight":34}],"type":"weightedChoice","lookupKey":"IXNTR","key":"IxNativeExperimentRecipe","abgroup":"ixntr"},{"variants":[{"value":1000,"weight":5},{"value":1250,"weight":45},{"value":1500,"weight":45},{"value":1750,"weight":5}],"type":"weightedChoice","lookupKey":"S2STO","key":"S2STimeOutExperiment","abgroup":"s2sto"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"INP","key":"INPExperiment","abgroup":"inp"},{"label":"BDPL","variants":[{"value":"er3","weight":33},{"value":"arl","weight":33},{"value":"off","weight":34}],"type":"weightedChoice","lookupKey":"IXNR2","key":"IxNativeExperimentRecipe2","abgroup":"ixntr2"},{"label":"BDPL","variants":[{"value":"ec3","weight":90},{"value":"arl","weight":5},{"value":"off","weight":5}],"type":"weightedChoice","lookupKey":"IXNC2","key":"IxNativeExperiment2","abgroup":"ixnt2"},{"variants":[{"value":1500,"weight":85},{"value":2000,"weight":5},{"value":3000,"weight":5},{"value":4000,"weight":5}],"type":"weightedChoice","lookupKey":"S2STORE","key":"S2SRefreshTimeout","abgroup":"s2store"},{"variants":[{"weight":99}],"type":"bernoulliTrial","lookupKey":"OPLI","key":"OpenPathLiveIntent","abgroup":"opli"},{"variants":[{"weight":1}],"type":"bernoulliTrial","lookupKey":"SSPTRM","key":"SspTakeRateMonitor","abgroup":"ssptrm"},{"variants":[{"value":1,"weight":20},{"value":2,"weight":20},{"value":3,"weight":20},{"value":4,"weight":20},{"value":5,"weight":20}],"type":"weightedChoice","lookupKey":"TTLB","key":"TTLBuffer","abgroup":"ttlb"},{"variants":[{"value":0,"weight":20},{"value":75,"weight":5},{"value":100,"weight":20},{"value":120,"weight":20},{"value":140,"weight":35}],"type":"weightedChoice","lookupKey":"NTVDL","key":"NativeDescriptionLength","abgroup":"ntvdl"},{"variants":[{"value":0,"weight":20},{"value":5,"weight":20},{"value":10,"weight":20},{"value":15,"weight":20},{"value":20,"weight":20}],"type":"weightedChoice","lookupKey":"NBHO","key":"NoBidHoldouts","abgroup":"nbho"},{"variants":[{"value":5,"weight":25},{"value":10,"weight":25},{"value":15,"weight":25},{"value":20,"weight":25}],"type":"weightedChoice","lookupKey":"NBL","key":"NoBidLimit","abgroup":"nbl"},{"label":"RPBS","variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"FTM2","key":"RPBSFixTmaxMax","abgroup":"ftm2"},{"variants":[{"value":300,"weight":20},{"value":400,"weight":20},{"value":500,"weight":20},{"value":600,"weight":20},{"value":700,"weight":20}],"type":"weightedChoice","lookupKey":"FTMG","key":"FetchMargin","abgroup":"ftmg"},{"variants":[{"value":"2_1","weight":7},{"value":"2_2","weight":7},{"value":"2_3","weight":7},{"value":"2_4","weight":7},{"value":"2_5","weight":7},{"value":"3_1","weight":7},{"value":"3_2","weight":7},{"value":"3_3","weight":7},{"value":"4_1","weight":7},{"value":"4_2","weight":7},{"value":"4_3","weight":7},{"value":"5_1","weight":7},{"value":"5_2","weight":7},{"value":"5_3","weight":7},{"value":"off","weight":2}],"type":"weightedChoice","lookupKey":"MMSA","key":"MultiMultistagePrebidAuctionDisplay","abgroup":"mmsa"},{"variants":[{"value":0,"weight":20},{"value":50,"weight":20},{"value":75,"weight":20},{"value":100,"weight":20},{"value":150,"weight":20}],"type":"weightedChoice","lookupKey":"LRT","key":"LazyRenderThreshold","abgroup":"lrt"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"KRPL","key":"KargoPlacement","abgroup":"krpl"},{"variants":[{"value":"20sf1","weight":0},{"value":"20sf2","weight":100},{"value":"off","weight":0},{"value":"crr","weight":0}],"type":"weightedChoice","lookupKey":"MULTIREFAUCD3","key":"MultistagePrebidAuctionDisplay3","abgroup":"multirefaucd3"},{"variants":[{"weight":5}],"type":"bernoulliTrial","lookupKey":"APPRQ","key":"AppRequests","abgroup":"apprq"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"SGF","key":"ServerGAMFailure","abgroup":"sgf"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"MR4","key":"DisableMultistageRefresh","abgroup":"mr4"},{"variants":[{"weight":50}],"label":"RPBS","type":"bernoulliTrial","lookupKey":"RAS","key":"RPBSAsyncStages","abgroup":"ras"},{"variants":[{"weight":25,"value":"mr4"},{"weight":25,"value":"mrt1"},{"weight":25,"value":"mrt2"},{"weight":25,"value":"off"}],"type":"weightedChoice","lookupKey":"MRM","key":"MultistageRefreshModifier","abgroup":"mrm"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"MNR","key":"MissingNativeParams","abgroup":"mnr"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"DBUID2","key":"DeclareBridgedUid2","abgroup":"dbuid2"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"DBGPID","key":"DeclareBridgedGPID","abgroup":"dbgpid"},{"variants":[{"weight":99,"value":"rubi_ss"},{"weight":5,"value":"tripl_ss"}],"type":"multivalueBernoulliTrial","lookupKey":"APPRQB","key":"AppBiddersList","abgroup":"apprqb"},{"variants":[{"weight":20}],"type":"bernoulliTrial","lookupKey":"BS2SE","key":"BrokenS2SEndpoint","abgroup":"bs2se"},{"variants":[{"value":1000,"weight":20},{"value":2000,"weight":20},{"value":3000,"weight":20},{"value":4000,"weight":20},{"value":5000,"weight":20}],"type":"weightedChoice","lookupKey":"PBFS","key":"PrebidFailsafeTimeout","abgroup":"pbfs"},{"variants":[{"value":500,"weight":20},{"value":750,"weight":20},{"value":1000,"weight":20},{"value":1250,"weight":20},{"value":1500,"weight":20}],"type":"weightedChoice","lookupKey":"AMZFS","key":"AmazonFailsafeTimeout","abgroup":"amzfs"},{"variants":[{"weight":1}],"type":"bernoulliTrial","lookupKey":"NTVHO","key":"NativeHoldout","abgroup":"ntvho"},{"variants":[{"value":0,"weight":20},{"value":2,"weight":20},{"value":3,"weight":20},{"value":4,"weight":20},{"value":5,"weight":20}],"type":"weightedChoice","lookupKey":"DRB","key":"DisplayRequestBatch","abgroup":"drb"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"GBSR","key":"GAMBatchSRARequest","abgroup":"gbsr"},{"variants":[{"value":15,"weight":20},{"value":3,"weight":20},{"value":7,"weight":20},{"value":10,"weight":20},{"value":"off","weight":20}],"type":"weightedChoice","lookupKey":"LBPE","key":"LimitBidPoolExperiment","abgroup":"lbpe"},{"variants":[{"value":100,"weight":20},{"value":200,"weight":20},{"value":300,"weight":20},{"value":400,"weight":20},{"value":500,"weight":20}],"type":"weightedChoice","lookupKey":"VSE","key":"VideoScrollExperiment","abgroup":"vse"},{"variants":[{"value":0,"weight":25},{"value":250,"weight":25},{"value":500,"weight":25},{"value":1000,"weight":25}],"type":"weightedChoice","lookupKey":"IISW","key":"IdentityIframeSyncWait","abgroup":"iisw"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"ADXISO","key":"AdxStickyOutstream","abgroup":"adxiso"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"ADXISO2","key":"AdxStickyOutstreamV2","abgroup":"adxiso2"},{"variants":[{"value":-1,"weight":4},{"value":500,"weight":95},{"value":1024,"weight":1}],"type":"weightedChoice","lookupKey":"IMABR","key":"IMABitrate","abgroup":"imabr"},{"variants":[{"value":0,"weight":20},{"value":20,"weight":20},{"value":35,"weight":20},{"value":50,"weight":20},{"value":"off","weight":20}],"type":"weightedChoice","lookupKey":"RPBBL","key":"RaptivePlayerBackBufferLength","abgroup":"rpbbl"},{"variants":[{"value":10,"weight":20},{"value":20,"weight":20},{"value":30,"weight":20},{"value":60,"weight":20},{"value":"off","weight":20}],"type":"weightedChoice","lookupKey":"RPFBT","key":"RaptivePlayerFrontBufferThreshold","abgroup":"rpfbt"},{"variants":[{"value":1,"weight":20},{"value":5,"weight":20},{"value":10,"weight":20},{"value":20,"weight":20},{"value":30,"weight":20}],"type":"weightedChoice","lookupKey":"RPMBL","key":"RaptivePlayerMaxBufferLength","abgroup":"rpmbl"},{"variants":[{"value":10,"weight":20},{"value":50,"weight":20},{"value":100,"weight":20},{"value":250,"weight":20},{"value":600,"weight":20}],"type":"weightedChoice","lookupKey":"RPMMBL","key":"RaptivePlayerMaxMaxBufferLength","abgroup":"rpmmbl"},{"variants":[{"value":5,"weight":20},{"value":20,"weight":20},{"value":35,"weight":20},{"value":50,"weight":20},{"value":60,"weight":20}],"type":"weightedChoice","lookupKey":"RPMBS","key":"RaptivePlayerMaxBufferSize","abgroup":"rpmbs"},{"variants":[{"value":20,"weight":20},{"value":25,"weight":20},{"value":30,"weight":20},{"value":35,"weight":20},{"value":40,"weight":20}],"type":"weightedChoice","lookupKey":"RPSLT","key":"RaptivePlayerStaleLoadThreshold","abgroup":"rpslt"},{"variants":[{"value":"d","weight":90},{"value":"7","weight":10}],"type":"weightedChoice","lookupKey":"LIFPI","key":"LiveIntentFpiExpiration","abgroup":"lifpi"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"ASRI","key":"AmazonASRInitalRequest","abgroup":"asri"},{"variants":[{"value":50,"weight":10},{"value":100,"weight":30},{"value":150,"weight":30},{"value":200,"weight":20},{"value":250,"weight":10}],"type":"weightedChoice","lookupKey":"PBRQT","key":"PrebidRequestQueueTimeout","abgroup":"pbrqt"},{"variants":[{"weight":1}],"type":"bernoulliTrial","lookupKey":"GAAM","key":"GenericAnalyticsAdMarkup","abgroup":"gaam"},{"variants":[{"value":"bc","weight":50},{"value":"nobc","weight":0},{"value":"off","weight":50}],"type":"weightedChoice","lookupKey":"PUBBCAT","key":"PubmaticBCats","abgroup":"pubbcat"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"RPEP","key":"RaptivePlayerEnablePreloading","abgroup":"rpep"},{"variants":[{"value":4000,"weight":20},{"value":6000,"weight":20},{"value":8000,"weight":20},{"value":10000,"weight":20},{"value":15000,"weight":20}],"type":"weightedChoice","lookupKey":"RPLVTO","key":"RaptivePlayerLoadVideoTimeout","abgroup":"rplvto"},{"variants":[{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"33across","abvalue":"33"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"adform","abvalue":"af"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"appnexus","abvalue":"an"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"conversant","abvalue":"cv"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"criteo","abvalue":"cr"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"flipp","abvalue":"fl"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"gridvid","abvalue":"gv"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"gumgum","abvalue":"gg"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"improvedigital","abvalue":"id"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"ix","abvalue":"ix"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"kargo","abvalue":"kg"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"nativo","abvalue":"nt"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"openx","abvalue":"ox"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"ozone","abvalue":"oz"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"pubmatic","abvalue":"pm"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"resetdigital","abvalue":"rd"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"rise","abvalue":"ri"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"rtbhouse","abvalue":"rh"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"rubicon","abvalue":"rb"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"sharethrough","abvalue":"sh"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"teads","abvalue":"te"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"triplelift","abvalue":"tl"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"ttd","abvalue":"td"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"undertone","abvalue":"ut"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"unruly","abvalue":"ur"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"yahoossp","abvalue":"yh"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"yieldmo","abvalue":"ym"}],"type":"multivalueWeightedChoice","lookupKey":"DFDB","key":"DifferentFloorDifferentBidder","abgroup":"dfdb"},{"variants":[{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"33across","abvalue":"33"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"adform","abvalue":"af"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"appnexus","abvalue":"an"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"aidem_ss","abvalue":"as"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"conversant","abvalue":"cv"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"crit_ss","abvalue":"cr"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"flipp","abvalue":"fl"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"grid","abvalue":"gs"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"gumgum","abvalue":"gg"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"improve_ss","abvalue":"id"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"ix_ss","abvalue":"ix"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"ntvo_ss","abvalue":"nt"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"opnx_ss","abvalue":"ox"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"pubm_ss","abvalue":"pm"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"resetdigital","abvalue":"rd"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"rise","abvalue":"ri"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"rubi_ss","abvalue":"rb"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"share_ss","abvalue":"sh"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"tripl_ss","abvalue":"tl"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"under_ss","abvalue":"ut"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"unruly","abvalue":"ur"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"yah_ss","abvalue":"yh"},{"choices":[{"value":0.8,"weight":10},{"value":1,"weight":80},{"value":1.2,"weight":10}],"value":"yieldmo","abvalue":"ym"}],"type":"multivalueWeightedChoice","lookupKey":"DFDSB","key":"DifferentFloorDifferentServerBidder","abgroup":"dfdsb"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"PBSINTL","key":"PBSInternationalTraffic","abgroup":"pbsintl"},{"variants":[{"value":"ignkrg","weight":33},{"value":"nokrginfl","weight":33},{"value":"off","weight":34}],"type":"weightedChoice","lookupKey":"BPKRG","key":"KargoFloorsRefreshExperiment","abgroup":"bpkrg"},{"variants":[{"value":50,"weight":25},{"value":100,"weight":25},{"value":200,"weight":25},{"value":400,"weight":25}],"type":"weightedChoice","lookupKey":"ECHDE","key":"EmailCaptureHandlerDebounceExperiment","abgroup":"echde"},{"variants":[{"value":1,"weight":20},{"value":1.5,"weight":20},{"value":2,"weight":20},{"value":3,"weight":20},{"value":4,"weight":20}],"type":"weightedChoice","lookupKey":"BCM","key":"BidCacheTimeout","abgroup":"bcm"},{"variants":[{"value":1,"weight":50},{"value":"off","weight":50}],"label":"RPBS","type":"weightedChoice","lookupKey":"ASF","key":"RPBSAvoidSameFloor","abgroup":"asf"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"MMBR","key":"MaxMaxBufferReset","abgroup":"mmbr"},{"variants":[{"value":0,"weight":25},{"value":1,"weight":5},{"value":2,"weight":25},{"value":3,"weight":20},{"value":4,"weight":25}],"type":"weightedChoice","lookupKey":"ICFT","key":"InstreamCreativeFailureThreshold","abgroup":"icft"},{"variants":[{"value":0,"weight":25},{"value":1,"weight":5},{"value":2,"weight":25},{"value":3,"weight":20},{"value":4,"weight":25}],"type":"weightedChoice","lookupKey":"OCFT","key":"OutstreamCreativeFailureThreshold","abgroup":"ocft"},{"variants":[{"value":1.3,"weight":33},{"value":1.5,"weight":33},{"value":"off","weight":34}],"label":"RPBS","type":"weightedChoice","lookupKey":"BDM","key":"RPBSBidDensityMultipliers","abgroup":"bdm"},{"variants":[{"value":1.1,"weight":49},{"value":1.2,"weight":49},{"value":"off","weight":2}],"label":"RPBS","type":"weightedChoice","lookupKey":"R_INFMLT","key":"RPBSInflatorMultiplier","abgroup":"r_infmlt"},{"variants":[{"value":1.1,"weight":33},{"value":1.2,"weight":33},{"value":"off","weight":34}],"label":"RPBS","type":"weightedChoice","lookupKey":"MFM","key":"RPBSMultistageFloorMultiplier","abgroup":"mfm"},{"variants":[{"weight":5}],"type":"bernoulliTrial","lookupKey":"IXNR","key":"IXRefresh","abgroup":"ixnr"},{"variants":[{"value":0,"weight":20},{"value":50,"weight":20},{"value":100,"weight":20},{"value":200,"weight":20},{"value":400,"weight":20}],"type":"weightedChoice","lookupKey":"ECHDE2","key":"EmailCaptureHandlerDebounceExperiment_2","abgroup":"echde2"},{"variants":[{"weight":5}],"type":"bernoulliTrial","lookupKey":"MGNR","key":"MagniteRefresh","abgroup":"mgnr"},{"variants":[{"weight":1}],"type":"bernoulliTrial","lookupKey":"VPSM","key":"ViewportSampling","abgroup":"vpsm"},{"label":"RPBS","variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"MPS","key":"RPBSMetricsPerStage","abgroup":"mps"},{"variants":[{"value":0,"weight":25},{"value":0.5,"weight":25},{"value":1,"weight":25},{"value":2,"weight":25}],"type":"weightedChoice","lookupKey":"RFAVT","key":"RefreshAuctionViewportThreshold","abgroup":"rfavt"},{"variants":[{"value":"off","weight":90},{"value":"nobid","weight":10}],"label":"RPBS","type":"weightedChoice","lookupKey":"R_SHPMLT","key":"RPBSReRequestNoBids","abgroup":"r_shpmlt"},{"label":"RPBS","variants":[{"value":2,"weight":25},{"value":3,"weight":25},{"value":4,"weight":25},{"value":"off","weight":25}],"type":"weightedChoice","lookupKey":"RSS2","key":"RPBSRespectSmallStages2","abgroup":"rss2"},{"label":"RPBS","variants":[{"value":2,"weight":100}],"type":"weightedChoice","lookupKey":"SCA","key":"StagesCountAdjustment","abgroup":"sca"},{"variants":[{"value":"off","weight":25},{"value":"bg","weight":25},{"value":"sm","weight":25},{"value":"rv","weight":25}],"type":"weightedChoice","lookupKey":"SO2","key":"SizeOrder2","abgroup":"so2"},{"variants":[{"value":"off","weight":20},{"value":"bg","weight":20},{"value":"sm","weight":20},{"value":"sm1","weight":20},{"value":"rv","weight":20}],"type":"weightedChoice","lookupKey":"BWH","key":"BannerWidthHeight","abgroup":"bwh"},{"variants":[{"value":"off","weight":25},{"value":"bg","weight":25},{"value":"sm","weight":25},{"value":"rv","weight":25}],"type":"weightedChoice","lookupKey":"SOG","key":"SizeOrderGam","abgroup":"sog"},{"variants":[{"value":"off","weight":2},{"value":"sm","weight":98}],"type":"weightedChoice","lookupKey":"SO","key":"SizeOrder","abgroup":"so"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"RP","key":"RaptivePlayerOverride","abgroup":"rp"},{"label":"RPBS","variants":[{"value":"off","weight":100},{"value":1,"weight":0},{"value":2,"weight":0}],"type":"weightedChoice","lookupKey":"MFB","key":"RPBSMultistageFixedBidders","abgroup":"mfb"},{"label":"RPBS","variants":[{"value":2,"weight":25},{"value":3,"weight":25},{"value":4,"weight":25},{"value":"off","weight":25}],"type":"weightedChoice","lookupKey":"AHF","key":"RPBSAvoidHighFloors","abgroup":"ahf"},{"variants":[{"value":"off","weight":34},{"value":1,"weight":33},{"value":2,"weight":33}],"label":"RPBS","type":"weightedChoice","lookupKey":"RDR","key":"RPBSRegionalDoubleRequest","abgroup":"rdr"},{"label":"RPBS","variants":[{"value":"off","weight":34},{"value":1,"weight":33},{"value":2,"weight":33}],"type":"weightedChoice","lookupKey":"FBL","key":"RPBSFixedBiddersList","abgroup":"fbl"},{"variants":[{"value":15,"weight":0},{"value":25,"weight":100}],"type":"weightedChoice","lookupKey":"ADVD","key":"AdvancePlaylistDelay","abgroup":"advd"},{"label":"RPBS","variants":[{"value":"off","weight":34},{"value":1,"weight":33},{"value":2,"weight":33}],"type":"weightedChoice","lookupKey":"BFC","key":"RPBSBidFloorAdjustAlgorithm","abgroup":"bfc"},{"variants":[{"weight":98}],"type":"bernoulliTrial","lookupKey":"VADF","key":"VideoAuctionDurationFallbackExperiment","abgroup":"vadf"},{"label":"RPBS","variants":[{"value":0.7,"weight":20},{"value":0.8,"weight":20},{"value":0.9,"weight":20},{"value":1,"weight":20},{"value":"off","weight":20}],"type":"weightedChoice","lookupKey":"DFA","key":"RPBSDynamicFloorAdjustment","abgroup":"dfa2"},{"variants":[{"value":0,"weight":100},{"value":1,"weight":0}],"type":"weightedChoice","lookupKey":"VRE","key":"VideoPreloadRetriesExperiment","abgroup":"vre"},{"label":"RPBS","variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"AOF","key":"RPBSAllOnFirstStage","abgroup":"aof"},{"variants":[{"value":"rpbs","weight":100},{"value":"mag","weight":0}],"type":"weightedChoice","lookupKey":"PBSGR","key":"PrebidServerGDPRRouting","abgroup":"pbsgr"},{"label":"RPBS","variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"BPS2","key":"RPBSBiddersPerStage2","abgroup":"bps3"},{"label":"RPBS","variants":[{"value":1,"weight":100},{"value":"off","weight":0}],"type":"weightedChoice","lookupKey":"SBO","key":"ServerBackoff","abgroup":"sbo"},{"variants":[{"value":"default","weight":90},{"value":"single","weight":5},{"value":"both","weight":5}],"type":"weightedChoice","lookupKey":"UID1SRC","key":"Uid1AdserverExperiment","abgroup":"uid1src"},{"variants":[{"value":15000,"weight":25},{"value":10000,"weight":25},{"value":5000,"weight":25},{"value":2000,"weight":25}],"type":"weightedChoice","lookupKey":"IMAIV","key":"IOSMobileAdInViewExperiment","abgroup":"imaiv"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"AYSSEWOLI","key":"AyServerSideEnrichmentWithoutLiveIntent","abgroup":"ayssewoli"},{"variants":[{"weight":95}],"type":"bernoulliTrial","lookupKey":"AYSSEWLI","key":"AyServerSideEnrichmentWithLiveIntent","abgroup":"ayssewli"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"ARF","key":"AdditiveRefreshFloors","abgroup":"arf"},{"variants":[{"value":500,"weight":50},{"value":200,"weight":50}],"type":"weightedChoice","lookupKey":"FMBDT0","key":"FetchMarginWithMinBidCacheTTLAt0","abgroup":"fmbdt0"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"AMZNTS","key":"AmazonTrafficShaping","abgroup":"amznts"},{"variants":[{"weight":0}],"type":"bernoulliTrial","lookupKey":"OBTS","key":"OpenBiddingTrafficShaping","abgroup":"obts"},{"variants":[{"weight":50}],"type":"bernoulliTrial","lookupKey":"MULTISOSD","key":"MultiStageStickyOutstreamShorterDuration","abgroup":"multisosd"},{"variants":[{"value":3,"weight":25},{"value":7,"weight":25},{"value":10,"weight":25},{"value":15,"weight":25}],"type":"weightedChoice","lookupKey":"LRBPE","key":"LimitRecipeBidPoolExperiment","abgroup":"lrbpe"},{"variants":[{"weight":100}],"type":"bernoulliTrial","lookupKey":"SBH","key":"SlotBidHeight","abgroup":"sbh"}]};

    
(function() {
  let css = ".adthrive-act25-modal{z-index:2147483647;background-color:#0006;width:100%;height:100%;display:none;position:fixed;top:0;left:0;overflow:auto}.adthrive-act25-modal.show{display:block}.adthrive-act25-modal-content{background-color:#fefefe;border:1px solid #888;border-radius:10px;width:80%;max-width:592px;margin:auto;padding:20px 24px 24px;font-family:Verdana,Geneva,Tahoma,sans-serif;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);box-shadow:0 0 10px #00000080}.adthrive-act25-modal-close{color:#000;font-size:28px;font-weight:700;position:fixed;top:-10px;right:3px}.adthrive-act25-modal-close:hover,.adthrive-act25-modal-close:focus{color:#000;cursor:pointer;text-decoration:none}.adthrive-act25-modal-header{padding:2px 16px}.adthrive-act25-modal-header h1{color:#000000de;font-size:20px;line-height:26px}.adthrive-act25-modal-body{max-height:50vh;margin-bottom:10px;padding:10px 16px;position:relative;overflow-y:auto}.adthrive-act25-modal-body p{font-size:14px;line-height:20px}.adthrive-act25-modal-footer{color:#fff;flex-direction:column;justify-content:space-between;padding:2px 16px;display:flex}.adthrive-act25-modal-accept,.adthrive-act25-modal-decline{color:#fff;cursor:pointer;border:none;border-radius:10px}.adthrive-act25-modal-accept{background-color:#010044}.adthrive-act25-modal-decline{color:#000;background-color:#fff}.adthrive-act25-modal-accept,.adthrive-act25-modal-decline{text-transform:uppercase;flex:1;margin:0 10px 10px 0}.adthrive-act25-modal-accept:hover,.adthrive-act25-modal-accept:focus{color:#c4c4c4;background-color:#010044}.adthrive-act25-modal-decline:hover,.adthrive-act25-modal-decline:focus{color:#000;background-color:#fff}@media (width<=600px){.adthrive-act25-modal-content{width:90%}.adthrive-act25-modal-body{border-bottom:1px solid #c4c4c4;box-shadow:inset 0 -100px 30px -100px #0000001a}.adthrive-act25-modal-accept,.adthrive-act25-modal-decline{font-size:14px;line-height:14px}}@media (width>=600px){.adthrive-act25-modal-footer{flex-direction:row}.adthrive-act25-modal-accept,.adthrive-act25-modal-decline{flex:none;margin:0}}.adthrive-act25-footer{margin-bottom:30px}.adthrive-act25-footer-text{color:#a9a9a9;font-size:14px}.adthrive-act25-footer-text p{color:#a9a9a9;text-decoration:underline}.adthrive-act25-footer-link{cursor:pointer;font-size:14px;text-decoration:underline}.adthrive-ad{text-align:center;clear:both;margin-top:10px;margin-bottom:10px;line-height:0;overflow-x:visible}.adthrive-ad-cls{flex-wrap:wrap;justify-content:center;align-items:center;display:flex}.adthrive-ad-cls>div,.adthrive-ad-cls>iframe{flex-basis:100%}.adthrive-interstitial{margin-top:0;margin-bottom:0}.adthrive-native-recipe{display:inline-block}.adthrive-recipe{z-index:1;min-width:300px;position:relative}.adthrive-footer-mobile,.adthrive-header-mobile,.adthrive-footer-phone,.adthrive-header-phone{min-height:50px}.adthrive-footer-desktop,.adthrive-header-desktop,.adthrive-header-tablet,.adthrive-footer-tablet{min-height:90px}.adthrive-content,.adthrive-recipe,.adthrive-sidebar,.adthrive-below-post{min-height:250px}.adthrive-fit-content .adthrive-content{min-height:250px;width:fit-content!important;min-width:300px!important;max-width:fit-content!important;margin-left:auto!important;margin-right:auto!important}.adthrive-fit-content .adthrive-ad.adthrive-content:has(.raptive-sales-mural){width:100%!important;max-width:100%!important}.adthrive-device-desktop .adthrive-recipe,.adthrive-device-tablet .adthrive-recipe{max-width:320px}.adthrive-stuck.adthrive-sticky.adthrive-sidebar,.adthrive-stuck.adthrive-sticky.adthrive-header{z-index:9999;position:fixed;top:0}.adthrive-stuck.adthrive-header{margin-top:0}.adthrive-stuck.adthrive-sticky-outstream{z-index:2147483644;display:none;position:fixed}.adthrive-sticky.adthrive-footer{text-align:center;z-index:1000001;box-sizing:content-box;background-color:#fffc;border-top:2px solid #e1e1e1cc;width:100%;max-height:100px;margin:0;position:fixed;bottom:0;left:0;overflow:hidden}.adthrive-sticky.adthrive-footer>.adthrive-close{cursor:pointer;color:#b2b2b2;background:#fff;border:1px solid #b2b2b2;border-radius:20px;padding:0 5px;font-family:Arial,sans-serif;font-size:20px;line-height:20px;display:inline-block;position:absolute;top:5px;right:5px}.adthrive-device-desktop .adthrive-sticky.adthrive-footer>.adthrive-close{top:10px;right:10px}.adthrive-footer-message,.adthrive-privacy-preferences,.adthrive-ccpa-link{text-align:center;margin-top:5px}.adthrive-footer>div,.adthrive-header>div{max-width:1200px}.raptive-player-reset>*{box-sizing:border-box;float:none;clear:both;box-shadow:none;font-variant:normal;letter-spacing:normal;overflow-wrap:normal;text-align:left;text-transform:none;word-spacing:normal;white-space:normal;color:inherit;direction:ltr;background-color:#0000;border:0;margin:0;padding:0;font-family:Arial,Helvetica,sans-serif;font-size:16px;font-style:normal;font-weight:400;font-stretch:100%;line-height:1.2;text-decoration:none;display:block}#next-video,#stay-video{opacity:.9;text-align:center;cursor:pointer;color:#fff;text-transform:capitalize;background-color:#333;width:100px;height:40px;margin:5px;line-height:40px;position:relative}.jw-flag-small-player #next-video,.jw-flag-small-player #stay-video,.adthrive-collapse-mobile #next-video,.adthrive-collapse-mobile #stay-video,.adthrive-player-position-mobile #next-video,.adthrive-player-position-mobile #stay-video,.raptive-player-container-mobile #next-video,.raptive-player-container-mobile #stay-video{width:75px;height:30px;line-height:30px}#next-stay-container{z-index:1;flex-flow:column;justify-content:center;margin:12px;display:flex;position:absolute;top:0;bottom:0;right:0}.jw-flag-small-player #next-stay-container,.adthrive-collapse-mobile #next-stay-container,.adthrive-player-position-mobile #next-stay-container,.raptive-player-container-mobile #next-stay-container{margin:0}#next-video:before{content:\"\";z-index:1;will-change:transform,opacity;transform-origin:0;background-color:red;width:100%;height:100%;display:block;position:absolute}#next-stay-container.active>#next-video:before{animation:5s linear scaleInFromLeft}#next-video span{z-index:2;position:relative}@keyframes scaleInFromLeft{0%{opacity:0;transform:scaleX(0)}to{opacity:1;transform:scaleX(1)}}.video-box-shadow{box-shadow:0 0 10px #00000080}.adthrive-wrapper-bar{background-color:#595959;border-top-left-radius:5px;border-top-right-radius:5px;height:36px;font-family:Arial,Helvetica,sans-serif;display:none}.adthrive-video-title{color:#fff;font-size:13px;font-weight:700;text-decoration:none}.adthrive-wrapper-title-wrapper{min-width:0;box-shadow:none;border:none;justify-content:center;align-items:center;margin-left:10px;margin-right:10px;display:inline-flex}.adthrive-wrapper-title-wrapper>a>svg,.adthrive-wrapper-title-wrapper>div>svg{vertical-align:middle;fill:#fff;margin-right:5px}.adthrive-wrapper-title-wrapper>a{text-decoration:none}.adthrive-video-text-cutoff{text-overflow:ellipsis;white-space:nowrap;color:#fff;overflow:hidden}.adthrive-collapse-player{border-top:1px solid #dbdbdb;border-bottom:1px solid #dbdbdb;width:90%;margin-left:auto;margin-right:auto;padding:8px!important}.adthrive-outstream-container{margin:0 auto;position:relative;flex-basis:unset!important}.adthrive-player-idle{transition:all .5s ease-out .5s;display:none}.raptive-player-ad-container-idle{display:none}.adthrive-player-playing{transition:all .5s ease-in .5s;display:block}.adthrive-sticky-outstream-active.adthrive-new-outstream-player{opacity:1;animation-name:adthrive-fade-in;animation-duration:.5s;animation-timing-function:ease-in;animation-iteration-count:1}.adthrive-sticky-outstream-idle.adthrive-new-outstream-player{opacity:0;animation-name:adthrive-fade-out;animation-duration:.5s;animation-timing-function:ease-out;animation-iteration-count:1;display:block}@keyframes adthrive-fade-in{0%{opacity:0}to{opacity:1}}@keyframes adthrive-fade-out{0%{opacity:1}to{opacity:0}}.adthrive-player-ad-controls-play{z-index:1001;margin:-5px 4px}.adthrive-player-icon-play>svg{margin-left:4px}.adthrive-player-ad-controls-pause{justify-content:center;display:flex}.adthrive-player-ad-controls-volume-container{z-index:1001;border-radius:36px;flex-direction:column-reverse;height:36px;display:flex;position:relative}.adthrive-player-ad-controls-volume-container-with-bar{top:-5px}.adthrive-player-ad-controls-volume-container>.adthrive-player-ad-controls-volume{flex-direction:column-reverse;height:55px;display:flex;position:relative}.adthrive-player-ad-controls>.adthrive-player-ad-controls-volume-container,.adthrive-player-ad-controls-volume>.adthrive-player-icon-volume-muted,.adthrive-player-ad-controls-volume>.adthrive-player-icon.adthrive-player-icon-volume-unmuted,.adthrive-player-ad-controls-play>.adthrive-player-icon.adthrive-player-icon-pause,.adthrive-player-ad-controls-volume>.adthrive-player-volume-control{margin-block-start:0}.adthrive-player-icon-volume-muted,.adthrive-player-icon-volume-unmuted{z-index:2}.adthrive-player-volume-control{z-index:1}.adthrive-player-ad-controls-play,.adthrive-player-ad-controls-volume{border-radius:36px;width:36px;height:36px;display:inline-block}.adthrive-player-ad-controls-play:hover,.adthrive-player-ad-controls-volume-container:hover,.adthrive-player-icon-fullscreen:hover,.adthrive-player-icon-fullscreen:focus{background:#0000004d}.adthrive-player-ad-controls-volume-container-with-slider:hover{background:0 0}.adthrive-player-ad-controls-volume-container.active{z-index:1001}.adthrive-player-icon{cursor:pointer;background:0 0;border:none;border-radius:100%;justify-content:center;align-items:center;width:36px;height:36px;margin-right:4px;padding:0;display:flex}.adthrive-hidden{display:none!important}.adthrive-count-down{z-index:1;pointer-events:none;color:#fff;text-shadow:0 0 1px #000,0 0 1px #000,0 0 1px #000,0 0 1px #000;background:#00000080;border-bottom-right-radius:4px;outline:none;width:auto;height:auto;padding:4px;font-size:12px;line-height:1.2;position:absolute;top:0;left:0}.adthrive-collapse-medium>.adthrive-count-down,.adthrive-collapse-small>.adthrive-count-down{padding:2px}.adthrive-player-icon svg{pointer-events:none;filter:drop-shadow(3px 5px 3px #00000080)}.adthrive-player-ad-container{margin:0;position:absolute;bottom:0}.adthrive-player-ad-container-loading{background-color:#000;justify-content:center;align-items:center;height:100%;display:flex}.adthrive-player-ad-container{overflow:hidden}.adthrive-loading-spinner-container{z-index:2147483647;justify-content:center;align-items:center;position:absolute;inset:0}.adthrive-loading-spinner{border:3px solid #ffffff4d;border-top-color:#fff;border-radius:50%;width:50px;height:50px;-webkit-animation:1s ease-in-out infinite spin;animation:1s ease-in-out infinite spin}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{-webkit-transform:rotate(360deg)}}.adthrive-title-overlay{box-sizing:border-box;z-index:1;color:#fff;background:#0006;border-radius:0;flex-direction:row;justify-content:flex-start;align-items:center;height:0;transition:background .3s ease-out;display:flex;position:absolute;top:0;left:0;right:0}.adthrive-title-overlay.active{height:36px}.adthrive-title-overlay>.adthrive-wrapper-title-wrapper{flex-direction:row-reverse;align-items:center;width:100%;height:100%;text-decoration:none;display:none;overflow:hidden}.adthrive-title-overlay.active>.adthrive-wrapper-title-wrapper{display:flex}.adthrive-player-ad-container-loading~.adthrive-title-overlay,.adthrive-title-overlay.active>.adthrive-wrapper-title-wrapper:after{display:none}.adthrive-wrapper-bar a[target=_blank]:after{display:none!important}.adthrive-no-pointer-events{pointer-events:none}.adthrive-display-none{display:none}.adthrive-small-text{font-size:13px}.adthrive-video-title-description-container{flex-direction:column;flex:1;height:100%;font-size:1.2em;line-height:1.1em;display:flex}#adthrive-video-title-text{flex:1;align-items:center;display:flex}.adthrive-player-position-mobile #adthrive-video-title-text,.raptive-player-container-mobile #adthrive-video-title-text{font-size:.85em}#adthrive-video-description-text{text-overflow:ellipsis;white-space:nowrap;flex:1;align-items:center;margin:-4px 0 0;font-size:1vw;display:flex;overflow:hidden}.adthrive-video-play-button{cursor:pointer;z-index:1;border-top:30px solid #0000;border-bottom:30px solid #0000;border-left:60px solid #fff;width:0;height:0}.raptive-player-position{clear:both;background-color:#000;width:100%;padding-top:56.25%;position:relative}.raptive-player-container{z-index:1;height:100%;position:absolute;inset:0}.raptive-player-hidden{display:none}.raptive-player-video{width:100%;height:100%;margin-block:0!important}.raptive-player-collapse{z-index:2147483644;background-color:#000;max-height:169px}.adthrive-video-overlay{cursor:pointer;z-index:4;background-color:#00000080;justify-content:center;align-items:center;margin-block-start:unset;display:flex;position:absolute;inset:0}.adthrive-player-big-play-button{color:#6b65ff;font-size:48px}@media (width<=480px){.adthrive-player-big-play-button{font-size:44px}}@media (width>=481px) and (width<=768px){.adthrive-player-big-play-button{font-size:77px}}@media (width>=769px){.adthrive-player-big-play-button{font-size:88px}}.adthrive-sticky-outstream.adthrive-sticky-outstream-mobile .adthrive-player-ad-container{margin-top:2px;margin-bottom:2px}.adthrive-player-ad-controls.adthrive-player-ad-controls-hidden{pointer-events:none;opacity:0!important;transition:opacity .5s!important}.adthrive-player-ad-controls{text-align:left;z-index:1000000;opacity:1;width:auto;height:50px;padding:0;line-height:18px;transition:opacity .5s ease-out,transform .2s ease-out;display:flex;position:absolute;bottom:0;left:0;transform:translateY(12px)}.adthrive-full-width{width:100%}.adthrive-player-ad-controls.adthrive-player-progress-bar-visible{transform:translateY(0)}.adthrive-player-progress-bar-container{cursor:pointer;z-index:1000;pointer-events:all;width:96%;height:20px;display:none;position:absolute;bottom:0;left:2%}.adthrive-collapse-mobile .adthrive-player-progress-bar-container{width:94%;left:3%}.adthrive-player-progress-bar-container.active{display:initial}.adthrive-player-progress-bar{background-color:#ccc;border-radius:36px;width:100%;height:6px;margin:auto 0;position:absolute;top:0;bottom:0;overflow:hidden}.adthrive-player-progress-bar div{transform-origin:0;content:\"\";background-color:#6b65ff;width:100%;height:100%;display:block}.adthrive-player-progress-bar-handle{touch-action:none;z-index:1001;background-color:#6b65ff;border-radius:50%;width:12px;height:12px;position:absolute;top:50%;left:0;transform:translate(-50%,-50%)scale(1);box-shadow:0 0 10px #0006}.adthrive-player-progress-bar-handle:before{content:\"\";width:20px;height:20px;display:block;transform:translate(-4px,-4px)}.adthrive-player-volume-control{opacity:0;z-index:1;transform-origin:18px;background:#00000080;border-radius:36px;justify-content:center;align-items:center;width:120px;height:36px;margin:auto;padding-left:30px;display:flex;position:absolute;transform:rotate(270deg)}.adthrive-player-volume-control.adPlaying{top:20px}.adthrive-player-volume-control input[type=range]{-webkit-appearance:none;vertical-align:bottom;cursor:pointer;width:65px;height:10px;box-shadow:none;z-index:1001;background-color:#777;border:0;border-radius:20px;outline:0;margin:0;padding:0;position:relative;overflow:hidden}.adthrive-player-volume-control input[type=range]::-webkit-slider-runnable-track{-webkit-appearance:none;color:#777;height:10px;margin-top:-1px}.adthrive-player-volume-control input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;cursor:pointer;background:#fff;border-radius:50%;width:10px;height:10px;position:relative;top:.5px;box-shadow:-325px 0 0 320px #6b65ff,inset 0 0 0 40px #fff}.adthrive-player-volume-control input[type=range]:active::-webkit-slider-thumb{background:#fff;box-shadow:-325px 0 0 320px #6b65ff,inset 0 0 0 3px #fff}.adthrive-player-volume-control input[type=range]::-moz-range-thumb{width:10px;height:10px}.adthrive-player-volume-control input[type=range]::-moz-range-progress{background-color:#ddd;box-shadow:-325px 0 0 320px #6b65ff,inset 0 0 0 3px #6b65ff}.adthrive-player-volume-control input[type=range]::-moz-range-track{background-color:#777}.adthrive-player-volume-control input[type=range]::-ms-fill-lower{background-color:#ddd;box-shadow:-325px 0 0 320px #6b65ff,inset 0 0 0 3px #6b65ff}.adthrive-player-volume-control input[type=range]::-ms-fill-upper{background-color:#777}.adthrive-jw-player-collapse{z-index:2147483644}.adthrive-player-position.adthrive-collapse-float,.raptive-player-container.adthrive-collapse-float{position:fixed;width:300px!important}.adthrive-player-position.adthrive-collapse-float #adthrive-video-description-text,.raptive-player-container.adthrive-collapse-float #adthrive-video-description-text{display:none}.adthrive-player-position.adthrive-collapse-float.adthrive-collapse-right,.raptive-player-container.adthrive-collapse-float.adthrive-collapse-right{inset:0 5px auto auto}.adthrive-player-position.adthrive-collapse-float.adthrive-collapse-bottom-right,.raptive-player-container.adthrive-collapse-float.adthrive-collapse-bottom-right{inset:auto 5px 100px auto}.adthrive-player-position.adthrive-collapse-float.adthrive-collapse-bottom-left,.raptive-player-container.adthrive-collapse-float.adthrive-collapse-bottom-left{top:auto;bottom:100px;left:auto}.adthrive-player-position.adthrive-collapse-float>.adthrive-player-title,.raptive-player-container.adthrive-collapse-float>.adthrive-player-title{display:none}.adthrive-player-position.adthrive-collapse-sticky,.raptive-player-container.adthrive-collapse-sticky{z-index:9999;padding-top:20px;padding-bottom:20px;position:fixed}.adthrive-player-position.adthrive-collapse-sticky>.adthrive-player-title,.raptive-player-container.adthrive-collapse-sticky>.adthrive-player-title{display:none}.adthrive-sticky-outstream.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-mobile{top:0;bottom:auto!important;transform:translate(0)!important}body.adthrive-device-phone .adthrive-sticky-outstream.adthrive-sticky-outstream-active.adthrive-sticky-outstream-top-center{bottom:auto!important}.adthrive-collapse-mobile-background{z-index:99990;position:fixed;top:0;left:0}.adthrive-collapse-mobile-background.extra-height{height:163px!important}.adthrive-top-collapse-close{z-index:1;position:fixed;top:5px;left:-30px}.adthrive-sticky-outstream-top-center>.adthrive-top-collapse-close{position:fixed;top:48px;left:10px}.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-mobile>.adthrive-top-collapse-close{top:10px}.adthrive-top-collapse-wrapper-bar>* .adthrive-top-collapse-close{position:relative;top:0;left:0}.adthrive-top-collapse-wrapper-bar>* .adthrive-wrapper-float-close{float:none;margin-bottom:0;display:none}.adthrive-top-collapse-close-spacer{line-height:1.2}.adthrive-player-position.adthrive-collapse-mobile,.raptive-player-container.adthrive-collapse-mobile{z-index:99998;width:300px;position:fixed}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-small,.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-medium{width:178px}.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-small,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-medium{width:178px;height:101px;left:unset;right:unset;bottom:unset;top:unset}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-right,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-top-right{top:26px;right:10px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-left,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-top-left{top:26px;left:5px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-bottom-left,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-bottom-left{bottom:52px;left:5px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-bottom-right,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-bottom-right{bottom:52px;right:10px}.adthrive-player-position.adthrive-collapse-mobile>.adthrive-player-title,.raptive-player-container.adthrive-collapse-mobile>.adthrive-player-title{display:none}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center>.adthrive-wrapper-bar,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-top-center>.adthrive-wrapper-bar{display:none!important}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center>.adthrive-top-collapse-wrapper-bar,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-top-center>.adthrive-top-collapse-wrapper-bar{display:block}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center.adthrive-player-without-wrapper-text,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-top-center.adthrive-player-without-wrapper-text{inset:0 auto auto 50%;transform:translate(-50%);padding-top:0!important;padding-bottom:1px!important}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center.adthrive-player-with-wrapper-text,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-top-center.adthrive-player-with-wrapper-text{inset:0 5px auto auto;padding-top:0!important;padding-bottom:1px!important}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center,.raptive-player-container.adthrive-collapse-mobile.adthrive-collapse-top-center{transition:none!important}.adthrive-top-collapse-wrapper-bar{color:#fff;z-index:99998;width:-webkit-calc(100% - 178px - 10px);width:-moz-calc(100% - 178px - 10px);width:calc(100% - 188px);padding-top:5px;padding-bottom:5px;display:none;position:fixed;top:0;left:5px}.adthrive-top-collapse-wrapper-video-title{color:#fff;text-overflow:ellipsis;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical;font-size:13px;font-weight:700;text-decoration:none;display:-webkit-box;overflow:hidden}.adthrive-top-collapse-wrapper-bar a a.adthrive-learn-more-link{font-size:13px;display:inline-block}.adthrive-top-collapse-wrapper-bar a a.raptive-player-learn-more-link{display:none}.adthrive-top-collapse-wrapper-bar a a.raptive-player-learn-more-link.raptive-player-learn-more-link-active{display:inline-block}h3.adthrive-player-title{margin:10px 0}.adthrive-wrapper-close{color:#fff;justify-content:center;align-items:center;min-width:36px;height:36px;margin-left:auto;margin-right:0;font-size:36px}.adthrive-wrapper-float-close{float:right;cursor:pointer;margin-bottom:5px;display:none}.adthrive-top-left-outer{width:78px;height:78px;position:absolute;top:-55px;left:-30px}.adthrive-top-right-outer{width:78px;height:78px;position:absolute;top:-55px;right:-30px}.adthrive-top-left-outer>svg{position:absolute;bottom:30px;left:30px}.adthrive-top-right-outer>svg{position:absolute;bottom:30px;right:30px}.adthrive-top-left-inner{position:absolute;top:0}.adthrive-top-left-inner.adthrive-wrapper-float-close{color:#fff;pointer-events:none;z-index:99;background:#00000080;width:100%;padding:2px}.adthrive-new-outstream-player .adthrive-top-left-inner.adthrive-wrapper-float-close{z-index:10000}.adthrive-new-outstream-player .adthrive-ad{margin-top:0;margin-bottom:0}.adthrive-top-left-inner-wrapper.adthrive-wrapper-float-close{color:#fff;pointer-events:none;z-index:10000;background:#00000080;width:100%;padding:2px;position:absolute;top:36px}.adthrive-sticky-outstream>.adthrive-wrapper-float-close.adthrive-wrapper-close-outside-left{left:2px}.adthrive-sticky-outstream>.adthrive-wrapper-float-close.adthrive-wrapper-close-bkgd-50{color:#fff;pointer-events:none;background:#00000080;padding:2px 0;top:0;left:0}.adthrive-new-outstream-player{margin-bottom:20px;padding:0!important}.adthrive-new-outstream-player>.adthrive-wrapper-float-close.adthrive-wrapper-close-bkgd-50{top:0}.adthrive-close-in-container{line-height:0;position:relative}#adthrive-sticky-outstream-close.adthrive-top-collapse-close{position:inherit}.adthrive-sticky-outstream-idle>.adthrive-close-in-container{pointer-events:none}.adthrive-sticky-outstream-active>.adthrive-close-in-container{pointer-events:all}.adthrive-wrapper-close-bkgd-50>.adthrive-close-in-container{pointer-events:all;padding:2px 0 0 4px}.adthrive-sticky-outstream.adthrive-sticky-outstream-mobile{transition-property:transform;transition-duration:.25s;transition-delay:0s;bottom:52px}.adthrive-sticky-outstream.adthrive-sticky-outstream-mobile-right{right:10px}.adthrive-sticky-outstream.adthrive-sticky-outstream-mobile-left{left:10px;transform:none!important}.adthrive-sticky-outstream.adthrive-sticky-outstream-active.adthrive-sticky-outstream-top-center{background:#000;inset:0 0 auto;transform:none}.adthrive-sticky-outstream.adthrive-sticky-outstream-desktop{bottom:100px;right:5px}.adthrive-sticky-outstream.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-desktop,.adthrive-sticky-outstream.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-mobile{bottom:auto}.adthrive-sticky-outstream.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-mobile .adthrive-stickyoutstream-container{background-color:#000;margin:0 auto}.adthrive-sticky-outstream.adthrive-sticky-outstream-active{display:block}.adthrive-video-stickyoutstream{margin-top:0}.adthrive-video-stickyoutstream div:first-of-type{margin:-1px}.adthrive-video-stickyoutstream-new-player div:first-of-type{margin:0}.adthrive-video-stickyoutstream-new-player>div:first-child{position:absolute}.adthrive-video-close{pointer-events:all}.adthrive-video-close-float-left{float:left}.adthrive-video-close-float-right{float:right}.adthrive-footer-message span,.adthrive-privacy-preferences a,.adthrive-ccpa-link,.adthrive-ccpa-link span{color:#a9a9a9;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;font-size:13px}.adthrive-ccpa-link a{cursor:pointer;text-decoration:underline}.adthrive-device-phone .adthrive-footer-message{margin-bottom:60px}.adthrive-footer-message{margin-bottom:100px}.adthrive-footer-message>span{text-transform:uppercase;border-top:1px solid #b2b2b2;padding-top:5px}.adthrive-parallax-slot{height:400px;padding-top:5px;overflow:hidden}.adthrive-parallax-ad{transition:transform .3s ease-out;transform:translateY(0)}.adthrive-sticky-container.adthrive-parallax-slot{flex-direction:row;justify-content:center;padding-top:10px}#_inv_voicefive___{display:none}.adthrive-ad-debug{background-color:#ff000080!important;outline:1px solid red!important}.adthrive-ad-debug:hover{cursor:pointer;background-color:#f00c!important;outline:1px solid red!important}.adthrive-player-ad-controls-volume:hover>.adthrive-player-volume-control,.adthrive-player-volume-control:focus{opacity:1}@media print{div[data-gg-moat],body[data-gg-moat],iframe[data-gg-moat-ifr],div[class*=kargo-ad],.adthrive-ad,.adthrive-comscore,.adthrive-native-recipe,.raptive-sales{visibility:hidden;width:0;height:0;display:none!important}}.raptive-player-captions{text-align:center;color:#fff;--raptive-player-captions-font-opacity:100%;--raptive-player-captions-background-opacity:0%;--raptive-player-captions-window-opacity:0%;border-radius:5px;width:90%;margin:0 auto;line-height:1.5;transition:transform .5s;display:none;position:absolute;bottom:60px;left:0;right:0;font-size:16px!important}.raptive-player-captions span{white-space:pre-wrap;background:#00000080;border-radius:5px;padding:2px 4px}.raptive-player-captions-button{border-style:unset;color:#fff;cursor:pointer;background-color:#0000;border-radius:9999px;width:36px;height:36px;margin:-5px 4px -5px auto;padding:0;font-size:.75em;font-weight:700;display:none}.raptive-player-captions-button:hover{background:#0000004d}.adthrive-full-width .raptive-player-captions-button.raptive-player-captions-button--visible{display:block}.adthrive-player-ad-controls-hidden+.raptive-player-captions{transform:translateY(40px)}.raptive-player-container-mobile .raptive-player-captions,.raptive-player-collapse .raptive-player-captions{font-size:10px!important}.raptive-player-container-mobile.raptive-player-collapse .raptive-player-captions{font-size:6px!important}.raptive-player-container-mobile.raptive-player-collapse .raptive-player-captions-button{display:none}.raptive-player-settings{color:#fff;z-index:999999999;background:#000;border-radius:5px;width:288px;height:192px;font-size:14px;display:none;position:absolute;bottom:60px;right:2%;text-transform:none!important;font-family:Arial,sans-serif!important;font-weight:400!important}.raptive-player-settings--active{display:block}.raptive-player-settings-header{box-sizing:content-box;background:#404040;border-radius:5px 5px 0 0;align-items:center;gap:4px;height:40px;padding:4px;display:flex}.raptive-player-settings-header>button{color:#fff;cursor:pointer;background:0 0;border:none;border-radius:5px;justify-content:center;align-items:center;width:40px;height:40px;padding:0;font-weight:700;position:relative}.raptive-player-settings-header>button.active{border-radius:5px 5px 0 0}.raptive-player-settings-header>button.active:after{content:\"\";background-color:#fff;width:100%;height:4px;position:absolute;bottom:-4px;left:0}.raptive-player-settings-header>button:hover{background:#000}.raptive-player-settings-header-title{margin-left:8px;font-weight:700}.raptive-player-settings--nested .raptive-player-settings-header-title{margin-left:0}.raptive-player-settings-body{scrollbar-color:#fff #646464;height:144px;overflow:scroll}.raptive-player-settings-body>div{display:none}.raptive-player-settings-body>div.raptive-player-settings-page--active{display:block}.raptive-player-settings-body::-webkit-scrollbar-thumb{background:#fff!important}.raptive-player-settings-close{margin:0 0 0 auto;display:flex}.raptive-player-settings-back{display:none}.raptive-player-settings-back>svg{margin-right:2px}.raptive-player-settings--nested .raptive-player-settings-back{display:flex}.raptive-player-settings-page{padding:4px}.raptive-player-settings-page>button:hover{background:#404040}.raptive-player-settings-page-item{cursor:pointer;background:unset;text-align:left;border:none;border-radius:5px;align-items:center;width:100%;margin:4px 0;padding:4px 8px;display:flex;color:#fff!important;letter-spacing:normal!important;text-transform:none!important;font-family:Arial,sans-serif!important;font-weight:400!important;line-height:1!important}.raptive-player-settings-page-item>span:nth-child(2){text-transform:capitalize;margin-left:auto}.raptive-player-settings-page-item>span:nth-child(3){display:flex}.raptive-player-settings-page-item--selected{background:#6b65ff!important}.raptive-player-settings-page-item--unavailable{display:none}.raptive-player-container-mobile .raptive-player-settings,.raptive-player-collapse .raptive-player-settings{border-radius:0;width:100%;height:100%;position:absolute;inset:0}.raptive-player-container-mobile .raptive-player-settings-body,.raptive-player-collapse .raptive-player-settings-body{height:auto;position:absolute;inset:48px 0 0}.raptive-player-container-mobile .raptive-player-settings-header,.raptive-player-collapse .raptive-player-settings-header{border-radius:0}.raptive-player-container-mobile.raptive-player-collapse .raptive-player-settings{display:none}.adthrive-player-icon-fullscreen .raptive-player-primary-icon,.raptive-player-fullscreen .adthrive-player-icon-fullscreen .raptive-player-secondary-icon{display:block}.adthrive-player-icon-fullscreen .raptive-player-secondary-icon,.raptive-player-fullscreen .adthrive-player-icon-fullscreen .raptive-player-primary-icon,.raptive-player-ios .adthrive-player-icon-fullscreen{display:none}.raptive-player-ios .adthrive-full-width .adthrive-player-icon-fullscreen{display:flex}.adthrive-player-ad-controls>.adthrive-player-icon-fullscreen,.adthrive-player-ad-controls.adthrive-full-width .raptive-player-captions-button.raptive-player-captions-button--visible+.adthrive-player-icon-fullscreen{margin:-5px 4px}.raptive-player-container-mobile .adthrive-player-ad-controls.adthrive-full-width>.adthrive-player-icon-fullscreen,.adthrive-player-ad-controls.adthrive-full-width .raptive-player-captions-button+.adthrive-player-icon-fullscreen{margin:-5px 4px -5px auto}.raptive-content-terms-footer-link{cursor:pointer;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;font-size:13px;text-decoration:underline}.raptive-content-terms-modal{background:0 0;border:none;max-width:none;max-height:none;padding:0;overflow:visible}.raptive-content-terms-modal[open]{justify-content:center;align-items:center;margin:auto;display:flex;position:fixed;inset:0}.raptive-content-terms-modal:focus{outline:none}.raptive-content-terms-modal::backdrop{background-color:#00000080}.raptive-content-terms-modal-content{background-color:#fff;border-radius:8px;flex-direction:column;width:50vw;min-width:300px;max-width:800px;max-height:85vh;display:flex}.raptive-content-terms-modal-header{border-bottom:1px solid #e0e0e0;flex-shrink:0;justify-content:space-between;align-items:center;padding:16px 24px;display:flex}.raptive-content-terms-modal-title{color:#333;margin:0;font-size:20px;font-weight:600}.raptive-content-terms-modal-close{color:#757575;cursor:pointer;background:0 0;border:none;padding:0;font-size:24px}.raptive-content-terms-modal-close:hover{color:#000}.raptive-content-terms-modal-body{color:#555;padding:24px;overflow-y:auto}.raptive-content-terms-modal-body p{margin-top:0;margin-bottom:1em}.raptive-content-terms-modal-body p:last-child{margin-bottom:0}.raptive-content-terms-modal-body a{color:#007bff;text-decoration:none}.raptive-content-terms-modal-body a:hover{text-decoration:underline}@media (width<=768px){.raptive-content-terms-modal-content{width:90vw}}.adthrive-ccpa-modal{z-index:2147483647;background-color:#0006;width:100%;height:100%;display:none;position:fixed;top:0;left:0;overflow:auto}.adthrive-ccpa-modal-content{background-color:#fefefe;border:1px solid #888;border-radius:10px;width:80%;max-width:592px;margin:0 auto;padding:20px 24px 24px;font-family:Verdana,Geneva,Tahoma,sans-serif;position:relative;top:50%;transform:translateY(-50%);box-shadow:0 0 10px #00000080}#adthrive-ccpa-modal-title{color:#000000de;font-size:20px;line-height:26px}.adthrive-ccpa-modal-btn:hover,.adthrive-ccpa-modal-btn:focus{color:#000;cursor:pointer;text-decoration:none}#adthrive-ccpa-modal-language{color:#000000de;margin:16px 0 32px;font-size:14px;line-height:20px;display:block}#adthrive-ccpa-modal-close-btn-container:hover,#adthrive-ccpa-modal-close-btn-container:focus,#adthrive-ccpa-modal-cancel-btn:hover,#adthrive-ccpa-modal-cancel-btn:focus{color:#000c;cursor:pointer;text-decoration:none}#adthrive-ccpa-modal-continue-btn:hover,#adthrive-ccpa-modal-continue-btn:focus{color:#fffc;cursor:pointer;text-decoration:none}#adthrive-ccpa-modal-close-btn-container{color:#000;font-size:20px;font-weight:700;line-height:20px;position:absolute;top:8px;right:8px}.adthrive-ccpa-lower-buttons-container{color:#000;font-size:18px}#adthrive-ccpa-modal-cancel-btn{text-align:left;width:calc(100% - 150px);display:inline-block}#adthrive-ccpa-modal-continue-btn{color:#fff;text-align:center;background-color:#010044;border-radius:10px;width:150px;height:44px;line-height:44px;display:inline-block}@media screen and (width<=896px){.adthrive-ccpa-modal-content{width:calc(100% - 80px);margin:0 auto;position:relative}#adthrive-ccpa-modal-title{font-size:16px;line-height:24px}#adthrive-ccpa-modal-language{text-align:left;font-size:12px;line-height:16px}.adthrive-ccpa-lower-buttons-container{font-size:14px}#adthrive-ccpa-modal-close-btn-container{font-size:14px;line-height:14px}}@media screen and (width<=350px){#adthrive-ccpa-modal-title{font-size:14px;line-height:24px}#adthrive-ccpa-modal-language{text-align:left;font-size:10px;line-height:14px}.adthrive-ccpa-lower-buttons-container{text-align:center;width:100%;font-size:12px;display:block}#adthrive-ccpa-modal-close-btn-container{font-size:12px;line-height:12px;display:block}#adthrive-ccpa-modal-continue-btn{text-align:center;width:100%;display:block}#adthrive-ccpa-modal-cancel-btn{text-align:center;width:100%;margin-bottom:10px;display:block}}.raptive-gated-print-modal-container{--raptive-gated-print-primary-color:#6e55f2;--raptive-gated-print-primary-hover-color:#5a45d6;--raptive-gated-print-disabled-color:#c5c5c5;--raptive-gated-print-border-color:#c5c5c5;--raptive-gated-print-placeholder-color:#c5c5c5;--raptive-gated-print-text-color:#333;--raptive-gated-print-title-color:#000;--raptive-gated-print-background-color:#fff;--raptive-gated-print-overlay-color:#000000b3;--raptive-gated-print-checkbox-check-color:#fff;background-color:var(--raptive-gated-print-overlay-color);z-index:999;overscroll-behavior:contain;width:100vw;height:100vh;display:none;position:fixed;top:0;left:0;overflow:hidden}.raptive-gated-print-modal-container .raptive-gated-print-modal-content{text-align:start;background-color:var(--raptive-gated-print-background-color);z-index:1000;border-radius:12px;flex-direction:column;align-items:start;gap:24px;width:550px;max-width:550px;padding:24px;display:flex;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);box-shadow:0 4px 12px #00000026}.raptive-gated-print-modal-container #raptive-gated-print-modal-form{flex-direction:column;gap:16px;width:100%;display:flex}.raptive-gated-print-modal-container .raptive-gated-print-modal-title{color:var(--raptive-gated-print-title-color);font-size:1.5rem;font-weight:700}.raptive-gated-print-modal-container .raptive-gated-print-modal-body{color:var(--raptive-gated-print-text-color);font-size:1.1rem}.raptive-gated-print-modal-container label.raptive-gated-print-modal-body{color:var(--raptive-gated-print-text-color);cursor:pointer;font-size:1.1rem}.raptive-gated-print-modal-container .raptive-gated-print-modal-input{box-sizing:border-box;border:1px solid var(--raptive-gated-print-border-color);border-radius:5px;outline:none;width:100%;padding:12px;font-size:1.1rem}.raptive-gated-print-modal-container .raptive-gated-print-modal-input::placeholder{color:var(--raptive-gated-print-placeholder-color)}.raptive-gated-print-modal-container .raptive-gated-print-modal-input:focus{border:1px solid var(--raptive-gated-print-primary-color);box-shadow:0 0 2px var(--raptive-gated-print-primary-hover-color)}.raptive-gated-print-modal-container .raptive-gated-print-modal-actions{justify-content:space-between;align-items:center;width:100%;margin-top:8px;display:flex}.raptive-gated-print-modal-container .raptive-gated-print-modal-checkbox-container{align-items:center;display:flex}.raptive-gated-print-modal-container .raptive-gated-print-modal-checkbox{-webkit-appearance:none;appearance:none;border:2px solid var(--raptive-gated-print-border-color);cursor:pointer;background-color:var(--raptive-gated-print-background-color);border-radius:4px;outline:none;width:20px;height:20px;margin-right:8px;position:relative}.raptive-gated-print-modal-container .raptive-gated-print-modal-checkbox:checked{background-color:var(--raptive-gated-print-primary-color);border-color:var(--raptive-gated-print-primary-color)}.raptive-gated-print-modal-container .raptive-gated-print-modal-checkbox:checked:after{content:\"✓\";color:var(--raptive-gated-print-checkbox-check-color);font-size:14px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.raptive-gated-print-modal-container .raptive-gated-print-modal-button{width:auto;color:var(--raptive-gated-print-checkbox-check-color);cursor:pointer;background-color:var(--raptive-gated-print-primary-color);border:none;border-radius:12px;padding:12px 24px;font-size:1.1rem;font-weight:700;transition:background-color .3s}.raptive-gated-print-modal-container .raptive-gated-print-modal-button:hover{background-color:var(--raptive-gated-print-primary-hover-color)}.raptive-gated-print-modal-container .raptive-gated-print-modal-button:disabled{background-color:var(--raptive-gated-print-disabled-color);cursor:not-allowed}@media screen and (width<=896px){.raptive-gated-print-modal-container .raptive-gated-print-modal-content{width:90%;padding:16px}}@media screen and (width<=350px){.raptive-gated-print-modal-container .raptive-gated-print-modal-content{width:95%;padding:12px}}@media print{.raptive-gated-print-modal-container .raptive-gated-print-modal-content{display:none!important}}.adthrive-us-cmp-modal{z-index:2147483647;background-color:#0006;width:100%;height:100%;display:none;position:fixed;top:0;left:0;overflow:auto}.adthrive-us-cmp-modal.show{display:block}.adthrive-us-cmp-modal-content{background-color:#fefefe;border:1px solid #888;border-radius:10px;width:80%;max-width:592px;margin:auto;padding:20px 24px 24px;font-family:Verdana,Geneva,Tahoma,sans-serif;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);box-shadow:0 0 10px #00000080}.adthrive-us-cmp-modal-close{color:#000;font-size:28px;font-weight:700;position:fixed;top:-10px;right:3px}.adthrive-us-cmp-modal-close:hover,.adthrive-us-cmp-modal-close:focus{color:#000;cursor:pointer;text-decoration:none}.adthrive-us-cmp-modal-header{padding:2px 16px}.adthrive-us-cmp-modal-header h1{color:#000000de;font-size:20px;line-height:26px}.adthrive-us-cmp-modal-body{max-height:50vh;margin-bottom:10px;padding:10px 16px;position:relative;overflow-y:auto}.adthrive-us-cmp-modal-body p{font-size:14px;line-height:20px}.adthrive-us-cmp-modal-footer{color:#fff;flex-direction:column;justify-content:space-between;padding:2px 16px;display:flex}.adthrive-us-cmp-modal-accept,.adthrive-us-cmp-modal-decline{color:#fff;cursor:pointer;border:none;border-radius:10px}.adthrive-us-cmp-modal-accept{background-color:#010044}.adthrive-us-cmp-modal-decline{color:#000;background-color:#fff}.adthrive-us-cmp-modal-accept,.adthrive-us-cmp-modal-decline{text-transform:uppercase;flex:1;margin:0 10px 10px 0}.adthrive-us-cmp-modal-accept:hover,.adthrive-us-cmp-modal-accept:focus{color:#c4c4c4;background-color:#010044}.adthrive-us-cmp-modal-decline:hover,.adthrive-us-cmp-modal-decline:focus{color:#000;background-color:#fff}@media (width<=600px){.adthrive-us-cmp-modal-content{width:90%}.adthrive-us-cmp-modal-body{border-bottom:1px solid #c4c4c4;box-shadow:inset 0 -100px 30px -100px #0000001a}.adthrive-us-cmp-modal-accept,.adthrive-us-cmp-modal-decline{font-size:14px;line-height:14px}}@media (width>=600px){.adthrive-us-cmp-modal-footer{flex-direction:row}.adthrive-us-cmp-modal-accept,.adthrive-us-cmp-modal-decline{flex:none;margin:0}}.adthrive-us-cmp-footer{margin-bottom:30px}.adthrive-us-cmp-footer-text{color:#a9a9a9;font-size:14px}.adthrive-us-cmp-footer-text p{color:#a9a9a9;text-decoration:underline}.adthrive-us-cmp-footer-link{cursor:pointer;font-size:14px;text-decoration:underline}";
  let style = document.createElement('style');
  style.textContent = css;
  document.head.appendChild(style);
})();

var adtpm=Math.random()<.02&&{startTime:Date.now(),name:`adt-iife-start`,duration:null};window.adthrive.branch=window.adthrive.branch||`HEAD 2de77e1`,window.adthrive.bucket=window.adthrive.bucket||`flex`,window.adthrive.gdpr=`false`,window.adthrive.deployment=window.adthrive.deployment||`X`;var adthrive=(function(){window.adthrive.buildDate=`2025-08-29`;var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,o=(e,t)=>()=>(e&&(t=e(e=0)),t),s=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),c=(e,n)=>{for(var r in n)t(e,r,{get:n[r],enumerable:!0})},l=(e,i,o,s)=>{if(i&&typeof i==`object`||typeof i==`function`)for(var c=r(i),l=0,u=c.length,d;l<u;l++)d=c[l],!a.call(e,d)&&d!==o&&t(e,d,{get:(e=>i[e]).bind(null,d),enumerable:!(s=n(i,d))||s.enumerable});return e},u=(n,r,a)=>(a=n==null?{}:e(i(n)),l(r||!n||!n.__esModule?t(a,`default`,{value:n,enumerable:!0}):a,n));function d(e,t,n,r){return e.reverse().forEach(e=>{r=e(t,n,r)||r}),r}function f(e,t){return e.reverse().forEach(e=>{let n=e(t);n&&(t=n)}),t}function p(e,t,n,r){if(!Array.isArray(e)||e.length===0)throw TypeError();if(n!==void 0)return d(e,t,n,r);if(typeof t==`function`)return f(e,t)}function m(e,t){return ie.get(e)&&ie.get(e).get(t)}function h(e,t,n){if(t===void 0)throw TypeError();let r=m(t,n);return r&&r.get(e)}function g(e,t){let n=ie.get(e)||new Map;ie.set(e,n);let r=n.get(t)||new Map;return n.set(t,r),r}function _(e,t,n,r){if(r&&![`string`,`symbol`].includes(typeof r))throw TypeError();(m(n,r)||g(n,r)).set(e,t)}function v(e,t,n){return h(e,t,n)?h(e,t,n):Object.getPrototypeOf(t)?v(e,Object.getPrototypeOf(t),n):void 0}function y(e,t){return function(n,r){_(e,t,n,r)}}function b(e,t,n){return v(e,t,n)}function ee(e,t,n){return h(e,t,n)}function te(e,t,n){return!!h(e,t,n)}function ne(e,t,n){return!!v(e,t,n)}function re(e,t,n,r){_(e,t,n,r)}var ie,ae,oe=o((()=>{ie=new WeakMap,ae={decorate:p,defineMetadata:re,getMetadata:b,getOwnMetadata:ee,hasMetadata:ne,hasOwnMetadata:te,metadata:y},Object.assign(Reflect,ae)})),se,ce,le=o((()=>{(function(e){e[e.Transient=0]=`Transient`,e[e.Singleton=1]=`Singleton`,e[e.ResolutionScoped=2]=`ResolutionScoped`,e[e.ContainerScoped=3]=`ContainerScoped`})(se||(se={})),ce=se})),ue=o((()=>{le()}));function de(e,t){_e(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function fe(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})}function pe(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol==`function`&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return c([e,t])}}function c(o){if(r)throw TypeError(`Generator is already executing.`);for(;n;)try{if(r=1,i&&(a=o[0]&2?i.return:o[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,o[1])).done)return a;switch(i=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return n.label++,{value:o[1],done:!1};case 5:n.label++,i=o[1],o=[0];continue;case 7:o=n.ops.pop(),n.trys.pop();continue;default:if((a=n.trys,!(a=a.length>0&&a[a.length-1]))&&(o[0]===6||o[0]===2)){n=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){n.label=o[1];break}if(o[0]===6&&n.label<a[1]){n.label=a[1],a=o;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(o);break}a[2]&&n.ops.pop(),n.trys.pop();continue}o=t.call(e,n)}catch(e){o=[6,e],i=0}finally{r=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function me(e){var t=typeof Symbol==`function`&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length==`number`)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?`Object is not iterable.`:`Symbol.iterator is not defined.`)}function he(e,t){var n=typeof Symbol==`function`&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function ge(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(he(arguments[t]));return e}var _e,ve=o((()=>{_e=function(e,t){return _e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},_e(e,t)}}));function ye(e){var t=Reflect.getMetadata(`design:paramtypes`,e)||[],n=Reflect.getOwnMetadata(xe,e)||{};return Object.keys(n).forEach(function(e){t[+e]=n[e]}),t}function be(e,t){return function(n,r,i){var a=Reflect.getOwnMetadata(xe,n)||{};a[i]=t?{token:e,transform:t.transformToken,transformArgs:t.args||[]}:e,Reflect.defineMetadata(xe,a,n)}}var xe,Se=o((()=>{xe=`injectionTokens`}));function Ce(e){return!!e.useClass}var we=o((()=>{}));function Te(e){return!!e.useFactory}var Ee=o((()=>{})),De,Oe=o((()=>{ve(),De=function(){function e(e){this.wrap=e,this.reflectMethods=[`get`,`getPrototypeOf`,`setPrototypeOf`,`getOwnPropertyDescriptor`,`defineProperty`,`has`,`set`,`deleteProperty`,`apply`,`construct`,`ownKeys`]}return e.prototype.createProxy=function(e){var t=this,n={},r=!1,i,a=function(){return r||(i=e(t.wrap()),r=!0),i};return new Proxy(n,this.createHandler(a))},e.prototype.createHandler=function(e){var t={},n=function(n){t[n]=function(){var t=[...arguments];t[0]=e();var r=Reflect[n];return r.apply(void 0,ge(t))}};return this.reflectMethods.forEach(n),t},e}()}));function ke(e){return typeof e==`string`||typeof e==`symbol`}function eee(e){return typeof e==`object`&&`token`in e&&`multiple`in e}function Ae(e){return typeof e==`object`&&`token`in e&&`transform`in e}function je(e){return typeof e==`function`||e instanceof De}var Me=o((()=>{Oe()}));function Ne(e){return!!e.useToken}var Pe=o((()=>{}));function Fe(e){return e.useValue!=null}var Ie=o((()=>{})),Le=o((()=>{we(),Ee(),Me(),Pe(),Ie()}));function Re(e){return Ce(e)||Fe(e)||Ne(e)||Te(e)}var ze=o((()=>{we(),Ie(),Pe(),Ee()})),Be,Ve=o((()=>{Be=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}()})),He,Ue=o((()=>{ve(),Ve(),He=function(e){de(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Be)})),We,Ge=o((()=>{We=function(){function e(){this.scopedResolutions=new Map}return e}()}));function Ke(e,t){if(e===null)return`at position #`+t;var n=e.split(`,`)[t].trim();return`"`+n+`" at position #`+t}function qe(e,t,n){return n===void 0&&(n=`    `),ge([e],t.message.split(`
`).map(function(e){return n+e})).join(`
`)}function Je(e,t,n){var r=he(e.toString().match(/constructor\(([\w, ]+)\)/)||[],2),i=r[1],a=i===void 0?null:i,o=Ke(a,t);return qe(`Cannot inject the dependency `+o+` of "`+e.name+`" constructor. Reason:`,n)}var Ye=o((()=>{ve()}));function Xe(e){if(typeof e.dispose!=`function`)return!1;var t=e.dispose;return!(t.length>0)}var Ze=o((()=>{})),Qe,$e,et,tt=o((()=>{ve(),Ve(),Qe=function(e){de(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Be),$e=function(e){de(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Be),et=function(){function e(){this.preResolution=new Qe,this.postResolution=new $e}return e}()})),nt,rt,x,it=o((()=>{ve(),Le(),ze(),Me(),Ue(),le(),Ge(),Ye(),Oe(),Ze(),tt(),nt=new Map,rt=function(){function e(e){this.parent=e,this._registry=new He,this.interceptors=new et,this.disposed=!1,this.disposables=new Set}return e.prototype.register=function(e,t,n){n===void 0&&(n={lifecycle:ce.Transient}),this.ensureNotDisposed();var r;if(r=Re(t)?t:{useClass:t},Ne(r))for(var i=[e],a=r;a!=null;){var o=a.useToken;if(i.includes(o))throw Error(`Token registration cycle detected! `+ge(i,[o]).join(` -> `));i.push(o);var s=this._registry.get(o);a=s&&Ne(s.provider)?s.provider:null}if((n.lifecycle===ce.Singleton||n.lifecycle==ce.ContainerScoped||n.lifecycle==ce.ResolutionScoped)&&(Fe(r)||Te(r)))throw Error(`Cannot use lifecycle "`+ce[n.lifecycle]+`" with ValueProviders or FactoryProviders`);return this._registry.set(e,{provider:r,options:n}),this},e.prototype.registerType=function(e,t){return this.ensureNotDisposed(),ke(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),ke(e)){if(ke(t))return this.register(e,{useToken:t},{lifecycle:ce.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:ce.Singleton});throw Error(`Cannot register a type name as a singleton without a "to" token`)}var n=e;return t&&!ke(t)&&(n=t),this.register(e,{useClass:n},{lifecycle:ce.Singleton})},e.prototype.resolve=function(e,t){t===void 0&&(t=new We),this.ensureNotDisposed();var n=this.getRegistration(e);if(!n&&ke(e))throw Error(`Attempted to resolve unregistered dependency token: "`+e.toString()+`"`);if(this.executePreResolutionInterceptor(e,`Single`),n){var r=this.resolveRegistration(n,t);return this.executePostResolutionInterceptor(e,r,`Single`),r}if(je(e)){var r=this.construct(e,t);return this.executePostResolutionInterceptor(e,r,`Single`),r}throw Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var n,r;if(this.interceptors.preResolution.has(e)){var i=[];try{for(var a=me(this.interceptors.preResolution.getAll(e)),o=a.next();!o.done;o=a.next()){var s=o.value;s.options.frequency!=`Once`&&i.push(s),s.callback(e,t)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}this.interceptors.preResolution.setAll(e,i)}},e.prototype.executePostResolutionInterceptor=function(e,t,n){var r,i;if(this.interceptors.postResolution.has(e)){var a=[];try{for(var o=me(this.interceptors.postResolution.getAll(e)),s=o.next();!s.done;s=o.next()){var c=s.value;c.options.frequency!=`Once`&&a.push(c),c.callback(e,t,n)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}this.interceptors.postResolution.setAll(e,a)}},e.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===ce.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var n=e.options.lifecycle===ce.Singleton,r=e.options.lifecycle===ce.ContainerScoped,i=n||r,a;return a=Fe(e.provider)?e.provider.useValue:Ne(e.provider)?i?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):Ce(e.provider)?i?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):Te(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===ce.ResolutionScoped&&t.scopedResolutions.set(e,a),a},e.prototype.resolveAll=function(e,t){var n=this;t===void 0&&(t=new We),this.ensureNotDisposed();var r=this.getAllRegistrations(e);if(!r&&ke(e))throw Error(`Attempted to resolve unregistered dependency token: "`+e.toString()+`"`);if(this.executePreResolutionInterceptor(e,`All`),r){var i=r.map(function(e){return n.resolveRegistration(e,t)});return this.executePostResolutionInterceptor(e,i,`All`),i}var a=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,a,`All`),a},e.prototype.isRegistered=function(e,t){return t===void 0&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var n=me(this._registry.entries()),r=n.next();!r.done;r=n.next()){var i=he(r.value,2),a=i[0],o=i[1];this._registry.setAll(a,o.filter(function(e){return!Fe(e.provider)}).map(function(e){return e.instance=void 0,e}))}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){var t,n;this.ensureNotDisposed();var r=new e(this);try{for(var i=me(this._registry.entries()),a=i.next();!a.done;a=i.next()){var o=he(a.value,2),s=o[0],c=o[1];c.some(function(e){var t=e.options;return t.lifecycle===ce.ContainerScoped})&&r._registry.setAll(s,c.map(function(e){return e.options.lifecycle===ce.ContainerScoped?{provider:e.provider,options:e.options}:e}))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},e.prototype.beforeResolution=function(e,t,n){n===void 0&&(n={frequency:`Always`}),this.interceptors.preResolution.set(e,{callback:t,options:n})},e.prototype.afterResolution=function(e,t,n){n===void 0&&(n={frequency:`Always`}),this.interceptors.postResolution.set(e,{callback:t,options:n})},e.prototype.dispose=function(){return fe(this,void 0,void 0,function(){var e;return pe(this,function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach(function(t){var n=t.dispose();n&&e.push(n)}),[4,Promise.all(e)];case 1:return t.sent(),[2]}})})},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var n=this;if(e instanceof De)return e.createProxy(function(e){return n.resolve(e,t)});var r=(function(){var r=nt.get(e);if(!r||r.length===0){if(e.length===0)return new e;throw Error(`TypeInfo not known for "`+e.name+`"`)}var i=r.map(n.resolveParams(t,e));return new(e.bind.apply(e,ge([void 0],i)))})();return Xe(r)&&this.disposables.add(r),r},e.prototype.resolveParams=function(e,t){var n=this;return function(r,i){var a,o,s;try{return eee(r)?Ae(r)?r.multiple?(a=n.resolve(r.transform)).transform.apply(a,ge([n.resolveAll(r.token)],r.transformArgs)):(o=n.resolve(r.transform)).transform.apply(o,ge([n.resolve(r.token,e)],r.transformArgs)):r.multiple?n.resolveAll(r.token):n.resolve(r.token,e):Ae(r)?(s=n.resolve(r.transform,e)).transform.apply(s,ge([n.resolve(r.token,e)],r.transformArgs)):n.resolve(r,e)}catch(e){throw Error(Je(t,i,e))}}},e.prototype.ensureNotDisposed=function(){if(this.disposed)throw Error(`This container has been disposed, you cannot interact with a disposed container`)},e}(),x=new rt})),at=o((()=>{it(),Me()}));function ot(e){return be(e)}var st=o((()=>{Se()}));function S(){return function(e){nt.set(e,ye(e))}}var ct=o((()=>{Se(),it()})),lt=o((()=>{it()}));function C(){return function(e){S()(e),x.registerSingleton(e)}}var ut=o((()=>{ct(),it()})),dt=o((()=>{ct(),it()})),ft=o((()=>{at(),st(),ct(),lt(),ut(),dt()})),tee=o((()=>{})),w=o((()=>{if(ue(),ft(),tee(),Le(),Oe(),it(),typeof Reflect>`u`||!Reflect.getMetadata)throw Error(`tsyringe requires a reflect polyfill. Please add 'import "reflect-metadata"' to the top of your entry point.`)})),nee=o((()=>{oe(),w()}));function pt(e){"@babel/helpers - typeof";return pt=typeof Symbol==`function`&&typeof Symbol.iterator==`symbol`?function(e){return typeof e}:function(e){return e&&typeof Symbol==`function`&&e.constructor===Symbol&&e!==Symbol.prototype?`symbol`:typeof e},pt(e)}var mt=o((()=>{}));function ree(e,t){if(pt(e)!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(pt(r)!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var iee=o((()=>{mt()}));function aee(e){var t=ree(e,`string`);return pt(t)==`symbol`?t:t+``}var oee=o((()=>{mt(),iee()}));function T(e,t,n){return(t=aee(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=o((()=>{oee()}));function D(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}var O=o((()=>{})),ht,gt,_t=o((()=>{w(),E(),O(),ht=class{constructor(){T(this,`emitters`,new Set)}},ht=D([C()],ht),gt=x.resolve(ht).emitters})),k,vt=o((()=>{_t(),E(),k=class{constructor(){T(this,`_listeners`,new Set),T(this,`_emitted`,0),T(this,`_onces`,new Set)}on(e){return this._listeners.add(e),()=>{this.off(e)}}off(e){this._listeners.delete(e)}once(e,t=!0){let n=t=>{this.off(n);let r=e;r(t)};this._listeners.add(n),t&&(this._onces.add(e),this._trackStatefulEmitter())}legacyOnce(){return new Promise(e=>{let t=this.on((...n)=>(t(),e(...n)))})}_trackStatefulEmitter(){gt.add(this)}async legacyEmit(e){return Promise.all([...this._listeners].map(async t=>{let n=t;return await n(e)})).then(e=>(this._emitted++,e))}emit(e){[...this._listeners].forEach(t=>{let n=t;return n(e)}),this._emitted++,this._trackStatefulEmitter()}clear(){this._listeners.clear()}resetEmitted(){this._emitted=0}resetOnces(){for(let e of this._onces)this.once(e,!1)}get count(){return this._listeners.size}get emitted(){return this._emitted}get onces(){return this._onces}}})),yt,see=o((()=>{vt(),_t(),E(),yt=class extends k{constructor(...e){super(...e),T(this,`_pastEvents`,[])}on(e,t){return this._listeners.add(e),t!=null&&t.handleEventsAlreadyEmitted&&this._pastEvents.forEach(e),()=>{this.off(e)}}async legacyEmit(e){return this._pastEvents.push(e),Promise.all([...this._listeners].map(async t=>{let n=t;return await n(e)})).then(e=>(this._emitted++,e))}emit(e){this._pastEvents.push(e),[...this._listeners].forEach(t=>{let n=t;return n(e)}),this._emitted++,this._trackStatefulEmitter()}_trackStatefulEmitter(){gt.add(this)}}})),bt=o((()=>{vt(),see(),_t()})),xt,St=o((()=>{E(),xt=class{constructor(){T(this,`name`,void 0),T(this,`disable`,void 0),T(this,`gdprPurposes`,void 0)}}})),Ct,wt=o((()=>{w(),O(),Ct=class{},Ct=D([C()],Ct)})),Tt,Et,Dt,Ot,cee=o((()=>{Tt=e=>e.length===1,Et=e=>{let t=0;return e.forEach(e=>{e.weight&&(t+=e.weight)}),e.length>0&&e.every(e=>!!(e.hasOwnProperty(`value`)&&e.hasOwnProperty(`weight`)))&&t===100},Dt=e=>e.length>0&&e.every(e=>!!(e.hasOwnProperty(`value`)&&e.hasOwnProperty(`weight`))),Ot=e=>e.length>0&&e.every(e=>{let t=0,n=!!(e.value&&e.choices);for(let r of e.choices||[]){if(!r.hasOwnProperty(`weight`)||!r.hasOwnProperty(`value`)){n=!1;break}t+=r.weight}return!!(n&&t===100)})}));function A(e,t){if(typeof Reflect==`object`&&typeof Reflect.metadata==`function`)return Reflect.metadata(e,t)}var j=o((()=>{}));function kt(e,t){return function(n,r){t(n,r,e)}}var At=o((()=>{})),jt,Mt=o((()=>{$(),cee(),w(),j(),E(),At(),O(),jt=class{constructor(e){T(this,`_validExperiments`,void 0),T(this,`coreExperiments`,void 0),this._validExperiments=this._getValidExperiments(e).map(e=>({...e,_expConfigABGroup:e.abgroup})),this.coreExperiments=this._validExperiments.map(({variants:e,abgroup:t,key:n})=>({variants:e,abgroup:t,key:n}))}getCoreExperimentButMutateWeights(e,t){let n=this.getCoreExperiment(e,t);return(n==null?void 0:n.type)===`bernoulliTrial`&&(n.variants[0].weight=n.variants[0].weight/100),n}getCoreExperiment(e,t){let n=t?this._validExperiments.find(e=>e.lookupKey===t):null;return n||(n=this._validExperiments.find(({key:t})=>t===e)),n}getAllMatchingCoreExperiments(e){let t=this._validExperiments.filter(({label:t})=>t==null?void 0:t.includes(e));return t}getWeightedChoiceVariants(e,t){let n=this.getCoreExperimentButMutateWeights(e,t);return n&&n.type===`weightedChoice`?n.variants.map(e=>({choice:e.value,weight:e.weight,...e.abvalue?{abvalue:e.abvalue}:{}})):null}getMultivalueBernoulliVariants(e,t){let n=this.getCoreExperimentButMutateWeights(e,t);return n&&n.type===`multivalueBernoulliTrial`?n.variants.map(e=>({choice:e.value,weight:e.weight})):null}getMultivalueWeightedChoiceVariants(e,t){let n=this.getCoreExperimentButMutateWeights(e,t);return n&&n.type===`multivalueWeightedChoice`?n.variants.map(e=>({choice:e.value,options:e.choices.map(e=>({choice:e.value,weight:e.weight,abvalue:e.abvalue})),keyABValue:e.abvalue})):null}_getValidExperiments(e=[]){return e.filter(({type:e,variants:t,key:n})=>e===`weightedChoice`?this._isValidWeightedChoice(t,n):e===`bernoulliTrial`?this._isValidBernoulliTrial(t,n):e===`multivalueBernoulliTrial`?this._isValidMultivalueBernoulliTrial(t,n):e===`multivalueWeightedChoice`?this._isValidMultivalueWeightChoiceTrial(t,n):!1)}_isValidWeightedChoice(e,t){let n=Et(e);return n||this._invalidExperiment(t),n}_isValidBernoulliTrial(e,t){let n=Tt(e);return n||this._invalidExperiment(t),n}_isValidMultivalueBernoulliTrial(e,t){let n=Dt(e);return n||this._invalidExperiment(t),n}_isValidMultivalueWeightChoiceTrial(e,t){let n=Ot(e);return n||this._invalidExperiment(t),n}_invalidExperiment(e){M.error(`CoreExperimentConfig`,`_invalidExperiment`,`Experiment Validation failed for key: `,e)}},jt=D([C(),A(`design:paramtypes`,[Array]),kt(0,ot(`CoreExperimentValues`))],jt)})),Nt=o((()=>{Mt()})),Pt,Ft=o((()=>{w(),bt(),wt(),E(),O(),Pt=class extends Ct{constructor(...e){super(...e),T(this,`dialDownLogs`,new k),T(this,`newContextDataEncodingSize`,new k)}},Pt=D([C()],Pt)})),It,M,Lt=o((()=>{nee(),bt(),St(),w(),Ft(),j(),E(),O(),It=class extends xt{constructor(){super(),T(this,`name`,`Logger`),T(this,`gdprPurposes`,[7]),T(this,`disable`,!1),T(this,`siteId`,void 0),T(this,`siteName`,void 0),T(this,`bucket`,void 0),T(this,`branch`,void 0),T(this,`deployment`,void 0),T(this,`debug`,void 0),T(this,`_gamAccountId`,void 0),T(this,`_gamAccountIdSetPromise`,new Promise(e=>e())),T(this,`_gdpr`,void 0),T(this,`_shouldQueue`,!1),T(this,`_dialDownLogsExperimentResult`,void 0),T(this,`_dialDownLogsExperimentChoices`,void 0),T(this,`_data`,{abgroup:{key:`adslogger-err`},abgroupMulti:{key:`adslogger-err`},pubab:{key:`adslogger-err`},sess:`adslogger-err`,pvk:`adslogger-err`,hbho:[`adslogger-err`],vbho:[`adslogger-err`],spa:!1}),T(this,`_uniqueLogLimit`,100),T(this,`_uniqueLogMap`,new Map),T(this,`_uniqueLogExclusionList`,[`SlotRenderEnded::adImpression`,`ImpressionLogComponent::bidWon`]),T(this,`sending`,new k),T(this,`logQueue`,[]),T(this,`logFilter`,void 0),T(this,`suppressedEventLogNames`,new Map([[`SlotRenderEnded`,`adImpression`],[`VideoUtils`,`getPlacementElement`],[`PrebidAuctionManager`,`_logAuctionDebug`],[`PrebidAuctionManager`,`init`]])),T(this,`defaultDataFilterList`,new Map([[`SlotRenderEnded:adImpression`,[`abgroup`,`abgroupMulti`]]])),T(this,`maxCloudFrontUrlSize`,8192),T(this,`loggerEventBus`,void 0),this.loggerEventBus=x.resolve(Pt)}init(e){this.logFilter=e.loggerFilters||[],this.siteId=e.siteAds.siteId,this.siteName=e.siteAds.siteName,this.bucket=e.bucket,this.branch=e.branch,this.deployment=e.deployment,this.debug=e.debug,this._gdpr=e.gdpr===`true`,this._shouldQueue=this._gdpr,this._setLoggerExperiments()}set gamAccountId(e){this._gamAccountId=e,this._gamAccountIdSetPromise=Promise.resolve()}_setLoggerExperiments(){this.loggerEventBus.dialDownLogs.on(({result:e,choices:t})=>{this._dialDownLogsExperimentResult=e,this._dialDownLogsExperimentChoices=t})}_isDialedDownLog(e){let t=this._dialDownLogsExperimentResult||[];return e.some(e=>typeof e==`string`&&t.some(t=>e.toLowerCase().indexOf(t.toLowerCase())>-1))}_dialedDownChoice(e){var t;return(t=this._dialDownLogsExperimentChoices)==null?void 0:t.filter(({choice:t})=>typeof t==`string`&&e.some(e=>typeof e==`string`&&e.toLowerCase().indexOf(t.toLowerCase())>-1)).map(({weight:e})=>e)}log(e,t,...n){this.call(console.log,e,t,...n)}info(e,t,...n){this.call(console.info,e,t,...n)}warn(e,t,...n){this.call(console.warn,e,t,...n)}_getLogToCheck(e){let t=e&&e[1]&&e[1].arguments&&e[1].arguments[0];return t?[t]:e}error(e,t,...n){this._request(`error`,e,t,n)}event(e,t,...n){this._request(`event`,e,t,n)}_request(e,t,n,r){this.shouldLog(t,n)&&this.call(console.error,t,n,...r);let i=`${t}::${n}`,a=r.concat([i]),o=this._getLogToCheck(a),s=this._uniqueLogMap.get(i)||0;if(!(!this._uniqueLogExclusionList.includes(i)&&s>this._uniqueLogLimit)&&!this._isDialedDownLog(o)){let a=this._dialedDownChoice(o);a&&a.length&&r.push(`Sampled at ${100-a[0]} percent`),this.makeRequest(`send`,e,t,n,...r).catch(e=>{console.error(e)}),this._uniqueLogMap.set(i,++s)}}shouldLog(e,t){return!!this.debug&&!this.suppressedEventLogNames.has(e)&&this.suppressedEventLogNames.get(e)!==t}fetchEvent(e,t,...n){this.debug&&this.call(console.log,e,t,...n),this.makeRequest(`fetch`,`event`,e,t,...n).catch(e=>{console.error(e)})}getBlockedLogCategories(){if(typeof window<`u`&&window.location){let e=new URLSearchParams(window.location.search).get(`at_block_logs`);if(e)return e.split(`,`).map(e=>e.trim().toLowerCase())}return[]}getLimitedLogCategories(){if(typeof window<`u`&&window.location){let e=new URLSearchParams(window.location.search).get(`at_limit_logs`);if(e)return e.split(`,`).map(e=>e.trim().toLowerCase())}return[]}call(e,t,n,...r){let i=this.logFilter;if(i&&i.length&&i.includes(t))return;let a=t.toLowerCase(),o=this.getBlockedLogCategories();if(o.includes(a))return;let s=this.getLimitedLogCategories();if(s.length>0&&!s.includes(a))return;let c=[`%c${t}::${n} `],l=[`color: #999; font-weight: bold;`];r.length>0&&typeof r[0]==`string`&&c.push(r.shift()),l.push(...r);try{Function.prototype.apply.call(e,console,[c.join(``),...l])}catch(e){console.error(e);return}}buildRequestUrl(e,t,n,r){let i=`https://logger.adthrive.com/${e}`,a=[`${t}::${n} `];r.length>0&&typeof r[0]==`string`&&a.push(r.shift());let o=r.map(e=>(e&&e.error&&(e=e.error),e instanceof Error&&(e={name:e.name,message:e.message,stack:e.stack}),e)),s=this._addDefaultData(t,n);s&&o.push(s);let c=[`gamAcctId=${encodeURIComponent(this._gamAccountId||``)}`,`siteId=${encodeURIComponent(this.siteId||``)}`,`siteName=${encodeURIComponent(this.siteName||``)}`,`bucket=${encodeURIComponent(this.bucket||``)}`,`branch=${encodeURIComponent(this.branch||``)}`,`deployment=${encodeURIComponent(this.deployment||``)}`,`message=${encodeURIComponent(a.join(``).trim())}`,`pageurl=${encodeURIComponent(window.location.origin+window.location.pathname)}`,`body=${encodeURIComponent(JSON.stringify(o))}`];return`${i}?${c.join(`&`)}`}_addDefaultData(e,t){if(!this._data)return;let n={...this._data},r=this.defaultDataFilterList.get(`${e}:${t}`);return r&&Object.keys(n).forEach(e=>{r.includes(e)&&delete n[e]}),n}clearQueue(e){e&&(this._shouldQueue=!1,this.logQueue.forEach(e=>{e.action===`send`&&this.sendRequest(e.type,e.className,e.methodName,...e.args).catch(()=>{}),e.action===`fetch`&&this.fetchRequest(e.type,e.className,e.methodName,...e.args).catch(()=>{})})),this.logQueue=[]}async makeRequest(e,t,n,r,...i){if(this.disable)return Promise.resolve(!1);if(this._gdpr&&this._shouldQueue){let a={action:e,type:t,className:n,methodName:r,args:i};return this.logQueue.push(a),Promise.resolve(!0)}return this._gamAccountId||await this._gamAccountIdSetPromise,e===`send`?this.sendRequest(t,n,r,...i):this.fetchRequest(t,n,r,...i)}truncateRequestUrl(e,t,n,r,i){let a=[...r[0].arguments],o={...r[0],arguments:a},s=`${n}Truncated`,c=0;for(;i.length>this.maxCloudFrontUrlSize&&a.length>0&&c<10;)a.pop(),i=this.buildRequestUrl(e,t,s,[o]),c++;return i}async sendRequest(e,t,n,...r){this.sending.emit();let i=this.buildRequestUrl(e,t,n,r);if(i.length>this.maxCloudFrontUrlSize){var a;if(this._isTruncatableRequest(e,t,n,(a=r[0])==null?void 0:a.arguments)&&(i=this.truncateRequestUrl(e,t,n,r,i)),i.length>this.maxCloudFrontUrlSize)return this.sendRequest(e,t,n,`Payload too large. Logger cannot send`).catch(e=>{console.error(e)})}return new Promise((e,a)=>{let o=new XMLHttpRequest;o.open(`get`,i);let s=t===`logger`&&n===`sendRequest`;o.addEventListener(`load`,()=>o.status===200?e(o.responseText):(s||this.error(`logger`,`sendRequest`,...r,{className:t,methodName:n}),a(Error(`Logger send request failed ${o.status}`)))),o.addEventListener(`error`,()=>(s||this.error(`logger`,`sendRequest`,...r,{className:t,methodName:n}),a(Error(`Logger send request failed`)))),o.send()})}_isTruncatableRequest(e,t,n,r){let i=[{type:`error`,className:`PrebidAuctionManager`,methodName:`_logAuctionDebug`},{type:`event`,className:`SlotManager`,methodName:`requestBids`}];return i.some(r=>r.type===e&&r.className===t&&r.methodName===n)&&!!r}async fetchRequest(e,t,n,...r){this.sending.emit();let i=this.buildRequestUrl(e,t,n,r);return fetch(i,{method:`GET`,keepalive:!0,referrerPolicy:`no-referrer-when-downgrade`})}get data(){return this._data}set data(e){this._data=e,this.loggerEventBus.newContextDataEncodingSize.emit(encodeURIComponent(JSON.stringify(this._data)).length)}},It=D([S(),A(`design:paramtypes`,[])],It),M=new It})),Rt=o((()=>{Lt()})),zt,lee=o((()=>{E(),zt=class{constructor(e){this._wait=e,T(this,`_timeouts`,new Map)}async limit(e){return new Promise(t=>{this._timeouts.has(e)&&window.clearTimeout(this._timeouts.get(e));let n=window.setTimeout(()=>{t()},this._wait);this._timeouts.set(e,n)})}}})),uee=o((()=>{})),Bt,Vt,Ht=o((()=>{w(),Lt(),O(),Bt=class extends It{},Bt=D([S()],Bt),Vt=new Bt})),Ut,Wt=o((()=>{Ut=e=>{let t={};return function(...n){let r=JSON.stringify(n);if(t[r])return t[r];let i=e.apply(this,n);return t[r]=i,i}}})),Gt,Kt,qt,Jt,Yt,Xt,Zt,Qt,$t,en,tn,nn,rn,an,on,sn,cn,ln,un,dn=o((()=>{Wt(),Gt=navigator.vendor,Kt=navigator.userAgent,qt=Ut(e=>/Edge\/|Edg\//.test(e||Kt)),Jt=Ut(e=>/Firefox/.test(e||Kt)),Yt=Ut(e=>/Trident|MSIE/.test(e||Kt)),Xt=Ut(e=>/Opera|OPR/.test(e||Kt)),Zt=Ut((e,t)=>(/Chrom/.test(e||Kt)&&/Google/.test(t||Gt)||/CriOS/.test(e||Kt))&&!qt(e)&&!Xt(e)),Qt=Ut(e=>/Chrom|Applechromium/.test(e||Kt)),$t=Ut((e,t)=>/Safari/.test(e||Kt)&&/Apple Computer/.test(t||Gt)&&!qt(e)&&!Xt(e)),en=Ut(()=>/WebKit/.test(Kt)),tn=e=>{let t=e.indexOf(`Version/`);if(t!==-1){let n=t+8,r=e.indexOf(` `,n),i=e.substring(n,r);return i}let n=e.indexOf(`Safari/`);if(n!==-1){let t=n+7,r=e.indexOf(` `,t),i=e.substring(t,r);return i}return null},nn=e=>{let t=e.indexOf(`Firefox/`);if(t!==-1){let n=t+8,r=e.indexOf(` `,n);r===-1&&(r=e.length);let i=e.substring(n,r);return i}return null},rn=e=>{let t=e.indexOf(`Edg/`);if(t!==-1){let n=t+4,r=e.indexOf(` `,n);r===-1&&(r=e.length);let i=e.substring(n,r);return i}return null},an=e=>{let t=e.indexOf(`MSIE `);if(t!==-1){let n=t+5,r=e.indexOf(`;`,n);r===-1&&(r=e.length);let i=e.substring(n,r);return i}},on=e=>{let t=e.indexOf(`OPR/`);if(t!==-1){let n=t+4,r=e.indexOf(` `,n),i=e.substring(n,r);return i}return`Unknown`},sn=e=>{let t=e.indexOf(`Chrom`)===-1?e.indexOf(`CriOS`):e.indexOf(`Chrom`);if(t!==-1){let n=t+7,r=e.indexOf(` `,n),i=e.substring(n,r);return i}return null},cn=Ut((e,t)=>Zt(e,t)?`Chrome`:$t(e,t)?`Safari`:qt(e)?`Edge`:Jt(e)?`Firefox`:Xt(e)?`Opera`:Yt(e)?`IE`:`Others`),ln=Ut((e,t)=>{let n=cn(e||Kt,t||Gt);if(n===`Chrome`)return sn(e||Kt);if(n===`Safari`)return tn(e||Kt);if(n===`Firefox`)return nn(e||Kt);if(n===`Edge`)return rn(e||Kt);if(n===`IE`)return an(e||Kt);if(n===`Opera`)return on(e||Kt)}),un=Ut(()=>Qt()?`chromium`:en()?`webkit`:`other`)})),fn,pn,mn,hn,dee=o((()=>{fn=(e=window.document)=>!!e.browsingTopics&&!!e.featurePolicy&&e.featurePolicy.allowsFeature(`browsing-topics`),pn=(e=window.document,t=window.navigator)=>!!t.joinAdInterestGroup&&!!e.featurePolicy&&e.featurePolicy.allowsFeature(`join-ad-interest-group`)&&e.featurePolicy.allowsFeature(`run-ad-auction`),mn={"control_1.1":`disabled`,"control_1.2":`disabled`,"control_1.3":`disabled`,"control_1.4":`disabled`,label_only_1:`disabled`,label_only_2:`enabled`,label_only_3:`enabled`,label_only_4:`enabled`,label_only_5:`enabled`,control_2:`disabled`,"treatment_1.1":`enabled`,"treatment_1.2":`enabled`,"treatment_1.3":`enabled`,none:`experiment`},hn=e=>{let t=Object.keys(mn).find(t=>e===t||e.startsWith(t));return mn[t==null?`none`:t]}})),gn,fee=o((()=>{Lt(),gn=(e,t=0,n=!1,r=74)=>{if(!e.parentElement||t===r)return;let i=getComputedStyle(e.parentElement).overflow;(i===`hidden`||i===`auto`)&&(e.parentElement.style.overflow=`visible`,n||(n=!0,M.event(`util`,`checkForOverflow`,`parent element with overflow detected`))),gn(e.parentElement,++t,n,r)}})),pee=o((()=>{})),_n,vn=o((()=>{_n=()=>{let e=document.querySelector(`.adthrive-footer`),t=52;return e&&e.style.display===`none`?t=102:e&&(t=Math.max(e.getBoundingClientRect().height,t)),t}})),yn,bn=o((()=>{yn=(e,t,n,r,i)=>{let a=document.createElement(e);return t&&a.setAttribute(`id`,t),n&&(a.className=n),r&&(a.innerHTML=r),i&&(a.href=i,e===`a`&&a.addEventListener(`click`,e=>{e.preventDefault()})),a}})),N,xn=o((()=>{N=(e,t)=>e==null||e!==e?t:e})),Sn,mee=o((()=>{Sn=e=>new Promise(t=>{setTimeout(t,e)})})),Cn,hee=o((()=>{Cn=(e,t)=>{let n=window.innerWidth;return n>=t?`desktop`:n>=e?`tablet`:`phone`}})),wn,gee=o((()=>{wn=()=>new Promise(e=>{if(document.readyState===`interactive`||document.readyState===`complete`)return e();document.addEventListener(`DOMContentLoaded`,()=>e())})})),Tn,_ee=o((()=>{Tn={amznbid:`amznbid`,amzniid:`amzniid`,amznp:`amznp`,amznsz:`amznsz`}})),En,Dn,On,P,kn,An,vee,jn,Mn,Nn,Pn,Fn=o((()=>{En={Aidem:`aidem`,AmazonTAM:`amazon`,AmazonUAM:`AmazonUAM`,Blis:`blis`,Cadent:`cadent`,Connatix:`connatix`,Criteo:`criteo`,ImproveDigital:`improvedigital`,IndexExchange:`ix`,Kargo:`kargo`,MediaGridVideo:`gridvid`,Medianet:`medianet`,Nativo:`nativo`,Ogury:`ogury`,OpenX:`openx`,Ozone:`ozone`,Pubmatic:`pubmatic`,Rtbhouse:`rtbhouse`,Rubicon:`rubicon`,Seedtag:`seedtag`,Sharethrough:`sharethrough`,StackAdapt:`stackadapt`,Triplelift:`triplelift`,Teads:`teads`,TTD:`ttd`,Undertone:`undertone`,Verizon:`verizon`,Verve:`verve`,YahooSSP:`yahoossp`},Dn={AdaptMx:`amx`,Adform:`adform`,AppNexus:`appnexus`,AidemServer:`aidem_ss`,Conversant:`conversant`,CriteoServer:`crit_ss`,Flipp:`flipp`,ImproveDigitalServer:`improve_ss`,IndexExchangeServer:`ix_ss`,GumGum:`gumgum`,MediaGrid:`grid`,NativoServer:`ntvo_ss`,Ogury:`ogury`,OpenXServer:`opnx_ss`,PubmaticServer:`pubm_ss`,Rise:`rise`,RubiconServer:`rubi_ss`,SharethroughServer:`share_ss`,ThirtyThreeAcross:`33across`,TripleliftServer:`tripl_ss`,UndertoneServer:`under_ss`,Unruly:`unruly`,YahooSSPServer:`yah_ss`,Yieldmo:`yieldmo`},On={AdaptMxAY:`amx_ay`,AdformAY:`adform_ay`,AidemAY:`aidem_ay`,AppNexusAY:`appnexus_ay`,ConnatixAY:`connatix_ay`,ConversantAY:`convrsnt_ay`,CriteoAY:`crit_ay`,FlippAY:`flipp_ay`,GumGumAY:`gumgum_ay`,ImproveDigitalAY:`improve_ay`,IndexExchangeAY:`ix_ay`,MediaGridAY:`grid_ay`,NativoAY:`ntvo_ay`,OguryAY:`ogury_ay`,OpenXAY:`opnx_ay`,PubmaticAY:`pubm_ay`,RiseAY:`rse_ay`,RubiconAY:`rubi_ay`,SharethroughAY:`share_ay`,ThirtyThreeAcrossAY:`33across_ay`,TripleliftAY:`tripl_ay`,UndertoneAY:`under_ay`,UnrulyAY:`unrly_ay`,YahooSSPAY:`yah_ay`,YieldmoAY:`yldmo_ay`},P={...En,...Dn,...On},kn={stackadapt:`sa`,"33across":`ta`,adaptmx:`ax`,adform:`af`,aidem_ss:`as`,aidem:`am`,appnexus:`an`,connatix:`cx`,conversant:`cv`,crit_ss:`cs`,criteo:`cr`,flipp:`fl`,grid:`mg`,gumgum:`gg`,improve_ss:`ims`,improve:`im`,ix_ss:`is`,ix:`ix`,medianet:`mn`,ntvo_ss:`ns`,ntvo:`nt`,ogury:`og`,openx:`ox`,opnx_ss:`os`,pubm_ss:`ps`,pubmatic:`pu`,resetdigital:`rd`,rise:`rs`,rubi_ss:`ms`,rubicon:`ma`,share_ss:`sr`,sharethrough:`sh`,tripl_ss:`ts`,triplelift:`tl`,under_ss:`us`,undertone:`ut`,unruly:`ur`,yah_ss:`ys`,yahoo:`ya`,yieldmo:`ym`},An={[P.IndexExchange]:kn.ix,[P.Medianet]:kn.medianet,[P.Ogury]:kn.ogury,[P.OpenX]:kn.openx,[P.Pubmatic]:kn.pubmatic,[P.Rubicon]:kn.rubicon,[P.Sharethrough]:kn.sharethrough,[P.Triplelift]:kn.triplelift,[P.AdaptMx]:kn.adaptmx,[P.Adform]:kn.adform,[P.AppNexus]:kn.appnexus,[P.AidemServer]:kn.aidem_ss,[P.Connatix]:kn.connatix,[P.Conversant]:kn.conversant,[P.CriteoServer]:kn.crit_ss,[P.Flipp]:kn.flipp,[P.ImproveDigitalServer]:kn.improve_ss,[P.IndexExchangeServer]:kn.ix_ss,[P.GumGum]:kn.gumgum,[P.MediaGrid]:kn.grid,[P.NativoServer]:kn.ntvo_ss,[P.OpenXServer]:kn.opnx_ss,[P.PubmaticServer]:kn.pubm_ss,[P.Rise]:kn.rise,[P.RubiconServer]:kn.rubi_ss,[P.SharethroughServer]:kn.share_ss,[P.StackAdapt]:kn.stackadapt,[P.ThirtyThreeAcross]:kn[`33across`],[P.TripleliftServer]:kn.tripl_ss,[P.UndertoneServer]:kn.under_ss,[P.Unruly]:kn.unruly,[P.YahooSSPServer]:kn.yah_ss,[P.Yieldmo]:kn.yieldmo},vee={[kn.ix]:P.IndexExchange,[kn.medianet]:P.Medianet,[kn.ogury]:P.Ogury,[kn.openx]:P.OpenX,[kn.pubmatic]:P.Pubmatic,[kn.rubicon]:P.Rubicon,[kn.sharethrough]:P.Sharethrough,[kn.triplelift]:P.Triplelift,[kn.adaptmx]:P.AdaptMx,[kn.adform]:P.Adform,[kn.appnexus]:P.AppNexus,[kn.aidem_ss]:P.AidemServer,[kn.connatix]:P.Connatix,[kn.conversant]:P.Conversant,[kn.crit_ss]:P.CriteoServer,[kn.flipp]:P.Flipp,[kn.improve_ss]:P.ImproveDigitalServer,[kn.ix_ss]:P.IndexExchangeServer,[kn.gumgum]:P.GumGum,[kn.grid]:P.MediaGrid,[kn.ntvo_ss]:P.NativoServer,[kn.opnx_ss]:P.OpenXServer,[kn.pubm_ss]:P.PubmaticServer,[kn.rise]:P.Rise,[kn.rubi_ss]:P.RubiconServer,[kn.share_ss]:P.SharethroughServer,[kn.stackadapt]:P.StackAdapt,[kn[`33across`]]:P.ThirtyThreeAcross,[kn.tripl_ss]:P.TripleliftServer,[kn.under_ss]:P.UndertoneServer,[kn.unruly]:P.Unruly,[kn.yah_ss]:P.YahooSSPServer,[kn.yieldmo]:P.Yieldmo},jn=new Map([[kn.adaptmx,[P.AdaptMx]],[kn.adform,[P.Adform]],[kn.aidem,[P.Aidem,P.AidemServer]],[kn.appnexus,[P.AppNexus]],[kn.conversant,[P.Conversant]],[kn.criteo,[P.Criteo,P.CriteoServer]],[kn.flipp,[P.Flipp]],[kn.grid,[P.MediaGrid]],[kn.gumgum,[P.GumGum]],[kn.improve,[P.ImproveDigital,P.ImproveDigitalServer]],[kn.ix,[P.IndexExchange,P.IndexExchangeServer]],[kn.medianet,[P.Medianet]],[kn.ntvo,[P.Nativo,P.NativoServer]],[kn.openx,[P.OpenX,P.OpenXServer]],[kn.pubmatic,[P.Pubmatic,P.PubmaticServer]],[kn.rise,[P.Rise]],[kn.rubicon,[P.Rubicon,P.RubiconServer]],[kn.sharethrough,[P.Sharethrough,P.SharethroughServer]],[kn.stackadapt,[P.StackAdapt]],[kn.triplelift,[P.Triplelift,P.TripleliftServer]],[kn.undertone,[P.Undertone,P.UndertoneServer]],[kn.unruly,[P.Unruly]],[kn.yahoo,[P.YahooSSP,P.YahooSSPServer]],[kn.yieldmo,[P.Yieldmo]],[kn[`33across`],[P.ThirtyThreeAcross]]]),Mn=[P.AppNexus,P.IndexExchangeServer,P.MediaGrid,P.OpenXServer,P.PubmaticServer,P.RubiconServer,P.TripleliftServer,P.UndertoneServer],Nn=[],Pn=[P.Connatix]})),In,Ln,Rn,zn=o((()=>{In={GAM:`gam`,Marmalade:`marmalade`,CMP:`cmp`},Ln={Prebid:`prebid`,Amazon:`amazon`,Floors:`floors`,Optable:`optable`,TrafficShaping:`trafficShaping`,cridBlock:`cridBlock`,GAM:`gam`,Marmalade:`marmalade`},Rn={...In,...Ln}})),Bn,yee=o((()=>{Bn=()=>window.adthriveCLS})),bee=o((()=>{yee()})),xee=o((()=>{})),See=o((()=>{})),Cee=o((()=>{})),wee=o((()=>{})),Tee=o((()=>{})),Eee=o((()=>{})),Vn,Hn,Un,Wn=o((()=>{Vn={cm:`cm`,fbrap:`fbrap`,rapml:`rapml`},Hn={lazy:`lazy`,raptive:`raptive`,refresh:`refresh`,session:`session`,crossDomain:`crossdomain`,highSequence:`highsequence`,lazyBidPool:`lazyBidPool`,fallback:`fallback`},Un={lazy:`l`,raptive:`rapml`,refresh:`r`,session:`s`,crossdomain:`c`,highsequence:`hs`,lazyBidPool:`lbp`,fallback:`f`}})),Gn,Kn,Dee=o((()=>{Gn={Version:`Version`,SharingNotice:`SharingNotice`,SaleOptOutNotice:`SaleOptOutNotice`,SharingOptOutNotice:`SharingOptOutNotice`,TargetedAdvertisingOptOutNotice:`TargetedAdvertisingOptOutNotice`,SensitiveDataProcessingOptOutNotice:`SensitiveDataProcessingOptOutNotice`,SensitiveDataLimitUseNotice:`SensitiveDataLimitUseNotice`,SaleOptOut:`SaleOptOut`,SharingOptOut:`SharingOptOut`,TargetedAdvertisingOptOut:`TargetedAdvertisingOptOut`,SensitiveDataProcessing:`SensitiveDataProcessing`,KnownChildSensitiveDataConsents:`KnownChildSensitiveDataConsents`,PersonalDataConsents:`PersonalDataConsents`,MspaCoveredTransaction:`MspaCoveredTransaction`,MspaOptOutOptionMode:`MspaOptOutOptionMode`,MspaServiceProviderMode:`MspaServiceProviderMode`,SubSectionType:`SubsectionType`,Gpc:`Gpc`},Kn={NA:0,OptedOut:1,OptedIn:2}})),Oee=o((()=>{})),kee=o((()=>{})),Aee=o((()=>{})),jee=o((()=>{})),qn,Jn,Yn=o((()=>{qn={percent:`percent`,flat:`flat`,pmp:`pmp`,instream:`instream`,default:`default`,outstream:`outstream`,stickyOutstream:`stickyOutstream`,all:`all`,prebid:`prebid`,native:`native`},Jn={percent:1,flat:0}})),Mee=o((()=>{})),Nee=o((()=>{})),Pee=o((()=>{})),Xn,Fee=o((()=>{Xn={AdDensity:`addensity`,AdLayout:`adlayout`,FooterCloseButton:`footerclose`,Interstitial:`interstitial`,RemoveVideoTitleWrapper:`removevideotitlewrapper`,StickyOutstream:`stickyoutstream`,StickyOutstreamOnStickyPlayer:`sospp`,VideoAdvancePlaylistRelatedPlayer:`videoadvanceplaylistrp`,MobileStickyPlayerPosition:`mspp`}})),F,Zn=o((()=>{F={Below_Post_1:`Below_Post_1`,Below_Post:`Below_Post`,Content:`Content`,Content_1:`Content_1`,Content_2:`Content_2`,Content_3:`Content_3`,Content_4:`Content_4`,Content_5:`Content_5`,Content_6:`Content_6`,Content_7:`Content_7`,Content_8:`Content_8`,Content_9:`Content_9`,Recipe:`Recipe`,Recipe_1:`Recipe_1`,Recipe_2:`Recipe_2`,Recipe_3:`Recipe_3`,Recipe_4:`Recipe_4`,Recipe_5:`Recipe_5`,Native_Recipe:`Native_Recipe`,Footer_1:`Footer_1`,Footer:`Footer`,Header_1:`Header_1`,Header_2:`Header_2`,Header:`Header`,Sidebar_1:`Sidebar_1`,Sidebar_2:`Sidebar_2`,Sidebar_3:`Sidebar_3`,Sidebar_4:`Sidebar_4`,Sidebar_5:`Sidebar_5`,Sidebar_9:`Sidebar_9`,Sidebar:`Sidebar`,Interstitial_1:`Interstitial_1`,Interstitial:`Interstitial`,Video_StickyOutstream_1:`Video_StickyOutstream_1`,Video_StickyOutstream:`Video_StickyOutstream`,Video_StickyInstream:`Video_StickyInstream`,Sponsor_Tile:`Sponsor_Tile`}})),Qn,$n=o((()=>{Qn={Desktop:`desktop`,Mobile:`mobile`}})),Iee=o((()=>{})),er,Lee=o((()=>{Z(),w(),j(),E(),O(),er=class{constructor(){T(this,`adthriveExperimentOverrides`,void 0),this.adthriveExperimentOverrides=UW(`at_features`)}hasValidOverride(e,t){if(e in this.adthriveExperimentOverrides){let n=this.adthriveExperimentOverrides[e],r=this.isValidExperimentOverride(t,n);return r}return!1}useOverride(e){return this.adthriveExperimentOverrides[e]}isValidExperimentOverride(e,t){if(e.length===0)return!1;let n=Array.isArray(e[0])?`array`:typeof e[0];if(n===`array`){if(!Array.isArray(t)||t.some(t=>!e.includes(t))&&t.map(e=>`[`+JSON.stringify(e)+`]`).some(t=>!e.map(e=>JSON.stringify(e)).includes(t))&&!e.map(e=>JSON.stringify(e)).includes(JSON.stringify(t)))return!1}else if(n===`object`){if(!e.map(e=>JSON.stringify(e)).includes(JSON.stringify(t)))return!1}else if(typeof e[0]==typeof t&&!e.includes(t))return!1;return!0}},er=D([C(),A(`design:paramtypes`,[])],er)})),tr,nr=o((()=>{Lee(),w(),E(),tr=class{constructor(){T(this,`shouldUseCoreExperimentsConfig`,!0),T(this,`_expConfigABGroup`,void 0),T(this,`abgroup`,void 0);let e=this.run.bind(this);this.run=()=>{var t;let n=x.resolve(er),r=(t=this._choices)==null?void 0:t.map(e=>e.choice),i=this._expConfigABGroup?this._expConfigABGroup:this.abgroup?this.abgroup:this.key;return r&&n.hasValidOverride(i,r)?n.useOverride(i):e()}}}})),rr,ir=o((()=>{rr=class{}})),ar,or=o((()=>{ir(),ar=class extends rr{constructor(e){super(),this._probability=e}get(){if(this._probability<0||this._probability>1)throw Error(`Invalid probability: ${this._probability}`);return Math.random()<this._probability}}})),sr,cr,lr,ur=o((()=>{sr=(e,t)=>Math.random()*(t-e)+e,cr=(e,t)=>Math.floor(sr(Math.ceil(e),Math.floor(t))),lr=()=>{if(window.crypto){let e=new Uint8Array(1);return crypto.getRandomValues(e),e[0]/255}return Math.random()}})),Ree=o((()=>{})),zee=o((()=>{})),dr,Bee=o((()=>{ur(),ir(),dr=class e extends rr{constructor(e=[],t){super(),this._choices=e,this._default=t}static fromArray(t,n){return new e(t.map(([e,t])=>({choice:e,weight:t})),n)}addChoice(e,t){this._choices.push({choice:e,weight:t})}get(){let e=sr(0,100),t=0;for(let{choice:n,weight:r}of this._choices)if(t+=r,t>=e)return n;return this._default}get totalWeight(){return this._choices.reduce((e,{weight:t})=>e+t,0)}}})),fr=o((()=>{or(),Ree(),zee(),Bee()})),pr,Vee=o((()=>{bt(),w(),wt(),E(),O(),pr=class extends Ct{constructor(...e){super(...e),T(this,`initialized`,new k),T(this,`initRan`,new k)}},pr=D([C()],pr)})),mr,hr=o((()=>{bt(),w(),wt(),E(),O(),mr=class extends Ct{constructor(...e){super(...e),T(this,`libraryLoadFailed`,new yt),T(this,`amazonLibraryLoadComplete`,new yt),T(this,`floorsLibraryLoadComplete`,new yt),T(this,`optableLibraryLoadComplete`,new yt),T(this,`prebidLibraryLoadComplete`,new yt),T(this,`trafficShapingLibraryLoadComplete`,new yt),T(this,`cridBlockLibraryLoadComplete`,new yt),T(this,`gamLibraryLoadComplete`,new yt),T(this,`marmaladeLibraryLoadComplete`,new yt)}},mr=D([C()],mr)})),gr,Hee=o((()=>{w(),bt(),wt(),j(),E(),O(),gr=class extends Ct{constructor(){super(),T(this,`topicsReceived`,new yt)}},gr=D([C(),A(`design:paramtypes`,[])],gr)})),_r,Uee=o((()=>{w(),bt(),wt(),E(),O(),_r=class extends Ct{constructor(...e){super(...e),T(this,`act25consentCaptured`,new yt),T(this,`usCmpConsentCaptured`,new yt)}},_r=D([C()],_r)})),vr,Wee=o((()=>{w(),bt(),wt(),E(),O(),vr=class extends Ct{constructor(...e){super(...e),T(this,`disableAds`,new yt)}},vr=D([C()],vr)})),yr,br=o((()=>{w(),wt(),bt(),E(),O(),yr=class extends Ct{constructor(...e){super(...e),T(this,`setAmazonFloors`,new k),T(this,`clearAllFloorData`,new k),T(this,`storeModuleFloorData`,new k),T(this,`storeRaptiveFloorData`,new k),T(this,`setAuctionFloorData`,new k),T(this,`componentActive`,new k)}},yr=D([C()],yr)})),xr,Gee=o((()=>{w(),bt(),wt(),E(),O(),xr=class extends Ct{constructor(...e){super(...e),T(this,`footerElementAdded`,new yt),T(this,`comscoreInitialized`,new yt),T(this,`footerHeightChanged`,new k),T(this,`footerResponseReceived`,new k),T(this,`footerRenderEnded`,new k),T(this,`footerVideoRibbonStateChanged`,new k)}},xr=D([C()],xr)})),Sr,Cr,wr,Kee=o((()=>{Sr={EMAIL:`e:`,IP4:`i4:`,GPID:`c:`,RCID:`c3`,UID1:`c5:`},Cr={PUBMATIC_SSP_ID:`c1:`},wr=`https://raptive.solutions.cdn.optable.co/public-assets/raptive-sdk.js`})),I,qee=o((()=>{I={IDENTITY_DATA:{KEY:`adt_i`},PII_DATA:{KEY:`adt_ei`},PII_SOURCE:{KEY:`adt_emsrc`,VALUES:{ID5ID:`id5id`,GPID:`gpid`,RCID:`rcid`,SHID:`shid`,LPID:`lpid`,TD:`td`,MW:`mw`,API:`api`,URL:`url`,URLH:`urlh`,URLHCK:`urlhck`,LOCAL_STORAGE:`l`,COOKIE:`cki`,COMMENT:`c`,NEWSLETTER:`nl`,SLICKSTREAM:`ss`,IDENTITY_IFRAME:`l_i`,GRWM:`grwm`,PUBM:`pubm`,OTHER:`o`,SDKLI:`sdkli`,UNKNOWN:`unknown`,GATED_PRINT:`gp`,FORM:`form`},PREFIXES:{IDG:`g_`,IDENTITY_IFRAME:`l_i-`,SLICKSTREAM:`ss_`,RAPTIVE_AUTH:`ra_`,HEM_CAPTURE:`hc_`},SUFFIXES:{CAPTURE:`_c`,STORAGE:`_s`}},PII_SOURCE_COLLECTED_DATE:{KEY:`adt_emsrc_cd`},OPTABLE_LMPID:{KEY:`__lmpid`}}})),Tr=o((()=>{Kee(),qee()})),Er,Dr,Or,kr,Ar,jr,Mr=o((()=>{Tr(),E(),Er=new Map([[`api`,I.PII_SOURCE.VALUES.API],[`comment`,I.PII_SOURCE.VALUES.COMMENT],[`cookies`,I.PII_SOURCE.VALUES.COOKIE],[`growme`,I.PII_SOURCE.VALUES.GRWM],[`gatedPrint`,I.PII_SOURCE.VALUES.GATED_PRINT],[`localStorage`,I.PII_SOURCE.VALUES.LOCAL_STORAGE],[`newsletter`,I.PII_SOURCE.VALUES.NEWSLETTER],[`form`,I.PII_SOURCE.VALUES.FORM],[`other`,I.PII_SOURCE.VALUES.OTHER],[`url`,I.PII_SOURCE.VALUES.URL],[`urlHashed`,I.PII_SOURCE.VALUES.URLH],[`urlConvertKit`,I.PII_SOURCE.VALUES.URLHCK],[`identityIframe`,I.PII_SOURCE.VALUES.IDENTITY_IFRAME],[`slickstream`,I.PII_SOURCE.VALUES.SLICKSTREAM]]),Dr=new Map([[`truedata`,I.PII_SOURCE.VALUES.TD],[`mediawallah`,I.PII_SOURCE.VALUES.MW]]),Or=class{constructor(e){T(this,`collectionMethod`,`direct`),T(this,`type`,void 0),T(this,`sha256Hash`,void 0),T(this,`sha1Hash`,void 0),T(this,`collectionSiteId`,void 0),T(this,`collectionDate`,void 0),T(this,`collectionSource`,void 0),T(this,`iframe`,void 0),T(this,`directSource`,void 0),this.type=e.type,this.sha256Hash=e.sha256Hash,this.sha1Hash=e.sha1Hash,this.collectionSiteId=e.collectionSiteId,this.collectionDate=e.collectionDate,this.collectionSource=e.collectionSource,this.iframe=e.iframe,this.directSource=e.directSource}},kr=class{constructor(e){T(this,`collectionMethod`,`graph3p`),T(this,`type`,void 0),T(this,`sha256Hash`,void 0),T(this,`sha1Hash`,void 0),T(this,`alternateIds`,void 0),T(this,`collectionSiteId`,void 0),T(this,`collectionDate`,void 0),T(this,`collectionSource`,void 0),T(this,`iframe`,void 0),T(this,`graphSource`,void 0),T(this,`graphTraits`,void 0),T(this,`bridgingMethod`,void 0),T(this,`bridgingValue`,void 0),this.type=e.type,this.sha256Hash=e.sha256Hash,this.sha1Hash=e.sha1Hash,this.alternateIds=e.alternateIds,this.collectionSiteId=e.collectionSiteId,this.collectionDate=e.collectionDate,this.collectionSource=e.collectionSource,this.iframe=e.iframe,this.graphSource=e.graphSource,this.graphTraits=e.graphTraits,this.bridgingMethod=e.bridgingMethod,this.bridgingValue=e.bridgingValue}},Ar=class{constructor(e){T(this,`collectionMethod`,`graph1p`),T(this,`type`,void 0),T(this,`sha256Hash`,void 0),T(this,`sha1Hash`,void 0),T(this,`alternateIds`,void 0),T(this,`collectionSiteId`,void 0),T(this,`collectionDate`,void 0),T(this,`collectionSource`,void 0),T(this,`iframe`,void 0),T(this,`bridgingMethod`,void 0),T(this,`bridgingValue`,void 0),this.type=e.type,this.sha256Hash=e.sha256Hash,this.sha1Hash=e.sha1Hash,this.alternateIds=e.alternateIds,this.collectionSiteId=e.collectionSiteId,this.collectionDate=e.collectionDate,this.collectionSource=e.collectionSource,this.iframe=e.iframe,this.bridgingMethod=e.bridgingMethod}},jr=class{constructor(e){T(this,`collectionMethod`,`liveIntent`),T(this,`type`,void 0),T(this,`sha256Hash`,void 0),T(this,`sha1Hash`,void 0),T(this,`collectionSiteId`,void 0),T(this,`collectionDate`,void 0),T(this,`collectionSource`,void 0),T(this,`iframe`,void 0),T(this,`withUid2`,void 0),this.type=e.type,this.sha256Hash=e.sha256Hash,this.sha1Hash=e.sha1Hash,this.collectionSiteId=e.collectionSiteId,this.collectionDate=e.collectionDate,this.collectionSource=e.collectionSource,this.iframe=e.iframe,this.withUid2=e.withUid2}}})),Nr,Jee=o((()=>{w(),bt(),wt(),E(),O(),Nr=class extends Ct{constructor(...e){super(...e),T(this,`identityApiReady`,new yt),T(this,`identityApiDataSubmitted`,new k),T(this,`dataCaptured`,new yt),T(this,`dataCapturedForIframe`,new yt),T(this,`dataCapturedLegacy`,new yt),T(this,`dataSentFromIframe`,new k),T(this,`iframeReady`,new yt),T(this,`iframeDataSynced`,new yt),T(this,`optableResolved`,new yt),T(this,`optableIdentitiesCaptured`,new yt),T(this,`optableTraitsCaptured`,new yt),T(this,`optableRaptiveGraphResolved`,new yt),T(this,`optableThirdPartyGraphResolved`,new yt),T(this,`optableWaterfallCompleted`,new yt),T(this,`optableUid1Captured`,new yt),T(this,`optableResolveAnalytics`,new yt)}},Nr=D([C()],Nr)})),Pr,Fr=o((()=>{w(),bt(),wt(),j(),E(),O(),Pr=class extends Ct{constructor(){super(),T(this,`adRenderFailed`,new k),T(this,`adRenderSucceeded`,new k),T(this,`auctionDebug`,new k),T(this,`auctionEnd`,new k),T(this,`auctionInit`,new k),T(this,`beforeRequestBids`,new k),T(this,`bidRequested`,new k),T(this,`bidWon`,new k),T(this,`initialized`,new yt),T(this,`rubiconBidError`,new k),T(this,`setTargeting`,new k),T(this,`staleRender`,new k),T(this,`tcf2Enforcement`,new k),T(this,`vastExceededLimit`,new k),T(this,`liveIntentResolved`,new yt),T(this,`expiredRender`,new k),T(this,`id5Resolved`,new k)}},Pr=D([C(),A(`design:paramtypes`,[])],Pr)})),Ir,Yee=o((()=>{w(),bt(),wt(),E(),O(),Ir=class extends Ct{constructor(...e){super(...e),T(this,`iframeReady`,new yt)}},Ir=D([C()],Ir)})),Lr,Xee=o((()=>{w(),bt(),wt(),E(),O(),Lr=class extends Ct{constructor(...e){super(...e),T(this,`userIdNeedsRefresh`,new k),T(this,`uid2Refreshed`,new k)}},Lr=D([C()],Lr)})),Rr,Zee=o((()=>{w(),bt(),wt(),j(),E(),O(),Rr=class extends Ct{constructor(){super(),T(this,`marmaladeResponseLoaded`,new yt),T(this,`recencyFrequencyDataSet`,new yt),T(this,`resetMarmaladeData`,new k)}},Rr=D([C(),A(`design:paramtypes`,[])],Rr)})),zr,Qee=o((()=>{w(),bt(),wt(),E(),O(),zr=class extends Ct{constructor(...e){super(...e),T(this,`routeChanged`,new k),T(this,`resetCompleted`,new k)}},zr=D([C()],zr)})),Br,$ee=o((()=>{bt(),w(),wt(),E(),O(),Br=class extends Ct{constructor(...e){super(...e),T(this,`targetingReady`,new k)}},Br=D([C()],Br)})),Vr,Hr=o((()=>{bt(),w(),wt(),E(),O(),Vr=class extends Ct{constructor(...e){super(...e),T(this,`addSlots`,new k),T(this,`addRebuiltSlots`,new k),T(this,`requestingBids`,new k),T(this,`preRequestBids`,new k),T(this,`refreshingBids`,new k),T(this,`beforeGoogleAdManagerRefreshSlots`,new k),T(this,`addRangeSlotTargeting`,new k),T(this,`addPrebidSlotTargeting`,new k),T(this,`displaySlot`,new k),T(this,`triggerRenderOutsideGam`,new k),T(this,`adRenderingOutsideGAM`,new k),T(this,`adRenderedOutsideGAM`,new k),T(this,`googleAdManagerFallbackDivAdded`,new k),T(this,`amazonBidResponseReceived`,new k),T(this,`noBidResponses`,new k),T(this,`auctionsCompleted`,new k),T(this,`gamEmptyNoBidResponse`,new k),T(this,`adSlotScrolledFarOutOfView`,new k),T(this,`stickyOutstreamSlotDestroyedUserClick`,new k)}},Vr=D([C()],Vr)})),Ur,Wr=o((()=>{bt(),w(),E(),O(),Ur=class{constructor(){T(this,`added`,new k),T(this,`displayed`,new k),T(this,`displaying`,new k),T(this,`refreshed`,new k),T(this,`refreshing`,new k),T(this,`refreshAuctionStart`,new k),T(this,`refreshingBids`,new k),T(this,`requestingBids`,new k),T(this,`requestedBids`,new k)}},Ur=D([C()],Ur)})),Gr,Kr,ete=o((()=>{Gr={AS:{location:`Sponsor_Tile`,selectors:[`h1.entry-title`,`h1.post-title`,`h1.posttitle`,`h1.story-title`,`h1.heading`,`.post > .post-title`,`h1.tdb-title-text`,`h1.post_title`],size:[[300,55],[234,60]],position:`afterend`,classNames:[`adthrive-sponsor-tile`],find:e=>document.querySelector(e),requireSelectorMatch:!0,lazy:!1},NR:{location:`Native_Recipe`,sequence:1,selectors:[`[itemscope][itemtype$="//schema.org/Recipe"] [itemprop="recipeIngredient"]:last-child`,`[itemscope][itemtype$="//schema.org/Recipe"] [itemprop="ingredients"]:last-child`,`[itemscope][itemtype$="//schema.org/Recipe"] .ingredient:last-child`,`.wprm-recipe-ingredient:last-child`,`#recipe .ingredients`,`.wprm-recipe-ingredients-container`,`.tasty-recipe-ingredients`,`[class*="recipe"] [class*="ingredient"] ul li:last-child`,`[class*="create-ingredient"] ul li:last-child`,`[class*="tasty-recipe"] [class*="ingredient"] p:last-child`,`[class*=recipe] [class*=recipe] ~ p + ul li:last-child`],size:[[225,65],[234,60],[300,100]],position:`afterend`,classNames:[`adthrive-native-recipe`],find:e=>{let t=document.querySelectorAll(e);return t.length>0?t[t.length-1]:null},requireSelectorMatch:!1,lazy:!0}},Kr=(e,t)=>{let n=t.inRecipeRecommendationSelectors?t.inRecipeRecommendationSelectors.split(`,`).map(e=>e.trim()):void 0;return n||e.selectors}})),qr,Jr,tte=o((()=>{qr=[`AAOSL_21`,`AFAM_2020`,`AFOI_2020`,`APIO_2022`,`ASOI_2022`,`BIPOC_2024`,`CMINO_2022`,`EXPFTR_24`,`FMLO_2021`,`FMOOI_2022`,`GENZ_2023`,`HISP_2023`,`HISPO_2022`,`INTSCR_24`,`LGBTOI_2022`,`LGBTQ_2021`,`MINO_2021`,`MOMS_2020`,`MRLOI_22`,`NWPR_2021`,`PKDSU12_24`,`RMOI_24`,`STKCONT_24`,`TGNAF_21`],Jr=[`AAOSL_21`,`AFAM_2020`,`AFOI_2020`,`APIO_2022`,`ASOI_2022`,`CMINO_2022`,`FMLO_2021`,`FMOOI_2022`,`GENZ_2023`,`HISP_2023`,`HISPO_2022`,`LGBTQ_2021`,`LGBTQOI_2021`,`MINO_2021`,`MOMS_2020`,`MRLOI_22`,`NWPR_2021`,`PKDSU12_2021`,`RMOI_24`,`TGNAF_21`]})),Yr,Xr,Zr,Qr,$r,ei=o((()=>{Yr=()=>Date.now(),Xr=e=>e.toISOString(),Zr=()=>Xr(new Date),Qr=(e,t)=>{let n=new Date(e),r=new Date(t);return r-n},$r=e=>{let t=e.slice(8,10);return parseInt(t)}})),ti,ni=o((()=>{Z(),w(),j(),E(),O(),ti=class{constructor(){T(this,`_map`,void 0),T(this,`_multiMap`,void 0),T(this,`setAbGroup`,void 0),this._map=new Map,this._multiMap=new Map,this.setAbGroup=!Hh().has(`at_features`)}set(e,t,n=`singular`){this.setAbGroup&&n===`singular`?this._map.set(e,t):this.setAbGroup&&n===`multi`&&this._multiMap.set(e,t)}get(e){let t=this._map.get(e),n=this._multiMap.get(e);return t||n}get groups(){return this.getMapGroups(`singular`)}get groupsAsObject(){return this.getMapGroupsAsObject(`singular`)}get multiGroups(){return this.getMapGroups(`multi`)}get multiGroupsAsObject(){return this.getMapGroupsAsObject(`multi`)}getMapGroups(e){let t=[],n=e===`singular`?this._map:this._multiMap;for(let[e,r]of n)Array.isArray(r)?r.forEach(n=>{t.push(`${e}:${n}`)}):t.push(`${e}:${r}`);return t}getMapGroupsAsObject(e){let t={},n=e===`singular`?this._map:this._multiMap;for(let e of n.keys()){let r=n.get(e);r&&(t[e]=r)}return t}},ti=D([C(),A(`design:paramtypes`,[])],ti)})),ri,nte=o((()=>{w(),ni(),O(),ri=class extends ti{},ri=D([C()],ri)})),ii=o((()=>{ni(),nte()})),ai,oi,rte=o((()=>{w(),rU(),Rm(),j(),E(),At(),O(),oi=class{constructor(e,t){this._consentEventBus=t,T(this,`_required`,void 0),T(this,`_consented`,void 0),T(this,`_storageKey`,`adthrive_act25-consent`),this._required=e.core.country===`CA`&&e.core.region===`QC`&&this._isFrenchLanguage(),this._consented=U.readInternalLocalStorage(this._storageKey),this._required&&this._setupListeners()}get required(){return this._required}get consented(){return this._consented}set consented(e){this._consented=e}_setupListeners(){this._consentEventBus.act25consentCaptured.on(e=>{this._consented=e})}_isFrenchLanguage(){var e,t;let n=(e=navigator.language&&navigator.language.toLowerCase())==null?``:e,r=(t=navigator.languages&&navigator.languages.map(e=>e.toLowerCase()))==null?[]:t;return n===`fr`||n.includes(`fr-`)||(r==null?void 0:r.some(e=>e===`fr`||e.includes(`fr-`)))}},oi=D([C(),A(`design:paramtypes`,[Object,typeof(ai=_r!==void 0&&_r)==`function`?ai:Object]),kt(0,ot(`AdThrive`))],oi)})),ite=o((()=>{rte()})),si,ci,ate=o((()=>{w(),rU(),Rm(),Z(),j(),E(),At(),O(),ci=class{constructor(e,t){var n,r,i;this.consentEventBus=t,T(this,`_required`,void 0),T(this,`_consent`,null),T(this,`_defaultOptIn`,void 0);let a=N((n=e.siteAds.adOptions.usCMP)==null?void 0:n.regions,[]),o=e.core.region&&a.includes(e.core.region);if(this._required=!!(o&&N((r=e.siteAds.adOptions.usCMP)==null?void 0:r.enabled,!1)),this._defaultOptIn=!!N((i=e.siteAds.adOptions.usCMP)==null?void 0:i.defaultOptIn,!1),this._required){let e=U.readExternalCookie(`usprivacy`);e===`1YNY`?this._consent=!0:e===`1YYY`&&(this._consent=!1),this.consentEventBus.usCmpConsentCaptured.on(e=>{this._consent=e},{handleEventsAlreadyEmitted:!0})}}get required(){return this._required}get consent(){return this._consent}get defaultOptIn(){return this._defaultOptIn}},ci=D([C(),A(`design:paramtypes`,[Object,typeof(si=_r!==void 0&&_r)==`function`?si:Object]),kt(0,ot(`AdThrive`))],ci)})),li=o((()=>{ate()})),ui,ote=o((()=>{mU(),$(),w(),j(),O(),ui=class extends pU{init(){this._key=`InterstitialAlt`,this._lookup=`INTERS5`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],ui.prototype,`run`,null),ui=D([C()],ui)})),di,fi=o((()=>{Rm(),ei(),di=()=>{try{let e=U.readExternalLocalStorage(`__lsv__`),t=e||[];if(window.innerWidth>=2500)return{isError:!1,canDisplay:!1};if(t.length){let e=Yr(),n=t[0],r=typeof n==`number`?e-n:0;return{isError:!1,canDisplay:r>36e5}}else return{isError:!1,canDisplay:!0}}catch(e){return{isError:!0,canDisplay:!1,message:e.message}}}})),pi,mi,hi,ste=o((()=>{w(),$(),ii(),fU(),X(),fi(),j(),E(),O(),hi=class extends iU{constructor(e,t){super(),this._siteExperiments=e,this._pubabgroup=t,T(this,`_choices`,[]),T(this,`_result`,!1),T(this,`key`,Xn.Interstitial);let{isError:n,canDisplay:r,message:i}=di();n&&M.error(`InterstitialSiteExperiment`,`constructor`,{message:i}),this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this.experimentConfig&&r&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}run(){let e=this._choices[0].weight/100,t=new ar(e).get();return t}setExperimentTargeting(){if(!this.enabled||!this.experimentConfig){M.error(`InterstitialSiteExperiment`,`setExperimentTargeting`,`() => %o`,`Experiment targeting requires an experiment config`);return}let e=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`,t=this._result?`on`:`off`;this._pubabgroup.set(e,t)}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],hi.prototype,`run`,null),hi=D([C(),A(`design:paramtypes`,[typeof(pi=uU!==void 0&&uU)==`function`?pi:Object,typeof(mi=ri!==void 0&&ri)==`function`?mi:Object])],hi)})),gi,_i,vi,cte=o((()=>{w(),$(),ii(),fU(),X(),j(),E(),O(),vi=class extends iU{constructor(e,t){super(),this._siteExperiments=e,this._pubabgroup=t,T(this,`_choices`,[]),T(this,`_result`,!1),T(this,`key`,Xn.FooterCloseButton),this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}run(){let e=this._choices[0].weight/100;return new ar(e).get()}setExperimentTargeting(){if(!this.enabled||!this.experimentConfig){M.error(`RemoveFooterCloseButtonSiteExperiment`,`setExperimentTargeting`,`() => %o`,`Experiment targeting requires an experiment config`);return}let e=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`,t=this._result?`on`:`off`;this._pubabgroup.set(e,t)}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],vi.prototype,`run`,null),vi=D([C(),A(`design:paramtypes`,[typeof(gi=uU!==void 0&&uU)==`function`?gi:Object,typeof(_i=ri!==void 0&&ri)==`function`?_i:Object])],vi)})),yi,lte=o((()=>{yi=`,s1143,s480,s1222,s909,s911,s949,s940,s919,s1233,s1237,s1239,s2767,s94,s154,s1053,s1058,s1250,s1256,s1257,s921,s944,s1004,s941,s930,s929,s1524,s927,s1989,s2825,s966,s1020,s2472,s92,s1277,s114,s115,s119,s2518,s1254,s122,s234,s155,s1156,s2516,s1583,s198,s1293,s7,s129,s1498,s26,s995,s2520,s362,s1376,s721,s105,s219,s88,s202,s143,s2433,s454,s1513,s1392,s231,s80,s413,s148,s1072,s1219,s270,s1273,s1315,s306,s227,s1565,s2902,s2644,s1367,s1402,s920,s496,s937,s1600,s163,s2636,s720,s611,s167,s741,s1141,s2904,s107,s743,s269,s118,s177,s232,s910,s427,s117,s527,s366,s2504,s759,s1082,s567,s186,s724,s840,s722,s430,s580,s98,s450,s18,s1037,s1119,s194,c55503,s320,s255,s203,s1209,s579,s915,s740,s961,s1168,`})),bi,ute=o((()=>{bi=e=>{let t=e.replace(/\s+/g,``);return t=t.replace(/^,+|,+$/g,``),t.length===0?``:`,${t},`}})),xi,Si,Ci,wi=o((()=>{w(),Z(),ote(),ste(),cte(),fi(),$(),lte(),ute(),j(),E(),At(),O(),Ci=class{constructor(e,t,n){var r,i,a,o,s,c,l,u,d,f;this._interstitialSiteExperiment=t,this._removeFooterCloseButtonSiteExperiment=n,T(this,`adInViewTime`,void 0),T(this,`allowSmallerAdSizes`,void 0),T(this,`bgColor`,void 0),T(this,`footerSelector`,void 0),T(this,`interstitial`,void 0),T(this,`pmp`,void 0),T(this,`footerCloseButton`,void 0),T(this,`footerCloseButtonMobile`,void 0),T(this,`footerCloseButtonDesktop`,void 0),T(this,`infiniteScroll`,void 0),T(this,`infiniteScrollOptions`,void 0),T(this,`infiniteScrollRefresh`,void 0),T(this,`isAutoOptimized`,void 0),T(this,`footerCloseButtonMigrated`,!1),T(this,`targetAff`,void 0),T(this,`spa`,void 0),T(this,`stickyContentEnabled`,void 0),T(this,`stickyContentHeight`,void 0),T(this,`stickyRecipeHeight`,void 0),T(this,`stickyHeaderSelectors`,void 0),T(this,`stickyBlockedSelectors`,void 0),T(this,`dynamicStickySidebarEnabled`,void 0),T(this,`dynamicStickySidebarHeight`,void 0),T(this,`dynamicStickySidebarBlockedSelectors`,void 0),T(this,`dynamicStickySidebarHeaderSelectors`,void 0),T(this,`dynamicContentSlotLazyLoading`,void 0),T(this,`desktopInterstitial`,void 0),T(this,`mobileInterstitial`,void 0),T(this,`prioritizeShorterVideoAds`,void 0),T(this,`optimizeVideoPlayersForEarnings`,void 0),T(this,`longerVideoAdPod`,void 0),T(this,`secColor`,void 0),T(this,`contentTermsFooterEnabled`,void 0),T(this,`wakeLock`,void 0),T(this,`gatedPrint`,void 0),T(this,`usCMP`,void 0),T(this,`consentMode`,void 0);let{adInViewTime:p,allowSmallerAdSizes:m,bgColor:h,footerCloseButton:g,footerCloseButtonMobile:_,footerCloseButtonDesktop:v,footerSelector:y,infiniteScroll:b,infiniteScrollOptions:ee,infiniteScrollRefresh:te,isAutoOptimized:ne,pmp:re,targetaff:ie,stickyContainerConfig:ae,sidebarConfig:oe,siteAttributes:se,dynamicContentSlotLazyLoading:ce,desktopInterstitial:le,mobileInterstitial:ue,prioritizeShorterVideoAds:de,optimizeVideoPlayersForEarnings:fe,longerVideoAdPod:pe,secColor:me,contentTermsFooterEnabled:he,wakeLock:ge,usCMP:_e,gatedPrint:ve}=e.siteAds.adOptions;this.allowSmallerAdSizes=N(m,!0),_!==void 0&&v!==void 0&&(this.footerCloseButtonMigrated=!0);let ye=this._isGamInterstitialNetworkExperimentEnabled(e),be=this._interstitialSiteExperiment.enabled,xe=be?this._interstitialSiteExperiment.result:ye;if(this.interstitial={gam:xe,prebid:!1},this._removeFooterCloseButtonSiteExperiment.enabled){let e=!this._removeFooterCloseButtonSiteExperiment.result;this.footerCloseButton=e,this.footerCloseButtonMobile=e,this.footerCloseButtonDesktop=e}else this.footerCloseButton=N(g,!0),this.footerCloseButtonMobile=N(_,!0),this.footerCloseButtonDesktop=N(v,!0);this.adInViewTime=p?p*1e3:void 0,this.bgColor=N(h,`#FFFFFF`),this.footerSelector=N(y,``),this.pmp=N(re,!0),this.infiniteScroll=N(b,!1),this.infiniteScrollOptions=N(ee,{}),this.infiniteScrollRefresh=N(te,!0),this.isAutoOptimized=N(ne,!1),this.targetAff=N(ie,!1),this.spa=N(e.siteAds.adOptions.spa,!1),this.stickyContentEnabled=ae==null||(r=ae.content)==null?void 0:r.enabled,this.stickyContentHeight=ae==null||(i=ae.content)==null?void 0:i.minHeight,this.stickyRecipeHeight=tG()?ae==null||(a=ae.recipeMobile)==null?void 0:a.minHeight:ae==null||(o=ae.recipeDesktop)==null?void 0:o.minHeight,this.stickyHeaderSelectors=ae==null?void 0:ae.stickyHeaderSelectors,this.stickyBlockedSelectors=ae==null?void 0:ae.blockedSelectors,this.dynamicStickySidebarEnabled=oe==null||(s=oe.dynamicStickySidebar)==null?void 0:s.enabled,this.dynamicStickySidebarHeight=oe==null||(c=oe.dynamicStickySidebar)==null?void 0:c.minHeight,this.dynamicStickySidebarBlockedSelectors=oe==null||(l=oe.dynamicStickySidebar)==null?void 0:l.blockedSelectors,this.dynamicStickySidebarHeaderSelectors=tG()?se==null?void 0:se.mobileHeaderSelectors:se==null?void 0:se.desktopHeaderSelectors,this.dynamicContentSlotLazyLoading=N(ce,!1),this.desktopInterstitial=N(le,!1),this.mobileInterstitial=N(ue,!1),this.prioritizeShorterVideoAds=N(de,!0),this.optimizeVideoPlayersForEarnings=N(fe,!1),this.longerVideoAdPod=N(pe,!0),this.secColor=N(me,`#000000`),this.contentTermsFooterEnabled=N(he,!0),this.wakeLock=ge,this.gatedPrint=ve,this.usCMP=N(_e,{enabled:!1,regions:[],defaultOptIn:!1}),this.consentMode={enabled:(u=(d=e.siteAds.adOptions.consentMode)==null?void 0:d.enabled)==null?!1:u,customVendorList:bi(((f=e.siteAds.adOptions.consentMode)==null?void 0:f.customVendorList)||yi)}}_isGamInterstitialNetworkExperimentEnabled(e){let{isError:t,canDisplay:n,message:r}=di(),i=tG()&&N(e.siteAds.adOptions.mobileInterstitial,!1),a=!tG()&&N(e.siteAds.adOptions.desktopInterstitial,!1);if(t&&M.error(`InterstitialExperiment`,`canDisplayInterstitial`,{message:r}),n&&(i||a)){let e=x.resolve(ui);return!!(e&&e.result&&e.result!==`off`)}return!1}},Ci=D([C(),A(`design:paramtypes`,[Object,typeof(xi=hi!==void 0&&hi)==`function`?xi:Object,typeof(Si=vi!==void 0&&vi)==`function`?Si:Object]),kt(0,ot(`AdThrive`))],Ci)})),Ti=o((()=>{wi()})),Ei,Di=o((()=>{Wt(),Ei=Ut((e=navigator.userAgent)=>/Windows NT|Macintosh/i.test(e))})),Oi,ki,Ai,ji,Mi,Ni=o((()=>{dn(),Di(),Oi=(e=navigator.userAgent)=>/iP(hone|od|ad)/i.test(e),ki=(e=navigator.userAgent)=>e.includes(`android`)||e.includes(`Android`),Ai=(e,t=navigator.userAgent)=>RegExp(`OS ${e}`,`i`).test(t),ji=(e,t=navigator.userAgent)=>Oi(t)&&Ai(e.toString(),t),Mi=(e=navigator.userAgent)=>$t(e)&&Ei(e)})),Pi,Fi,Ii,dte=o((()=>{w(),fU(),$(),ii(),Nt(),j(),E(),At(),O(),Ii=class extends tr{constructor(e,t,n){super(),T(this,`_result`,!0),T(this,`key`,`Amazon`),T(this,`lookup`,`AMZN`),T(this,`_choices`,[{choice:!0},{choice:!1}]),T(this,`weight`,.995);let r=e.deliveryFeatures,i=n.getCoreExperimentButMutateWeights(this.key,this.lookup);if(!(r&&r.includes(`amazonLoad`))&&i){this._expConfigABGroup=i.abgroup;let e=i.variants[0];this.weight=e.weight,this._result=this.run(),t.set(i.abgroup,this._result?`on`:`off`)}}get result(){return this._result}run(){return new ar(this.weight).get()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],Ii.prototype,`run`,null),Ii=D([C(),A(`design:paramtypes`,[Object,typeof(Pi=ti!==void 0&&ti)==`function`?Pi:Object,typeof(Fi=jt!==void 0&&jt)==`function`?Fi:Object]),kt(0,ot(`AdThrive`))],Ii)})),Li,Ri,zi,Bi,Vi=o((()=>{ii(),Mt(),w(),nr(),j(),E(),At(),O(),zi=`You need to set "this._key" in the init method for this experiment. The code should look something like this:

  protected init() {
    this._key = 'my_key';
  }`,Bi=class extends tr{get _choices(){return null}get key(){if(!this._key)throw Error(zi);return this._key}get lookup(){return this._lookup||``}constructor(e,t){super(),this.abgroupClass=e,this._coreExperimentConfig=t,T(this,`_type`,void 0),T(this,`_result`,void 0),T(this,`_stickyResult`,void 0),T(this,`_stickyWeight`,void 0),T(this,`_expConfigABGroup`,void 0),T(this,`_setAbGroup`,!0),T(this,`_abGroupType`,`singular`),T(this,`_autorun`,!0),T(this,`_experiment`,void 0),T(this,`_key`,void 0),T(this,`_lookup`,void 0),this.init();let n=this._experiment=this._coreExperimentConfig.getCoreExperiment(this.key,this.lookup);this._type=(n==null?void 0:n.type)||`Unknown`,this.isEnabled()&&(this._expConfigABGroup=n==null?void 0:n.abgroup,this._autorun&&this._runAndSetABGroup())}_isMultiValueChoice(e){return this._type===`multivalueWeightedChoice`}_isGenericChoice(e){return this._type!==`multivalueWeightedChoice`}_isMultiValueResult(e){return this._type===`multivalueWeightedChoice`}_isGenericResult(e){return this._type!==`multivalueWeightedChoice`}_runAndSetABGroup(){let e=this._choices;if(e){let t=this._result=this.run();if(t===void 0)return;this._isMultiValueResult(t)&&this._isMultiValueChoice(e)?this._setMultivalueABGroup(e,t):this._isGenericResult(t)&&this._isGenericChoice(e)&&this._setStandardABGroup(e,t)}return this._result}_setStandardABGroup(e,t){let n=e.filter(({choice:e})=>e===t)[0],r=(n==null?void 0:n.abvalue)||t;if(this._setAbGroup&&r!==void 0){var i;let e=(i=n==null?void 0:n.weight)==null?-1:i,t=this.getResultWeight(r,e);t!==100&&this.setABGroup(r,void 0,t)}}_setMultivalueABGroup(e,t){let n=[],r=this._experiment;if(!r)return;let i={};e.forEach(e=>{let t=`${e.choice}`;i[t]||(i[t]=[]),e.options.forEach(n=>{let r=Array.isArray(n.choice)?n.choice.join(`%7C`):`${n.choice}`;i[t].push({weight:n.weight,option:r,...n.abvalue&&{abvalue:n.abvalue},...e.keyABValue&&{keyABValue:e.keyABValue}})})}),t.forEach(e=>{if(i[e.choice])for(let a of i[e.choice]){var t,r;let i=Array.isArray(e.option)?e.option.join(`%7C`):`${e.option}`;i===a.option&&a.weight!==100&&n.push(`${(t=a.keyABValue)==null?e.choice:t}_${(r=a.abvalue)==null?a.option:r}@${a.weight}`)}}),n.length&&this.abgroupClass.set(r.abgroup,n,this._abGroupType)}getResultWeight(e,t=-1){let n=this._experiment;if(!n)return-1;if(n.type===`bernoulliTrial`){let t=n.variants[0].weight;return e?t:100-t}else if(n.type===`multivalueBernoulliTrial`){let e=new Map;return n.variants.forEach(t=>{e.set(t.value,t.weight)}),e}return t}setABGroup(e,t,n){var r;let i=this._experiment,a=(r=this._stickyWeight)==null?n:r;if(i)if(Array.isArray(e)){let n=e.filter(e=>typeof a==`number`?a!==100:a&&a.get(e)!==100).map(e=>`${e}@${typeof a==`number`?a:a&&a.get(e)||0}`);n.length||n.push(`none`),this.abgroupClass.set(t||i.abgroup,n,this._abGroupType)}else this.abgroupClass.set(t||i.abgroup,`${e}@${a}`,this._abGroupType)}init(){throw Error(zi)}get result(){return this._autorun===!1&&this._result===void 0&&this.abgroupClass.get(this.key)===void 0&&(this._result=this._runAndSetABGroup()),this._result}isEnabled(){if(this.shouldUseCoreExperimentsConfig){let e=this._experiment=this._coreExperimentConfig.getCoreExperiment(this.key,this.lookup);return!!e}return!0}},Bi=D([A(`design:paramtypes`,[typeof(Li=ti!==void 0&&ti)==`function`?Li:Object,typeof(Ri=jt!==void 0&&jt)==`function`?Ri:Object]),kt(0,ot(ti)),kt(1,ot(jt))],Bi)})),Hi,Ui=o((()=>{Vi(),fr(),E(),Hi=class extends Bi{constructor(...e){super(...e),T(this,`_stickyResult`,void 0),T(this,`_stickyWeight`,void 0)}get _choices(){var e;let t=(e=this._coreExperimentConfig.getCoreExperiment(this.key,this.lookup))==null?void 0:e.variants;return t?[{choice:!0,weight:t[0].weight},{choice:!1,weight:100-t[0].weight}]:[{choice:!0,weight:-1},{choice:!1,weight:-1}]}run(){let e=this._coreExperimentConfig.getCoreExperiment(this.key,this.lookup);if(e){let t=e.variants[0];return new ar(t.weight/100).get()}}setABGroup(e,t){let n=this._coreExperimentConfig.getCoreExperiment(this.key,this.lookup),r,i;if(n){let a=n.variants[0];this._stickyResult!==void 0&&this._stickyWeight!==void 0?(r=this._stickyResult?`on`:`off`,i=this._stickyWeight):(r=e?`on`:`off`,i=e?a.weight:100-a.weight),i!==100&&i!==0&&this.abgroupClass.set(t||n.abgroup,`${r}@${i}`)}}get result(){var e;return this._autorun===!1&&this._result===void 0&&this.abgroupClass.get(this.key)===void 0&&(this._result=this._runAndSetABGroup()),(e=this._result)==null?this._default:e}}})),Wi,fte=o((()=>{Ui(),w(),E(),O(),Wi=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`WebVitals`,this._lookup=`WVTLS`}},Wi=D([C()],Wi)})),Gi,Ki,qi=o((()=>{$(),Z(),Ni(),w(),dte(),fte(),j(),E(),At(),O(),Ki=class{constructor(e,t){T(this,`amazonEnabled`,void 0),T(this,`bootstrapResult`,new Map),T(this,`webVitalsEnabled`,void 0),T(this,`gptLibFailedToLoad`,void 0),T(this,`bootstrapLoaders`,{}),T(this,`isAmazonPreloaded`,void 0),T(this,`isGPTPreloaded`,void 0),T(this,`isPrebidPreloaded`,void 0),T(this,`isCmpPreloaded`,void 0),T(this,`_host`,void 0),T(this,`_baseUrl`,void 0),T(this,`_targetPath`,void 0),T(this,`isGDPR`,void 0),this.webVitalsEnabled=Zt()?x.resolve(Wi).result:!1,this.gptLibFailedToLoad=!1,this.isGDPR=e.gdpr===`true`;let n=Oi()?`/s2s`:``;this._host=e.host,this._baseUrl=e.baseUrl,this._targetPath=`${e.targetPath}${n}`||`/es2018${n}`;let r=e.deliveryFeatures;this.isAmazonPreloaded=!!(r&&r.includes(`amazonLoad`)),this.isGPTPreloaded=!!(r&&r.includes(`gptLoad`)),this.isPrebidPreloaded=!!(r&&r.includes(`prebidLoad`)),this.isCmpPreloaded=!!(r&&r.includes(`consentManagerCMP`)),this.amazonEnabled=t.result||this.isAmazonPreloaded}get host(){return this._host}get baseUrl(){return this._baseUrl}get targetPath(){return this._targetPath}},Ki=D([Q(`BootstrapConfig`),C(),A(`design:paramtypes`,[Object,typeof(Gi=Ii!==void 0&&Ii)==`function`?Gi:Object]),kt(0,ot(`AdThrive`))],Ki)})),Ji,Yi=o((()=>{bt(),w(),E(),O(),Ji=class{constructor(){T(this,`_initialized`,!1),T(this,`_initPromise`,null),T(this,`_initComplete`,new k)}async ready(){var e;if(this._initialized)return;let t=(e=this._initPromise)==null?new Promise(e=>{this._initComplete.once(()=>{e()})}):e;await t}isAmazonLoaded(){return!!window.apstag}init(e){this.isAmazonLoaded()&&window.apstag.init(e),this._initialized=!0,this._initComplete.emit()}async fetchBids(e,t){await this.ready(),this.isAmazonLoaded()&&window.apstag.fetchBids(e,t)}async setDisplayBids(){await this.ready(),this.isAmazonLoaded()&&window.apstag.setDisplayBids()}async targetingKeys(){return await this.ready(),this.isAmazonLoaded()?window.apstag.targetingKeys():[]}async rpa(e){await this.ready(),this.isAmazonLoaded()&&window.apstag.rpa(e,this.tokenCallback,!1)}async upa(e){await this.ready(),this.isAmazonLoaded()&&window.apstag.upa(e,this.tokenCallback,!1)}tokenCallback(e){e&&(document.cookie=`AMZN-Token=${e.AIPToken}; expires=${e.cookieExpiry}; path=/;`)}async dpa(e){await this.ready(),this.isAmazonLoaded()&&window.apstag.dpa(e)}async renderImp(e,t){if(await this.ready(),this.isAmazonLoaded()){var n,r;(n=(r=window.apstag).renderImp)==null||n.call(r,e,t)}}setupAmazonWindow(e){window.apstag={init:()=>{e(`i`,arguments)},customPlacements:()=>({}),fetchBids:()=>{e(`f`,arguments)},setDisplayBids:()=>{},targetingKeys:()=>[],dpa:()=>{e(`di`,arguments)},rpa:()=>{e(`ri`,arguments)},upa:()=>{e(`ui`,arguments)},queue:[]}}queuePush(e,t){window.apstag.queue.push([e,t,new Date().getTime()])}},Ji=D([C()],Ji)})),Xi,Zi,Qi,$i=o((()=>{w(),qi(),X(),$(),Z(),Yi(),j(),E(),At(),O(),Qi=class{constructor(e,t,n){this._bootstrapConfig=t,this._amazonMethods=n,T(this,`type`,Ln.Amazon),T(this,`wait`,!0),T(this,`_url`,`https://c.aps.amazon-adsystem.com/apstag.js`),T(this,`_link`,`https://c.aps.amazon-adsystem.com`),T(this,`_amazonUAM`,void 0),this._amazonUAM=e.siteAds.adOptions.amazonUAM}async load(){return this._bootstrapConfig.amazonEnabled&&this._amazonUAM?(this._init(),this._bootstrapConfig.isAmazonPreloaded?Promise.resolve(!0):(this._addAmazonLinks(),this._addApstag())):Promise.resolve(!1)}_addApstag(){return ta(this._url)}_addAmazonLinks(){let e=this._link;PG(e,`dns-prefetch`),PG(e,`preconnect`,[{name:`crossorigin`,value:``}])}_init(){if(this._amazonMethods.isAmazonLoaded())return;let e=(e,t)=>{this._amazonMethods.queuePush(e,t)};this._amazonMethods.setupAmazonWindow(e)}},Qi=D([Q(`AmazonBootstrap`),S(),A(`design:paramtypes`,[Object,typeof(Xi=Ki!==void 0&&Ki)==`function`?Xi:Object,typeof(Zi=Ji!==void 0&&Ji)==`function`?Zi:Object]),kt(0,ot(`AdThrive`))],Qi)})),ea,ta,na=o((()=>{ea=(e,t)=>{let n=document.getElementsByTagName(`script`)[0];n&&n.parentNode&&!t?n.parentNode.insertBefore(e,n):document.body.appendChild(e)},ta=(e,t=!1,n=!1,r=!1)=>new Promise((i,a)=>{let o=document.createElement(`script`);o.addEventListener(`error`,()=>a(Error(`Failed to import script ${e}`))),o.addEventListener(`load`,()=>i(o)),o.type=`text/javascript`,o.src=e,o.defer=n,o.async=r,ea(o,t)})})),ra,ia,aa,oa,sa,ca,pte=o((()=>{ra=()=>({totalClusterCount:0,totalSourceCount:0,uniqueSources:[],uniqueIds:[],uniqueTraits:[],lastSeen:null,lastSeenSource:null,lastSeenSourceClusterCount:0,lastSeenSourceIds:[],lastSeenSourceTraits:[]}),ia=(e,t)=>e<t?-1:e>t?1:0,aa=(e,t)=>{var n,r;return((n=t.lastSeen)==null?0:n)-((r=e.lastSeen)==null?0:r)},oa=e=>Array.from(new Set(e)).sort(ia),sa=e=>{var t;let n={metadata:ra(),sources:{mediawallah:{clusters:[]},truedata:{clusters:[]},id5:{clusters:[]}},lmpid:(t=e.lmpid)==null?``:t};return e.clusters?(e.clusters.forEach(e=>{var t;let r=(t=e.ids)==null?[]:t,i=null;e.traits.forEach(e=>{let{key:t,value:a}=e;if(t===`metadata`&&a){let e=a.split(`|`);e.forEach(e=>{let t=JSON.parse(e),{id:a,metadata:o}=t,{last_seen:s,percentile:c,source:l,cookie_type:u}=o,d=l==null?void 0:l.toLowerCase(),f=a;d!=null&&d.includes(`mediawallah`)?i=`mediawallah`:d!=null&&d.includes(`truedata`)?i=`truedata`:d!=null&&d.includes(`id5`)&&(i=`id5`,f=`id5:${f}`);let p=Array.from(new Set([f,...r])).sort(ia),m={lastSeen:new Date(s*1e3).getTime(),...i===`id5`?{cookieType:u.toLowerCase().replace(/\s/g,``)}:{},...(i===`mediawallah`||i===`truedata`)&&c!==void 0?{percentile:parseInt(c)}:{}};i&&(n.metadata.uniqueIds.push(...p),n.metadata.uniqueSources.push(i),n.metadata.uniqueTraits.push(...Object.keys(m)),n.sources[i].clusters.push({ids:p,traits:m})),(!n.metadata.lastSeen&&m.lastSeen||n.metadata.lastSeen&&m.lastSeen&&m.lastSeen>n.metadata.lastSeen)&&(n.metadata.lastSeen=m.lastSeen,n.metadata.lastSeenSource=i,n.metadata.lastSeenSourceIds=oa([...r,f]),n.metadata.lastSeenSourceTraits=Object.keys(m).sort(ia))})}})}),n.metadata.totalClusterCount=Object.values(n.sources).reduce((e,t)=>e+t.clusters.length,0),n.metadata.lastSeenSourceClusterCount=n.metadata.lastSeenSource===`mediawallah`?n.sources.mediawallah.clusters.length:n.sources.truedata.clusters.length,n.metadata.uniqueSources=oa(n.metadata.uniqueSources),n.metadata.uniqueIds=oa(n.metadata.uniqueIds),n.metadata.uniqueTraits=oa(n.metadata.uniqueTraits),n.metadata.totalSourceCount=n.metadata.uniqueSources.length,Object.values(n.sources).forEach(e=>{e.clusters.sort((e,t)=>aa(e.traits,t.traits))}),n):n},ca=e=>{let t={metadata:ra(),sources:{raptive:{clusters:[]}}};if(!e.clusters)return t;let n=[],r=[];return e.clusters.forEach(e=>{var i;let a={cookieDeprecationLabel:[],lastSeen:null,hemCollectionDate:[],hemSites:[],hemSources:[],browser:[],device:[],os:[],trueDataHems:[]};e.traits.forEach(e=>{let{key:t,value:n}=e;switch(t){case`cookieDeprecationLabel`:a.cookieDeprecationLabel.push(n);break;case`hem_cd`:var r;let e=new Date(n).getTime();a.hemCollectionDate.push(e),e>((r=a.lastSeen)==null?0:r)&&(a.lastSeen=e);break;case`hem_dates`:var i;let t=new Date(n).getTime();t>((i=a.lastSeen)==null?0:i)&&(a.lastSeen=t);break;case`hem_sites`:a.hemSites.push(n);break;case`hem_sources`:a.hemSources.push(n);break;case`browser`:a.browser.push(n);break;case`device`:a.device.push(n);break;case`os`:a.os.push(n);break;case`td_hems`:a.trueDataHems.push(n);break;default:break}}),Object.entries(a).forEach(([e,t])=>{Array.isArray(t)&&(a[e]=Array.from(new Set(t)).sort(ia))}),t.sources.raptive.clusters.push({ids:Array.from(new Set((i=e.ids)==null?[]:i)).sort(ia),traits:a}),t.metadata.uniqueIds.push(...e.ids),t.metadata.uniqueTraits.push(...Object.keys(a)),a.lastSeen&&(!t.metadata.lastSeen||a.lastSeen>t.metadata.lastSeen)&&(t.metadata.lastSeen=a.lastSeen,t.metadata.lastSeenSource=`raptive`,n=e.ids,r=Object.keys(a))}),t.metadata.lastSeenSourceIds=oa(n),t.metadata.lastSeenSourceTraits=oa(r),t.metadata.totalClusterCount=t.sources.raptive.clusters.length,t.metadata.lastSeenSourceClusterCount=t.sources.raptive.clusters.length,t.metadata.totalSourceCount=1,t.metadata.uniqueSources.push(`raptive`),t.metadata.uniqueIds=oa(t.metadata.uniqueIds),t.metadata.uniqueTraits=oa(t.metadata.uniqueTraits),Object.values(t.sources).forEach(e=>{e.clusters.sort((e,t)=>aa(e.traits,t.traits))}),t}})),la,ua=o((()=>{na(),Tr(),pte(),w(),IK(),O(),la=class{async load(e,t){var n,r,i,a;let o=`s-${e}`;(n=window.optable)!=null&&n.instance&&(r=window.optable)!=null&&r.auth&&((i=window.optable)==null?void 0:i.site)===o&&((a=window.optable.auth)==null?void 0:a.site)===o||(window.optable=window.optable||{cmd:[]},window.optable.site=o,window.optable.geo=t===`CA`?`US`:t,window.optable.auth||(window.optable.auth={}),window.optable.auth.site=o,window.optable.instance||(window.optable.instance={},window.optable.instance.dcn=window.optable.instance.dcn||{}),window.optable.tests||(window.optable.tests={}),await ta(wr))}setDCNExperiments(e){var t;(t=window.optable)!=null&&t.instance&&(window.optable.instance.dcn=window.optable.instance.dcn||{},window.optable.instance.dcn.experiments=e)}loaded(){var e,t,n;return!!((e=window.optable)!=null&&e.site)&&!!((t=window.optable)!=null&&t.instance)&&!!((n=window.optable)!=null&&n.auth)}addToQueue(e){var t,n;window.optable=window.optable||{cmd:[]},window.optable.cmd=((t=window.optable)==null?void 0:t.cmd)||[],(n=window.optable)==null||n.cmd.push(e)}async resolveRaptiveClusters(e){return new Promise((t,n)=>{this.addToQueue(()=>{var r;!((r=window.optable)==null||(r=r.auth)==null)&&r.resolve?window.optable.auth.resolve(e).then(e=>{let n=ca(e);t(n)}).catch(n):n(`Optable SDK 'resolve' method not available after loading SDK`)})})}async resolveThirdPartyClusters(e,t=!1){return new Promise((n,r)=>{this.addToQueue(()=>{var i,a;let o=t?(i=window.optable)==null?void 0:i.tests:(a=window.optable)==null?void 0:a.instance;o!=null&&o.resolve?o.resolve(e).then(e=>{let t=sa(e);n(t)}).catch(r):r(`Optable SDK 'resolve' method not available after loading SDK`)})})}cid(e,t=0){return new Promise((n,r)=>{this.addToQueue(()=>{var i;if(!(!((i=window.optable)==null||(i=i.SDK)==null)&&i.cid))r(`Optable SDK 'SDK.cid' method not available after loading SDK`);else{let r=window.optable.SDK.cid(e,t);n(r)}})})}eid(e){return new Promise((t,n)=>{this.addToQueue(()=>{var r;if(!(!((r=window.optable)==null||(r=r.SDK)==null)&&r.eid))n(`Optable SDK 'SDK.eid' method not available after loading SDK`);else{let n=window.optable.SDK.eid(e);t(n)}})})}async identify(...e){return new Promise((t,n)=>{this.addToQueue(()=>{var r;!((r=window.optable)==null||(r=r.auth)==null)&&r.identify?window.optable.auth.identify(...e).then(t).catch(n):n(`Optable SDK 'identify' method not available after loading SDK`)})})}async profile(e){return new Promise((t,n)=>{this.addToQueue(()=>{var r;!((r=window.optable)==null||(r=r.auth)==null)&&r.profile?window.optable.auth.profile(e).then(t).catch(n):n(`Optable SDK 'auth.profile' method not available after loading SDK`)})})}async targeting(){return new Promise((e,t)=>{this.addToQueue(()=>{var n;!((n=window.optable)==null||(n=n.auth)==null)&&n.targeting?window.optable.auth.targeting().then(e).catch(t):t(`Optable SDK 'auth.targeting' method not available after loading SDK`)})})}async tokenize(e){return new Promise((t,n)=>{this.addToQueue(()=>{var r;!((r=window.optable)==null||(r=r.instance)==null)&&r.tokenize?window.optable.instance.tokenize(e).then(e=>t(e)).catch(n):n(`Optable SDK 'instance.tokenize' method not available after loading SDK`)})})}installGPTSecureSignals(){return new Promise(e=>{this.addToQueue(()=>{window.googletag=window.googletag||{cmd:[]};let t=window.googletag;t.cmd.push(()=>{t.secureSignalProviders||(t.secureSignalProviders=[]),t.secureSignalProviders.push({id:`loblawmedia.ca`,collectorFunction:()=>{var e,t;return!((e=window.optable)==null||(e=e.auth)==null)&&e.lmpidFromCache?Promise.resolve((t=window.optable.auth.lmpidFromCache())==null?``:t):Promise.resolve(``)}})}),e()})})}},la=D([Q(`OptableSdkWrapper`),C()],la)})),da,fa=o((()=>{Vi(),fr(),E(),da=class extends Bi{constructor(...e){super(...e),T(this,`_default`,void 0)}get _choices(){let e=this._coreExperimentConfig.getMultivalueBernoulliVariants(this.key,this.lookup);return!e||e.length,e}run(){let e=this._choices;if(e){let t=e.filter(e=>new ar(e.weight/100).get()).map(e=>e.choice);t.length&&(this._result=t)}return this._result||this._default}get choices(){return this._choices}}})),pa,mte=o((()=>{w(),fa(),O(),pa=class extends da{init(){this._key=`OptableCountryAllowlist`,this._lookup=`OPTCA`,this._default=[]}},pa=D([C()],pa)})),ma,hte=o((()=>{w(),fa(),O(),ma=class extends da{init(){this._key=`OptableCountryRegionBlocklist`,this._lookup=`OPTCRB`,this._default=[]}},ma=D([C()],ma)})),gte,ha,ga,_te=o((()=>{w(),Z(),mte(),hte(),j(),E(),At(),O(),ga=class{constructor(e,t,n){var r,i,a,o;this._optableCountryAllowlistExperiment=t,this._optableCountryRegionBlocklistExperiment=n,T(this,`enabled`,void 0),T(this,`loblawEnabled`,void 0),T(this,`identifierOverride`,void 0);let s=(r=(i=e.core)==null?void 0:i.country)==null?``:r,c=(a=(o=e.core)==null||(o=o.region)==null?void 0:o.toUpperCase())==null?``:a,l=Hh().get(`optable_identifier`);this.enabled=this._getOptableEnabled(e,s,c),this.loblawEnabled=this.enabled&&s===`CA`,this.identifierOverride=l?decodeURIComponent(l):void 0}_getOptableEnabled(e,t,n){var r,i;if(!t||!n||!((r=this._optableCountryAllowlistExperiment.result)!=null&&r.includes(t))||(i=this._optableCountryRegionBlocklistExperiment.result)!=null&&i.includes(`${t}-${n}`))return!1;let a=Hh().get(`rptbt24`),o=e.invalidTraffic&&a!==`true`;return!o}},ga=D([C(),A(`design:paramtypes`,[Object,typeof(gte=pa!==void 0&&pa)==`function`?gte:Object,typeof(ha=ma!==void 0&&ma)==`function`?ha:Object]),kt(0,ot(`AdThrive`))],ga)})),_a=o((()=>{_te()})),va,vte=o((()=>{w(),Rm(),j(),E(),O(),va=class{constructor(){T(this,`globalPrivacyControl`,void 0),T(this,`gpcEnabled`,void 0),T(this,`gpcUpdated`,!1),this.globalPrivacyControl=!!window.navigator.globalPrivacyControl,this.gpcEnabled=U.readInternalLocalStorage(`adthrive_gpc`)===`true`}setGpcString(){!this.gpcEnabled&&this.globalPrivacyControl?(U.setInternalLocalStorage(`adthrive_gpc`,`${this.globalPrivacyControl}`),this._updateGPC()):this.gpcEnabled&&!this.globalPrivacyControl&&(U.deleteLocalStorage(`adthrive_gpc`),this._updateGPC())}_updateGPC(){this.gpcEnabled=!!this.globalPrivacyControl,this.gpcUpdated=!0}},va=D([C(),A(`design:paramtypes`,[])],va)})),ya=o((()=>{vte()})),ba,xa,Sa,Ca,wa,Ta=o((()=>{ba=[`CA`,`CT`,`UT`,`VA`,`WA`],xa=e=>{let t=document.getElementsByTagName(`meta`);return!!Array.from(t).filter(t=>t.name===e&&t.content===`true`).length},Sa=()=>xa(`child-directed-treatment`),Ca=e=>{let t=!1;return e&&(t=ba.includes(e)),xa(`health-directed-treatment`)&&t},wa=()=>xa(`sensitive-finance-treatment`)})),yte,bte,Ea,xte=o((()=>{Rm(),bt(),w(),Ta(),li(),rU(),j(),E(),At(),O(),Ea=class{constructor(e,t,n){var r;this._usCmp=t,this._consentEventBus=n,T(this,`nonCompliantBidders`,[`unruly`]),T(this,`ccpaNotApplicable`,`1---`),T(this,`ccpaOptIn`,`1YNY`),T(this,`ccpaOptOut`,`1YYY`),T(this,`comscoreParams`,void 0),T(this,`privacyString`,void 0),T(this,`required`,void 0),T(this,`userOptedOut`,void 0),T(this,`gpcEnabled`,void 0),T(this,`consentChange`,new k),T(this,`optOutText`,`Do not sell or share my personal information.`),T(this,`optInText`,`Customize my ad experience.`),T(this,`deviceAccess`,!1),T(this,`usCmpRequired`,this._usCmp.required);let i=e==null||(r=e.core)==null?void 0:r.region;this.required=e.gdpr!==`true`,this.privacyString=U.readExternalCookie(`usprivacy`),this.userOptedOut=this.privacyString===this.ccpaOptOut,this.gpcEnabled=U.readInternalLocalStorage(`adthrive_gpc`),this._usCmp.required&&(this._usCmp.defaultOptIn?this.userOptedOut=this.privacyString===this.ccpaOptOut:this.userOptedOut=!this._usCmp.consent,this._consentEventBus.usCmpConsentCaptured.on(e=>{this.userOptedOut=!e,this.consentChange.emit(e?this.ccpaOptIn:this.ccpaOptOut)},{handleEventsAlreadyEmitted:!0})),this.consentChange=new k,Sa()||wa()&&this.required||Ca(i)&&this.required?this.privacyString=this.ccpaOptOut:!this.privacyString&&this.required&&(this.privacyString=this.ccpaOptIn),this.consentChange.on(e=>{this.privacyString=e}),this.required&&(this.comscoreParams=this.userOptedOut?`0`:`1`)}get enabled(){return this.required&&this.userOptedOut}},Ea=D([C(),A(`design:paramtypes`,[Object,typeof(yte=ci!==void 0&&ci)==`function`?yte:Object,typeof(bte=_r!==void 0&&_r)==`function`?bte:Object]),kt(0,ot(`AdThrive`))],Ea)})),Da=o((()=>{xte()})),Oa,ka,Aa,Ste=o((()=>{dn(),Oa=(e,t)=>{var n;let r=e||navigator.userAgent,i=t||navigator.vendor;if(!$t(r,i))return!1;let a=/ Version\/(1\d)\.(\d+)/,o=((n=a.exec(r))==null?void 0:n.slice(-2))||[],s=o[0]===`14`,c=o[0]===`15`&&+o[1]<4;return s||c},ka=()=>{Oa()&&window.addEventListener(`beforeunload`,()=>{window.addEventListener(`visibilitychange`,e=>{e.stopImmediatePropagation()},!0)},!0)},Aa=()=>{ka()}})),ja,Ma=o((()=>{w(),Ste(),$(),bt(),j(),E(),O(),ja=class{setupOnceEvent(e,t,n=window){let r=()=>{n.removeEventListener(e,r),t()};n.addEventListener(e,r)}setupOnceEventWithPromise(e,t=window){return new Promise(n=>{let r=i=>(t.removeEventListener(e,r),n(i));t.addEventListener(e,r)})}addEventListener(e,t,n=window){n.addEventListener(e,()=>{t.emit()},!1)}_handleScreenChange(){let e=screen.orientation.type,t=e.includes(`portrait`)?`portrait`:`landscape`;this._currentDeviceOrientation!==t&&(this.deviceOrientationChange.emit(),this._currentDeviceOrientation=t)}constructor(){var e;T(this,`beforeUnload`,new k),T(this,`pageHide`,new k),T(this,`resize`,new k),T(this,`scroll`,new k),T(this,`visibilityChange`,new k),T(this,`keydown`,new k),T(this,`deviceOrientationChange`,new k),T(this,`_currentDeviceOrientation`,void 0),this.addEventListener(`beforeunload`,this.beforeUnload),this.addEventListener(`pagehide`,this.pageHide),this.addEventListener(`resize`,this.resize),this.addEventListener(`scroll`,this.scroll),this._handleScreenChange=this._handleScreenChange.bind(this),(e=window)==null||(e=e.screen)==null||(e=e.orientation)==null||e.addEventListener(`change`,this._handleScreenChange),this.addEventListener(`visibilitychange`,this.visibilityChange,document),this.addEventListener(`keydown`,this.keydown,document),Aa()}},ja=D([Q(`PageManager`),C(),A(`design:paramtypes`,[])],ja)})),Na=o((()=>{Ma()})),Pa,Cte=o((()=>{Na(),w(),Rm(),Pa=e=>{let t=U.readExternalCookie(`_ga`),n=U.readExternalCookie(`_gid`);if(!(t||n)){let e=x.resolve(ja);e.beforeUnload.on(()=>{})}}})),Fa,Ia=o((()=>{Fa=e=>{let t=new URLSearchParams(window.location.search);return t.get(e)}})),L,La=o((()=>{w(),$(),Cte(),Z(),Ia(),Rm(),j(),E(),At(),O(),L=class{constructor(e,t){var n,r,i;T(this,`host`,void 0),T(this,`privacySandboxHost`,void 0),T(this,`baseUrl`,void 0),T(this,`branch`,void 0),T(this,`bucket`,void 0),T(this,`debug`,void 0),T(this,`plugin`,void 0),T(this,`deployment`,void 0),T(this,`domain`,void 0),T(this,`invalidTraffic`,void 0),T(this,`device`,void 0),T(this,`pageUrl`,void 0),T(this,`fastAds`,void 0),T(this,`pageviewKey`,void 0),T(this,`sessionKey`,void 0),T(this,`querystring`,void 0),T(this,`styleUrl`,void 0),T(this,`adsMinLoadDuration`,void 0),T(this,`connectionTargeting`,[]),T(this,`downlink`,void 0),T(this,`integration`,void 0),T(this,`deliveryVersion`,void 0),T(this,`country`,void 0),T(this,`region`,void 0),T(this,`savedReferrer`,void 0),T(this,`isFirstPageview`,void 0),T(this,`ri`,void 0),T(this,`salesThrottle`,void 0),T(this,`rsi`,void 0),T(this,`browsingTopics`,void 0),T(this,`gpid`,void 0),T(this,`isWordPressLogin`,void 0),T(this,`utm`,{});let{bucket:a,core:o,plugin:s,branch:c,debug:l,deployment:u,baseUrl:d,host:f,fastAds:p,siteAds:m,styleUrl:h,invalidTraffic:g,integration:_,deliveryVersion:v}=e,{tablet:y,desktop:b}=m.breakpoints;this.host=f.replace(`https://`,``),this.privacySandboxHost=this._getPrivacySandboxHost().replace(`https://`,``),this.baseUrl=d,this.branch=c,this.bucket=a,this.country=o&&o.country,this.region=o&&o.region,this.plugin=s,this.fastAds=p,this.invalidTraffic=g,this.deployment=u,this.domain=window.location.host,this.device=Cn(y,b),this.pageUrl=window.location.href,this.pageviewKey=t;let ee=this.querystring=Hh();this.sessionKey=this.setSessionKey(),this.styleUrl=h,this.debug=l,this.integration=_,this.deliveryVersion=v,this.savedReferrer=U.readInternalLocalStorage(`adthrive_referrer`),this.isFirstPageview=ZG(),this.isWordPressLogin=this._isWordPressLogin(),this.gpid=this._getGpFromStorage(`id5id`)||this._getGpFromStorage(`pbjs-id5id`);let te=N(U.readInternalLocalStorage(`adthrive_utm`),{});[`utm_medium`,`utm_campaign`,`utm_session`,`utm_source`,`utm_content`,`utm_term`].forEach(e=>{let t=ee.get(e),n=N(t,te[e]);n&&(this.utm[e]=n)}),this.ri=ee.has(`ri`)?ee.get(`ri`):String(Math.floor(Math.random()*200)),this.salesThrottle=ee.has(`st`)?ee.get(`st`):String(Math.floor(Math.random()*200));let ne=U.readInternalLocalStorage(`adthrive_rsi`);this.rsi=ne||String(Math.floor(Math.random()*200)),ne||U.setInternalLocalStorage(`adthrive_rsi`,this.rsi);let re=(n=(r=window.performance)==null||(i=r.getEntriesByType)==null?void 0:i.call(r,`resource`))==null?[]:n,ie=re.filter(e=>e.name.includes(`ads.min.js`)&&e.name.includes(`ads.adthrive.com`))[0];if(ie){let e=Math.round(ie.responseEnd-ie.startTime).toString();e!==`NaN`&&(this.adsMinLoadDuration=[e])}let ae=window.navigator&&(window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection);ae&&(ae.effectiveType&&this.connectionTargeting.push(`niet:${ae.effectiveType}`),this.downlink=ae.downlink||ae.bandwidth,this.downlink&&this.connectionTargeting.push(`dl:${this.downlink}`));let oe=U.readInternalLocalStorage(`adthrive_browsing_topics`);this.browsingTopics=Array.isArray(oe)?oe:[]}setSessionKey(){let e=U.readInternalLocalStorage(`adthrive_session_key`);if(e)return e;{let e=KK();return U.setExpirableInternalLocalStorage(`adthrive_session_key`,e,{expiry:{value:24,unit:`hours`},resetOnRead:!0}),U.deleteLocalStorage(`adthrive_fpv`),Pa(e),e}}get browsingTopicsSupported(){return fn()}get browsingTopicsTaxonomyVersion(){var e;return(e=this.browsingTopics)==null||(e=e[0])==null?void 0:e.taxonomy_version}_getGpFromStorage(e){let t=U.readExternalLocalStorage(e);if(!(typeof t!=`string`||!t))try{return JSON.parse(decodeURIComponent(t)).gp}catch(e){return}}_isWordPressLogin(){return document.getElementById(`wpadminbar`)?!0:window.location.href?window.location.href.includes(`/wp-admin`):!1}_getPrivacySandboxHost(){var e;return(e=Fa(`at_privacy_sandbox_host`))==null?`privacysandbox.adthrive.com`:e}},L=D([C(),A(`design:paramtypes`,[Object,String]),kt(0,ot(`AdThrive`)),kt(1,ot(`PageviewKey`))],L)})),Ra=o((()=>{La()})),za,wte=o((()=>{Ui(),w(),E(),O(),za=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`OptTknEndpoint`,this._lookup=`OTKE`,this.abgroup=`otke`}},za=D([C()],za)})),Ba,Va,Ha,Ua=o((()=>{Ba=()=>new Promise(e=>setTimeout(e,0)),Va=()=>window.scheduler.yield(),Ha=(()=>window.scheduler&&`yield`in window.scheduler&&typeof window.scheduler.yield==`function`?Va:Ba)()})),Wa,Tte=o((()=>{Wa={GetPiiData:`adthrive_GetPiiData`,SetPiiData:`adthrive_SetPiiData`,SetIdentityData:`adthrive_SetIdentityData`,DeletePiiData:`adthrive_DeletePiiData`,SendPiiData:`adthrive_SendPiiData`}})),Ga,Ete=o((()=>{w(),Z(),fU(),j(),E(),At(),O(),Ga=class extends tr{constructor(e){super(),T(this,`_result`,void 0),T(this,`key`,`SensOff`),T(this,`lookup`,`SENSOFF`),T(this,`abgroup`,`SensOffExperiment`),T(this,`_sensCategories`,void 0),T(this,`_choices`,[]),this._sensCategories=N(e.siteAds.adOptions.sensitiveCategories,[]),this._choices=this._sensCategories.map(e=>({choice:[e]})),this._result=this.run()}get result(){return this._result}run(){return this._sensCategories.filter(()=>new ar(.01).get())}},Ga=D([C(),A(`design:paramtypes`,[Object]),kt(0,ot(`AdThrive`))],Ga)})),Ka,qa,Dte=o((()=>{w(),Z(),Ete(),j(),E(),At(),O(),qa=class{constructor(e,t){var n,r,i;this._sensOffExperiment=t,T(this,`id`,void 0),T(this,`name`,void 0),T(this,`verticals`,void 0),T(this,`filteredSensitiveCategories`,void 0),T(this,`sensitiveCategories`,void 0),T(this,`sensCategoriesOff`,void 0),T(this,`breakpoints`,void 0),T(this,`style`,void 0),T(this,`spa`,void 0),T(this,`enableCategoriesNetworkWide`,[`drg`,`conl`]),T(this,`disableCategoriesNetworkWide`,[`dlu`]),T(this,`deployedCloudflareVersion`,void 0),T(this,`category`,void 0),T(this,`_verticalCategoryMap`,new Map([[`Baby`,`family`],[`Family and Parenting`,`family`],[`Natural Parenting`,`family`],[`Pregnancy`,`family`],[`Toddler`,`family`],[`Personal Finance`,`finance`],[`Professional Finance`,`finance`],[`Deals`,`finance`],[`Clean Eating`,`food`],[`Food`,`food`],[`Crafts`,`home`],[`Gardening`,`home`],[`Green Living`,`home`],[`Home Decor and Design`,`home`],[`Pets`,`home`],[`Travel`,`travel`],[`News`,`news`],[`Lifestyle`,`lifestyle`],[`Beauty`,`lifestyle`],[`Other`,`lifestyle`],[`Health and Fitness`,`health`],[`Entertainment`,`entertainment`],[`Sports`,`sports`],[`Womens Style`,`womensstyle`],[`Mens Style and Grooming`,`mensstyle`],[`Tech`,`tech`],[`Wedding`,`wedding`],[`Auto`,`auto`]])),T(this,`_categoryPriorityList`,new Set([`food`,`home`,`family`,`finance`,`travel`,`news`,`health`,`entertainment`,`sports`,`womensstyle`,`mensstyle`,`tech`,`wedding`,`auto`,`lifestyle`])),this.id=e.siteAds.siteId,this.name=e.siteAds.siteName,this.verticals=e.siteAds.adOptions.verticals,this.sensitiveCategories=N(e.siteAds.adOptions.sensitiveCategories,[]).filter(e=>!this.enableCategoriesNetworkWide.includes(e)&&!this.disableCategoriesNetworkWide.includes(e)),this.sensCategoriesOff=this._sensOffExperiment.result,this.filteredSensitiveCategories=this.sensitiveCategories.filter(e=>this.sensCategoriesOff.indexOf(e)===-1),this.breakpoints=e.siteAds.breakpoints,this.style=e.style,this.spa=N(e.siteAds.adOptions.spa,!1),this.deployedCloudflareVersion=(n=(r=e.siteAds.cloudflare)==null?void 0:r.version)==null?null:n,this.category=(i=this._getCategory())==null?`food`:i}_getCategory(){let e=this.verticals.filter(e=>this._verticalCategoryMap.has(e)).map(e=>this._verticalCategoryMap.get(e));for(let t of this._categoryPriorityList)if(e.includes(t))return t}},qa=D([C(),A(`design:paramtypes`,[Object,typeof(Ka=Ga!==void 0&&Ga)==`function`?Ka:Object]),kt(0,ot(`AdThrive`))],qa)})),Ja=o((()=>{Dte()})),Ya,Xa,Za,Qa,$a,eo,Ote,to,no,ro,kte,io,Ate,ao=o((()=>{Rm(),Tr(),Ya=e=>new TextEncoder().encode(e),Xa=e=>new TextDecoder().decode(e),Za=async e=>{let t=Ya(e);return crypto.subtle.importKey(`raw`,t.slice(0,16),{name:`AES-GCM`},!1,[`encrypt`,`decrypt`])},Qa=async(e,t)=>{let n=await Za(t),r=Uint8Array.from(atob(e),e=>e.charCodeAt(0)),i=r.slice(0,12),a=r.slice(12),o=await crypto.subtle.decrypt({name:`AES-GCM`,iv:i},n,a);return JSON.parse(Xa(o))},$a=e=>{let t=String.fromCharCode(...new Uint8Array(e)),n=btoa(t);return n.replace(/\+/g,`-`).replace(/\//g,`_`).replace(/=+$/,``)},eo=e=>{e=e.replace(/-/g,`+`).replace(/_/g,`/`);let t=(4-e.length%4)%4;e+=`=`.repeat(t);let n=atob(e);return Uint8Array.from(n,e=>e.charCodeAt(0))},Ote=async(e,t)=>{let n=await Za(t),r=Ya(JSON.stringify(e)),i=crypto.getRandomValues(new Uint8Array(12)),a=await crypto.subtle.encrypt({name:`AES-GCM`,iv:i},n,r),o=new Uint8Array(i.length+a.byteLength);return o.set(i),o.set(new Uint8Array(a),i.length),$a(o.buffer)},to=async(e,t)=>{let n=await Za(t),r=eo(e),i=r.slice(0,12),a=r.slice(12),o=await crypto.subtle.decrypt({name:`AES-GCM`,iv:i},n,a);return JSON.parse(Xa(o))},no=async(e=!0)=>{try{let t=U.readInternalLocalStorage(I.IDENTITY_DATA.KEY);if(typeof t!=`object`)return null;if(t&&e)for(let e of Object.values(t))typeof e.d==`string`&&(e.d=await to(e.d,e.s));return t}catch(e){return null}},ro=async(e=!0)=>{let t=await no(e);if(t){if(t.direct)return t.direct.d;if(t.graph1p)return t.graph1p.d;if(t.graph3p)return t.graph3p.d;if(t.liveIntent)return t.liveIntent.d}return null},kte=async(e,t)=>{let n=[`direct`,`graph1p`,`graph3p`,`liveIntent`],r=n.findIndex(t=>e[t]),i=n.findIndex(e=>t[e]);if(r<i)return e;if(i<r)return t;try{let i=n[r],a=e[i],o=t[i];if(a&&o){let n=typeof a.d==`string`?await to(a.d,a.s):a.d,r=typeof o.d==`string`?await to(o.d,o.s):o.d;if(n.collectionDate&&r.collectionDate)return new Date(n.collectionDate)>new Date(r.collectionDate)?e:t}}catch(t){return e}return e},io=async(e,t,n=!0,r)=>{let i=await no(!1)||{},a=e.collectionSiteId?e.collectionSiteId:t;i[e.collectionMethod]={d:e,s:a};for(let e of Object.values(i))n&&typeof e.d==`object`&&(e.d=await Ote(e.d,e.s)),!n&&typeof e.d==`string`&&(e.d=await to(e.d,e.s));return U.setInternalLocalStorage(I.IDENTITY_DATA.KEY,i),r&&U.setInternalCookie(I.IDENTITY_DATA.KEY,i),i},Ate=async()=>{let e=await no(!0)||{};e&&U.setInternalLocalStorage(I.IDENTITY_DATA.KEY,e)}})),oo,so=o((()=>{w(),bt(),E(),O(),oo=class{constructor(){T(this,`consentResponseCaptured`,new yt)}},oo=D([C()],oo)})),co,jte=o((()=>{w(),X(),j(),E(),At(),O(),co=class{constructor(e){T(this,`raptiveVendorId`,996),T(this,`nonCompliantBidders`,[P.ThirtyThreeAcross]),T(this,`revokedPurposeConsent`,!1),T(this,`cmpUserActionCompleteFired`,!1),T(this,`consentCaptured`,!1),T(this,`consentCapturedData`,{}),T(this,`_isRequired`,void 0),this._isRequired=e.gdpr===`true`}get enabled(){return this._isRequired}},co=D([C(),A(`design:paramtypes`,[Object]),kt(0,ot(`AdThrive`))],co)})),lo=o((()=>{jte()})),uo,fo=o((()=>{Lt(),uo=(e,t)=>{try{var n;if(typeof window.__cmp!=`function`)return!1;let r=window.__cmp(`getCMPData`),i=(r==null||(n=r.vendorConsents)==null?void 0:n[e])===!0,a=!!(t!=null&&t.every(e=>{var t;return(r==null||(t=r.purposeConsents)==null?void 0:t[e])===!0}));return i&&a}catch(e){return M.error(`util`,`checkConsentForVendor`,e),!1}}})),po,mo,ho,go,_o,vo,yo,bo,xo,So=o((()=>{w(),qi(),IK(),Lt(),rU(),Tte(),Da(),ya(),Ja(),ao(),Ra(),so(),lo(),fo(),j(),E(),O(),xo=class{constructor(e,t,n,r,i,a,o,s){this._bootstrapConfig=e,this._gpcConfig=t,this._gdprConfig=n,this._ccpaConfig=r,this._identityEventBus=i,this._gdprEvents=a,this._siteConfig=o,this._context=s,T(this,`_host`,`https://${this._bootstrapConfig.host}`.replace(`https://https://`,`https://`)),T(this,`_frame`,document.createElement(`iframe`)),T(this,`_baseUrl`,this._bootstrapConfig.baseUrl),T(this,`_frameSrc`,`${this._baseUrl.replace(`/gdpr`,``)}/html/i.html`),this.enabled&&(this._gdprConfig.enabled?this._gdprEvents.consentResponseCaptured.on(()=>{let e=uo(this._gdprConfig.raptiveVendorId,[1]);e&&this.start().catch(e=>{M.error(`PiiIframeManager`,`constructor`,`Failed to initialize identity iframe`,e)})},{handleEventsAlreadyEmitted:!0}):this.start().catch(e=>{M.error(`PiiIframeManager`,`constructor`,`Failed to initialize identity iframe`,e)}))}get enabled(){return!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut}async start(){await this._addIframeToPage(),this._identityEventBus.iframeReady.emit(),this._setupEventListeners()}deleteData(){try{if(this._frame.contentWindow){let e={action:Wa.DeletePiiData};this._frame.contentWindow.postMessage(e,this._host)}}catch(e){M.error(`PiiIframeManager`,`deleteIdentity`,`Failed to delete identity data`,e)}}setIdentityData(e){try{if(this._frame.contentWindow){let t={action:Wa.SetIdentityData,identityData:e,encrypt:this._context.querystring.get(`adt_encrypt`)!==`false`};this._frame.contentWindow.postMessage(t,this._host)}}catch(e){M.error(`PiiIframeManager`,`setIdentityData`,`Failed to set identity data`,e)}}setData(e){try{if(this._frame.contentWindow){let t={action:Wa.SetPiiData,piiData:e};this._frame.contentWindow.postMessage(t,this._host)}}catch(e){M.error(`PiiIframeManager`,`setIdentity`,`Failed to set identity data`,e)}}getData(){try{if(this._frame.contentWindow){let e={action:Wa.GetPiiData};this._frame.contentWindow.postMessage(e,this._host)}}catch(e){M.error(`PiiIframeManager`,`getIdentity`,`Failed to get identity data`,e)}}_addIframeToPage(){return new Promise(e=>{this._frame.src=this._frameSrc,this._frame.id=`adt-ii`,this._frame.style.display=`none`,this._frame.onload=()=>{e()},document.body.appendChild(this._frame)})}_setupEventListeners(){this._identityEventBus.dataCapturedLegacy.on(e=>{let{sha1Hash:t,sha256Hash:n,source:r,sourceCollectedDate:i}=e;(n||t||r)&&this.setData({sha1Hash:t,sha256Hash:n,source:r,sourceCollectedDate:i})},{handleEventsAlreadyEmitted:!0}),this._identityEventBus.dataCapturedForIframe.on(e=>{e&&this.setIdentityData(e)},{handleEventsAlreadyEmitted:!0}),this._ccpaConfig.consentChange.on(e=>{e===this._ccpaConfig.ccpaOptOut&&this.deleteData()}),this._frame.contentWindow&&window.addEventListener(`message`,e=>void this._handleMessageEvent(e))}async _handleMessageEvent(e){let t=e.data.action;if(e.origin===this._host&&t===Wa.SendPiiData){let t=e.data.piiData;t&&!t.sourceCollectedDate&&(t.sourceCollectedDate=null);let n=e.data.identityDataFromLocalStorage,r=e.data.identityDataFromCookie,i;n&&typeof n==`object`&&r&&typeof r==`object`?i=await kte(n,r):n&&typeof n==`object`?i=n:r&&typeof r==`object`&&(i=r),this._identityEventBus.dataSentFromIframe.emit({...t&&{piiData:t},...i&&{identityData:i}})}}},xo=D([Q(`PiiIframeManager`),C(),A(`design:paramtypes`,[typeof(po=Ki!==void 0&&Ki)==`function`?po:Object,typeof(mo=va!==void 0&&va)==`function`?mo:Object,typeof(ho=co!==void 0&&co)==`function`?ho:Object,typeof(go=Ea!==void 0&&Ea)==`function`?go:Object,typeof(_o=Nr!==void 0&&Nr)==`function`?_o:Object,typeof(vo=oo!==void 0&&oo)==`function`?vo:Object,typeof(yo=qa!==void 0&&qa)==`function`?yo:Object,typeof(bo=L!==void 0&&L)==`function`?bo:Object])],xo)}));function Co(e){var t=typeof e;return e!=null&&(t==`object`||t==`function`)}var wo=o((()=>{})),To,Eo=o((()=>{To=typeof global==`object`&&global&&global.Object===Object&&global})),Do,Oo,ko=o((()=>{Eo(),Do=typeof self==`object`&&self&&self.Object===Object&&self,Oo=To||Do||Function(`return this`)()})),Ao,Mte=o((()=>{ko(),Ao=function(){return Oo.Date.now()}}));function Nte(e){for(var t=e.length;t--&&jo.test(e.charAt(t)););return t}var jo,Pte=o((()=>{jo=/\s/}));function Fte(e){return e&&e.slice(0,Nte(e)+1).replace(Mo,``)}var Mo,Ite=o((()=>{Pte(),Mo=/^\s+/})),No,Po=o((()=>{ko(),No=Oo.Symbol}));function Lte(e){var t=Io.call(e,Ro),n=e[Ro];try{e[Ro]=void 0;var r=!0}catch(e){}var i=Lo.call(e);return r&&(t?e[Ro]=n:delete e[Ro]),i}var Fo,Io,Lo,Ro,Rte=o((()=>{Po(),Fo=Object.prototype,Io=Fo.hasOwnProperty,Lo=Fo.toString,Ro=No?No.toStringTag:void 0}));function zte(e){return Bo.call(e)}var zo,Bo,Bte=o((()=>{zo=Object.prototype,Bo=zo.toString}));function Vo(e){return e==null?e===void 0?Uo:Ho:Wo&&Wo in Object(e)?Lte(e):zte(e)}var Ho,Uo,Wo,Go=o((()=>{Po(),Rte(),Bte(),Ho=`[object Null]`,Uo=`[object Undefined]`,Wo=No?No.toStringTag:void 0}));function Ko(e){return typeof e==`object`&&!!e}var qo=o((()=>{}));function Vte(e){return typeof e==`symbol`||Ko(e)&&Vo(e)==Jo}var Jo,Hte=o((()=>{Go(),qo(),Jo=`[object Symbol]`}));function Yo(e){if(typeof e==`number`)return e;if(Vte(e))return Xo;if(Co(e)){var t=typeof e.valueOf==`function`?e.valueOf():e;e=Co(t)?t+``:t}if(typeof e!=`string`)return e===0?e:+e;e=Fte(e);var n=Qo.test(e);return n||$o.test(e)?es(e.slice(2),n?2:8):Zo.test(e)?Xo:+e}var Xo,Zo,Qo,$o,es,Ute=o((()=>{Ite(),wo(),Hte(),Xo=NaN,Zo=/^[-+]0x[0-9a-f]+$/i,Qo=/^0b[01]+$/i,$o=/^0o[0-7]+$/i,es=parseInt}));function ts(e,t,n){var r,i,a,o,s,c,l=0,u=!1,d=!1,f=!0;if(typeof e!=`function`)throw TypeError(ns);t=Yo(t)||0,Co(n)&&(u=!!n.leading,d=`maxWait`in n,a=d?rs(Yo(n.maxWait)||0,t):a,f=`trailing`in n?!!n.trailing:f);function p(t){var n=r,a=i;return r=i=void 0,l=t,o=e.apply(a,n),o}function m(e){return l=e,s=setTimeout(_,t),u?p(e):o}function h(e){var n=e-c,r=e-l,i=t-n;return d?os(i,a-r):i}function g(e){var n=e-c,r=e-l;return c===void 0||n>=t||n<0||d&&r>=a}function _(){var e=Ao();if(g(e))return v(e);s=setTimeout(_,h(e))}function v(e){return s=void 0,f&&r?p(e):(r=i=void 0,o)}function y(){s!==void 0&&clearTimeout(s),l=0,r=c=i=s=void 0}function b(){return s===void 0?o:v(Ao())}function ee(){var e=Ao(),n=g(e);if(r=arguments,i=this,c=e,n){if(s===void 0)return m(c);if(d)return clearTimeout(s),s=setTimeout(_,t),p(c)}return s===void 0&&(s=setTimeout(_,t)),o}return ee.cancel=y,ee.flush=b,ee}var ns,rs,os,ss=o((()=>{wo(),Mte(),Ute(),ns=`Expected a function`,rs=Math.max,os=Math.min})),cs,Wte=o((()=>{mU(),w(),O(),cs=class extends pU{init(){this._key=`EmailCaptureHandlerDebounceExperiment_2`,this._lookup=`ECHDE2`}},cs=D([C()],cs)})),ls,us=o((()=>{bt(),wt(),w(),E(),O(),ls=class extends Ct{constructor(...e){super(...e),T(this,`selectorFound`,new k)}},ls=D([C()],ls)})),ds,fs,ps,ms,hs,gs=o((()=>{w(),$(),bt(),Z(),rU(),So(),Tr(),Rm(),ss(),Wte(),ao(),us(),j(),E(),O(),hs=class{constructor(e,t,n,r){var i;this._identityEventBus=e,this._piiIframeManager=t,this._emailCaptureEventBus=r,T(this,`_elements`,[]),T(this,`_keydownListenerAdded`,!1),T(this,`_emailProviderOnPage`,!1),T(this,`_growMeOnPage`,!1),T(this,`_growMeSelector`,`[id^="grow-me-inline-subscribe-cta-root-"]`),T(this,`_growMeFormSelector`,`[class^="SubscribeCtaWidget___StyledDiv6-"]`),T(this,`emailCaptured`,new yt),T(this,`_emailProviders`,[{divSelector:`div[id$="-optin"]`,name:`OptInMonster`},{divSelector:`div[class^="cb-form-group"]`,name:`ConvertBox`},{divSelector:`div.sumo-form-wrapper.listbuilder-popup`,name:`SumoMe`},{divSelector:this._growMeSelector,name:`Grow.me`},{divSelector:`input[id="raptive-gated-print-modal-input"]`,name:`GatedPrint`}]),T(this,`_hashTypes`,[{key:`sha256Hash`,length:64},{key:`sha1Hash`,length:40}]),T(this,`_emailCheckTimeout`,1500),T(this,`_eventMap`,new Map([[`mousemove`,window],[`scroll`,window],[`mouseleave`,document],[`om.Campaign.startShow`,document]])),T(this,`_boundCallEventHandler`,void 0),T(this,`_boundProcessEventHandler`,void 0);let a=(i=n.result)==null?0:i;this._boundCallEventHandler=ts(this.callCheckEmailProviders.bind(this),a),this._boundProcessEventHandler=ts(this.processInputChange.bind(this),a),this.addEmailProviderListeners(),this._addElementListeners(),this._addKeydownEventListener(),this.collectIdentityDataFromStorage().catch(e=>{}),this._collectFromIframe()}captureEmail(e,t){this.checkSources(t),this.emailCaptured.emit({pii:{email:e,source:`${t}_c`,sourceCollectedDate:Bs()},identityDataSource:`emailCapture`})}checkSources(e){e=e===`slickstream`?`ss`:e;let t=[`url`,`urlh`,`c`,`nl`,`ss`,`l_s`,`l_i`,`api`,`grwm`,`g_td`,`ra_gpid`,`hc_gp`,`form`];e&&!t.includes(e)&&!(e!=null&&e.startsWith(`ss_`))&&M.event(`EmailCaptureHandler`,`checkSources`,`unknown source: `,e)}_processHash(e,t){return e&&typeof e==`string`&&e.match(/value/i)?this._retrieveBitHashString(e,t):e||``}async collectIdentityDataFromStorage(){let e=await no(),[t,n]=this._getStoredHashInfo(),r=this._getStoredSource(n),i=this._getStoredSourceCollectedDate();(e||t)&&this._processStoredIdentityData(e,t,r,i)}_getStoredHashInfo(){let e=U.readInternalCookie(`adt_ei`),t=U.readInternalLocalStorage(`adt_ei`),n=null,r=!1;return e?(n=e,r=!0):t&&(n=typeof t==`string`?{sha256Hash:t,sha1Hash:``}:t),[n,r]}_getStoredSource(e=!1){let t=U.readInternalCookie(`adt_emsrc`),n=t||U.readInternalLocalStorage(`adt_emsrc`)||`o_s`,r=n.includes(I.PII_SOURCE.VALUES.IDENTITY_IFRAME);if(r)return this._retrieveIframeSourceString(n);let i=n.includes(I.PII_SOURCE.PREFIXES.IDG)||n.includes(I.PII_SOURCE.PREFIXES.RAPTIVE_AUTH);if(i){let e=n.includes(I.PII_SOURCE.SUFFIXES.CAPTURE),t=!n.includes(I.PII_SOURCE.SUFFIXES.CAPTURE)&&!n.includes(I.PII_SOURCE.SUFFIXES.STORAGE);return t?`${n}${I.PII_SOURCE.SUFFIXES.CAPTURE}`:e?n.replace(`${I.PII_SOURCE.SUFFIXES.CAPTURE}`,`${I.PII_SOURCE.SUFFIXES.STORAGE}`):n}return this._determineSource(n,e)}_getStoredSourceCollectedDate(){return U.readInternalLocalStorage(`adt_emsrc_cd`)}_determineSource(e,t){let n=e===`url`||e===`urlh`||e===`urlhck`,r=e.endsWith(`_c`);return n?`${e}_c`:r?e.replace(/_c$/,`_s`):t?`cki_s`:e}_processStoredIdentityData(e,t,n,r){(n.includes(`:id5id`)||n.includes(`:pubm`))&&(n=n.replace(`:`,`-`));for(let e of this._hashTypes)if(t){let n=t[e.key];n!=null&&n.length&&(t[e.key]=this._processHash(n,e.length))}let i;t&&n&&(t.sha256Hash||t.sha1Hash)&&(i={sha256Hash:t.sha256Hash,sha1Hash:t.sha1Hash,source:n,sourceCollectedDate:r});let a;i&&n===`url_c`||n===`urlh_c`||n===`urlhck_c`?a={pii:{...i,source:n,sourceCollectedDate:Bs()},identityDataSource:`urlCapture`}:(e||i)&&(a={pii:i,...e&&{identityDataMap:e},identityDataSource:`browserStorage`}),a&&this.emailCaptured.emit(a)}_collectFromIframe(){this._identityEventBus.dataSentFromIframe.once(e=>{if(e.piiData){let t=e.piiData.source&&!e.piiData.source.includes(I.PII_SOURCE.PREFIXES.IDENTITY_IFRAME);t&&(e.piiData.source=`${I.PII_SOURCE.PREFIXES.IDENTITY_IFRAME}${e.piiData.source}`);let n={pii:e.piiData,identityDataMap:e.identityData,identityDataSource:`iframe`};this.emailCaptured.emit(n)}else this._identityEventBus.iframeDataSynced.emit()}),this._identityEventBus.iframeReady.on(()=>this._piiIframeManager.getData(),{handleEventsAlreadyEmitted:!0})}_retrieveBitHashString(e,t){let n=e.match(`\\w{${t}}`);return n?n[0]:``}_retrieveIframeSourceString(e){let t=e.match(/^(l_i)-(.*)/);return t&&t.length===3?t[0].replace(/_c$/,`_s`):`l_i`}addEmailProviderListeners(){this._eventMap.forEach((e,t)=>{e.addEventListener(t,this._boundCallEventHandler)})}removeEmailProviderListeners(){this._eventMap.forEach((e,t)=>{e.removeEventListener(t,this._boundCallEventHandler)})}callCheckEmailProviders(e){(e.type!==`mouseleave`||e.clientY<=0)&&setTimeout(()=>{this._emailProviderOnPage||this.emailProviderHandler()},this._emailCheckTimeout)}emailProviderHandler(){for(let e of this._emailProviders){let t=document.querySelectorAll(e.divSelector);if(t.length){this._emailCaptureEventBus.selectorFound.emit({selector:e.divSelector,providerName:e.name,divs:t}),e.divSelector.includes(`grow-me`)&&(this._growMeOnPage=!0),this.removeEmailProviderListeners(),this._emailProviderOnPage=!0,this._addElementListeners();break}}}setElements(){let e=`input[type=text], input[type=email], input[name=email]`;if(this._elements=Array.prototype.slice.call(document.querySelectorAll(e)),this._growMeOnPage){var t,n;let[r]=Array.from(document.querySelectorAll(this._growMeSelector)),i=(t=Array.prototype.slice.call(r==null||(n=r.shadowRoot)==null?void 0:n.querySelectorAll(e)))==null?[]:t;this._elements=[...this._elements,...i]}}_addKeydownEventListener(){document.addEventListener(`keydown`,e=>this._keydownEventListener(e))}_keydownEventListener(e){e.type===`keydown`&&e.key==`@`&&!this._keydownListenerAdded&&(this._keydownListenerAdded=!0,this._addElementListeners())}_addElementListeners(){this.setElements();for(let e of this._elements)e.addEventListener(`blur`,this._boundProcessEventHandler),e.addEventListener(`change`,this._boundProcessEventHandler)}removeElementListeners(){for(let e of this._elements)e.removeEventListener(`blur`,this._boundProcessEventHandler),e.removeEventListener(`change`,this._boundProcessEventHandler)}sourceOrigin(e){if(!e.form)return`form`;let{id:t}=e.form;if(t&&typeof t==`string`){if(t.includes(`comment`))return I.PII_SOURCE.VALUES.COMMENT;if(t.includes(`subscribe`))return I.PII_SOURCE.VALUES.NEWSLETTER;if(this._growMeOnPage&&e.form.querySelectorAll(this._growMeFormSelector))return I.PII_SOURCE.VALUES.GRWM;if(t===`raptive-gated-print-modal-form`)return`${I.PII_SOURCE.PREFIXES.HEM_CAPTURE}${I.PII_SOURCE.VALUES.GATED_PRINT}`}return`form`}processInputChange(e){let t=e.target,n=t.value,r=HW(n);if(r){let e=this.sourceOrigin(t);this.captureEmail(r,e),this.removeElementListeners()}}},hs=D([Q(`EmailCaptureHandler`),C(),A(`design:paramtypes`,[typeof(ds=Nr!==void 0&&Nr)==`function`?ds:Object,typeof(fs=xo!==void 0&&xo)==`function`?fs:Object,typeof(ps=cs!==void 0&&cs)==`function`?ps:Object,typeof(ms=ls!==void 0&&ls)==`function`?ms:Object])],hs)})),_s,Gte=o((()=>{_s=class{constructor(){}}})),vs,Kte=o((()=>{w(),Gte(),E(),O(),vs=class extends _s{constructor(...e){super(...e),T(this,`truedataHems`,[])}},vs=D([C()],vs)})),ys=o((()=>{Kte()})),bs,qte=o((()=>{w(),mU(),O(),bs=class extends pU{init(){this._key=`IdentityIframeSyncWait`,this._lookup=`IISW`}},bs=D([C()],bs)})),xs,Ss,Jte=o((()=>{w(),Rm(),ao(),Ja(),j(),E(),O(),Ss=class{constructor(e){this._site=e,T(this,`_rcid`,null)}get rcid(){return this._rcid}async identityData(){return await ro()}get hash(){let e=U.readInternalLocalStorage(`adt_ei`);if(e&&typeof e==`object`&&e.hasOwnProperty(`sha256Hash`))return this._retrieveValueFromObject(e.sha256Hash);if(e&&typeof e==`string`&&e.match(/sha256Hash/i))return this._retrieve64BitString(e)}get source(){let e=U.readInternalLocalStorage(`adt_emsrc`);return e||void 0}async getRcid(){if(this._rcid)return this._rcid;try{var e;let t=U.readExternalCookie(`_rcid`);if(!t)return null;typeof t==`string`?this._rcid=await Qa(t,this._site.id):typeof t==`object`&&!(t==null||(e=t.value)==null)&&e.sharedId?this._rcid=t:this._rcid=null}catch(e){this._rcid=null}return this._rcid}_retrieveValueFromObject(e){if(typeof e==`string`)return e;if(typeof e==`object`&&e.hasOwnProperty(`sha256Hash`))return typeof e.sha256Hash==`object`?this._retrieveValueFromObject(e.sha256Hash):e.sha256Hash}_retrieve64BitString(e){let t=/\w{64}/.exec(e);return t?t[0]:void 0}},Ss=D([C(),A(`design:paramtypes`,[typeof(xs=qa!==void 0&&qa)==`function`?xs:Object])],Ss)})),Cs=o((()=>{Jte()})),ws,Ts,Es,Yte=o((()=>{_a(),Cs(),w(),j(),E(),O(),Es=class{constructor(e,t){this._optableConfig=e,this._user=t,T(this,`_identityData`,null),T(this,`share`,async({blockGraphHem:e=!1,blockLiveIntentHem:t=!1}={})=>{var n;if(this._identityData=await this._user.identityData(),!this._identityData)return!1;let r=this._identityData.collectionMethod===`graph3p`,i=(n=r&&e)==null?!1:n,a=r&&!this._optableConfig.enabled;return i||a||this._identityData.collectionMethod===`liveIntent`&&t?!1:this._identityData.sha256Hash?this._identityData.sha256Hash:this._identityData.sha1Hash?this._identityData.sha1Hash:!1})}},Es=D([S(),A(`design:paramtypes`,[typeof(ws=ga!==void 0&&ga)==`function`?ws:Object,typeof(Ts=Ss!==void 0&&Ss)==`function`?Ts:Object])],Es)})),Ds,Os,ks=o((()=>{Rm(),Ds=`_pubcid`,Os=()=>U.readExternalLocalStorage(Ds)})),As,Xte=o((()=>{w(),fa(),O(),As=class extends da{init(){this._key=`IDHO`,this._lookup=`IDHO`,this._default=[`none`]}setABGroup(e,t){let n=this._coreExperimentConfig.getCoreExperiment(this.key,this.lookup);if(n&&Array.isArray(e)){let r=e.map(e=>`${e}`);this.abgroupClass.set(t||n.abgroup,r)}}},As=D([C()],As)})),js,Ms,Zte=o((()=>{w(),Xte(),j(),E(),O(),Ms=class{constructor(e){T(this,`subModule`,void 0),T(this,`percentages`,void 0),this.subModule=e.result;let t=e._choices;this.percentages=t==null?void 0:t.map(e=>{let t=e.choice,n=typeof e.weight==`number`?e.weight:0;return`${t}:${n}`})}},Ms=D([C(),A(`design:paramtypes`,[typeof(js=As!==void 0&&As)==`function`?js:Object])],Ms)})),Ns=o((()=>{Zte()})),Ps,Qte=o((()=>{Ps=(e,t)=>{var n;return!((n=e.subModule)!=null&&n.some(e=>e===t))}})),Fs=o((()=>{Yte(),ks(),Qte()})),Is,Ls,Rs=o((()=>{Rm(),Is=()=>{let e=U.readExternalCookie(`panoramaId`),t=U.readExternalCookie(`panoramaId_expiry`);if(e&&t&&Number(t)>Date.now())return e;let n=U.readExternalLocalStorage(`panoramaId`),r=U.readExternalLocalStorage(`panoramaId_expiry`);return n&&r&&Number(r)>Date.now()?n:null},Ls=e=>{if(!e)return;let t;return e===`truedata.com`?t=`t`:e===`mediawallah.com`?t=`m`:e===`liveintent.com`&&(t=`l`),t}})),zs,$te=o((()=>{Mr(),zs=class{static createIdentityData(e,t){switch(e){case`direct`:return new Or(t);case`graph3p`:return new kr(t);case`graph1p`:return new Ar(t);case`liveIntent`:return new jr(t)}}}})),Bs,Vs=o((()=>{Bs=(e=new Date)=>{let t=e.getTimezoneOffset(),n=new Date(e.getTime()-t*60*1e3);return n.toISOString().split(`T`)[0]}})),Hs,Us,Ws,Gs,Ks,qs,Js,Ys,Xs,Zs,Qs,$s=o((()=>{Tr(),Mr(),$te(),Vs(),$(),Hs=e=>e.includes(`${I.PII_SOURCE.PREFIXES.RAPTIVE_AUTH}${I.PII_SOURCE.VALUES.GPID}`)||e.includes(`${I.PII_SOURCE.PREFIXES.RAPTIVE_AUTH}${I.PII_SOURCE.VALUES.RCID}`)||e.includes(`${I.PII_SOURCE.PREFIXES.RAPTIVE_AUTH}${I.PII_SOURCE.VALUES.LPID}`)||e.includes(`${I.PII_SOURCE.PREFIXES.RAPTIVE_AUTH}${I.PII_SOURCE.VALUES.SHID}`),Us=e=>e.includes(I.PII_SOURCE.VALUES.ID5ID)?`id5id`:e.includes(I.PII_SOURCE.VALUES.PUBM)?`pubm`:`unknown`,Ws=e=>e.includes(I.PII_SOURCE.VALUES.GPID)?`gpid`:e.includes(I.PII_SOURCE.VALUES.RCID)?`rcid`:e.includes(I.PII_SOURCE.VALUES.LPID)?`lpid`:e.includes(I.PII_SOURCE.VALUES.SHID)?`shid`:`unknown`,Gs=e=>e.includes(I.PII_SOURCE.VALUES.TD)?`truedata`:e.includes(I.PII_SOURCE.VALUES.MW)?`mediawallah`:`unknown`,Ks=e=>typeof e==`string`&&e.trim().length>0,qs=e=>{var t,n,r;return(t=(n=(r=e.direct)==null?e.graph1p:r)==null?e.graph3p:n)==null?e.liveIntent:t},Js=e=>{let t=e.startsWith(I.PII_SOURCE.PREFIXES.IDENTITY_IFRAME)?e.slice(I.PII_SOURCE.PREFIXES.IDENTITY_IFRAME.length):e;return t.includes(I.PII_SOURCE.VALUES.SLICKSTREAM)||t.includes(`slickstream`)?`slickstream`:t.includes(I.PII_SOURCE.VALUES.URLHCK)?`urlConvertKit`:t.includes(I.PII_SOURCE.VALUES.URLH)?`urlHashed`:t.includes(I.PII_SOURCE.VALUES.URL)?`url`:t.includes(I.PII_SOURCE.VALUES.API)?`api`:t.includes(I.PII_SOURCE.VALUES.COOKIE)?`cookies`:t.includes(I.PII_SOURCE.VALUES.GRWM)?`growme`:t.includes(I.PII_SOURCE.VALUES.NEWSLETTER)?`newsletter`:t.includes(I.PII_SOURCE.VALUES.IDENTITY_IFRAME)?`identityIframe`:t.includes(`${I.PII_SOURCE.VALUES.LOCAL_STORAGE}_`)?`localStorage`:t.includes(`${I.PII_SOURCE.VALUES.GATED_PRINT}_`)?`gatedPrint`:t.includes(`${I.PII_SOURCE.VALUES.COMMENT}_`)?`comment`:t.includes(`${I.PII_SOURCE.VALUES.FORM}_`)?`form`:t.includes(`${I.PII_SOURCE.VALUES.OTHER}_`)?`other`:`unknown`},Ys=(e,t,n,r,i,a,o)=>{if(e===`iframe`||e===`browserStorage`)return null;let s={type:`email`,sha256Hash:i.sha256Hash,sha1Hash:i.sha1Hash?i.sha1Hash:void 0,collectionSiteId:n,collectionDate:a||Bs(),collectionSource:`capture`},c=null;if(e===`emailCapture`||e===`urlCapture`||e===`identityApi`){let e={...s,collectionMethod:`direct`,directSource:Js(t),...r&&{email:r}};c=zs.createIdentityData(`direct`,e)}else if(e===`raptiveDCN`){let e={...s,collectionMethod:`graph1p`,bridgingMethod:Ws(t),alternateIds:o};c=zs.createIdentityData(`graph1p`,e)}else if(e===`externalDCN`){let e={...s,collectionMethod:`graph3p`,graphSource:Gs(t),bridgingMethod:Us(t),alternateIds:o};c=zs.createIdentityData(`graph3p`,e)}else if(e===`sdkli`){let e={...s,collectionMethod:`liveIntent`,withUid2:!t.includes(`sdklir`)};c=zs.createIdentityData(`liveIntent`,e)}else M.error(`createIdentityDataFromCapturedData`,`Unknown identity data source:`,e);return c},Xs=e=>{let t=Er.get(e);return t||`unk`},Zs=e=>{let t=Dr.get(e);return t||`unk`},Qs=e=>{switch(e){case`id5id`:return`id5`;case`pubm`:return`pub`;case`unknown`:return`unk`}}})),ec,tc=o((()=>{Rm(),ec=()=>{let e=U.readExternalLocalStorage(`__tamLIResolveResult`),t=e?JSON.parse(decodeURIComponent(e)):null;return t}})),nc,rc,ic,ac,oc,sc,cc,lc,uc,dc,fc,pc,ene=o((()=>{w(),Ua(),$(),Z(),gs(),Tr(),rU(),ua(),ys(),_a(),ya(),Da(),qte(),Rm(),Fs(),Rs(),$s(),Ra(),Cs(),Ns(),tc(),dn(),ao(),j(),O(),pc=class{constructor(e,t,n,r,i,a,o,s,c,l,u){this._optableStore=e,this._gpcConfig=t,this._ccpaConfig=n,this._context=r,this._user=i,this._emailCaptureHandler=a,this._identityEventBus=o,this._optableSdkWrapper=s,this._identityIframeSyncWaitExperiment=c,this._optableConfig=l,this._idho=u}get enabled(){let e=!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut;return!!this._optableConfig.enabled&&!!e}async start(){if(this.enabled){await Ha();try{var e;let t=await this._user.identityData(),n=(e=t==null?void 0:t.sha256Hash)==null?t==null?void 0:t.sha1Hash:e,r=!!n,i=(t==null?void 0:t.collectionMethod)===`graph3p`,a=r&&(t==null?void 0:t.collectionMethod)===`liveIntent`,o=r&&i,s=r&&((t==null?void 0:t.collectionMethod)===`direct`||(t==null?void 0:t.collectionMethod)===`graph1p`);o||a?await this._resolveHemFromGraph({resolveRaptiveDCN:!0,resolveExternalSourceDCN:!1,storeNewHem:!0,storedHem:n}):s?await this._resolveHemFromGraph({resolveRaptiveDCN:!1,resolveExternalSourceDCN:!0,storeNewHem:!1,storedHem:n}):!r&&this._context.isFirstPageview&&await this._resolveHemFromGraph({resolveRaptiveDCN:!0,resolveExternalSourceDCN:!0,storeNewHem:!0,storedHem:n})}catch(e){M.error(`OptableHemResolver`,`start`,e)}finally{this._identityEventBus.optableWaterfallCompleted.emit()}}}async _resolveHemFromGraph(e){let t,n=[Sr.RCID,Sr.EMAIL],r=await this._user.getRcid();if(r&&r.value&&r.value.sharedId&&e.resolveRaptiveDCN&&(t=await this._resolveHemFromRaptiveDCN(r.value.sharedId,3,I.PII_SOURCE.VALUES.RCID,n)),!(t!=null&&t.hem)&&e.resolveRaptiveDCN){let e=Os();e&&(t=await this._resolveHemFromRaptiveDCN(e,6,I.PII_SOURCE.VALUES.SHID,n))}let{gpid:i}=this._context;if(!(t!=null&&t.hem)&&i&&e.resolveRaptiveDCN&&(t=await this._resolveHemFromRaptiveDCN(i,0,I.PII_SOURCE.VALUES.GPID,n)),!(t!=null&&t.hem)&&e.resolveRaptiveDCN){let e=Is();e&&(t=await this._resolveHemFromRaptiveDCN(e,7,I.PII_SOURCE.VALUES.LPID,n))}if(!(t!=null&&t.hem)&&e.resolveExternalSourceDCN){var a;let{pubmatic:n}=(a=ec())==null?{}:a;n&&(t=await this._resolveHemFromThirdPartyDCN(e,`pubm`,`c1:`+n))}if(!(t!=null&&t.hem)&&e.resolveExternalSourceDCN){var o;let n=(o=this._optableConfig.identifierOverride)==null?Dm(r==null?void 0:r.metadata.clientIp):o;t=await this._resolveHemFromThirdPartyDCN(e,`ip`,n)}let s=!1;if(!($t()||Jt())){await this._waitForIdentityIframeSync();let e=await ro();s=!!e&&(e.collectionMethod===`direct`||e.collectionMethod===`graph1p`)}t&&e.storeNewHem&&!s&&this._emailCaptureHandler.emailCaptured.emit({pii:{sha256Hash:t.hem,source:t.source,sourceCollectedDate:Bs()},identityDataSource:Hs(t.source)?`raptiveDCN`:`externalDCN`}),t!=null&&t.additionalResolvedIds&&t.additionalResolvedIds.length>0&&this._identityEventBus.optableIdentitiesCaptured.emit(t.additionalResolvedIds),Ps(this._idho,`raptiveDcn1Uid1Id`)&&this._handleUid1Capture(t==null?void 0:t.uid1)}async _resolveHemFromRaptiveDCN(e,t,n,r=[]){if(!Ks(e)){M.event(`OptableHemResolver`,`_resolveHemFromRaptiveDCN`,`resolveId is not a string or empty`,{resolveId:e});return}let i=await this._optableSdkWrapper.cid(e,t),a=await this._optableSdkWrapper.resolveRaptiveClusters(i);this._identityEventBus.optableRaptiveGraphResolved.emit(a);let o=a.sources.raptive.clusters,s=this._extractIdFromClusters(i,o,r),c=s.get(Sr.EMAIL),l=c==null?void 0:c[Math.floor(Math.random()*c.length)],u=l==null?void 0:l.id.substring(Sr.EMAIL.length),d;Ps(this._idho,`raptiveDcn1Uid1Id`)&&!U.readInternalLocalStorage(`adt_uid1`)&&(d=this._extractUid1FromCluster(l==null?void 0:l.cluster));let f=u?1:0;if(this._identityEventBus.optableResolveAnalytics.emit(`dcn1-${n}-${f}`),u){let e;if(r.length>0)for(let t of r){let n=s.get(t);if(n){var p;e=[...(p=e)==null?[]:p,...n.map(e=>e.id)]}}return{hem:u,source:`${I.PII_SOURCE.PREFIXES.RAPTIVE_AUTH}${n}${I.PII_SOURCE.SUFFIXES.CAPTURE}`,uid1:d,...e&&{additionalResolvedIds:e}}}else return}_extractIdFromClusters(e,t,n){let r=new Map;for(let i of n){let n=[];for(let r of t){if(!r.ids.includes(e))continue;for(let e of r.ids)e.startsWith(i)&&n.push({id:e,cluster:r})}r.set(i,n)}return r}_extractUid1FromCluster(e){if(!e)return;let t=e.ids.find(e=>e.startsWith(Sr.UID1));if(t){let n=cn();if(e.traits.browser&&e.traits.browser.length>0&&e.traits.browser.every(e=>e===n))return t.replace(Sr.UID1,``)}}async _resolveHemFromThirdPartyDCN(e,t,n){var r,i;let a=await this._optableSdkWrapper.resolveThirdPartyClusters(n);U.setInternalLocalStorage(`adt_otpgrd`,a),this._identityEventBus.optableThirdPartyGraphResolved.emit(a),this._optableConfig.loblawEnabled&&a.lmpid&&localStorage.setItem(I.OPTABLE_LMPID.KEY,a.lmpid);let o=Math.floor(Date.now()/1e3)-2160*60*60,s=[...a.sources.truedata.clusters,...a.sources.mediawallah.clusters].sort((e,t)=>t.traits.lastSeen-e.traits.lastSeen),c=s.filter(e=>{let t=e.traits.lastSeen,n=`percentile`in e.traits?e.traits.percentile:void 0;return t?t>=o:n?n>=55:!1}),l=c.reduce((e,t)=>{let n=t.ids.filter(e=>e.startsWith(Sr.EMAIL));return[...e,...n]},[]),u=a.sources.truedata.clusters.reduce((e,t)=>{let n=t.ids.filter(e=>e.startsWith(Sr.EMAIL));return[...e,...n]},[]),d=l.length>0?1:0;this._identityEventBus.optableResolveAnalytics.emit(`dcn2-${t}-${d}`),l.length>0&&(this._optableStore.truedataHems=u);let f={clusterCount:c.length,hemCount:l.length,traits:(r=(i=c[0])==null?void 0:i.traits)==null?{}:r,accuracyResult:{status:`no-stored-hem`},recencyGroup:c[0]?Em(c[0].traits.lastSeen):`NA`};if(e.storedHem){let t=c.filter(t=>t.ids.some(t=>t.includes(e.storedHem))),n=c.reduce((e,n,r)=>t.includes(n)?r:e,-1);if(n!==-1){var p;f.accuracyResult={status:`hem-found`,matchingClusterIndex:n},f.traits=((p=c[n])==null?void 0:p.traits)||[]}else f.accuracyResult={status:`no-stored-hem`};M.event(`OptableHemResolver`,`_resolveHemFromExternalSourceDCN`,f)}if(this._identityEventBus.optableResolved.emit(f),!l.length||!e.storeNewHem||!c.length||!l.length)return;let m=l[Math.floor(Math.random()*l.length)],h=Sr.EMAIL.length,g=m==null?void 0:m.substring(h);if(!Ks(g)){M.event(`OptableHemResolver`,`_resolveHemFromExternalSourceDCN`,`Extracted HEM is not a string or empty`,{hem:g});return}let _=this._getHemSourceResolveResponseData(a,m)===`truedata`?I.PII_SOURCE.VALUES.TD:I.PII_SOURCE.VALUES.MW,v=``;if(_){let e=e=>`${e}-${I.PII_SOURCE.VALUES.PUBM}`;t===`pubm`&&(_=e(_)),v=`${I.PII_SOURCE.PREFIXES.IDG}${_}${I.PII_SOURCE.SUFFIXES.CAPTURE}`}if(!(!g||!v))return{hem:g,source:v}}_getHemSourceResolveResponseData(e,t){for(let n of Object.keys(e.sources))for(let r of e.sources[n].clusters)if(r.ids.includes(t))return n;return null}_waitForIdentityIframeSync(){var e;let t=(e=this._identityIframeSyncWaitExperiment.result)==null?0:e;return new Promise(e=>{let n=setTimeout(()=>{this._identityEventBus.iframeDataSynced.off(r),e()},t),r=()=>{clearTimeout(n),this._identityEventBus.iframeDataSynced.off(r),e()};this._identityEventBus.iframeDataSynced.on(r,{handleEventsAlreadyEmitted:!0})})}_handleUid1Capture(e){let t=U.readInternalLocalStorage(`adt_uid1`);if(!t&&e&&(U.setInternalLocalStorage(`adt_uid1`,e),t=e),t){let e={source:`adserver.org`,matcher:`raptive.com`,inserter:`cafemedia.com`,mm:5,uids:[{atype:1,id:t,ext:{dcn:`dcn1`}}]};this._identityEventBus.optableUid1Captured.emit(e)}}},pc=D([Q(`OptableHemResolver`),C(),A(`design:paramtypes`,[typeof(nc=vs!==void 0&&vs)==`function`?nc:Object,typeof(rc=va!==void 0&&va)==`function`?rc:Object,typeof(ic=Ea!==void 0&&Ea)==`function`?ic:Object,typeof(ac=L!==void 0&&L)==`function`?ac:Object,typeof(oc=Ss!==void 0&&Ss)==`function`?oc:Object,typeof(sc=hs!==void 0&&hs)==`function`?sc:Object,typeof(cc=Nr!==void 0&&Nr)==`function`?cc:Object,typeof(lc=la!==void 0&&la)==`function`?lc:Object,typeof(uc=bs!==void 0&&bs)==`function`?uc:Object,typeof(dc=ga!==void 0&&ga)==`function`?dc:Object,typeof(fc=Ms!==void 0&&Ms)==`function`?fc:Object])],pc)})),mc,hc,gc,_c,vc,yc,bc,xc,tne=o((()=>{w(),X(),$(),Z(),ua(),_a(),ya(),Da(),Ra(),wte(),ene(),j(),E(),At(),O(),xc=class{constructor(e,t,n,r,i,a,o,s){this._optableConfig=t,this._gpcConfig=n,this._ccpaConfig=r,this._optableSdkWrapper=i,this._optableTokenizeEndpointExperiment=a,this._context=o,this._optableHemResolver=s,T(this,`type`,Ln.Optable),T(this,`wait`,!1),T(this,`_optableTimingData`,{}),T(this,`_siteId`,``),this._siteId=e.siteAds.siteId}async load(){try{if(this._optableTimingData.bootstrapStarted=AK(),await this._checkAndInitSDK(),!this._optableConfig.enabled||this._gpcConfig.gpcEnabled||this._ccpaConfig.userOptedOut)return;this._optableTimingData.bootstrapFinished=AK()}catch(e){M.error(`OptableBootstrap`,`load`,`Failed to bootstrap Optable SDK`,e);return}this._optableTimingData.resolveStarted=AK(),await this._optableHemResolver.start(),this._optableTimingData.resolveFinished=AK(),this._shouldLogTimingData()&&M.event(`OptableBootstrap`,`load`,`Optable timing data`,this._optableTimingData)}async _checkAndInitSDK(){this._optableConfig.enabled&&(this._gpcConfig.gpcEnabled||this._ccpaConfig.userOptedOut||await this._initOptableSDK())}_shouldLogTimingData(){return Math.random()>=.95}async _initOptableSDK(){if(!this._optableSdkWrapper.loaded()){var e;await this._optableSdkWrapper.load(this._siteId,(e=this._context.country)==null?``:e)}this._optableTokenizeEndpointExperiment.result&&this._optableSdkWrapper.setDCNExperiments([`tokenize-v2`]),this._optableConfig.loblawEnabled&&(this._optableSdkWrapper.installGPTSecureSignals().catch(e=>{}),this._optableSdkWrapper.targeting().catch(e=>{}))}},xc=D([Q(`OptableBootstrap`),C(),A(`design:paramtypes`,[Object,typeof(mc=ga!==void 0&&ga)==`function`?mc:Object,typeof(hc=va!==void 0&&va)==`function`?hc:Object,typeof(gc=Ea!==void 0&&Ea)==`function`?gc:Object,typeof(_c=la!==void 0&&la)==`function`?_c:Object,typeof(vc=za!==void 0&&za)==`function`?vc:Object,typeof(yc=L!==void 0&&L)==`function`?yc:Object,typeof(bc=pc!==void 0&&pc)==`function`?bc:Object]),kt(0,ot(`AdThrive`))],xc)})),Sc,Cc,wc=o((()=>{$(),Z(),w(),qi(),X(),j(),E(),O(),Cc=class{constructor({isGPTPreloaded:e}){T(this,`type`,Ln.GAM),T(this,`wait`,!0),T(this,`_url`,`https://securepubads.g.doubleclick.net/tag/js/gpt.js`),T(this,`_isGPTPreloaded`,void 0),this._isGPTPreloaded=e}async load(){return this._isGPTPreloaded?Promise.resolve(!0):(this.init(),ta(this._url))}init(){window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[]}},Cc=D([Q(`GAMBootstrap`),S(),A(`design:paramtypes`,[typeof(Sc=Ki!==void 0&&Ki)==`function`?Sc:Object])],Cc)})),Tc,nne=o((()=>{mU(),w(),O(),Tc=class extends pU{init(){this._key=`MarmaladeBootstrap`,this._lookup=`MTO`}run(){return super.run()}},Tc=D([C()],Tc)})),Ec,Dc,Oc,kc=o((()=>{rU(),$(),w(),nne(),X(),j(),E(),O(),Oc=class{constructor(e,t){this._eventBus=e,this._timeoutExp=t,T(this,`type`,Ln.Marmalade),T(this,`wait`,!0),T(this,`_marmaladeFinishedTimeout`,this._timeoutExp.result?this._timeoutExp.result*1e3:3e3),T(this,`_timeoutId`,void 0)}setMarmaladeFinishedTimeout(e){this._marmaladeFinishedTimeout=e}async load(){if(window.adthrive.marmalade){let e=await window.adthrive.marmalade;return this._emitMarmaladeResponse(e),e}let e=new Promise(e=>{window.adthrive.marmaladeFinished=t=>(clearTimeout(this._timeoutId),e(t),t)}).then(e=>(this._emitMarmaladeResponse(e),e)),t=new Promise(e=>{this._timeoutId=window.setTimeout(()=>{let t=window.adthrive.marmalade||{};this._emitMarmaladeResponse(t),e(t)},this._marmaladeFinishedTimeout)});return Promise.race([e,t])}_emitMarmaladeResponse(e){e&&Object.keys(e).length>0&&this._eventBus.marmaladeResponseLoaded.emit(e)}},Oc=D([Q(`MarmaladeBootstrap`),S(),A(`design:paramtypes`,[typeof(Ec=Rr!==void 0&&Rr)==`function`?Ec:Object,typeof(Dc=Tc!==void 0&&Tc)==`function`?Dc:Object])],Oc)})),Ac,R,jc=o((()=>{X(),$(),w(),rU(),j(),E(),O(),R=class{constructor(e){var t;this._bootstrapEventBus=e,T(this,`_queueRan`,!1),T(this,`_loadedFinished`,!1),T(this,`_prebidLibraryPromise`,void 0),(t=window.pbjs)!=null&&t.que||(window.pbjs=window.pbjs||{},window.pbjs.que=window.pbjs.que||[]),this.addToQueue(()=>{this._queueRan=!0,this._loadedFinished=!0}),this._bootstrapEventBus.prebidLibraryLoadComplete.on(()=>{this._loadedFinished=!0}),this._bootstrapEventBus.libraryLoadFailed.on(e=>{e.bootstrapType===`prebid`&&(this._loadedFinished=!0)})}addAdUnits(e){this.addToQueue(()=>{window.pbjs.addAdUnits(e)})}getPrebidAdUnits(){return window.pbjs&&window.pbjs.adUnits}addToQueue(e){if(this._queueRan)try{e()}catch(e){M.error(`PrebidMethods`,`Method in command queue failed to run`,e)}else window.pbjs.que.push(e)}enableAnalytics(e){this.addToQueue(()=>{window.pbjs.enableAnalytics(e)})}isPrebidLoaded(){return window.pbjs&&window.pbjs.libLoaded}getVersion(){return window.pbjs&&window.pbjs.version||`nl`}markWinningBidAsUsed(e){this.addToQueue(()=>{window.pbjs.markWinningBidAsUsed(e)})}offEvent(e,t){this.addToQueue(()=>{window.pbjs.offEvent(e,t)})}onEvent(e,t){this.addToQueue(()=>{window.pbjs.onEvent(e,t)})}refreshUserIds(e,t){return new Promise((n,r)=>{this.addToQueue(()=>{window.pbjs.refreshUserIds(e,t).then(n).catch(r)})})}requestBids(e){this.addToQueue(()=>{window.pbjs.requestBids(e)})}setAliasBidder(e,t,n){this.addToQueue(()=>{n?window.pbjs.aliasBidder(e,t,n):window.pbjs.aliasBidder(e,t)})}setBidderConfig(e,t=!1){this.addToQueue(()=>{window.pbjs.setBidderConfig(e,t)})}setBidderSettings(e){this.addToQueue(()=>{window.pbjs.bidderSettings=e})}setBidsReceivedFilter(e){this.addToQueue(()=>{window.pbjs.setBidsReceivedFilter(e)})}setConfig(e,t=!0){this.addToQueue(()=>{let n=t?Object.keys(e).reduce((t,n)=>{let r=n,i=e[r],a=window.pbjs.getConfig(n);return!a||typeof i!=`object`||typeof i!=typeof a?t[r]=i:t[r]=Array.isArray(i)?[...a==null?[]:a,...i]:{...a==null?{}:a,...i},t},{}):e;window.pbjs.setConfig({...n})})}mergeConfig(e){this.addToQueue(()=>{window.pbjs.mergeConfig(e)})}setTargetingForGPTAsync(e,t=null,n=``,r,i,a,o){o?this.addToQueue(()=>{window.pbjs.setTargetingForGPTAsync(e,t,n,r,i,a)}):window.pbjs.setTargetingForGPTAsync(e,t,n,r,i,a)}triggerUserSyncs(){this.addToQueue(()=>{window.pbjs.triggerUserSyncs()})}registerSignalSources(){this.addToQueue(()=>{window.pbjs.registerSignalSources()})}clearTargetingForSharedBidPool(e){this.addToQueue(()=>{window.pbjs.clearTargetingForSharedBidPool(e)})}renderAd(e,t){this.addToQueue(()=>{window.pbjs.renderAd(e,t)})}clearAllAuctions(){this.addToQueue(()=>{window.pbjs.clearAllAuctions()})}clearSlotTargeting(e){this.addToQueue(()=>{let t=e.googleTagSlot;t&&window.pbjs.clearSlotTargeting(t)})}async waitForQueue(){return await this._waitForPrebidLibraryLoaded(),new Promise(e=>{this._queueRan?e(!0):this._loadedFinished&&!this.isPrebidLoaded()?e(!1):window.pbjs.que.push(()=>{e(!0)})})}getBidResponsesForAdUnitCode(e){return window.pbjs.getBidResponsesForAdUnitCode(e)}clearAuctionBids(e){return window.pbjs.clearAuctionBids(e)}trimBidPoolForAdUnit(e,t){return window.pbjs.trimBidPoolForAdUnit(e,t)}getUserIdsAsEids(){var e,t,n;return(e=(t=(n=window.pbjs).getUserIdsAsEids)==null?void 0:t.call(n))==null?[]:e}getUserIdsAsEidBySource(e){var t,n;return(t=(n=window.pbjs).getUserIdsAsEidBySource)==null?void 0:t.call(n,e)}getBidResponsesForBidPoolId(e){var t,n,r;return(t=(n=(r=pbjs).getBidResponsesForBidPoolId)==null?void 0:n.call(r,e))==null?{}:t}getAdserverTargetingForAdUnitCode(e,t){var n,r,i;return(n=(r=(i=window.pbjs).getAdserverTargetingForAdUnitCode)==null?void 0:r.call(i,e,t))==null?{}:n}getAllPrebidWinningBids(){return window.pbjs.getAllPrebidWinningBids()}getConfig(e,t){return t?window.pbjs.getConfig(e,t):window.pbjs.getConfig(e)}getHighestCpmBids(e){var t,n;return(t=(n=window.pbjs)==null?void 0:n.getHighestCpmBids(e))==null?[]:t}getHighestCpmBidsForPoolId(e){var t,n;return(t=(n=window.pbjs)==null?void 0:n.getHighestCpmBidsForPoolId(e))==null?[]:t}getUserIds(){return window.pbjs.getUserIds()}async getUserIdsAsync(){return await this._waitForPrebidLibraryLoaded(),new Promise(e=>{this.isPrebidLoaded()||e(!1),window.pbjs.getUserIdsAsync().then(t=>e(t)).catch(()=>{})})}removeAdUnit(e){return window.pbjs.removeAdUnit(e)}removeAllAdUnits(e=!0){if(e){var t;let e=[...(t=pbjs.adUnits)==null?[]:t];return window.pbjs.adUnits=[],e}else{var n;let e=[],t=[];return((n=pbjs.adUnits)==null?[]:n).forEach(n=>{Object.values(vW).includes(n.code)?e.push(n):t.push(n)}),window.pbjs.adUnits=e,t}}updateAdUnit(e,t){let n=this.getAdUnit(e);n&&Object.assign(n,t)}getAdUnit(e){var t;return(t=window.pbjs.adUnits)==null?void 0:t.find(t=>t.code===e)}setPAAPIConfigForGPT(e){return window.pbjs.setPAAPIConfigForGPT(e)}buildVideoURL(e,t,n){var r,i;return(r=window.pbjs.adServers)==null||(r=r.dfp)==null||(i=r.buildVideoUrl)==null?void 0:i.call(r,{adUnit:e,params:{...t,cust_params:n}})}async _waitForPrebidLibraryLoaded(){this._prebidLibraryPromise&&await this._prebidLibraryPromise}setupPrebidWindow(e){this._prebidLibraryPromise=e,window.pbjs=window.pbjs||{},window.pbjs.que=window.pbjs.que||[]}},R=D([C(),A(`design:paramtypes`,[typeof(Ac=mr!==void 0&&mr)==`function`?Ac:Object])],R)})),Mc,Nc=o((()=>{Ui(),w(),E(),O(),Mc=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`3pgaun`,this._lookup=`3pgaun`}isEnabled(){let e=window.adthrive.siteAds.siteId===`682cc8505853093e968e35b5`;return super.isEnabled()&&e}},Mc=D([C()],Mc)})),Pc,rne=o((()=>{Pc=`18190176`})),Fc,Ic,Lc,ine=o((()=>{w(),Z(),Nc(),rU(),rne(),j(),E(),At(),O(),Lc=class{constructor(e,t,n){this._bootstrapEventBus=t,T(this,`gamEventPromise`,void 0),T(this,`account`,void 0),T(this,`prefix`,`AdThrive`),T(this,`targeting`,void 0),T(this,`networkCode`,``),T(this,`isThirdPartyGam`,!1),T(this,`_adthriveNetworkCode`,Pc),T(this,`_gamMCMEnabled`,void 0),T(this,`_gamMCMChildNetworkCode`,void 0),T(this,`_loaded`,!1),T(this,`_gamOffEvent`,void 0);let r=e.siteAds,i=r.thirdPartySiteConfig.gam,a=i==null?void 0:i.accountId,o=i==null?void 0:i.childAccountId,s=this.isThirdPartyGam=n.result&&!!a;this.networkCode=s?a:this._adthriveNetworkCode,s?(this._gamMCMEnabled=!!o,this._gamMCMChildNetworkCode=N(o,``)):(this._gamMCMEnabled=N(r.adOptions.gamMCMEnabled,!1),this._gamMCMChildNetworkCode=N(r.adOptions.gamMCMChildNetworkCode,``)),this.account=this._gamMCMEnabled&&this._gamMCMChildNetworkCode!==``?`${this.networkCode},${this._gamMCMChildNetworkCode}`:this.networkCode;let c=new Set([`service`,`bidding`,`dynamicVersion`]);this.gamEventPromise=new Promise(e=>{this._gamOffEvent=this._bootstrapEventBus.gamLibraryLoadComplete.on(t=>{var n;this._loaded=!0,e(t),(n=this._gamOffEvent)==null||n.call(this)},{handleEventsAlreadyEmitted:!0})}),this.targeting=e.siteAds.targeting.length&&e.siteAds.targeting.filter(({key:e})=>!c.has(e)).map(({key:e,value:t})=>(typeof t==`boolean`&&(t=String(t)),{key:e,value:t}))||[]}get loaded(){return this._loaded}},Lc=D([C(),A(`design:paramtypes`,[Object,typeof(Fc=mr!==void 0&&mr)==`function`?Fc:Object,typeof(Ic=Mc!==void 0&&Mc)==`function`?Ic:Object]),kt(0,ot(`AdThrive`))],Lc)})),Rc=o((()=>{ine()})),zc,ane=o((()=>{w(),fa(),O(),zc=class extends da{init(){this._setAbGroup=!0,this._key=`S2S`,this._lookup=`PBS2S`,this._default=[`none`]}},zc=D([C()],zc)})),Bc,one=o((()=>{mU(),w(),O(),Bc=class extends pU{init(){this._key=`AuctionDelay_2`,this._lookup=`ADT3`}get result(){return this._result}},Bc=D([C()],Bc)})),Vc,sne=o((()=>{w(),Ui(),E(),O(),Vc=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`OrtbEnrich`,this._lookup=`S2SPARAM`}},Vc=D([C()],Vc)})),Hc,cne=o((()=>{mU(),$(),w(),j(),O(),Hc=class extends pU{init(){this._key=`YahooSSP`,this._lookup=`YAHOODR`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],Hc.prototype,`run`,null),Hc=D([C()],Hc)})),Uc,lne=o((()=>{mU(),$(),w(),j(),O(),Uc=class extends pU{init(){this._key=`MultistagePrebidAuctionDisplay3`,this._lookup=`MULTIREFAUCD3`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],Uc.prototype,`run`,null),Uc=D([C()],Uc)})),Wc,Gc,Kc,une=o((()=>{X(),Wc=new Map([[P.AdaptMx,{enabled:!0,nameFromAdmin:P.Rubicon}],[P.Adform,{enabled:!0,nameFromAdmin:`adform`}],[P.AidemServer,{enabled:!0,nameFromAdmin:P.Aidem}],[P.AmazonUAM,{enabled:!0,nameFromAdmin:`amazonUAM`}],[P.AppNexus,{enabled:!0,nameFromAdmin:`appNexus`}],[P.Connatix,{enabled:!0}],[P.Conversant,{enabled:!0}],[P.Criteo,{enabled:!0}],[P.GumGum,{enabled:!0}],[P.ImproveDigital,{enabled:!0}],[P.IndexExchange,{enabled:!0,nameFromAdmin:`indexExchange`}],[P.Kargo,{enabled:!0}],[P.MediaGrid,{enabled:!0,nameFromAdmin:`mediaGrid`}],[P.MediaGridVideo,{enabled:!0,nameFromAdmin:`mediaGrid`}],[P.Nativo,{enabled:!0}],[P.Ogury,{enabled:!1}],[P.OpenX,{enabled:!0}],[P.Ozone,{enabled:!1}],[P.Pubmatic,{enabled:!0,nameFromAdmin:`pubMatic`}],[P.Rise,{enabled:!1}],[P.Rtbhouse,{enabled:!0}],[P.Rubicon,{enabled:!0}],[P.Sharethrough,{enabled:!0}],[P.StackAdapt,{enabled:!1}],[P.Teads,{enabled:!0}],[P.ThirtyThreeAcross,{enabled:!0,nameFromAdmin:`thirtyThreeAcross`}],[P.Triplelift,{enabled:!0,nameFromAdmin:`tripleLift`}],[P.TTD,{enabled:!0,nameFromAdmin:`theTradeDesk`}],[P.Undertone,{enabled:!0}],[P.UndertoneServer,{enabled:!0}],[P.Unruly,{enabled:!0}],[P.YahooSSP,{enabled:!0}],[P.Yieldmo,{enabled:!0}],[P.Flipp,{enabled:!1}]]),Gc=new Map([[P.AdaptMx,!0],[P.Adform,!0],[P.AidemServer,!1],[P.AmazonUAM,!0],[P.AppNexus,!1],[P.Connatix,!0],[P.Conversant,!1],[P.Criteo,!0],[P.GumGum,!0],[P.ImproveDigital,!0],[P.IndexExchange,!1],[P.Kargo,!0],[P.MediaGrid,!0],[P.MediaGridVideo,!0],[P.Nativo,!1],[P.OpenX,!1],[P.Ozone,!1],[P.Pubmatic,!0],[P.Rise,!1],[P.Rtbhouse,!0],[P.Rubicon,!0],[P.Sharethrough,!0],[P.StackAdapt,!0],[P.Teads,!0],[P.ThirtyThreeAcross,!0],[P.Triplelift,!0],[P.TTD,!0],[P.Undertone,!0],[P.Unruly,!0],[P.YahooSSP,!0],[P.Yieldmo,!0],[P.Flipp,!1]]),Kc=new Map([[P.AdaptMx,!0],[P.Adform,!0],[P.AidemServer,!1],[P.AmazonUAM,!0],[P.AppNexus,!0],[P.Connatix,!0],[P.Criteo,!0],[P.GumGum,!0],[P.ImproveDigital,!0],[P.IndexExchange,!0],[P.Kargo,!0],[P.Nativo,!1],[P.MediaGridVideo,!0],[P.OpenX,!0],[P.Pubmatic,!0],[P.StackAdapt,!0],[P.Rise,!1],[P.Rubicon,!0],[P.Sharethrough,!0],[P.ThirtyThreeAcross,!0],[P.Triplelift,!0],[P.TTD,!0],[P.Unruly,!0],[P.UndertoneServer,!0],[P.YahooSSP,!0]])})),dne,qc,Jc,fne=o((()=>{X(),dne=[{choice:P.ThirtyThreeAcross,weight:.0033},{choice:P.AppNexus,weight:.0033},{choice:P.Conversant,weight:33e-5},{choice:P.GumGum,weight:33e-5},{choice:P.ImproveDigitalServer,weight:.0033},{choice:P.IndexExchange,weight:.0033},{choice:P.Kargo,weight:33e-5},{choice:P.MediaGrid,weight:.0033},{choice:P.Nativo,weight:33e-5},{choice:P.OpenX,weight:.0033},{choice:P.OpenXServer,weight:.0033},{choice:P.Ozone,weight:.0033},{choice:P.Pubmatic,weight:.0033},{choice:P.PubmaticServer,weight:.0033},{choice:P.Rtbhouse,weight:33e-5},{choice:P.Rubicon,weight:.0033},{choice:P.RubiconServer,weight:.0033},{choice:P.Sharethrough,weight:33e-5},{choice:P.Triplelift,weight:.00158},{choice:P.TripleliftServer,weight:.00236},{choice:P.TTD,weight:.0033},{choice:P.Undertone,weight:33e-5},{choice:P.Unruly,weight:.0033},{choice:P.YahooSSP,weight:.0033},{choice:P.YahooSSPServer,weight:.0033},{choice:P.Yieldmo,weight:.0033},{choice:P.AidemServer,weight:.0033}],qc=[qn.default,qn.outstream,qn.stickyOutstream],Jc={[P.ThirtyThreeAcross]:.0033,[P.AppNexus]:.0033,[P.Conversant]:33e-5,[P.GumGum]:33e-5,[P.ImproveDigitalServer]:.0033,[P.IndexExchange]:.0033,[P.Kargo]:33e-5,[P.MediaGrid]:.0033,[P.Nativo]:33e-5,[P.OpenX]:.0033,[P.OpenXServer]:.0033,[P.Ozone]:.0033,[P.Pubmatic]:.0033,[P.PubmaticServer]:.0033,[P.Rtbhouse]:33e-5,[P.Rubicon]:.0033,[P.RubiconServer]:.0033,[P.Sharethrough]:33e-5,[P.Triplelift]:.00158,[P.TripleliftServer]:.00236,[P.TTD]:.0033,[P.Undertone]:33e-5,[P.Unruly]:.0033,[P.YahooSSP]:.0033,[P.YahooSSPServer]:.0033,[P.Yieldmo]:.0033,[P.AidemServer]:.0033}})),Yc,Xc,pne=o((()=>{Fn(),Yn(),Z(),w(),une(),fne(),Lt(),Nc(),j(),E(),At(),O(),Xc=class{constructor(e,t){var n,r,i,a;this.adthrive=e,T(this,`display`,void 0),T(this,`video`,void 0),T(this,`configTypes`,[qn.default,qn.instream,qn.native,qn.outstream,qn.pmp,qn.stickyOutstream]),T(this,`_adOptions`,void 0),T(this,`_biddersCoreConfig`,new Map),T(this,`_videoPartners`,void 0),T(this,`_idGraphAdjustmentGlobalDiscount`,((n=this.adthrive.core)==null?void 0:n.country)===`US`?.006:0),T(this,`_gamRenderFee`,.0147),T(this,`_gamInstreamAdditionalRenderFee`,.16),T(this,`_liveIntentFeeByBidder`,{}),T(this,`_bidderPriceAdjustments`,{ix:new Map([[qn.pmp,{flat:.05}]])}),T(this,`_invalidBidAdjustments`,[]);let o=e.siteAds,s=o.thirdPartySiteConfig,c=s.partners,l=c&&c.discounts,u=s.gam,d=u==null?void 0:u.accountId,f=t.result&&!!d;f&&(l&&l.length?e.core.partners=l:(e.core.partners=[],M.error(`Partners`,`constructor`,`replacing core partners with an empty array`)));let p=(r=o.videoPlayers)==null?void 0:r.partners,m=(i=o.video)==null?void 0:i.partners;if(this._adOptions=o.adOptions,this._videoPartners=p||m||{},!((a=e.core)==null||(a=a.partners)==null)&&a.length){let t=this._isCPMConfigLegacy(e.core.partners);e.core.liveIntent&&this._enableLiveIntentPriceAdjustments(e.core.liveIntent),e.core.partners.forEach(e=>{e.bidder_name&&this._createCPMMap(e,t)})}this._invalidBidAdjustments.length>0&&M.error(`Partners`,`constructor`,`Invalid bid adjustments detected`,this._invalidBidAdjustments),this.display=this._getDisplayBidders(),this.video=this._getVideoBidders()}getBidderConfig(e,t=!0){let n={bidder_name:e,enabled:t,cpmMap:new Map};return N(this._biddersCoreConfig.get(e),n)}getDefaultDiscount(){return{discounts:{flat:Jn.flat,percent:Jn.percent},gam:{flat:this._gamRenderFee,percent:Jn.percent}}}getDefaultInstreamDiscount(e){var t,n;return{discounts:{flat:(t=e.discounts.flat)==null?Jn.flat:t,percent:(n=e.discounts.percent)==null?Jn.percent:n},gam:{flat:this._gamRenderFee+this._gamInstreamAdditionalRenderFee,percent:Jn.percent}}}get bidderPriceAdjustments(){return this._bidderPriceAdjustments}_enableLiveIntentPriceAdjustments(e){this._liveIntentFeeByBidder=e.filter(e=>Zt()?e.browser===`Chrome`:e.browser===`Not Chrome`).reduce((e,t)=>{let n=t.multiplier/100,r=t.bidder;return e[r]=n,(n<0||n>1)&&this._invalidBidAdjustments.push({source:`LiveIntent`,bidder:r,value:n}),e},{})}_displayPartnerEnabled(e){var t,n,r;let i=((t=Wc.get(e))==null?void 0:t.nameFromAdmin)||e,a=i?N(this._adOptions[i],Gc.get(e)):void 0,o=N((n=this._biddersCoreConfig.get(e))==null?void 0:n.enabled,(r=Wc.get(e))==null?void 0:r.enabled);return e===P.AmazonUAM?a:!!a&&!!o}_videoPartnerEnabled(e){var t,n,r;let i=((t=Wc.get(e))==null?void 0:t.nameFromAdmin)||e,a=N(this._videoPartners[i],Kc.get(e)),o=N((n=this._biddersCoreConfig.get(e))==null?void 0:n.enabled,(r=Wc.get(e))==null?void 0:r.enabled);return!!a&&!!o}_createCPMMap(e,t){let n=N(e.enabled,!0),r=new Map;if(t){let t=e.cpm,n=this._prepareCPMConfigs(t);t.forEach(t=>{t.type===`percent`&&(t.value<0||t.value>1)&&this._invalidBidAdjustments.push({source:`BidderCoreConfig`,bidder:e.bidder_name,value:t.value})}),n.forEach(t=>{r.set(t.name,this._convertToCPMPriceAdjustments(t,e.bidder_name))})}else r=e.cpm;this._setFeeBreakdownByBidder(r,e.bidder_name,n)}_getRenderFees(e,t,n){return{gam:{flat:e,percent:Jn.percent},idGraph:{flat:this._idGraphAdjustmentGlobalDiscount,percent:Jn.percent},...t&&{confiant:{flat:t,percent:Jn.percent}},...n&&{liveIntent:{flat:Jn.flat,percent:n}}}}_setFeeBreakdownByBidder(e,t,n){let r=new Map;for(let[o,s]of e.entries()){var i,a;let e=o===qn.pmp,{flat:c=0,percent:l=1}=s,u=s.deals,d=this._gamRenderFee+(o===`instream`?this._gamInstreamAdditionalRenderFee:0),f=(i=qc.includes(o)?Jc[t]:0)==null?0:i,p=(a=this._liveIntentFeeByBidder[t])==null?0:a;r.set(o,{discounts:{flat:c,percent:l},...!e&&{...this._getRenderFees(d,f,p)},...u&&{deals:u}}),this._biddersCoreConfig.set(t,{bidder_name:t,enabled:n,cpmMap:r})}}_prepareCPMConfigs(e){var t;let n=(t=e.find(e=>e.name===qn.default))==null?{name:qn.default,type:qn.percent,value:Jn.percent}:t,r=[];return this.configTypes.forEach(t=>{let i=e.find(e=>e.name===t);i?r.push(i):r.push({...n,name:t})}),r}_isCPMConfigLegacy(e){var t;let n=e==null||(t=e[0])==null?void 0:t.cpm;return n&&Array.isArray(n)}_convertToCPMPriceAdjustments(e,t){return e.name===qn.pmp?this._convertToCMPPriceAdjustmentPMP(e,t):this._convertToCMPPriceAdjustment(e,t)}_convertToCMPPriceAdjustmentPMP(e,t){let n=this._convertToCMPPriceAdjustment(e,t);return e.deals&&(n.deals={},e.deals.forEach(e=>{n.deals[e.name]=this._convertToCMPPriceAdjustment(e,t,!1)})),n}_convertToCMPPriceAdjustment(e,t,n=!0){let r={},i=e.name,a=this._getBidderPriceAdjustment(t,i,n),o=1,s=0;return e.type===qn.percent?o*=e.value:e.type===qn.flat&&(s+=e.value),r.percent=o*a.percent,r.flat=s+Number(a.flat),r}_getBidderPriceAdjustment(e,t,n=!0){if(!n)return{...Jn};let r=this._bidderPriceAdjustments,i=r[e]&&r[e].get(r[e].has(t)?t:qn.default)||{};return{...Jn,...i}}_getDisplayBidders(){return new Map([[P.AdaptMx,this._displayPartnerEnabled(P.Rubicon)],[P.Adform,this._displayPartnerEnabled(P.Adform)],[P.Aidem,this._displayPartnerEnabled(P.AidemServer)],[P.AppNexus,this._displayPartnerEnabled(P.AppNexus)],[P.Connatix,this._displayPartnerEnabled(P.Connatix)],[P.Conversant,this._displayPartnerEnabled(P.Conversant)],[P.Criteo,this._displayPartnerEnabled(P.Criteo)],[P.ImproveDigital,this._displayPartnerEnabled(P.ImproveDigital)],[P.IndexExchange,this._displayPartnerEnabled(P.IndexExchange)],[P.GumGum,this._displayPartnerEnabled(P.GumGum)],[P.Kargo,this._displayPartnerEnabled(P.Kargo)],[P.MediaGrid,this._displayPartnerEnabled(P.MediaGrid)],[P.MediaGridVideo,this._displayPartnerEnabled(P.MediaGridVideo)],[P.Nativo,this._displayPartnerEnabled(P.Nativo)],[P.Ogury,this._displayPartnerEnabled(P.Ogury)],[P.OpenX,this._displayPartnerEnabled(P.OpenX)],[P.Ozone,this._displayPartnerEnabled(P.Ozone)],[P.Pubmatic,this._displayPartnerEnabled(P.Pubmatic)],[P.Rise,this._displayPartnerEnabled(P.Rise)],[P.Rtbhouse,this._displayPartnerEnabled(P.Rtbhouse)],[P.Rubicon,this._displayPartnerEnabled(P.Rubicon)],[P.Sharethrough,this._displayPartnerEnabled(P.Sharethrough)],[P.StackAdapt,this._displayPartnerEnabled(P.StackAdapt)],[P.Teads,this._displayPartnerEnabled(P.Teads)],[P.ThirtyThreeAcross,this._displayPartnerEnabled(P.ThirtyThreeAcross)],[P.Triplelift,this._displayPartnerEnabled(P.Triplelift)],[P.TTD,this._displayPartnerEnabled(P.TTD)],[P.Undertone,this._displayPartnerEnabled(P.Undertone)],[P.Unruly,this._displayPartnerEnabled(P.Unruly)],[P.YahooSSP,this._displayPartnerEnabled(P.YahooSSP)],[P.Yieldmo,this._displayPartnerEnabled(P.Yieldmo)],[P.AmazonUAM,this._displayPartnerEnabled(P.AmazonUAM)],[P.Flipp,this._displayPartnerEnabled(P.Flipp)]])}_getVideoBidders(){return new Map([[P.AdaptMx,this._videoPartnerEnabled(P.Rubicon)],[P.Adform,this._videoPartnerEnabled(P.Adform)],[P.Aidem,this._videoPartnerEnabled(P.AidemServer)],[P.AmazonUAM,this._videoPartnerEnabled(P.AmazonUAM)],[P.AppNexus,this._videoPartnerEnabled(P.AppNexus)],[P.Connatix,this._videoPartnerEnabled(P.Connatix)],[P.Criteo,this._videoPartnerEnabled(P.Criteo)],[P.GumGum,this._videoPartnerEnabled(P.GumGum)],[P.ImproveDigital,this._videoPartnerEnabled(P.ImproveDigital)],[P.IndexExchange,this._videoPartnerEnabled(P.IndexExchange)],[P.Kargo,this._videoPartnerEnabled(P.Kargo)],[P.MediaGridVideo,this._videoPartnerEnabled(P.MediaGridVideo)],[P.Nativo,this._videoPartnerEnabled(P.Nativo)],[P.OpenX,this._videoPartnerEnabled(P.OpenX)],[P.Pubmatic,this._videoPartnerEnabled(P.Pubmatic)],[P.Rise,this._videoPartnerEnabled(P.Rise)],[P.Rubicon,this._videoPartnerEnabled(P.Rubicon)],[P.Sharethrough,this._videoPartnerEnabled(P.Sharethrough)],[P.StackAdapt,this._videoPartnerEnabled(P.StackAdapt)],[P.ThirtyThreeAcross,this._videoPartnerEnabled(P.ThirtyThreeAcross)],[P.Triplelift,this._videoPartnerEnabled(P.Triplelift)],[P.TTD,this._videoPartnerEnabled(P.TTD)],[P.Unruly,this._videoPartnerEnabled(P.Unruly)],[P.UndertoneServer,this._videoPartnerEnabled(P.Undertone)],[P.YahooSSP,this._videoPartnerEnabled(P.YahooSSP)],[P.Yieldmo,this._videoPartnerEnabled(P.Yieldmo)]])}},Xc=D([C(),A(`design:paramtypes`,[Object,typeof(Yc=Mc!==void 0&&Mc)==`function`?Yc:Object]),kt(0,ot(`AdThrive`))],Xc)})),Zc=o((()=>{pne()})),Qc,mne=o((()=>{Qc=new Map([[`20sf1`,[`ttd`,`appnexus`,`rtbhouse`,`teads`,`kargo`,`gridvid`,`rubi_ss`,`tripl_ss`,`pubm_ss`,`yah_ss`,`improve_ss`,`opnx_ss`,`under_ss`]],[`20sf2`,[`ozone`,`under_ss`,`33across`,`nativo`,`triplelift`,`grid`,`undertone`,`opnx_ss`,`yieldmo`,`unruly`,`yah_ss`,`pubm_ss`,`improve_ss`,`tripl_ss`,`rubi_ss`]],[`20scf`,[`appnexus`,`teads`,`kargo`,`pubmatic`,`ix`,`ttd`,`rubicon`,`pubm_ss`,`yieldmo`,`yahoossp`,`yah_ss`,`undertone`,`unruly`,`opnx_ss`]]])})),$c,hne=o((()=>{mU(),$(),w(),j(),O(),$c=class extends pU{init(){this._key=`MultistagePrebidAuctionVideoNonIosExperiment`,this._lookup=`MVIOS`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],$c.prototype,`run`,null),$c=D([C()],$c)})),el,gne=o((()=>{w(),Ui(),E(),O(),el=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`MissingNativeParams`,this._lookup=`MNR`}},el=D([C()],el)})),tl,_ne=o((()=>{or(),E(),tl=class{constructor(){T(this,`_featureRollouts`,{}),T(this,`_checkedFeatureRollouts`,new Map),T(this,`_enabledFeatureRolloutIds`,[])}get siteFeatureRollouts(){return this._featureRollouts}_isRolloutEnabled(e){if(this._doesRolloutExist(e)){let t=this._featureRollouts[e],n=t.enabled,r=t.data;if(this._doesRolloutHaveConfig(e)&&this._isFeatureRolloutConfigType(r)){let e=r.pct_enabled?r.pct_enabled/100:1;n=n&&new ar(e).get()}return n}return!1}isRolloutEnabled(e){var t;let n=(t=this._checkedFeatureRollouts.get(e))==null?this._isRolloutEnabled(e):t;return this._checkedFeatureRollouts.get(e)===void 0&&this._checkedFeatureRollouts.set(e,n),n}_doesRolloutExist(e){return this._featureRollouts&&!!this._featureRollouts[e]}_doesRolloutHaveConfig(e){return this._doesRolloutExist(e)&&`data`in this._featureRollouts[e]}_isFeatureRolloutConfigType(e){return typeof e==`object`&&!!e&&!!Object.keys(e).length}getSiteRolloutConfig(e){var t;let n=this.isRolloutEnabled(e),r=(t=this._featureRollouts[e])==null?void 0:t.data,i=n&&this._doesRolloutHaveConfig(e)&&this._isFeatureRolloutConfigType(r)?r:{};return i}get enabledFeatureRolloutIds(){return this._enabledFeatureRolloutIds}}})),nl,vne=o((()=>{_ne(),nl=class extends tl{constructor(e){super(),this._featureRollouts=e,this._setEnabledFeatureRolloutIds()}_setEnabledFeatureRolloutIds(){Object.entries(this._featureRollouts).forEach(([e,t])=>{this.isRolloutEnabled(e)&&t.featureRolloutId!==void 0&&this._enabledFeatureRolloutIds.push(t.featureRolloutId)})}}})),rl,il,al=o((()=>{vne(),il=new nl(window.adthrive&&window.adthrive.siteAds&&`featureRollouts`in window.adthrive.siteAds?(rl=window.adthrive.siteAds.featureRollouts)==null?{}:rl:{})})),ol,sl,cl=o((()=>{w(),Ra(),Z(),IK(),al(),j(),E(),O(),sl=class{_isHighRevGeo(e){var t;let n=(t=e.country)==null?`US`:t,r=[`US`,`CA`,`AU`,`DE`,`NZ`,`GB`,`UK`];return r.includes(n)}constructor(e){T(this,`_enabled`,!0);let t=this._isHighRevGeo(e),n=il.isRolloutEnabled(`only-pb-s2s-non-high-rev-geo-mob-chromium`);this._enabled=t?!0:!(n&&Qt()&&tG())}get enabled(){return this._enabled}},sl=D([Q(`PrebidClientSide`),C(),A(`design:paramtypes`,[typeof(ol=L!==void 0&&L)==`function`?ol:Object])],sl)})),ll,yne=o((()=>{w(),Ui(),E(),O(),ll=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`DisableMultistageRefresh`,this._lookup=`MR4`}},ll=D([C()],ll)})),ul,bne=o((()=>{mU(),w(),O(),ul=class extends pU{init(){this._key=`PrebidFailsafeTimeout`,this._lookup=`PBFS`}},ul=D([C()],ul)})),dl,xne=o((()=>{w(),Ui(),E(),O(),dl=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`CurrencyConversion`,this._lookup=`FOREX`}},dl=D([C()],dl)})),fl,Sne=o((()=>{mU(),w(),O(),fl=class extends pU{init(){this._key=`PrebidRequestQueueTimeout`,this._lookup=`PBRQT`}get result(){return this._result}},fl=D([C()],fl)})),pl,ml,hl,gl,_l=o((()=>{Nt(),w(),Ui(),mU(),fa(),ii(),j(),E(),At(),O(),hl=`You need to set "this._label" in the init method for this experiment. The code should look something like this:

  protected init() {
    this._label = 'my_label';
  }`,gl=class{constructor(e,t){this._coreExperimentConfig=e,this._abgroupClass=t,T(this,`_label`,void 0),T(this,`shouldUseCoreExperimentsConfig`,!0),T(this,`_autorun`,!0),T(this,`_experiments`,void 0),T(this,`_results`,{}),T(this,`_resultsByLookupKey`,{}),this.init(),this.isEnabled()&&this._autorun&&this._run()}get label(){if(!this._label)throw Error(hl);return this._label}get experiments(){return this._experiments}get results(){return this._autorun===!1&&!Object.keys(this._results).length&&this._run(),this._results}get resultsByLookupKey(){return this._autorun===!1&&!Object.keys(this._results).length&&this._run(),this._resultsByLookupKey}init(){throw Error(hl)}_run(){var e;(e=this._experiments)==null||e.forEach(e=>{let{abgroup:t,key:n,lookupKey:r}=e,i=this._createExperiment(e);if(Object.defineProperty(i,`name`,{value:`${n}${n.includes(`Experiment`)?``:`Experiment`}`}),!i)return;let a=new i(this._abgroupClass,this._coreExperimentConfig);this._results[t]=a.result,r&&(this._resultsByLookupKey[r]=a.result)})}isEnabled(){if(this.shouldUseCoreExperimentsConfig){let e=this._experiments=this._coreExperimentConfig.getAllMatchingCoreExperiments(this.label);return!!(e&&e.length)}return!0}_createExperiment(e){let{key:t,type:n,lookupKey:r}=e;switch(n){case`bernoulliTrial`:return this._runBernoulliExperiment(t,r);case`weightedChoice`:return this._runWeightedChoiceExperiment(t,r);case`multivalueBernoulliTrial`:return this._runMultivalueBernoulliExperiment(t,r);default:return}}_runBernoulliExperiment(e,t){return class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=e,this._lookup=t}}}_runWeightedChoiceExperiment(e,t){return class extends pU{init(){this._key=e,this._lookup=t}}}_runMultivalueBernoulliExperiment(e,t){return class extends da{init(){this._key=e,this._default=[`none`],this._lookup=t}}}},gl=D([A(`design:paramtypes`,[typeof(pl=jt!==void 0&&jt)==`function`?pl:Object,typeof(ml=ti!==void 0&&ti)==`function`?ml:Object]),kt(0,ot(jt))],gl)})),vl,Cne=o((()=>{w(),_l(),O(),vl=class extends gl{init(){this._label=`RPBS`}},vl=D([C()],vl)})),yl,bl=o((()=>{mU(),w(),O(),yl=class extends pU{init(){this._key=`PrebidServerMultiCall`,this._lookup=`PBSMC`}run(){return super.run()}},yl=D([C()],yl)})),xl,wne=o((()=>{w(),fa(),O(),xl=class extends da{init(){this._key=`AppBiddersList`,this._lookup=`APPRQB`,this._default=[]}get choices(){return this._choices}},xl=D([C()],xl)})),Sl,Cl=o((()=>{Vi(),fr(),E(),Sl=class extends Bi{constructor(...e){super(...e),T(this,`_default`,void 0)}get _choices(){let e=this._coreExperimentConfig.getMultivalueWeightedChoiceVariants(this.key,this.lookup);return!e||e.length,e}run(){let e=this._choices;if(e){let t=e.map(e=>{let t=new dr(e.options).get();return{choice:`${e.choice}`,option:t,...e.abvalue&&{keyValue:e.abvalue},...e.keyABValue&&{abvalue:e.keyABValue}}});t.length&&(this._result=t)}return this._result||this._default}get choices(){return this._choices}}})),wl,Tne=o((()=>{Cl(),w(),O(),wl=class extends Sl{init(){this._key=`DifferentFloorDifferentBidder`,this._lookup=`DFDB`,this._abGroupType=`multi`}},wl=D([C()],wl)})),Tl,Ene=o((()=>{mU(),$(),w(),j(),O(),Tl=class extends pU{init(){this._key=`IndexExchangeDoubleRequest`,this._lookup=`IXDR`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],Tl.prototype,`run`,null),Tl=D([C()],Tl)})),El,Dne=o((()=>{Ui(),w(),E(),O(),El=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`TrafficShaping`,this._lookup=`TS`}},El=D([C()],El)})),Dl,Ol=o((()=>{Dl=e=>{let t={index:-1,weight:-1};if(!e||e.length===0)return t;let n=e.reduce((e,t)=>e+t,0);if(n===0)return t;let r=Math.random()*n,i=0,a=e[i];for(;r>a;)a+=e[++i];return{index:i,weight:e[i]}}})),kl,Al,jl,One=o((()=>{Dne(),Ol(),w(),rU(),X(),j(),E(),O(),jl=class{constructor(e,t){this.trafficShapingExperiment=e,this._bootstrapEventBus=t,T(this,`_shapingData`,void 0),T(this,`_modelGroup`,void 0),T(this,`_modelVersion`,void 0),T(this,`experimentActive`,!1),T(this,`active`,!1),T(this,`_trafficShapingEventPromise`,void 0),T(this,`_trafficShapingLoaded`,!1),T(this,`_trafficShapingOffEvent`,void 0),this.experimentActive=this.trafficShapingExperiment.result,this._trafficShapingEventPromise=new Promise(e=>{this._trafficShapingOffEvent=this._bootstrapEventBus.trafficShapingLibraryLoadComplete.on(()=>{var t;this._trafficShapingLoaded=!0,e(),(t=this._trafficShapingOffEvent)==null||t.call(this)},{handleEventsAlreadyEmitted:!0})})}get trafficShapingEventPromise(){return this._trafficShapingEventPromise}setupData(e){var t;this._shapingData=e,this._setTrafficShapingModelGroup(e),this.modelVersion=(t=this._modelGroup)==null?void 0:t.modelVersion,this.active=this._checkData()}_checkData(){return!(!this.experimentActive||!this._shapingData||!this._modelGroup||!this.modelVersion)}_setTrafficShapingModelGroup(e){var t;let n=(t=e.shaping)==null?void 0:t.modelGroups.map(e=>e.modelWeight);if(n){let{index:t}=Dl(n);this._modelGroup=e.shaping.modelGroups[t]}}get trafficShapingLoaded(){return this._trafficShapingLoaded}get modelVersion(){return this._modelVersion}set modelVersion(e){this._modelVersion=e}applyTrafficShapingLabel(e,t){var n;if(!this.active)return;let{pbsHost:r,bidder:i}=t,a=`location`in e?e.location:e.name,o=`refreshCount`in e?e.refreshCount:e.prerollNum,s=`holdout`,c=t.labelAll||[],l=((n=this.getTrafficShapingRule(a,o))==null?void 0:n.pb)||[],u=!r&&l.includes(i)||r&&l.includes(`${i}_ay`),d=c.indexOf(s),f=d!==-1;u&&!f?c.push(s):!u&&f&&c.splice(d,1),c.length?t.labelAll=c:t.labelAll&&!t.labelAll.length&&delete t.labelAll}getTrafficShapingRule(e,t){var n,r,i,a,o,s,c,l;if(!((n=this._modelGroup)!=null&&n.values.length))return;let u=this._modelGroup.values[0],d=e.includes(F.Video_StickyOutstream)?`O`:e[0],f=`${t}`,p=d===`O`||d===`V`;return(r=(i=(a=u[d])==null?void 0:a[f])==null?(o=u[d])==null?void 0:o[`*`]:i)==null?p?void 0:(s=(c=u[`*`])==null?void 0:c[f])==null?(l=u[`*`])==null?void 0:l[`*`]:s:r}getTrafficShapingServerShutoff(){var e,t;let n=[];return(e=this._modelGroup)!=null&&e.da&&n.push(`ay`),(t=this._modelGroup)!=null&&t.dr&&n.push(`west`),n}},jl=D([C(),A(`design:paramtypes`,[typeof(kl=El!==void 0&&El)==`function`?kl:Object,typeof(Al=mr!==void 0&&mr)==`function`?Al:Object])],jl)})),Ml=o((()=>{One()})),Nl,kne=o((()=>{mU(),w(),O(),Nl=class extends pU{init(){this._key=`AYRPBSStages`,this._lookup=`ARS`}},Nl=D([C()],Nl)})),Pl,Ane=o((()=>{Cl(),$(),w(),O(),Pl=class extends Sl{init(){this._key=`DifferentFloorDifferentServerBidder`,this._lookup=`DFDSB`,this._abGroupType=`multi`}},Pl=D([Q(`DifferentFloorDifferentServerBidderExperiment `),C()],Pl)})),Fl,jne=o((()=>{w(),$(),_l(),O(),Fl=class extends gl{init(){this._label=`BDPL`}},Fl=D([Q(`BidderPlacementsBatchExperiments`),C()],Fl)})),Il,Ll,Rl,zl,Bl,Vl,Hl,Ul,Wl,Gl,Kl,ql,Jl,Yl,Xl,Zl,Ql,$l,eu,tu,nu,ru,iu,au,ou,su,cu,lu,uu=o((()=>{w(),Rc(),Ja(),ane(),one(),X(),sne(),Ni(),cne(),lne(),Zc(),mne(),Z(),hne(),gne(),cl(),yne(),bne(),xne(),Sne(),Cne(),bl(),wne(),Tne(),Ene(),Ml(),kne(),Ane(),hr(),jne(),j(),E(),O(),su={[P.AidemServer]:P.Aidem,[P.CriteoServer]:P.Criteo,[P.ImproveDigitalServer]:P.ImproveDigital,[P.IndexExchangeServer]:P.IndexExchange,[P.NativoServer]:P.Nativo,[P.OpenXServer]:P.OpenX,[P.PubmaticServer]:P.Pubmatic,[P.RubiconServer]:P.Rubicon,[P.SharethroughServer]:P.Sharethrough,[P.TripleliftServer]:P.Triplelift,[P.YahooSSPServer]:P.YahooSSP,[P.UndertoneServer]:P.Undertone},cu=class{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v,y,b,ee,te,ne,re){var ie,ae,oe,se,ce,le;this._ayRpbsStagesExperiment=a,this._gam=o,this._site=s,this._partners=u,this._prebidClientSide=f,this._currencyConversionExperiment=h,this._prebidServerMultiCallExperiment=v,this._trafficShaping=ee,this._bootstrapEventBus=ne,T(this,`interstitialAdUnitCode`,void 0),T(this,`s2s`,void 0),T(this,`ortbEnrich`,void 0),T(this,`bidPoolSlots`,[F.Below_Post,F.Content,F.Sidebar,F.Recipe]),T(this,`auctionDelay`,void 0),T(this,`deals`,[]),T(this,`firstVideoAuctionBidders`,new Set),T(this,`secondVideoAuctionBidders`,new Set),T(this,`auctionMapping`,new Map),T(this,`targetingKeys`,[`ADOMAIN`,`AD_ID`,`BIDDER`,`CACHE_ID`,`CACHE_HOST`,`DEAL`,`FORMAT`,`PRICE_BUCKET`,`SIZE`,`SOURCE`,`UUID`,`INTERSTITIAL`,`DSP`,`CRID`,`ATTR`]),T(this,`advertiserId`,413678576),T(this,`multistageActive`,void 0),T(this,`multistageStickyOutstreamActive`,void 0),T(this,`refreshAuctionCount`,1),T(this,`refreshStickyOutstreamAuctionCount`,1),T(this,`multistageValue`,void 0),T(this,`experimentRefreshInterval`,void 0),T(this,`multiStageLimit`,void 0),T(this,`currencyConversionEnabled`,!1),T(this,`sendAllBidsTargetingKeys`,this.targetingKeys.filter(e=>![`BIDDER`,`INTERSTITIAL`,`CRID`].includes(e))),T(this,`sendAdditionalNativeParams`,void 0),T(this,`isClientSideDoubleRequest`,!1),T(this,`failsafeTimeout`,void 0),T(this,`requestExp`,{}),T(this,`ayServerEnabled`,!1),T(this,`rpbsEnabled`,!1),T(this,`appBidders`,void 0),T(this,`blockedCreativeIds`,[]),T(this,`bidderInflatorMap`,new Map),T(this,`serverBidderInflatorMap`,new Map),T(this,`experimentIntegrationHoldouts`,[]),T(this,`prebidEventPromise`,void 0),T(this,`_s2sBidders`,[]),T(this,`_isIOS`,Oi()),T(this,`_requestQueueTimeout`,void 0),T(this,`_pbsExperimentsResultsByLookupKey`,void 0),T(this,`_prebidOffEvent`,void 0),T(this,`_bidderPlacementsExperimentsResults`,void 0),T(this,`_bidderPlacementsExperimentsResultsByLookupKey`,void 0),this.prebidEventPromise=new Promise(e=>{this._prebidOffEvent=this._bootstrapEventBus.prebidLibraryLoadComplete.on(()=>{var t;e(),(t=this._prebidOffEvent)==null||t.call(this)},{handleEventsAlreadyEmitted:!0})});let ue=this._trafficShaping.getTrafficShapingServerShutoff(),de=this._prebidServerMultiCallExperiment.result,fe=`west`,pe=de===`all`;this.rpbsEnabled=pe&&!ue.includes(fe)||de===fe,this.ayServerEnabled=pe&&!ue.includes(`ay`)||de===`ay`,this.s2s=this._setupS2SBidders(e,l,c),this.interstitialAdUnitCode=`gpt_unit_/${this._gam.account}/AdThrive_Interstitial_1/${this._site.id}_0`,this.ortbEnrich=n.result,this.setBidderInflators(this.bidderInflatorMap,b.result),this.setBidderInflators(this.serverBidderInflatorMap,te.result);let me=Object.values(P),he=[P.AmazonTAM,P.AmazonUAM],ge=this.getClientSideBiddersArray(me,e=>!this.s2s.bidders.includes(e)&&!he.includes(e)),_e=this.ayServerEnabled&&this.rpbsEnabled?this._ayRpbsStagesExperiment.result:void 0,ve=(ie=r.result)==null?`off`:ie,ye=_e==null?void 0:_e.startsWith(`b`);this.multistageValue=ve,ye?this.multistageActive=!0:this.multistageActive=ve!==`off`;let be=r.result||`off`;this.multistageStickyOutstreamActive=be!==`off`;let xe=this.isClientSideDoubleRequest=ve===`crr`&&!this._trafficShaping.active;this.isClientSideDoubleRequest||this._determineBidderLabel(ve,ge),this._determineVideoBidderLabel(i),this.auctionDelay=(ae=t.result)==null?0:ae,ye?this.refreshAuctionCount=2:this._setRefreshAuctionCount(ve),this.experimentRefreshInterval=3e4-this.refreshAuctionCount*5e3,this.sendAdditionalNativeParams=d.result,this.multiStageLimit=!xe&&p.result?4:0,this.failsafeTimeout=(oe=m.result)==null?1e3:oe,this.currencyConversionEnabled=this._currencyConversionExperiment.result,this.appBidders=y.result||[],this._requestQueueTimeout=g.result||250,this._pbsExperimentsResultsByLookupKey=(se=_.resultsByLookupKey)==null?[]:se,this._bidderPlacementsExperimentsResults=(ce=re.results)==null?[]:ce,this._bidderPlacementsExperimentsResultsByLookupKey=(le=re.resultsByLookupKey)==null?[]:le}setBidderInflators(e,t){(t||[]).forEach(t=>{e.set(t.choice,t.option)})}_setRefreshAuctionCount(e){e!==`off`&&(this.refreshAuctionCount=2)}_setupS2SBidders(e,t,n){var r;this._addToS2SBidders(P.IndexExchange,P.IndexExchangeServer,(r=t==null?void 0:t.result)==null?`client`:r),this._addToS2SBidders(P.YahooSSP,P.YahooSSPServer,this._isIOS?`server`:n==null?void 0:n.result);let i=e.result||[],a=i.indexOf(P.GumGum);this._isIOS&&a>-1&&i.splice(a,1);let o=[...i,...this._s2sBidders];return{bidders:o.filter(e=>this._isBidderCodeValid(e)),aliases:{}}}_isBidderCodeValid(e){let t=su[e];return this._partners.display.get(e)||this._partners.video.get(e)||t&&(this._partners.display.get(t)||this._partners.video.get(t))}_determineBidderLabel(e,t){if(e===`off`)return;let n=this.s2s.bidders,r={first:1,second:2},i={},a=Qc.get(e);for(let e in i[r.first]=this._evaluateMultistageServerBidders(n,a)||[...n,...t],i[r.second]=this._getLastAuctionBidders(i[r.first]||[],[...n,...t]),i)this._addBidderLabelToAuctionMap(i[e],Number(e))}_evaluateMultistageServerBidders(e,t){return t=t&&t.concat(e).filter(GW),t}_getLastAuctionBidders(e,t){return t.filter(t=>!e.includes(t))}_addBidderLabelToAuctionMap(e,t){e.forEach(e=>{this.auctionMapping.set(e,`auction-${t}`)})}_determineVideoBidderLabel(e){let t=Object.values(P),n=[P.AmazonTAM,P.AmazonUAM],r=this.getClientSideBiddersArray(t,e=>!this.s2s.bidders.includes(e)&&!n.includes(e)),{result:i}=e;this.refreshStickyOutstreamAuctionCount=i===`off`?1:2;let{bidders:a}=this.s2s;if(i===`10s1`){r=this._shuffleArray(r);let e=Math.ceil(r.length/2);this.firstVideoAuctionBidders=new Set([...a,...r.slice(0,e)]),this.secondVideoAuctionBidders=new Set(r.slice(e))}else i===`10s2`?(this.firstVideoAuctionBidders=new Set(a),this.secondVideoAuctionBidders=new Set(r)):(this.firstVideoAuctionBidders=new Set([...a,...r]),this.secondVideoAuctionBidders=this.firstVideoAuctionBidders)}_shuffleArray(e){let t=[...e];for(let e=t.length-1;e>0;e--){let n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}_addToS2SBidders(e,t,n){if(!n)return;this.requestExp[t]=n;let r=this.experimentIntegrationHoldouts;n===`server`?(this._s2sBidders.push(t),r.push(e)):n===`client`?r.push(t):this._s2sBidders.push(t)}distributeServerBidders(){if(!this.ayServerEnabled||!this.rpbsEnabled)return;let e=this.s2s.bidders,t=[],n=[],r=[],i=[];for(let a of e)Nn.includes(a)?t.push(a):Pn.includes(a)?n.push(a):Mn.includes(a)?r.push(a):i.push(a);for(let e of r)n.push(e),t.push(e);for(let e of i.sort(()=>Math.random()-.5))t.length>n.length?n.push(e):t.push(e);this.s2s.distributedBidders={rpbsBidders:t,ayBidders:n}}_determineBidderLabelByServer(e){let t=!!e,n=`auction-1`,r=`auction-2`;switch(this._ayRpbsStagesExperiment.result){case`a1`:return t?n:r;case`a2`:return t?r:n;case`b1`:return n;case`b2`:return r;default:return}}get pbsExperimentsResultsByLookupKey(){return this._pbsExperimentsResultsByLookupKey}get bidderPlacementsExperimentsResults(){return this._bidderPlacementsExperimentsResults}get bidderPlacementsExperimentsResultsByLookupKey(){return this._bidderPlacementsExperimentsResultsByLookupKey}getVideoBidderLabel(e){let t=this.firstVideoAuctionBidders.has(e),n=this.secondVideoAuctionBidders.has(e),r=t&&!n||!t&&n;return r?t?[`auction-1`]:[`auction-2`]:[]}getBidderLabel(e,t){var n;let{bidders:r,distributedBidders:i}=this.s2s,a=this._ayRpbsStagesExperiment.result,o;return o=a&&i&&r.includes(e)?this._determineBidderLabelByServer(t):this.auctionMapping.get(e),[(n=o)==null?`auction-${this.refreshAuctionCount}`:n]}get requestQueueTimeout(){return this._requestQueueTimeout}getClientSideBiddersArray(e,t){let n=e.filter(t.bind(this));return this._prebidClientSide.enabled?n:[]}},cu=D([C(),A(`design:paramtypes`,[typeof(Il=zc!==void 0&&zc)==`function`?Il:Object,typeof(Ll=Bc!==void 0&&Bc)==`function`?Ll:Object,typeof(Rl=Vc!==void 0&&Vc)==`function`?Rl:Object,typeof(zl=Uc!==void 0&&Uc)==`function`?zl:Object,typeof(Bl=$c!==void 0&&$c)==`function`?Bl:Object,typeof(Vl=Nl!==void 0&&Nl)==`function`?Vl:Object,typeof(Hl=Lc!==void 0&&Lc)==`function`?Hl:Object,typeof(Ul=qa!==void 0&&qa)==`function`?Ul:Object,typeof(Wl=Hc!==void 0&&Hc)==`function`?Wl:Object,typeof(Gl=Tl!==void 0&&Tl)==`function`?Gl:Object,typeof(Kl=Xc!==void 0&&Xc)==`function`?Kl:Object,typeof(ql=el!==void 0&&el)==`function`?ql:Object,typeof(Jl=sl!==void 0&&sl)==`function`?Jl:Object,typeof(Yl=ll!==void 0&&ll)==`function`?Yl:Object,typeof(Xl=ul!==void 0&&ul)==`function`?Xl:Object,typeof(Zl=dl!==void 0&&dl)==`function`?Zl:Object,typeof(Ql=fl!==void 0&&fl)==`function`?Ql:Object,typeof($l=vl!==void 0&&vl)==`function`?$l:Object,typeof(eu=yl!==void 0&&yl)==`function`?eu:Object,typeof(tu=xl!==void 0&&xl)==`function`?tu:Object,typeof(nu=wl!==void 0&&wl)==`function`?nu:Object,typeof(ru=jl!==void 0&&jl)==`function`?ru:Object,typeof(iu=Pl!==void 0&&Pl)==`function`?iu:Object,typeof(au=mr!==void 0&&mr)==`function`?au:Object,typeof(ou=Fl!==void 0&&Fl)==`function`?ou:Object])],cu),lu=[F.Sidebar_3,F.Sidebar_4,F.Sidebar_5,F.Native_Recipe]})),du=o((()=>{uu()})),fu,pu,mu,hu,gu=o((()=>{w(),$(),Z(),qi(),X(),jc(),du(),j(),E(),O(),hu=class{constructor(e,t,{baseUrl:n,targetPath:r,isPrebidPreloaded:i}){this._prebid=e,this._prebidMethods=t,T(this,`type`,Ln.Prebid),T(this,`wait`,!0),T(this,`_url`,void 0),T(this,`_isPrebidPreloaded`,void 0),this._url=`${n}/vendor/prebid${r}/prebid.min.js`,this._isPrebidPreloaded=i}async load(){return this.init(),this._isPrebidPreloaded?`preloaded`:await ta(this._url,!1,!1,!0)}init(){this._prebidMethods.setupPrebidWindow(this._prebid.prebidEventPromise)}},hu=D([Q(`PrebidBootstrap`),S(),A(`design:paramtypes`,[typeof(fu=cu!==void 0&&cu)==`function`?fu:Object,typeof(pu=R!==void 0&&R)==`function`?pu:Object,typeof(mu=Ki!==void 0&&Ki)==`function`?mu:Object])],hu)})),_u,Mne=o((()=>{mU(),$(),w(),j(),O(),_u=class extends pU{init(){this._key=`Floors`,this._lookup=`FLRML1`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],_u.prototype,`run`,null),_u=D([C()],_u)})),vu,yu,bu,xu=o((()=>{ii(),X(),$(),w(),Mne(),j(),E(),O(),bu=class{constructor(e,t){this._floorsExperiment=e,this.abGroup=t,T(this,`_result`,{raptive:!1,legacy:!1,fbrap:!1,cm:!1,percentile:{lazy:0}}),this.run()}get result(){return this._result}_enableRaptiveFloors(){this._result.raptive=!0}_enableLegacyFloors(){this._result.legacy=!0}_getFloorsExperimentResults(){let e=this._floorsExperiment.result,t=e===Vn.cm,n=e===Vn.fbrap,r=e===Vn.rapml,i=n||t;return{cm:t,fbrap:n,rapML:r,enableLegacy:i}}_setExpResults({cm:e,fbrap:t}){let n=this._result;e&&(n.cm=e),t&&(n.fbrap=t)}run(){let e=this._getFloorsExperimentResults(),{enableLegacy:t,fbrap:n,rapML:r}=e;this._setExpResults(e),(r||n)&&this._enableRaptiveFloors(),t&&this._enableLegacyFloors()}},bu=D([Q(`FloorsExperimentHandler`),C(),A(`design:paramtypes`,[typeof(vu=_u!==void 0&&_u)==`function`?vu:Object,typeof(yu=ti!==void 0&&ti)==`function`?yu:Object])],bu)})),Su,Cu,wu,Nne=o((()=>{bt(),xu(),Wn(),Rm(),w(),rU(),j(),E(),O(),wu=class{constructor(e,t){this._enabledFloorsExperiments=e,this._bootstrapEventBus=t,T(this,`floorsDataReady`,new k),T(this,`floorsTypeExcludes`,new Set([Hn.raptive])),T(this,`amazonSlotCpm`,new Map),T(this,`_raptiveMLFloorsEventPromise`,void 0),T(this,`_raptiveMLFloorsLoaded`,!1),T(this,`_raptiveMLRefreshFloors`,void 0),T(this,`_activeFloorsTypes`,[]),T(this,`_floorsData`,void 0),T(this,`_cmFPVPriority`,[Hn.refresh,Hn.lazyBidPool,Hn.lazy,Hn.session]),T(this,`_cmNonFPVPriority`,[Hn.refresh,Hn.lazyBidPool,Hn.session,Hn.lazy]),T(this,`_customFieldsMap`,new Map([[`hvp`,e=>{var t,n;let r=(t=(n=e.ortb2Imp.ext)==null||(n=n.data)==null?void 0:n.hvp)==null?0:t;return r?`${r}`:`*`}],[`knownUser`,()=>{let e=U.readInternalLocalStorage(`adt_ei`),t=U.readInternalLocalStorage(`adt_i`);return e||t?`1`:`*`}],[`*`,()=>`*`]])),T(this,`_customSchemaFields`,{}),T(this,`_floorsPriorityData`,new Map),T(this,`_fpv`,void 0),T(this,`_schemaFieldOrder`,new Map([[`adUnitCode`,1]])),T(this,`_standardSchemaFields`,new Set([`size`,`mediaType`,`gptSlot`,`domain`,`adUnitCode`])),T(this,`_modelTimestamp`,0),T(this,`_os`,void 0),T(this,`_browser`,void 0),T(this,`_country`,void 0),T(this,`_defaultFloorData`,{currency:`USD`,schema:{fields:[`domain`,`adUnitCode`],delimiter:`|`},values:{},modelWeight:100,modelVersion:``}),T(this,`_floorsOffEvent`,void 0),this._fpv=U.readInternalLocalStorage(`adthrive_session_fpv`)===!0||U.readInternalLocalStorage(`adthrive_session_fpv`)===null,this._raptiveMLFloorsEventPromise=new Promise(e=>{this._floorsOffEvent=this._bootstrapEventBus.floorsLibraryLoadComplete.on(()=>{var t;this._raptiveMLFloorsLoaded=!0,e(),(t=this._floorsOffEvent)==null||t.call(this)},{handleEventsAlreadyEmitted:!0})})}savePriorityFloorData(e,t,n){let r=this._floorsPriorityData.get(e);this._floorsPriorityData.set(e,{...r,[n]:t})}get raptiveMLFloorsEventPromise(){return this._raptiveMLFloorsEventPromise}get os(){return this._os}set os(e){this._os=e}get browser(){return this._browser}set browser(e){this._browser=e}get country(){return this._country}set country(e){this._country=e}get raptiveMLFloorsLoaded(){return this._raptiveMLFloorsLoaded}get floorsData(){return this._floorsData}set floorsData(e){this._floorsData=e}get floorsExperiment(){return this._enabledFloorsExperiments.result}get activeFloorsData(){return this._floorsPriorityData}get cmPriority(){return this._fpv?this._cmFPVPriority:this._cmNonFPVPriority}get activeFloorsTypes(){return this._activeFloorsTypes}addActiveFloorsType(e){return this._activeFloorsTypes.push(e)}get customSchemaFields(){return this._customSchemaFields}getSchemaFieldOrder(e){return this._schemaFieldOrder.get(e)}get raptiveMLRefreshFloors(){return this._raptiveMLRefreshFloors}set raptiveMLRefreshFloors(e){this._raptiveMLRefreshFloors=e}get modelTimestamp(){return this._modelTimestamp}set modelTimestamp(e){this._modelTimestamp=e}setAdditionalSchemaFields(e){for(let t of e)if(this._schemaFieldOrder.set(t,e.indexOf(t)||0),!this._standardSchemaFields.has(t)){let e=this._customFieldsMap.get(t)||this._customFieldsMap.get(`*`);this._customSchemaFields[t]=e}}get defaultFloorData(){return this._defaultFloorData}},wu=D([C(),A(`design:paramtypes`,[typeof(Su=bu!==void 0&&bu)==`function`?Su:Object,typeof(Cu=mr!==void 0&&mr)==`function`?Cu:Object])],wu)})),Tu=o((()=>{Nne()})),Eu,Pne=o((()=>{mU(),w(),O(),Eu=class extends pU{init(){this._key=`FloorBootstrap`,this._lookup=`FTO`}run(){return super.run()}},Eu=D([C()],Eu)})),Du,Ou,ku,Fne=o((()=>{Tu(),$(),w(),Pne(),X(),j(),E(),O(),ku=class{constructor(e,t){this._floorsConfig=e,this._timeoutExp=t,T(this,`type`,Ln.Floors),T(this,`wait`,!1),T(this,`_isRaptive`,!1),T(this,`_floorsFinishedTimeout`,this._timeoutExp.result?this._timeoutExp.result*1e3:3e3),this._isRaptive=this._floorsConfig.floorsExperiment.raptive}async _resolveFloorsData(e){let t=await e;return new Promise(e=>{if(t&&Object.keys(t).length){var n;let{floors:r,refreshFloors:i,os:a,browser:o,country:s}=t;this._floorsConfig.floorsData=r,this._floorsConfig.raptiveMLRefreshFloors=i,this._floorsConfig.modelTimestamp=(n=r.modelTimestamp)==null?0:n,this._floorsConfig.floorsDataReady.emit(),this._floorsConfig.os=a,this._floorsConfig.browser=o,this._floorsConfig.country=s,e(r)}e({})})}async load(){if(!this._isRaptive)return Promise.resolve({});let e=window.adthrive.additiveRaptiveFloors;if(e)return this._resolveFloorsData(e);let t=new Promise(e=>{window.adthrive.additiveRaptiveFloorsFinished=e}),n=new Promise(e=>{setTimeout(()=>{e({})},this._floorsFinishedTimeout)});return await Promise.race([t,n]),this._resolveFloorsData(window.adthrive.additiveRaptiveFloors)}},ku=D([Q(`FloorsBootstrap`),S(),A(`design:paramtypes`,[typeof(Du=wu!==void 0&&wu)==`function`?Du:Object,typeof(Ou=Eu!==void 0&&Eu)==`function`?Ou:Object])],ku)})),Au,ju,Mu,Nu,Ine=o((()=>{qi(),w(),IK(),rU(),Lt(),Da(),j(),E(),O(),Nu=class{constructor(e,t,n){this._bootstrapConfig=e,this._ccpaConfig=t,this._marmaladeEventBus=n,T(this,`_host`,`https://${this._bootstrapConfig.host}`),T(this,`_baseUrl`,this._bootstrapConfig.baseUrl),T(this,`_frame`,document.createElement(`iframe`))}async start(){this._ccpaConfig.enabled||(await this.addIframeToPage(),this._marmaladeEventBus.marmaladeResponseLoaded.on(e=>{let t=e.recencyFrequency;Array.isArray(t)&&t.length&&this.setMcmpData(t)},{handleEventsAlreadyEmitted:!0}),this._ccpaConfig.consentChange.on(e=>{e===this._ccpaConfig.ccpaOptOut&&this.deleteMcmpData()}))}get recencyFrequencyIframeLocation(){return`${this._baseUrl}/html/rnf.html`}addIframeToPage(){let e,t=new Promise(t=>{e=t});this._frame.onload=()=>{e()};try{this._frame.src=this.recencyFrequencyIframeLocation,this._frame.id=`adthrive-mcmp`,this._frame.style.display=`none`,document.body.appendChild(this._frame)}catch(e){M.error(`RecencyAndFrequencyIFrameManager`,`addIframeToPage`,`Failed to append rnf iframe to document`,e)}return t}deleteMcmpData(){try{this._frame.contentWindow&&this._frame.contentWindow.postMessage({message:`deleteMcmpData`},this._host)}catch(e){M.error(`RecencyAndFrequencyIFrameManager`,`deleteMcmpData`,`Failed to delete mcmp data`,e)}}setMcmpData(e){try{this._frame.contentWindow&&(window.addEventListener(`message`,e=>{let t=e.data,n=t.message;e.origin===this._host&&n===`mcmpDataResponse`&&this._marmaladeEventBus.recencyFrequencyDataSet.emit(t.mcmpData)}),this._frame.contentWindow.postMessage({message:`setMcmpData`,mcmpData:e},this._host))}catch(e){M.error(`RecencyAndFrequencyIFrameManager`,`setMcmpData`,`Failed to set mcmp data`,e)}}},Nu=D([Q(`RecencyAndFrequencyIFrameManager`),C(),A(`design:paramtypes`,[typeof(Au=Ki!==void 0&&Ki)==`function`?Au:Object,typeof(ju=Ea!==void 0&&Ea)==`function`?ju:Object,typeof(Mu=Rr!==void 0&&Rr)==`function`?Mu:Object])],Nu)})),Pu,Fu,Lne=o((()=>{Ml(),X(),$(),w(),j(),E(),At(),O(),Fu=class{constructor(e,t){var n,r;this.trafficShaping=t,T(this,`type`,Ln.TrafficShaping),T(this,`wait`,!1),T(this,`timeout`,3e3),T(this,`trafficShapingDeliveryFeatureEnabled`,!1),this.trafficShapingDeliveryFeatureEnabled=(n=(r=e.deliveryFeatures)==null?void 0:r.includes(`trafficShaping`))==null?!1:n}async _resolveTrafficShapingData(e){let t=await e;return new Promise(e=>{var n;t!=null&&t.trafficShaping&&!(t==null||(n=t.trafficShaping)==null||(n=n.shaping)==null||(n=n.modelGroups)==null)&&n.length?(this.trafficShaping.setupData(t.trafficShaping),e(t)):e({})})}async load(){if(!this.trafficShapingDeliveryFeatureEnabled||!this.trafficShaping.experimentActive)return Promise.resolve({});let e=window.adthrive.trafficShaping;if(e)return this._resolveTrafficShapingData(e);let t=new Promise(e=>{window.adthrive.trafficShapingFinished=e}),n=new Promise(e=>{setTimeout(()=>{e({})},this.timeout)});return await Promise.race([t,n]),this._resolveTrafficShapingData(window.adthrive.trafficShaping)}},Fu=D([Q(`TrafficShapingBootstrap`),S(),A(`design:paramtypes`,[Object,typeof(Pu=jl!==void 0&&jl)==`function`?Pu:Object]),kt(0,ot(`AdThrive`))],Fu)})),Iu,Lu=o((()=>{mU(),w(),O(),Iu=class extends pU{init(){this._key=`CreativeBlocking`,this._lookup=`CB`}},Iu=D([C()],Iu)})),Ru,zu,Bu,Vu=o((()=>{w(),rU(),Lu(),al(),j(),E(),O(),Bu=class{constructor(e,t){this._creativeBlockingExperiment=e,this._bootstrapEventBus=t,T(this,`_cridEventPromise`,void 0),T(this,`_creativeBlockEnabled`,!1),T(this,`_crids`,[]),T(this,`_cridsLoaded`,!1),T(this,`_cridsOffEvent`,void 0);let n=this._creativeBlockingExperiment.result,r=il.isRolloutEnabled(`confiant-blocking-disabled`);this._creativeBlockEnabled=r||n===`rt`||n===`both`,this._cridEventPromise=new Promise(e=>{this._cridsOffEvent=this._bootstrapEventBus.cridBlockLibraryLoadComplete.on(()=>{var t;this._cridsLoaded=!0,e(),(t=this._cridsOffEvent)==null||t.call(this)},{handleEventsAlreadyEmitted:!0})})}get cridEventPromise(){return this._cridEventPromise}get creativeBlockEnabled(){return this._creativeBlockEnabled}get cridsLoaded(){return this._cridsLoaded}set crids(e){this._crids=e}get crids(){return this._crids}},Bu=D([C(),A(`design:paramtypes`,[typeof(Ru=Iu!==void 0&&Iu)==`function`?Ru:Object,typeof(zu=mr!==void 0&&mr)==`function`?zu:Object])],Bu)})),Hu,Uu,Rne=o((()=>{$(),w(),X(),Vu(),j(),E(),At(),O(),Uu=class{constructor(e,t){var n,r;this._creativeBlock=t,T(this,`type`,Ln.cridBlock),T(this,`wait`,!1),T(this,`_timeout`,1500),T(this,`_enabled`,void 0),this._enabled=(n=(r=e.deliveryFeatures)==null?void 0:r.includes(`rbcrid`))==null?!1:n}async _resolveCreativeIdData(e){let t=await e,n=t==null?void 0:t.crids;return new Promise(e=>{n&&(this._creativeBlock.crids=n,e(t)),e({})})}async load(){if(!this._enabled||!this._creativeBlock.creativeBlockEnabled)return this._resolveCreativeIdData(Promise.resolve({}));let e=window.adthrive.rbcrid;if(e)return this._resolveCreativeIdData(e);let t=new Promise(e=>{window.adthrive.rbcridFinished=e}),n=new Promise(e=>{setTimeout(()=>{e({})},this._timeout)});return await Promise.race([t,n]),this._resolveCreativeIdData(window.adthrive.rbcrid)}},Uu=D([Q(`CreativeBlockBootstrap`),S(),A(`design:paramtypes`,[Object,typeof(Hu=Bu!==void 0&&Bu)==`function`?Hu:Object]),kt(0,ot(`AdThrive`))],Uu)})),Wu,zne=o((()=>{$(),Z(),zn(),Wu=class{constructor(e,t){this._bootstrapConfig=e,this._bootstrapEventBus=t}async run(){return this.loadNonBlockingLibraries(),Promise.all([wn(),...this._dependencies])}loadNonBlockingLibraries(){let e;this._orderedLibraryList.forEach(t=>{let n=t.type,r=this._run(()=>{let r=t.load().catch(r=>{if(n===Ln.GAM){var i;this.gamFallback((i=r==null?void 0:r.message)==null?r==null?void 0:r.result:i,e),e.then(e=>{this._bootstrapEventBus[`${n}LibraryLoadComplete`].emit(Promise.resolve(e))}).catch(()=>!1)}throw this._bootstrapEventBus.libraryLoadFailed.emit({bootstrapType:t.type}),r instanceof Error?r:Error(typeof r==`string`?r:JSON.stringify(r))});return this._bootstrapConfig.bootstrapLoaders[t.type]=r,r},t.type,{wait:t.wait}).then(e=>(this._bootstrapEventBus[`${t.type}LibraryLoadComplete`].emit(Promise.resolve(e)),e)).catch(()=>!1);t.type===Ln.Marmalade&&(e=r)})}async gamFallback(e,t){return this._bootstrapConfig.gptLibFailedToLoad=!0,this._bootstrapConfig.webVitalsEnabled||(this._bootstrapConfig.webVitalsEnabled=!0),t.then(t=>Promise.reject({message:e,marmalade:t}))}_run(e,t,{required:n=!1,wait:r=!0}={}){let i=AK(),a=e=>{let n=AK(),r={result:e,started:i,finished:n,duration:n-i};return this._bootstrapConfig.bootstrapResult.set(t,r),r},o=e().then(a,e=>(M.error(`Bootstrap`,`_start error`,t,e),n?Promise.reject(a(e.message)):a(e.message)));return this._forceWait||r?o:Promise.resolve(a(!0))}}})),Gu,Ku,qu,Ju,Yu,Xu,Zu,Qu,$u,ed,td,nd,Bne=o((()=>{w(),$(),$i(),tne(),qi(),wc(),kc(),gu(),Fne(),Ine(),rU(),Cs(),Lne(),Rne(),zne(),j(),E(),O(),nd=class extends Wu{constructor(e,t,n,r,i,a,o,s,c,l,u){super(e,n),this._bootstrapConfig=e,this._user=t,this._bootstrapEventBus=n,this._amazon=r,this._optable=i,this._gam=a,this._marmalade=o,this._prebid=s,this._floors=c,this._trafficShaping=l,this._cridBlock=u,T(this,`_orderedLibraryList`,[this._marmalade,this._gam,this._prebid,this._amazon,this._optable,this._floors,this._trafficShaping,this._cridBlock]),T(this,`_forceWait`,!1),T(this,`_dependencies`,[this._user.getRcid()]);let d=x.resolve(Nu);d.start().catch(e=>{M.error(`Bootstrap`,`constructor`,`Failed to start RecencyAndFrequencyIFrameManager`,e)})}},nd=D([S(),A(`design:paramtypes`,[typeof(Gu=Ki!==void 0&&Ki)==`function`?Gu:Object,typeof(Ku=Ss!==void 0&&Ss)==`function`?Ku:Object,typeof(qu=mr!==void 0&&mr)==`function`?qu:Object,typeof(Ju=Qi!==void 0&&Qi)==`function`?Ju:Object,typeof(Yu=xc!==void 0&&xc)==`function`?Yu:Object,typeof(Xu=Cc!==void 0&&Cc)==`function`?Xu:Object,typeof(Zu=Oc!==void 0&&Oc)==`function`?Zu:Object,typeof(Qu=hu!==void 0&&hu)==`function`?Qu:Object,typeof($u=ku!==void 0&&ku)==`function`?$u:Object,typeof(ed=Fu!==void 0&&Fu)==`function`?ed:Object,typeof(td=Uu!==void 0&&Uu)==`function`?td:Object])],nd)})),rd=o((()=>{Bne(),qi(),$i(),wc(),kc(),gu()})),id,Vne=o((()=>{mU(),w(),O(),id=class extends pU{init(){this._key=`AmazonFailsafeTimeout`,this._lookup=`AMZFS`}},id=D([C()],id)})),ad,od,sd,Hne=o((()=>{w(),rd(),X(),Vne(),j(),E(),At(),O(),sd=class{constructor(e,t,n){T(this,`enabled`,void 0),T(this,`pubId`,`4fbba76f-7987-4fa2-9733-c27eb3a2170b`),T(this,`adUnitExclusions`,new Set([F.Interstitial])),T(this,`amznTargetingKeys`,[]),T(this,`advertiserId`,4526447244),T(this,`failsafeTimeout`,void 0),T(this,`availableBids`,new Map),T(this,`_amznDecryptedTargetingKeys`,[`amz_pb`,`amz_bidder`,`amz_pb_sp`,`amz_bidder_sp`]),T(this,`_amznEncryptedTargetingKeys`,[`amznbid`,`amzniid`,`amznp`,`amznsz`,`mediaType`,`amznbid_sp`,`amzniid_sp`,`amznp_sp`,`amznsz_sp`,`mediaType_sp`]);let r=t.amazonEnabled;this.enabled=r&&e.siteAds.adOptions.amazonUAM===!0,this.amznTargetingKeys=[`amzndeal_sp`,...this._amznEncryptedTargetingKeys,...this._amznDecryptedTargetingKeys],this.failsafeTimeout=n.result||1e3}getEncryptedTargetingKeys(e={dealKeys:!1,nonDealKeys:!1}){return e.dealKeys?this._amznEncryptedTargetingKeys.filter(e=>e.includes(`_sp`)).concat(`amzndeal_sp`):e.nonDealKeys?this._amznEncryptedTargetingKeys.filter(e=>!e.includes(`_sp`)):this._amznEncryptedTargetingKeys}},sd=D([C(),A(`design:paramtypes`,[Object,typeof(ad=Ki!==void 0&&Ki)==`function`?ad:Object,typeof(od=id!==void 0&&id)==`function`?od:Object]),kt(0,ot(`AdThrive`))],sd)})),cd=o((()=>{Hne()})),ld,ud=o((()=>{w(),j(),E(),O(),ld=class{constructor(){T(this,`error`,void 0),T(this,`buildDate`,void 0),T(this,`branch`,void 0),T(this,`bucket`,void 0),T(this,`targetDensityLog`,void 0),T(this,`injectedSlots`,void 0),T(this,`injectedVideoSlots`,void 0),T(this,`experiments`,void 0),T(this,`experimentsWeightedChoice`,void 0),T(this,`siteExperimentsWeightedChoice`,void 0),T(this,`siteExperiments`,void 0),T(this,`injectedFromPlugin`,void 0),T(this,`injectedFromSiteAds`,void 0),T(this,`disabled`,void 0),T(this,`adUnits`,void 0)}init(e){this.error=e.error,this.injectedSlots=e.injectedSlots,this.injectedVideoSlots=e.injectedVideoSlots,this.experiments=e.experiments,this.experimentsWeightedChoice=e.experimentsWeightedChoice,this.siteExperiments=e.siteExperiments,this.siteExperimentsWeightedChoice=e.siteExperimentsWeightedChoice,this.targetDensityLog=e.targetDensityLog,this.buildDate=e.buildDate,this.branch=e.branch,this.bucket=e.bucket,this.injectedFromPlugin=e.injectedFromPlugin,this.injectedFromSiteAds=e.injectedFromSiteAds,this.disabled=e.disabled,this.adUnits=e.adUnits||[]}get enabled(){return!this.error&&!this.disabled}overwriteInjectedSlots(e){this.injectedSlots=e}},ld=D([C(),A(`design:paramtypes`,[])],ld)})),dd,fd,pd,md,hd,gd,_d,Une=o((()=>{w(),X(),Ra(),ii(),ud(),j(),E(),At(),O(),md=250,hd=50,gd=90,_d=class{constructor(e,t,n,r){if(this._context=t,this._abgroup=n,this._cls=r,T(this,`_clsOptimizedAds`,void 0),T(this,`_defaultHeight`,md),T(this,`_map`,new Map([[`phone`,{Content:md,Recipe:md,Header:hd,Footer:hd,Below_Post:md,Sidebar:md}],[`tablet`,{Content:md,Recipe:md,Header:gd,Footer:gd,Below_Post:md,Sidebar:md}],[`desktop`,{Content:md,Recipe:md,Header:gd,Footer:gd,Below_Post:md,Sidebar:md}]])),this._clsOptimizedAds=e.siteAds.adOptions.clsOptimizedAds,this._cls.enabled){let e=`clsins_ss`,t=this._cls.experiments&&e in this._cls.experiments;t&&this._abgroup.set(e,String(t))}}get enabled(){return this._clsOptimizedAds||this._cls.enabled&&(this._cls.injectedFromPlugin||this._cls.injectedFromSiteAds)}getDivHeight(e,t){let n=this._map.get(t);return n&&n[e]||this._defaultHeight}setStyle(e,t){if(t===F.Footer||this.enabled&&this._map.get(this._context.device)[t]){e.classList.add(`adthrive-ad-cls`);let n=t===F.Header||t===F.Footer;n&&e.classList.add(`adthrive-${t.toLowerCase()}-${this._context.device}`)}}},_d=D([C(),A(`design:paramtypes`,[Object,typeof(dd=L!==void 0&&L)==`function`?dd:Object,typeof(fd=ti!==void 0&&ti)==`function`?fd:Object,typeof(pd=ld!==void 0&&ld)==`function`?pd:Object]),kt(0,ot(`AdThrive`))],_d)})),vd=o((()=>{Une()})),yd,bd,Wne=o((()=>{w(),Z(),rU(),j(),E(),At(),O(),bd=class{constructor(e,t){this._footerConfigEventBus=t,T(this,`tracker`,!0),T(this,`gdpr`,!1),T(this,`category`,void 0),T(this,`comscore`,void 0),T(this,`comscoreMessage`,void 0),T(this,`_footerMessages`,new Map([[`FamilyParenting`,`CafeMedia Family & Parenting`],[`Finance`,`CafeMedia Finance`],[`Food`,`CafeMedia Food`],[`General`,`CafeMedia`],[`HomeDIY`,`CafeMedia Home/DIY`],[`Lifestyle`,`CafeMedia Lifestyle`],[`Pets`,`CafeMedia Pets`],[`Tech`,`CafeMedia Tech`],[`Travel`,`CafeMedia Travel`]]));let{comscore:n,comscoreFooter:r}=e.siteAds.adOptions;this.category=N(n,`General`),this.comscore=N(r,!0),this.comscoreMessage=N(this._footerMessages.get(this.category),`CafeMedia`),this._footerConfigEventBus.comscoreInitialized.emit(this.comscore)}},bd=D([C(),A(`design:paramtypes`,[Object,typeof(yd=xr!==void 0&&xr)==`function`?yd:Object]),kt(0,ot(`AdThrive`))],bd)})),xd=o((()=>{Wne()})),Sd,Cd,Gne=o((()=>{w(),X(),$(),Z(),rU(),ud(),j(),E(),At(),O(),Cd=class{constructor(e,t){this.adthrive=e,this._cls=t,T(this,`all`,!1),T(this,`content`,!1),T(this,`recipe`,!1),T(this,`video`,!1),T(this,`locations`,new Set),T(this,`reasons`,new Set),T(this,`_clsDivs`,[`adthrive-below-post`,`adthrive-content`,`adthrive-header`,`adthrive-recipe`,`adthrive-sidebar`]),T(this,`_disableAdsEventBus`,x.resolve(vr)),T(this,`init`,()=>{(this.urlHasEmail(window.location.href)||this.urlHasEmail(window.document.referrer))&&(this.all=!0,this.reasons.add(`all_email`),this.removeClsDivs(this._clsDivs));try{document.body.classList.contains(`adthrive-disable-all`)&&(this.all=!0,this.reasons.add(`all_plugin`)),document.body.classList.contains(`adthrive-disable-content`)&&(this.content=!0,this.recipe=!0,this.locations.add(F.Content),this.locations.add(F.Recipe),this.reasons.add(`content_plugin`)),document.querySelector(`.tag-novideo`)!==null&&(this.video=!0,this.locations.add(`Video`),this.reasons.add(`video_tag`)),document.body.classList.contains(`adthrive-disable-video`)&&(this.video=!0,this.locations.add(`Video`),this.reasons.add(`video_plugin`))}catch(e){M.error(`DisableAds`,`constructor`,{message:e.message});let t=`classList`in document.createElement(`_`);M.error(`BodyDeviceClassComponent`,`init.support`,{support:t});let n=`classList`in document.body;M.error(`BodyDeviceClassComponent`,`init.supportBody`,{supportBody:n})}this.reasons.size>0&&this._emit(),this._log(`init`)}),T(this,`clear`,()=>{this.all=!1,this.content=!1,this.recipe=!1,this.video=!1,this.locations=new Set,this.reasons=new Set}),T(this,`_log`,e=>{}),this.init()}removeClsDivs(e){if(this._cls.enabled&&this._cls.injectedSlots&&this._cls.injectedSlots.length){let t=this._cls.injectedSlots.filter(t=>{let n=t.element,r=!1;return n.parentNode&&e.some(e=>n.classList.contains(e))&&(n.parentNode.removeChild(n),r=!0),!r});this._cls.overwriteInjectedSlots(t)}}disableAllAds(e){(!e||SK(e))&&(this.all=!0,this.reasons.add(`all_page`),this.removeClsDivs(this._clsDivs),this._emit()),this._log(`disableAllAds`)}disableContentAds(e){(!e||SK(e))&&(this.content=!0,this.recipe=!0,this.locations.add(F.Content),this.locations.add(F.Recipe),this.reasons.add(`content_page`),this.removeClsDivs([`adthrive-content`,`adthrive-recipe`])),this._log(`disableContentAds`)}disablePlaylistPlayers(e){(!e||SK(e))&&(this.video=!0,this.locations.add(`Video`),this.reasons.add(`video_page`),this.adthrive.siteAds.videoPlayers?this._removeCLSVideoPlayers():this._removeLegacyCLSVideoPlayers()),this._log(`disablePlaylistPlayers`)}_removeCLSVideoPlayers(){var e;(e=this.adthrive.siteAds.videoPlayers)==null||e.players.filter(e=>e.type===`stickyPlaylist`).map(e=>document.querySelectorAll(`#cls-video-container-${e.playlistId}`)).forEach(e=>{for(let n=0;n<e.length;n++){var t;let r=e[n];(t=r.parentNode)==null||t.removeChild(r)}})}_removeLegacyCLSVideoPlayers(){var e;let t=(e=this.adthrive.siteAds.video)==null?void 0:e.jwPlaylistId;if(t){let e=document.querySelectorAll(`#cls-video-container-${t}`);for(let t=0;t<e.length;t++){var n;let r=e[t];(n=r.parentNode)==null||n.removeChild(r)}}}urlHasEmail(e){if(!e)return!1;let t=/([A-Z0-9._%+-]+(@|%(25)*40)[A-Z0-9.-]+\.[A-Z]{2,})/i;return t.exec(e)!==null}_emit(){this._disableAdsEventBus.disableAds.emit(this.reasons)}},Cd=D([C(),A(`design:paramtypes`,[Object,typeof(Sd=ld!==void 0&&ld)==`function`?Sd:Object]),kt(0,ot(`AdThrive`))],Cd)})),Kne=o((()=>{Gne()})),wd,qne=o((()=>{w(),fa(),O(),wd=class extends da{init(){this._setAbGroup=!1,this._key=`DisplayOpenBidderExperiment`,this._lookup=`DOBA`,this._default=[`none`]}},wd=D([C()],wd)})),Td,Ed,Jne=o((()=>{w(),qne(),j(),E(),O(),Ed=class{constructor(e){T(this,`bidders`,void 0),this.bidders=e.result||[`none`]}},Ed=D([C(),A(`design:paramtypes`,[typeof(Td=wd!==void 0&&wd)==`function`?Td:Object])],Ed)})),Dd,Od=o((()=>{hee(),Dd=e=>{let{tablet:t,desktop:n}=e.siteAds.breakpoints,r=Cn(t,n),i=e.siteAds,a=i.video&&i.video.partners&&i.video.partners.stickyOutstream,o=i.videoPlayers&&i.videoPlayers.partners&&i.videoPlayers.partners.stickyOutstream,s=a||o,c=e.siteAds.adOptions,l=s||c&&c.stickyOutstream,u=l&&(r===`phone`?l.mobile.enabled:l.desktop.enabled);return!!u}})),kd,Ad,jd,Yne=o((()=>{Od(),Ti(),_W(),X(),Z(),w(),j(),E(),At(),O(),jd=class{constructor(e,t,n){this._adOptions=t,this._stickyOutstreamSiteExperiment=n,T(this,`_device`,void 0),T(this,`_stickyOutstreamEnabled`,!1),T(this,`_adthriveOptions`,void 0),T(this,`_adthriveSiteAds`,void 0),T(this,`_supportedSizes`,[[728,90],[300,250],[300,600],[320,50],[970,250],[160,600],[300,1050],[336,280],[970,90],[300,50],[320,100],[468,60],[250,250],[120,240],[1,1],[300,300],[552,334],[300,420],[728,250],[320,300],[300,390]]),T(this,`_tallMobileContentAdsizes`,[[300,600],[160,600]]),T(this,`_interstitialSupportedSizes`,[[320,50],[300,250],[300,600],[336,280],[320,480],[1,1]]),T(this,`_adUnitAuctionPriorityMap`,new Map([[F.Footer,1],[F.Header,2],[F.Sidebar,3],[F.Content,4],[F.Recipe,5],[`Sidebar_sticky`,6],[`Below Post`,7]])),T(this,`_interstitialSettingTemplate`,void 0),T(this,`_stickyOutstreamSettingTemplate`,void 0),T(this,`_adUnitSettingTemplate`,{auctionPriority:8,autosize:!0,classNames:[],devices:[`tablet`,`phone`,`desktop`],elementSelector:`body`,every:1,lazy:!1,lazyMax:0,lazyMaxDefaulted:!1,location:``,max:1,pageSelector:``,position:`beforebegin`,sequence:1,sizes:[],skip:0,spacing:0,special:[],sticky:!1,stickyOverlapSelector:``,name:``}),T(this,`_adUnits`,void 0),T(this,`isStickyUnit`,(e,t)=>{let{location:n,sticky:r}=e,i=n===F.Recipe&&t;if(i){let{recipeMobile:e,recipeDesktop:n}=t;if(tG()&&e!=null&&e.enabled||!tG()&&n!=null&&n.enabled)return!0}return n===F.Footer||r});let{tablet:r,desktop:i}=e.siteAds.breakpoints;this._device=Cn(r,i),this._adthriveSiteAds=e.siteAds,this._adthriveOptions=this._adthriveSiteAds.adOptions,this._adUnits=e.siteAds.adUnits,this.setupStickyOutstreamSettings(e),this.setupInterstitialSettings()}setupStickyOutstreamSettings(e){let t=e.siteAds.video&&e.siteAds.video.partners&&e.siteAds.video.partners.stickyOutstream,n=this._adthriveSiteAds.videoPlayers&&this._adthriveSiteAds.videoPlayers.partners&&this._adthriveSiteAds.videoPlayers.partners.stickyOutstream,r=t||n,i=Dd(e),a=this._stickyOutstreamSiteExperiment.enabled?this._stickyOutstreamSiteExperiment.result:i;if(a){this._stickyOutstreamEnabled=!0;let e={...this._adUnitSettingTemplate};e.sticky=!0,e.location=F.Video_StickyOutstream,e.position=`beforeend`,e.pageSelector=N(r&&r.blockedPageSelectors,``),e.sizes=this._device===`phone`?[[300,50]]:[[300,250]],this._stickyOutstreamSettingTemplate=e}}setupInterstitialSettings(){let e={...this._adUnitSettingTemplate},t=this._adthriveOptions;e.location=F.Interstitial,e.sizes=this.interstitalSupportedSizes(),e.pageSelector=N(t.interstitialBlockedPageSelectors,``),this._interstitialSettingTemplate=e}get(){this._adUnits.sort((e,t)=>{let n=e.location===F.Sidebar&&e.sticky?`${e.location}_sticky`:e.location,r=t.location===F.Sidebar&&t.sticky?`${t.location}_sticky`:t.location;return this._adUnitAuctionPriorityMap.get(n)-this._adUnitAuctionPriorityMap.get(r)});let e=this._adUnits.filter(e=>e.dynamic!==void 0&&e.dynamic.enabled).map(e=>{var t;let n=e.location.replace(/\s+/g,`_`),r=n===`Sidebar`?0:2,i=N(e.dynamic.lazyMax,r),a=((t=e.dynamic)==null?void 0:t.lazy)===void 0?i>0:e.dynamic.lazy;return{auctionPriority:this._adUnitAuctionPriorityMap.get(n)||8,location:n,sequence:N(e.sequence,1),thirdPartyAdUnitName:e.thirdPartyAdUnitName||``,sizes:this.onlySupportedAdSizes(e.adSizes).filter(t=>this.includeCertainTallSizes(e,t)),devices:e.devices,pageSelector:N(e.dynamic.pageSelector,``).trim(),elementSelector:N(e.dynamic.elementSelector,``).trim(),position:N(e.dynamic.position,`beforebegin`),max:Math.floor(N(e.dynamic.max,0)),spacing:N(e.dynamic.spacing,0),skip:Math.floor(N(e.dynamic.skip,0)),every:Math.max(Math.floor(N(e.dynamic.every,1)),1),classNames:e.dynamic.classNames||[],sticky:this.isStickyUnit(e,this._adthriveSiteAds.adOptions.stickyContainerConfig),stickyOverlapSelector:N(e.stickyOverlapSelector,``).trim(),autosize:e.autosize,special:N(e.targeting,[]).filter(e=>e.key===`special`).reduce((e,t)=>e.concat(...t.value),[]),lazy:a,lazyMax:i,lazyMaxDefaulted:e.dynamic.lazyMax===0?!1:!e.dynamic.lazyMax,name:e.name}});return this._stickyOutstreamEnabled&&this._stickyOutstreamSettingTemplate&&e.push(this._stickyOutstreamSettingTemplate),this._adOptions.interstitial.gam&&this._interstitialSettingTemplate&&e.push(this._interstitialSettingTemplate),e}onlySupportedAdSizes(e){return this._supportedSizes.filter(([t,n])=>e.some(([e,r])=>t===e&&n===r))}interstitalSupportedSizes(){return this._interstitialSupportedSizes.filter(([e,t])=>!(this._device!==`phone`&&`${e},${t}`==`320,50`))}includeCertainTallSizes(e,[t,n]){let{location:r,sequence:i}=e;if(r===F.Footer)return!(this._device===`phone`&&t===320&&n===100);if(r===F.Header)return!0;if(r===F.Recipe)return!(tG()&&this._device===`phone`&&(t===300&&n===390||t===320&&n===300));if(r===F.Sidebar){let t=e.adSizes.some(([,e])=>e<=300),r=!!i&&i<=5,a=n>300;return a&&!t||i===9?!0:r?a?e.sticky:!0:!a}else return!0}},jd=D([S(),A(`design:paramtypes`,[Object,typeof(kd=Ci!==void 0&&Ci)==`function`?kd:Object,typeof(Ad=oW!==void 0&&oW)==`function`?Ad:Object]),kt(0,ot(`AdThrive`))],jd)})),Md=o((()=>{Yne(),xee()})),Nd,Xne=o((()=>{w(),Ui(),E(),O(),Nd=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`FledgeGPT`,this._lookup=`FLDG`,this._autorun=!1}},Nd=D([C()],Nd)})),Pd,Zne=o((()=>{w(),Ui(),E(),O(),Pd=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`PaapiExperiment`,this._lookup=`PAAPI`}},Pd=D([C()],Pd)})),Fd,Id,Ld,Rd=o((()=>{w(),Z(),Xne(),Zne(),j(),E(),At(),O(),Ld=class{constructor(e,t,n){var r;this._paapiExperiment=t,this._fledgeGptExperiment=n,T(this,`_supported`,void 0),T(this,`_enabled`,void 0),T(this,`_cookieDeprecationLabel`,void 0),this._cookieDeprecationLabel=(r=e.cookieDeprecationLabel)==null?null:r,this._supported=pn(),this._enabled=this._isFledgeEnabled()}get supported(){return this._supported}get enabled(){return this._enabled}get cookieDeprecationLabel(){return this._cookieDeprecationLabel}_isFledgeEnabled(){var e;if(!this._supported||!this._paapiExperiment.result)return!1;let t=((e=this._cookieDeprecationLabel)==null?``:e).replace(`fake_`,``),n=hn(t);return n===`enabled`?!0:n===`disabled`?!1:this._fledgeGptExperiment.result}},Ld=D([C(),A(`design:paramtypes`,[Object,typeof(Fd=Pd!==void 0&&Pd)==`function`?Fd:Object,typeof(Id=Nd!==void 0&&Nd)==`function`?Id:Object]),kt(0,ot(`AdThrive`))],Ld)})),zd=o((()=>{Rd()})),Bd,Qne=o((()=>{w(),E(),O(),Bd=class{constructor(){T(this,`elements`,[]),T(this,`footerSelectorsForHeightCheck`,[`div[data-gg-moat]`,`.kargo-ad-content`,`.adthrive-footer`,`.sprkflw_main.sprkflw_default`,`.ogy-footer-ad`,`.raptive-sales-footer`])}},Bd=D([C()],Bd)})),Vd=o((()=>{Qne()})),Hd,$ne=o((()=>{w(),fa(),O(),Hd=class extends da{init(){this._key=`HBHO2`,this._lookup=`HBHO2`,this._default=[`none`]}},Hd=D([C()],Hd)})),Ud,ere=o((()=>{w(),Ui(),E(),O(),Ud=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`HBHORise`,this._lookup=`HBHORISE`}},Ud=D([C()],Ud)})),Wd,tre=o((()=>{w(),fa(),O(),Wd=class extends da{init(){this._key=`AllBidderHO`,this._lookup=`ALLBHO`,this.abgroup=`allbho`,this._default=[`none`]}get result(){var e;return(e=this._result)==null?this._default:e}},Wd=D([C()],Wd)})),Gd=o((()=>{tre()})),Kd,qd,Jd,Yd,Xd,nre=o((()=>{w(),$ne(),ere(),Gd(),X(),j(),E(),O(),Yd=[`none`],Xd=class{constructor(e,t,n){var r;this.hbhoExperiment=e,this.allBidderHOExperiment=t,this.hbhoRiseExperiment=n,T(this,`bidders`,[]),T(this,`filteredBidders`,void 0),T(this,`_fullyDisabledBiddersMapping`,[]);let i=(r=this.hbhoExperiment.result)==null?[]:r,a=this.allBidderHOExperiment.result;this.hbhoRiseExperiment.result&&i.push(P.Rise),this.bidders=[...i,...a].filter((e,t,n)=>e!==`none`&&n.indexOf(e)===t),this.bidders.length===0&&(this.bidders=Yd),this.filteredBidders=this._getFilteredBidders(this.bidders)}_getFilteredBidders(e){let t=e.filter(e=>this._fullyDisabledBiddersMapping.includes(e));return t}},Xd=D([C(),A(`design:paramtypes`,[typeof(Kd=Hd!==void 0&&Hd)==`function`?Kd:Object,typeof(qd=Wd!==void 0&&Wd)==`function`?qd:Object,typeof(Jd=Ud!==void 0&&Ud)==`function`?Jd:Object])],Xd)})),rre=o((()=>{nre()})),Zd,ire=o((()=>{w(),E(),O(),Zd=class{constructor(){T(this,`refreshSlots`,new Set([`Footer`])),T(this,`ajaxType`,!1)}},Zd=D([C()],Zd)})),are=o((()=>{ire()})),Qd,ore=o((()=>{w(),j(),E(),O(),Qd=class{constructor(){T(this,`googleLazyLoadSettings`,void 0),this.googleLazyLoadSettings={disabled:{fetchMarginPercent:-1,renderMarginPercent:-1,mobileScaling:-1},gam:{fetchMarginPercent:600,renderMarginPercent:100,mobileScaling:1.5},hbMarginPercent:700}}},Qd=D([C(),A(`design:paramtypes`,[])],Qd)})),$d=o((()=>{ore()})),ef,sre=o((()=>{w(),Z(),j(),E(),At(),O(),ef=class{constructor(e){T(this,`enabled`,void 0),T(this,`_id`,`69e75073-3763-483e-a64c-0d281bfd9225`),T(this,`url`,`https://launchpad-wrapper.privacymanager.io/${this._id}/launchpad-liveramp.js`),this.enabled=N(e.siteAds.adOptions.liveRampATS,!0)}},ef=D([C(),A(`design:paramtypes`,[Object]),kt(0,ot(`AdThrive`))],ef)})),tf=o((()=>{sre()})),nf,cre=o((()=>{w(),j(),E(),At(),O(),nf=class{constructor(e){var t,n;T(this,`country`,void 0),T(this,`region`,void 0),T(this,`tz`,void 0),T(this,`gdpr`,void 0),this.country=e==null||(t=e.core)==null||(t=t.country)==null?void 0:t.toUpperCase(),this.region=e==null||(n=e.core)==null||(n=n.region)==null?void 0:n.toUpperCase(),this.tz=Intl.DateTimeFormat().resolvedOptions().timeZone,this.gdpr=e==null?void 0:e.gdpr}get targetingValue(){return this.isNewZealand()?`nz`:this.isUnitedStates()?`us`:this.isUnitedKingdom()?`uk`:this.isCanada()?`ca`:this.isGDPR()?`gdpr`:`o`}isNewZealand(){return this.country===`NZ`}isUnitedStates(){return this.country===`US`}isUnitedKingdom(){if(!this.country)return!1;let e=[`UK`,`GB`,`IM`,`GG`,`JE`,`GI`,`FK`];return e.includes(this.country)}isCanada(){return this.country===`CA`}isGDPR(){return this.country?this.gdpr===`true`:!1}},nf=D([C(),A(`design:paramtypes`,[Object]),kt(0,ot(`AdThrive`))],nf)})),lre=o((()=>{cre()})),rf,af,ure=o((()=>{rf=e=>{let t=e.substring(13).split(`.`).map(e=>parseInt(e));return{major:t[0],minor:t[1],patch:t[2]}},af=(e,t)=>{let n=rf(e),r=rf(t);if(n.major>r.major)return!1;if(n.major<r.major)return!0;if(n.minor>r.minor)return!1;if(n.minor<r.minor)return!0;if(n.patch>r.patch)return!1;if(n.patch<=r.patch)return!0}})),sf,cf,dre=o((()=>{Z(),ure(),w(),ud(),j(),E(),At(),O(),cf=class{constructor(e,t){this._cls=t,T(this,`enabled`,void 0),T(this,`settings`,void 0),T(this,`_adDensityEnabled`,void 0),this.settings=e.siteAds.adDensityLayout,this._adDensityEnabled=N(e.siteAds.adDensityEnabled,!0),this.enabled=this.isEnabled()}isEnabled(){let e=window,t=e.adthrive&&e.adthrive.plugin,n=this._cls&&this._cls.experiments,r=!!(n&&`clsins_ss`in n),i=r||!!(t&&af(`adthrive-ads-1.1.0`,t));return!!(this.settings&&this._adDensityEnabled&&i)}},cf=D([C(),A(`design:paramtypes`,[Object,typeof(sf=ld!==void 0&&ld)==`function`?sf:Object]),kt(0,ot(`AdThrive`))],cf)})),lf,uf,df,fre=o((()=>{mU(),w(),Ra(),O(),lf=e=>{let t=e.downlink;return t===void 0?`unknown`:t<10?`slow`:`fast`},uf=e=>{let t=lf(e);if(e.device===`desktop`)switch(t){case`fast`:return{key:`InitialTimeoutDesktopFastExperiment`,lookupKey:`ITO_DF`};case`slow`:return{key:`InitialTimeoutDesktopSlowExperiment`,lookupKey:`ITO_DS`};case`unknown`:return{key:`InitialTimeoutDesktopUnknownExperiment`,lookupKey:`ITO_DN`}}else switch(t){case`fast`:return{key:`InitialTimeoutMobileFastExperiment`,lookupKey:`ITO_MF`};case`slow`:return{key:`InitialTimeoutMobileSlowExperiment`,lookupKey:`ITO_MS`};case`unknown`:return{key:`InitialTimeoutMobileUnknownExperiment`,lookupKey:`ITO_MN`}}},df=class extends pU{init(){let e=x.resolve(L),{key:t,lookupKey:n}=uf(e);this._key=t,this._lookup=n}},df=D([C()],df)})),ff,pf,pre=o((()=>{w(),fre(),j(),E(),O(),pf=class{constructor(e){var t;T(this,`initialBidsRequest`,void 0),T(this,`refreshBidsRequest`,void 0),this.initialBidsRequest=(t=e.result)==null?2400:t,this.refreshBidsRequest=5e3}},pf=D([C(),A(`design:paramtypes`,[typeof(ff=df!==void 0&&df)==`function`?ff:Object])],pf)})),mre=o((()=>{pre()})),mf,hf=o((()=>{w(),$(),E(),O(),mf=class{constructor(){T(this,`_data`,{})}set(e){this._data={...this._data,...e}}get(){return Object.keys(this._data).length===0?void 0:this._data}getByKey(e){return this._data[e]}clear(){this.set({})}},mf=D([Q(`UserPageDataLoggingStore`),C()],mf)})),gf,_f,vf=o((()=>{w(),$(),bt(),hf(),j(),E(),O(),_f=class{constructor(e){this._userPageDataLoggingStore=e,T(this,`loggingData`,new k),T(this,`_maxTimeOnPage`,36e5),T(this,`_listeners`,[]),T(this,`_callbacks`,new Set),T(this,`_requestSent`,!1),setTimeout(()=>{this._callbacks.forEach(e=>this._executeCallback(e)),this.cleanup()},this._maxTimeOnPage)}_executeCallback(e){e(),this._callbacks.delete(e),this._callbacks.size===0&&this.logUserPageData()}setUserPageData(e){e&&this._userPageDataLoggingStore.set(e)}logUserPageData(){this._requestSent||(M.fetchEvent(`UserPageDataLoggingComponent`,`logUserData`,this._userPageDataLoggingStore.get()),this._requestSent=!0,this.cleanup())}addCallbackToQueue(e,t){this._callbacks.add(t),e.forEach(e=>{this._listeners.push(e.on(()=>this._executeCallback(t)))})}cleanup(){this._listeners.forEach(e=>{e()}),this._listeners=[],this._callbacks.clear()}},_f=D([Q(`UserPageDataLoggingEvents`),C(),A(`design:paramtypes`,[typeof(gf=mf!==void 0&&mf)==`function`?gf:Object])],_f)})),yf,bf,xf,hre=o((()=>{vf(),Na(),Z(),w(),X(),j(),E(),O(),xf=class{constructor(e,t){this._pageManager=t,T(this,`started`,0),T(this,`delay`,0),T(this,`loading`,0),T(this,`timeOnPage`,void 0),T(this,`totalTimeOnPage`,0),T(this,`bootstrapFinished`,0),T(this,`amazonStarted`,0),T(this,`amazonFinished`,0),T(this,`amazonDuration`,0),T(this,`gamStarted`,0),T(this,`gamFinished`,0),T(this,`gamDuration`,0),T(this,`marmaladeStarted`,0),T(this,`marmaladeFinished`,0),T(this,`marmaladeDuration`,0),T(this,`floorsStarted`,0),T(this,`floorsFinished`,0),T(this,`floorsDuration`,0),T(this,`prebidStarted`,0),T(this,`prebidFinished`,0),T(this,`prebidDuration`,0),T(this,`optableStarted`,0),T(this,`optableFinished`,0),T(this,`optableDuration`,0),this.started=AK(),document.visibilityState===`visible`&&(this.timeOnPage=this.started),this._pageManager.visibilityChange.on(()=>this.documentVisibilityChanged()),e.loggingData.on(()=>{document.visibilityState===`visible`&&(this.totalTimeOnPage+=AK()-this.timeOnPage)})}setNonBlockingLibraryTimingData(e){let t=e.get(Rn.Prebid),n=e.get(Rn.Amazon),r=e.get(Rn.Optable);this._setPrebidTimingData(t),this._setAmazonTimingData(n),this._setOptableTimingData(r)}_setPrebidTimingData(e){this.prebidStarted=e&&e.started||0,this.prebidFinished=e&&e.finished||0,this.prebidDuration=e&&e.started&&e.finished&&e.finished-e.started||0}_setAmazonTimingData(e){this.amazonStarted=e&&e.started||0,this.amazonFinished=e&&e.finished||0,this.amazonDuration=e&&e.started&&e.finished&&e.finished-e.started||0}_setOptableTimingData(e){this.optableStarted=e&&e.started||0,this.optableFinished=e&&e.finished||0,this.optableDuration=e&&e.started&&e.finished&&e.finished-e.started||0}get timingData(){return{started:this.started,delay:this.delay,loading:this.loading,totalTimeOnPage:this.totalTimeOnPage,bootstrapFinished:this.bootstrapFinished,amazonStarted:this.amazonStarted,amazonFinished:this.amazonFinished,amazonDuration:this.amazonDuration,gamStarted:this.gamStarted,gamFinished:this.gamFinished,gamDuration:this.gamDuration,marmaladeStarted:this.marmaladeStarted,marmaladeFinished:this.marmaladeFinished,marmaladeDuration:this.marmaladeDuration,floorsStarted:this.floorsStarted,floorsFinished:this.floorsFinished,floorsDuration:this.floorsDuration,prebidStarted:this.prebidStarted,prebidFinished:this.prebidFinished,prebidDuration:this.prebidDuration,optableStarted:this.optableStarted,optableFinished:this.optableFinished,optableDuration:this.optableDuration,...this.timeOnPage&&{timeOnPage:this.timeOnPage}}}documentVisibilityChanged(){document.visibilityState===`visible`?this.timeOnPage=AK():document.visibilityState===`hidden`&&(this.totalTimeOnPage+=AK()-this.timeOnPage,this.timeOnPage=void 0)}},xf=D([C(),A(`design:paramtypes`,[typeof(yf=_f!==void 0&&_f)==`function`?yf:Object,typeof(bf=ja!==void 0&&ja)==`function`?bf:Object])],xf)})),Sf=o((()=>{hre()})),Cf,gre=o((()=>{w(),fa(),O(),Cf=class extends da{init(){this._key=`TKHO`,this._lookup=`TKHO_2`,this._default=[`none`]}},Cf=D([C()],Cf)})),wf,Tf,_re=o((()=>{w(),gre(),j(),E(),O(),Tf=class{constructor(e){var t;T(this,`tracker`,void 0),this.tracker=(t=e.result)==null?[`none`]:t}},Tf=D([C(),A(`design:paramtypes`,[typeof(wf=Cf!==void 0&&Cf)==`function`?wf:Object])],Tf)})),Ef=o((()=>{_re()})),Df,vre=o((()=>{w(),fa(),O(),Df=class extends da{init(){this._key=`VBHO2`,this._lookup=`VBHO2`,this._default=[`none`]}},Df=D([C()],Df)})),Of,yre=o((()=>{w(),Ui(),E(),O(),Of=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`VBHORise`,this._lookup=`VBHORISE`}},Of=D([C()],Of)})),kf,Af,jf,Mf,Nf,bre=o((()=>{w(),vre(),yre(),Gd(),X(),j(),E(),O(),Mf=[`none`],Nf=class{constructor(e,t,n){var r;this.vbhoExperiment=e,this.allBidderHOExperiment=t,this.vbhoRiseExperiment=n,T(this,`bidders`,void 0),T(this,`filteredBidders`,void 0),T(this,`_fullyDisabledBiddersMapping`,[]);let i=(r=this.vbhoExperiment.result)==null?[]:r,a=this.allBidderHOExperiment.result;this.vbhoRiseExperiment.result&&i.push(P.Rise),this.bidders=[...i,...a].filter((e,t,n)=>e!==`none`&&n.indexOf(e)===t),this.bidders.length===0&&(this.bidders=Mf),this.filteredBidders=this._getFilteredBidders(this.bidders)}_getFilteredBidders(e){let t=e.filter(e=>this._fullyDisabledBiddersMapping.includes(e));return t}},Nf=D([C(),A(`design:paramtypes`,[typeof(kf=Df!==void 0&&Df)==`function`?kf:Object,typeof(Af=Wd!==void 0&&Wd)==`function`?Af:Object,typeof(jf=Of!==void 0&&Of)==`function`?jf:Object])],Nf)})),xre=o((()=>{bre()})),Pf,Ff=o((()=>{Z(),Pf=class{static getScrollTop(){return(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0)}static getScrollBottom(){return this.getScrollTop()+(document.documentElement.clientHeight||0)}static shufflePlaylist(e){let t=e.length,n,r;for(;t!==0;)r=Math.floor(Math.random()*e.length),--t,n=e[t],e[t]=e[r],e[r]=n;return e}static isMobileLandscape(){return window.matchMedia(`(orientation: landscape) and (max-height: 480px)`).matches}static playerViewable(e){let t=e.getBoundingClientRect();return this.isMobileLandscape()?window.innerHeight>t.top+t.height/2&&t.top+t.height/2>0:window.innerHeight>t.top+t.height/2}static createQueryString(e){return Object.keys(e).map(t=>`${t}=${e[t]}`).join(`&`)}static createEncodedQueryString(e){return Object.keys(e).map(t=>`${t}=${encodeURIComponent(e[t])}`).join(`&`)}static setMobileLocation(e){return e=e||`bottom-right`,e===`top-left`?e=`adthrive-collapse-top-left`:e===`top-right`?e=`adthrive-collapse-top-right`:e===`bottom-left`?e=`adthrive-collapse-bottom-left`:e===`bottom-right`?e=`adthrive-collapse-bottom-right`:e===`top-center`&&(e=tG()?`adthrive-collapse-top-center`:`adthrive-collapse-bottom-right`),e}static addMaxResolutionQueryParam(e){let t=tG()?`320`:`1280`,n=`max_resolution=${t}`,[r,i]=String(e).split(`?`),a=i?i+`&${n}`:n;return`${r}?${a}`}}})),If,Lf,Rf=o((()=>{If=e=>{try{return{valid:!0,elements:document.querySelectorAll(e)}}catch(e){return{valid:!1,...e}}},Lf=e=>e===``?{valid:!0}:If(e)})),zf,Bf,Vf,Hf=o((()=>{_W(),Rf(),w(),zf=()=>{let e=Lf(`.adthrive-content-specific-playlist`);return e.valid&&e.elements&&e.elements.length?{playlistId:e.elements[0].getAttribute(`data-playlist-id`),shuffle:!!e.elements[0].getAttribute(`data-playlist-shuffle`)}:null},Bf=e=>{let t=[],n=[],r=zf(),i=r&&r.playlistId;if(i)return r;e.forEach(e=>{if(e.isDraft)return;let r=e.categories.some(e=>{let t=Lf(`.adthrive-cat-${e}`);return t.valid&&t.elements&&t.elements.length});r?t.push({playlistId:e.playlistId,shuffle:e.shuffle||!1}):e.categories.length===0&&n.push({playlistId:e.playlistId,shuffle:e.shuffle||!1})});let a=t.length>0?t:n,o=Math.floor(Math.random()*a.length);return a[o]},Vf=e=>{let t=x.resolve(_U);if(t.result&&e.length){let t=Bf(e);return t}}})),Uf,Sre=o((()=>{mU(),w(),O(),Uf=class extends pU{init(){this._key=`RaptivePlayerLoadVideoTimeout`,this._lookup=`RPLVTO`}},Uf=D([C()],Uf)})),Wf,Gf,Kf,qf,Jf,Yf,Xf,Zf,Qf,$f,ep,tp,np,rp,ip,ap,op,sp,cp,lp,up,dp,fp,Cre=o((()=>{X(),Ff(),Z(),w(),Rm(),al(),Hf(),_W(),Sre(),j(),E(),At(),O(),fp=class{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v,y,b,ee,te){T(this,`videoEmbed`,void 0),T(this,`jwPlayer`,void 0),T(this,`relatedSettings`,void 0),T(this,`players`,[]),T(this,`vastTimeoutISV`,void 0),T(this,`vastTimeoutOSV`,void 0),T(this,`maxRedirect`,void 0),T(this,`apiValue`,void 0),T(this,`videoWasClosed`,void 0),T(this,`mobileStickyPlayerOnPage`,void 0),T(this,`logAdDuration`,void 0),T(this,`logAdLifeCycle`,void 0),T(this,`jwRequestTimeout`,void 0),T(this,`mimeType`,void 0),T(this,`videoProtocols`,void 0),T(this,`playbackmethod`,void 0),T(this,`outstreamPlacement`,void 0),T(this,`stickyOutstreamCloseButtonTimeout`,void 0),T(this,`advancePlaylist`,void 0),T(this,`position`,void 0),T(this,`removeVideoTitleWrapper`,void 0),T(this,`instreamAdUnits`,new Set([vW.Video_Collapse_Autoplay_SoundOff,vW.Video_Individual_Autoplay_SOff,vW.Video_Coll_SOff_Smartphone,vW.Video_In_Post_ClicktoPlay_SoundOn])),T(this,`footerSelector`,void 0),T(this,`jwPlaylistObj`,void 0),T(this,`stickyOutstreamSettings`,void 0),T(this,`contentSpecificPlaylists`,void 0),T(this,`setStandardOutstreamBackupRenderer`,void 0),T(this,`maxBitrate`,void 0),T(this,`backBufferLength`,void 0),T(this,`maxBufferLength`,void 0),T(this,`maxBufferSize`,void 0),T(this,`maxMaxBufferLength`,void 0),T(this,`frontBufferThreshold`,void 0),T(this,`staleLoadThreshold`,void 0),T(this,`maxMaxBufferReset`,void 0),T(this,`enablePreloading`,void 0),T(this,`loadVideoTimeout`,void 0),T(this,`instreamCreativeFailureThreshold`,void 0),T(this,`outstreamCreativeFailureThreshold`,void 0);let ne=e.siteAds.videoPlayers;this.advancePlaylist=this._getAdvancePlaylistConfig(e),this.apiValue=[2,7],this.stickyOutstreamCloseButtonTimeout=N(t.result,4e3),this.contentSpecificPlaylists=ne&&ne.contentSpecificPlaylists,this.footerSelector=N(ne&&ne.footerSelector,``),this.jwPlaylistObj=this._getPlaylistPlayerVideos(e),this.jwRequestTimeout=N(c.result,15e3),this.logAdDuration=o.result,this.logAdLifeCycle=s.result,this.maxRedirect=8,this.mimeType=navigator.userAgent&&navigator.userAgent.search(/Chrom|firefox/i)===-1?[`video/mp4`,`application/javascript`]:[`video/mp4`,`application/javascript`,`video/webm`],this.mobileStickyPlayerOnPage=!1,this.outstreamPlacement=l.result||0,this.playbackmethod=a.playbackmethod,this.players=N(ne&&ne.players.map(e=>(e.mobileLocation=Pf.setMobileLocation(e.mobileLocation),e)),[]),this.position={id:1,name:`above`},this.relatedSettings=ne&&ne.contextual,this.removeVideoTitleWrapper=N(e.siteAds.adOptions.removeVideoTitleWrapper,!1),this.setStandardOutstreamBackupRenderer=d.result,this.stickyOutstreamSettings=this._getStickyOutstreamSettings(e),this.vastTimeoutISV=N(n.result,1e4),this.vastTimeoutOSV=N(r.result,5e3),this.videoProtocols=i.result,this.videoWasClosed=N(U.readInternalLocalStorage(`adthrive_video_closed`),!1),this.maxBitrate=f.result||-1,this.backBufferLength=!p.result||p.result===`off`?1/0:p.result;let re=il.isRolloutEnabled(`optimize-max-buffer-length`)?5:m.result;this.maxBufferLength=re||30;let ie=il.isRolloutEnabled(`optimize-max-buffer-size`)?5:h.result;this.maxBufferSize=ie||60,this.maxMaxBufferLength=g.result||600,this.frontBufferThreshold=!_.result||_.result===`off`?1/0:_.result,this.staleLoadThreshold=u.result||20,this.maxMaxBufferReset=v.result,this.enablePreloading=y.result,this.loadVideoTimeout=b.result||8e3,this.instreamCreativeFailureThreshold=ee.result||0,this.outstreamCreativeFailureThreshold=te.result||0}setupAdvanceRelatedExperiment(e){let t=x.resolve(dW),n=this.advancePlaylist.relatedPlayer,r=t.enabled,i=()=>r?t.result:e&&n.sticky?n.sticky.applyToFirst:n.applyToFirst,a=i=>{let a=n.sticky?n.sticky.enabled:n.enabled,o=n.static?n.static.enabled:n.enabled,s=typeof i==`object`,c=a&&e,l=!e||o,u=s&&(r&&t.result||!r&&(c||l));return u};n.shouldRun=this.jwPlaylistObj.playlist.then(a).catch(()=>!1),n.applyToFirst=i()}_getPlaylistPlayerVideos(e){var t,n,r;let i=e.siteAds,a=i.videoPlayers,o=(a&&a.players||[]).filter(e=>e.type===`stickyPlaylist`),s=e.siteAds.videoPlayers&&e.siteAds.videoPlayers.contentSpecificPlaylists,c=s&&Vf(s),l=c&&c.playlistId,u=l||o.length&&o[0].playlistId,d={playlistId:u,hasContentSpecificPlaylist:!!c,contentSpecificPlaylistshuffle:(t=c&&c.shuffle)==null?!1:t,defaultPlaylistShuffle:(n=(r=o[0])==null?void 0:r.shuffle)==null?!1:n,playlist:u?pg(Pf.addMaxResolutionQueryParam(`https://cdn.jwplayer.com/v2/playlists/${u}`)):Promise.reject().catch(()=>!1)};return d}_getAdvancePlaylistConfig(e){let t=e.siteAds.adOptions.advancePlaylistOptions||{},n=t.relatedPlayer||{};return{playlistPlayer:{enabled:N(t.playlistPlayer.enabled,!0)},relatedPlayer:{applyToFirst:N(n.applyToFirst,!0),enabled:N(n.enabled,!0),shouldRun:Promise.reject().catch(()=>!1),static:n.static,sticky:n.sticky}}}_getStickyOutstreamSettings(e){let t={blockedPageSelectors:``,mobile:{enabled:!1},desktop:{enabled:!1},allowForPageWithStickyPlayer:{enabled:!1},allowOnHomepage:!1,mobileHeaderSelector:``,mobileLocation:`bottom-right`,saveVideoCloseState:!1},{video:n,videoPlayers:r}=e.siteAds,i=r&&r.partners&&r.partners.stickyOutstream,a=n&&n.partners.stickyOutstream,o=i||a,s=N(o,t);return s}},fp=D([C(),A(`design:paramtypes`,[Object,typeof(Wf=tW!==void 0&&tW)==`function`?Wf:Object,typeof(Gf=sW!==void 0&&sW)==`function`?Gf:Object,typeof(Kf=cW!==void 0&&cW)==`function`?Kf:Object,typeof(qf=UU!==void 0&&UU)==`function`?qf:Object,typeof(Jf=VU!==void 0&&VU)==`function`?Jf:Object,typeof(Yf=TU!==void 0&&TU)==`function`?Yf:Object,typeof(Xf=EU!==void 0&&EU)==`function`?Xf:Object,typeof(Zf=CU!==void 0&&CU)==`function`?Zf:Object,typeof(Qf=RU!==void 0&&RU)==`function`?Qf:Object,typeof($f=YU!==void 0&&YU)==`function`?$f:Object,typeof(ep=eW!==void 0&&eW)==`function`?ep:Object,typeof(tp=DU!==void 0&&DU)==`function`?tp:Object,typeof(np=gU!==void 0&&gU)==`function`?np:Object,typeof(rp=OU!==void 0&&OU)==`function`?rp:Object,typeof(ip=kU!==void 0&&kU)==`function`?ip:Object,typeof(ap=AU!==void 0&&AU)==`function`?ap:Object,typeof(op=vU!==void 0&&vU)==`function`?op:Object,typeof(sp=jU!==void 0&&jU)==`function`?sp:Object,typeof(cp=gW!==void 0&&gW)==`function`?cp:Object,typeof(lp=Uf!==void 0&&Uf)==`function`?lp:Object,typeof(up=yU!==void 0&&yU)==`function`?up:Object,typeof(dp=LU!==void 0&&LU)==`function`?dp:Object]),kt(0,ot(`AdThrive`))],fp)})),pp,mp,hp,gp,_p,wre=o((()=>{_W(),Cre(),X(),w(),j(),E(),O(),_p=class{constructor(e,t,n,r){this._videoAdOptions=e,T(this,`advancePlaylist`,void 0),T(this,`apiValue`,[2,7]),T(this,`collapsePlayerId`,void 0),T(this,`collapseSettings`,void 0),T(this,`contentSpecificPlaylists`,void 0),T(this,`relatedPlayerAdded`,!1),T(this,`relatedSettings`,void 0),T(this,`desktopCollapseSettings`,void 0),T(this,`desktopRelatedCollapseSettings`,void 0),T(this,`footerSelector`,``),T(this,`gamDiscount`,.16),T(this,`hasJwPlayer`,!1),T(this,`hasStickyOutstream`,!1),T(this,`instreamAdUnits`,new Set([vW.Video_Collapse_Autoplay_SoundOff,vW.Video_Individual_Autoplay_SOff,vW.Video_Coll_SOff_Smartphone,vW.Video_In_Post_ClicktoPlay_SoundOn])),T(this,`jwPlaylistObj`,void 0),T(this,`jwRequestTimeout`,void 0),T(this,`jwpVersion`,null),T(this,`logAdDuration`,void 0),T(this,`logAdLifeCycle`,void 0),T(this,`maxDuration`,void 0),T(this,`maxRedirect`,void 0),T(this,`mimeType`,void 0),T(this,`minFloor`,.1753),T(this,`mobileCollapseSettings`,void 0),T(this,`mobileRelatedCollapseSettings`,void 0),T(this,`mobileLocation`,void 0),T(this,`mobileStickyPlayerOnPage`,!1),T(this,`collapsiblePlayerOnPage`,!1),T(this,`outstreamPlacement`,void 0),T(this,`position`,void 0),T(this,`playbackmethod`,void 0),T(this,`playerId`,void 0),T(this,`players`,void 0),T(this,`playlistId`,void 0),T(this,`playlistPlayerAdded`,!1),T(this,`plcmtUnits`,new Map([[vW.Video_Collapse_Autoplay_SoundOff,2],[vW.Video_Individual_Autoplay_SOff,2],[vW.Video_Coll_SOff_Smartphone,2],[vW.Video_In_Post_ClicktoPlay_SoundOn,1]])),T(this,`preventStickyOutstream`,!1),T(this,`removeVideoTitleWrapper`,!1),T(this,`setStandardOutstreamBackupRenderer`,void 0),T(this,`staleLoadThreshold`,void 0),T(this,`stickyOutstreamCloseButtonTimeout`,void 0),T(this,`setupAdvanceRelatedExperiment`,void 0),T(this,`stickyOutstreamSettings`,void 0),T(this,`vastTimeoutISV`,void 0),T(this,`vastTimeoutOSV`,void 0),T(this,`vidDiscount`,.1753),T(this,`videoProtocols`,void 0),T(this,`videoWasClosed`,void 0),T(this,`maxBitrate`,void 0),T(this,`backBufferLength`,void 0),T(this,`maxBufferLength`,void 0),T(this,`maxBufferSize`,void 0),T(this,`maxMaxBufferLength`,void 0),T(this,`frontBufferThreshold`,void 0),T(this,`maxMaxBufferReset`,void 0),T(this,`enablePreloading`,void 0),T(this,`loadVideoTimeout`,void 0),T(this,`instreamCreativeFailureThreshold`,void 0),T(this,`outstreamCreativeFailureThreshold`,void 0),T(this,`bidRate`,void 0),T(this,`_videoFlagSlot`,{});let i=this._videoAdOptions;this.position={id:1,name:`above`},this.maxRedirect=8,this.playbackmethod=i.playbackmethod,this.advancePlaylist=i.advancePlaylist,this.jwPlaylistObj=i.jwPlaylistObj,this.setupAdvanceRelatedExperiment=i.setupAdvanceRelatedExperiment,this.relatedSettings=i.relatedSettings,this.mimeType=i.mimeType,this.outstreamPlacement=i.outstreamPlacement,this.videoProtocols=i.videoProtocols,this.jwRequestTimeout=i.jwRequestTimeout,this.logAdDuration=i.logAdDuration,this.logAdLifeCycle=i.logAdLifeCycle,this.vastTimeoutISV=i.vastTimeoutISV,this.vastTimeoutOSV=i.vastTimeoutOSV,this.videoWasClosed=i.videoWasClosed,this.removeVideoTitleWrapper=n.enabled?n.result:i.removeVideoTitleWrapper,this.players=i.players,this.footerSelector=i.footerSelector,this.stickyOutstreamSettings=i.stickyOutstreamSettings,this.maxDuration=r.result||30,this.contentSpecificPlaylists=i.contentSpecificPlaylists,this.jwpVersion=t.result&&t.result!==`none`?t.result:null,this.staleLoadThreshold=i.staleLoadThreshold,this.setStandardOutstreamBackupRenderer=i.setStandardOutstreamBackupRenderer,this.stickyOutstreamCloseButtonTimeout=i.stickyOutstreamCloseButtonTimeout,this.maxBitrate=i.maxBitrate,this.backBufferLength=i.backBufferLength,this.maxBufferLength=i.maxBufferLength,this.maxBufferSize=i.maxBufferSize,this.maxMaxBufferLength=i.maxMaxBufferLength,this.frontBufferThreshold=i.frontBufferThreshold,this.maxMaxBufferReset=i.maxMaxBufferReset,this.enablePreloading=i.enablePreloading,this.loadVideoTimeout=i.loadVideoTimeout,this.instreamCreativeFailureThreshold=i.instreamCreativeFailureThreshold,this.outstreamCreativeFailureThreshold=i.outstreamCreativeFailureThreshold}get videoFlagSlot(){return this._videoFlagSlot}setVideoFlagSlot(e,t={}){e&&(this._videoFlagSlot[e]={...this._videoFlagSlot[e],...t})}clearVideoFlagSlot(e){if(e)return delete this._videoFlagSlot[e],!0}},_p=D([C(),A(`design:paramtypes`,[typeof(pp=fp!==void 0&&fp)==`function`?pp:Object,typeof(mp=wU!==void 0&&wU)==`function`?mp:Object,typeof(hp=QU!==void 0&&QU)==`function`?hp:Object,typeof(gp=hW!==void 0&&hW)==`function`?gp:Object])],_p)})),Tre=o((()=>{wre()})),vp,Ere=o((()=>{w(),fa(),O(),vp=class extends da{init(){this._setAbGroup=!1,this._key=`VideoOpenBidderExperiment`,this._lookup=`VOBA`,this._default=[`none`]}},vp=D([C()],vp)})),yp,bp,Dre=o((()=>{w(),Ere(),j(),E(),O(),bp=class{constructor(e){T(this,`bidders`,void 0),this.bidders=e.result||[`none`]}},bp=D([C(),A(`design:paramtypes`,[typeof(yp=vp!==void 0&&vp)==`function`?yp:Object])],bp)})),Ore=o((()=>{Dre()})),xp,kre=o((()=>{w(),mU(),O(),xp=class extends pU{init(){this._key=`TrackScrollExperiment2`,this._lookup=`TCKSCROLL2`}get result(){return this._result}},xp=D([C()],xp)}));function Sp(e,t,n){var r=!0,i=!0;if(typeof e!=`function`)throw TypeError(Cp);return Co(n)&&(r=`leading`in n?!!n.leading:r,i=`trailing`in n?!!n.trailing:i),ts(e,t,{leading:r,maxWait:t,trailing:i})}var Cp,wp=o((()=>{ss(),wo(),Cp=`Expected a function`})),Tp,Ep,Are=o((()=>{w(),kre(),wp(),j(),E(),O(),Ep=class{constructor(e){this.trackScrollExperiment=e,T(this,`trackScrollEnabled`,void 0),T(this,`_timesForTracking`,void 0),T(this,`_currentTimesForTracking`,[]),T(this,`_lastScrollTimestamp`,void 0);let t=this.trackScrollExperiment.result;t===`off`?this.trackScrollEnabled=!1:(this.trackScrollEnabled=!0,this._timesForTracking=this._parseResult(t),this._setupScrollListener())}getTargetingValue(){if(this._timesForTracking&&this._shouldUpdateTargeting()&&this._currentTimesForTracking.length>0)return this._currentTimesForTracking.map(e=>`engage${e}`)}_parseResult(e){return Array.isArray(e)&&e.length>0&&e.every(e=>typeof e==`number`)?e:[]}_setupScrollListener(){let e=Sp(()=>{this._lastScrollTimestamp=Date.now()},500);window.addEventListener(`scroll`,e,{passive:!0})}_shouldUpdateTargeting(){if(this._lastScrollTimestamp&&this._timesForTracking){let e=(Date.now()-this._lastScrollTimestamp)/1e3;if(this._currentTimesForTracking=this._timesForTracking.filter(t=>t>e),this._currentTimesForTracking.length>0)return!0}return!1}},Ep=D([C(),A(`design:paramtypes`,[typeof(Tp=xp!==void 0&&xp)==`function`?Tp:Object])],Ep)})),jre=o((()=>{Are()})),Dp,Mre=o((()=>{Z(),w(),j(),E(),At(),O(),Dp=class{constructor(e){T(this,`_os`,void 0),T(this,`_browser`,void 0),T(this,`_device`,void 0),T(this,`_deviceByBreakpoint`,void 0);let{tablet:t,desktop:n}=e.siteAds.breakpoints;this._os=kG(),this._browser=cn(),this._device=aG(),this._deviceByBreakpoint=Cn(t,n)}get os(){return this._os}get browser(){return this._browser}get device(){return this._device}get deviceByBreakpoint(){return this._deviceByBreakpoint}},Dp=D([C(),A(`design:paramtypes`,[Object]),kt(0,ot(`AdThrive`))],Dp)})),Op=o((()=>{Mre()})),kp=o((()=>{Vu()})),Ap,jp,Nre=o((()=>{w(),mU(),O(),Ap={ABGR_UNSPECIFIED:0,ABGR_LEGACY:1,ABGR_ALL:2,ABGR_OTHERS_ONLY:3,ABGR_NONE:4,ABGR_IIQ_ONLY:5},jp=class extends pU{init(){this._key=`AudienceTargeting`,this._lookup=`AUDT`}},jp=D([C()],jp)})),Mp,Np,Pre=o((()=>{w(),Nre(),j(),E(),O(),Np=class{constructor(e){var t;this._audienceTargetingExperiment=e,T(this,`liveIntentEnabled`,void 0),T(this,`intentIqEnabled`,void 0),T(this,`id5Enabled`,void 0),T(this,`ayEnrichmentGroup`,void 0),T(this,`ayEnrichmentEnabled`,void 0),T(this,`ayEnrichWithLiveIntent`,void 0),T(this,`ayEnrichWithoutLiveIntent`,void 0);let n=(t=this._audienceTargetingExperiment.result)==null?`none`:t;this.liveIntentEnabled=this._getLiveIntentEnabled(n),this.intentIqEnabled=this._getIntentIqEnabled(n),this.id5Enabled=this._getId5Enabled(n),this.ayEnrichmentGroup=this._getAyEnrichmentGroup(this.liveIntentEnabled,this.intentIqEnabled),this.ayEnrichmentEnabled=this._getAyEnrichmentEnabled(n),this.ayEnrichWithLiveIntent=this._getAyEnrichWithLiveIntent(n),this.ayEnrichWithoutLiveIntent=this._getAyEnrichWithoutLiveIntent(n)}_getLiveIntentEnabled(e){let t=[`all`,`li_only`,`li_iiq`,`li_id5`];return t.includes(e)}_getIntentIqEnabled(e){let t=[`all`,`iiq_only`,`li_iiq`,`iiq_id5`];return t.includes(e)}_getId5Enabled(e){let t=[`all`,`id5_only`,`li_id5`,`iiq_id5`];return t.includes(e)}_getAyEnrichmentGroup(e,t){return e&&t?Ap.ABGR_ALL:e&&!t?Ap.ABGR_OTHERS_ONLY:!e&&t?Ap.ABGR_IIQ_ONLY:Ap.ABGR_NONE}_getAyEnrichmentEnabled(e){let t=[`all`,`li_iiq`,`iiq_id5`,`iiq_only`];return t.includes(e)}_getAyEnrichWithLiveIntent(e){let t=[`iiq_id5`,`id5_only`,`iiq_only`,`none`];if(t.includes(e))return null;let n=[`all`,`li_iiq`];return n.includes(e)}_getAyEnrichWithoutLiveIntent(e){let t=[`all`,`li_iiq`,`li_id5`,`li_only`];if(t.includes(e))return null;let n=[`iiq_id5`,`iiq_only`];return n.includes(e)}},Np=D([C(),A(`design:paramtypes`,[typeof(Mp=jp!==void 0&&jp)==`function`?Mp:Object])],Np)})),Pp=o((()=>{Pre()})),Fp,Ip,Lp,Rp,zp,Bp,Vp,Hp,Up,Wp,Gp,Kp,qp,Jp,Yp,Xp,Zp,Qp,$p,em,tm,nm,rm,im,am,om,sm,cm,lm,um,dm,fm,pm,mm,hm,gm,_m,vm,ym,bm,xm,Sm,Cm,wm,z,Tm=o((()=>{w(),ii(),ite(),li(),Ti(),uh(),cd(),Da(),vd(),xd(),Kne(),Jne(),Md(),zd(),Tu(),Vd(),Rc(),lo(),ya(),rre(),Ns(),are(),$d(),tf(),lre(),hh(),_a(),Zc(),du(),Ja(),dre(),mre(),Sf(),Ef(),Cs(),xre(),Tre(),Ore(),jre(),Op(),cl(),al(),Ml(),kp(),Pp(),j(),E(),O(),z=class{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v,y,b,ee,te,ne,re,ie,ae,oe,se,ce,le,ue,de,fe,pe,me,he,ge,_e,ve,ye,be,xe,Se){this.abGroup=e,this.act25=t,this.usCMP=n,this.adOptions=r,this.adTypes=i,this.amazon=a,this.ccpa=o,this.gpc=s,this.clsOptimizedAds=c,this.comscore=l,this.disableAds=u,this.displayOpenBidding=d,this.fledge=f,this.floors=p,this.footer=m,this.gam=h,this.gdpr=g,this.hbho=_,this.idho=v,this.audienceTargeting=y,this.infiniteScroll=b,this.lazyLoad=ee,this.liveRampAts=te,this.locale=ne,this.marmalade=re,this.optable=ie,this.partners=ae,this.pubAbGroup=oe,this.prebid=se,this.site=ce,this.targetDensity=le,this.timeouts=ue,this.timing=de,this.tkho=fe,this.user=pe,this.vbho=me,this.video=he,this.videoOpenBidding=ge,this._dynamicAdsMapper=_e,this.trackScroll=ve,this.userAgent=ye,this.prebidClientSide=be,this.trafficShaping=xe,this.creativeBlock=Se,T(this,`dynamicAds`,void 0),T(this,`enabledBidders`,this._getEnabledBidders()),this.dynamicAds=_e.get()}resetDynamicAds(){this.dynamicAds=this._dynamicAdsMapper.get()}get isStickyOutstreamTopCenterColorsDisabled(){return il.isRolloutEnabled(`disable-sticky-outstream-top-center-colors`)}_getEnabledBidders(){let e=[...this.partners.display.entries(),...this.partners.video.entries()].filter(([,e])=>e).map(([e])=>e),t=new Set([...e,...this.prebid.s2s.bidders]);return Array.from(t).sort((e,t)=>e.localeCompare(t))}},z=D([C(),A(`design:paramtypes`,[typeof(Fp=ti!==void 0&&ti)==`function`?Fp:Object,typeof(Ip=oi!==void 0&&oi)==`function`?Ip:Object,typeof(Lp=ci!==void 0&&ci)==`function`?Lp:Object,typeof(Rp=Ci!==void 0&&Ci)==`function`?Rp:Object,typeof(zp=lh!==void 0&&lh)==`function`?zp:Object,typeof(Bp=sd!==void 0&&sd)==`function`?Bp:Object,typeof(Vp=Ea!==void 0&&Ea)==`function`?Vp:Object,typeof(Hp=va!==void 0&&va)==`function`?Hp:Object,typeof(Up=_d!==void 0&&_d)==`function`?Up:Object,typeof(Wp=bd!==void 0&&bd)==`function`?Wp:Object,typeof(Gp=Cd!==void 0&&Cd)==`function`?Gp:Object,typeof(Kp=Ed!==void 0&&Ed)==`function`?Kp:Object,typeof(qp=Ld!==void 0&&Ld)==`function`?qp:Object,typeof(Jp=wu!==void 0&&wu)==`function`?Jp:Object,typeof(Yp=Bd!==void 0&&Bd)==`function`?Yp:Object,typeof(Xp=Lc!==void 0&&Lc)==`function`?Xp:Object,typeof(Zp=co!==void 0&&co)==`function`?Zp:Object,typeof(Qp=Xd!==void 0&&Xd)==`function`?Qp:Object,typeof($p=Ms!==void 0&&Ms)==`function`?$p:Object,typeof(em=Np!==void 0&&Np)==`function`?em:Object,typeof(tm=Zd!==void 0&&Zd)==`function`?tm:Object,typeof(nm=Qd!==void 0&&Qd)==`function`?nm:Object,typeof(rm=ef!==void 0&&ef)==`function`?rm:Object,typeof(im=nf!==void 0&&nf)==`function`?im:Object,typeof(am=mh!==void 0&&mh)==`function`?am:Object,typeof(om=ga!==void 0&&ga)==`function`?om:Object,typeof(sm=Xc!==void 0&&Xc)==`function`?sm:Object,typeof(cm=ri!==void 0&&ri)==`function`?cm:Object,typeof(lm=cu!==void 0&&cu)==`function`?lm:Object,typeof(um=qa!==void 0&&qa)==`function`?um:Object,typeof(dm=cf!==void 0&&cf)==`function`?dm:Object,typeof(fm=pf!==void 0&&pf)==`function`?fm:Object,typeof(pm=xf!==void 0&&xf)==`function`?pm:Object,typeof(mm=Tf!==void 0&&Tf)==`function`?mm:Object,typeof(hm=Ss!==void 0&&Ss)==`function`?hm:Object,typeof(gm=Nf!==void 0&&Nf)==`function`?gm:Object,typeof(_m=_p!==void 0&&_p)==`function`?_m:Object,typeof(vm=bp!==void 0&&bp)==`function`?vm:Object,typeof(ym=jd!==void 0&&jd)==`function`?ym:Object,typeof(bm=Ep!==void 0&&Ep)==`function`?bm:Object,typeof(xm=Dp!==void 0&&Dp)==`function`?xm:Object,typeof(Sm=sl!==void 0&&sl)==`function`?Sm:Object,typeof(Cm=jl!==void 0&&jl)==`function`?Cm:Object,typeof(wm=Bu!==void 0&&Bu)==`function`?wm:Object])],z)})),B=o((()=>{Tm(),vd(),Ti(),uh(),cd(),xd(),Md(),Vd(),Rc(),hh(),Zc(),du(),Ja()})),V,H=o((()=>{V=class{get enabled(){return!0}}})),Em,Dm,Om,km=o((()=>{Em=e=>{if(typeof e!=`string`&&typeof e!=`number`||typeof e==`string`&&isNaN(parseInt(e,10))||typeof e==`number`&&isNaN(e))return`E`;let t=Date.now(),n=typeof e==`string`?parseInt(e,10):e,r=Math.floor((t-n)/864e5);return r<=1?`1`:r<=2?`2`:r<=3?`3`:r<=4?`4`:r<=14?`14`:`15`},Dm=e=>{if(e){if(e.includes(`.`))return`i4:${e}`;if(e.includes(`:`))return`i6:${e}`}},Om=(e,t)=>{let n=null,r=null,i=0;for(let a of Object.keys(e.sources)){let o=e.sources[a].clusters;for(let e of o){let o=e.ids.find(e=>e.startsWith(t));if(!o)continue;let s=e.traits.lastSeen;typeof s==`number`&&s>i&&(i=s,n=o.replace(t,``),r=a)}}return{hem:n,source:r}}})),Am,jm,Mm,Nm,Fre=o((()=>{B(),H(),Rt(),w(),$(),Rm(),ua(),La(),km(),ao(),Z(),j(),E(),O(),Nm=class extends V{constructor(e,t,n){super(),this._config=e,this._context=t,this._optableSdkWrapper=n,T(this,`_cloudflareWorkerUrl`,``),T(this,`_isFirstPageview`,!1),T(this,`_siteHasCloudflareWorker`,!1);let r=this._config.site.id,i=window.location.origin;this._cloudflareWorkerUrl=i.replace(`https://`,`https://${r}.`).replace(`www.`,``),this._isFirstPageview=this._context.isFirstPageview,this._siteHasCloudflareWorker=this._config.site.deployedCloudflareVersion!==null}get enabled(){let e=Hh().get(`rptbt24`),t=this._context.invalidTraffic&&e!==`true`,n=this._context.country===`US`||this._context.country===`CA`&&this._context.region!==`QC`||e===`true`;return this._siteHasCloudflareWorker&&!t&&n}async start(){try{let e=U.readExternalCookie(`_rcid`);(!e&&this._isFirstPageview||e&&await this._shouldRefreshCookie(e))&&await this._requestRcid(),await this._logCookie()}catch(e){M.error(`RaptiveConnectedIdComponent`,`start`,`Error starting Raptive Connected ID component`,e)}}async _shouldRefreshCookie(e){let t=e;if(typeof t==`string`){t=await Qa(t,this._config.site.id);let e=new Date(t.metadata.capturedOn).getTime(),n=new Date().getTime(),r=Math.floor((n-e)/(1e3*60*60*24));return r>340}return!0}async _logCookie(){let e=U.readExternalCookie(`_rcid`);if(!e)return;typeof e==`string`&&(e=await Qa(e,this._config.site.id)),M.event(`RaptiveConnectedIdComponent`,`_logCookie`,`Raptive Connected ID`,e);let t=await this._optableSdkWrapper.cid(e.value.sharedId,3);await this._optableSdkWrapper.identify(t);let n=Dm(e.metadata.clientIp);n&&await this._optableSdkWrapper.identify(n)}async _requestRcid(){M.event(`RaptiveConnectedIdComponent`,`_requestRcid`,`Requesting Raptive Connected ID`);try{let e=await fetch(this._cloudflareWorkerUrl,{credentials:`include`});e.ok||(e.status===404?M.error(`RaptiveConnectedIdComponent`,`_requestRcid`,`Handler not found at ${this._cloudflareWorkerUrl}`):M.error(`RaptiveConnectedIdComponent`,`_requestRcid`,`Error fetching Raptive Connected ID`))}catch(e){M.error(`RaptiveConnectedIdComponent`,`_requestRcid`,`Error fetching Raptive Connected ID`,e)}}},Nm=D([Q(`RaptiveConnectedIdComponent`),C(),A(`design:paramtypes`,[typeof(Am=z!==void 0&&z)==`function`?Am:Object,typeof(jm=L!==void 0&&L)==`function`?jm:Object,typeof(Mm=la!==void 0&&la)==`function`?Mm:Object])],Nm)})),Pm,Fm=o((()=>{w(),$(),Rm(),tU(),j(),E(),O(),Pm=class{constructor(){T(this,`_videoEventBus`,x.resolve(eU)),T(this,`_settings`,{language:``,fontColor:`white`,fontOpacity:`100%`,fontSize:`100%`,fontFamily:`Arial`,textShadow:`none`,backgroundColor:`black`,backgroundOpacity:`50%`,windowColor:`black`,windowOpacity:`0%`}),T(this,`STORAGE_KEY`,`adthrive_video_settings`),this._loadSettings()}get settings(){return this._settings}updateSetting(e,t){this._settings[e]=t,this._saveSettings(),this._videoEventBus.settingsUpdated.emit({key:e,value:t})}_saveSettings(){try{U.setInternalLocalStorage(this.STORAGE_KEY,this._settings)}catch(e){console.error(`Failed to save settings:`,e)}}_loadSettings(){try{let e=U.readInternalLocalStorage(this.STORAGE_KEY);e&&typeof e==`object`&&(this._settings={...this._settings,...e})}catch(e){console.error(`Failed to load settings:`,e)}}},Pm=D([Q(`VideoSettingsManager`),C(),A(`design:paramtypes`,[])],Pm)})),Im,Lm,U,Rm=o((()=>{St(),E(),Im=[`mcmpfreqrec`],Lm=class extends xt{constructor(...e){super(...e),T(this,`name`,`BrowserStorage`),T(this,`disable`,!1),T(this,`gdprPurposes`,[1]),T(this,`_sessionStorageHandlerQueue`,[]),T(this,`_localStorageHandlerQueue`,[]),T(this,`_cookieHandlerQueue`,[]),T(this,`_gdpr`,void 0),T(this,`_shouldQueue`,!1)}init(e){this._gdpr=e.gdpr===`true`,this._shouldQueue=this._gdpr}clearQueue(e){e&&(this._shouldQueue=!1,this._sessionStorageHandlerQueue.forEach(e=>{this.setSessionStorage(e.key,e.value)}),this._localStorageHandlerQueue.forEach(e=>{if(e.key===`adthrive_abgroup`){let t=Object.keys(e.value)[0],n=e.value[t],r=e.value[`${t}_weight`];this.getOrSetABGroupLocalStorageValue(t,n,r,{value:24,unit:`hours`})}else e.expiry?e.type===`internal`?this.setExpirableInternalLocalStorage(e.key,e.value,{expiry:e.expiry,resetOnRead:e.resetOnRead}):this.setExpirableExternalLocalStorage(e.key,e.value,{expiry:e.expiry,resetOnRead:e.resetOnRead}):e.type===`internal`?this.setInternalLocalStorage(e.key,e.value):this.setExternalLocalStorage(e.key,e.value)}),this._cookieHandlerQueue.forEach(e=>{e.type===`internal`?this.setInternalCookie(e.key,e.value):this.setExternalCookie(e.key,e.value)})),this._sessionStorageHandlerQueue=[],this._localStorageHandlerQueue=[],this._cookieHandlerQueue=[]}readInternalCookie(e){return this._verifyInternalKey(e),this._readCookie(e)}readExternalCookie(e){return this._readCookie(e)}readExternalCookieList(e){return this._readCookieList(e)}getAllCookies(){return this._getCookies()}readInternalLocalStorage(e){return this._verifyInternalKey(e),this._readFromLocalStorage(e)}readExternalLocalStorage(e){return this._readFromLocalStorage(e)}readSessionStorage(e){let t=window.sessionStorage.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch(e){return t}}deleteCookie(e){document.cookie=`${e}=; SameSite=None; Secure; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/`}deleteLocalStorage(e){window.localStorage.removeItem(e)}deleteSessionStorage(e){window.sessionStorage.removeItem(e)}setInternalCookie(e,t,n){this._verifyInternalKey(e),this._setCookieValue(`internal`,e,t,n)}setExternalCookie(e,t,n){this._setCookieValue(`external`,e,t,n)}setInternalLocalStorage(e,t){if(this._verifyInternalKey(e),this._gdpr&&this._shouldQueue){let n={key:e,value:t,type:`internal`};this._localStorageHandlerQueue.push(n)}else{let n=typeof t==`string`?t:JSON.stringify(t);window.localStorage.setItem(e,n)}}setExternalLocalStorage(e,t){if(this._gdpr&&this._shouldQueue){let n={key:e,value:t,type:`external`};this._localStorageHandlerQueue.push(n)}else{let n=typeof t==`string`?t:JSON.stringify(t);window.localStorage.setItem(e,n)}}setExpirableInternalLocalStorage(e,t,n){this._verifyInternalKey(e);try{var r,i;let a=(r=n==null?void 0:n.expiry)==null?{value:400,unit:`days`}:r,o=(i=n==null?void 0:n.resetOnRead)==null?!1:i;if(this._gdpr&&this._shouldQueue){let n={key:e,value:t,type:`internal`,expires:this._getExpiryDate(a),expiry:a,resetOnRead:o};this._localStorageHandlerQueue.push(n)}else{let n={value:t,type:`internal`,expires:this._getExpiryDate(a),expiry:a,resetOnRead:o};window.localStorage.setItem(e,JSON.stringify(n))}}catch(e){console.error(e)}}setExpirableExternalLocalStorage(e,t,n){try{var r,i;let a=(r=n==null?void 0:n.expiry)==null?{value:400,unit:`days`}:r,o=(i=n==null?void 0:n.resetOnRead)==null?!1:i;if(this._gdpr&&this._shouldQueue){let n={key:e,value:JSON.stringify(t),type:`external`,expires:this._getExpiryDate(a),expiry:a,resetOnRead:o};this._localStorageHandlerQueue.push(n)}else{let n={value:t,type:`external`,expires:this._getExpiryDate(a),expiry:a,resetOnRead:o};window.localStorage.setItem(e,JSON.stringify(n))}}catch(e){console.error(e)}}setSessionStorage(e,t){if(this._gdpr&&this._shouldQueue){let n={key:e,value:t};this._sessionStorageHandlerQueue.push(n)}else{let n=typeof t==`string`?t:JSON.stringify(t);window.sessionStorage.setItem(e,n)}}getOrSetABGroupLocalStorageValue(e,t,n,r,i=!0){let a=`adthrive_abgroup`,o=this.readInternalLocalStorage(a);if(o!==null){var s;let t=o[e],n=(s=o[`${e}_weight`])==null?null:s;if(this._isValidABGroupLocalStorageValue(t))return[t,n]}let c={...o,[e]:t,[`${e}_weight`]:n};return r?this.setExpirableInternalLocalStorage(a,c,{expiry:r,resetOnRead:i}):this.setInternalLocalStorage(a,c),[t,n]}_isValidABGroupLocalStorageValue(e){return e!=null&&!(typeof e==`number`&&isNaN(e))}_getExpiryDate({value:e,unit:t}){let n=new Date;return t===`milliseconds`?n.setTime(n.getTime()+e):t==`seconds`?n.setTime(n.getTime()+e*1e3):t===`minutes`?n.setTime(n.getTime()+e*60*1e3):t===`hours`?n.setTime(n.getTime()+e*60*60*1e3):t===`days`?n.setTime(n.getTime()+e*24*60*60*1e3):t===`months`&&n.setTime(n.getTime()+e*30*24*60*60*1e3),n.toUTCString()}_resetExpiry(e){return e.expires=this._getExpiryDate(e.expiry),e}_readCookie(e){let t=document.cookie.split(`; `).find(t=>t.split(`=`)[0]===e);if(!t)return null;let n=t.split(`=`)[1];if(n)try{return JSON.parse(decodeURIComponent(n))}catch(e){return decodeURIComponent(n)}return null}_readCookieList(e){let t;for(let n of document.cookie.split(`;`)){let[r,...i]=n.split(`=`);r.trim()===e&&(t=i.join(`=`).trim())}return t&&JSON.parse(t)||[]}_getCookies(){let e=[];return document.cookie.split(`;`).forEach(t=>{let[n,r]=t.split(`=`).map(e=>e.trim());e.push({name:n,value:r})}),e}_readFromLocalStorage(e){let t=window.localStorage.getItem(e);if(!t)return null;try{let r=JSON.parse(t),i=r.expires&&new Date().getTime()>=new Date(r.expires).getTime();if(e===`adthrive_abgroup`&&r.created)return window.localStorage.removeItem(e),null;if(r.resetOnRead&&r.expires&&!i){var n;let t=this._resetExpiry(r);return window.localStorage.setItem(e,JSON.stringify(r)),(n=t.value)==null?t:n}else if(i)return window.localStorage.removeItem(e),null;if(r.hasOwnProperty(`value`))try{let e=JSON.parse(r.value);return e}catch(e){return r.value}else return r}catch(e){return t}}_setCookieValue(e,t,n,r){try{if(this._gdpr&&this._shouldQueue){let r={key:t,value:n,type:e};this._cookieHandlerQueue.push(r)}else{var i,a,o;let e=this._getExpiryDate((i=r==null?void 0:r.expiry)==null?{value:400,unit:`days`}:i),s=(a=r==null?void 0:r.sameSite)==null?`None`:a,c=(o=r==null?void 0:r.secure)==null?!0:o,l=typeof n==`object`?JSON.stringify(n):n;document.cookie=`${t}=${l}; SameSite=${s}; ${c?`Secure;`:``} expires=${e}; path=/`}}catch(e){}}_verifyInternalKey(e){let t=e.startsWith(`adthrive_`),n=e.startsWith(`adt_`);if(!t&&!n&&!Im.includes(e))throw Error(`When reading an internal cookie, the key must start with "adthrive_" or "adt_" or be part of the allowed legacy keys.`)}},U=new Lm})),zm,Bm,Vm,Hm,Um,Wm,Gm,Km=o((()=>{zm=e=>{let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return t>>>0},Bm=e=>zm(e).toString(16),Vm=e=>typeof e==`string`?/^[0-9a-f]{64}$/.test(e):!1,Hm=e=>typeof e==`string`?/^[0-9a-fA-F-]{36}$/.test(e):!1,Um=e=>typeof e==`string`?/^[0-9a-f]{32}$/.test(e):!1,Wm=e=>{if(typeof e!=`string`)return!1;let t=/^[A-Za-z0-9\-_]+$/;return!!(e&&t.test(e))},Gm=(e,t=2**53-1)=>n=>typeof n==`string`?n.length>=e&&n.length<=t:!1})),qm,Jm,Ym,Xm=o((()=>{Km(),qm=e=>{if(e===null)return null;let t=e.map(({choice:e})=>e);return Bm(JSON.stringify(t))},Jm=(e,t)=>{var n,r;return(n=(r=e.find(({choice:e})=>e===t))==null?void 0:r.weight)==null?null:n},Ym=e=>e!=null&&!(typeof e==`number`&&isNaN(e))})),Zm,Qm,$m=o((()=>{Zm={"Europe/Brussels":`gdpr`,"Europe/Sofia":`gdpr`,"Europe/Prague":`gdpr`,"Europe/Copenhagen":`gdpr`,"Europe/Berlin":`gdpr`,"Europe/Tallinn":`gdpr`,"Europe/Dublin":`gdpr`,"Europe/Athens":`gdpr`,"Europe/Madrid":`gdpr`,"Africa/Ceuta":`gdpr`,"Europe/Paris":`gdpr`,"Europe/Zagreb":`gdpr`,"Europe/Rome":`gdpr`,"Asia/Nicosia":`gdpr`,"Europe/Nicosia":`gdpr`,"Europe/Riga":`gdpr`,"Europe/Vilnius":`gdpr`,"Europe/Luxembourg":`gdpr`,"Europe/Budapest":`gdpr`,"Europe/Malta":`gdpr`,"Europe/Amsterdam":`gdpr`,"Europe/Vienna":`gdpr`,"Europe/Warsaw":`gdpr`,"Europe/Lisbon":`gdpr`,"Atlantic/Madeira":`gdpr`,"Europe/Bucharest":`gdpr`,"Europe/Ljubljana":`gdpr`,"Europe/Bratislava":`gdpr`,"Europe/Helsinki":`gdpr`,"Europe/Stockholm":`gdpr`,"Europe/London":`gdpr`,"Europe/Vaduz":`gdpr`,"Atlantic/Reykjavik":`gdpr`,"Europe/Oslo":`gdpr`,"Europe/Istanbul":`gdpr`,"Europe/Zurich":`gdpr`},Qm=()=>{let e=Intl.DateTimeFormat().resolvedOptions().timeZone,t=Zm[e];return t==null?null:t}})),eh,th=o((()=>{Rm(),Xm(),$m(),X(),eh=()=>(e,t,n)=>{let r=n.value;r&&(n.value=function(...e){let t=qm(this._choices),n=this._expConfigABGroup?this._expConfigABGroup:this.abgroup,i=n?n.toLowerCase():this.key?this.key.toLowerCase():``,a=t?`${i}_${t}`:i,o=this.localStoragePrefix?`${this.localStoragePrefix}-${a}`:a,s=[Xn.AdLayout,Xn.AdDensity].includes(i)&&Qm()===`gdpr`;if(s){let t=r.apply(this,e);return t}let c=U.readInternalLocalStorage(`adthrive_branch`);(c&&c.enabled)===!1&&U.deleteLocalStorage(o);let l=()=>r.apply(this,e),u=l(),d=Jm(this._choices,u),[f,p]=U.getOrSetABGroupLocalStorageValue(o,u,d,{value:24,unit:`hours`});return this._stickyResult=f,this._stickyWeight=p,f})}})),nh,Ire=o((()=>{mU(),th(),w(),j(),O(),nh=class extends pU{init(){this._key=`AdTypeDays`,this._lookup=`ATD2`,this._autorun=!1}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],nh.prototype,`run`,null),nh=D([C()],nh)})),rh,Lre=o((()=>{mU(),th(),w(),j(),O(),rh=class extends pU{init(){this._key=`AdTypeDaysHoldout`,this._lookup=`ATDH`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],rh.prototype,`run`,null),rh=D([C()],rh)})),ih,ah,Rre=o((()=>{IK(),ei(),w(),Ire(),Lre(),j(),O(),ah=class{constructor(e){this._adTypeDaysExperiment=e}get overrideValues(){let e=this._adTypeDaysExperiment.result;if(!e)return null;let[t,n]=e.split(`,`),r=parseInt(t,10),i=parseInt(n,10),a=$r(Zr());if(a>=r&&a<=i){let e=x.resolve(rh).result;return e?e[0]===`control`?null:e:null}return null}},ah=D([Q(`AdTypePerformanceMonitoring`),C(),A(`design:paramtypes`,[typeof(ih=nh!==void 0&&nh)==`function`?ih:Object])],ah)})),oh,zre=o((()=>{w(),fa(),O(),oh=class extends da{init(){this._key=`AdTypeHoldout`,this._lookup=`ATHMB`,this._default=[`none`]}},oh=D([C()],oh)})),sh,ch,lh,Bre=o((()=>{w(),Z(),Rre(),zre(),j(),E(),At(),O(),lh=class{constructor(e,t,n){var r,i;this._adTypeHoldoutExperiment=t,T(this,`animatedFooter`,void 0),T(this,`expandableFooter`,void 0),T(this,`inRecipeRecommendationDesktop`,void 0),T(this,`inRecipeRecommendationMobile`,void 0),T(this,`inRecipeRecommendationSelectors`,void 0),T(this,`interscroller`,void 0),T(this,`largeFormatsDesktop`,void 0),T(this,`largeFormatsMobile`,void 0),T(this,`miniscroller`,void 0),T(this,`nativeDesktopContent`,void 0),T(this,`nativeDesktopRecipe`,void 0),T(this,`nativeDesktopSidebar`,void 0),T(this,`nativeMobileContent`,void 0),T(this,`nativeMobileRecipe`,void 0),T(this,`nativeDesktopHeader`,void 0),T(this,`nativeDesktopBelowPost`,void 0),T(this,`nativeMobileHeader`,void 0),T(this,`nativeMobileBelowPost`,void 0),T(this,`outstreamDesktop`,void 0),T(this,`outstreamMobile`,void 0),T(this,`sponsorTileDesktop`,void 0),T(this,`sponsorTileMobile`,void 0),T(this,`expandableCatalogAdsDesktop`,void 0),T(this,`expandableCatalogAdsMobile`,void 0),T(this,`skylineHeader`,void 0);let a=e.siteAds.adTypes||{};this.animatedFooter=N(a.animatedFooter,!0),this.expandableFooter=N(a.expandableFooter,!0),this.inRecipeRecommendationDesktop=N(a.inRecipeRecommendationDesktop,!0),this.inRecipeRecommendationMobile=N(a.inRecipeRecommendationMobile,!0),this.inRecipeRecommendationSelectors=a.inRecipeRecommendationSelectors,this.interscroller=tG()?N(a.interscroller,!0):!1,this.largeFormatsDesktop=N(a.largeFormatsDesktop,!0),this.largeFormatsMobile=N(a.largeFormatsMobile,!0),this.miniscroller=tG()?N(a.miniscroller,!0):!1,this.nativeDesktopContent=N(a.nativeDesktopContent,!0),this.nativeDesktopRecipe=N(a.nativeDesktopRecipe,!0),this.nativeDesktopSidebar=N(a.nativeDesktopSidebar,!0),this.nativeDesktopHeader=N((r=a.nativeHeaderDesktop)==null?a.nativeDesktopHeader:r,!0),this.nativeDesktopBelowPost=N(a.nativeDesktopBelowPost,!0),this.nativeMobileContent=N(a.nativeMobileContent,!0),this.nativeMobileRecipe=N(a.nativeMobileRecipe,!0),this.nativeMobileHeader=N((i=a.nativeHeaderMobile)==null?a.nativeMobileHeader:i,!0),this.nativeMobileBelowPost=N(a.nativeMobileBelowPost,!0),this.outstreamDesktop=N(a.outstreamDesktop,!0),this.outstreamMobile=N(a.outstreamMobile,!0),this.sponsorTileDesktop=N(a.sponsorTileDesktop,!1),this.sponsorTileMobile=N(a.sponsorTileMobile,!1),this.expandableCatalogAdsDesktop=N(a.expandableCatalogAdsDesktop,!1),this.expandableCatalogAdsMobile=N(a.expandableCatalogAdsMobile,!1),this.skylineHeader=N(a.skylineHeader,!1),this._overriveAdType(n)}has(e){return this[e]&&this[e]===!0}get enabled(){return Object.keys(this).filter(e=>this[e]===!0)}get enabledMinified(){let e={outstreamDesktop:{min:`od`,val:this.outstreamDesktop},outstreamMobile:{min:`om`,val:this.outstreamMobile}};return this.enabled.filter(t=>Object.keys(e).includes(t)&&e[t].val).map(t=>e[t].min)}get outstreamEnabled(){return tG()?this.outstreamMobile===!0:this.outstreamDesktop===!0}_overriveAdType(e){let t=e.overrideValues;if(t)t.forEach(e=>{this[e]=!1});else{let e=this._adTypeHoldoutExperiment.result;e&&e.length&&e.forEach(e=>{this[e]&&(this[e]=!1)})}}},lh=D([C(),A(`design:paramtypes`,[Object,typeof(sh=oh!==void 0&&oh)==`function`?sh:Object,typeof(ch=ah!==void 0&&ah)==`function`?ch:Object]),kt(0,ot(`AdThrive`))],lh)})),uh=o((()=>{Bre()})),dh,fh,ph,mh,Vre=o((()=>{rU(),bt(),w(),ete(),Z(),tte(),uh(),j(),E(),O(),mh=class{constructor(e,t,n){this._eventBus=e,this._adTypes=t,this._bootstrapEventBus=n,T(this,`_marmaladeEventPromise`,void 0),T(this,`loaded`,!1),T(this,`campaigns`,[]),T(this,`filteredRoadblockSiteCodes`,[]),T(this,`filteredSiteCodes`,[]),T(this,`siteCodes`,[]),T(this,`adViewability`,[]),T(this,`dcsllSiteSpecific`,void 0),T(this,`speed`,navigator.connection&&navigator.connection.effectiveType===`4g`?`1`:`0`),T(this,`adUnits`,Gr),T(this,`selectorMatches`,[]),T(this,`ortbSegments`,new Map),T(this,`rfMcmpCodes`,[]),T(this,`rfIabCodes`,[]),T(this,`rfDataProcessed`,new k),T(this,`hvThreshold`,.6),T(this,`mcmp`,[]),T(this,`mcmpTargeting`,[]),T(this,`flpProdIds`,[]),T(this,`_targetCampaignSites`,new Set([`divascancook.com`,`hungryhappens.net`,`whatsgabycooking.com`,`pinchofyum.com`,`isabeleats.com`])),T(this,`_bidderSiteCodeList`,qr),T(this,`_appnexusRoadblockSiteCodeList`,Jr),T(this,`_marmaladeOffEvent`,void 0),T(this,`_activeCampaign`,e=>{let t=Date.now();return t>=this._parseDate(e.start_date).getTime()&&t<=this._parseDate(e.expiration_date).getTime()}),this._marmaladeEventPromise=new Promise(e=>{this._marmaladeOffEvent=this._bootstrapEventBus.marmaladeLibraryLoadComplete.on(t=>{var n;e(t),(n=this._marmaladeOffEvent)==null||n.call(this)},{handleEventsAlreadyEmitted:!0})}),this._setupMarmalade()}updateMarmalade(e){this._setMarmaladeData(e)}get marmaladeEventPromise(){return this._marmaladeEventPromise}async _setupMarmalade(){let e=await this.marmaladeEventPromise;x.register(`RecencyFrequencyMarmaladeResponse`,{useValue:e.result}),e&&Object.keys(e).length>0?this._setMarmaladeData(e.result):this._eventBus.marmaladeResponseLoaded.once(e=>{this._setMarmaladeData(e),this._eventBus.resetMarmaladeData.emit()})}getAllMcmps(){return[...this.mcmp.filter(e=>!e.startsWith(`SR_`)),...this.rfMcmpCodes.map(e=>e[0]),...this.rfIabCodes.map(e=>e[0])].filter(GW)}_setMarmaladeData(e){var t;this.loaded=!0;let{host:n,page:r,adViewability:i,dcsllSiteSpecific:a}=e;if(n&&n.length&&(this.siteCodes=(n[0].site_codes||[]).filter(GW),this.filteredSiteCodes=this.siteCodes.filter(e=>this._bidderSiteCodeList.includes(e)),this.filteredRoadblockSiteCodes=this.siteCodes.filter(e=>this._appnexusRoadblockSiteCodeList.includes(e))),r&&r.length){let e=r[0].campaigns||[];this.campaigns=e.filter(this._activeCampaign)}i&&i.length&&(this.adViewability=i),a&&(this.dcsllSiteSpecific=a);let o=(t=window.location.hostname)==null?void 0:t.replace(`www.`,``);this._targetCampaignSites.has(o)&&(this.adUnits.NR.lazy=!1),this._targetCampaignSites.has(o)&&document.body.classList.contains(`single-post`)&&!this.campaigns.some(e=>e.dfp_id===`NR_TNFLK23`)&&this.campaigns.push({casale_id:`NR_TNFLK23`,dfp_id:`NR_TNFLK23`,expiration_date:`2026-12-31`,ingredient_line:``,internal_id:`NR_TNFLK23`,lead_ingredient:``,start_date:`2023-08-15`});let s=this._getMcmpFlpIds();this.mcmp=s.mcmp||[],this.flpProdIds=s.flpProdIds||[],this.ortbSegments=this._getOrtbSegments(),this._eventBus.recencyFrequencyDataSet.on(this._handleRecencyFrequencyDataSet.bind(this),{handleEventsAlreadyEmitted:!0})}_getOrtbSegments(){return this.campaigns.reduce((e,t)=>{let n=new RegExp(/(^iab(a|c))_(\d*)/),[,r,,i]=n.exec(t.dfp_id)||[];if(i){let t=e.get(r)||[];t.push({id:i}),r&&t.length&&e.set(r,t)}return e},new Map)}_handleRecencyFrequencyDataSet(e){e.forEach(e=>{let t=e[0],n=e[1];if(t.substring(t.length-2)===`_A`)this.rfMcmpCodes.push([t,n]);else{let e=t.substring(t.indexOf(`_`)+1);this.ortbSegments.set(`iaba`,[{id:e}]),this.rfIabCodes.push([t,n])}}),this.rfDataProcessed.emit()}_isValidMarmaladeCampaign(e){let t=e.dfp_id.substring(0,2),n=this.adUnits[t];if(n){let e=n.find(Kr(n,this._adTypes).join(`,`));return e&&this.selectorMatches.push({adUnit:n,match:e}),!n.requireSelectorMatch||!!e}else return!0}_getMcmpFlpIds(){return this.campaigns.filter(e=>this._isValidMarmaladeCampaign(e)).reduce((e,t)=>(e.mcmp.push(t.dfp_id),t.flp_prod_id&&e.flpProdIds.push(...JSON.parse(t.flp_prod_id)),e),{mcmp:[],flpProdIds:[]})}_parseDate(e){let t=e.split(`-`);return new Date(Number(t[0]),Number(t[1])-1,Number(t[2]))}},mh=D([C(),A(`design:paramtypes`,[typeof(dh=Rr!==void 0&&Rr)==`function`?dh:Object,typeof(fh=lh!==void 0&&lh)==`function`?fh:Object,typeof(ph=mr!==void 0&&mr)==`function`?ph:Object])],mh)})),hh=o((()=>{Vre()})),gh,Hre=o((()=>{X(),$(),Rm(),Z(),uu(),bt(),E(),gh=class{constructor(e,t,n,r,i,a=!1,o=8,s,c=[],l=!0,u=!1,d=``){this.location=e,this.sequence=t,this.sizes=n,this.element=r,this.sticky=i,this.lazy=a,this.auctionPriority=o,this.stickyOverlapSelector=s,this.special=c,this.enabledForAuction=l,this.infinite=u,this.thirdPartyAdUnitName=d,T(this,`googleTagSlot`,void 0),T(this,`refreshPaused`,!1),T(this,`refreshTimeout`,void 0),T(this,`isRefreshing`,!1),T(this,`closed`,!1),T(this,`viewableSince`,void 0),T(this,`viewableDuration`,0),T(this,`slotFullyRenderedSince`,void 0),T(this,`slotFullyRenderedDuration`,0),T(this,`refreshInterval`,void 0),T(this,`outOfViewIO`,!0),T(this,`outOfViewGPT`,!0),T(this,`alwaysInView`,!1),T(this,`displayed`,!1),T(this,`refreshCount`,0),T(this,`viewability`,0),T(this,`highlyViewable`,!1),T(this,`hvp`,0),T(this,`servedPrebidBidResponse`,void 0),T(this,`noAdRefreshCount`,void 0),T(this,`bidPoolId`,void 0),T(this,`lazyDisabled`,!1),T(this,`transactionId`,``),T(this,`stickyOutstreamErrorCount`,void 0),T(this,`stickyOutstreamErrorLogged`,void 0),T(this,`stickyOutstreamRenderedTimestamp`,void 0),T(this,`stickyOutstreamShortVideo`,!1),T(this,`stickyOutstreamLastAdErrored`,!1),T(this,`stickyOutstreamRefreshTimeout`,5e3),T(this,`passiveBidPoolId`,void 0),T(this,`multiformat`,!1),T(this,`multiformatNative`,!1),T(this,`multiformatOutstream`,!1),T(this,`outstreamEnabled`,!1),T(this,`nativeEnabled`,!1),T(this,`googleTagSlotReadyEmitter`,new k),T(this,`googleTagSlotReady`,!1),T(this,`mainAuctionWidth`,void 0),T(this,`mainAuctionHeight`,void 0),T(this,`slotAppBids`,void 0),T(this,`rebuild`,!1),T(this,`impressionId`,NK()),T(this,`rbTotalBidsCompared`,new Set),T(this,`rbTotalBidsFiltered`,new Set),T(this,`rbWinningBidsFiltered`,new Set),T(this,`rbTotalBadCrids`,0),this.location===F.Video_StickyOutstream&&(this.stickyOutstreamErrorCount=0,this.noAdRefreshCount=0,this.stickyOutstreamErrorLogged=!1)}get id(){return this.element.id}get isSticky(){return this.sticky}get hasHighViewability(){return this.sticky||this.location===F.Recipe}refreshImpressionId(){let e=NK();this.impressionId=e}setHighlyViewable(e){let t=this.viewability>=Number(e&&e.hvThreshold);this.highlyViewable=this.lazy||t}setBidPoolId(e){let t=this.location.includes(F.Sidebar);t?this.generateSidebarBidPoolId(e):this.generateContentBidPoolId(e),this.setSlotTargetingFlag(`bpe`,[this.bidPoolId?`1`:`0`])}generateSidebarBidPoolId(e){let t=this.lazy,n=this.sequence,r=`${this.location}_${this.sequence}`;if(n&&!lu.includes(r)){let n=t?t?`_Lazy`:``:`_Nonlazy`;if(this.sizes.length<=2||!e.includes(this.location)||!n)return;this.bidPoolId=`${this.location}_BPID${n}`;return}}generateContentBidPoolId(e){let t=this.lazy,n=this.location.toLowerCase().includes(`content`),r=this.sequence,i=n&&r&&r>=4&&!t?`_Nonlazy`:n&&t?`_Lazy`:``;!e.includes(this.location)||n&&!i||(this.bidPoolId=`${this.location}_BPID${i}`)}setPassiveBidPoolId(){let e=this.lazy,t=this.location,n=`${t}_${this.sequence}`,r=t.includes(F.Content),i=t.includes(F.Sidebar)&&!lu.includes(n);!e&&(r||i)&&(this.passiveBidPoolId=`${t}_BPID_Lazy`)}isHighlyViewable(){return this.highlyViewable||this.lazy||this.refreshCount>0}get isAboveTheFold(){return NW(this.element).top>1e3}hasSize([e,t]){return this.sizes.some(([n,r])=>e===n&&t===r)}get name(){return[this.location,this.sequence].filter(bK).join(`_`)}get placementMapName(){return this.location===F.Content&&this.sequence&&this.sequence>9?F.Content_9:this.name.includes(F.Below_Post)?F.Below_Post:this.location===F.Sidebar&&this.sequence&&this.sequence>9?F.Sidebar_9:this.location===F.Recipe&&this.sequence&&this.sequence>5?F.Recipe_2:this.name}pushToQueue(e){let t=window.googletag;t&&t.cmd&&t.cmd.push(e)}setViewability(e){let t=e.adViewability.length&&e.adViewability[0].home!==void 0&&e.adViewability[0].depth!==void 0&&e.adViewability[0].lazy!==void 0,n=window.location.pathname===`/`?`1`:`0`,r=U.readInternalLocalStorage(`adthrive_session_fpv`),i=r===!0||r===null?`1`:`0`;e.adViewability.filter(r=>r.speed===e.speed&&window.innerWidth>=r.width[0]&&(!r.width[1]||window.innerWidth<=r.width[1])&&(!t||r.home===n&&r.depth===i&&this.lazy===r.lazy)).forEach(e=>{Object.keys(e.adUnits).forEach(t=>{t===this.name?this.viewability=e.adUnits[t]:this.location===F.Content&&this.sequence>9?this.viewability=e.adUnits[F.Content]:this.location===F.Below_Post&&this.sequence>1&&(this.viewability=e.adUnits[F.Below_Post])})})}clearTargeting(e){this.googleTagSlot?this.googleTagSlot.clearTargeting(e):M.error(`Slot`,`setTargeting`,`Attempted to clear targeting before slot was defined`,e)}setTargeting(e){this.googleTagSlotReady?this.applyTargeting(e):this.googleTagSlotReadyEmitter.once(()=>{this.applyTargeting(e)})}applyTargeting(e){this.pushToQueue(()=>{if(this.googleTagSlot){let t=Array.isArray(e)?e:[e];for(let e of t)this.googleTagSlot.setTargeting(e.key,e.value)}else M.error(`Slot`,`setTargeting`,`Attempted to set targeting before slot was defined`,e)})}setSlotTargetingFlag(e,t,n=!1){let r=()=>{if(this.googleTagSlot){let r=this.googleTagSlot.getTargeting(`flag_slot`)||[],i=r.filter(t=>{let[r]=t.split(`:`);return!n||r!==e});this.googleTagSlot.setTargeting(`flag_slot`,[...i,...t.map(t=>`${e}:${t}`)])}};t&&t.length>0&&this.pushToQueue(()=>r())}clearSlotTargetingFlag(e){let t=()=>{if(this.googleTagSlot){let t=this.googleTagSlot.getTargeting(`flag_slot`)||[],n=t.filter(t=>{let[n]=t.split(`:`);return!e.includes(n)});this.googleTagSlot.setTargeting(`flag_slot`,[...n])}};this.pushToQueue(()=>t())}getTargeting(e){return this.googleTagSlot?this.googleTagSlot.getTargeting(e):(M.error(`Slot`,`getTargeting`,`Attempted to get targeting before slot was defined`,e),[])}setTransactionId(e){this.transactionId=e}getTargetingMap(){if(this.googleTagSlot){let e=this.googleTagSlot;return e.getTargetingKeys().reduce((t,n)=>(t[n]=e.getTargeting(n),t),{})}else M.error(`Slot`,`getTargetingMap`,`Attempted to get targeting before slot was defined`);return{}}setSlotAppBids(e,t){let n=e.filter(e=>e.adUnitCode===t).map(e=>e.adId);n.length&&(this.slotAppBids=n)}getSlotAppBids(){return this.slotAppBids}addRequestTypeSlotFlag(){var e,t;if(!((e=this)==null||(e=e.getSlotAppBids())==null)&&e.length&&(t=this)!=null&&t.googleTagSlot){let e=this.getSlotAppBids(),t=this.googleTagSlot.getTargeting(`hb_adid`).some(t=>e==null?void 0:e.includes(t));t&&this.setSlotTargetingFlag(`reqtype`,[`app`],!0)}}getPositionFromViewport(){return oG(this.element)}updateTargetingForRaptiveBlocking(){this.googleTagSlot&&(this.setSlotTargetingFlag(`bc`,[this.rbTotalBidsCompared.size.toString()],!0),this.setSlotTargetingFlag(`fc`,[this.rbTotalBidsFiltered.size.toString()],!0),this.setSlotTargetingFlag(`wf`,[this.rbWinningBidsFiltered.size.toString()],!0),this.setSlotTargetingFlag(`bl`,[this.rbTotalBadCrids.toString()],!0))}}})),_h,Ure=o((()=>{w(),$(),X(),bt(),Rm(),E(),O(),_h=class{constructor(){T(this,`added`,new k),T(this,`bidServed`,new k),T(this,`_slots`,new Map)}add(e){let t=U.readSessionStorage(`adthrive_footer_closed`),n=this.castArray(e);t&&(n=n.filter(e=>e.location!==F.Footer));for(let e of n)if(!this._slots.has(e.id)){this._slots.set(e.id,e);try{this.added.emit(e)}catch(e){M.error(`Slots`,`add`,e)}}return n}remove(e){let t=this.castArray(e);for(let e of t)this._slots.has(e.id)&&(e.closed=!0,this._slots.delete(e.id))}get(e){return typeof e==`string`?this._slots.get(e):Array.isArray(e)?e.map(e=>this._slots.get(e)).filter(e=>e!==void 0):[...this._slots.values()]}castArray(e){if(typeof e==`string`){let t=this.get(e);return t===void 0?[]:[t]}return Array.isArray(e)?e:[e]}},_h=D([Q(`Slots`),C()],_h)})),vh=o((()=>{Hre(),Ure()})),yh,Wre=o((()=>{w(),$(),O(),yh=class{getBidWithBsidForSlot(e,t=[]){let n=t.filter(e=>e.meta&&e.meta.dchain),r=RegExp(`${e.location}_${e.sequence}(?!\d)`,`i`);for(let e=t.length-1;e>=0;e--){let{adUnitCode:i,meta:a}=t[e];if(r.test(i)&&this.getLastBsid(a))return n[e]}}getLastBsid(e={}){let{dchain:t}=e,n=t&&t.nodes||[];for(let e=n.length-1;e>=0;e--)if(n[e].bsid)return n[e].bsid}},yh=D([Q(`DemandChain`),S()],yh)})),bh,Gre=o((()=>{mU(),w(),O(),bh=class extends pU{init(){this._key=`ReduceRenderAboveViewport`,this._lookup=`RRAV2`}},bh=D([C()],bh)})),xh,Sh,Ch,wh,Th,Eh=o((()=>{Hr(),$(),vh(),w(),Gre(),$d(),j(),E(),O(),Th=class{constructor(e,t,n,r){this._slots=e,this._slotEventBus=t,T(this,`_adjustment`,void 0),T(this,`_marginToIntersectionObserverMap`,new Map),T(this,`_slotToIntersectionObserverMap`,new Map),T(this,`_initialMarginPercent`,void 0),n.result&&typeof n.result==`number`?this._adjustment=n.result:this._adjustment=1,this._initialMarginPercent=r.googleLazyLoadSettings.hbMarginPercent}observe(e){let t=this._initialMarginPercent,n=e.getPositionFromViewport()<0;n&&(t*=this._adjustment);let r=this._marginToIntersectionObserverMap.get(t);r||(r=this._getIntersectionObserver(t),this._marginToIntersectionObserverMap.set(t,r)),r.observe(e.element),this._slotToIntersectionObserverMap.set(e,r)}unobserve(e){let t=this._slotToIntersectionObserverMap.get(e);t&&t.unobserve(e.element),this._slotToIntersectionObserverMap.delete(e)}unobserveAll(e=!0){this.getObservedSlots().forEach(t=>{this.unobserve(t),e&&this._slotEventBus.displaySlot.emit(t.id)})}reobserveAll(){this.getObservedSlots().forEach(e=>{this.unobserve(e),this.observe(e)})}_getIntersectionObserver(e){let t=window.innerHeight*(e/100),n=e=>{for(let t of e)this.processEntry(t)};return new IntersectionObserver(n,{rootMargin:`${t}px 0px`,threshold:[0]})}processEntry(e){let t=this._slots.get(e.target.id);t&&e.intersectionRatio>0&&this._slotToIntersectionObserverMap.has(t)&&(this._slotEventBus.displaySlot.emit(t.id),this.unobserve(t))}getObservedSlots(){return Array.from(this._slotToIntersectionObserverMap.keys())}},Th=D([Q(`IntersectionObserverManager`),C(),A(`design:paramtypes`,[typeof(xh=_h!==void 0&&_h)==`function`?xh:Object,typeof(Sh=Vr!==void 0&&Vr)==`function`?Sh:Object,typeof(Ch=bh!==void 0&&bh)==`function`?Ch:Object,typeof(wh=Qd!==void 0&&Qd)==`function`?wh:Object])],Th)})),Dh,Kre=o((()=>{w(),mU(),O(),Dh=class extends pU{init(){this._key=`DCSLLMediumCPMTarget`,this._lookup=`DCSLL_MED`}},Dh=D([C()],Dh)})),Oh,kh,Ah,jh,Mh,Nh,qre=o((()=>{$(),jc(),Hr(),H(),w(),Eh(),Kre(),B(),X(),j(),E(),O(),Nh=class extends V{constructor(e,t,n,r,i){super(),this._slotEventBus=e,this._intersectionObserverManager=t,this._config=n,this._dcsllMediumCPMExperiment=r,this._prebidMethods=i,T(this,`cpmThreshold`,{met:!1,slotLimit:null,slotLocations:null})}isContentSlot(e){return e.location===F.Content}isBelowPostSlot(e){return e.location===F.Below_Post}isRecipeSlot(e){return e.location===F.Recipe}isValidLocation(e){let t=this.isContentSlot(e)||this.isBelowPostSlot(e)||this.isRecipeSlot(e);return this.cpmThreshold.slotLocations?t&&this.cpmThreshold.slotLocations.includes(e.location):t}isValidSequence(e){if(this.isBelowPostSlot(e))return e.sequence&&e.sequence<=1;if(this.isRecipeSlot(e))return!0;{var t;let n=(t=this.cpmThreshold.slotLimit)==null?9:t;return e.sequence&&e.sequence<=n}}isCPMSlot(e){return e.sequence&&e.sequence<=2&&this.isContentSlot(e)}isTargetSlot(e){return e.lazy&&!this.isCPMSlot(e)&&this.isValidSequence(e)&&this.isValidLocation(e)}_sortByCpm(e,t){return e.cpm===t.cpm?0:e.cpm<t.cpm?1:-1}getSlotCPM(e){if(e.prebidAdUnit&&e.prebidAdUnit.length&&e.prebidAdUnit[0].code){let t=this._prebidMethods.getBidResponsesForAdUnitCode(e.prebidAdUnit[0].code).bids.filter(t=>{var n;return((n=e.prebidAdUnit)==null?void 0:n.length)&&t.adUnitCode===e.prebidAdUnit[0].code}).sort(this._sortByCpm);if(t.length>0)return t[0].cpm}return 0}checkThresholdMet(e){if(!this.cpmThreshold.met&&this.isCPMSlot(e)){let t=this._dcsllMediumCPMExperiment.result?parseFloat(this._dcsllMediumCPMExperiment.result):5,n=this.getSlotCPM(e);n>=100?this.cpmThreshold={met:!0,slotLimit:null,slotLocations:null}:n>=t?this.cpmThreshold={met:!0,slotLimit:7,slotLocations:[F.Content]}:n>=4&&(this.cpmThreshold={met:!0,slotLimit:4,slotLocations:[F.Content]}),this.cpmThreshold.met&&this.loadRemainingSlots()}return this.cpmThreshold.met}loadRemainingSlots(){this._intersectionObserverManager.getObservedSlots().forEach(e=>{this.isTargetSlot(e)&&(this._intersectionObserverManager.unobserve(e),this._slotEventBus.displaySlot.emit(e.id))})}lazyLoadingEnabledForSlot(e){if(!e||!e.googleTagSlot)M.error(`DynamicContentSlotLazyLoadingComponent`,`lazyLoadingEnabledForSlot`,`Slot not configured`);else if(this.enabled&&this.checkThresholdMet(e)&&this.isTargetSlot(e))return e.setSlotTargetingFlag(`dcsll`,[`true`]),e.lazyDisabled=!0,!1;return e.lazy}get enabled(){return this._config.adOptions.dynamicContentSlotLazyLoading}},Nh=D([Q(`DynamicContentSlotLazyLoadingComponent`),C(),A(`design:paramtypes`,[typeof(Oh=Vr!==void 0&&Vr)==`function`?Oh:Object,typeof(kh=Th!==void 0&&Th)==`function`?kh:Object,typeof(Ah=z!==void 0&&z)==`function`?Ah:Object,typeof(jh=Dh!==void 0&&Dh)==`function`?jh:Object,typeof(Mh=R!==void 0&&R)==`function`?Mh:Object])],Nh)})),Ph,Jre=o((()=>{w(),Ui(),E(),O(),Ph=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`InterstitialConfig`,this._lookup=`INTCFG`}},Ph=D([C()],Ph)})),Fh,Ih,Lh,Yre=o((()=>{$(),w(),H(),wi(),Jre(),j(),O(),Lh=class extends V{constructor(e,t){super(),this._interstitialConfigExperiment=e,this._adOptions=t}get enabled(){return this._interstitialConfigExperiment.result&&(this._adOptions.desktopInterstitial||this._adOptions.mobileInterstitial)}start(){this._addAttributeToInternalLinks()}_isInternalLink(e){let t=new URL(window.location.href),n=t.hostname;return e.startsWith(`/`)||e.startsWith(`#`)||e.includes(n)||e.startsWith(`//${n}`)}_addAttributeToInternalLinks(){let e=document.querySelectorAll(`a`);e.forEach(e=>{this._isInternalLink(e.href)&&e.setAttribute(`data-google-interstitial`,`false`)})}_setInterstitialConfig(e){e.googleTagSlot&&e.googleTagSlot.setConfig({interstitial:{triggers:{unhideWindow:!0}}})}},Lh=D([S(),Q(`InterstitialConfigComponent`),A(`design:paramtypes`,[typeof(Fh=Ph!==void 0&&Ph)==`function`?Fh:Object,typeof(Ih=Ci!==void 0&&Ci)==`function`?Ih:Object])],Lh)})),Rh,Xre=o((()=>{Ui(),al(),Z(),w(),E(),O(),Rh=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`AdExpansion`,this._lookup=`AED1`}isEnabled(){let e=!il.isRolloutEnabled(`disable-expandable-ads`);return super.isEnabled()&&!tG()&&e}},Rh=D([C()],Rh)})),Zre=o((()=>{})),zh,Bh=o((()=>{vt(),w(),E(),O(),zh=class{constructor(){T(this,`impressionViewable`,new k),T(this,`slotOnload`,new k),T(this,`slotRenderEnded`,new k),T(this,`slotVisibilityChanged`,new k),T(this,`slotRequested`,new k),T(this,`slotResponseReceived`,new k),T(this,`started`,new k)}},zh=D([C()],zh)})),Vh,Qre=o((()=>{Vh=e=>`scheduler`in window&&window.scheduler&&window.scheduler.postTask?window.scheduler.postTask(()=>e(),{priority:`background`}):new Promise(t=>setTimeout(()=>t(e()),0))})),Hh,Uh,$re,Wh=o((()=>{Hh=(e=window.location.search)=>{let t=e.indexOf(`?`)===0?1:0;return e.slice(t).split(`&`).reduce((e,t)=>{let[n,r]=t.split(`=`);return e.set(n,r),e},new Map)},Uh=e=>e.split(`&`).reduce((e,t)=>{let[n,r]=t&&t.split(`=`);return n&&r&&(e[n]=r),e},{}),$re=e=>Object.keys(e).map(t=>`${t}=${encodeURIComponent(e[t])}`).join(`&`)})),eie,tie,Gh,Kh=o((()=>{or(),Qre(),al(),Wh(),E(),eie=class{constructor(e,t,n,r,i){this._id=e,this._startTime=t,this._sequence=n,this._type=r,this._slotRenderEndedFired=i,T(this,`_pvk`,``),T(this,`_name`,void 0),T(this,`_adsloggerData`,{abgroup:`taskmonitor-log`,pubab:`taskmonitor-log`,sess:`taskmonitor-log`,pvk:this._pvk,hbho:[`taskmonitor-log`],vbho:[`taskmonitor-log`],spa:!1}),T(this,`_taskData`,null),T(this,`_metadata`,{});let a=window.adthrive;typeof a==`object`&&a&&`context`in a&&typeof a.context==`object`&&a.context!==null&&`pageviewKey`in a.context&&typeof a.context.pageviewKey==`string`&&(this._pvk=a.context.pageviewKey,this._adsloggerData.pvk=this._pvk),this._name=this._id.split(`_`)[0]}markEndTask(){let e=this._markEnd();this._slotRenderEndedFired?Vh(()=>this._logData(e)):this._pushToAdThriveQueue(()=>{this._pushToGamQueue(()=>{window.googletag.pubads().addEventListener(`slotRenderEnded`,()=>{Vh(()=>this._logData(e))})})})}_markEnd(){let e=Date.now();return performance.mark(`${this._id}-end`),performance.measure(`${this._id}`,`${this._id}-start`,`${this._id}-end`),{startTime:this._startTime,duration:e-this._startTime,name:this._id}}_logData(e){let t=this._createLogURL(e),n=new XMLHttpRequest;n.open(`get`,t,!0),n.send()}setTaskData(e){let{duration:t,startTime:n}=e;this._taskData={name:this._name,type:this._type,startTime:n,duration:t,sequence:this._sequence,metadata:this._metadata}}_createLogURL(e){this.setTaskData(e);let t=[this._taskData===null?{}:this._taskData,this._adsloggerData],n=[`siteId=${encodeURIComponent(window.adthrive.siteAds.siteId||``)}`,`siteName=${encodeURIComponent(window.adthrive.siteAds.siteName||``)}`,`bucket=${encodeURIComponent(window.adthrive.bucket||``)}`,`branch=${encodeURIComponent(window.adthrive.branch||``)}`,`deployment=${encodeURIComponent(window.adthrive.deployment||``)}`,`message=TaskMonitor%3A%3A_logData`,`pageurl=${encodeURIComponent(window.location.origin+window.location.pathname)}`,`body=${encodeURIComponent(JSON.stringify(t))}`];return`https://logger.adthrive.com/event?${n.join(`&`)}`}addMetadata(e){Object.keys(e).forEach(t=>{this._metadata[t]=e[t]})}_pushToAdThriveQueue(e){let t=window.adthrive;t&&t.cmd&&t.cmd.push(e)}_pushToGamQueue(e){let t=window.googletag;t&&t.cmd&&t.cmd.push(e)}},tie=class{constructor(){T(this,`_taskIdCounters`,new Map),T(this,`_enabled`,null),T(this,`_defaultLoggingRate`,.02),T(this,`_featureRolloutKeyForLoggingRate`,`task-performance-logging-rate`),T(this,`_slotRenderEndedFired`,!1);let e=window.adthrive;e&&this._pushToAdThriveQueue(()=>{this._pushToGamQueue(()=>{window.googletag.pubads().addEventListener(`slotRenderEnded`,()=>{this._slotRenderEndedFired=!0})})})}markStartTask(e,t,n=!1){if(n||this.enabled){let n=`adt-${t.join(`-`)}`,r=this._taskIdCounters.get(n),i=r===void 0?0:r+1,a=`${n}_${i}`,o=this._markStart(a);return this._taskIdCounters.set(n,i),new eie(a,o,i,e,this._slotRenderEndedFired)}else return{markEndTask:()=>{},addMetadata:()=>{}}}_markStart(e){return performance.mark(`${e}-start`),Date.now()}get enabled(){if(this._enabled===null){let e=!!Hh().get(`tpm`),t=this._determineDesiredSiteLevelLoggingRate(),n=new ar(t).get();this._enabled=n||e}return this._enabled}_pushToAdThriveQueue(e){let t=window.adthrive;t&&t.cmd&&t.cmd.push(e)}_pushToGamQueue(e){let t=window.googletag;t&&t.cmd&&t.cmd.push(e)}_determineDesiredSiteLevelLoggingRate(){if(this._featureRolloutKeyForLoggingRate in il.siteFeatureRollouts){let{enabled:e,data:t}=il.siteFeatureRollouts[this._featureRolloutKeyForLoggingRate];if(e&&t&&typeof t==`object`&&`pct_enabled`in t&&typeof t.pct_enabled==`number`)return t.pct_enabled/100}return this._defaultLoggingRate}},Gh=new tie})),qh,nie=o((()=>{Ui(),w(),$(),E(),j(),O(),qh=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`CFIpBidReqHoldout`,this._lookup=`CFIP_BRHO`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],qh.prototype,`run`,null),qh=D([C()],qh)})),Jh,rie=o((()=>{$(),Jh=(e,t)=>{var n;if(!e||!(!(e==null||(n=e.metadata)==null)&&n.capturedOn))return!1;try{if(e){let n=new Date(e.metadata.capturedOn).getTime(),r=new Date().getTime(),i=(r-n)/(1e3*60*60);return i>24?!1:!!t}else return!1}catch(e){return M.error(`isCloudFlareIpCurrent`,`shouldPassCloudFlareIp`,`Error checking session validity`,e),!1}}})),iie,aie,oie,sie,cie,lie,uie,die,fie,pie,mie,hie,gie,_ie,Yh,Xh,Zh,Qh=o((()=>{Wre(),jc(),qre(),B(),Ra(),Yre(),rU(),hr(),Hr(),X(),$(),vh(),Z(),Ta(),w(),Xre(),Bh(),rd(),Kh(),al(),nie(),rie(),j(),O(),Zh=Xh=class{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m){this._config=e,this._context=t,this._bootstrapEventBus=n,this._consentEventBus=r,this._slots=i,this._prebidMethods=a,this._demandChain=o,this._dynamicContentSlotLazyLoadingComponent=s,this._interstitialConfigComponent=c,this._adExpansionExperiment=l,this._identityEventBus=u,this._slotEventBus=d,this._eventBus=f,this._bootstrapConfig=p,this._cloudflareIpBidReqExpHo=m}init(){Xh.pushToQueue(()=>{let e=window.googletag.pubads();e.setSafeFrameConfig({sandbox:!0,allowOverlayExpansion:!0,allowPushExpansion:!0}),e.set(`page_url`,this._context.pageUrl),e.enableSingleRequest(),e.disableInitialLoad(),e.setPrivacySettings({childDirectedTreatment:Sa()}),this._configureIpAddress(),this._addGamEventListeners(),this._bootstrapEventBus.libraryLoadFailed.on(({bootstrapType:e})=>{e===Rn.Prebid&&this.setTargetingFlag(`pbjs`,[`failed`])},{handleEventsAlreadyEmitted:!0}),this._config.act25.required&&this._consentEventBus.act25consentCaptured.on(e=>{this.setNonPersonalizedAds(!e)},{handleEventsAlreadyEmitted:!0}),this._config.usCMP.required&&this._consentEventBus.usCmpConsentCaptured.on(e=>{this.setNonPersonalizedAds(!e)},{handleEventsAlreadyEmitted:!0}),this._identityEventBus.optableResolved.on(e=>this._setOptableGamTargeting(e),{handleEventsAlreadyEmitted:!0}),this._identityEventBus.optableResolveAnalytics.on(e=>this.setTargetingFlag(`opt_reslv`,[e]),{handleEventsAlreadyEmitted:!0}),il.enabledFeatureRolloutIds&&il.enabledFeatureRolloutIds.length&&this.setTargetingFlag(`fr`,il.enabledFeatureRolloutIds.map(e=>e.toString()))}),this.setTargetingFlag(`tpme`,[Gh.enabled.toString()])}start(){Xh.pushToQueue(()=>{window.googletag.enableServices();try{this._eventBus.started.emit()}catch(e){M.error(`GoogleAdManager`,`start`,`started`,e)}})}static pushToQueue(e){window.googletag.cmd.push(e)}waitForQueue(){return new Promise(e=>{window.googletag.cmd.push(()=>{e(!0)})})}setTargeting(e){let t=(Array.isArray(e)?e:[e]).filter(e=>!(!e.value||!e.value.length));for(let e of t)e&&Xh.pushToQueue(()=>{window.googletag.pubads().setTargeting(e.key,e.value)})}setSlotTargeting(e,t){let n=Array.isArray(e)?e:[e];for(let e of n)e&&Xh.pushToQueue(()=>{t.setTargeting(e.key,Array.isArray(e.value)?e.value.join(`,`):e.value)})}setTargetingFlag(e,t,n=!1){let r=()=>{let r=window.googletag.pubads(),i=r.getTargeting(`flag`),a=i.filter(t=>{let[r]=t.split(`:`);return!n||r!==e});this.setTargeting({key:`flag`,value:[...a,...t.map(t=>`${e}:${t}`)]})};t&&t.length>0&&Xh.pushToQueue(()=>r())}getTargeting(){return window.googletag.pubads().getTargetingKeys().map(e=>({key:e,value:window.googletag.pubads().getTargeting(e)}))}getTargetingValuesForKey(e){return window.googletag.pubads().getTargeting(e)}getTargetingValuesForFlag(e){let t=[],n=this.getTargetingValuesForKey(`flag`).filter(t=>{let[n]=t.split(`:`);return n===e});return n.length>0&&(t=n.map(e=>e.split(`:`)[1])),t}getTargetingMap(){let e=window.googletag.pubads();return e.getTargetingKeys().reduce((t,n)=>(t[n]=e.getTargeting(n),t),{})}clearTargetingForKey(e){Xh.pushToQueue(()=>{window.googletag.pubads().clearTargeting(e)})}_getPathname(e,t){return e.thirdPartyAdUnitName&&t?e.thirdPartyAdUnitName:e.location===F.Content&&e.sequence&&e.sequence>9||e.location===F.Below_Post&&e.sequence&&e.sequence>1?e.location:e.location===F.Sidebar&&e.sequence&&e.sequence>9?e.name.replace(/\d+/,`9`):e.location===F.Recipe&&e.sequence&&e.sequence>5?e.name.replace(/\d+/,`2`):e.name}defineSlots(e){let{id:t}=this._config.site,{account:n,prefix:r}=this._config.gam,i=this._config.gam.isThirdPartyGam;return e.map(e=>{if(i&&!e.thirdPartyAdUnitName){M.error(`GoogleAdManager`,`defineSlots`,`Ad unit name undefined for third party GAM slot.`);return}let a=this._getPathname(e,i),o=e.thirdPartyAdUnitName&&i?``:`${r}_`,s=`/${n}/${o}${a}/${t}`,c=e.location===F.Video_StickyOutstream?[...e.sizes]:[...e.sizes,`fluid`];return this._setupSlot(e,s,c),e}).filter(bK)}async displaySlots(e){await this.waitForQueue();let t=window.googletag.pubads();window.googletag&&!window.googletag.pubadsReady&&M.error(`GoogleAdManager`,`displaySlots`,Error(`Unexpected googletag.pubadsReady: ${window.googletag.pubadsReady}`));let n=[];await this._prebidMethods.waitForQueue().then(e=>{e===!0&&(n=this._prebidMethods.getAllPrebidWinningBids())});for(let r of e){let i=r.location===F.Video_StickyOutstream,a=this._demandChain.getBidWithBsidForSlot(r,n),o;a&&(o=this._demandChain.getLastBsid(a.meta),o&&r.googleTagSlot.setTargeting(`hb_bsid`,o)),t.enableLazyLoad(this._dynamicContentSlotLazyLoadingComponent.lazyLoadingEnabledForSlot(r)?this._config.lazyLoad.googleLazyLoadSettings.gam:this._config.lazyLoad.googleLazyLoadSettings.disabled),await this._emitBeforeRefreshSlots(e);let s=i?this._hasBids(r,{hb_bsid:o}):!0;s?t.refresh([r.googleTagSlot]):(r.unfilled=!0,await this._emitNoBidResponses(r))}}refreshSlots(e){Xh.pushToQueue(async()=>{await this._emitBeforeRefreshSlots(e);let t=[],n=[];e.forEach(e=>{let r=e.location!==F.Video_StickyOutstream||this._hasBids(e);r?t.push(e):(e.unfilled=!0,n.push(e))}),t.length&&(t.forEach(e=>e.addRequestTypeSlotFlag()),window.googletag.pubads().refresh(t.map(e=>e.googleTagSlot)));for(let e of n)await this._emitNoBidResponses(e)})}_emitNoBidResponses(e){return this._slotEventBus.noBidResponses.legacyEmit(e.id)}_hasBids(e,t){let n=e.googleTagSlot;if(!n)return;let r=n.getTargeting(`amz_pb`).length||n.getTargeting(`amz_pb_sp`).length,i=n.getTargeting(`hb_adid`).length||r;return i||M.event(`GoogleAdManager`,`_hasBids`,{name:e.name,nref:e.refreshCount,...t}),!!i}async _emitBeforeRefreshSlots(e){let t=e.map(e=>e.id);await this._slotEventBus.beforeGoogleAdManagerRefreshSlots.legacyEmit(t),await this._slotEventBus.addRangeSlotTargeting.legacyEmit(t)}clearSlots(e){Xh.pushToQueue(()=>{let t=e.map(e=>e.googleTagSlot);window.googletag.pubads().clear(t)})}destroySlots(e){Xh.pushToQueue(()=>{let t=e.map(e=>e.googleTagSlot);window.googletag.destroySlots(t)})}setIdAsPPID(e){Xh.pushToQueue(()=>{window.googletag.pubads().setPublisherProvidedId(e)})}setNonPersonalizedAds(e){Xh.pushToQueue(()=>{window.googletag.pubads().setPrivacySettings({nonPersonalizedAds:e})})}_addGamEventListeners(){this._addEventListener(this._eventBus.impressionViewable,`impressionViewable`),this._addEventListener(this._eventBus.slotOnload,`slotOnload`),this._addEventListener(this._eventBus.slotRenderEnded,`slotRenderEnded`),this._addEventListener(this._eventBus.slotVisibilityChanged,`slotVisibilityChanged`),this._addEventListener(this._eventBus.slotRequested,`slotRequested`),this._addEventListener(this._eventBus.slotResponseReceived,`slotResponseReceived`)}_addEventListener(e,t){Xh.pushToQueue(()=>{window.googletag.pubads().addEventListener(t,n=>{let r=Gh.markStartTask(`microtask`,[`GoogleAdManager`,t]),i=this._slots.get(n.slot.getSlotElementId());if(i)try{e.emit({slotId:i.id,event:n})}catch(e){M.error(`GoogleAdManager`,`addEventListener`,`emit`,e)}r.markEndTask()})})}_setOptableGamTargeting(e){let{clusterCount:t,hemCount:n,accuracyResult:r,traits:i,recencyGroup:a}=e;this.setTargetingFlag(`n_clust`,[`${t}`]),this.setTargetingFlag(`n_hem`,[`${n}`]),this.setTargetingFlag(`g_rec`,[a]),r.status===`hem-found`?this.setTargetingFlag(`rog_ha`,[r.matchingClusterIndex.toString()]):r.status===`hem-not-found`&&this.setTargetingFlag(`rog_ha`,[`-1`]),this._setOptableGamTargetingForTraits(i)}_setOptableGamTargetingForTraits(e){let t=[{key:`lastSeen`,targetingName:`td_rec`},{key:`percentile`,targetingName:`td_perc`},{key:`hemSources`,targetingName:`oemsrc`}];t.forEach(t=>{let{key:n,targetingName:r}=t,i=e[n];if(i)switch(i){case`true`:this.setTargetingFlag(r,[`t`]);break;case`false`:this.setTargetingFlag(r,[`f`]);break;default:this.setTargetingFlag(r,Array.isArray(i)?i.map(e=>e.toString()):[i.toString()]);break}})}_setupSlot(e,t,n){if(this._bootstrapConfig.gptLibFailedToLoad)return;let r=window.googletag.pubads();if(e.googleTagSlot=e.location===F.Interstitial?window.googletag.defineOutOfPageSlot(t,window.googletag.enums.OutOfPageFormat.INTERSTITIAL):window.googletag.defineSlot(t,n,e.element.id),!e.googleTagSlot){M.error(`GoogleAdManager`,`defineSlots`,`Duplicate`,t);return}e.googleTagSlot.addService(r).setTargeting(`location`,e.location).setTargeting(`sequence`,String(e.sequence)).setTargeting(`id`,e.id),e.googleTagSlotReady=!0,e.googleTagSlotReadyEmitter.emit(),(e.location===F.Content||e.location===F.Below_Post)&&this._adExpansionExperiment.result&&e.googleTagSlot.setConfig({adExpansion:{enabled:!0}}),this._interstitialConfigComponent.enabled&&(e.location===F.Interstitial||e.location===F.Interstitial_1)&&this._interstitialConfigComponent._setInterstitialConfig(e),(e.sequence===1&&e.isAboveTheFold||e.location===F.Footer)&&e.googleTagSlot.setTargeting(`ATF`,`true`),e.isSticky&&e.location!==F.Video_StickyOutstream&&e.googleTagSlot.setTargeting(`sticky`,`true`),e.special&&e.special.length>0&&e.googleTagSlot.setTargeting(`special`,e.special),e.location===`Sponsor_Tile`&&e.googleTagSlot.setCollapseEmptyDiv(!0,!0),e.location.includes(`Native`)&&e.googleTagSlot.setCollapseEmptyDiv(!0),r.isInitialLoadDisabled()&&window.googletag.display(e.googleTagSlot)}_configureIpAddress(){var e;if(!this._cloudflareIpBidReqExpHo.result||this._config.ccpa.userOptedOut||this._config.gdpr.enabled)return;let t=(e=this._config.user.rcid)==null?void 0:e.metadata.clientIp;if(!(!t||!Jh(this._config.user.rcid,!!this._context.sessionKey)))try{window.googletag.pubads().set(`ipAddress`,t)}catch(e){M.error(`GoogleAdManager`,`_configureIpAddress`,`IP address available but failed to configure IP address`,e)}}},Zh=Xh=D([Q(`GoogleAdManager`),C(),A(`design:paramtypes`,[typeof(iie=z!==void 0&&z)==`function`?iie:Object,typeof(aie=L!==void 0&&L)==`function`?aie:Object,typeof(oie=mr!==void 0&&mr)==`function`?oie:Object,typeof(sie=_r!==void 0&&_r)==`function`?sie:Object,typeof(cie=_h!==void 0&&_h)==`function`?cie:Object,typeof(lie=R!==void 0&&R)==`function`?lie:Object,typeof(uie=yh!==void 0&&yh)==`function`?uie:Object,typeof(die=Nh!==void 0&&Nh)==`function`?die:Object,typeof(fie=Lh!==void 0&&Lh)==`function`?fie:Object,typeof(pie=Rh!==void 0&&Rh)==`function`?pie:Object,typeof(mie=Nr!==void 0&&Nr)==`function`?mie:Object,typeof(hie=Vr!==void 0&&Vr)==`function`?hie:Object,typeof(gie=zh!==void 0&&zh)==`function`?gie:Object,typeof(_ie=Ki!==void 0&&Ki)==`function`?_ie:Object,typeof(Yh=qh!==void 0&&qh)==`function`?Yh:Object])],Zh)})),$h=o((()=>{Qh(),Zre()})),eg,tg=o((()=>{eg=class{get videoEnabled(){return!0}get enabled(){return!0}}})),ng,rg=o((()=>{ng=class{getSupplyChainConfig(e){return{ver:`1.0`,complete:1,nodes:[{asi:`cafemedia.com`,sid:e,hp:1}]}}}})),ig,vie=o((()=>{Fn(),ig=new Map([[`10thu68`,`a_${P.AppNexus}`],[`16d9pts`,`a_${P.GumGum}`],[`1axt6o`,`a_${P.OpenX}`],[`1bkk3r4`,`a_${P.AmazonTAM}`],[`1dfpj4`,`a_${P.AmazonTAM}`],[`1e4ycjk`,`a_${P.Triplelift}`],[`1lcnshs`,`a_${P.Sharethrough}`],[`1skd8g0`,`a_${P.Yieldmo}`],[`1y4543k`,`a_${P.Pubmatic}`],[`3bcv7k`,`a_${P.AmazonTAM}`],[`j27tog`,`a_${P.Rubicon}`],[`me2y9s`,`a_${P.IndexExchange}`],[`qtwge8`,`a_${P.Verizon}`],[`upqrr4`,`a_${P.MediaGrid}`],[`emebk0`,`a_${P.Unruly}`],[`f6dibk`,`a_${P.Ogury}`],[`rdvn5s`,`a_${P.Seedtag}`],[`1qwfo5c`,`a_${P.Blis}`],[`ii8mww`,`a_${P.Cadent}`],[`1nkkjk0`,`a_${P.Medianet}`],[`wdoc1s`,`a_${P.Verve}`]])})),ag,og,sg,yie=o((()=>{ag={"138wa9s":.01,lhm9s0:.02,"1l06ark":.03,clz9j4:.04,"1c4jaio":.05,ud9a0w:.06,"1tvtb0g":.07,"865reo":.08,"17opse8":.09,pxfrwg:.1,"1pfzsw0":.11,h1srnk:.12,"1gkcsn4":.13,yt2s5c:.14,"1ybmt4w":.15,"1ifi80":.16,"110zj7k":.17,j9pips:.18,"1is9jpc":.19,ae2igw:.2,"19wmjgg":.21,s5ciyo:.22,"1rnwjy8":.23,"5y90cg":.24,"15gt1c0":.25,npj0u8:.26,"1n831ts":.27,etw0lc:.28,"1ecg1kw":.29,wl6134:.3,"1w3q22o":.31,"2mdvr4":.32,"124xwqo":.33,kdnw8w:.34,"1jw7x8g":.35,bi0w00:.36,"1b0kwzk":.37,t9awhs:.38,"1sruxhc":.39,"727dvk":.4,"16krev4":.41,othedc:.42,"1oc1fcw":.43,fxue4g:.44,"1fgef40":.45,xp4em8:.46,"1x7ofls":.47,eh4ow:.48,zx15og:.49,i5r56o:.5,"1hob668":.51,"9a44xs":.52,"18so5xc":.53,r1e5fk:.54,"1qjy6f4":.55,"4uamtc":.56,"14cunsw":.57,mlknb4:.58,"1m44oao":.59,dpxn28:.6,"1d8ho1s":.61,vh7nk0:.62,"1uzrojk":.63,"4abg1s":.64,"13svh1c":.65,m1lgjk:.66,"1lk5hj4":.67,d5ygao:.68,"1coiha8":.69,ux8gsg:.7,"1ufshs0":.71,"8q4y68":.72,"188oz5s":.73,qheyo0:.74,"1pzyznk":.75,hlryf4:.76,"1h4bzeo":.77,zd1yww:.78,"1yvlzwg":.79,"22eozk":.8,"11kypz4":.81,jtophc:.82,"1jc8qgw":.83,ay1p8g:.84,"1aglq80":.85,spbpq8:.86,"1s7vqps":.87,"6i8740":.88,"160s83k":.89,o9i7ls:.9,"1ns28lc":.91,fdv7cw:.92,"1ewf8cg":.93,x557uo:.94,"1wnp8u8":.95,"36d2io":.96,"12ox3i8":.97,kxn30g:.98,"1kg7400":.99,c202rk:1,"1bkk3r4":1.01,tta39c:1.02,"1tbu48w":1.03,"7m6kn4":1.04,"174qlmo":1.05,pdgl4w:1.06,"1ow0m4g":1.07,ghtkw0:1.08,"1g0dlvk":1.09,y93lds:1.1,"1xrnmdc":1.11,ygbgg:1.12,"10h0cg0":1.13,ipqby8:1.14,"1i8acxs":1.15,"9u3bpc":1.16,"19cncow":1.17,rldc74:1.18,"1r3xd6o":1.19,"5e9tkw":1.2,"14wtukg":1.21,n5ju2o:1.22,"1mo3v28":1.23,e9wtts:1.24,"1dsgutc":1.25,w16ubk:1.26,"1vjqvb4":1.27,"3gcnwg":1.28,"12ywow0":1.29,l7moe8:1.3,"1kq6pds":1.31,cbzo5c:1.32,"1bujp4w":1.33,u39on4:1.34,"1tltpmo":1.35,"7w660w":1.36,"17eq70g":1.37,png6io:1.38,"1p607i8":1.39,grt69s:1.4,"1gad79c":1.41,yj36rk:1.42,"1y1n7r4":1.43,"18fwu8":1.44,"10qzxts":1.45,izpxc0:1.46,"1ii9ybk":1.47,a42x34:1.48,"19mmy2o":1.49,rvcxkw:1.5,"1rdwykg":1.51,"5o9eyo":1.52,"156tfy8":1.53,nfjfgg:1.54,"1my3gg0":1.55,ejwf7k:1.56,"1e2gg74":1.57,wb6fpc:1.58,"1vtqgow":1.59,"2ceadc":1.6,"11uybcw":1.61,k3oav4:1.62,"1jm8buo":1.63,b81am8:1.64,"1aqlbls":1.65,szbb40:1.66,"1shvc3k":1.67,"6s7shs":1.68,"16arthc":1.69,ojhszk:1.7,"1o21tz4":1.71,fnusqo:1.72,"1f6etq8":1.73,xf4t8g:1.74,"1wxou80":1.75,"4hjb4":1.76,zn1kao:1.77,hvrjsw:1.78,"1hebksg":1.79,"904jk0":1.8,"18iokjk":1.81,qrek1s:1.82,"1q9yl1c":1.83,"4kb1fk":1.84,"142v2f4":1.85,mbl1xc:1.86,"1lu52ww":1.87,dfy1og:1.88,"1cyi2o0":1.89,v78268:1.9,"1ups35s":1.91,"40buo0":1.92,"13ivvnk":1.93,lrlv5s:1.94,"1la5w5c":1.95,cvyuww:1.96,"1ceivwg":1.97,un8veo:1.98,"1u5swe8":1.99,"8g5csg":2,"17ypds0":2.01,q7fda8:2.02,"1ppze9s":2.03,hbsd1c:2.04,"1guce0w":2.05,z32dj4:2.06,"1ylmeio":2.07,"1sf3ls":2.08,"11az4lc":2.09,jjp43k:2.1,"1j29534":2.11,ao23uo:2.12,"1a6m4u8":2.13,sfc4cg:2.14,"1rxw5c0":2.15,"688lq8":2.16,"15qsmps":2.17,nzim80:2.18,"1ni2n7k":2.19,f3vlz4:2.2,"1emfmyo":2.21,wv5mgw:2.22,"1wdpngg":2.23,"2wdh4w":2.24,"12exi4g":2.25,knnhmo:2.26,"1k67im8":2.27,bs0hds:2.28,"1bakidc":2.29,tjahvk:2.3,"1t1uiv4":2.31,"7c6z9c":2.32,"16ur08w":2.33,p3gzr4:2.34,"1om10qo":2.35,g7tzi8:2.36,"1fqe0hs":2.37,xz4000:2.38,"1xho0zk":2.39,ogq2o:2.4,"1070r28":2.41,ifqqkg:2.42,"1hyark0":2.43,"9k3qbk":2.44,"192nrb4":2.45,rbdqtc:2.46,"1qtxrsw":2.47,"54a874":2.48,"14mu96o":2.49,mvk8ow:2.5,"1me49og":2.51,dzx8g0:2.52,"1dih9fk":2.53,vr78xs:2.54,"1v9r9xc":2.55,"3vc1z4":2.56,"13dw2yo":2.57,lmm2gw:2.58,"1l563gg":2.59,cqz280:2.6,"1c9j37k":2.61,ui92ps:2.62,"1u0t3pc":2.63,"8b5k3k":2.64,"17tpl34":2.65,q2fklc:2.66,"1pkzlkw":2.67,h6skcg:2.68,"1gpclc0":2.69,yy2ku8:2.7,"1ygmlts":2.71,"1nfaww":2.72,"115zbwg":2.73,jepbeo:2.74,"1ix9ce8":2.75,aj2b5s:2.76,"1a1mc5c":2.77,sacbnk:2.78,"1rswcn4":2.79,"638t1c":2.8,"15lsu0w":2.81,nuitj4:2.82,"1nd2uio":2.83,eyvta8:2.84,"1ehfu9s":2.85,wq5ts0:2.86,"1w8purk":2.87,"2rdog0":2.88,"129xpfk":2.89,kinoxs:2.9,"1k17pxc":2.91,bn0oow:2.92,"1b5kpog":2.93,teap6o:2.94,"1swuq68":2.95,"7776kg":2.96,"16pr7k0":2.97,oyh728:2.98,"1oh181s":2.99,g2u6tc:3,"1020ydc":3.05,r6dy4g:3.1,"1m94gzk":3.15,"4fb8qo":3.2,"1cti9z4":3.25,qmercw:3.3,"1z0lslc":3.35,b31hxc:3.4,"165s0sg":3.45,xa50jk:3.5,"1kl6wow":3.55,"7r6dc0":3.6,"1g5dekg":3.65,iuq4n4:3.7,"1r8x5vk":3.75,eewmio:3.8,"133whkw":3.85,u89hc0:3.9,"1pb0074":3.95,"1dfpj4":4,"19rmqrk":4.05,nkj85c:4.1,"1vyq9ds":4.15,bd13b4:4.2,"16frm68":4.25,xk4lxc:4.3,"1hjbdhc":4.35,"4pau4g":4.4,"1d3hvcw":4.45,lwlnuo:4.5,"1uasp34":4.55,hgs5q8:4.6,"11fyxa8":4.65,skbx1c:4.7,"1nn2fwg":4.75,"31d9ts":4.8,"1bfkb28":4.85,p8gsg0:4.9,"1xmntog":4.95,"9p3j0g":5,"14ru1vk":5.05,vw71mo:5.1,"1kxoef4":5.15,"83nv28":5.2,"1ghuwao":5.25,j77mdc:5.3,"1rlenls":5.35,ere48w:5.4,"122g0e8":5.45,t6t05c:5.5,"1o9jj0g":5.55,bz8cg:5.6,"18q69kw":5.65,mj2qyo:5.7,"1ux9s74":5.75,d3gjy8:5.8,"18672tc":5.85,zak2kg:5.9,"1j9qu4g":5.95,"6fqark":6,"1etxc00":6.05,kv56o0:6.1,"1t9c7wg":6.15,gfbojk:6.2,"10eig3k":6.25,rivfuo:6.3,"1mllyps":6.35,"3durk0":6.4,"1bs1ssg":6.45,pkya68:6.5,"1xz5beo":6.55,a1l0qo:6.6,"154bjls":6.65,w8ojcw:6.7,"1jjqfi8":6.75,"6ppw5c":6.8,"1f3wxds":6.85,ht9ngg:6.9,"1q7goow":6.95,ddg5c0:7,"13gdzb4":7.05,ukqz28:7.1,"1pnhhxc":7.15,"1px79c":7.2,"1a448hs":7.25,nx0pvk:7.3,"1wb7r40":7.35,bpil1c:7.4,"16s93wg":7.45,xwm3nk:7.5,"1hvsv7k":7.55,"51sbuo":7.6,"1dfzd34":7.65,lk464g:7.7,"1tyb7cw":7.75,h4ao00:7.8,"113hfk0":7.85,s7ufb4:7.9,"1naky68":7.95,"2ovs3k":8,ovzaps:8.1,"9cm1a8":8.2,"14fck5c":8.25,vjpjwg:8.3,"8smuio":8.4,jw6lts:8.5,fgd3pc:8.6,tvrzls:8.7,"1oyiigw":8.75,"10y7sw":8.8,n81qf4:8.9,cehkhs:9,yll340:9.1,"5qrbb4":9.2,"1e4ycjk":9.25,k6677k:9.3,fqcp34:9.4,qtwge8:9.5,"42tr0g":9.6,q9x9mo:9.7,"1yo4av4":9.75,aqk074:9.8,wxnitc:9.9,"7eovls":10,ii8mww:10.1,e2f4sg:10.2,"137nc3k":10.25,uc0buo:10.3,"1h6k1s":10.4,noa2o0:10.5,bgrxts:10.6,xnvgg0:10.7,"1hn2800":10.75,"4t1on4":10.8,m0cidc:10.9,hkj08w:11,so2rk0:11.1,"3544cg":11.2,"1bjb5kw":11.25,pc7myo:11.3,"9sudj4":11.4,vzxw5c:11.5,"7ux7uo":11.6,iygz5s:11.7,"1rco0e8":11.75,einh1c:11.8,sy2cxs:11.9,"38l4w":12,mac3r4:12.1,cupwqo:12.2,"17xgfls":12.25,z1tfcw:12.3,"66znk0":12.4,kmejgg:12.5,g6l1c0:12.6,"1mcvbi8":12.7,ra4sn4:12.75,"3u33sw":12.8,q16mf4:12.9,ahtczk:13,wowvls:13.1,"75y8e8":13.2,"1fk59mo":13.25,i9hzpc:13.3,dtohkw:13.4,v0zbb4:13.5,"265ji8":13.6,od924g:13.7,"1wrg3cw":13.75,c5qxa8:13.8,ycufwg:13.9,"5i0o3k":14,lbdiww:14.1,gvk0sg:14.2,"10uqscg":14.25,rz3s3k:14.3,"2g54w0":14.4,on8ni8:14.5,"93ve2o":14.6,vaywow:14.7,"1ldwqo0":14.75,"8jw7b4":14.8,jnfym8:14.9,f7mghs:15,tn1ce8:15.1,s7klc:15.2,"196elts":15.25,mzb37k:15.3,ci8f0g:15.4,ypbxmo:15.5,"5ui5ts":15.6,k9x1q8:15.7,"1so42yo":15.75,fu3jls:15.8,qxnaww:15.9,"46klj4":16,qdo45c:16.1,auaups:16.2,"15x1dkw":16.25,x1edc0:16.3,"7ifq4g":16.4,ilzhfk:16.5,e65zb4:16.6,tziu4g:16.7,"1p29czk":16.75,"14p2bk":16.8,nbskxs:16.9,b4ag3k:17,xbdyps:17.1,"4gk6ww":17.2,"1cur85c":17.25,lnv0n4:17.3,h81iio:17.4,sbl9ts:17.5,"2smmm8":17.6,ozq58g:17.7,"1xdx6gw":17.75,"9gcvsw":17.8,vngef4:17.9,"87epkw":18,jaygw0:18.1,ev4yrk:18.2,"1266uww":18.25,tajuo0:18.3,fq2v4:18.4,mmtlhc:18.5,d77egw:18.6,zeax34:18.7,"1jdhon4":18.75,"6jh5a8":18.8,kyw16o:18.9,gj2j28:19,rmmadc:19.1,"3hlm2o":19.2,"1bvsnb4":19.25,pop4ow:19.3,a5bv9c:19.4,wcfdvk:19.5,"6tgqo0":19.6,hx0hz4:19.7,"1qb7j7k":19.75,dh6zuo:19.8,uohtkw:19.9,"1to1s0":20,lgzsow:20.5,"99hnuo":21,tsnm68:21.5,"5nmxvk":22,q6sw74:22.5,dzarcw:23,xthq80:23.5,"3aqe4g":24,j438xs:24.5,d0c6io:25,rfr2f4:25.5,"6z30g0":26,o6du68:26.5,goosu8:27,v43oqo:27.5,lccn4:28,kfjbi8:28.5,azx4hs:29,u553wg:29.5,"4m6gow":30,p5cf0g:30.5,es0lc0:31,zb6jnk:31.5,"3eh8n4":32,htw4jk:32.5,bq524g:33,s8gwe8:33.5,"8t9bls":34,n8o7i8:34.5,fqz668:35,wy9zwg:35.5,"1e26m8":36,lx84xs:36.5,"9pq03k":37,suxzi8:37.5,"63va4g":38,py28zk:38.5,dqk45c:39,y9q2gw:39.5,"2d0rgg":40,jkbl6o:40.5,cmai2o:41,r1pdz4:41.5,"7mht6o":42,nfuo00:42.5,hc3lkw:43,vrihhc:43.5,js5xc:44,l2y48w:44.5,a9dybk:45,usjwn4:45.5,"59l9fk":46,oraqkg:46.5,fbojk0:47,ygwiyo:47.5,"3y56v4":48,idk2rk:48.5,bku0w0:49,ss4um8:49.5,"7yzaww":50,mee6tc:50.5,gan4e8:51,wk8bgg:51.5,"21gzcw":52,l6oyrk:52.5,"8z6txc":53,tics8w:53.5,"62b3eo":54,qlh1q8:54.5,edyww0:55,xj6wao:55.5,"30fk74":56,j69wqo:56.5,d2iubk:57,rhxq80:57.5,"6os6io":58,nw308w:58.5,h3cydc:59,viru9s:59.5,"100i68":60,k58hkw:60.5,apmakg:61,ucy1hc:61.5,"4tze9s":62,pd5clc:62.5,ejl6o0:63,z2r4zk:63.5,"3v0tfk":64,iafpc0:64.5,c6omww:65,s01hq8:65.5,"8ktwxs":66,n08su8:66.5,fv198g:67,x2c2yo:67.5,"15mry8":68,losq9s:68.5,"9halfk":69,tbhkao:69.5,"6keuww":70,ppmubk:70.5,di4phc:71,y1answ:71.5,"2ktp1c":72,js4irk:72.5,cafhfk:73,qpudc0:73.5,"7amsjk":74,nsymtc:74.5,hp7ke8:75,w4mgao:75.5,"7x5a8":76,kr33ls:76.5,aa0feo:77,ut6dq8:77.5,"5a7qio":78,offpxc:78.5,eztiww:79,yu0hs0:79.5,"4b95og":80,iqo1kw:80.5,b8z08w:81,sg9tz4:81.5,"86bdog":82,mlq9kw:82.5,ghz75s:83,wbc1z4:83.5,"1skpvk":84,lmroqo:84.5,"9f9jwg":85,tyfi80:85.5,"5tetxc":86,qcks8w:86.5,e52neo:87,xms4jk:87.5,"340sg0":88,ixdn9c:88.5,ctmku8:89,r91gqo:89.5,"74uwhs":90,oc5q80:90.5,gugow0:91,v9vksg:91.5,r48ow:92,kckkcg:92.5,awydc0:93,u26cqo:93.5,"4j7pj4":94,p2dnuo:94.5,exshds:95,zgyfpc:95.5,"3k94ow":96,hzo0lc:96.5,bvwy68:97,s1raps:97.5,"8mjpxc":98,n1ylts:98.5,fk9khs:99,wrke80:99.5,"1ju2o0":100},og=e=>{let t=e.indexOf(`_`);return t===-1?e:e.substring(t+1)},sg=e=>ag[og(e)]})),cg,bie=o((()=>{w(),$(),Ui(),E(),j(),O(),cg=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`AmazonHoldDisplay`,this._lookup=`AMZN_HOLD_DISP`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],cg.prototype,`run`,null),cg=D([C()],cg)})),lg,ug,dg=o((()=>{w(),$(),bt(),tU(),j(),E(),O(),ug=class{constructor(e){this._videoEventBus=e,T(this,`refreshingVideoBids`,new k),T(this,`requestingVideoBids`,new k)}addVideoSlots(e){this._videoEventBus.videoPlayerAdded.emit(e)}async requestVideoBids(e,t){await this.requestingVideoBids.legacyEmit(e).catch(),await this._determineIsRefreshing(e).catch(),await this._videoEventBus.preRequestVideoBids.legacyEmit({videos:e,timeout:t}),await this._videoEventBus.requestingVideoBids.legacyEmit({videos:e,timeout:t})}get amazonVideoBidResponseReceived(){return this._videoEventBus.amazonVideoBidResponseReceived}async _determineIsRefreshing(e){let t=e.filter(e=>e.prerollNum>0);t.length&&(this._generateNewUUIDsForPlayers(e),await this.refreshingVideoBids.legacyEmit(t))}_generateNewUUIDsForPlayers(e){e.forEach(e=>{e.refreshImpressionId()})}},ug=D([Q(`VideoRequestManager`),C(),A(`design:paramtypes`,[typeof(lg=eU!==void 0&&eU)==`function`?lg:Object])],ug)})),fg=o((()=>{dg()})),pg,mg=o((()=>{pg=e=>new Promise((t,n)=>{fetch(e).then(e=>{e.json().then(e=>t(e)).catch(()=>n(!1))}).catch(()=>n(!1))})})),hg,gg,_g,vg=o((()=>{w(),mg(),rU(),B(),$(),j(),E(),O(),_g=class{constructor(e,t){this._config=e,this._spaEventBus=t,T(this,`_name`,`iris`),T(this,`segmentName`,`www.iris.tv`),T(this,`segtax`,501),T(this,`_irisEndpoint`,`https://context.iris.tv/video_info`),T(this,`_token`,`5d8f38ad6d7de4253cfa501b84c30b1014868d9884be5d68dc64bd50a6edb54c`),T(this,`_clientToken`,`EXJQESR8SMWMZCJ`),T(this,`_contextualData`,void 0),T(this,`_irisId`,void 0),this._spaEventBus.routeChanged.on(()=>{this._resetIrisData()})}async setContextualData(e){return this.fetchIrisResponse(e).then(e=>{if(e&&typeof e!=`boolean`){let t=e.video_info,n=t&&t.context;n&&n.length&&(this._contextualData=n,this._irisId=t.iris_id)}return!0}).catch(()=>!1)}get irisContextualData(){return this._contextualData}get irisId(){return this._irisId}fetchIrisResponse(e){return pg(`${this._irisEndpoint}?access_token=${this._token}&client_token=${this._clientToken}&platform_id=${e}`)}_resetIrisData(){this._contextualData=void 0,this._irisId=void 0}get enabled(){return!this._config.tkho.tracker.includes(this._name)&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}},_g=D([Q(`IrisTvTrackerComponent`),C(),A(`design:paramtypes`,[typeof(hg=z!==void 0&&z)==`function`?hg:Object,typeof(gg=zr!==void 0&&zr)==`function`?gg:Object])],_g)})),yg,bg,xg,Sg=o((()=>{w(),B(),rU(),$(),H(),Z(),j(),E(),O(),xg=class extends V{constructor(e,t){super(),this._config=e,this._eventBus=t,T(this,`setMcmpWithRFCodes`,()=>new Promise(e=>{this._eventBus.recencyFrequencyDataSet.on(()=>{this.getAllMcmps(),e(!0)},{handleEventsAlreadyEmitted:!0})}))}getAllMcmps(){let e=this._config.marmalade;return[...e.mcmp.filter(e=>!e.startsWith(`SR_`)),...e.rfMcmpCodes.map(e=>e[0]),...e.rfIabCodes.map(e=>e[0])].filter(GW)}},xg=D([Q(`RecencyAndFrequencyCodesComponent`),S(),A(`design:paramtypes`,[typeof(yg=z!==void 0&&z)==`function`?yg:Object,typeof(bg=Rr!==void 0&&Rr)==`function`?bg:Object])],xg)})),Cg,xie=o((()=>{mU(),w(),O(),Cg=class extends pU{init(){this._key=`TTDDealFloor`,this._lookup=`TTDDEALFLR`}},Cg=D([C()],Cg)})),wg,Tg,Sie=o((()=>{wg=[`IAB25`,`IAB26`],Tg=new Map([[`alc`,[`IAB8-5`,`IAB8-18`]],[`ast`,[`IAB15-1`]],[`dat`,[`IAB14-1`]],[`gamc`,[`IAB9-5`]],[`gamv`,[`IAB9-30`]],[`pol`,[`IAB11-4`]],[`rel`,[`IAB23`]],[`ssr`,[`IAB7-39`]],[`srh`,[`IAB7-30`,`IAB6-7`,`IAB7-45`]],[`ske`,[`IAB7-19`]],[`tob`,[`IAB7-41`]],[`wtl`,[`IAB7-44`]]])})),Eg,Dg=o((()=>{mU(),$(),w(),j(),O(),Eg=class extends pU{init(){this._key=`PubmaticBCats`,this._lookup=`PUBBCAT`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],Eg.prototype,`run`,null),Eg=D([C()],Eg)})),Og,kg,Ag,jg,Mg,Ng,Pg,Fg,Ig,Lg,Rg,zg,Bg,Cie=o((()=>{w(),$h(),jc(),H(),B(),Ra(),$(),vh(),Z(),fg(),vg(),Sg(),Fn(),rU(),xie(),Sie(),Wr(),Dg(),j(),E(),O(),Bg=class extends V{get staticFirstPartyData(){return this._staticFirstPartyData}get staticIXFirstPartyData(){return this._staticIXFirstPartyData}constructor(e,t,n,r,i,a,o,s,c,l,u,d){super(),this._config=e,this._context=t,this._prebidMethods=n,this._videoRequestManager=r,this._irisTvTracker=i,this._rfcodes=a,this._spaEventBus=o,this._ttdDealFloorExperiment=s,this._slotManagerEventBus=c,this._pubMaticBcatExperiment=l,this._prebidEventBus=u,this._slots=d,T(this,`_staticFirstPartyData`,{mcmp:this._rfcodes.getAllMcmps(),site_id:[this._config.site.id],verticals:this._config.site.verticals,pmp_elig:[this._config.adOptions.pmp],sens:this._config.site.filteredSensitiveCategories}),T(this,`_staticIXFirstPartyData`,{site_code:this._config.marmalade.filteredSiteCodes,sens:this._config.site.filteredSensitiveCategories,topic:this._config.site.verticals,pd:`${this._config.adOptions.pmp?``:`no`}${this._context.device}`,pmp_elig:this._config.adOptions.pmp?`TRUE`:`FALSE`,source:``}),T(this,`_initOffEvent`,void 0);let f=hG(this._context.savedReferrer);this._staticIXFirstPartyData.source=zG(f),this._setMCMPData()}init(){this._onAddedEvent(),this._onRequestingEvent(),this._onRefreshingEvent(),this._onVideoRequestingEvent(),this._onVideoRefreshingEvent(),this._setGlobalFirstPartyData(),this._spaEventBus.routeChanged.on(()=>{this._onAddedEvent()})}async _setMCMPData(){await this._config.marmalade.marmaladeEventPromise,this._resetMCMPData()}_resetMCMPData(){this._staticFirstPartyData.mcmp=this._rfcodes.getAllMcmps()}_getTheTradeDeskPMPData(){let e=this._ttdDealFloorExperiment.result||`1`;e=e===`off`?`1`:e;let t=+e.replace(`_`,`.`),n=[{id:`opath-456-def-ryan`,at:1,bidfloor:10*t,bidfloorcur:`USD`,isVideo:!0},{id:`opath-123-abc-ryan`,at:1,bidfloor:2.5*t,bidfloorcur:`USD`,isVideo:!1}],r={deals:n,private_auction:0};return r}_getSiteExtData(e,t=!1){let n=this._updateMcmpWithScrollTargeting(e.mcmp);return t&&n&&(e.mcmp=n),{ext:{data:e}}}_onAddedEvent(){this._slotManagerEventBus.added.once(e=>{let t=this._getBlockedCategories(),n=this._getTheTradeDeskPMPData();this._setPrebidBidderSpecificFirstPartyData([P.TTD],{pmp:n,site:this._getSiteExtData({site_code:this._config.marmalade.filteredSiteCodes}),bcat:t});let r=this._slots.get(e[0]),i=this._context.bucket,a=uG(r).toString(),o=this._getIXFirstPartyData({refresh:`0`,vp:`0`});this._setPrebidBidderSpecificFirstPartyData([P.IndexExchange,P.IndexExchangeServer],{site:this._getSiteExtData(o,!0)});let s=this._getSiteExtData({site_code:this._config.marmalade.filteredSiteCodes,refresh:[`false`],vp:`0`,bucket:i},!0);this._setPrebidBidderSpecificFirstPartyData([P.Rubicon,P.RubiconServer],{site:s});let c=this._getSiteExtData({refresh:`0`,vp:`0`,hvp:a,site_code:this._config.marmalade.filteredSiteCodes});this._setPrebidBidderSpecificFirstPartyData([P.OpenX,P.OpenXServer],{site:c,bcat:t}),this._setPrebidBidderSpecificFirstPartyData([P.Kargo],{bcat:t}),this._pubMaticBcatExperiment.result!==`nobc`&&this._setPrebidBidderSpecificFirstPartyData([P.Pubmatic,P.PubmaticServer],{bcat:t});let l=this._getSiteExtData({site_code:this._config.marmalade.filteredSiteCodes,vp:`0`,hvp:a,refresh:`0`});this._setPrebidBidderSpecificFirstPartyData([P.Triplelift,P.TripleliftServer],{site:l}),this._setPrebidBidderSpecificFirstPartyData([P.Ogury],{site:{publisher:{id:`f48f1699-39f7-40c5-8aef-1e5255be6d5e`}}})})}_getBlockedCategories(){let e=[...Tg.keys()].filter(e=>!this._config.site.filteredSensitiveCategories.includes(e)),t=e.reduce((e,t)=>e.concat(Tg.get(t)||[]),[]);return[...t,...wg]}_onRequestingEvent(){this._slotManagerEventBus.requestingBids.on(e=>{let t=this._slots.get(e);t.forEach(e=>{this.setIXHVPParam(e,this._prebidMethods)});let n=this._context.bucket,r=uG(t[0]).toString(),i=this._getIXFirstPartyData({refresh:`0`,vp:`0`});this._setPrebidBidderSpecificFirstPartyData([P.IndexExchange,P.IndexExchangeServer],{site:this._getSiteExtData(i,!0)});let a=this._getSiteExtData({site_code:this._config.marmalade.filteredSiteCodes,refresh:[`false`],vp:`0`,bucket:n},!0);this._setPrebidBidderSpecificFirstPartyData([P.Rubicon,P.RubiconServer],{site:a});let o=this._getSiteExtData({refresh:`0`,vp:`0`,hvp:r,site_code:this._config.marmalade.filteredSiteCodes});this._setPrebidBidderSpecificFirstPartyData([P.OpenX,P.OpenXServer],{site:o});let s=this._getSiteExtData({site_code:this._config.marmalade.filteredSiteCodes,vp:`0`,hvp:r,refresh:`0`});this._setPrebidBidderSpecificFirstPartyData([P.Triplelift,P.TripleliftServer],{site:s})})}_onRefreshingEvent(){this._slotManagerEventBus.refreshingBids.on(e=>{var t;let n=this._slots.get(e);n.forEach(e=>{this.setIXHVPParam(e,this._prebidMethods)});let r=n[0]&&((t=n[0])==null?void 0:t.refreshCount),i=uG(n[0]).toString(),a=this._context.bucket,o=this._getSiteExtData({site_code:this._config.marmalade.filteredSiteCodes,refresh:[`true`],vp:`0`,bucket:a},!0);this._setPrebidBidderSpecificFirstPartyData([P.Rubicon,P.RubiconServer],{site:o});let s=this._getIXFirstPartyData({refresh:`${r}`,vp:`0`});this._setPrebidBidderSpecificFirstPartyData([P.IndexExchange,P.IndexExchangeServer],{site:this._getSiteExtData(s,!0)});let c=this._getSiteExtData({refresh:`${r}`,vp:`0`,hvp:i,site_code:this._config.marmalade.filteredSiteCodes});this._setPrebidBidderSpecificFirstPartyData([P.OpenX,P.OpenXServer],{site:c});let l=this._getSiteExtData({site_code:this._config.marmalade.filteredSiteCodes,vp:`0`,hvp:i,refresh:`${r}`});this._setPrebidBidderSpecificFirstPartyData([P.Triplelift,P.TripleliftServer],{site:l})})}_onVideoRequestingEvent(){this._videoRequestManager.requestingVideoBids.on(e=>{e.forEach(()=>{let e=this._irisTvTracker,t=this._irisTvTracker.enabled?e.irisContextualData:void 0;if(t!=null&&t.length){let t={content:{id:e.irisId}};this._setPrebidBidderSpecificFirstPartyData([P.Pubmatic,P.PubmaticServer],{site:t})}})})}_onVideoRefreshingEvent(){this._videoRequestManager.refreshingVideoBids.on(e=>{let t=this._context.bucket;e.forEach(e=>{if(e.vp>0&&e.prerollNum<=10){let n=e.vp.toString(),r=this._getSiteExtData({site_code:this._config.marmalade.filteredSiteCodes,refresh:[`true`],vp:n,bucket:t},!0);this._setPrebidBidderSpecificFirstPartyData([P.Rubicon,P.RubiconServer],{site:r});let i=this._getIXFirstPartyData({refresh:`${e.prerollNum}`,vp:n});this._setPrebidBidderSpecificFirstPartyData([P.IndexExchange,P.IndexExchangeServer],{site:this._getSiteExtData(i,!0)});let a=this._getSiteExtData({refresh:`${e.prerollNum}`,vp:n,site_code:this._config.marmalade.filteredSiteCodes});this._setPrebidBidderSpecificFirstPartyData([P.OpenX,P.OpenXServer],{site:a});let o=this._getSiteExtData({site_code:this._config.marmalade.filteredSiteCodes,vp:n,refresh:`${e.prerollNum}`});this._setPrebidBidderSpecificFirstPartyData([P.Triplelift,P.TripleliftServer],{site:o}),this._prebidMethods.addToQueue(()=>{this.setIXVPParam(e.vp)})}})})}_getIXFirstPartyData(e){let t=this._setupIXFirstPartyData(e);return t}setIXHVPParam(e,t){Zh.pushToQueue(()=>{t.addToQueue(()=>{let n=t.getConfig(P.IndexExchange);if(n&&n.firstPartyData){let r=n.firstPartyData.HVP||{},i=uG(e),a=dG(i||0);r[e.id]=a,e.refreshCount>0?IG({HVP:r,Refresh:`True`},t):IG({HVP:r},t,!0)}})})}setIXVPParam(e){let t=this._prebidMethods.getConfig(P.IndexExchange);t&&t.firstPartyData&&e>0&&IG({vp:e.toString()},this._prebidMethods)}_setupIXFirstPartyData(e){return{...e,...this.staticIXFirstPartyData}}_removeInitEvent(){var e;(e=this._initOffEvent)==null||e.call(this)}_awaitPrebidInit(){return new Promise(e=>{this._initOffEvent=this._prebidEventBus.initialized.on(()=>{e(),this._removeInitEvent()},{handleEventsAlreadyEmitted:!0})})}async _setGlobalFirstPartyData(){await this._awaitPrebidInit(),this._config.marmalade.rfDataProcessed.emitted||this._rfcodes.setMcmpWithRFCodes().then(()=>{this._resetMCMPData(),this._setPrebidGlobalFirstPartyData()}).catch(()=>{}),this._setPrebidGlobalFirstPartyData()}_setPrebidGlobalFirstPartyData(){this._prebidMethods.addToQueue(()=>{var e;let t=this._prebidMethods.getConfig(`ortb2`),n={...t,ext:{...t.ext,rpbs:{exp:this._config.prebid.pbsExperimentsResultsByLookupKey}},site:{...t.site,ext:{data:{...(e=t.site)==null||(e=e.ext)==null?void 0:e.data,...this.staticFirstPartyData}}}};this._prebidMethods.setConfig({ortb2:n})})}_setPrebidBidderSpecificFirstPartyData(e,t){this._prebidMethods.setBidderConfig({bidders:e,config:{ortb2:t}})}_updateMcmpWithScrollTargeting(e){let t=this._config.trackScroll.getTargetingValue();return t?e?[...e,...t]:[...t]:e}},Bg=D([Q(`FirstPartyDataComponent`),C(),A(`design:paramtypes`,[typeof(Og=z!==void 0&&z)==`function`?Og:Object,typeof(kg=L!==void 0&&L)==`function`?kg:Object,typeof(Ag=R!==void 0&&R)==`function`?Ag:Object,typeof(jg=ug!==void 0&&ug)==`function`?jg:Object,typeof(Mg=_g!==void 0&&_g)==`function`?Mg:Object,typeof(Ng=xg!==void 0&&xg)==`function`?Ng:Object,typeof(Pg=zr!==void 0&&zr)==`function`?Pg:Object,typeof(Fg=Cg!==void 0&&Cg)==`function`?Fg:Object,typeof(Ig=Ur!==void 0&&Ur)==`function`?Ig:Object,typeof(Lg=Eg!==void 0&&Eg)==`function`?Lg:Object,typeof(Rg=Pr!==void 0&&Pr)==`function`?Rg:Object,typeof(zg=_h!==void 0&&_h)==`function`?zg:Object])],Bg)})),Vg=o((()=>{Cie()}));function wie(){this.__data__=[],this.size=0}var Tie=o((()=>{}));function Hg(e,t){return e===t||e!==e&&t!==t}var Ug=o((()=>{}));function Wg(e,t){for(var n=e.length;n--;)if(Hg(e[n][0],t))return n;return-1}var Gg=o((()=>{Ug()}));function Eie(e){var t=this.__data__,n=Wg(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():qg.call(t,n,1),--this.size,!0}var Kg,qg,Die=o((()=>{Gg(),Kg=Array.prototype,qg=Kg.splice}));function Oie(e){var t=this.__data__,n=Wg(t,e);return n<0?void 0:t[n][1]}var kie=o((()=>{Gg()}));function Aie(e){return Wg(this.__data__,e)>-1}var jie=o((()=>{Gg()}));function Mie(e,t){var n=this.__data__,r=Wg(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var Nie=o((()=>{Gg()}));function Jg(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var Yg=o((()=>{Tie(),Die(),kie(),jie(),Nie(),Jg.prototype.clear=wie,Jg.prototype.delete=Eie,Jg.prototype.get=Oie,Jg.prototype.has=Aie,Jg.prototype.set=Mie}));function Pie(){this.__data__=new Jg,this.size=0}var Fie=o((()=>{Yg()}));function Iie(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var Lie=o((()=>{}));function Rie(e){return this.__data__.get(e)}var zie=o((()=>{}));function Bie(e){return this.__data__.has(e)}var Vie=o((()=>{}));function Xg(e){if(!Co(e))return!1;var t=Vo(e);return t==Qg||t==$g||t==Zg||t==e_}var Zg,Qg,$g,e_,t_=o((()=>{Go(),wo(),Zg=`[object AsyncFunction]`,Qg=`[object Function]`,$g=`[object GeneratorFunction]`,e_=`[object Proxy]`})),n_,Hie=o((()=>{ko(),n_=Oo[`__core-js_shared__`]}));function Uie(e){return!!r_&&r_ in e}var r_,Wie=o((()=>{Hie(),r_=function(){var e=/[^.]+$/.exec(n_&&n_.keys&&n_.keys.IE_PROTO||``);return e?`Symbol(src)_1.`+e:``}()}));function i_(e){if(e!=null){try{return o_.call(e)}catch(e){}try{return e+``}catch(e){}}return``}var a_,o_,s_=o((()=>{a_=Function.prototype,o_=a_.toString}));function Gie(e){if(!Co(e)||Uie(e))return!1;var t=Xg(e)?m_:l_;return t.test(i_(e))}var c_,l_,u_,d_,f_,p_,m_,Kie=o((()=>{t_(),Wie(),wo(),s_(),c_=/[\\^$.*+?()[\]{}|]/g,l_=/^\[object .+?Constructor\]$/,u_=Function.prototype,d_=Object.prototype,f_=u_.toString,p_=d_.hasOwnProperty,m_=RegExp(`^`+f_.call(p_).replace(c_,`\\$&`).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,`$1.*?`)+`$`)}));function qie(e,t){return e==null?void 0:e[t]}var Jie=o((()=>{}));function h_(e,t){var n=qie(e,t);return Gie(n)?n:void 0}var g_=o((()=>{Kie(),Jie()})),__,v_=o((()=>{g_(),ko(),__=h_(Oo,`Map`)})),y_,b_=o((()=>{g_(),y_=h_(Object,`create`)}));function Yie(){this.__data__=y_?y_(null):{},this.size=0}var Xie=o((()=>{b_()}));function Zie(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Qie=o((()=>{}));function $ie(e){var t=this.__data__;if(y_){var n=t[e];return n===x_?void 0:n}return C_.call(t,e)?t[e]:void 0}var x_,S_,C_,eae=o((()=>{b_(),x_=`__lodash_hash_undefined__`,S_=Object.prototype,C_=S_.hasOwnProperty}));function tae(e){var t=this.__data__;return y_?t[e]!==void 0:T_.call(t,e)}var w_,T_,nae=o((()=>{b_(),w_=Object.prototype,T_=w_.hasOwnProperty}));function rae(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=y_&&t===void 0?E_:t,this}var E_,iae=o((()=>{b_(),E_=`__lodash_hash_undefined__`}));function D_(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var aae=o((()=>{Xie(),Qie(),eae(),nae(),iae(),D_.prototype.clear=Yie,D_.prototype.delete=Zie,D_.prototype.get=$ie,D_.prototype.has=tae,D_.prototype.set=rae}));function oae(){this.size=0,this.__data__={hash:new D_,map:new(__||Jg),string:new D_}}var sae=o((()=>{aae(),Yg(),v_()}));function cae(e){var t=typeof e;return t==`string`||t==`number`||t==`symbol`||t==`boolean`?e!==`__proto__`:e===null}var lae=o((()=>{}));function O_(e,t){var n=e.__data__;return cae(t)?n[typeof t==`string`?`string`:`hash`]:n.map}var k_=o((()=>{lae()}));function uae(e){var t=O_(this,e).delete(e);return this.size-=t?1:0,t}var dae=o((()=>{k_()}));function fae(e){return O_(this,e).get(e)}var pae=o((()=>{k_()}));function mae(e){return O_(this,e).has(e)}var hae=o((()=>{k_()}));function gae(e,t){var n=O_(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var _ae=o((()=>{k_()}));function A_(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var j_=o((()=>{sae(),dae(),pae(),hae(),_ae(),A_.prototype.clear=oae,A_.prototype.delete=uae,A_.prototype.get=fae,A_.prototype.has=mae,A_.prototype.set=gae}));function vae(e,t){var n=this.__data__;if(n instanceof Jg){var r=n.__data__;if(!__||r.length<M_-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new A_(r)}return n.set(e,t),this.size=n.size,this}var M_,yae=o((()=>{Yg(),v_(),j_(),M_=200}));function N_(e){var t=this.__data__=new Jg(e);this.size=t.size}var P_=o((()=>{Yg(),Fie(),Lie(),zie(),Vie(),yae(),N_.prototype.clear=Pie,N_.prototype.delete=Iie,N_.prototype.get=Rie,N_.prototype.has=Bie,N_.prototype.set=vae})),F_,I_=o((()=>{g_(),F_=function(){try{var e=h_(Object,`defineProperty`);return e({},``,{}),e}catch(e){}}()}));function L_(e,t,n){t==`__proto__`&&F_?F_(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var R_=o((()=>{I_()}));function z_(e,t,n){(n!==void 0&&!Hg(e[t],n)||n===void 0&&!(t in e))&&L_(e,t,n)}var B_=o((()=>{R_(),Ug()}));function bae(e){return function(t,n,r){for(var i=-1,a=Object(t),o=r(t),s=o.length;s--;){var c=o[e?s:++i];if(n(a[c],c,a)===!1)break}return t}}var xae=o((()=>{})),V_,Sae=o((()=>{xae(),V_=bae()}));function H_(e,t){if(t)return e.slice();var n=e.length,r=q_?q_(n):new e.constructor(n);return e.copy(r),r}var U_,W_,G_,K_,q_,J_=o((()=>{ko(),U_=typeof exports==`object`&&exports&&!exports.nodeType&&exports,W_=U_&&typeof module==`object`&&module&&!module.nodeType&&module,G_=W_&&W_.exports===U_,K_=G_?Oo.Buffer:void 0,q_=K_?K_.allocUnsafe:void 0})),Y_,X_=o((()=>{ko(),Y_=Oo.Uint8Array}));function Z_(e){var t=new e.constructor(e.byteLength);return new Y_(t).set(new Y_(e)),t}var Q_=o((()=>{X_()}));function $_(e,t){var n=t?Z_(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var ev=o((()=>{Q_()}));function tv(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var nv=o((()=>{})),rv,iv,Cae=o((()=>{wo(),rv=Object.create,iv=function(){function e(){}return function(t){if(!Co(t))return{};if(rv)return rv(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}()}));function av(e,t){return function(n){return e(t(n))}}var ov=o((()=>{})),sv,cv=o((()=>{ov(),sv=av(Object.getPrototypeOf,Object)}));function lv(e){var t=e&&e.constructor,n=typeof t==`function`&&t.prototype||uv;return e===n}var uv,dv=o((()=>{uv=Object.prototype}));function fv(e){return typeof e.constructor==`function`&&!lv(e)?iv(sv(e)):{}}var pv=o((()=>{Cae(),cv(),dv()}));function mv(e){return Ko(e)&&Vo(e)==hv}var hv,wae=o((()=>{Go(),qo(),hv=`[object Arguments]`})),gv,_v,vv,yv,bv=o((()=>{wae(),qo(),gv=Object.prototype,_v=gv.hasOwnProperty,vv=gv.propertyIsEnumerable,yv=mv(function(){return arguments}())?mv:function(e){return Ko(e)&&_v.call(e,`callee`)&&!vv.call(e,`callee`)}})),xv,Sv=o((()=>{xv=Array.isArray}));function Cv(e){return typeof e==`number`&&e>-1&&e%1==0&&e<=wv}var wv,Tv=o((()=>{wv=9007199254740991}));function Ev(e){return e!=null&&Cv(e.length)&&!Xg(e)}var Dv=o((()=>{t_(),Tv()}));function Tae(e){return Ko(e)&&Ev(e)}var Eae=o((()=>{Dv(),qo()}));function Dae(){return!1}var Oae=o((()=>{})),Ov,kv,Av,jv,Mv,Nv,Pv=o((()=>{ko(),Oae(),Ov=typeof exports==`object`&&exports&&!exports.nodeType&&exports,kv=Ov&&typeof module==`object`&&module&&!module.nodeType&&module,Av=kv&&kv.exports===Ov,jv=Av?Oo.Buffer:void 0,Mv=jv?jv.isBuffer:void 0,Nv=Mv||Dae}));function kae(e){if(!Ko(e)||Vo(e)!=Fv)return!1;var t=sv(e);if(t===null)return!0;var n=zv.call(t,`constructor`)&&t.constructor;return typeof n==`function`&&n instanceof n&&Rv.call(n)==Bv}var Fv,Iv,Lv,Rv,zv,Bv,Aae=o((()=>{Go(),cv(),qo(),Fv=`[object Object]`,Iv=Function.prototype,Lv=Object.prototype,Rv=Iv.toString,zv=Lv.hasOwnProperty,Bv=Rv.call(Object)}));function jae(e){return Ko(e)&&Cv(e.length)&&!!dy[Vo(e)]}var Vv,Hv,Uv,Wv,Gv,Kv,qv,Jv,Yv,Xv,Zv,Qv,$v,ey,ty,ny,ry,iy,ay,oy,sy,cy,ly,uy,dy,Mae=o((()=>{Go(),Tv(),qo(),Vv=`[object Arguments]`,Hv=`[object Array]`,Uv=`[object Boolean]`,Wv=`[object Date]`,Gv=`[object Error]`,Kv=`[object Function]`,qv=`[object Map]`,Jv=`[object Number]`,Yv=`[object Object]`,Xv=`[object RegExp]`,Zv=`[object Set]`,Qv=`[object String]`,$v=`[object WeakMap]`,ey=`[object ArrayBuffer]`,ty=`[object DataView]`,ny=`[object Float32Array]`,ry=`[object Float64Array]`,iy=`[object Int8Array]`,ay=`[object Int16Array]`,oy=`[object Int32Array]`,sy=`[object Uint8Array]`,cy=`[object Uint8ClampedArray]`,ly=`[object Uint16Array]`,uy=`[object Uint32Array]`,dy={},dy[ny]=dy[ry]=dy[iy]=dy[ay]=dy[oy]=dy[sy]=dy[cy]=dy[ly]=dy[uy]=!0,dy[Vv]=dy[Hv]=dy[ey]=dy[Uv]=dy[ty]=dy[Wv]=dy[Gv]=dy[Kv]=dy[qv]=dy[Jv]=dy[Yv]=dy[Xv]=dy[Zv]=dy[Qv]=dy[$v]=!1}));function fy(e){return function(t){return e(t)}}var py=o((()=>{})),my,hy,gy,_y,vy,yy=o((()=>{Eo(),my=typeof exports==`object`&&exports&&!exports.nodeType&&exports,hy=my&&typeof module==`object`&&module&&!module.nodeType&&module,gy=hy&&hy.exports===my,_y=gy&&To.process,vy=function(){try{var e=hy&&hy.require&&hy.require(`util`).types;return e||_y&&_y.binding&&_y.binding(`util`)}catch(e){}}()})),by,xy,Sy=o((()=>{Mae(),py(),yy(),by=vy&&vy.isTypedArray,xy=by?fy(by):jae}));function Cy(e,t){if(!(t===`constructor`&&typeof e[t]==`function`)&&t!=`__proto__`)return e[t]}var wy=o((()=>{}));function Ty(e,t,n){var r=e[t];(!(Dy.call(e,t)&&Hg(r,n))||n===void 0&&!(t in e))&&L_(e,t,n)}var Ey,Dy,Oy=o((()=>{R_(),Ug(),Ey=Object.prototype,Dy=Ey.hasOwnProperty}));function ky(e,t,n,r){var i=!n;n||(n={});for(var a=-1,o=t.length;++a<o;){var s=t[a],c=r?r(n[s],e[s],s,n,e):void 0;c===void 0&&(c=e[s]),i?L_(n,s,c):Ty(n,s,c)}return n}var Ay=o((()=>{Oy(),R_()}));function Nae(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var Pae=o((()=>{}));function jy(e,t){var n=typeof e;return t=t==null?My:t,!!t&&(n==`number`||n!=`symbol`&&Ny.test(e))&&e>-1&&e%1==0&&e<t}var My,Ny,Py=o((()=>{My=9007199254740991,Ny=/^(?:0|[1-9]\d*)$/}));function Fy(e,t){var n=xv(e),r=!n&&yv(e),i=!n&&!r&&Nv(e),a=!n&&!r&&!i&&xy(e),o=n||r||i||a,s=o?Nae(e.length,String):[],c=s.length;for(var l in e)(t||Ly.call(e,l))&&!(o&&(l==`length`||i&&(l==`offset`||l==`parent`)||a&&(l==`buffer`||l==`byteLength`||l==`byteOffset`)||jy(l,c)))&&s.push(l);return s}var Iy,Ly,Ry=o((()=>{Pae(),bv(),Sv(),Pv(),Py(),Sy(),Iy=Object.prototype,Ly=Iy.hasOwnProperty}));function Fae(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var Iae=o((()=>{}));function Lae(e){if(!Co(e))return Fae(e);var t=lv(e),n=[];for(var r in e)r==`constructor`&&(t||!By.call(e,r))||n.push(r);return n}var zy,By,Rae=o((()=>{wo(),dv(),Iae(),zy=Object.prototype,By=zy.hasOwnProperty}));function Vy(e){return Ev(e)?Fy(e,!0):Lae(e)}var Hy=o((()=>{Ry(),Rae(),Dv()}));function zae(e){return ky(e,Vy(e))}var Bae=o((()=>{Ay(),Hy()}));function Vae(e,t,n,r,i,a,o){var s=Cy(e,n),c=Cy(t,n),l=o.get(c);if(l){z_(e,n,l);return}var u=a?a(s,c,n+``,e,t,o):void 0,d=u===void 0;if(d){var f=xv(c),p=!f&&Nv(c),m=!f&&!p&&xy(c);u=c,f||p||m?xv(s)?u=s:Tae(s)?u=tv(s):p?(d=!1,u=H_(c,!0)):m?(d=!1,u=$_(c,!0)):u=[]:kae(c)||yv(c)?(u=s,yv(s)?u=zae(s):(!Co(s)||Xg(s))&&(u=fv(c))):d=!1}d&&(o.set(c,u),i(u,c,r,a,o),o.delete(c)),z_(e,n,u)}var Hae=o((()=>{B_(),J_(),ev(),nv(),pv(),bv(),Sv(),Eae(),Pv(),t_(),wo(),Aae(),Sy(),wy(),Bae()}));function Uy(e,t,n,r,i){e!==t&&V_(t,function(a,o){if(i||(i=new N_),Co(a))Vae(e,t,o,n,Uy,r,i);else{var s=r?r(Cy(e,o),a,o+``,e,t,i):void 0;s===void 0&&(s=a),z_(e,o,s)}},Vy)}var Uae=o((()=>{P_(),B_(),Sae(),Hae(),wo(),Hy(),wy()}));function Wy(e){return e}var Gy=o((()=>{}));function Wae(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var Gae=o((()=>{}));function Kae(e,t,n){return t=Ky(t===void 0?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=Ky(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(o),Wae(e,this,s)}}var Ky,qae=o((()=>{Gae(),Ky=Math.max}));function Jae(e){return function(){return e}}var Yae=o((()=>{})),qy,Xae=o((()=>{Yae(),I_(),Gy(),qy=F_?function(e,t){return F_(e,`toString`,{configurable:!0,enumerable:!1,value:Jae(t),writable:!0})}:Wy}));function Zae(e){var t=0,n=0;return function(){var r=Xy(),i=Yy-(r-n);if(n=r,i>0){if(++t>=Jy)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Jy,Yy,Xy,Qae=o((()=>{Jy=800,Yy=16,Xy=Date.now})),Zy,$ae=o((()=>{Xae(),Qae(),Zy=Zae(qy)}));function eoe(e,t){return Zy(Kae(e,t,Wy),e+``)}var toe=o((()=>{Gy(),qae(),$ae()}));function noe(e,t,n){if(!Co(n))return!1;var r=typeof t;return(r==`number`?Ev(n)&&jy(t,n.length):r==`string`&&t in n)?Hg(n[t],e):!1}var roe=o((()=>{Ug(),Dv(),Py(),wo()}));function ioe(e){return eoe(function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(a=e.length>3&&typeof a==`function`?(i--,a):void 0,o&&noe(n[0],n[1],o)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,a)}return t})}var aoe=o((()=>{toe(),roe()})),Qy,ooe=o((()=>{Uae(),aoe(),Qy=ioe(function(e,t,n){Uy(e,t,n)})})),$y,soe=o((()=>{mU(),w(),O(),$y=class extends pU{init(){this._key=`AdInViewExperiment_2`,this._lookup=`AINV2`}},$y=D([C()],$y)})),eb,coe=o((()=>{w(),mU(),O(),eb=class extends pU{init(){this._key=`SizeOrder2`,this._lookup=`SO2`}},eb=D([C()],eb)})),tb,loe=o((()=>{tb=new Map([[`300x250`,1],[`320x50`,2],[`728x90`,3],[`300x600`,4],[`300x50`,5],[`336x280`,6],[`1x1`,7],[`160x600`,8],[`320x300`,9],[`300x300`,10],[`320x100`,11],[`552x334`,12],[`970x90`,13],[`300x420`,14],[`300x390`,15],[`970x950`,16],[`250x250`,17],[`468x60`,18],[`1x2`,19],[`320x480`,20],[`120x240`,21],[`728x4100`,22],[`*`,23]])})),nb,uoe=o((()=>{w(),mU(),O(),nb=class extends pU{init(){this._key=`BannerWidthHeight`,this._lookup=`BWH`}},nb=D([C()],nb)})),rb,doe=o((()=>{w(),Ui(),E(),O(),rb=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`OpenBiddingTrafficShaping`,this._lookup=`OBTS`}},rb=D([C()],rb)})),ib,ab,foe=o((()=>{E(),ib={Recipe:`Recipe`,Video:`Video`},ab=class{constructor(){T(this,`_hasFired`,!1),T(this,`_buttonClicked`,void 0),T(this,`listeners`,[]),T(this,`elements`,[]),this._buttonClicked=this._processButtonClicked.bind(this)}init(e){this.listeners=e,this._addElementListeners()}_processButtonClicked(e){if(!this._hasFired)for(let t of this.listeners)t(e);this._cleanup()}_cleanup(){for(let e of this.elements)e.removeEventListener(`click`,this._buttonClicked)}_addElementListeners(){this.setElementsListeners()}setElementsListeners(){for(let e of this.elements)e.addEventListener(`click`,this._buttonClicked)}}})),ob,sb=o((()=>{w(),foe(),bt(),Lt(),j(),E(),O(),ob=class extends ab{constructor(){super(),T(this,`selectors`,[`.wprm-recipe-jump`,`#jump-to-recipe`,`#wprm-jump`,`.wprm-jump`,`.tasty-recipes-jump-link`,`.mv-create-jtr`,`.jump-to-recipe`]),T(this,`onJumpToRecipeClicked`,new yt),this.elements=Array.prototype.slice.call(document.querySelectorAll(this.selectors.join()))}start(e){let t=()=>{this.onJumpToRecipeClicked.emit()},n=[t];if(e){let e=e=>{let t=e.target.classList;M.event(`JumpToTracker`,`_logEvent`,ib.Recipe.toLowerCase(),t)};n.push(e)}this.init(n)}},ob=D([C(),A(`design:paramtypes`,[])],ob)})),poe,moe,cb,hoe=o((()=>{sb(),bt(),w(),Z(),B(),X(),al(),j(),E(),O(),cb=class{constructor(e,t){this._jumpToRecipeTracker=e,T(this,`_isFoodVertical`,void 0),T(this,`_jumpToRecipeElementsOnPage`,!1),T(this,`_allowSlotsToBeFiltered`,!1),T(this,`_onJumpToRecipeTrackerClicked`,new yt),T(this,`_allowSlotsToBeAdded`,!1),T(this,`preventedSlotsFromBeingAdded`,new yt),this._isFoodVertical=!!t.verticals.find(e=>e.toLowerCase()===`food`),this._jumpToRecipeElementsOnPage=!!e.elements.length,this._jumpToRecipeTracker.onJumpToRecipeClicked.on(()=>{this._allowSlotsToBeFiltered=!0,this._onJumpToRecipeTrackerClicked.emit(),setTimeout(()=>{this._allowSlotsToBeFiltered=!1},500)},{handleEventsAlreadyEmitted:!0})}slotsFilter(e){return e.location===F.Content&&e.sequence&&e.sequence<=3}preventSlotsBeingAdded(e){this.preventedSlotsFromBeingAdded.emit(e)}determineSlotsToAddAndRemove(e){let t=[];return this.enabled&&this._allowSlotsToBeFiltered&&(e=e.filter(e=>{let n=this.slotsFilter(e);return n&&e.getPositionFromViewport()<=-2?(t.push(e),!1):!0})),{addSlots:e,removeSlots:t}}get enabled(){return!il.isRolloutEnabled(`ios-manage-content-slots`)&&tG()&&Oi()&&this._isFoodVertical&&this._jumpToRecipeElementsOnPage}},cb=D([C(),A(`design:paramtypes`,[typeof(poe=ob!==void 0&&ob)==`function`?poe:Object,typeof(moe=qa!==void 0&&qa)==`function`?moe:Object])],cb)})),lb,goe=o((()=>{Ui(),$(),w(),E(),j(),O(),lb=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`MagniteBotTraffic`,this.abgroup=`mgbtff`,this._lookup=`MGBTFF`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],lb.prototype,`run`,null),lb=D([C()],lb)})),ub,db=o((()=>{ub=class{get _config(){return this.config}get enabled(){return!0}}})),_oe,voe,yoe,boe,xoe,fb,Soe=o((()=>{Ns(),tf(),Fs(),db(),w(),$(),Da(),ya(),j(),E(),O(),fb=class extends ub{constructor(e,t,n,r,i){super(),this._ccpa=e,this._gpc=t,this._idho=n,this._liveRampAts=r,this._shareHemWithUserIdModule=i,T(this,`config`,void 0),T(this,`_name`,`connectId`),T(this,`targetingKey`,`cid`),T(this,`eidSource`,`yahoo.com`),T(this,`storageKey`,`connectId`);let a=Os();this.config={name:this._name,params:{pixelId:58404,...a&&{puid:a}}},this.setHash()}async setHash(){let e=await this._shareHemWithUserIdModule.share();typeof e==`string`&&(this.config={...this.config,params:{...this.config.params,he:e}})}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`connectId`)&&this._liveRampAts.enabled}},fb=D([Q(`ConnectIdModule`),C(),A(`design:paramtypes`,[typeof(_oe=Ea!==void 0&&Ea)==`function`?_oe:Object,typeof(voe=va!==void 0&&va)==`function`?voe:Object,typeof(yoe=Ms!==void 0&&Ms)==`function`?yoe:Object,typeof(boe=ef!==void 0&&ef)==`function`?boe:Object,typeof(xoe=Es!==void 0&&Es)==`function`?xoe:Object])],fb)})),pb,mb,hb,gb,Coe=o((()=>{w(),Ns(),Fs(),db(),$(),ya(),Da(),j(),E(),O(),gb=class extends ub{constructor(e,t,n){super(),this._ccpa=e,this._gpc=t,this._idho=n,T(this,`config`,void 0),T(this,`_name`,`unifiedId`),T(this,`targetingKey`,`uid1`),T(this,`eidSource`,`adserver.org`),T(this,`eidSourceAlias`,`adsrvr.org`),this.config={name:this._name,params:{url:`https://match.adsrvr.org/track/rid?ttd_pid=iowij76&fmt=json`},storage:{type:`html5`,name:`pbjs-unifiedid`,expires:60}}}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`unifiedId`)}},gb=D([Q(`UnifiedIdModule`),C(),A(`design:paramtypes`,[typeof(pb=Ea!==void 0&&Ea)==`function`?pb:Object,typeof(mb=va!==void 0&&va)==`function`?mb:Object,typeof(hb=Ms!==void 0&&Ms)==`function`?hb:Object])],gb)})),_b,vb=o((()=>{_b=e=>{let t=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,n=/^((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){1,7}:)|(([0-9A-Fa-f]{1,4}:){1,6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,5}(:[0-9A-Fa-f]{1,4}){1,2})|(([0-9A-Fa-f]{1,4}:){1,4}(:[0-9A-Fa-f]{1,4}){1,3})|(([0-9A-Fa-f]{1,4}:){1,3}(:[0-9A-Fa-f]{1,4}){1,4})|(([0-9A-Fa-f]{1,4}:){1,2}(:[0-9A-Fa-f]{1,4}){1,5})|([0-9A-Fa-f]{1,4}:((:[0-9A-Fa-f]{1,4}){1,6}))|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4}))$/;return t.test(e)?`IPv4`:n.test(e)||e===`::`?`IPv6`:`Invalid`}})),yb,bb=o((()=>{Ui(),w(),$(),E(),j(),O(),yb=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`CFIdParHoldout`,this._lookup=`CFIP_IDPHO`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],yb.prototype,`run`,null),yb=D([C()],yb)})),xb,Sb,Cb,wb,Tb,Eb,Db,woe=o((()=>{w(),Cs(),Pp(),Fs(),db(),Z(),$(),Da(),ya(),vb(),bb(),j(),E(),O(),Db=class extends ub{constructor(e,t,n,r,i,a){super(),this._ccpa=e,this._gpc=t,this._audienceTargeting=n,this._user=r,this._shareHemWithUserIdModule=i,this._cloudflareIdPartnerExpHo=a,T(this,`config`,void 0),T(this,`_name`,`id5Id`),T(this,`targetingKey`,`id5-d`),T(this,`eidSource`,`id5-sync.com`),this.config={name:this._name,params:{partner:367,externalModuleUrl:`https://cdn.id5-sync.com/api/1.0/id5PrebidModule.js`},storage:{type:`html5`,name:`id5id`,expires:90,refreshInSeconds:7200}},this.setPd()}async setPd(){let e=await this.getPdString();this.config={...this.config,params:{...this.config.params,pd:e}}}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&this._audienceTargeting.id5Enabled}async getPdString(e){var t;let n=(t=this._user.rcid)==null?void 0:t.metadata.clientIp,r=_b(n||``),i=await this._shareHemWithUserIdModule.share({blockGraphHem:!0}),a=this._cloudflareIdPartnerExpHo.result,o=[{key:5,value:Os()},{key:12,value:Kt}];typeof i==`string`&&o.push({key:1,value:e==null?i:e}),a&&r===`IPv4`&&o.push({key:10,value:n}),a&&r===`IPv6`&&o.push({key:11,value:n});let s=o.filter(e=>e.value).map(e=>`${e.key}=${encodeURIComponent(e.value)}`).join(`&`);return btoa(s)}},Db=D([Q(`Id5IdModule`),C(),A(`design:paramtypes`,[typeof(xb=Ea!==void 0&&Ea)==`function`?xb:Object,typeof(Sb=va!==void 0&&va)==`function`?Sb:Object,typeof(Cb=Np!==void 0&&Np)==`function`?Cb:Object,typeof(wb=Ss!==void 0&&Ss)==`function`?wb:Object,typeof(Tb=Es!==void 0&&Es)==`function`?Tb:Object,typeof(Eb=yb!==void 0&&yb)==`function`?Eb:Object])],Db)})),Ob,kb,Ab,jb,Mb,Toe=o((()=>{Ns(),Fs(),db(),lo(),w(),$(),ya(),Da(),j(),E(),O(),Mb=class extends ub{constructor(e,t,n,r){super(),this._ccpa=e,this._gpc=t,this._idho=n,this._gdpr=r,T(this,`config`,void 0),T(this,`_name`,`merkleId`),T(this,`targetingKey`,`mrk`),T(this,`eidSource`,`merkleinc.com`),this.config={name:this._name,params:{sv_pubid:`9262`,ssp_ids:[`534404531`]},storage:{type:`html5`,name:`pbjs-merkleId`,expires:30}}}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`merkuryId`)&&!this._gdpr.enabled}},Mb=D([Q(`MerkuryIdModule`),C(),A(`design:paramtypes`,[typeof(Ob=Ea!==void 0&&Ea)==`function`?Ob:Object,typeof(kb=va!==void 0&&va)==`function`?kb:Object,typeof(Ab=Ms!==void 0&&Ms)==`function`?Ab:Object,typeof(jb=co!==void 0&&co)==`function`?jb:Object])],Mb)})),Nb,Pb,Fb,Ib,Lb,Eoe=o((()=>{Ns(),Fs(),db(),w(),$(),Da(),ya(),lo(),j(),E(),O(),Lb=class extends ub{constructor(e,t,n,r){super(),this._ccpa=e,this._gpc=t,this._idho=n,this._gdpr=r,T(this,`config`,void 0),T(this,`_name`,`identityLink`),T(this,`targetingKey`,`idl`),T(this,`eidSource`,`liveramp.com`),this.config={name:this._name,params:{pid:`111`,...this._gdpr.enabled&&{notUse3P:!0}},storage:{type:`html5`,name:`pbjs-identitylink`,expires:60}}}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`identityLink`)}},Lb=D([Q(`IdentityLinkIdModule`),C(),A(`design:paramtypes`,[typeof(Nb=Ea!==void 0&&Ea)==`function`?Nb:Object,typeof(Pb=va!==void 0&&va)==`function`?Pb:Object,typeof(Fb=Ms!==void 0&&Ms)==`function`?Fb:Object,typeof(Ib=co!==void 0&&co)==`function`?Ib:Object])],Lb)})),Rb,zb,Bb,Vb,Doe=o((()=>{w(),Ns(),Fs(),db(),$(),Da(),ya(),j(),E(),O(),Vb=class extends ub{constructor(e,t,n){super(),this._ccpa=e,this._gpc=t,this._idho=n,T(this,`config`,void 0),T(this,`_name`,`lotamePanoramaId`),T(this,`targetingKey`,`lpid`),T(this,`storageKey`,`panoramaId`),T(this,`eidSource`,`crwdcntrl.net`),this.config={name:this._name,params:{clientId:`17297`}}}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`lotamePanoramaId`)}},Vb=D([Q(`LotamePanoramaIdModule`),C(),A(`design:paramtypes`,[typeof(Rb=Ea!==void 0&&Ea)==`function`?Rb:Object,typeof(zb=va!==void 0&&va)==`function`?zb:Object,typeof(Bb=Ms!==void 0&&Ms)==`function`?Bb:Object])],Vb)})),Hb,Ub,Wb,Gb,Kb,Ooe=o((()=>{Ns(),Fs(),db(),lo(),w(),$(),Da(),ya(),j(),E(),O(),Kb=class extends ub{constructor(e,t,n,r){super(),this._ccpa=e,this._gpc=t,this._idho=n,this._gdpr=r,T(this,`config`,void 0),T(this,`_name`,`FTrack`),T(this,`targetingKey`,`ftr`),T(this,`eidSource`,`flashtalking.com`),this.config={name:this._name,params:{url:`https://d9.flashtalking.com/d9core`,ids:{"device id":!0,"single device id":!0,"household id":!0}},storage:{type:`html5`,name:`FTrackId`,expires:60,refreshInSeconds:8*3600}}}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`FTrack`)&&!this._gdpr.enabled}},Kb=D([Q(`FTrackIdModule`),C(),A(`design:paramtypes`,[typeof(Hb=Ea!==void 0&&Ea)==`function`?Hb:Object,typeof(Ub=va!==void 0&&va)==`function`?Ub:Object,typeof(Wb=Ms!==void 0&&Ms)==`function`?Wb:Object,typeof(Gb=co!==void 0&&co)==`function`?Gb:Object])],Kb)})),qb,Jb,Yb,Xb,Zb,koe=o((()=>{w(),Ns(),Fs(),db(),Tr(),_a(),$(),Da(),ya(),j(),E(),O(),Zb=class extends ub{constructor(e,t,n,r){super(),this._ccpa=e,this._gpc=t,this._idho=n,this._optableConfig=r,T(this,`config`,void 0),T(this,`_name`,`lmpId`),T(this,`targetingKey`,`lmpId`),T(this,`storageKey`,I.OPTABLE_LMPID.KEY),T(this,`eidSource`,`loblawmedia.ca`),this.config={name:this._name,params:{clientId:`17297`}}}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`lmpId`)&&this._optableConfig.loblawEnabled}},Zb=D([Q(`LoblawIdModule`),C(),A(`design:paramtypes`,[typeof(qb=Ea!==void 0&&Ea)==`function`?qb:Object,typeof(Jb=va!==void 0&&va)==`function`?Jb:Object,typeof(Yb=Ms!==void 0&&Ms)==`function`?Yb:Object,typeof(Xb=ga!==void 0&&ga)==`function`?Xb:Object])],Zb)})),Qb,$b,ex,tx,Aoe=o((()=>{Fs(),Ns(),db(),w(),$(),ya(),Da(),j(),E(),O(),tx=class extends ub{constructor(e,t,n){super(),this._ccpa=e,this._gpc=t,this._idho=n,T(this,`_name`,`teadsId`),T(this,`targetingKey`,`teads`),T(this,`eidSource`,`teads.com`),T(this,`config`,{name:this._name,params:{pubId:17002}})}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`teadsId`)}},tx=D([Q(`TeadsIdModule`),C(),A(`design:paramtypes`,[typeof(Qb=Ea!==void 0&&Ea)==`function`?Qb:Object,typeof($b=va!==void 0&&va)==`function`?$b:Object,typeof(ex=Ms!==void 0&&Ms)==`function`?ex:Object])],tx)})),nx,rx,ix,ax,ox,sx,joe=o((()=>{Ns(),Fs(),db(),lo(),w(),$(),ya(),Da(),j(),E(),O(),sx=class extends ub{constructor(e,t,n,r,i){super(),this._ccpa=e,this._gpc=t,this._idho=n,this._gdpr=r,this._shareHemWithUserIdModule=i,T(this,`config`,void 0),T(this,`_name`,`33acrossId`),T(this,`targetingKey`,`33a`),T(this,`eidSource`,`33across.com`),this.config={name:this._name,params:{pid:`0013300001i0fyfAAA`},storage:{name:`33acrossId`,type:`html5`,expires:90,refreshInSeconds:8*3600}},this.setHem()}async setHem(){let e=await this._shareHemWithUserIdModule.share({blockGraphHem:!0});typeof e==`string`&&(this.config={...this.config,params:{...this.config.params,hem:e}})}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`33acrossId`)&&!this._gdpr.enabled}},sx=D([Q(`ThirtyThreeAcrossIdModule`),C(),A(`design:paramtypes`,[typeof(nx=Ea!==void 0&&Ea)==`function`?nx:Object,typeof(rx=va!==void 0&&va)==`function`?rx:Object,typeof(ix=Ms!==void 0&&Ms)==`function`?ix:Object,typeof(ax=co!==void 0&&co)==`function`?ax:Object,typeof(ox=Es!==void 0&&Es)==`function`?ox:Object])],sx)})),cx,lx,ux,dx,fx,px,Moe=o((()=>{Ns(),Fs(),db(),lo(),w(),$(),Da(),ya(),j(),E(),O(),px=class extends ub{constructor(e,t,n,r,i){super(),this._ccpa=e,this._gpc=t,this._idho=n,this._gdpr=r,this._shareHemWithUserIdModule=i,T(this,`config`,void 0),T(this,`_name`,`fabrickId`),T(this,`targetingKey`,`fab`),T(this,`eidSource`,`neustar.biz`),this.config={name:this._name,params:{apiKey:`2487261909`},storage:{type:`html5`,name:`pbjs_fabrickId`,expires:60}},this.setHash()}async setHash(){let e=await this._shareHemWithUserIdModule.share();typeof e==`string`&&(this.config={...this.config,params:{...this.config.params,e}})}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`fabrickId`)&&!this._gdpr.enabled}},px=D([Q(`FabrickIdModule`),C(),A(`design:paramtypes`,[typeof(cx=Ea!==void 0&&Ea)==`function`?cx:Object,typeof(lx=va!==void 0&&va)==`function`?lx:Object,typeof(ux=Ms!==void 0&&Ms)==`function`?ux:Object,typeof(dx=co!==void 0&&co)==`function`?dx:Object,typeof(fx=Es!==void 0&&Es)==`function`?fx:Object])],px)})),mx,hx,gx,_x,Noe=o((()=>{Ns(),Fs(),db(),w(),$(),Da(),ya(),j(),E(),O(),_x=class extends ub{constructor(e,t,n){super(),this._ccpa=e,this._gpc=t,this._idho=n,T(this,`config`,void 0),T(this,`_name`,`criteo`),T(this,`targetingKey`,`cri`),T(this,`eidSource`,`criteo.com`),this.config={name:this._name,storage:{type:`html5`,name:`pbjs-criteo`,expires:60}}}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`criteo`)}},_x=D([Q(`CriteoIdModule`),C(),A(`design:paramtypes`,[typeof(mx=Ea!==void 0&&Ea)==`function`?mx:Object,typeof(hx=va!==void 0&&va)==`function`?hx:Object,typeof(gx=Ms!==void 0&&Ms)==`function`?gx:Object])],_x)})),vx,yx,bx,xx,Sx,Poe=o((()=>{Ns(),Fs(),db(),tf(),w(),$(),Da(),ya(),j(),E(),O(),Sx=class extends ub{constructor(e,t,n,r){super(),this._ccpa=e,this._gpc=t,this._idho=n,this._liveRampAts=r,T(this,`config`,void 0),T(this,`_name`,`pairId`),T(this,`targetingKey`,`pair`),T(this,`eidSource`,`google.com`),this.config={name:this._name,params:{liveramp:{}},storage:{type:`html5`,name:`pbjs-pairId`,expires:30,refreshInSeconds:1800}}}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`pairId`)&&this._liveRampAts.enabled}},Sx=D([Q(`PairIdModule`),C(),A(`design:paramtypes`,[typeof(vx=Ea!==void 0&&Ea)==`function`?vx:Object,typeof(yx=va!==void 0&&va)==`function`?yx:Object,typeof(bx=Ms!==void 0&&Ms)==`function`?bx:Object,typeof(xx=ef!==void 0&&ef)==`function`?xx:Object])],Sx)})),Cx,wx,Foe=o((()=>{Ui(),$(),w(),E(),O(),Cx=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`SharethroughLiveIntent`,this._lookup=`SHTLI`}},Cx=D([Q(`SharethroughLiftLiveIntentExperiment`),C()],Cx),wx=Cx})),Tx,Ioe=o((()=>{mU(),w(),O(),Tx=class extends pU{init(){this._key=`LiveIntentTimeOutExperiment`,this._lookup=`LITO`}},Tx=D([C()],Tx)})),Ex,Loe=o((()=>{mU(),$(),w(),j(),O(),Ex=class extends pU{init(){this._key=`LiveIntentFpiExpiration`,this._lookup=`LIFPI`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],Ex.prototype,`run`,null),Ex=D([C()],Ex)})),Dx,Roe=o((()=>{w(),Ui(),E(),O(),Dx=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`LiveIntentHem`,this._lookup=`SDKLI`}},Dx=D([C()],Dx)})),Ox,kx=o((()=>{w(),Ui(),E(),O(),Ox=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`LiveIntentUid2Hem`,this._lookup=`SDKLIR`}},Ox=D([C()],Ox)})),Ax,jx,Mx,Nx,Px,Fx,Ix,Lx,Rx,zx,Bx,Vx,Hx,Ux,Wx,Gx,zoe=o((()=>{w(),Cs(),Fs(),db(),Foe(),Ioe(),Loe(),$(),ya(),Da(),vb(),Rm(),Rs(),Ra(),rU(),gs(),Roe(),kx(),Z(),$h(),Tr(),bb(),Pp(),j(),E(),O(),Gx=class extends ub{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m){var h;super(),this._ccpa=e,this._gpc=t,this._audienceTargeting=n,this._user=r,this._shareHemWithUserIdModule=i,this._sharethroughLiveIntentExperiment=a,this._liveIntentTimeoutExperiment=o,this._liveIntentFpiExpirationExperiment=s,this._cloudflareIdPartnerExpHo=c,this._context=l,this._prebidEventBus=u,this._emailCaptureHandler=d,this._liveIntentHemExperiment=f,this._gam=p,this._liveIntentUid2HemExperiment=m,T(this,`config`,void 0),T(this,`_name`,`liveIntentId`),T(this,`targetingKey`,`liid`),T(this,`eidSource`,`liveintent.com`);let g,_;if(this._user.rcid){let e=_b(this._user.rcid.metadata.clientIp);e===`IPv4`?g=this._user.rcid.metadata.clientIp:e===`IPv6`&&(_=this._user.rcid.metadata.clientIp)}let v=this._getIdentifiers();this.config={name:this._name,params:{distributorId:`did-001w`,requestedAttributesOverrides:{uid2:!0,medianet:!0,bidswitch:!0,magnite:!0,index:!0,pubmatic:!0,sovrn:!0,openx:!0,triplelift:!0,thetradedesk:!0,sha2:!0,...this._sharethroughLiveIntentExperiment.result&&{sharethrough:!0}},...this._cloudflareIdPartnerExpHo.result&&g&&{ipv4:g},...this._cloudflareIdPartnerExpHo.result&&_&&{ipv6:_},...v.length&&{identifiersToResolve:v},...this._liveIntentFpiExpirationExperiment.result!==`d`&&this._liveIntentFpiExpirationExperiment.result&&{liCollectConfig:{fpiExpirationDays:parseInt(this._liveIntentFpiExpirationExperiment.result)}},ajaxTimeout:(h=this._liveIntentTimeoutExperiment.result)==null?5e3:h},storage:{name:`__tamLIResolveResult`,type:`html5`,expires:1,refreshInSeconds:8*3600}},this._setHash(),this._collectLiveIntentHem()}_collectLiveIntentHem(){this._liveIntentHemExperiment.result&&this._prebidEventBus.liveIntentResolved.once(async e=>{let t=await this._user.identityData(),n=(t==null?void 0:t.sha256Hash)||(t==null?void 0:t.sha1Hash);if(t&&t.collectionMethod===`direct`&&e&&e.sha2){let t=n==e.sha2?`1`:`0`;this._gam.setTargetingFlag(`lihem_mtch`,[t])}!t&&e&&e.sha2&&(this._liveIntentUid2HemExperiment.result||!this._liveIntentUid2HemExperiment.result&&e.uid2)&&this._emailCaptureHandler.emailCaptured.emit({pii:{sha256Hash:e.sha2,source:`${I.PII_SOURCE.VALUES.SDKLI}${e.uid2?``:`r`}_c`,sourceCollectedDate:Bs()},identityDataSource:`sdkli`})})}async _setHash(){let e=await this._shareHemWithUserIdModule.share({blockGraphHem:!0,blockLiveIntentHem:!0});typeof e==`string`&&(this.config={...this.config,params:{...this.config.params,emailHash:e}})}_getIdentifiers(){var e;let t=this._context.gpid;t?U.setInternalLocalStorage(`adt_li_gpid`,t):U.deleteLocalStorage(`adt_li_gpid`);let n=Is();n?U.setInternalLocalStorage(`adt_li_panoramaid`,n):U.deleteLocalStorage(`adt_li_panoramaid`);let r=(e=this._user.rcid)==null?void 0:e.value.sharedId;r?U.setInternalLocalStorage(`adt_li_rcid`,r):U.deleteLocalStorage(`adt_li_rcid`);let i=U.readExternalLocalStorage(`pbjs-unifiedid`),a=i?JSON.parse(decodeURIComponent(i)):void 0,o=a?a.TDID:void 0;return o?U.setInternalLocalStorage(`adt_li_unifiedid`,o):U.deleteLocalStorage(`adt_li_unifiedid`),[Os()&&`_pubcid`,t&&`adt_li_gpid`,n&&`adt_li_panoramaid`,o&&`adt_li_unifiedid`,r&&`adt_li_rcid`].filter(e=>e!=null)}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&this._audienceTargeting.liveIntentEnabled}},Gx=D([Q(`LiveIntentIdModule`),C(),A(`design:paramtypes`,[typeof(Ax=Ea!==void 0&&Ea)==`function`?Ax:Object,typeof(jx=va!==void 0&&va)==`function`?jx:Object,typeof(Mx=Np!==void 0&&Np)==`function`?Mx:Object,typeof(Nx=Ss!==void 0&&Ss)==`function`?Nx:Object,typeof(Px=Es!==void 0&&Es)==`function`?Px:Object,typeof(Fx=wx!==void 0&&wx)==`function`?Fx:Object,typeof(Ix=Tx!==void 0&&Tx)==`function`?Ix:Object,typeof(Lx=Ex!==void 0&&Ex)==`function`?Lx:Object,typeof(Rx=yb!==void 0&&yb)==`function`?Rx:Object,typeof(zx=L!==void 0&&L)==`function`?zx:Object,typeof(Bx=Pr!==void 0&&Pr)==`function`?Bx:Object,typeof(Vx=hs!==void 0&&hs)==`function`?Vx:Object,typeof(Hx=Dx!==void 0&&Dx)==`function`?Hx:Object,typeof(Ux=Zh!==void 0&&Zh)==`function`?Ux:Object,typeof(Wx=Ox!==void 0&&Ox)==`function`?Wx:Object])],Gx)})),Kx,qx=o((()=>{w(),$(),Ui(),E(),j(),O(),Kx=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`IdGraphUid2`,this._lookup=`IDGUID3`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],Kx.prototype,`run`,null),Kx=D([C()],Kx)})),Jx,Yx,Xx,Zx,Qx,$x,eS,tS,Boe=o((()=>{w(),Ns(),Fs(),db(),lo(),$(),Rm(),Da(),ya(),Cs(),Z(),qx(),$h(),Rs(),j(),E(),O(),tS=class extends ub{constructor(e,t,n,r,i,a,o){super(),this._ccpa=e,this._gpc=t,this._idho=n,this._gdpr=r,this._user=i,this._idGraphUid2Experiment=a,this._googleAdManager=o,T(this,`config`,void 0),T(this,`_name`,`uid2`),T(this,`targetingKey`,`uid2`),T(this,`eidSource`,`uidapi.com`),T(this,`storageKey`,`__uid2_advertising_token`),T(this,`_uid2ServerToken`,U.readExternalLocalStorage(`__uid2_server_token`)),T(this,`_uid2AdvertisingToken`,U.readExternalLocalStorage(`__uid2_advertising_token`));let s=this.getToken(),c=!!(s!=null&&s.matcher);this.config={name:this._name,params:{storage:`localStorage`,...s?{uid2Token:s,declareBridged:c}:{},...(s==null?void 0:s.matcher)&&{matcher:s.matcher}}},c&&s!=null&&s.matcher&&this._setBridgedTargetingFlag(s==null?void 0:s.matcher).catch(e=>{M.error(`UnifiedId2IdModule`,`_setBridgedTargetingFlag`,e)})}get enabled(){var e;let t=!MG({source:(e=this._user.source)==null?``:e}),n=this._idGraphUid2Experiment.result;return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`unifiedId2`)&&!this._gdpr.enabled&&(t||n)}getToken(){return this._uid2AdvertisingToken?this._uid2AdvertisingToken.latestToken?this._uid2AdvertisingToken.latestToken:this._uid2AdvertisingToken.originalToken:this._uid2ServerToken}get _config(){return this.config}async _setBridgedTargetingFlag(e){await this._googleAdManager.waitForQueue();let t=Ls(e);t&&this._googleAdManager.setTargetingFlag(`uid2b`,[t],!0)}},tS=D([Q(`UnifiedId2IdModule`),C(),A(`design:paramtypes`,[typeof(Jx=Ea!==void 0&&Ea)==`function`?Jx:Object,typeof(Yx=va!==void 0&&va)==`function`?Yx:Object,typeof(Xx=Ms!==void 0&&Ms)==`function`?Xx:Object,typeof(Zx=co!==void 0&&co)==`function`?Zx:Object,typeof(Qx=Ss!==void 0&&Ss)==`function`?Qx:Object,typeof($x=Kx!==void 0&&Kx)==`function`?$x:Object,typeof(eS=Zh!==void 0&&Zh)==`function`?eS:Object])],tS)})),nS,rS,iS,aS,Voe=o((()=>{Fs(),Ns(),db(),w(),$(),ya(),Da(),j(),E(),O(),aS=class extends ub{constructor(e,t,n){super(),this._ccpa=e,this._gpc=t,this._idho=n,T(this,`_name`,`sharedId`),T(this,`targetingKey`,`shl`),T(this,`eidSource`,`pubcid.org`),T(this,`config`,{name:this._name,storage:{type:`html5`,name:`_pubcid`,expires:60}})}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`sharedId`)}},aS=D([Q(`SharedIdModule`),C(),A(`design:paramtypes`,[typeof(nS=Ea!==void 0&&Ea)==`function`?nS:Object,typeof(rS=va!==void 0&&va)==`function`?rS:Object,typeof(iS=Ms!==void 0&&Ms)==`function`?iS:Object])],aS)})),oS,sS,cS,lS,Hoe=o((()=>{Ns(),Fs(),db(),w(),$(),Da(),ya(),j(),E(),O(),lS=class extends ub{constructor(e,t,n){super(),this._ccpa=e,this._gpc=t,this._idho=n,T(this,`config`,void 0),T(this,`_name`,`linkedInAdsId`),T(this,`targetingKey`,`liaid`),T(this,`eidSource`,`linkedin.com`),this.config={name:this._name,storage:{type:`html5`,name:`linkedin_ads_id`,expires:30}}}get _config(){return this.config}get enabled(){return!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&Ps(this._idho,`linkedInAdsId`)}},lS=D([Q(`LinkedInAdsIdModule`),C(),A(`design:paramtypes`,[typeof(oS=Ea!==void 0&&Ea)==`function`?oS:Object,typeof(sS=va!==void 0&&va)==`function`?sS:Object,typeof(cS=Ms!==void 0&&Ms)==`function`?cS:Object])],lS)})),uS,dS,fS,pS,mS,hS,gS,Uoe=o((()=>{w(),db(),$(),lo(),ya(),Da(),Pp(),Z(),ew(),La(),j(),E(),O(),gS=class extends ub{constructor(e,t,n,r,i,a){super(),this._gdpr=e,this._ccpa=t,this._gpc=n,this._audienceTargeting=r,this._ortb2=i,this._context=a,T(this,`config`,void 0),T(this,`_name`,`intentIqId`),T(this,`targetingKey`,`iiq_id`);let o=this._getRaptiveUid();this.config={name:this._name,params:{partner:743264634,timeoutInMillis:500,...o?{partnerClientId:o,partnerClientIdType:3}:{},callback:e=>{this._ortb2.addEidsToOrtb2((e==null?void 0:e.eids)||[])}},storage:{type:`html5`,name:`intentIqId`,expires:0,refreshInSeconds:0}}}get _config(){return this.config}get enabled(){return!this._gdpr.enabled&&!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut&&this._audienceTargeting.intentIqEnabled}_getRaptiveUid(){let e=jG(this._context.gpid);if(e){var t;return(e==null||(t=e.uids[0])==null?void 0:t.id)||void 0}}},gS=D([Q(`IntentIqIdModule`),C(),A(`design:paramtypes`,[typeof(uS=co!==void 0&&co)==`function`?uS:Object,typeof(dS=Ea!==void 0&&Ea)==`function`?dS:Object,typeof(fS=va!==void 0&&va)==`function`?fS:Object,typeof(pS=Np!==void 0&&Np)==`function`?pS:Object,typeof(mS=$C!==void 0&&$C)==`function`?mS:Object,typeof(hS=L!==void 0&&L)==`function`?hS:Object])],gS)})),_S=o((()=>{Soe(),Coe(),woe(),Toe(),Eoe(),Doe(),Ooe(),koe(),Aoe(),joe(),Moe(),Noe(),Poe(),zoe(),Boe(),Voe(),Hoe(),Uoe()})),vS=o((()=>{_S(),Rs()})),yS,bS,xS,SS,CS,wS,TS,ES,DS,OS,kS,AS,jS,MS,NS,PS,Woe=o((()=>{w(),$h(),B(),X(),$(),vh(),Z(),Hr(),rU(),soe(),Ua(),rd(),Bh(),Rm(),Wr(),Kh(),coe(),loe(),uoe(),al(),doe(),hoe(),goe(),vS(),j(),E(),O(),PS=class{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m){this._config=e,this._googleAdManager=t,this._slots=n,this._slotEventBus=r,this._marmaladeEventBus=i,this._gamEventBus=a,this.eventBus=o,this._prebidEventBus=s,this._jumpToSlotManager=c,this._bootstrapConfig=l,this._openBiddingTrafficShapingExperiment=p,this._magniteBotTrafficExperiment=m,T(this,`displayRefreshInterval`,void 0),T(this,`stickyOutstreamRefreshInterval`,4e4),T(this,`slotAdvertiserID`,new Map),T(this,`_refreshTargetingKeys`,[`aop`,`apd`,`aopp`,`appd`,EW,`pbop`,`pbpd`,`reqtype`]),T(this,`_sizeOrderExperimentResult`,void 0),T(this,`_bannerWidthHeightExperimentResult`,void 0),T(this,`_adInViewExperimentResult`,void 0),T(this,`_largeSizeSorter`,(e,t)=>{let n=e[0]*e[1],r=t[0]*t[1];return r-n}),T(this,`_smallSizeSorter`,(e,t)=>{let n=e[0]*e[1],r=t[0]*t[1];return n-r}),T(this,`_valueSizeSorter`,(e,t)=>{let n=tb.get(e.join(`x`))||tb.get(`*`)||tb.size,r=tb.get(t.join(`x`))||tb.get(`*`)||tb.size;return n-r}),this._slotEventBus.adSlotScrolledFarOutOfView.on(e=>{let t=this._slots.get(e);t&&this.destroy(t)}),this._slotEventBus.displaySlot.on(async e=>{let t=this._slots.get(e);t&&await this.display(t)}),this.setupSlotRenderedListener(),this.displayRefreshInterval=3e4-this._config.prebid.refreshAuctionCount*5e3,this._prebidEventBus.rubiconBidError.on(this._setRubiconBidFailedTargeting.bind(this)),this._sizeOrderExperimentResult=d.result===`sm`&&tG()?`sm`:`off`,this._bannerWidthHeightExperimentResult=f.result||`off`,this._adInViewExperimentResult=u.result}setSizes(e){let t=this._sizeOrderExperimentResult,n=this._bannerWidthHeightExperimentResult;if(t!==`off`){let n=this._getSizeSorter(t);e.originalSizes=[...e.sizes],e.sizes=[...e.sizes].sort(n)}if(n!==`off`){let t=this._getBannerWidthSizeSorter(n),r=[...e.sizes].sort(t),i=r.length>1&&n===`sm1`,a=r[i?1:0];e.mainAuctionWidth=a[0],e.mainAuctionHeight=a[1]}}async add(e,t=!1){let n=Gh.markStartTask(`microtask`,[`SlotManager`,`add`,`1`]),r=this._config.gam;r.loaded||await r.gamEventPromise,this._bootstrapConfig.gptLibFailedToLoad?n.markEndTask():(n.markEndTask(),await this._googleAdManager.waitForQueue());let i=Gh.markStartTask(`microtask`,[`SlotManager`,`add`,`2`]),a=U.readSessionStorage(`adthrive_footer_closed`),{addSlots:o,removeSlots:s}=this._jumpToSlotManager.determineSlotsToAddAndRemove(this.castArray(e));s.length&&this._jumpToSlotManager.preventSlotsBeingAdded(s);let c=this._googleAdManager.defineSlots(o.filter(e=>e.location!==F.Footer||e.location===F.Footer&&!a)),l=this._config.marmalade;l.loaded||await l.marmaladeEventPromise,l.adViewability.length||this._marmaladeEventBus.resetMarmaladeData.once(()=>{c.forEach(e=>e.setViewability(l))}),c.forEach(e=>{this.setSizes(e),e.setViewability(l),e.setHighlyViewable(l),e.setBidPoolId(this._config.prebid.bidPoolSlots),e.setPassiveBidPoolId(),e.rebuild=t;let n=e.location===F.Recipe&&e.sticky;n||this._config.clsOptimizedAds.setStyle(e.element,e.location),this._setSlotTargetingForTrafficShaping(e)}),this._slots.add(c);let u=c.map(e=>e.id);t?this._slotEventBus.addRebuiltSlots.emit(u):this._slotEventBus.addSlots.emit(u),i.markEndTask(),await Ha();let d=Gh.markStartTask(`microtask`,[`SlotManager`,`add`,`3`]),f=this.eventBus.added.legacyEmit(c.map(e=>e.id));return d.markEndTask(),await f,c}destroy(e){let t=this.castArray(e);return this.pauseRefresh(t),this._slots.remove(t),this._googleAdManager.destroySlots(t),t}destroyAll(e=!0){let t=this._slots.get();return e||(t=t.filter(e=>!Object.values(vW).includes(e.location))),this.destroy(t)}rebuild(e){let t=this.castArray(e),n=this._googleAdManager;for(let e of t)Zh.pushToQueue(()=>{let t=[`refresh`,`inf_scroll`,`decref`,`nref`,`hvp`,`lazy`,`bpe`,`fle`].reduce((t,n)=>{let r=e.getTargeting(n);return r.length&&t.push({key:n,value:r}),t},[]);n.destroySlots(this.castArray(e)),e.googleTagSlotReady=!1,n.defineSlots(this.castArray(e)),e.setTargeting(t)});return t}rebuildAll(){let e=this._slots.get(),t=this.rebuild(e);return t}removeElement(e){let t=this.castArray(e),n=[];for(let e of t){if(e.location===F.Video_StickyOutstream){var r;(r=e.element.parentElement)==null||r.remove()}else e.element.remove();n.push(e.element)}return n}removeAllElements(e=!0){let t=this._slots.get();return e||(t=t.filter(e=>!Object.values(vW).includes(e.location))),this.removeElement(t)}async refresh(e,t=!0,n=0){let{addSlots:r,removeSlots:i}=this._jumpToSlotManager.determineSlotsToAddAndRemove(this.castArray(e));i.length&&this.destroy(i);let a=r.some(e=>e.location===F.Video_StickyOutstream),o=r.map(e=>e.id);for(let e of r){if(!e||e.refreshCount===void 0)continue;e.refreshCount++,e.servedPrebidBidResponse=void 0,e.isRefreshing=!0,this._setSlotTargetingForTrafficShaping(e)}await this.eventBus.refreshing.legacyEmit(o),await this.eventBus.refreshAuctionStart.legacyEmit(o);let s=Date.now(),c=this._getAuctionCount(r,a),l=c!==1,u=this._getInjectedAuctions(l,c);this._generateNewUUIDsForSlots(r);for(let e=0;e<u.length;e++){let t=e+1;await this.refreshBids(r,t,!1),await this.eventBus.refreshAuctionStart.legacyEmit(o)}let d=il.isRolloutEnabled(`refresh-optimization`)?0:n,f=this._getAuctionDelay(r,s,d);await Promise.all([t?Sn(f):!0,this.refreshBids(r,c,!0)]).then(async()=>{await this._slotEventBus.auctionsCompleted.legacyEmit(r.map(e=>e.id)),this._googleAdManager.refreshSlots(r)}),await this.eventBus.refreshed.legacyEmit(o);for(let e of r)e.isRefreshing=!1;return r}async display(e){let{addSlots:t,removeSlots:n}=this._jumpToSlotManager.determineSlotsToAddAndRemove(this.castArray(e));n.length&&this.destroy(n);let r=t.map(e=>e.id);await this.eventBus.displaying.legacyEmit(r);let i=Gh.markStartTask(`microtask`,[`SlotManager`,`display`,`1`]),a=this.requestBids(t);i.markEndTask(),await a;let o=Gh.markStartTask(`microtask`,[`SlotManager`,`display`,`auctionComplete`]),s=this._slotEventBus.auctionsCompleted.legacyEmit(r);o.markEndTask(),await s;let c=Gh.markStartTask(`microtask`,[`SlotManager`,`display`,`gamDisplaySlots`]);return await this._googleAdManager.displaySlots(t),c.markEndTask(),t.forEach(e=>{e.displayed=!0}),this.eventBus.displayed.emit(r),t}inView(e){let t=this.castArray(e);return t.forEach(e=>this.setRefreshTimeout(e)),t}outOfView(e){let t=this.castArray(e);return t.filter(e=>!e.alwaysInView).filter(e=>`IntersectionObserver`in window?e.outOfViewGPT&&e.outOfViewIO:e.outOfViewGPT).forEach(e=>{let t=e.element.querySelector(`div > iframe`),n=t==null?void 0:t.nextElementSibling;QG(e.element)&&t&&(QG(t)||n&&QG(n))&&this.clearRefreshTimeout(e)}),t}pauseRefresh(e){let t=this.castArray(e);return t.filter(e=>e.refreshTimeout).forEach(e=>{e.refreshPaused=!0,this.clearRefreshTimeout(e)}),t}resumeRefresh(e){let t=this.castArray(e);return t.filter(e=>e.refreshPaused).forEach(e=>{e.refreshPaused=!1,this.setRefreshTimeout(e)}),t}updateRefreshTimeout(e,t){let n=this.castArray(e);return n.forEach(e=>{e.refreshInterval=t;let n=e.element.querySelector(`div > iframe`),r=QG(e.element)&&n&&QG(n)&&!document.hidden,i=e.location===F.Video_StickyOutstream&&e.unfilled;i?(this.setRefreshTimeout(e),e.unfilled=!1):e.refreshTimeout&&(e.location!==F.Video_StickyOutstream||r)?(this.clearRefreshTimeout(e),this.setRefreshTimeout(e)):e.refreshTimeout&&!r&&(this.setRefreshTimeout(e),this.clearRefreshTimeout(e))}),n}clearRefreshTimeout(e,t=!1){let n=this.castArray(e);n.filter(e=>e.refreshTimeout).forEach(e=>{window.clearTimeout(e.refreshTimeout),e.refreshTimeout=void 0,t?(e.viewableDuration=0,e.slotFullyRenderedDuration=0):(e.viewableSince&&(e.viewableDuration+=Yr()-e.viewableSince.getTime()),e.slotFullyRenderedSince&&(e.slotFullyRenderedDuration=Yr()-e.slotFullyRenderedSince))})}getSlot(e){return this._slots.get(e)}getSlots(e){return e?this._slots.get(e):this._slots.get()}get amazonBidResponseReceived(){return this._slotEventBus.amazonBidResponseReceived}_getAuctionCount(e,t){let n=t&&e[0].stickyOutstreamShortVideo,r=t&&e[0].noAdRefreshCount,i=t&&e[0].stickyOutstreamLastAdErrored,a=this._config.prebid.multiStageLimit,o=a&&e[0].refreshCount>=a?1:this._config.prebid.refreshAuctionCount,s=!n&&!r&&!i?this._config.prebid.refreshStickyOutstreamAuctionCount:1,c=t?s:o;return c}_getAuctionDelay(e,t,n){var r;let i=this._config,a=i.timeouts.refreshBidsRequest,o=e.some(e=>e.location===F.Video_StickyOutstream),s=o&&e[0].stickyOutstreamShortVideo,c=s?1:this._config.prebid.refreshStickyOutstreamAuctionCount,l=o?c:this._config.prebid.refreshAuctionCount,u=Date.now(),d=u-t,f=(r=e[0])==null?void 0:r.stickyOutstreamRefreshTimeout,p=3e4,m=p-a*l,h=n>m,g=(h?p-n:a*l)-d,_=Math.max(g,0);return o&&f?f:_}_getInjectedAuctions(e,t){let n=[];if(e)for(let e=0;e<(t||1)-1;e++)n.push(e);return n}_setSlotTargetingForTrafficShaping(e){let t=this._config.trafficShaping;if(t.active&&this._openBiddingTrafficShapingExperiment.result){var n,r;let i=(n=(r=t.getTrafficShapingRule(e.location,e.refreshCount))==null?void 0:r.ob)==null?[]:n;this._googleAdManager.setSlotTargeting({key:`obts`,value:i},e.googleTagSlot)}}setRefreshTimeout(e){let t=this.castArray(e);t.filter(e=>!e.refreshTimeout&&(!e.isRefreshing||e.location===F.Video_StickyOutstream)).forEach(e=>{let t=this.calculateRemainingRefreshDuration(e,e.location===F.Video_StickyOutstream?this.stickyOutstreamRefreshInterval:this.displayRefreshInterval);e.viewableSince=new Date,e.refreshInterval!==0&&(e.refreshTimeout=window.setTimeout(()=>{let t=Yr()-(e.slotFullyRenderedSince||Date.now());e.viewableDuration=0,e.slotFullyRenderedDuration=0,e.refreshInterval=void 0,e.refreshTimeout=void 0,e.slotFullyRenderedSince=void 0,this.refresh(e,!0,t).catch(e=>void 0)},Math.max(t,0)))})}getAmazonBidderCode(e){var t;return this.slotAdvertiserID.get(e.element.id)===4526447244&&((t=e.getTargeting(`amz_bidder`))==null||(t=t[0])==null?void 0:t.substring(2))||``}getBidderAdInViewDurationOverride(e){var t;let n=new Set([`kargo`,`tripl_ss`,`triplelift`,`ogury`,`nativo`]),r=((t=e.servedPrebidBidResponse)==null?void 0:t.bidderCode)||``,i=this.getAmazonBidderCode(e);return n.has(r)||n.has(i)?5e3:void 0}calculateRemainingRefreshDuration(e,t=25e3){let n=this._adInViewExperimentResult?this.getBidderAdInViewDurationOverride(e):void 0,r=N(n||this._config.adOptions.adInViewTime||this._adInViewExperimentResult,t),i=N(e.refreshInterval,r);e.slotFullyRenderedSince&&(e.slotFullyRenderedDuration=Yr()-e.slotFullyRenderedSince);let a=t-e.slotFullyRenderedDuration,o=i-e.viewableDuration,s=Math.max(a,o,0);if(e.location===F.Video_StickyOutstream){let t=N(e.refreshInterval,this.stickyOutstreamRefreshInterval);return t-e.viewableDuration}return s}async requestBids(e){let t=this.castArray(e).filter(e=>e.enabledForAuction);if(t.length===0)return t;let n=t.map(e=>e.id);await this.eventBus.requestingBids.legacyEmit(n);let r=Gh.markStartTask(`microtask`,[`SlotManger`,`requestBids`,`1`]),i=this._slotEventBus.preRequestBids.legacyEmit(n);r.markEndTask(),await i;let a=Gh.markStartTask(`microtask`,[`SlotManger`,`requestBids`,`2`]),o=this._slotEventBus.requestingBids.legacyEmit(n);a.markEndTask(),await o;let s=Gh.markStartTask(`microtask`,[`SlotManger`,`requestBids`,`3`]),c=this.eventBus.requestedBids.legacyEmit(n);return s.markEndTask(),await c,t}async refreshBids(e,t=0,n=!0){let r=this.castArray(e).filter(e=>e.enabledForAuction);if(r.length>0){let e=r.map(e=>e.id);this._clearTargetingKeysOnRefresh(r),await this.eventBus.refreshingBids.legacyEmit(e),await this._slotEventBus.preRequestBids.legacyEmit(e),await this._slotEventBus.refreshingBids.legacyEmit({managedSlotsIds:e,auctionCount:t,setTargeting:n})}return r}castArray(e){if(typeof e==`string`){let t=this._slots.get(e);return t===void 0?[]:[t]}return Array.isArray(e)?e:[e]}setupSlotRenderedListener(){this._gamEventBus.slotRenderEnded.on(e=>{let t=this._slots.get(e.slotId);this.slotAdvertiserID.set(e.slotId,e.event.advertiserId),t&&(t.slotFullyRenderedSince=new Date().getTime())})}_clearTargetingKeysOnRefresh(e){e.forEach(e=>{e.clearSlotTargetingFlag(this._refreshTargetingKeys)})}_generateNewUUIDsForSlots(e){e.forEach(e=>{e.refreshImpressionId()})}_setRubiconBidFailedTargeting(e){let t=e.errorCode,n=TW.includes(t),r=this.getSlot(e.adUnitCode);if(n){let e=this._googleAdManager.getTargetingValuesForFlag(DW);if(e.push(EW),this._googleAdManager.setTargetingFlag(DW,e.filter(GW),!0),this._magniteBotTrafficExperiment.result){let e=Is();M.event(`SlotManager`,`setRubiconBidFailedTargeting`,`Magnite error targeting for bot`,{panoramaId:e})}}r&&r.setSlotTargetingFlag(EW,[t],!0)}_getBannerWidthSizeSorter(e){let t=e.includes(`sm`)?`sm`:e;return this._getSizeSorter(t)}_getSizeSorter(e){let t;return t=e===`bg`?this._largeSizeSorter:e===`sm`?this._smallSizeSorter:this._valueSizeSorter,t}},PS=D([Q(`SlotManager`),C(),A(`design:paramtypes`,[typeof(yS=z!==void 0&&z)==`function`?yS:Object,typeof(bS=Zh!==void 0&&Zh)==`function`?bS:Object,typeof(xS=_h!==void 0&&_h)==`function`?xS:Object,typeof(SS=Vr!==void 0&&Vr)==`function`?SS:Object,typeof(CS=Rr!==void 0&&Rr)==`function`?CS:Object,typeof(wS=zh!==void 0&&zh)==`function`?wS:Object,typeof(TS=Ur!==void 0&&Ur)==`function`?TS:Object,typeof(ES=Pr!==void 0&&Pr)==`function`?ES:Object,typeof(DS=cb!==void 0&&cb)==`function`?DS:Object,typeof(OS=Ki!==void 0&&Ki)==`function`?OS:Object,typeof(kS=$y!==void 0&&$y)==`function`?kS:Object,typeof(AS=eb!==void 0&&eb)==`function`?AS:Object,typeof(jS=nb!==void 0&&nb)==`function`?jS:Object,typeof(MS=rb!==void 0&&rb)==`function`?MS:Object,typeof(NS=lb!==void 0&&lb)==`function`?NS:Object])],PS)})),FS=o((()=>{Woe()})),IS,LS,RS,zS,BS,VS,HS=o((()=>{rU(),Bh(),X(),Na(),bt(),vh(),w(),j(),E(),O(),VS=class{constructor(e,t,n,r,i){this._pageManager=e,this._spaEventBus=t,this.gamEventBus=n,this.footerEventBus=r,this._slots=i,T(this,`scroll`,new k),T(this,`resize`,new k),T(this,`pageVisibility`,new k),T(this,`videoPlaying`,new k),T(this,`videoSlotRendered`,new k),T(this,`loggingBidWon`,new k),T(this,`videoImpression`,new k),T(this,`spaListeners`,[]),this._setupSpaListeners(),this.addEventListeners(),this.gamEventBus.slotResponseReceived.on(({slotId:e})=>{let t=this._slots.get(e);(t==null?void 0:t.location)===F.Footer&&this.footerEventBus.footerResponseReceived.emit()}),this.gamEventBus.slotRenderEnded.on(({slotId:e})=>{let t=this._slots.get(e);(t==null?void 0:t.location)===F.Footer&&this.footerEventBus.footerRenderEnded.emit(t.refreshCount)})}_setupSpaListeners(){this._spaEventBus.routeChanged.on(()=>{this.spaListeners.forEach(e=>e()),this.spaListeners.length=0}),this._spaEventBus.resetCompleted.on(()=>{this.addEventListeners()})}addEventListeners(){let e=!1,t=!1,n=()=>{e||(e=!0,setTimeout(()=>{this.scroll.emit(),e=!1},100))},r=()=>{t||(t=!0,setTimeout(()=>{this.resize.emit(),t=!1},100))};this.spaListeners.push(this._pageManager.scroll.on(()=>n())),this.spaListeners.push(this._pageManager.resize.on(()=>r())),this.spaListeners.push(this._pageManager.visibilityChange.on(()=>{this.pageVisibility.emit(document.hidden)}))}emitVideoPlayingEvent(e){this.videoPlaying.emit(e)}emitVideoSlotRenderedEvent(e){this.videoSlotRendered.emit(e)}emitVideoImpressionEvent(e){this.videoImpression.emit(e)}},VS=D([C(),A(`design:paramtypes`,[typeof(IS=ja!==void 0&&ja)==`function`?IS:Object,typeof(LS=zr!==void 0&&zr)==`function`?LS:Object,typeof(RS=zh!==void 0&&zh)==`function`?RS:Object,typeof(zS=xr!==void 0&&xr)==`function`?zS:Object,typeof(BS=_h!==void 0&&_h)==`function`?BS:Object])],VS)})),US,WS,GS=o((()=>{US=e=>Array.isArray(e)?e:[e],WS=(e,t)=>{t=US(t),t.forEach(t=>{e.classList.contains(t)?e.classList.remove(t):e.classList.add(t)})}})),KS,Goe=o((()=>{wp(),E(),KS=class{constructor(e,t){T(this,`_container`,document.createElement(`DIV`)),T(this,`_progressBar`,document.createElement(`DIV`)),T(this,`_progressBarIndicator`,document.createElement(`DIV`)),T(this,`_progressBarHandle`,document.createElement(`DIV`)),T(this,`_isDragging`,!1),T(this,`_startDraggingHandler`,this._handleDragProgress.bind(this)),T(this,`_stopDraggingHandler`,this._handleStopDragProgress.bind(this)),T(this,`_videoElement`,void 0),T(this,`_isVisible`,void 0),T(this,`_throttledKeyboardControl`,Sp(e=>{switch(e.code){case`ArrowRight`:this._fastForwardVideo();break;case`ArrowLeft`:this._rewindVideo();break}},100)),this._videoElement=e,this._isVisible=t,this.init()}isDragging(){return this._isDragging}toggle(e){e?this._container.classList.add(`active`):this._container.classList.remove(`active`)}update(){if(!this._isVisible()||this._isDragging)return;let{currentTime:e,duration:t}=this._videoElement,n=e/t;this._setProgressPosition(n)}init(){this._createProgressBar(),this._setupListeners()}_createProgressBar(){this._container.tabIndex=0,this._container.className=`adthrive-player-progress-bar-container`,this._progressBar.className=`adthrive-player-progress-bar`,this._progressBarHandle.className=`adthrive-player-progress-bar-handle`,this._progressBar.appendChild(this._progressBarIndicator),this._container.appendChild(this._progressBar),this._container.appendChild(this._progressBarHandle)}_setupListeners(){this._container.addEventListener(`click`,this._seekVideoOnClick.bind(this)),this._container.addEventListener(`keydown`,this._handleKeyboardControl.bind(this)),this._progressBarHandle.addEventListener(`pointerdown`,this._handleStartDragProgress.bind(this)),this._videoElement.addEventListener(`timeupdate`,this.update.bind(this))}_setProgressPosition(e){this._progressBarHandle.style.left=`${e*100}%`,this._progressBarIndicator.style.transform=`scaleX(${e})`}_seekVideoOnClick(e){this._seekVideo(e.clientX)}_seekVideo(e){let t=this._container.getBoundingClientRect(),n=e-t.left,r=n/t.width,i=r*this._videoElement.duration;this._videoElement.currentTime=i}_fastForwardVideo(e=.05){let t=this._videoElement.duration,n=t*e;this._videoElement.currentTime=Math.min(this._videoElement.currentTime+n,t)}_rewindVideo(e=.05){let t=this._videoElement.duration,n=t*e;this._videoElement.currentTime=Math.max(this._videoElement.currentTime-n,0)}_handleKeyboardControl(e){[`Space`,`Enter`,`ArrowLeft`,`ArrowRight`].includes(e.code)&&e.preventDefault(),this._throttledKeyboardControl(e)}_handleStartDragProgress(e){this._isDragging||(e.preventDefault(),this._isDragging=!0,this._container.setPointerCapture(e.pointerId),document.addEventListener(`pointermove`,this._startDraggingHandler),document.addEventListener(`pointerup`,this._stopDraggingHandler))}_handleDragProgress(e){let t=e.clientX;e.preventDefault();let n=this._container.getBoundingClientRect(),r=t-n.left;r=Math.max(0,Math.min(r,n.width));let i=r/n.width;this._setProgressPosition(i)}_handleStopDragProgress(e){let t=e.clientX;this._isDragging=!1,this._container.releasePointerCapture(e.pointerId),document.removeEventListener(`pointermove`,this._startDraggingHandler),document.removeEventListener(`pointerup`,this._stopDraggingHandler),this._seekVideo(t)}}})),Koe=o((()=>{Goe()})),qS,qoe=o((()=>{wW(),qS={languages:{path:`captions`,key:`language`,title:`Captions`,options:[{label:`Settings`,value:`settings`,action:`show`,persist:!0},...Object.entries(CW).map(([e,t])=>({label:t,value:e,action:`update`,persist:e===``}))],parent:``},settings:{path:`settings`,key:`settings`,title:`Settings`,options:[{label:`Font Color`,value:`fontColor`,action:`show`},{label:`Font Opacity`,value:`fontOpacity`,action:`show`},{label:`Font Size`,value:`fontSize`,action:`show`},{label:`Font Family`,value:`fontFamily`,action:`show`},{label:`Text Shadow`,value:`textShadow`,action:`show`},{label:`Background Color`,value:`backgroundColor`,action:`show`},{label:`Background Opacity`,value:`backgroundOpacity`,action:`show`},{label:`Window Color`,value:`windowColor`,action:`show`},{label:`Window Opacity`,value:`windowOpacity`,action:`show`}],parent:`language`},fontColor:{path:`fontColor`,key:`fontColor`,title:`Font Color`,options:[{label:`White`,value:`white`,action:`update`},{label:`Black`,value:`black`,action:`update`},{label:`Red`,value:`red`,action:`update`},{label:`Green`,value:`green`,action:`update`},{label:`Blue`,value:`blue`,action:`update`},{label:`Yellow`,value:`yellow`,action:`update`},{label:`Magenta`,value:`magenta`,action:`update`},{label:`Cyan`,value:`cyan`,action:`update`}],parent:`settings`},fontOpacity:{path:`fontOpacity`,key:`fontOpacity`,title:`Font Opacity`,options:[{label:`100%`,value:`100%`,action:`update`},{label:`75%`,value:`75%`,action:`update`},{label:`50%`,value:`50%`,action:`update`},{label:`25%`,value:`25%`,action:`update`}],parent:`settings`},fontSize:{path:`fontSize`,key:`fontSize`,title:`Font Size`,options:[{label:`200%`,value:`200%`,action:`update`},{label:`175%`,value:`175%`,action:`update`},{label:`150%`,value:`150%`,action:`update`},{label:`125%`,value:`125%`,action:`update`},{label:`100%`,value:`100%`,action:`update`},{label:`75%`,value:`75%`,action:`update`},{label:`50%`,value:`50%`,action:`update`}],parent:`settings`},fontFamily:{path:`fontFamily`,key:`fontFamily`,title:`Font Family`,options:[{label:`Arial`,value:`Arial`,action:`update`},{label:`Georgia`,value:`Georgia`,action:`update`},{label:`Garamond`,value:`Garamond`,action:`update`},{label:`Courier New`,value:`Courier New`,action:`update`},{label:`Tahoma`,value:`Tahoma`,action:`update`},{label:`Times New Roman`,value:`Times New Roman`,action:`update`},{label:`Trebuchet MS`,value:`Trebuchet MS`,action:`update`},{label:`Verdana`,value:`Verdana`,action:`update`}],parent:`settings`},textShadow:{path:`textShadow`,key:`textShadow`,title:`Text Shadow`,options:[{label:`None`,value:`none`,action:`update`},{label:`Raised`,value:`raised`,action:`update`},{label:`Depressed`,value:`depressed`,action:`update`},{label:`Uniform`,value:`uniform`,action:`update`},{label:`Drop Shadow`,value:`drop shadow`,action:`update`}],parent:`settings`},backgroundColor:{path:`backgroundColor`,key:`backgroundColor`,title:`Background Color`,options:[{label:`White`,value:`white`,action:`update`},{label:`Black`,value:`black`,action:`update`},{label:`Red`,value:`red`,action:`update`},{label:`Green`,value:`green`,action:`update`},{label:`Blue`,value:`blue`,action:`update`},{label:`Yellow`,value:`yellow`,action:`update`},{label:`Magenta`,value:`magenta`,action:`update`},{label:`Cyan`,value:`cyan`,action:`update`}],parent:`settings`},backgroundOpacity:{path:`backgroundOpacity`,key:`backgroundOpacity`,title:`Background Opacity`,options:[{label:`100%`,value:`100%`,action:`update`},{label:`75%`,value:`75%`,action:`update`},{label:`50%`,value:`50%`,action:`update`},{label:`25%`,value:`25%`,action:`update`},{label:`0%`,value:`0%`,action:`update`}],parent:`settings`},windowColor:{path:`windowColor`,key:`windowColor`,title:`Window Color`,options:[{label:`White`,value:`white`,action:`update`},{label:`Black`,value:`black`,action:`update`},{label:`Red`,value:`red`,action:`update`},{label:`Green`,value:`green`,action:`update`},{label:`Blue`,value:`blue`,action:`update`},{label:`Yellow`,value:`yellow`,action:`update`},{label:`Magenta`,value:`magenta`,action:`update`},{label:`Cyan`,value:`cyan`,action:`update`}],parent:`settings`},windowOpacity:{path:`windowOpacity`,key:`windowOpacity`,title:`Window Opacity`,options:[{label:`100%`,value:`100%`,action:`update`},{label:`75%`,value:`75%`,action:`update`},{label:`50%`,value:`50%`,action:`update`},{label:`25%`,value:`25%`,action:`update`},{label:`0%`,value:`0%`,action:`update`}],parent:`settings`}}})),JS,Joe=o((()=>{E(),JS=class{static bootstrap(){let e=document.createElement(`div`),t=document.createElement(`div`),n=document.createElement(`span`),r=document.createElement(`div`);e.classList.add(this.CLASSES.CONTAINER),t.classList.add(this.CLASSES.HEADER),n.classList.add(this.CLASSES.TITLE),r.classList.add(this.CLASSES.BODY);let i=this._createBackButton();t.appendChild(i),t.appendChild(n);let a=this._createCloseButton();return t.appendChild(a),e.appendChild(t),e.appendChild(r),[e,n,r]}static show(e,t=null,n=null,r=!1){t&&t.classList.remove(this.CLASSES.PAGE_ACTIVE),n&&(n.classList.add(this.CLASSES.PAGE_ACTIVE),r?e.classList.add(this.CLASSES.NESTED):e.classList.remove(this.CLASSES.NESTED)),this._scrollup(e),e.classList.add(this.CLASSES.ACTIVE)}static hide(e){e.classList.remove(this.CLASSES.ACTIVE)}static isActive(e){return e.classList.contains(this.CLASSES.ACTIVE)}static updateTitle(e,t=``){e.innerText=t}static createOptionList(e,t){let n=document.createElement(`div`);return n.classList.add(this.CLASSES.PAGE),n.dataset.key=e,t.forEach(e=>{let t=this._createOptionListItem(e.label,e.value,e.action,e.persist);n.appendChild(t)}),n}static updateOptionListAllowedValues(e,t){let n=Array.from(e.children).filter(e=>e instanceof HTMLButtonElement);n.forEach(e=>{let n=this.CLASSES.PAGE_ITEM_UNAVAILABLE,{persist:r,value:i}=e.dataset,a=i?t.includes(i):!1;r||a?e.classList.remove(n):e.classList.add(n)})}static updateOptionListSelection(e,t){let n=this.CLASSES.PAGE_ITEM_SELECTED,r=Array.from(e.children).filter(e=>e instanceof HTMLElement);r.forEach(e=>{t===e.dataset.value?e.classList.add(n):e.classList.remove(n)})}static updateOptionListItemPreview(e,t,n){let r=e.querySelector(`button[data-value="${t}"] span.raptive-player-settings-page-item-value`);r&&(r.innerText=n)}static _createOptionListItem(e,t,n,r=!1){let i=document.createElement(`button`);i.setAttribute(`type`,`button`),i.classList.add(this.CLASSES.PAGE_ITEM),i.dataset.action=n,i.dataset.value=t,r&&(i.dataset.persist=`true`);let a=document.createElement(`span`);a.innerText=e,i.appendChild(a);let o=document.createElement(`span`);if(o.classList.add(`raptive-player-settings-page-item-value`),i.appendChild(o),n===`show`){let e=document.createElement(`span`),t=this._createForwardIcon();e.appendChild(t),i.appendChild(e)}return i}static _scrollup(e){e!=null&&e.lastElementChild&&(e.lastElementChild.scrollTop=0)}static _createBackButton(){let e=document.createElement(`button`);e.setAttribute(`type`,`button`),e.classList.add(this.CLASSES.BACK_BUTTON),e.dataset.action=`back`;let t=this._createBackIcon();return e.appendChild(t),e}static _createBackIcon(){let e=`http://www.w3.org/2000/svg`,t=document.createElementNS(e,`svg`);t.style.pointerEvents=`none`,t.setAttribute(`viewBox`,`0 0 24 24`),t.setAttribute(`width`,`24`),t.setAttribute(`height`,`24`),t.setAttribute(`stroke`,`currentColor`),t.setAttribute(`stroke-width`,`2`),t.setAttribute(`fill`,`none`),t.setAttribute(`stroke-linecap`,`round`),t.setAttribute(`stroke-linejoin`,`round`),t.setAttribute(`class`,`feather feather-chevron-left`);let n=document.createElementNS(e,`polyline`);return n.setAttribute(`points`,`15 18 9 12 15 6`),t.appendChild(n),t}static _createForwardIcon(){let e=`http://www.w3.org/2000/svg`,t=document.createElementNS(e,`svg`);t.style.pointerEvents=`none`,t.setAttribute(`viewBox`,`0 0 24 24`),t.setAttribute(`width`,`20`),t.setAttribute(`height`,`20`),t.setAttribute(`fill`,`none`),t.setAttribute(`stroke`,`currentColor`),t.setAttribute(`stroke-width`,`2`),t.setAttribute(`stroke-linecap`,`round`),t.setAttribute(`stroke-linejoin`,`round`),t.setAttribute(`class`,`feather feather-chevron-right`);let n=document.createElementNS(e,`polyline`);return n.setAttribute(`points`,`9 18 15 12 9 6`),t.appendChild(n),t}static _createCloseButton(){let e=document.createElement(`button`);e.setAttribute(`type`,`button`),e.classList.add(this.CLASSES.CLOSE_BUTTON),e.dataset.action=`hide`;let t=this._createCloseIcon();return e.appendChild(t),e}static _createCloseIcon(){let e=`http://www.w3.org/2000/svg`,t=document.createElementNS(e,`svg`);t.style.pointerEvents=`none`,t.setAttribute(`viewBox`,`0 0 24 24`),t.setAttribute(`width`,`24`),t.setAttribute(`height`,`24`),t.setAttribute(`stroke`,`currentColor`),t.setAttribute(`stroke-width`,`2`),t.setAttribute(`fill`,`none`),t.setAttribute(`stroke-linecap`,`round`),t.setAttribute(`stroke-linejoin`,`round`),t.setAttribute(`class`,`css-i6dzq1`);let n=document.createElementNS(e,`line`);n.setAttribute(`x1`,`18`),n.setAttribute(`y1`,`6`),n.setAttribute(`x2`,`6`),n.setAttribute(`y2`,`18`);let r=document.createElementNS(e,`line`);return r.setAttribute(`x1`,`6`),r.setAttribute(`y1`,`6`),r.setAttribute(`x2`,`18`),r.setAttribute(`y2`,`18`),t.appendChild(n),t.appendChild(r),t}},T(JS,`CLASSES`,Object.freeze({CONTAINER:`raptive-player-settings`,ACTIVE:`raptive-player-settings--active`,NESTED:`raptive-player-settings--nested`,HEADER:`raptive-player-settings-header`,BACK_BUTTON:`raptive-player-settings-back`,TITLE:`raptive-player-settings-header-title`,CLOSE_BUTTON:`raptive-player-settings-close`,BODY:`raptive-player-settings-body`,PAGE:`raptive-player-settings-page`,PAGE_ACTIVE:`raptive-player-settings-page--active`,PAGE_ITEM:`raptive-player-settings-page-item`,PAGE_ITEM_SELECTED:`raptive-player-settings-page-item--selected`,PAGE_ITEM_UNAVAILABLE:`raptive-player-settings-page-item--unavailable`}))})),YS,Yoe=o((()=>{w(),qoe(),Joe(),Fm(),tU(),E(),YS=class{constructor(){T(this,`_container`,void 0),T(this,`_title`,void 0),T(this,`_body`,void 0),T(this,`_pages`,new Map),T(this,`_activePage`,``),T(this,`_state`,x.resolve(Pm)),T(this,`_videoEventBus`,x.resolve(eU)),[this._container,this._title,this._body]=JS.bootstrap(),this._initPages(),this._initOptionListSelections(),this._setupListeners(),this._videoEventBus.settingsUpdated.on(e=>this._updateSettingUI(e.key,e.value))}get el(){return this._container}show(e){let t=this._pages.get(this._activePage)||null,n=e?this._pages.get(e):null,r=!!(n!=null&&n.parent);this._activePage=e==null?``:e,JS.show(this._container,t==null?void 0:t.el,n==null?void 0:n.el,r),JS.updateTitle(this._title,n==null?void 0:n.title)}hide(){JS.hide(this._container)}toggle(e){JS.isActive(this._container)?this.hide():this.show(e)}updatePageOptions(e,t){let n=this._pages.get(e);n&&JS.updateOptionListAllowedValues(n.el,t)}_back(){let e=this._pages.get(this._activePage);e&&this.show(e.parent)}_update(e,t){if(!(e in this._state.settings))return;this._state.updateSetting(e,t),this._updateSettingUI(e,t);let n=this._pages.get(e);n!=null&&n.parent&&this._back()}_updateSettingUI(e,t){let n=this._pages.get(e);n&&(JS.updateOptionListItemPreview(this._container,e,t),JS.updateOptionListSelection(n.el,t))}_initPages(){Object.values(qS).forEach(e=>{let t=JS.createOptionList(e.key,e.options);this._addPage(e.key,e.title,t,e.parent)})}_initOptionListSelections(){Object.entries(this._state.settings).forEach(([e,t])=>{JS.updateOptionListItemPreview(this._container,e,t);let n=this._pages.get(e);n&&JS.updateOptionListSelection(n.el,t)})}_addPage(e,t,n,r=``){this._pages.set(e,{el:n,title:t,parent:r}),this._body.appendChild(n)}_setupListeners(){this._container.addEventListener(`click`,e=>{var t;if(!(e.target instanceof HTMLElement))return;let n=e.target.closest(`button`);if(!n)return;let r=n.dataset.action,i=(t=n.dataset.value)==null?``:t;if(r)switch(r){case`show`:this.show(i);break;case`hide`:this.hide();break;case`back`:this._back();break;case`update`:var a,o;let e=(a=(o=n.parentElement)==null?void 0:o.dataset.key)==null?``:a;this._update(e,i);break}})}}})),XS,Xoe=o((()=>{E(),XS=class{static createCaptionsContainer(){let e=document.createElement(`div`);e.classList.add(this.CLASSES.CAPTIONS);let t=document.createElement(`span`);return e.appendChild(t),e}static createCaptionsButton(e){let t=document.createElement(`button`);return t.setAttribute(`type`,`button`),t.innerText=`CC`,t.classList.add(this.CLASSES.CAPTIONS_BUTTON),t.addEventListener(`click`,()=>e()),t}static toggleCaptionsButton(e,t){t?e.classList.add(this.CLASSES.CAPTIONS_BUTTON_VISIBLE):e.classList.remove(this.CLASSES.CAPTIONS_BUTTON_VISIBLE)}static updateCaptionStyles(e,t,n){let r=e.firstElementChild;if(r)switch(t){case`fontColor`:e.style.color=this._getColor(`font`,n);break;case`fontOpacity`:e.style.setProperty(this.VARIABLES.FONT_OPACITY,n);break;case`fontSize`:r.style.fontSize=n;break;case`fontFamily`:e.style.fontFamily=n;break;case`textShadow`:e.style.textShadow=this._getTextShadow(n);break;case`backgroundColor`:r.style.backgroundColor=this._getColor(`background`,n);break;case`backgroundOpacity`:e.style.setProperty(this.VARIABLES.BACKGROUND_OPACITY,n);break;case`windowColor`:e.style.backgroundColor=this._getColor(`window`,n);break;case`windowOpacity`:e.style.setProperty(this.VARIABLES.WINDOW_OPACITY,n);break;default:break}}static displayCaption(e,t){let n=e.children[0];n.innerText=t,e.style.display=`block`}static clearCaption(e){let t=e.children[0];e.style.display=`none`,t.innerText=``}static _getColor(e,t){let n={font:this.VARIABLES.FONT_OPACITY,background:this.VARIABLES.BACKGROUND_OPACITY,window:this.VARIABLES.WINDOW_OPACITY},r={white:`0, 0%, 100%`,black:`0, 0%, 0%`,red:`0, 100%, 50%`,green:`120, 100%, 50%`,blue:`240, 100%, 50%`,yellow:`60, 100%, 50%`,magenta:`300, 100%, 50%`,cyan:`180, 100%, 50%`};return r[t]?`hsla(${r[t]}, var(${n[e]}))`:t}static _getTextShadow(e){let t={none:``,raised:`rgb(0, 0, 0) 0px 0px 5px, rgb(0, 0, 0) 0px 1px 5px, rgb(0, 0, 0) 0px 2px 5px`,depressed:`rgb(0, 0, 0) 0px -2px 1px`,uniform:`rgb(0, 0, 0) -2px 0px 1px, rgb(0, 0, 0) 2px 0px 1px, rgb(0, 0, 0) 0px -2px 1px, rgb(0, 0, 0) 0px 2px 1px, rgb(0, 0, 0) -1px 1px 1px, rgb(0, 0, 0) 1px 1px 1px, rgb(0, 0, 0) 1px -1px 1px, rgb(0, 0, 0) 1px 1px 1px`,"drop shadow":`rgb(0, 0, 0) 0px 2px 1px`};return t[e]||``}},T(XS,`CLASSES`,Object.freeze({CAPTIONS:`raptive-player-captions`,CAPTIONS_BUTTON:`raptive-player-captions-button`,CAPTIONS_BUTTON_VISIBLE:`raptive-player-captions-button--visible`})),T(XS,`VARIABLES`,Object.freeze({FONT_OPACITY:`--raptive-player-captions-font-opacity`,BACKGROUND_OPACITY:`--raptive-player-captions-background-opacity`,WINDOW_OPACITY:`--raptive-player-captions-window-opacity`}))})),ZS,Zoe=o((()=>{E(),ZS=class{constructor(){T(this,`seperator`,`,`)}timestampToSeconds(e){let[t,n]=e.split(`,`),r=parseInt(n),[i,a,o]=t.split(`:`).map(e=>parseInt(e)),s=r*.001+o+60*a+3600*i;return Math.round(s*1e3)/1e3}correctFormat(e){let t=e.replace(`.`,`,`);var n=null,r=null,i=null,a=null,[o,s]=t.split(`,`);a=this.fixed_str_digit(3,s);var[c,l,u]=o.split(`:`);return n=this.fixed_str_digit(2,c,!1),r=this.fixed_str_digit(2,l,!1),i=this.fixed_str_digit(2,u,!1),`${n}:${r}:${i},${a}`}fixed_str_digit(e,t,n=!0){if(t.length==e)return t;if(t.length>e)return t.slice(0,e);if(t.length<e)return n?t.padEnd(e,`0`):t.padStart(e,`0`)}tryComma(e){e=e.replace(/\r/g,``);var t=/(\d+)\n(\d{1,2}:\d{2}:\d{2},\d{1,3}) --> (\d{1,2}:\d{2}:\d{2},\d{1,3})/g;let n=e.split(t);return n.shift(),n}tryDot(e){e=e.replace(/\r/g,``);var t=/(\d+)\n(\d{1,2}:\d{2}:\d{2}\.\d{1,3}) --> (\d{1,2}:\d{2}:\d{2}\.\d{1,3})/g;let n=e.split(t);return n.shift(),this.seperator=`.`,n}fromSrt(e){var t=e,n=this.tryComma(t);n.length==0&&(n=this.tryDot(t));for(var r=[],i=0;i<n.length;i+=4){let e=this.correctFormat(n[i+1].trim()),t=this.correctFormat(n[i+2].trim());var a={id:n[i].trim(),startTime:e,startSeconds:this.timestampToSeconds(e),endTime:t,endSeconds:this.timestampToSeconds(t),text:n[i+3].trim()};r.push(a)}return r}toSrt(e){for(var t=``,n=0;n<e.length;n++){var r=e[n];t+=r.id+`\r
`,t+=r.startTime+` --> `+r.endTime+`\r
`,t+=r.text.replace(`
`,`\r
`)+`\r
\r
`}return t}}})),Qoe=s((exports=>{(function(){var t={direction:`horizontal`,snapToLines:!0,linePosition:`auto`,lineAlign:`start`,textPosition:`auto`,positionAlign:`auto`,size:100,alignment:`center`},n=function(e){e||(e={"&amp":`&`,"&lt":`<`,"&gt":`>`,"&lrm":`‎`,"&rlm":`‏`,"&nbsp":`\xA0`}),this.entities=e,this.parse=function(n,a){n=n.replace(/\0/g,`�`);var o=/\r\n|\r|\n/,s=Date.now(),c=0,l=n.split(o),u=!1,d=[],f=[],p=[];function m(e,t){p.push({message:e,line:c+1,col:t})}var h=l[c],g=h.length,_=`WEBVTT`,v=0,y=_.length;for(h[0]===`﻿`&&(v=1,y+=1),(g<y||h.indexOf(_)!==0+v||g>y&&h[y]!==` `&&h[y]!==`	`)&&m(`No valid signature. (File needs to start with "WEBVTT".)`),c++;l[c]!=``&&l[c]!=null;){if(m(`No blank line after the signature.`),l[c].indexOf(`-->`)!=-1){u=!0;break}c++}for(;l[c]!=null;){for(var b;!u&&l[c]==``;)c++;if(!u&&l[c]==null)break;b=Object.assign({},t,{id:``,startTime:0,endTime:0,pauseOnExit:!1,direction:`horizontal`,snapToLines:!0,linePosition:`auto`,lineAlign:`start`,textPosition:`auto`,positionAlign:`auto`,size:100,alignment:`center`,text:``,tree:null});var ee=!0;if(l[c].indexOf(`-->`)==-1){if(b.id=l[c],/^NOTE($|[ \t])/.test(b.id)){for(c++;l[c]!=``&&l[c]!=null;)l[c].indexOf(`-->`)!=-1&&m(`Cannot have timestamp in a comment.`),c++;continue}if(/^STYLE($|[ \t])/.test(b.id)){var te=[],ne=!1;for(c++;l[c]!=``&&l[c]!=null;)l[c].indexOf(`-->`)!=-1&&(m(`Cannot have timestamp in a style block.`),ne=!0),te.push(l[c]),c++;if(f.length){m(`Style blocks cannot appear after the first cue.`);continue}ne||d.push(te.join(`
`));continue}if(c++,l[c]==``||l[c]==null){m(`Cue identifier cannot be standalone.`);continue}if(l[c].indexOf(`-->`)==-1){ee=!1,m(`Cue identifier needs to be followed by timestamp.`);continue}}u=!1;var re=new r(l[c],m),ie=0;if(f.length>0&&(ie=f[f.length-1].startTime),ee&&!re.parse(b,ie)){for(b=null,c++;l[c]!=``&&l[c]!=null;){if(l[c].indexOf(`-->`)!=-1){u=!0;break}c++}continue}for(c++;l[c]!=``&&l[c]!=null;){if(l[c].indexOf(`-->`)!=-1){m(`Blank line missing before cue.`),u=!0;break}b.text!=``&&(b.text+=`
`),b.text+=l[c],c++}var ae=new i(b.text,m,a,e);b.tree=ae.parse(b.startTime,b.endTime),f.push(b)}return f.sort(function(e,t){return e.startTime<t.startTime?-1:e.startTime>t.startTime?1:e.endTime>t.endTime?-1:e.endTime<t.endTime?1:0}),{cues:f,errors:p,time:Date.now()-s,styles:d}}},r=function(e,t){var n=/[\u0020\t\f]/,r=/[^\u0020\t\f]/,e=e,i=0,a=function(e){t(e,i+1)},o=!0;function s(t){for(;e[i]!=null&&t.test(e[i]);)i++}function c(t){for(var n=``;e[i]!=null&&t.test(e[i]);)n+=e[i],i++;return n}function l(){var t=`minutes`,n,r,o,s;if(e[i]==null){a(`No timestamp found.`);return}if(!/\d/.test(e[i])){a(`Timestamp must start with a character in the range 0-9.`);return}if(n=c(/\d/),(n.length>2||parseInt(n,10)>59)&&(t=`hours`),e[i]!=`:`){a(`No time unit separator found.`);return}if(i++,r=c(/\d/),r.length!=2){a(`Must be exactly two digits.`);return}if(t==`hours`||e[i]==`:`){if(e[i]!=`:`){a(`No seconds found or minutes is greater than 59.`);return}if(i++,o=c(/\d/),o.length!=2){a(`Must be exactly two digits.`);return}}else{if(n.length!=2){a(`Must be exactly two digits.`);return}o=r,r=n,n=`0`}if(e[i]!=`.`){a(`No decimal separator (".") found.`);return}if(i++,s=c(/\d/),s.length!=3){a(`Milliseconds must be given in three digits.`);return}if(parseInt(r,10)>59){a(`You cannot have more than 59 minutes.`);return}if(parseInt(o,10)>59){a(`You cannot have more than 59 seconds.`);return}return parseInt(n,10)*60*60+parseInt(r,10)*60+parseInt(o,10)+parseInt(s,10)/1e3}function u(e,t){for(var r=e.split(n),i=[],o=0;o<r.length;o++)if(r[o]!=``){var s=r[o].indexOf(`:`),c=r[o].slice(0,s),l=r[o].slice(s+1);if(i.indexOf(c)!=-1&&a(`Duplicate setting.`),i.push(c),l==``){a(`No value for setting defined.`);return}if(c==`vertical`){if(l!=`rl`&&l!=`lr`){a(`Writing direction can only be set to 'rl' or 'rl'.`);continue}t.direction=l}else if(c==`line`){if(/,/.test(l)){var u=l.split(`,`);l=u[0];var d=u[1]}if(!/^[-\d](\d*)(\.\d+)?%?$/.test(l)){a(`Line position takes a number or percentage.`);continue}if(l.indexOf(`-`,1)!=-1){a(`Line position can only have '-' at the start.`);continue}if(l.indexOf(`%`)!=-1&&l.indexOf(`%`)!=l.length-1){a(`Line position can only have '%' at the end.`);continue}if(l[0]==`-`&&l[l.length-1]==`%`){a(`Line position cannot be a negative percentage.`);continue}var f=l,p=!1;if(l[l.length-1]==`%`&&(p=!0,f=l.slice(0,l.length-1),parseInt(l,10)>100)){a(`Line position cannot be >100%.`);continue}if(f===``||isNaN(f)||!isFinite(f)){a(`Line position needs to be a number`);continue}if(d!==void 0){if(![`start`,`center`,`end`].includes(d)){a(`Line alignment needs to be one of start, center or end`);continue}t.lineAlign=d}t.snapToLines=!p,t.linePosition=parseFloat(f),parseFloat(f).toString()!==f&&(t.nonSerializable=!0)}else if(c==`position`){if(/,/.test(l)){var u=l.split(`,`);l=u[0];var m=u[1]}if(l[l.length-1]!=`%`){a(`Text position must be a percentage.`);continue}if(parseInt(l,10)>100||parseInt(l,10)<0){a(`Text position needs to be between 0 and 100%.`);continue}if(f=l.slice(0,l.length-1),f===``||isNaN(f)||!isFinite(f)){a(`Line position needs to be a number`);continue}if(m!==void 0){if(![`line-left`,`center`,`line-right`].includes(m)){a(`Position alignment needs to be one of line-left, center or line-right`);continue}t.positionAlign=m}t.textPosition=parseFloat(f)}else if(c==`size`){if(l[l.length-1]!=`%`){a(`Size must be a percentage.`);continue}if(parseInt(l,10)>100){a(`Size cannot be >100%.`);continue}var h=l.slice(0,l.length-1);if(h===void 0||h===``||isNaN(h)){a(`Size needs to be a number`),h=100;continue}else if(h=parseFloat(h),h<0||h>100){a(`Size needs to be between 0 and 100%.`);continue}t.size=h}else if(c==`align`){var g=[`start`,`center`,`end`,`left`,`right`];if(g.indexOf(l)==-1){a(`Alignment can only be set to one of `+g.join(`, `)+`.`);continue}t.alignment=l}else a(`Invalid setting.`)}}this.parse=function(t,c){if(s(n),t.startTime=l(),t.startTime!=null){if(t.startTime<c&&a(`Start timestamp is not greater than or equal to start timestamp of previous cue.`),r.test(e[i])&&a(`Timestamp not separated from '-->' by whitespace.`),s(n),e[i]!=`-`){a(`No valid timestamp separator found.`);return}if(i++,e[i]!=`-`){a(`No valid timestamp separator found.`);return}if(i++,e[i]!=`>`){a(`No valid timestamp separator found.`);return}if(i++,r.test(e[i])&&a(`'-->' not separated from timestamp by whitespace.`),s(n),t.endTime=l(),t.endTime!=null)return t.endTime<=t.startTime&&a(`End timestamp is not greater than start timestamp.`),r.test(e[i])&&(o=!1),s(n),u(e.substring(i),t),!0}},this.parseTimestamp=function(){var t=l();if(e[i]!=null){a(`Timestamp must not have trailing characters.`);return}return t}},i=function(e,t,n,i){this.entities=i;var a=this,e=e,o=0,s=function(e){n!=`metadata`&&t(e,o+1)};this.parse=function(t,i){function a(e){let t={...e};return e.children&&(t.children=e.children.map(a)),t.parent&&delete t.parent,t}var l={children:[]},u=l,d=[];function f(e){u.children.push({type:`object`,name:e[1],classes:e[2],children:[],parent:u}),u=u.children[u.children.length-1]}function p(e){for(var t=u;t;){if(t.name==e)return!0;t=t.parent}}for(;e[o]!=null;){var m=c();if(m[0]==`text`)u.children.push({type:`text`,value:m[1],parent:u});else if(m[0]==`start tag`){n==`chapters`&&s(`Start tags not allowed in chapter title text.`);var h=m[1];h!=`v`&&h!=`lang`&&m[3]!=``&&s(`Only <v> and <lang> can have an annotation.`),h==`c`||h==`i`||h==`b`||h==`u`||h==`ruby`||h==`rt`&&u.name==`ruby`?f(m):h==`v`?(p(`v`)&&s(`<v> cannot be nested inside itself.`),f(m),u.value=m[3],m[3]||s(`<v> requires an annotation.`)):h==`lang`?(f(m),u.value=m[3]):s(`Incorrect start tag.`)}else if(m[0]==`end tag`)n==`chapters`&&s(`End tags not allowed in chapter title text.`),m[1]==u.name?u=u.parent:m[1]==`ruby`&&u.name==`rt`?u=u.parent.parent:s(`Incorrect end tag.`);else if(m[0]==`timestamp`){n==`chapters`&&s(`Timestamp not allowed in chapter title text.`);var g=new r(m[1],s),_=g.parseTimestamp();_!=null&&((_<=t||_>=i)&&s(`Timestamp must be between start timestamp and end timestamp.`),d.length>0&&d[d.length-1]>=_&&s(`Timestamp must be greater than any previous timestamp.`),u.children.push({type:`timestamp`,value:_,parent:u}),d.push(_))}}for(;u.parent;)u.name!=`v`&&s(`Required end tag missing.`),u=u.parent;return a(l)};function c(){for(var t=`data`,n=``,r=``,c=[];e[o-1]!=null||o==0;){var l=e[o];if(t==`data`)if(l==`&`)r=l,t=`escape`;else if(l==`<`&&n==``)t=`tag`;else if(l==`<`||l==null)return[`text`,n];else n+=l;else if(t==`escape`)if(l==`<`||l==null){s(`Incorrect escape.`);let e;return(e=r.match(/^&#([0-9]+)$/))?n+=String.fromCharCode(e[1]):a.entities[r]?n+=a.entities[r]:n+=r,[`text`,n]}else if(l==`&`)s(`Incorrect escape.`),n+=r,r=l;else if(/[a-z#0-9]/i.test(l))r+=l;else if(l==`;`){let e;(e=r.match(/^&#(x?[0-9]+)$/))?n+=String.fromCharCode(`0`+e[1]):a.entities[r+l]?n+=a.entities[r+l]:(e=Object.keys(i).find(e=>r.startsWith(e)))?n+=a.entities[e]+r.slice(e.length)+l:(s(`Incorrect escape.`),n+=r+`;`),t=`data`}else s(`Incorrect escape.`),n+=r+l,t=`data`;else if(t==`tag`)if(l==`	`||l==`
`||l==`\f`||l==` `)t=`start tag annotation`;else if(l==`.`)t=`start tag class`;else if(l==`/`)t=`end tag`;else if(/\d/.test(l))n=l,t=`timestamp tag`;else if(l==`>`||l==null)return l==`>`&&o++,[`start tag`,``,[],``];else n=l,t=`start tag`;else if(t==`start tag`)if(l==`	`||l==`\f`||l==` `)t=`start tag annotation`;else if(l==`
`)r=l,t=`start tag annotation`;else if(l==`.`)t=`start tag class`;else if(l==`>`||l==null)return l==`>`&&o++,[`start tag`,n,[],``];else n+=l;else if(t==`start tag class`)if(l==`	`||l==`\f`||l==` `)r&&c.push(r),r=``,t=`start tag annotation`;else if(l==`
`)r&&c.push(r),r=l,t=`start tag annotation`;else if(l==`.`)r&&c.push(r),r=``;else if(l==`>`||l==null)return l==`>`&&o++,r&&c.push(r),[`start tag`,n,c,``];else r+=l;else if(t==`start tag annotation`){if(l==`>`||l==null)return l==`>`&&o++,r=r.split(/[\u0020\t\f\r\n]+/).filter(function(e){if(e)return!0}).join(` `),[`start tag`,n,c,r];r+=l}else if(t==`end tag`){if(l==`>`||l==null)return l==`>`&&o++,[`end tag`,n];n+=l}else if(t==`timestamp tag`){if(l==`>`||l==null)return l==`>`&&o++,[`timestamp`,n];n+=l}else s(`Never happens.`);o++}}},a=function(){function e(e){let t=(`00`+(e-Math.floor(e)).toFixed(3)*1e3).slice(-3),n=0,r=0,i=0;return e>=3600&&(n=Math.floor(e/3600)),r=Math.floor((e-3600*n)/60),i=Math.floor(e-3600*n-60*r),(n?n+`:`:``)+(``+r).padStart(2,`0`)+`:`+(``+i).padStart(2,`0`)+`.`+t}function n(e){var n=``;let r=Object.keys(t).filter(n=>e[n]!==t[n]);return r.includes(`direction`)&&(n+=` vertical:`+e.direction),r.includes(`alignment`)&&(n+=` align:`+e.alignment),r.includes(`size`)&&(n+=` size:`+e.size+`%`),(r.includes(`lineAlign`)||r.includes(`linePosition`))&&(n+=` line:`+e.linePosition+(e.snapToLines?``:`%`)+(e.lineAlign&&e.lineAlign!=t.lineAlign?`,`+e.lineAlign:``)),(r.includes(`textPosition`)||r.includes(`positionAlign`))&&(n+=` position:`+e.textPosition+`%`+(e.positionAlign&&e.positionAlign!==t.positionAlign?`,`+e.positionAlign:``)),n}function r(t){for(var n=``,i=0;i<t.length;i++){var a=t[i];if(a.type==`text`)n+=a.value.replace(/&/g,`&amp;`).replace(/</g,`&lt;`).replace(/>/g,`&gt;`);else if(a.type==`object`){if(n+=`<`+a.name,a.classes)for(var o=0;o<a.classes.length;o++)n+=`.`+a.classes[o];a.value&&(n+=` `+a.value),n+=`>`,a.children&&(n+=r(a.children)),n+=`</`+a.name+`>`}else a.type==`timestamp`?n+=`<`+e(a.value)+`>`:n+=`<`+a.value+`>`}return n}function i(t){return(t.id===void 0?``:t.id+`
`)+e(t.startTime)+` --> `+e(t.endTime)+n(t)+`
`+r(t.tree.children)+`

`}function a(e){return`STYLE
`+e+`

`}this.serialize=function(e,t){var n=`WEBVTT

`;if(t)for(var r=0;r<t.length;r++)n+=a(t[r]);for(var r=0;r<e.length;r++)n+=i(e[r]);return n}};function o(e){e.WebVTTParser=n,e.WebVTTCueTimingsAndSettingsParser=r,e.WebVTTCueTextParser=i,e.WebVTTSerializer=a}typeof window<`u`&&o(window),exports!==void 0&&o(exports)})()})),QS,$S,eC,$oe=o((()=>{wW(),Zoe(),QS=u(Qoe()),$S=Object.keys(CW),eC=class{static async load(e){if(!e)return[];let t=await fetch(e),n=await t.text(),r=this._parse(n);return r}static getTracks(e){return e.filter(e=>this._isSupportedTrack(e)).map(e=>{let t=e.language;return{language:t,label:this._getTrackLabel(t),file:e.file,cues:[]}})}static _isSupportedTrack(e){return e.kind===`captions`&&!!e.language&&$S.includes(e.language)}static _getTrackLabel(e){var t;return(t=CW[e])==null?`Unknown`:t}static _parse(e){return e.trim().startsWith(`WEBVTT`)?this._parseVTT(e):this._parseSRT(e)}static _parseVTT(e){try{let t=new QS.WebVTTParser,n=t.parse(e);return n.cues.map(e=>({start:e.startTime,end:e.endTime,text:e.text}))}catch(e){return console.error(`Failed to parse VTT captions:`,e),[]}}static _parseSRT(e){try{let t=new ZS;return t.fromSrt(e).map(e=>({start:e.startSeconds,end:e.endSeconds,text:e.text}))}catch(e){return console.error(`Failed to parse SRT captions:`,e),[]}}}})),tC,ese=o((()=>{w(),Xoe(),$oe(),tU(),Fm(),E(),tC=class{constructor(e,t){this._videoElement=e,this._settings=t,T(this,`_logPrefix`,`Captions`),T(this,`captionsButton`,void 0),T(this,`captionContainer`,void 0),T(this,`_tracks`,[]),T(this,`_activeTrack`,null),T(this,`_currentCueIndex`,-1),T(this,`_preferredLanguage`,``),T(this,`_videoEventBus`,x.resolve(eU)),T(this,`_settingsState`,x.resolve(Pm)),T(this,`_onTimeUpdate`,this._handleTimeUpdate.bind(this)),T(this,`_onTimeUpdateAttached`,!1),this.captionContainer=XS.createCaptionsContainer(),this.captionsButton=XS.createCaptionsButton(()=>this._settings.toggle(`language`)),this._videoEventBus.settingsUpdated.on(e=>this._handleSettingsUpdate(e.key,e.value)),this._applyStoredSettings()}get captionLanguage(){return this._preferredLanguage}init(e){this._reset(),this._tracks=eC.getTracks(e),this._updateCaptionsButtonVisibility(),this._settings.updatePageOptions(`language`,this._tracks.map(e=>e.language)),this._setTrack(this._preferredLanguage)}_applyStoredSettings(){let e=this._settingsState.settings;Object.entries(e).forEach(([e,t])=>{this._setStyle(e,t)}),this._preferredLanguage=e.language}_updateCaptionsButtonVisibility(){let e=this._tracks.length>0;XS.toggleCaptionsButton(this.captionsButton,e)}_handleSettingsUpdate(e,t){e===`language`?this._setTrack(t):this._setStyle(e,t)}async _setTrack(e){this._preferredLanguage=e,e||(XS.clearCaption(this.captionContainer),this._detachTimeUpdateListener()),this._activeTrack=this._tracks.find(t=>t.language===e)||null,this._activeTrack&&(this._activeTrack.cues=await eC.load(this._activeTrack.file),this._attachTimeUpdateListener(),this._currentCueIndex!==-1&&this._updateCaption(!0)),this._settings.hide()}_setStyle(e,t){XS.updateCaptionStyles(this.captionContainer,e,t)}_reset(){XS.clearCaption(this.captionContainer),this._detachTimeUpdateListener(),this._tracks=[],this._activeTrack=null,this._currentCueIndex=-1}_handleTimeUpdate(){if(!this._activeTrack){XS.clearCaption(this.captionContainer),this._detachTimeUpdateListener();return}this._updateCaption()}_updateCaption(e=!1){var t;let n=this._videoElement.currentTime,r=((t=this._activeTrack)==null?void 0:t.cues)||[];if(r.length&&(this._currentCueIndex===-1||n<r[this._currentCueIndex].start||n>r[this._currentCueIndex].end||e)){let e=r.findIndex(e=>n>=e.start&&n<=e.end);e===-1?XS.clearCaption(this.captionContainer):(this._currentCueIndex=e,XS.displayCaption(this.captionContainer,r[e].text))}}_attachTimeUpdateListener(){!this._onTimeUpdateAttached&&this._activeTrack&&(this._videoElement.addEventListener(`timeupdate`,this._onTimeUpdate),this._onTimeUpdateAttached=!0)}_detachTimeUpdateListener(){this._onTimeUpdateAttached&&(this._videoElement.removeEventListener(`timeupdate`,this._onTimeUpdate),this._onTimeUpdateAttached=!1)}}})),nC,rC,iC,aC,oC=o((()=>{nC={AD_BREAK_READY:`adBreakReady`,AD_BUFFERING:`adBuffering`,AD_ERROR:`adError`,AD_CAN_PLAY:`adCanPlay`,ADS_MANAGER_LOADED:`adsManagerLoaded`,AD_METADATA:`adMetadata`,AD_PROGRESS:`adProgress`,ALL_ADS_COMPLETED:`allAdsCompleted`,CLICK:`click`,COMPLETE:`complete`,CONTENT_PAUSE_REQUESTED:`contentPauseRequested`,CONTENT_RESUME_REQUESTED:`contentResumeRequested`,DURATION_CHANGE:`durationChange`,EXPANDED_CHANGED:`expandedChanged`,FIRST_QUARTILE:`firstQuartile`,IMPRESSION:`impression`,INTERACTION:`interaction`,LINEAR_CHANGED:`linearChanged`,LOADED:`loaded`,LOG:`log`,MIDPOINT:`midpoint`,PAUSED:`pause`,RESUMED:`resume`,SKIPPABLE_STATE_CHANGED:`skippableStateChanged`,SKIPPED:`skip`,STARTED:`start`,THIRD_QUARTILE:`thirdQuartile`,USER_CLOSE:`userClose`,VIDEO_CLICKED:`videoClicked`,VIDEO_ICON_CLICKED:`videoIconClicked`,VIEWABLE_IMPRESSION:`viewable_impression`,VOLUME_CHANGED:`volumeChange`,VOLUME_MUTED:`mute`},rC={AutoInjected:`auto-injected`,EmbeddedStationary:`embedded-stationary`,Outstream:`outstream`,Playlist:`playlist`,Related:`related`,RelatedSticky:`related-sticky`,StickyOutstream:`stickyoutstream`},iC={ADSLOT_NOT_VISIBLE:-1,ADS_REQUEST_NETWORK_ERROR:1012,ASSET_FALLBACK_FAILED:1021,AUTOPLAY_DISALLOWED:1205,COMPANION_AD_LOADING_FAILED:-1,COMPANION_REQUIRED_ERROR:602,CONSENT_MANAGEMENT_PROVIDER_NOT_READY:1300,DEPRECATED_ERROR_CODE:-1,FAILED_TO_REQUEST_ADS:1005,INVALID_AD_TAG:1013,INVALID_ARGUMENTS:1101,NATIVE_MESSAGE_ERROR:1204,NONLINEAR_DIMENSIONS_ERROR:501,OVERLAY_AD_LOADING_FAILED:-1,OVERLAY_AD_PLAYING_FAILED:500,Rh:2002,STREAM_INITIALIZATION_FAILED:1020,UNKNOWN_AD_RESPONSE:1010,UNKNOWN_ERROR:900,UNSUPPORTED_LOCALE:1011,VAST_ASSET_NOT_FOUND:1007,VAST_EMPTY_RESPONSE:1009,VAST_LINEAR_ASSET_MISMATCH:403,VAST_LOAD_TIMEOUT:301,VAST_MALFORMED_RESPONSE:-1,VAST_MEDIA_ERROR:-1,VAST_MEDIA_LOAD_TIMEOUT:402,VAST_NONLINEAR_ASSET_MISMATCH:503,VAST_NO_ADS_AFTER_WRAPPER:303,VAST_PROBLEM_DISPLAYING_MEDIA_FILE:405,VAST_SCHEMA_VALIDATION_ERROR:101,VAST_TOO_MANY_REDIRECTS:302,VAST_TRAFFICKING_ERROR:200,VAST_UNEXPECTED_DURATION_ERROR:202,VAST_UNEXPECTED_LINEARITY:201,VAST_UNSUPPORTED_VERSION:102,VAST_WRAPPER_ERROR:300,VIDEO_ELEMENT_REQUIRED:-1,VIDEO_ELEMENT_USED:-1,VIDEO_PLAY_ERROR:400,VPAID_ERROR:901},aC={NORMAL:`normal`,FULLSCREEN:`fullscreen`}})),sC,tse=o((()=>{$(),GS(),wp(),Koe(),Yoe(),ese(),bt(),oC(),j(),E(),O(),sC=class{constructor({videoElement:e,playerType:t,isDesktop:n,getIsVideoContent:r}){T(this,`_playerControls`,document.createElement(`DIV`)),T(this,`_isInstream`,!1),T(this,`_isDesktop`,!1),T(this,`_playerType`,void 0),T(this,`_videoElement`,void 0),T(this,`_getIsVideoContent`,void 0),T(this,`_progressBar`,null),T(this,`_playButtonState`,`pause`),T(this,`_muted`,!0),T(this,`_muteButton`,document.createElement(`DIV`)),T(this,`_unmuteButton`,document.createElement(`DIV`)),T(this,`_playerControlsVolumeContainer`,document.createElement(`DIV`)),T(this,`_playerControlsVolumeIcon`,document.createElement(`DIV`)),T(this,`_previousVolumeLevel`,.5),T(this,`_volumeSliderContainer`,document.createElement(`DIV`)),T(this,`_volumeSlider`,document.createElement(`INPUT`)),T(this,`_volumeLevel`,0),T(this,`_logPrefix`,`VideoPlayerControls`),T(this,`_adthrivePlayerIcon`,`adthrive-player-icon`),T(this,`_hiddenIconClassName`,`adthrive-hidden`),T(this,`_overlay`,document.createElement(`DIV`)),T(this,`_overlayPlayButton`,document.createElement(`DIV`)),T(this,`_preventClick`,!1),T(this,`_created`,!1),T(this,`_playButton`,null),T(this,`_pauseButton`,null),T(this,`_fullscreenButton`,null),T(this,`_controlsVisible`,!0),T(this,`_autoHideControlsTimeout`,void 0),T(this,`_mediaStarted`,!1),T(this,`videoActionEvents`,new k),T(this,`_captions`,null),T(this,`_settings`,null),T(this,`_onPlayClickCallback`,void 0),T(this,`_onPauseClickCallback`,void 0),T(this,`_onVolumeChangeCallback`,void 0),T(this,`_onToggleFullscreenCallback`,void 0),T(this,`_onKickoffAdPlaybackCallback`,void 0),T(this,`_handleContainerMouseEnter`,()=>{this.showControls()}),T(this,`_handleContainerMouseLeave`,()=>{this.hideControls()}),T(this,`_handleContainerTouchStart`,e=>{var t;if((t=this._progressBar)!=null&&t.isDragging())return;let n=e.target,r=n.parentElement,i=n.querySelectorAll(`${this._adthrivePlayerIcon}-volume`);i!=null&&i.length&&i.forEach(e=>{WS(e,this._hiddenIconClassName)}),r&&WS(r,`active`),this._controlsVisible?this._preventClick=!1:(this._preventClick=!0,this.showControls())}),T(this,`_handleContainerTouchEnd`,e=>{let t=e.target,n=t.parentElement;t.classList.contains(`adthrive-player-progress-bar-handle`)||(n&&WS(n,`active`),this._controlsVisible&&e.stopPropagation())}),T(this,`_handleContainerFocusIn`,()=>{this.showControls()}),T(this,`_handleContainerFocusOut`,e=>{var t;!((t=this._videoElement)==null||(t=t.parentElement)==null)&&t.contains(e.target)||this.hideControls()}),T(this,`_handleOverlayClick`,()=>{var e;(e=this._onKickoffAdPlaybackCallback)==null||e.call(this),this._overlay.remove();let t=this._videoElement.parentElement;t&&(t.addEventListener(`mouseenter`,this._handleContainerMouseEnter),t.addEventListener(`mouseleave`,this._handleContainerMouseLeave),t.addEventListener(`focusin`,this._handleContainerFocusIn),t.addEventListener(`focusout`,this._handleContainerFocusOut),t.addEventListener(`touchstart`,this._handleContainerTouchStart),t.addEventListener(`touchend`,this._handleContainerTouchEnd))}),T(this,`_handlePlayClick`,e=>{var t;(t=this._onPlayClickCallback)==null||t.call(this,e)}),T(this,`_handlePauseClick`,e=>{var t;(t=this._onPauseClickCallback)==null||t.call(this,e)}),T(this,`_handleUnmuteClick`,()=>{this._toggleVolume()}),T(this,`_handleMuteClick`,()=>{this._toggleVolume()}),T(this,`_handleFullscreenClick`,e=>{var t;(t=this._onToggleFullscreenCallback)==null||t.call(this,e)}),T(this,`_handleVolumeSliderMouseUp`,e=>{this._volumeChange(e)}),T(this,`_handleOverlayKeydown`,Sp(e=>{[`Space`,`Enter`].includes(e.code)&&(e.preventDefault(),this._handleOverlayClick(),setTimeout(()=>{var e;return(e=this._pauseButton)==null?void 0:e.focus()},100))},100)),T(this,`_handlePlayKeydown`,Sp(e=>{if([`Space`,`Enter`].includes(e.code)){var t;e.preventDefault(),(t=this._onPlayClickCallback)==null||t.call(this,e),setTimeout(()=>{var e;return(e=this._pauseButton)==null?void 0:e.focus()},100)}},100)),T(this,`_handlePauseKeydown`,Sp(e=>{if([`Space`,`Enter`].includes(e.code)){var t;e.preventDefault(),(t=this._onPauseClickCallback)==null||t.call(this,e),setTimeout(()=>{var e;return(e=this._playButton)==null?void 0:e.focus()},100)}},100)),T(this,`_handleUnmuteKeydown`,Sp(e=>{[`Space`,`Enter`].includes(e.code)&&(e.preventDefault(),this._toggleVolume(),setTimeout(()=>{var e;return(e=this._muteButton)==null?void 0:e.focus()},100))},100)),T(this,`_handleMuteKeydown`,Sp(e=>{[`Space`,`Enter`].includes(e.code)&&(e.preventDefault(),this._toggleVolume(),setTimeout(()=>{var e;return(e=this._unmuteButton)==null?void 0:e.focus()},100))},100)),T(this,`_handleVolumeSliderKeydown`,Sp(e=>{[`Space`,`Enter`,`ArrowLeft`,`ArrowRight`].includes(e.code)&&e.preventDefault();let t=this._volumeSlider;if(e.code===`ArrowRight`){var n;if(t.value=`${Math.min(Number(t.value)+5,100)}`,this.muted){var r,i;this._setMuteState(!1),(r=this._muteButton)==null||r.classList.add(this._hiddenIconClassName),(i=this._unmuteButton)==null||i.classList.remove(this._hiddenIconClassName)}let e=Number(t.value)/100;this.setVolume(e),this._setSliderRange(),(n=this._onVolumeChangeCallback)==null||n.call(this)}if(e.code===`ArrowLeft`){var a;if(t.value=`${Math.max(Number(t.value)-5,0)}`,!this.muted&&t.value===`0`){var o,s;this._setMuteState(!0),(o=this._unmuteButton)==null||o.classList.add(this._hiddenIconClassName),(s=this._muteButton)==null||s.classList.remove(this._hiddenIconClassName)}let e=Number(t.value)/100;this.setVolume(e),this._setSliderRange(),(a=this._onVolumeChangeCallback)==null||a.call(this)}},100)),this._isInstream=rC.AutoInjected===t||rC.EmbeddedStationary===t||rC.RelatedSticky===t,this._playerType=t,this._videoElement=e,this._getIsVideoContent=r,this._isDesktop=n;let i=t===rC.EmbeddedStationary;this._playButtonState=i?`play`:`pause`,this._controlsVisible=!i,this._setInitialVolume(i)}get muted(){return this._muted}get volumeLevel(){return this._volumeLevel}get preventClick(){return this._preventClick}get isVideoContent(){return this._getIsVideoContent()}toggleControlsFullWidth(e){let t=this._playerControls.classList;e?t.add(`adthrive-full-width`):t.remove(`adthrive-full-width`)}showControls(){var e;if(!this._mediaStarted)return;let t=this._getIsVideoContent();this.toggleControlsFullWidth(t),this._controlsVisible=!0,(e=this._progressBar)==null||e.update(),this._playerControls.classList.remove(`adthrive-player-ad-controls-hidden`),this._resetAutoHideControlsTimeout()}hideControls(){var e,t;!this._isDesktop&&!this._getIsVideoContent()||(e=this._progressBar)!=null&&e.isDragging()||(this._playerControls.classList.add(`adthrive-player-ad-controls-hidden`),(t=this._settings)==null||t.hide(),this._controlsVisible=!1,this._clearAutoHideControlsTimeout())}toggleProgressBar(e){this._progressBar&&(e?this._playerControls.classList.add(`adthrive-player-progress-bar-visible`):this._playerControls.classList.remove(`adthrive-player-progress-bar-visible`),this._progressBar.toggle(e))}setMediaStarted(e){this._mediaStarted=e}setPlayButtonState(e){this._playButtonState!==e&&(this._playButtonState=e,this._setActiveButtonState(this._playButtonState))}_setPreviousVolume(e){return this._previousVolumeLevel=e,this._previousVolumeLevel}setVolume(e){return this._volumeLevel=e,this._videoElement.volume=this.volumeLevel,this._videoElement.volume}muteVolume(e=!1){this._setMuteState(!0),this.setVolume(0),this._setMuteIconToMuted(!0),e&&M.event(this._logPrefix,`muted`,this._playerType)}unmuteVolume(e,t=!1){this._setMuteState(!1),this.setVolume(e||this._previousVolumeLevel),this._setMuteIconToMuted(!1),t&&M.event(this._logPrefix,`unmuted`,this._playerType)}_setMuteState(e){return this._muted=!!e,this._videoElement.muted=this._muted,this._videoElement.muted}_emitAction(e,t){let n=t?`user${e.charAt(0).toUpperCase()+e.substring(1)}`:e,r=this._getIsVideoContent()?`content`:`ad`;this.videoActionEvents.emit({action:n,context:r})}_addEmitterIfNeeded(e){return this._isInstream?Object.entries(e).reduce((e,[t,n])=>(e[t]=e=>{t!==`onkickoffAdPlayback`&&this._emitAction(t,e),n(e)},e),{}):e}enablePlayerControls(e,t){if(this._created)return;this._created=!0;let{play:n,pause:r,volume:i,onkickoffAdPlayback:a,fullscreen:o}=this._addEmitterIfNeeded(e);this._onPlayClickCallback=n,this._onPauseClickCallback=r,this._onVolumeChangeCallback=i,this._onKickoffAdPlaybackCallback=a;let s=this._playerControls;s.classList.add(`adthrive-player-ad-controls`),this._playerType===rC.EmbeddedStationary&&a&&this._createOverlay();let c=this._createPlayPauseControls();if(this._createVolumeIconControls(),s.appendChild(c),s.appendChild(this._playerControlsVolumeContainer),this._isInstream){var l,u,d;s.classList.add(`adthrive-player-ad-controls-hidden`),this._settings=new YS,(l=this._videoElement.parentNode)==null||l.appendChild(this._settings.el),this._captions=new tC(this._videoElement,this._settings),s.appendChild(this._captions.captionsButton),o&&(this._onToggleFullscreenCallback=o,this._fullscreenButton=this.createFullscreenButton(),s.appendChild(this._fullscreenButton)),this._progressBar=new KS(this._videoElement,()=>this._controlsVisible),s.appendChild(this._progressBar._container),(u=this._videoElement.parentNode)==null||u.insertBefore(s,this._videoElement),(d=this._videoElement.parentNode)==null||d.insertBefore(this._captions.captionContainer,this._videoElement)}else t==null||t.appendChild(this._playerControls);let f=this._videoElement.parentElement;f&&this._isInstream&&this._playerType!==rC.EmbeddedStationary&&this._setVideoContainerEvents(f)}_setVideoContainerEvents(e){e&&(e.addEventListener(`mouseenter`,this._handleContainerMouseEnter),e.addEventListener(`mouseleave`,this._handleContainerMouseLeave),e.addEventListener(`focusin`,this._handleContainerFocusIn),e.addEventListener(`focusout`,this._handleContainerFocusOut),e.addEventListener(`touchstart`,this._handleContainerTouchStart),e.addEventListener(`touchend`,this._handleContainerTouchEnd))}_createOverlay(){var e;this._overlay.className=`adthrive-video-overlay`,this._createOverlayPlayButton(),(e=this._videoElement.parentElement)==null||e.appendChild(this._overlay),this._overlay.addEventListener(`click`,this._handleOverlayClick)}_createOverlayPlayButton(){this._overlayPlayButton.tabIndex=0,this._overlayPlayButton.className=`adthrive-player-big-play-button`,this._overlayPlayButton.innerHTML=`&#9658;`,this._overlay.appendChild(this._overlayPlayButton),this._overlayPlayButton.addEventListener(`keydown`,this._handleOverlayKeydown)}_createPlayPauseControls(){let e=document.createElement(`DIV`);return e.className=`adthrive-player-ad-controls-play`,this._playButton=this._createPlayButton(),this._pauseButton=this._createPauseButton(),e.appendChild(this._playButton),e.appendChild(this._pauseButton),e}_resetAutoHideControlsTimeout(e=5e3){this._clearAutoHideControlsTimeout(),!(this._isDesktop||!this._getIsVideoContent())&&(this._autoHideControlsTimeout=window.setTimeout(()=>{this.hideControls()},e))}_clearAutoHideControlsTimeout(){this._autoHideControlsTimeout&&(clearTimeout(this._autoHideControlsTimeout),this._autoHideControlsTimeout=void 0)}_setActiveButtonState(e){let t=this._playerControls.querySelector(`#${this._adthrivePlayerIcon}-${e}-${this._playerType}`),n=null;n=e===`pause`?t&&t.previousSibling:t&&t.nextSibling,t==null||t.classList.remove(this._hiddenIconClassName),n==null||n.classList.add(this._hiddenIconClassName)}_createPlayButton(){let e=document.createElement(`DIV`);e.classList.add(`${this._adthrivePlayerIcon}`,`${this._adthrivePlayerIcon}-play`),this._playButtonState===`pause`&&e.classList.add(this._hiddenIconClassName),e.id=`${this._adthrivePlayerIcon}-play-${this._playerType}`,e.tabIndex=0;let t=this._createSvg(`white`,!1);return t.appendChild(this._createPolygon(`white`,`2.29,0 2.29,18 15.71,9`)),e.appendChild(t),e.addEventListener(`click`,this._handlePlayClick),e.addEventListener(`keydown`,this._handlePlayKeydown),e}_createPauseButton(){let e=document.createElement(`DIV`);e.classList.add(`${this._adthrivePlayerIcon}`,`${this._adthrivePlayerIcon}-pause`),this._playButtonState===`play`&&e.classList.add(this._hiddenIconClassName),e.id=`${this._adthrivePlayerIcon}-pause-${this._playerType}`,e.tabIndex=0;let t=this._createSvg(`white`,!1);return t.appendChild(this._createRect(`white`,`5`,`18`,`2.29`)),t.appendChild(this._createRect(`white`,`5`,`18`,`10.71`)),e.addEventListener(`click`,this._handlePauseClick),e.addEventListener(`keydown`,this._handlePauseKeydown),e.appendChild(t),e}_appendVolumeSlider(){let e=this._createVolumeSlider();this._playerControlsVolumeContainer.classList.add(`adthrive-player-ad-controls-volume-container-with-slider`),this._playerControlsVolumeIcon.appendChild(e)}_createVolumeIconControls(){this._playerControlsVolumeContainer.className=`adthrive-player-ad-controls-volume-container`,this._playerControlsVolumeIcon.className=`adthrive-player-ad-controls-volume`,this._isInstream&&this._playerControlsVolumeContainer.classList.add(`adthrive-player-ad-controls-volume-container-with-bar`),this._createVolumeMutedButton(),this._createVolumeUnMutedButton(),this._playerControlsVolumeIcon.appendChild(this._muteButton),this._playerControlsVolumeIcon.appendChild(this._unmuteButton),this._playerControlsVolumeContainer.appendChild(this._playerControlsVolumeIcon),this._isDesktop&&this._appendVolumeSlider()}_createVolumeMutedButton(){this._muteButton.tabIndex=0,this._muteButton.classList.add(`${this._adthrivePlayerIcon}`,`${this._adthrivePlayerIcon}-volume`,`${this._adthrivePlayerIcon}-volume-muted`),this.muted||this._muteButton.classList.add(this._hiddenIconClassName);let e=this._createSvg(`white`,!1);e.appendChild(this._createPath(`white`,`M16.45,9.02c0,1.64-0.57,2.97-1.33,4.03l1.2,1.15C17.29,12.94,18,11.26,18,9.04c0-6.95-6.96-8.7-6.96-8.7v1.32C11.04,1.66,16.45,3.96,16.45,9.02z`)),e.appendChild(this._createPath(`white`,`M13.27,14.94c-1.18,0.91-2.23,1.33-2.23,1.33v1.44c0,0,1.68-0.42,3.39-1.67L13.27,14.94z`)),e.appendChild(this._createRect(`white`,`1.71`,`22.61`,`8.15`,`-2.28`,`matrix(0.6917 -0.7222 0.7222 0.6917 -3.7421 9.2833)`)),e.appendChild(this._createPath(`white`,`M12.98,11c0.31-0.55,0.52-1.2,0.52-1.98c0-2.95-2.99-4.24-2.99-4.24v3.86L12.98,11z`)),e.appendChild(this._createPath(`white`,`M10.52,12.3v0.86c0,0,0.24-0.1,0.58-0.3L10.52,12.3z`)),e.appendChild(this._createPolygon(`white`,`9.21,7.4 9.24,0.74 5.82,4.15`)),e.appendChild(this._createPolygon(`white`,`3.69,5.77 0.06,5.77 0,12.07 4.14,12.07 9.18,17.11 9.2,11.04`)),this._muteButton.addEventListener(`click`,this._handleMuteClick),this._muteButton.addEventListener(`keydown`,this._handleMuteKeydown),this._muteButton.appendChild(e)}_createVolumeUnMutedButton(){this._unmuteButton.tabIndex=0,this._unmuteButton.classList.add(`${this._adthrivePlayerIcon}`,`${this._adthrivePlayerIcon}-volume`,`${this._adthrivePlayerIcon}-volume-unmuted`),this.muted&&this._unmuteButton.classList.add(this._hiddenIconClassName);let e=this._createSvg(`white`,!1);e.appendChild(this._createPolygon(`white`,`9.18,17.11 4.14,12.07 0,12.07 0.06,5.77 4.2,5.77 9.24,0.74`)),e.appendChild(this._createPath(`white`,`M11.04,0.34c0,0,6.96,1.75,6.96,8.7s-6.96,8.67-6.96,8.67v-1.44c0,0,5.42-2.18,5.42-7.25s-5.42-7.37-5.42-7.37V0.34z`)),e.appendChild(this._createPath(`white`,`M10.52,4.79c0,0,2.99,1.28,2.99,4.24s-2.99,4.14-2.99,4.14V4.79z`)),this._unmuteButton.appendChild(e),this._unmuteButton.addEventListener(`click`,this._handleUnmuteClick),this._unmuteButton.addEventListener(`keydown`,this._handleUnmuteKeydown)}_setInitialVolume(e){let t=this._isDesktop?.5:.8,n=e?t:0,r=!e;this._setPreviousVolume(t),this.setVolume(n),this._setSliderRange(),this._setMuteState(r)}_setSliderRange(){this._volumeSlider.value=`${this.volumeLevel*100}`}_createVolumeSlider(){let e=this._volumeSliderContainer;e.tabIndex=0,e.className=`adthrive-player-volume-control`,e.id=`adthrive-${this._playerType}-volume-control`;let t=this._volumeSlider;return t.setAttribute(`type`,`range`),t.setAttribute(`min`,`0`),t.setAttribute(`max`,`100`),t.setAttribute(`step`,`1`),t.tabIndex=-1,e.appendChild(t),t.addEventListener(`mouseup`,this._handleVolumeSliderMouseUp),e.addEventListener(`keydown`,this._handleVolumeSliderKeydown),e}_setMuteIconToMuted(e=!0){e?(this._unmuteButton.classList.add(this._hiddenIconClassName),this._muteButton.classList.remove(this._hiddenIconClassName)):(this._muteButton.classList.add(this._hiddenIconClassName),this._unmuteButton.classList.remove(this._hiddenIconClassName))}_volumeChange(e){var t;if(this.preventClick)return;let n=e.target,r=this.volumeLevel,i=Number(n.value)/100,a=i===0,o=this.muted&&i>0;a?this.muteVolume(!0):o?this.unmuteVolume(i,!0):this.setVolume(i),this._setPreviousVolume(r),this._setSliderRange(),(t=this._onVolumeChangeCallback)==null||t.call(this)}_toggleVolume(){var e;this.preventClick||(this.muted?this.unmuteVolume(0,!0):(this._setPreviousVolume(this.volumeLevel),this.muteVolume(!0)),this._setSliderRange(),(e=this._onVolumeChangeCallback)==null||e.call(this))}createFullscreenButton(){let e=document.createElement(`button`);return e.setAttribute(`type`,`button`),e.classList.add(this._adthrivePlayerIcon),e.classList.add(`${this._adthrivePlayerIcon}-fullscreen`),e.appendChild(this.createMaximizeIcon()),e.appendChild(this.createMinimizeIcon()),e.addEventListener(`click`,this._handleFullscreenClick),e}createMinimizeIcon(){let e=this._createSvg(`white`,!1);return e.classList.add(`raptive-player-secondary-icon`),e.setAttribute(`stroke`,`white`),e.setAttribute(`stroke-width`,`2`),e.setAttribute(`stroke-linecap`,`round`),e.setAttribute(`stroke-linejoin`,`round`),e.appendChild(this._createLine(`1`,`17`,`7`,`11`)),e.appendChild(this._createLine(`3`,`11`,`7`,`11`)),e.appendChild(this._createLine(`7`,`11`,`7`,`15`)),e.appendChild(this._createLine(`17`,`1`,`11`,`7`)),e.appendChild(this._createLine(`11`,`7`,`15`,`7`)),e.appendChild(this._createLine(`11`,`3`,`11`,`7`)),e}createMaximizeIcon(){let e=this._createSvg(`white`,!1);return e.classList.add(`raptive-player-primary-icon`),e.setAttribute(`stroke`,`white`),e.setAttribute(`stroke-width`,`2`),e.setAttribute(`stroke-linecap`,`round`),e.setAttribute(`stroke-linejoin`,`round`),e.appendChild(this._createLine(`1`,`17`,`7`,`11`)),e.appendChild(this._createLine(`1`,`17`,`5`,`17`)),e.appendChild(this._createLine(`1`,`13`,`1`,`17`)),e.appendChild(this._createLine(`17`,`1`,`11`,`7`)),e.appendChild(this._createLine(`13`,`1`,`17`,`1`)),e.appendChild(this._createLine(`17`,`1`,`17`,`5`)),e}_createPath(e,t){let n=document.createElementNS(`http://www.w3.org/2000/svg`,`path`);return n.setAttribute(`d`,t),n.setAttribute(`fill`,e),n}_createLine(e,t,n,r){let i=document.createElementNS(`http://www.w3.org/2000/svg`,`line`);return i.setAttribute(`x1`,e),i.setAttribute(`y1`,t),i.setAttribute(`x2`,n),i.setAttribute(`y2`,r),i}_createPolygon(e,t){let n=document.createElementNS(`http://www.w3.org/2000/svg`,`polygon`);return n.setAttribute(`points`,t),n.setAttribute(`fill`,e),n}_createRect(e,t,n,r,i,a){let o=document.createElementNS(`http://www.w3.org/2000/svg`,`rect`);return o.setAttribute(`x`,r),o.setAttribute(`height`,n),o.setAttribute(`width`,t),o.setAttribute(`fill`,e),i&&o.setAttribute(`y`,i),a&&o.setAttribute(`transform`,a),o}_createSvg(e,t){let n=document.createElementNS(`http://www.w3.org/2000/svg`,`svg`);return n.setAttribute(`focusable`,`${t}`),n.setAttribute(`width`,`18`),n.setAttribute(`height`,`18`),n.setAttribute(`viewBox`,`0 0 18 18`),n.setAttribute(`fill`,e),n}setTracks(e){var t;(t=this._captions)==null||t.init(e)}get captionLanguage(){var e,t;return(e=(t=this._captions)==null?void 0:t.captionLanguage)==null?``:e}destroy(){var e,t,n,r,i,a,o,s,c,l,u,d,f;this._clearAutoHideControlsTimeout();let p=this._videoElement.parentElement;p==null||p.removeEventListener(`mouseenter`,this._handleContainerMouseEnter),p==null||p.removeEventListener(`mouseleave`,this._handleContainerMouseLeave),p==null||p.removeEventListener(`touchstart`,this._handleContainerTouchStart),p==null||p.removeEventListener(`touchend`,this._handleContainerTouchEnd),p==null||p.removeEventListener(`focusin`,this._handleContainerFocusIn),p==null||p.removeEventListener(`focusout`,this._handleContainerFocusOut),(e=this._overlay)==null||e.removeEventListener(`click`,this._handleOverlayClick),(t=this._playButton)==null||t.removeEventListener(`click`,this._handlePlayClick),(n=this._pauseButton)==null||n.removeEventListener(`click`,this._handlePauseClick),(r=this._unmuteButton)==null||r.removeEventListener(`click`,this._handleUnmuteClick),(i=this._muteButton)==null||i.removeEventListener(`click`,this._handleMuteClick),(a=this._fullscreenButton)==null||a.removeEventListener(`click`,this._handleFullscreenClick),(o=this._volumeSlider)==null||o.removeEventListener(`mouseup`,this._handleVolumeSliderMouseUp),(s=this._overlayPlayButton)==null||s.removeEventListener(`keydown`,this._handleOverlayKeydown),(c=this._playButton)==null||c.removeEventListener(`keydown`,this._handlePlayKeydown),(l=this._pauseButton)==null||l.removeEventListener(`keydown`,this._handlePauseKeydown),(u=this._unmuteButton)==null||u.removeEventListener(`keydown`,this._handleUnmuteKeydown),(d=this._muteButton)==null||d.removeEventListener(`keydown`,this._handleMuteKeydown),(f=this._volumeSliderContainer)==null||f.removeEventListener(`keydown`,this._handleVolumeSliderKeydown)}},sC=D([Q(`VideoPlayerControls`),A(`design:paramtypes`,[Object])],sC)})),cC,nse=o((()=>{E(),cC=class{constructor(){T(this,`boundHandlers`,new Map)}attachEventHandlers(e,t){this.detachEventHandlers(e);for(let n of e)this.addEventHandler(n.target,n.event,n.handler,t)}detachEventHandlers(e){for(let t of e)this.removeEventHandler(t.target,t.event)}addEventHandler(e,t,n,r){let i=r?n.bind(r):n,a=this.getHandlerKey(e,t);this.boundHandlers.set(a,i),e.addEventListener(t,i,!1)}removeEventHandler(e,t){let n=this.getHandlerKey(e,t),r=this.boundHandlers.get(n);r&&(e.removeEventListener(t,r,!1),this.boundHandlers.delete(n))}getHandlerKey(e,t){return`${e.constructor.name}_${t}`}}})),lC,rse=o((()=>{oC(),Z(),$(),bt(),nse(),E(),lC=class e{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v){this._config=e,this._playerType=t,this._size=n,this._isAutoPlay=r,this._container=i,this._videoElement=a,this._eventProxy=o,this._getVolumeLevel=s,this._muteVolume=c,this._getPreventClick=l,this._setPlayButtonState=u,this._getState=d,this._setState=f,this._getIntentionalPause=p,this._setIntentionalPause=m,this._setUserClickedToPlay=h,this._resumedCallback=g,this._setIsVideoContent=_,this._shouldUseHardcodedAdPodDuration=v,T(this,`_ima`,void 0),T(this,`_adsLoader`,void 0),T(this,`_adsManager`,void 0),T(this,`_adContainer`,document.createElement(`DIV`)),T(this,`_adDisplayContainer`,void 0),T(this,`_adsRequest`,void 0),T(this,`_adsRequestTimer`,null),T(this,`_adPlayReady`,!1),T(this,`_prematureAdPlay`,!1),T(this,`_isAdActive`,!1),T(this,`_visibilityListener`,void 0),T(this,`_eventManager`,new cC),T(this,`adCompleted`,new k),T(this,`adError`,new k),T(this,`adImpression`,new k),T(this,`adLoaded`,new k),T(this,`adPause`,new k),T(this,`adPlay`,new k),T(this,`adProgress`,new k),T(this,`adReady`,new k),T(this,`adRequest`,new k),T(this,`adSkipped`,new k),T(this,`adStarted`,new k),T(this,`allAdsCompleted`,new k),T(this,`contentResumeRequested`,new k),T(this,`log`,new k)}get imaSDKVersion(){return this._ima&&this._ima.VERSION}get adContainer(){return this._adContainer}get adDisplayContainer(){return this._adDisplayContainer}get adsLoader(){return this._adsLoader}get adsRequest(){return this._adsRequest}get adsManager(){return this._adsManager}get adPlayReady(){return this._adPlayReady}get prematureAdPlay(){return this._prematureAdPlay}get isAdActive(){return this._isAdActive}setAdPlayReady(e){this._adPlayReady=e}setPrematureAdPlay(e){this._prematureAdPlay=e}setIsAdActive(e){this._isAdActive=e}async init(){await this.initIMA(),this.initVisibilityListener(),this.adReady.on(()=>{this.setAdPlayReady(!0)})}setupOnInject(){window.google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this.initAdContainer(),this.setAdDisplayContainer(this._videoElement),this._adDisplayContainer&&(this._adDisplayContainer.initialize(),this.setAdsLoader(this._adDisplayContainer)),this.setAdsRequest(),this._isAutoPlay&&this._adsRequest&&(this._muteVolume(),this._adsRequest.setAdWillAutoPlay(!0),this._adsRequest.setAdWillPlayMuted(!0)),this.addSlickDialogListener()}requestAd(e){let t=this._adsRequest,n=this._size,{adResponse:r,adTagUrl:i}=e;t.linearAdSlotWidth=n[0],t.linearAdSlotHeight=n[1],t.nonLinearAdSlotWidth=n[0],t.nonLinearAdSlotHeight=n[1],t.vastLoadTimeout=this._isInstream()?this._config.video.vastTimeoutISV:this._config.video.vastTimeoutOSV,r&&(t.adsResponse=r),i&&(t.adTagUrl=i),this.setAdsLoaderEventHandlers(),this._adsLoader.requestAds(t)}resize(){var e;(e=this._adsManager)==null||e.resize(this._adContainer.clientWidth,this._adContainer.clientHeight,aC.NORMAL)}reInitIMA(){this.setAdsRequest(),this._isAutoPlay&&this._adsRequest&&(this._adsRequest.setAdWillAutoPlay(!0),this._adsRequest.setAdWillPlayMuted(!0))}disable(){var e,t,n;this.removeAdsLoaderEventHandlers(),(e=this.adsLoader)==null||e.destroy(),(t=this.adDisplayContainer)==null||t.destroy(),(n=this.adsManager)==null||n.destroy(),this._adsLoader=void 0,this._adDisplayContainer=void 0,this._adsManager=void 0}resetAdContainer(){this._adContainer=document.createElement(`DIV`)}remove(e=!1){if(!this._isInstream()||e){var t,n;this.removeAdsLoaderEvents(),(t=this.adsLoader)==null||t.destroy(),(n=this.adDisplayContainer)==null||n.destroy(),this.removeAdsLoader(),this.removeAdDisplayContainer()}else this.adsLoader&&this.removeAdsLoaderEvents();this._setState(`idle`),this.adsManager&&(this.adsManager.destroy(),this.removeAdsManager())}playAdInStream(){var e,t;(e=this._adsManager)==null||e.setVolume(this._getVolumeLevel()),(t=this._adsManager)==null||t.start()}playAdOutStream(e){this.requestAd(e),this._adsRequestTimer=window.setTimeout(()=>this._adError({error:{data:{errorCode:-1,errorMessage:`Adloader failed to request ads: unknown error`,type:`error`}}}),2e4)}playAd(e=!1){var t;this._getPreventClick()||(e&&this._setUserClickedToPlay(!0),this._getState()!==`playing`&&((t=this._adsManager)==null||t.resume()))}pauseAd({event:e,pausedByOtherPlayer:t}={}){var n;this._getPreventClick()||(this._setUserClickedToPlay(!1),(e||t)&&this._setIntentionalPause(!0),this._getState()!==`paused`&&((n=this._adsManager)==null||n.pause()))}_resumed(e){this._resumedCallback();let t=this._getAdRenderDetails(e);this.adPlay.emit(t),this._setState(`playing`),this._setIntentionalPause(!1),this._setPlayButtonState()}_paused(e){if(this._getState()===`paused`)return;let t=this._getAdRenderDetails(e);this.adPause.emit(t),this._setState(`paused`),this._setPlayButtonState()}_adsManagerLoaded(e){this.resetAdsRequestTimer(),this.setAdsManager(e,this._videoElement);let t=this._adsManager;if(t){this.setAdsManagerEventHandlers();try{let e=this._isInstream()?this._adContainer.clientWidth:this._size[0],n=this._isInstream()?this._adContainer.clientHeight:this._size[1];t.init(e,n,aC.NORMAL),this._isInstream()||t.start()}catch(e){M.error(`IMAManager`,`_adsManagerLoaded`,this._playerType,e)}}}_adLoaded(e){if(this._isInstream()){var t;(t=this._adsManager)==null||t.setVolume(this._getVolumeLevel())}else{var n;(n=this._adsManager)==null||n.setVolume(0),this._muteVolume()}let r=this._getAdRenderDetails(e);this.adLoaded.emit(r),document.hidden&&this.pauseAd()}_adStarted(e){if(this._isInstream()&&!this._adPlayReady){this.setAdPlayReady(!0),this.pauseAd();return}let t=this._getAdRenderDetails(e);if(this.adStarted.emit(t),this._setState(`playing`),this.setIsAdActive(!0),this._setIsVideoContent(!1),this._setPlayButtonState(),this._isInstream()){var n;(n=this._adsManager)==null||n.setVolume(this._getVolumeLevel())}else{var r;this._container.classList.remove(`adthrive-player-idle`),this._container.classList.add(`adthrive-player-playing`),(r=this._adsManager)==null||r.setVolume(0)}}_adComplete(e){this.setIsAdActive(!1);let t=this._getAdRenderDetails(e);this.adCompleted.emit(t)}_adError(e){this.resetAdsRequestTimer();let t=e&&e.error&&e.error.data,n=t?{code:t.errorCode,message:t.errorMessage,type:t.type}:{};this.adError.emit(n)}_adImpression(e){let t=this._getAdRenderDetails(e);this.adImpression.emit(t)}_contentResumeRequested(e){let t=this._getAdRenderDetails(e);this.contentResumeRequested.emit(t)}_allAdsComplete(e){let t=this._getAdRenderDetails(e);this.allAdsCompleted.emit(t)}_adProgress(e){let t=e.getAdData();t&&this.adProgress.emit({duration:t.duration,position:t.currentTime})}_adSkipped(e){let t=this._getAdRenderDetails(e);this.adSkipped.emit(t)}_log(e){this.log.emit(e)}async initIMA(){if(e.isIMALoaded()){this._ima=window.google.ima;return}try{var t;if(await this.importIMAScript(),await e._waitForIMAInit(),this._ima=(t=window.google)==null?void 0:t.ima,!this._ima)throw Error("IMA SDK loaded, but `window.google.ima` is undefined.")}catch(e){throw Error(`Failed to initialize IMA SDK: ${e instanceof Error?e.message:String(e)}`)}}initVisibilityListener(){this._isInstream()&&(this._visibilityListener=this._eventProxy.pageVisibility.on(this.handlePageVisibilityChange.bind(this)))}initAdContainer(){this._adContainer.id=`adthrive-${this._playerType}-ad-container`,this._adContainer.className=`adthrive-player-ad-container`,this._isOutstream()&&(this._adContainer.style.width=`${this._size[0]}px`,this._adContainer.style.height=`${this._size[1]}px`),this._isInstream()&&(this._adContainer.classList.add(`raptive-player-ad`,`raptive-player-ad-container-idle`),this._adContainer.style.width=`100%`,this._adContainer.style.height=`100%`)}static isIMALoaded(){var e;return!!((e=window.google)!=null&&e.ima)}async importIMAScript(){e.isIMALoaded()||await ta(e.IMA_SCRIPT_URL,!1,!1,!0)}setAdsLoader(e){var t;if(!this._ima)return;this._adsLoader=new this._ima.AdsLoader(e);let n=(t=this._adsLoader)==null?void 0:t.getSettings();n==null||n.setNumRedirects(this._config.video.maxRedirect),n==null||n.setVpaidMode(this._ima.ImaSdkSettings.VpaidMode.ENABLED),n==null||n.setVpaidMode(this._ima.ImaSdkSettings.VpaidMode.INSECURE)}removeAdsLoader(){this._adsLoader=void 0}setAdsLoaderEventHandlers(){let e=[{target:this._adsLoader,event:nC.ADS_MANAGER_LOADED,handler:this._adsManagerLoaded},{target:this._adsLoader,event:nC.AD_ERROR,handler:this._adError}];this._eventManager.attachEventHandlers(e,this)}removeAdsLoaderEventHandlers(){let e=[{target:this._adsLoader,event:nC.ADS_MANAGER_LOADED,handler:this._adsManagerLoaded},{target:this._adsLoader,event:nC.AD_ERROR,handler:this._adError}];this._eventManager.detachEventHandlers(e)}setAdsManager(e,t){if(!this._ima)return;let n=new this._ima.AdsRenderingSettings;n.restoreCustomPlaybackStateOnAdBreakComplete=!0,n.bitrate=this._config.video.maxBitrate,n.enablePreloading=this._config.video.enablePreloading,n.loadVideoTimeout=this._config.video.loadVideoTimeout,this._shouldUseHardcodedAdPodDuration&&(n.disableUi=!0),this._adsManager=e.getAdsManager(t,n)}removeAdsManager(){this._adsManager=void 0}setAdsManagerEventHandlers(){let e=[{target:this._adsManager,event:nC.PAUSED,handler:this._paused},{target:this._adsManager,event:nC.RESUMED,handler:this._resumed},{target:this._adsManager,event:nC.STARTED,handler:this._adStarted},{target:this._adsManager,event:nC.COMPLETE,handler:this._adComplete},{target:this._adsManager,event:nC.LOADED,handler:this._adLoaded},{target:this._adsManager,event:nC.AD_ERROR,handler:this._adError},{target:this._adsManager,event:nC.AD_PROGRESS,handler:this._adProgress},{target:this._adsManager,event:nC.ALL_ADS_COMPLETED,handler:this._allAdsComplete},{target:this._adsManager,event:nC.CONTENT_RESUME_REQUESTED,handler:this._contentResumeRequested},{target:this._adsManager,event:nC.IMPRESSION,handler:this._adImpression},{target:this._adsManager,event:nC.SKIPPED,handler:this._adSkipped},{target:this._adsManager,event:nC.LOG,handler:this._log}];this._eventManager.attachEventHandlers(e,this)}setAdDisplayContainer(e){this._ima&&(this._adDisplayContainer=new this._ima.AdDisplayContainer(this._adContainer,e))}removeAdDisplayContainer(){this._adDisplayContainer=void 0}setAdsRequest(){this._ima&&(this._adsRequest=new this._ima.AdsRequest)}resetAdsRequestTimer(){this._adsRequestTimer&&(clearTimeout(this._adsRequestTimer),this._adsRequestTimer=null)}addSlickDialogListener(){document.addEventListener(`slick-auth-dialog-opened`,()=>{var e;this._getState()!==`paused`&&((e=this._adsManager)==null||e.pause())}),document.addEventListener(`slick-auth-dialog-closed`,()=>{this._getIntentionalPause()||this.playAd()})}removeAdsLoaderEvents(){this._isInstream()&&this.removeAdsLoaderEventHandlers(),this._visibilityListener&&this._visibilityListener()}handlePageVisibilityChange(e){this._getState()===`playing`&&e?this.pauseAd():this._getState()===`paused`&&!e&&!this._getIntentionalPause()&&this.playAd()}_isOutstream(){return rC.Outstream===this._playerType||rC.StickyOutstream===this._playerType}_isInstream(){return rC.AutoInjected===this._playerType||rC.EmbeddedStationary===this._playerType||rC.RelatedSticky===this._playerType}_getAdRenderDetails(e){let t=this._adsRequest,n=t.adTagUrl,r=t.adsResponse,i;if(e&&e.getAd){let t=e.getAd(),n=Object.keys(t)||[];i=t&&n.length&&t[n[0]]}let a=e&&Object.keys(e)||[];return i=i||a.reduce((t,n)=>{if(!e[n]||typeof e[n]!=`object`||Array.isArray(e[n]))return;let r=Object.keys(e[n]),i=r&&r.length&&e[n][r[0]];i&&`adId`in i&&(t=i)},{}),{ad:i,userRequestContext:{...n&&{adTagUrl:n},...r&&{vastXml:r}}}}static _waitForIMAInit(e=50,t=5e3){return new Promise((n,r)=>{var i;if((i=window.google)!=null&&i.ima)return n();let a=Date.now(),o=setInterval(()=>{var e;(e=window.google)!=null&&e.ima?(clearInterval(o),n()):Date.now()-a>=t&&(clearInterval(o),r(Error(`Timed out waiting for IMA SDK to initialize`)))},e)})}},T(lC,`IMA_SCRIPT_URL`,`https://imasdk.googleapis.com/js/sdkloader/ima3.js`)})),uC,dC=o((()=>{H(),tse(),$(),bt(),oC(),Z(),Ni(),rse(),al(),E(),uC=class extends V{constructor(e,t,n,r,i,a,o,s,c,l,u){super(),this._playerId=e,this._playlistId=t,this._playerType=n,this._pageElement=r,this.size=i,this._config=a,this._eventProxy=o,this._autoplay=s,this._id=c,this.playerNumber=l,this._shouldUseHardcodedAdPodDuration=u,T(this,`canPlay`,!0),T(this,`error`,new k),T(this,`seeking`,new k),T(this,`seeked`,new k),T(this,`isFirstPlay`,!0),T(this,`isVideoContent`,!1),T(this,`pause`,new k),T(this,`play`,new k),T(this,`click`,new k),T(this,`playerVolumeChange`,new k),T(this,`loadedMetaData`,new k),T(this,`ended`,new k),T(this,`timeupdate`,new k),T(this,`playlist`,[]),T(this,`ready`,new k),T(this,`kickoffAdPlayback`,new k),T(this,`state`,`idle`),T(this,`videoContentState`,`idle`),T(this,`_videoTitleDiv`,document.createElement(`DIV`)),T(this,`_videoDescriptionDiv`,document.createElement(`DIV`)),T(this,`_videoTitleOverlayContainer`,document.createElement(`DIV`)),T(this,`_wrapperTitleWrapperElement`,void 0),T(this,`_container`,document.createElement(`DIV`)),T(this,`_videoPlayerControls`,void 0),T(this,`_playerPosition`,document.createElement(`DIV`)),T(this,`_isMobile`,tG()),T(this,`_isTablet`,rG()),T(this,`_isDesktop`,!this._isMobile&&!this._isTablet),T(this,`_playerContainer`,document.createElement(`DIV`)),T(this,`imaManager`,void 0),T(this,`_videoElement`,document.createElement(`VIDEO`)),T(this,`_userClickedToPlay`,!1),T(this,`_intentionalPause`,!1),T(this,`_boundHandlers`,void 0),T(this,`_isInstream`,!1),T(this,`_instreamTypes`,[rC.AutoInjected,rC.EmbeddedStationary,rC.RelatedSticky]),T(this,`requestVideoBids`,()=>(M.error(`VideoPlayerBase`,`requestVideoBids`,`Request video bids not set`),new Promise((e,t)=>t()))),T(this,`buildVideoUrl`,()=>{throw Error(`Build video url not set`)}),T(this,`waitForConsent`,()=>{throw Error(`Wait for consent not set`)}),T(this,`_callResumedCallback`,()=>this._resumedCallback()),T(this,`_muteVolume`,()=>{var e;return(e=this._videoPlayerControls)==null?void 0:e.muteVolume()}),T(this,`_getVolumeLevel`,()=>{var e,t;return(e=(t=this._videoPlayerControls)==null?void 0:t.volumeLevel)==null?0:e}),T(this,`_getPreventClick`,()=>{var e,t;return(e=(t=this._videoPlayerControls)==null?void 0:t.preventClick)==null?!1:e}),T(this,`_getIntentionalPause`,()=>this._intentionalPause),T(this,`_getState`,()=>this.state),T(this,`_setPlayButtonState`,()=>this.setPlayButtonState()),T(this,`_setState`,e=>{this.state=e}),T(this,`_setIntentionalPause`,e=>{this._intentionalPause=e}),T(this,`_setUserClickedToPlay`,e=>{this._userClickedToPlay=e}),T(this,`_setIsVideoContent`,e=>{this.isVideoContent=e}),T(this,`_getIsVideoContent`,()=>this.isVideoContent),this._boundHandlers=new Map,this._isInstream=this._instreamTypes.includes(this._playerType),this._videoPlayerControls=this._setupVideoPlayerControls(),this.imaManager=new lC(a,n,i,s,this._container,this._videoElement,this._eventProxy,this._getVolumeLevel,this._muteVolume,this._getPreventClick,this._setPlayButtonState,this._getState,this._setState,this._getIntentionalPause,this._setIntentionalPause,this._setUserClickedToPlay,this._callResumedCallback,this._setIsVideoContent,!!this._shouldUseHardcodedAdPodDuration)}_setupVideoPlayerControls(){return new sC({videoElement:this._videoElement,playerType:this._playerType,isDesktop:this._isDesktop,getIsVideoContent:this._getIsVideoContent})}attachEventHandlers(e){for(let t of e)this.addEventHandler(t.target,t.event,t.handler)}addEventHandler(e,t,n){let r=n.bind(this),i=this.getHandlerKey(e,t);this._boundHandlers.set(i,r),e.addEventListener(t,r,!1)}getHandlerKey(e,t){return`${e.constructor.name}_${t}`}async init(){try{await this.imaManager.init()}catch(e){M.error(`VideoPlayer`,`init`,this._playerType,`Failed to initialize player. IMA is not defined.`);return}this.injectPlayer()}injectPlayer(){this._remove(),this._injectPlayer(),this.ready.emit()}_injectPlayer(){this._isInstream&&this._injectInstreamPlayer(),this._container.id=`adthrive-${this._playerType}-container`,this._videoElement.setAttribute(`webkit-playsinline`,`true`),this._videoElement.setAttribute(`playsinline`,`true`),this._videoElement.setAttribute(`disablePictureInPicture`,`true`),this._pageElement.appendChild(this._container),this.imaManager.setupOnInject()}setPlayButtonState(){let e=this.imaManager.isAdActive&&this.state===`playing`||this.isVideoContent&&this.videoContentState===`playing`,t=this.imaManager.isAdActive&&this.state===`paused`,n=this.isVideoContent&&this.videoContentState===`paused`,r=t||n;if(e){var i;(i=this._videoPlayerControls)==null||i.setPlayButtonState(`pause`)}else if(r){var a;(a=this._videoPlayerControls)==null||a.setPlayButtonState(`play`)}}_play(e){this.imaManager.setIsAdActive(!1),this.isVideoContent=!0,this.videoContentState=`playing`,this.setPlayButtonState(),this.play.emit(e)}_playerClick(e){var t;!this.isVideoContent||(t=this._videoPlayerControls)!=null&&t.preventClick||(this.videoContentState===`playing`?this._pauseVideoPlayer(e):this.videoContentState===`paused`&&this._playVideoPlayer(),this.setPlayButtonState(),this.click.emit(e))}_playerVolumeChange(e){this.playerVolumeChange.emit(e)}_loadedMetaData(e){this.loadedMetaData.emit(e)}_pause(e){this.videoContentState=`paused`,this.setPlayButtonState(),this.pause.emit(e)}_error(e){this.error.emit(e)}_seeking(e){this.seeking.emit(e)}_seeked(e){this.seeked.emit(e)}_ended(e){this.videoContentState=`ended`,this.ended.emit(e)}_timeupdate(e){this.timeupdate.emit(e)}_resumedCallback(){this.playerNumber&&this._eventProxy.emitVideoPlayingEvent({playerNumber:this.playerNumber,playerType:this._playerType})}_remove(){this.imaManager.remove()}_removePlayer(){var e;(e=this._container)==null||(e=e.parentElement)==null||e.removeChild(this._container)}_injectInstreamPlayer(){var e;let t=this._container,n=this._videoElement,r=this._playerPosition,i=this._playerType;this._initVideoListeners();let a=il.isRolloutEnabled(`nsrp`);a&&t.setAttribute(`data-nosnippet`,``),t.className=`adthrive-${i}-player-container`,(this._playerType===rC.AutoInjected||this._playerType===rC.RelatedSticky)&&t.classList.add(`adthrive-collapse-player`),r.classList.add(`raptive-player-position`),this._config.video.removeVideoTitleWrapper||this.createTitleOverlayContainer(),n.classList.add(`raptive-player-video`),this._playerContainer.classList.add(`raptive-player-container`,`raptive-player-reset`),this._isMobile&&this._playerContainer.classList.add(`raptive-player-container-mobile`),this._playerContainer.appendChild(n),this._playerContainer.appendChild(this.imaManager.adContainer),r.appendChild(this._playerContainer),t.appendChild(r);let o={play:this._playVideoPlayer.bind(this),pause:this._pauseVideoPlayer.bind(this),volume:this._onVolumeChange.bind(this),fullscreen:this._onToggleFullscreen.bind(this),onkickoffAdPlayback:()=>{this.kickoffAdPlayback.emit(),this._eventProxy.emitVideoPlayingEvent({playerNumber:this.playerNumber,playerType:this._playerType})}};(e=this._videoPlayerControls)==null||e.enablePlayerControls(o)}_initVideoListeners(){this.attachEventHandlers([{target:this._videoElement,event:`ended`,handler:this._ended},{target:this._videoElement,event:`error`,handler:this._error},{target:this._videoElement,event:`seeking`,handler:this._seeking},{target:this._videoElement,event:`seeked`,handler:this._seeked},{target:this._videoElement,event:`loadedmetadata`,handler:this._loadedMetaData},{target:this._videoElement,event:`pause`,handler:this._pause},{target:this._videoElement,event:`play`,handler:this._play},{target:this._videoElement,event:`click`,handler:this._playerClick.bind(this)},{target:this._videoElement,event:`volumechange`,handler:this._playerVolumeChange},{target:this._videoElement,event:`timeupdate`,handler:this._timeupdate}])}createTitleOverlayContainer(e=!1){let t=this._playerType===rC.AutoInjected||this._playerType===rC.RelatedSticky&&e;this._videoTitleOverlayContainer.classList.add(`adthrive-title-overlay`);let n=document.createElement(`div`);n.classList.add(`adthrive-video-title-description-container`,`adthrive-video-text-cutoff`),this._videoTitleDiv.id=`adthrive-video-title-text`,this._videoDescriptionDiv.id=`adthrive-video-description-text`,n.appendChild(this._videoTitleDiv),this._isMobile||n.appendChild(this._videoDescriptionDiv),t?(this._wrapperTitleWrapperElement=document.createElement(`a`),this._wrapperTitleWrapperElement.classList.add(`adthrive-wrapper-title-wrapper`),this._wrapperTitleWrapperElement.appendChild(n),this._videoTitleOverlayContainer.appendChild(this._wrapperTitleWrapperElement)):this._videoTitleOverlayContainer.appendChild(n),this._playerContainer.appendChild(this._videoTitleOverlayContainer)}_pauseVideoPlayer(e){var t;if(!((t=this._videoPlayerControls)!=null&&t.preventClick)){if(e&&(this._intentionalPause=!0),this.isVideoContent&&this.videoContentState!==`paused`)this._videoElement.pause();else if(this.state!==`paused`){var n;(n=this.imaManager.adsManager)==null||n.pause()}}}_playVideoPlayer(){var e;if((e=this._videoPlayerControls)!=null&&e.preventClick)return;this._isInstream&&this.playerNumber&&this._eventProxy.emitVideoPlayingEvent({playerNumber:this.playerNumber,playerType:this._playerType});let t=this.videoContentState!==`playing`&&this.isVideoContent;if(t)this._videoElement.play();else if(this.state!==`playing`){var n;this._intentionalPause=!1,(n=this.imaManager.adsManager)==null||n.resume()}}_onVolumeChange(){var e,t;let n=(e=(t=this._videoPlayerControls)==null?void 0:t.volumeLevel)==null?0:e;if(this.isVideoContent){var r;(r=this._videoPlayerControls)==null||r.setVolume(n)}else{var i;(i=this.imaManager.adsManager)==null||i.setVolume(n)}}_onToggleFullscreen(){let e=this._playerContainer;e&&(Oi()&&this._videoElement&&this._videoElement.webkitSupportsFullscreen?this._videoElement.webkitEnterFullscreen():document.fullscreenElement?document.exitFullscreen().then(()=>e.classList.remove(`raptive-player-fullscreen`)).catch(e=>{console.error(`Error attempting to exit fullscreen mode: ${e.message}`)}):e.requestFullscreen().then(()=>e.classList.add(`raptive-player-fullscreen`)).catch(e=>{console.error(`Error attempting to enable fullscreen mode: ${e.message}`)}))}_resetPlayerReferences(){this.imaManager.resetAdContainer(),this._container=document.createElement(`DIV`),this._videoElement=document.createElement(`VIDEO`),this._videoPlayerControls=this._setupVideoPlayerControls(),this._playerContainer=document.createElement(`DIV`),this._playerPosition=document.createElement(`DIV`),this._videoDescriptionDiv=document.createElement(`DIV`),this._videoTitleDiv=document.createElement(`DIV`),this._videoTitleOverlayContainer=document.createElement(`DIV`)}_removeInstream(e=!1){e&&(this._removePlayer(),e&&this._resetPlayerReferences()),this.imaManager.remove(e)}destroy(){}}})),fC,ise=o((()=>{dC(),oC(),rU(),w(),E(),fC=class extends uC{constructor(e,t,n,r,i,a,o,s,c){super(e,t,n,r,a,s,i,o),this.adId=c,T(this,`adPlaying`,!1),T(this,`_adDetails`,void 0),T(this,`_footerConfigEventBus`,void 0),T(this,`_footerVideoRibbonStateListenerOff`,void 0),this._footerConfigEventBus=x.resolve(xr),this.ready.on(this._handleReady.bind(this)),this.imaManager.adStarted.on(this._handleAdStart.bind(this)),this.imaManager.allAdsCompleted.on(this._handleAdErrorOrComplete.bind(this)),this.imaManager.adError.on(this._handleAdErrorOrComplete.bind(this)),this.imaManager.adLoaded.on(e=>{var t;(t=this._videoPlayerControls)==null||t.enablePlayerControls({play:this.imaManager.playAd.bind(this.imaManager,!0),pause:e=>this.imaManager.pauseAd({event:e}),volume:this._onVolumeChange.bind(this)},this.imaManager.adContainer),this._adDetails=e}),this._listenForVideoRibbonFooter()}get adDetails(){return this._adDetails}_listenForVideoRibbonFooter(){this._footerVideoRibbonStateListenerOff=this._footerConfigEventBus.footerVideoRibbonStateChanged.on(e=>{e?this.imaManager.pauseAd():this.state===`paused`&&!this._intentionalPause&&this.imaManager.playAd()})}_handleReady(){this.adPlaying=!1;let e=document.getElementsByClassName(`adthrive-sticky-outstream-idle`)[0],t=document.getElementsByClassName(`adthrive-sticky-outstream-active`)[0];e?e.classList.add(`adthrive-new-outstream-player`):t&&this._toggleActive(!0)}_handleAdStart(){this.adPlaying=!0,this._toggleActive(!0)}_handleAdErrorOrComplete(){this.adPlaying=!1,this._toggleActive(!1),this._remove(),this._footerVideoRibbonStateListenerOff&&this._footerVideoRibbonStateListenerOff()}_toggleActive(e){let t=document.getElementsByClassName(`adthrive-new-outstream-player`)[0];t&&(e?(t.classList.add(`adthrive-sticky-outstream-active`),t.classList.remove(`adthrive-sticky-outstream-idle`)):(t.classList.remove(`adthrive-sticky-outstream-active`),t.classList.add(`adthrive-sticky-outstream-idle`)))}_injectPlayer(){let e=this._container,t=this._videoElement,n=this._playerType,r=this.size;n===rC.StickyOutstream&&this._pageElement.classList.add(`adthrive-video-stickyoutstream-new-player`),e.className=`adthrive-${n}-container adthrive-player-idle`,e.style.width=`${r[0]}px`,e.style.height=`${r[1]}px`,t.style.width=`${r[0]}px`,t.style.height=`${r[1]}px`,e.appendChild(t),e.appendChild(this.imaManager.adContainer),t.load(),super._injectPlayer()}_remove(){this._removePlayer(),super._remove()}}})),pC,mC,hC,gC,_C,vC,yC,bC=o((()=>{B(),Z(),$(),FS(),HS(),ise(),oC(),w(),X(),rU(),Bh(),jc(),j(),E(),O(),yC=class{constructor(e,t,n,r,i,a){this._config=e,this._slotManager=t,this._videoEventProxy=n,this._slotEventBus=r,this._gamEventBus=i,this._prebidMethods=a,T(this,`_stickyOutstreamSize`,void 0),T(this,`_sharedConfig`,{context:`outstream`,mimes:[`video/mp4`,`application/javascript`],api:[2],skip:0,pos:1,protocols:[2,3,5,6,7,8],linearity:1,minduration:0,maxduration:this._config.video.maxDuration,playbackmethod:[2],plcmt:4}),T(this,`_forcedRefreshLimit`,3),T(this,`_imaEndpoint`,`https://imasdk.googleapis.com/js/sdkloader/ima3.js`),T(this,`_viewableImpressionDelay`,1001),T(this,`_erroredOutCreativeIds`,new Map),T(this,`_offEvents`,[]),T(this,`_outstreamPlayer`,void 0),T(this,`_lastRenderedAdId`,null),T(this,`_prebidBidDetails`,void 0),T(this,`_amazonBidDetails`,void 0);let{desktop:o,tablet:s}=this._config.site.breakpoints;this._stickyOutstreamSize=Cn(s,o)===`phone`?[178,100]:[227,150],this._gamEventBus.slotRenderEnded.on(e=>this._setTargetingForFill(e)),this._slotEventBus.gamEmptyNoBidResponse.on(e=>this._noFillForceRefresh(e)),this._slotEventBus.noBidResponses.on(e=>{let t=this._slotManager.getSlot(e);t&&(t.isRefreshing=!1,this._setSlotForceRefresh(t.id,!1,!0))})}get outstreamPlayer(){return this._outstreamPlayer}callRendererWithUrl(e,t,n=!1){var r;this._amazonBidDetails=(r=window.apsBidObject)==null?void 0:r.targetingMap;let i=n?rC.StickyOutstream:rC.Outstream,a=n?this._stickyOutstreamSize:[300,225];this._callRenderAd({adTagUrl:e},t,i,a)}get standardOutstreamConfig(){let e=this._config.video,t={...this._rendererConfig},n=e.outstreamPlacement;return e.setStandardOutstreamBackupRenderer&&(t.renderer.backupOnly=!0),{playerSize:[640,480],...n&&{placement:n},...this._sharedConfig,...t}}get stickyOutstreamConfig(){return{...this._sharedConfig,...this._rendererConfig,startdelay:0,placement:5,playerSize:this._stickyOutstreamSize}}get _rendererConfig(){return{renderer:{url:this._imaEndpoint,render:e=>{this._renderer(e)}}}}_logAdInterruption(e){var t;let n=(t=this._outstreamPlayer)==null||(t=t.adDetails)==null?void 0:t.ad,r=e.refreshCount,i=n==null?void 0:n.adId,a=n==null?void 0:n.duration;M.event(`Outstream`,`_logAdInterruption`,{nref:r,adId:i,adDur:a})}_callRenderer(e,t,n,r=!1){let i=this._slotManager,a=i.getSlot(e),o=r?rC.StickyOutstream:rC.Outstream;if(a&&r){var s;a.stickyOutstreamShortVideo=!1,a.stickyOutstreamLastAdErrored=!1,a.stickyOutstreamRefreshTimeout=5e3,a.stickyOutstreamErrorLogged=!1,a.stickyOutstreamRenderedTimestamp=Date.now();let e=(s=this._outstreamPlayer)==null?void 0:s.adPlaying;e&&this._logAdInterruption(a)}this._callRenderAd(t,e,o,n)}_callRenderAd(e,t,n,r){let i=document.getElementById(t);if(i){var a;let o=Math.floor(Math.random()*1e8).toString(),s=this._config;(a=this._outstreamPlayer)==null||a.destroy();let c=this._outstreamPlayer=new fC(o,``,n,i,this._videoEventProxy,r,!0,s,t);this._setPlayerEvents(c,e),c.init().catch(()=>{M.error(`Outstream`,`_callRenderAd`,`Outstream failed to initialize`)})}}_handleAdImpression(e){let t=this._slotManager,n=t.getSlot(e);this._lastRenderedAdId=null,!(!e.includes(`StickyOutstream`)||!n)&&this._logCreativeIdWithPreviousError(n,e)}_handleComplete(e){var t;let n=this._slotManager,r=n.getSlot(e);!e.includes(`StickyOutstream`)||!r||(t=this.outstreamPlayer)==null||t.destroy()}_getAdDetailsForLogging(e){let{ad:t}=e.adDetails||{},n={adId:t==null?void 0:t.adId,mediaFileURL:t==null?void 0:t.mediaUrl,vastCreativeId:t==null?void 0:t.creativeId,wrapperCreativeIds:t==null?void 0:t.adWrapperCreativeIds,wrapperIds:t==null?void 0:t.adWrapperIds,wrapperSystems:t==null?void 0:t.adWrapperSystems};return n}_isStickyOutstream(e){return e.includes(`StickyOutstream`)}_getBidDetailsForLogging(e){var t,n,r,i,a;let o=this._isStickyOutstream(e),s=o?this._amazonBidDetails:this._config.amazon.availableBids.get(e),c={amznbid:s==null?void 0:s.amznbid,amznp:s==null?void 0:s.amznp,amz_bidder:s==null?void 0:s[o?`amz_bidder`:`bidder`],amz_pb:s==null?void 0:s.amz_pb},l={adomain:(t=this._prebidBidDetails)==null?void 0:t.hb_adomain,hb_bidder:(n=this._prebidBidDetails)==null?void 0:n.hb_bidder,hb_crid:(r=this._prebidBidDetails)==null?void 0:r.hb_crid,hb_pb:(i=this._prebidBidDetails)==null?void 0:i.hb_pb,hb_deal:(a=this._prebidBidDetails)==null?void 0:a.hb_deal};return{...c,...l}}_handleErrorEvent(e,t){var n,r;this._handleOffEvent();let i=this._slotManager,a=e.adId,o=i.getSlot(a),s=e.imaManager.imaSDKVersion;M.error(`Outstream`,`vastError`,{adUnitName:a,imaSDKVersion:s,...this._getAdDetailsForLogging(e),...this._getBidDetailsForLogging(a),...t}),!(!this._isStickyOutstream(a)||!o)&&(this._creativeFailureDetection(o,(n=this._lastRenderedAdId)==null?``:n),o.stickyOutstreamRefreshTimeout=2500,o.stickyOutstreamLastAdErrored=!0,this._lastRenderedAdId=null,this._setSlotForceRefresh(a,!0),(r=this.outstreamPlayer)==null||r.destroy())}_creativeFailureDetection(e,t){let n=this._config,r=this._prebidMethods.getBidResponsesForAdUnitCode(e.id).bids||[],i=n.video.outstreamCreativeFailureThreshold;for(let e of r){var a;let r=(a=e.creativeId)==null?void 0:a.toString();if(e.adId===t&&r&&!n.prebid.blockedCreativeIds.includes(r)){let e=this._erroredOutCreativeIds.get(r)||0;e++,this._erroredOutCreativeIds.set(r,e),e>=i&&n.prebid.blockedCreativeIds.push(r);break}}}_logCreativeIdWithPreviousError(e,t){let n=this._prebidMethods.getBidResponsesForAdUnitCode(e.id).bids||[];for(let e of n)if(e.adId===t&&e.creativeId){let t=this._erroredOutCreativeIds.get(e.creativeId.toString())||0;t&&M.event(`JWPlayer`,`_logCreativeIdWithPreviousError`,{creativeId:e.creativeId});break}}_handleAdTimeChange(e,t){let n=this._slotManager,r=n.getSlot(t),i=!1;if(!t.includes(`StickyOutstream`)||!r)return;let{duration:a,position:o}=e,s=(a||30)-o,c=a<10,l=this._config.prebid.refreshStickyOutstreamAuctionCount!==1,u=o<100&&o>30&&o<a;if(i=l&&!c?s>0&&s<=10||u:s>0&&s<=5||u,i&&!r.isRefreshing){let e=l&&!c?1e4:5e3;a<5&&(e=a*1e3),r.stickyOutstreamShortVideo=c,r.stickyOutstreamRefreshTimeout=e,this._setSlotForceRefresh(t)}}_handleAdSkip(e){let t=this._slotManager,n=t.getSlot(e);!e.includes(`StickyOutstream`)||!n||(n.stickyOutstreamRefreshTimeout=2500,this._setSlotForceRefresh(e))}_handleOffEvent(){this._offEvents=this._offEvents.filter(e=>(e(),!1))}_renderer(e){this._prebidBidDetails=e.adserverTargeting;let t=e.ad||e.vastXml,n=e.adUnitCode.indexOf(`StickyOutstream`)!==-1,r=n?this._stickyOutstreamSize:[300,225],i=t?{adResponse:t}:{adTagUrl:e.vastUrl};this._lastRenderedAdId=e.adId,this._callRenderer(e.sharedBidInUse||e.adUnitCode,i,r,n)}_setPlayerEvents(e,t){let n=this._offEvents;n.push(e.imaManager.adImpression.on(()=>this._handleAdImpression(e.adId))),n.push(e.imaManager.adError.on(t=>this._handleErrorEvent(e,t))),n.push(e.imaManager.adCompleted.on(()=>this._handleComplete(e.adId))),n.push(e.ready.on(()=>{e.imaManager.playAdOutStream(t)})),n.push(e.imaManager.adProgress.on(t=>this._handleAdTimeChange(t,e.adId))),n.push(e.imaManager.adSkipped.on(()=>this._handleAdSkip(e.adId)))}_setSlotForceRefresh(e,t=!1,n=!1){let r=this._slotManager,i=r.getSlot(e),a=e.includes(`StickyOutstream`),o=!t&&!n;if(!i||!a||i.isRefreshing)return;i.isRefreshing=!0;let s=t&&i.stickyOutstreamErrorCount!==void 0&&i.stickyOutstreamErrorCount<this._forcedRefreshLimit,c=n&&i.noAdRefreshCount!==void 0&&i.noAdRefreshCount<this._forcedRefreshLimit;s?(i.stickyOutstreamErrorCount++,o=!0):c?(i.noAdRefreshCount++,i.setSlotTargetingFlag(`fref`,[`${i.noAdRefreshCount}`],!0),o=!0):(i.stickyOutstreamErrorCount=0,i.setSlotTargetingFlag(`fref`,[`off`],!0));let l=o?this._viewableImpressionDelay:15e3;r.updateRefreshTimeout(i,l)}_setTargetingForFill({event:e,slotId:t}){let n=this._slotManager.getSlot(t);if(!n||n.location!==F.Video_StickyOutstream)return;let r=e.isEmpty;r||(n.noAdRefreshCount=0,n.setSlotTargetingFlag(`fref`,[`${n.noAdRefreshCount}`],!0))}_noFillForceRefresh(e){let t=this._slotManager.getSlot(e);!t||t.location!==F.Video_StickyOutstream||(t.stickyOutstreamRefreshTimeout=2500,this._setSlotForceRefresh(t.id,!1,!0))}},yC=D([C(),A(`design:paramtypes`,[typeof(pC=z!==void 0&&z)==`function`?pC:Object,typeof(mC=PS!==void 0&&PS)==`function`?mC:Object,typeof(hC=VS!==void 0&&VS)==`function`?hC:Object,typeof(gC=Vr!==void 0&&Vr)==`function`?gC:Object,typeof(_C=zh!==void 0&&zh)==`function`?_C:Object,typeof(vC=R!==void 0&&R)==`function`?vC:Object])],yC)})),xC,ase=o((()=>{w(),Ui(),E(),O(),xC=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`AdditionalOutstreamUnitsExperiment`,this._lookup=`AOS`}isEnabled(){return super.isEnabled()}},xC=D([C()],xC)})),SC,ose=o((()=>{w(),Ui(),E(),O(),SC=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`OneVideoStream`,this._lookup=`RMOS1`}},SC=D([C()],SC)})),CC,sse=o((()=>{mU(),w(),O(),CC=class extends pU{init(){this._key=`SuppressOutreamSlowConnection`,this._lookup=`SOCON`}},CC=D([C()],CC)})),wC,cse=o((()=>{mU(),w(),O(),wC=class extends pU{init(){this._key=`NativeDescriptionLength`,this._lookup=`NTVDL`}get result(){return this._result}},wC=D([C()],wC)})),TC,lse=o((()=>{Ui(),w(),E(),O(),TC=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!0)}init(){this._key=`OutstreamWithSOExperiment`,this._lookup=`OWSO`}run(){return super.run()}},TC=D([C()],TC)})),EC,use=o((()=>{Ui(),w(),E(),O(),EC=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`NativeHoldout`,this._lookup=`NTVHO`}},EC=D([C()],EC)})),DC,dse=o((()=>{mU(),w(),O(),DC=class extends pU{init(){this._key=`NativeRecipeTitleLength`,this._lookup=`NTVRTL`}get result(){return this._result}},DC=D([C()],DC)})),OC,kC=o((()=>{X(),OC=(e,t)=>{let n=e.get(t.name);return n&&t.type===`RaptivePlayer`&&t.name!==vW.Video_In_Post_ClicktoPlay_SoundOn&&(n=t.muted?2:1),n}})),AC,jC,MC,NC,PC,FC,IC,LC,RC,zC,BC,VC=o((()=>{$h(),B(),Ra(),X(),w(),bC(),ase(),ose(),sse(),Z(),cse(),lse(),use(),dse(),kC(),j(),E(),O(),BC=class{constructor(e,t,n,r,i,a,o,s,c,l){this._config=e,this._context=t,this._gam=n,this._outstream=r,this._outstreamWithSOExperiment=i,this._oneVideoStreamExperiment=a,this._soconExperiment=o,this._nativeDescriptionLengthExperiment=s,this._nativeHoldoutExperiment=c,this._nativeRecipeTitleLengthExperiment=l,T(this,`additionalOutstreamUnitsExperiment`,!1),T(this,`_standardOutstreamSlots`,new Set([F.Content_1,F.Below_Post,F.Video_StickyOutstream_1])),T(this,`_nativeEligibleSlots`,[F.Content,F.Recipe]),T(this,`_native`,void 0),this._native={size:[300,300],contentSize:[300,150],recipeSizes:[[320,300],[300,390]],recipeMobileSize:[300,300],titleLength:25,recipeTitleLength:this._nativeRecipeTitleLengthExperiment.result||25,descriptionLength:this._nativeDescriptionLengthExperiment.result||0}}runOneStreamExperiment(){let e=x.resolve(xC);this._gam.setTargeting({key:`abgroup`,value:this._config.abGroup.groups.join(`,`)}),this.additionalOutstreamUnitsExperiment=e.result,this.additionalOutstreamUnitsExperiment&&[F.Content_3,F.Content_5,F.Recipe_1].forEach(e=>{this._standardOutstreamSlots.add(e)})}isOutstreamAllowed(){return!this._oneVideoStreamExperiment.result||!this._config.video.hasJwPlayer}isSlowConnection(){var e;let t=(e=this._soconExperiment.result)==null?0:e;if(this._context.downlink!==void 0){let e=this._context.downlink;return e<=t}return!1}outstreamEnabled(e){let t=e.location===F.Video_StickyOutstream,n=!t&&this.isSlowConnection(),r=(this._config.adTypes.outstreamEnabled||t)&&this.outstreamSlots.has(e.placementMapName)&&this.isOutstreamAllowed()&&!n;return{outstreamCapable:r}}nativeEnabled(e){let t=this._nativeHoldoutExperiment.result,n=this._config.adTypes.has(tG()?`nativeMobile${e.location}`:`nativeDesktop${e.location}`),r=!t&&!!n&&!!this._nativeEligibleSlots.includes(e.location);return e.location.includes(F.Recipe)?r&&!!this.getNativeRecipeSize(e.sizes):r}getNativeRecipeSize(e){return tG()?e.find(e=>e[1]===this._native.recipeMobileSize[1]):e.find(e=>e[0]===this._native.recipeSizes[0][0]&&e[1]===this._native.recipeSizes[0][1]||e[0]===this._native.recipeSizes[1][0]&&e[1]===this._native.recipeSizes[1][1])}getMediaType(e,t={}){let n={},{slot:r,video:i}=e;if(i&&this._config.video.instreamAdUnits.has(i.name)&&this._config.video.plcmtUnits.has(i.name)){let e=this.getInstreamConfig(i);n.video=e}else if(r){let e={sizes:r.sizes,...r.isHighlyViewable()&&{pos:1},...r.mainAuctionWidth&&r.mainAuctionHeight&&{w:r.mainAuctionWidth,h:r.mainAuctionHeight}};t.banner&&(n.banner=e),t.outstream&&(n.video=r.location===F.Video_StickyOutstream?this._outstream.stickyOutstreamConfig:this._outstream.standardOutstreamConfig),t.native&&(n.native=this._getNativeConfig(r.location,(r.sequence||1)-1,r.sizes))}return n}get outstreamSlots(){return this._outstreamWithSOExperiment.result?this._standardOutstreamSlots:new Set([F.Video_StickyOutstream_1])}getInstreamConfig(e){var t,n;let r=OC(this._config.video.plcmtUnits,e);return{context:`instream`,playerSize:e.size,mimes:this._config.video.mimeType,protocols:(t=this._config.video.videoProtocols)==null?void 0:t.protocols,...r&&{plcmt:r},maxduration:this._config.video.maxDuration,...((n=this._config.video.playbackmethod)==null?void 0:n.get(e.name))&&{playbackmethod:this._config.video.playbackmethod.get(e.name)},...e.collapsible&&{playbackend:3},linearity:1,api:this._config.video.apiValue,w:e.size[0],h:e.size[1],pos:this._config.video.position.id,minduration:1,startdelay:0,placement:1,skip:0,delivery:[1,2]}}_getNativeSize(e,t){if(e.includes(F.Content))return this._native.contentSize;if(e.includes(F.Recipe))return this.getNativeRecipeSize(t)}_getAdditionalNativeParams(e){return{context:1,contextsubtype:10,privacy:0,seq:e}}_getNativeConfig(e,t,n){let r=this._native,i=this._getNativeSize(e,n)||r.size,a=e.includes(F.Recipe);return{ortb:{ver:`1.2`,plcmttype:1,eventtrackers:[{event:1,methods:[1,2]}],assets:[{id:1,required:1,title:{len:a?r.recipeTitleLength:r.titleLength}},{id:2,required:1,img:{type:3,wmin:i[0],hmin:i[1]}},{id:3,required:1,img:{type:1,wmin:20,hmin:20}},{id:4,required:1,data:{type:1}},{id:5,required:1,data:{type:2,...r.descriptionLength&&{len:r.descriptionLength}}}],...this._config.prebid.sendAdditionalNativeParams&&this._getAdditionalNativeParams(t)}}}},BC=D([C(),A(`design:paramtypes`,[typeof(AC=z!==void 0&&z)==`function`?AC:Object,typeof(jC=L!==void 0&&L)==`function`?jC:Object,typeof(MC=Zh!==void 0&&Zh)==`function`?MC:Object,typeof(NC=yC!==void 0&&yC)==`function`?NC:Object,typeof(PC=TC!==void 0&&TC)==`function`?PC:Object,typeof(FC=SC!==void 0&&SC)==`function`?FC:Object,typeof(IC=CC!==void 0&&CC)==`function`?IC:Object,typeof(LC=wC!==void 0&&wC)==`function`?LC:Object,typeof(RC=EC!==void 0&&EC)==`function`?RC:Object,typeof(zC=DC!==void 0&&DC)==`function`?zC:Object])],BC)})),HC,fse=o((()=>{HC={Crafts:{id:`540522cb5c0eb47de4152801`,iabCode:`IAB9-2`,iabCat:`Arts & Crafts`},Family_and_Parenting:{id:`540522cb5c0eb47de4152802`,iabCode:`IAB9-2`,iabCat:`Family & Parenting`},Personal_Finance:{id:`540522cb5c0eb47de4152803`,iabCode:`IAB13`,iabCat:`Personal Finance`},Food:{id:`540522cb5c0eb47de4152804`,iabCode:`IAB8`,iabCat:`Food & Drink`},Home_Decor_and_Design:{id:`540522cb5c0eb47de4152807`,iabCode:`IAB10`,iabCat:`Home & Garden`},Sports:{id:`540522cb5c0eb47de4152809`,iabCode:`IAB17`,iabCat:`Sports`},Entertainment:{id:`55d374253d3884315c3d0bca`,iabCode:`IAB1`,iabCat:`Arts & Entertainment`},Gardening:{id:`5a4fab0ce6ec1959fd678d46`,iabCode:`IAB10-4`,iabCat:`Gardening`},Mens_Style_and_Grooming:{id:`5a4fab1de6ec1959fd678d47`,iabCode:`IAB18`,iabCat:`Style & Fashion`},Pets:{id:`5a4fab2ee6ec1959fd678d49`,iabCode:`IAB16`,iabCat:`Pets`},Tech:{id:`5a4fab38e6ec1959fd678d4a`,iabCode:`IAB19`,iabCat:`Technology & Computing`},Wedding:{id:`5a4fab42e6ec1959fd678d4b`,iabCode:`IAB14-7`,iabCat:`Weddings`},Professional_Finance:{id:`5aa2f3a7fdf4d60603ab3a65`,iabCode:`IAB13`,iabCat:`Personal Finance`},Deals:{id:`5c05a3d19e385c167333449c`,iabCode:`IAB13`,iabCat:`Personal Finance`},Vegetarian:{id:`5c113968b4fc765c1cbd3a54`,iabCode:`IAB8-17`,iabCat:`Vegetarian`},Auto:{id:`5c11399bb4fc765c1cbd3a91`,iabCode:`IAB2`,iabCat:`Automotive`},Fitness:{id:`5e5571361237cb073f4c414a`,iabCode:`IAB7-1`,iabCat:`Exercise`},Gaming:{id:`615cb84741a24b73b7c34703`,iabCode:`IAB9-30`,iabCat:`Video & Computer Games`},Beauty:{id:`540522cb5c0eb47de4152800`,iabCode:`IAB18-1`,iabCat:`Beauty`},Health_and_Wellness:{id:`540522cb5c0eb47de4152806`,iabCode:`IAB7`,iabCat:`Health & Fitness`},Clean_Eating:{id:`58ebb95fb628206640771353`,iabCode:`IAB8-12`,iabCat:`Health/Lowfat Cooking`},Natural_Parenting:{id:`58ebba85b628206640771355`,iabCode:`IAB6`,iabCat:`Family & Parenting`},Baby:{id:`58ebba8bb628206640771356`,iabCode:`IAB6-2`,iabCat:`Babies & Toddlers`},Pregnancy:{id:`58ebba92b628206640771357`,iabCode:`IAB6-7`,iabCat:`Pregnancy`},Toddler:{id:`58ebba9ab628206640771358`,iabCode:`IAB6-2`,iabCat:`Babies & Toddlers`},Womens_Style:{id:`58ebbaccb628206640771359`,iabCode:`IAB18`,iabCat:`Style & Fashion`},Travel:{id:`58ebbafbb62820664077135a`,iabCode:`IAB20`,iabCat:`Travel`},"History_&_Culture":{iabCode:`IAB14`,iabCat:`Society`},"Arts_&_Creativity":{iabCode:`IAB1`,iabCat:`Arts & Entertainment`},Education:{iabCode:`IAB5`,iabCat:`Education`},Business:{iabCode:`IAB3`,iabCat:`Business`},"Hobbies_&_Interests":{iabCode:`IAB9`,iabCat:`Hobbies & Interests`},Science:{iabCode:`IAB15`,iabCat:`Science`},"Religion_&_Spirituality":{iabCode:`IAB23`,iabCat:`Religion & Spirituality`},Shopping:{iabCode:`IAB22`,iabCat:`Shopping`},"Law,_Gov't_&_Politics":{iabCode:`IAB11`,iabCat:`Law, Gov't & Politics`},Careers:{iabCode:`IAB4`,iabCat:`Careers`},Real_Estate:{iabCode:`IAB21`,iabCat:`Real Estate`}}})),UC,WC=o((()=>{UC=e=>e.type===`JwPlayer`})),GC,KC,qC,JC,YC,XC,ZC,QC,$C,ew=o((()=>{w(),ooe(),B(),Ra(),_W(),jc(),Z(),fse(),rU(),vb(),WC(),nie(),rie(),j(),E(),O(),$C=class{constructor(e,t,n,r,i,a,o,s){this._config=e,this._context=t,this._jwBoostExperiment=n,this._prebidMethods=r,this._spaEventBus=i,this._marmaladeEventBus=a,this._browsingTopicsApiEventBus=o,this._cloudflareIpBidReqExpHo=s,T(this,`_userSegments`,void 0),T(this,`_siteSegments`,void 0),T(this,`_ayEnrichmentEligible`,void 0),T(this,`_data`,{}),this._ayEnrichmentEligible=this._config.prebid.ayServerEnabled,this.createOrtbDataObj(),this._onConsentEvent(),this._marmaladeEventBus.resetMarmaladeData.once(()=>{this._setORTB2Data()}),this._config.marmalade.rfDataProcessed.on(()=>{this._setORTB2Data()}),!this._config.gdpr.enabled&&!this._config.ccpa.userOptedOut&&this._context.browsingTopicsSupported&&this._context.browsingTopics.length===0&&this._browsingTopicsApiEventBus.topicsReceived.on(e=>{this._setDelayedTopicsData(this._convertTopicData(e))})}_setORTB2Data(){this._prebidMethods.addToQueue(()=>{let e=this._prebidMethods.getConfig(`ortb2`)||{};this.createOrtbDataObj();let t=Qy(e,this._data);this._prebidMethods.setConfig({ortb2:t})}),this._spaEventBus.routeChanged.on(()=>{this._prebidMethods.addToQueue(()=>{this.createOrtbDataObj(),this._prebidMethods.setConfig({ortb2:{...this._data}})})})}createOrtbDataObj(){this._userSegments=this._getUserSegments(),this._siteSegments=this._getSiteSegments();let e=this._config.prebid.ortbEnrich,t=this._getUserData(),n=this._getSiteData(e),r=this._getDeviceData(e),i={cur:this._getOrtb2Currency(),site:n,user:t,device:r},a={at:1,source:{fd:0}};this._data={...i,...e&&a}}get data(){return this._data}_getDeviceData(e){var t;let n=this._cloudflareIpBidReqExpHo.result&&Jh(this._config.user.rcid,!!this._context.sessionKey)&&((t=this._config.user.rcid)==null?void 0:t.metadata.clientIp),r=n?_b(n):null,i=r===`IPv6`?`ipv6`:r===`IPv4`?`ip`:null;return{...n&&i&&{[i]:n},...e&&{language:navigator.language.slice(0,2),js:1}}}_getUserData(){return{...this._userSegments.length&&{data:this._userSegments}}}_getSiteData(e){let t=document.documentElement.lang,n=this._config.site.verticals,r=n.length?n[0].replace(/ /g,`_`):``;return{content:{...this._siteSegments.length&&{data:this._siteSegments},...e&&t&&{language:t.slice(0,2)}},...e&&n.length&&HC[r]&&{cat:[HC[r].iabCode],pagecat:[HC[r].iabCode]},...e&&{privacypolicy:1,mobile:1},...this._ayEnrichmentEligible&&{ext:{data:{aysse:this._config.audienceTargeting.ayEnrichmentEnabled,ayssewli:this._config.audienceTargeting.ayEnrichWithLiveIntent,ayssewoli:this._config.audienceTargeting.ayEnrichWithoutLiveIntent,aygroup:this._config.audienceTargeting.ayEnrichmentGroup}}}}}_onConsentEvent(){let e=this._config.ccpa;e.consentChange.on(t=>{this._prebidMethods.addToQueue(()=>{if(t===e.ccpaOptOut){let e=this._prebidMethods.getConfig(`ortb2`)||{};e.user&&(delete e.user,this._prebidMethods.setConfig({ortb2:e}))}})})}_getSiteSegments(){return this.buildSegmentData(this._config.marmalade.ortbSegments.get(`iabc`)||[],6)}_getUserSegments(){if(this._config.ccpa.userOptedOut)return[];let e=this.buildSegmentData(this._config.marmalade.ortbSegments.get(`iaba`)||[],4),t=this._convertTopicData(this._context.browsingTopics);return e.concat(t)}_convertTopicData(e){let t=e.some(e=>e.taxonomy_version===`2`)?601:600;return this.buildSegmentData(e.reduce((e,t)=>[...e,{id:String(t.id)}],[]),t,`adthrive.com`)}_setDelayedTopicsData(e){this._prebidMethods.addToQueue(()=>{let t=this._prebidMethods.getConfig(`ortb2`)||{};t.user=t.user||{},t.user.data=t.user.data||[],t.user.data=t.user.data.concat(e),this._prebidMethods.setConfig({ortb2:t})})}buildSegmentData(e,t,n=`cafemedia.com`){return e.length?[{name:n,segment:e,ext:{segtax:t}}]:[]}buildSegmentDataFromArray(e,t,n){return this.buildSegmentData(e.map(e=>({id:e})),t,n)}setOrtb2Imp(e,t){if(t)for(let n of Object.keys(e))t[n]=e[n]}setOrtb2ImpExt(e,t){t&&(t.ext={...t.ext,...e})}setOrtb2ImpExtData(e,t){var n;t&&(t.ext=(n=t.ext)==null?{}:n,t.ext.data={...t.ext.data,...e})}_setVideoOrtb2ImpData(e,t){this.setOrtb2ImpExtData({adserver:{name:`gam`,adslot:`/${this._config.gam.account}/${this._config.gam.prefix}_${t.name}/${this._config.site.id}`}},e),UC(t)&&!this._config.ccpa.userOptedOut&&this._jwBoostExperiment.result&&this.setOrtb2ImpExtData({jwTargeting:t.getJwBoostTargeting()},e)}_setOrtb2ImpTrafficShapingData({ortb2Imp:e,location:t,refreshCount:n}){var r,i;if(!e)return;e.ext=(r=e.ext)==null?{}:r,e.ext.rpbs=e.ext.rpbs||{};let a=(i=this._config.trafficShaping.getTrafficShapingRule(t,n))==null?void 0:i.dbl;a?e.ext.rpbs.ts={on:!0,dbl:a}:delete e.ext.rpbs}addOrtb2Imp(e,t,n=!1,r){let i=this._config,{slot:a,video:o}=e,s=r||{ext:{data:{}}};if(s.secure=1,i.fledge.enabled&&(this.setOrtb2ImpExt({ae:1},s),a&&this.setOrtb2ImpExtData({banner:{sizes:a.sizes}},s),o&&this.setOrtb2ImpExtData({video:{sizes:o.size}},s)),o)this._setVideoOrtb2ImpData(s,o);else if(a){let e=uG(a),t=dG(e||0);this.setOrtb2ImpExtData({hvp:`${t}`},s)}if(a&&n&&this.setOrtb2Imp({instl:1},s),a&&a.isHighlyViewable()&&this.setOrtb2ImpExtData({pos:`atf`},s),(a||o)&&i.prebid.rpbsEnabled&&i.trafficShaping.active){let e=(a==null?void 0:a.location)||(o==null?void 0:o.name),t=(a==null?void 0:a.refreshCount)||(o==null?void 0:o.prerollNum)||0;e&&this._setOrtb2ImpTrafficShapingData({ortb2Imp:s,location:e,refreshCount:t})}return s}addOrtb2Reg(e,t){this._prebidMethods.addToQueue(()=>{let n=this._prebidMethods.getConfig(`ortb2`)||{};n.regs={gpp:e,gpp_sid:t},this._prebidMethods.setConfig({ortb2:n})})}addEidsToOrtb2(e){let t=Array.isArray(e)?[...e]:[e];this._prebidMethods.addToQueue(()=>{var e,n,r,i,a;let o=(e=this._prebidMethods.getConfig(`ortb2`))==null?{}:e,s=(n=this._data)==null?{}:n,c=Qy(o,s);c.user=(r=c.user)==null?{}:r,c.user.ext=(i=c.user.ext)==null?{}:i,c.user.ext.eids=(a=c.user.ext.eids)==null?[]:a,c.user.ext.eids=c.user.ext.eids.concat(t),this._prebidMethods.setConfig({ortb2:c})})}updateOrtb2WithIris(e){var t,n;if(e.enabled===!1)return;let r=this._prebidMethods.getConfig(`ortb2`)||{},{irisId:i,segmentName:a,irisContextualData:o}=e,s={ext:{segtax:e.segtax,...i&&{cids:[i]}},name:a,segment:(t=o==null?void 0:o.map(e=>({id:e})))==null?[]:t};!((n=r.site)==null||(n=n.content)==null)&&n.data?r.site.content.data.push(s):r.site.content.data=[s],this._prebidMethods.setConfig({ortb2:r})}_getOrtb2Currency(){let e=this._config.prebid.currencyConversionEnabled,t=this._context.country,n=[`USD`],r={GB:`GBP`,CA:`CAD`,AU:`AUD`};return e&&t&&r[t]&&n.unshift(r[t]),n}},$C=D([C(),A(`design:paramtypes`,[typeof(GC=z!==void 0&&z)==`function`?GC:Object,typeof(KC=L!==void 0&&L)==`function`?KC:Object,typeof(qC=SU!==void 0&&SU)==`function`?qC:Object,typeof(JC=R!==void 0&&R)==`function`?JC:Object,typeof(YC=zr!==void 0&&zr)==`function`?YC:Object,typeof(XC=Rr!==void 0&&Rr)==`function`?XC:Object,typeof(ZC=gr!==void 0&&gr)==`function`?ZC:Object,typeof(QC=qh!==void 0&&qh)==`function`?QC:Object])],$C)})),tw,nw,pse=o((()=>{H(),B(),$(),Ta(),w(),j(),O(),nw=class extends V{constructor(e){super(),this._config=e}init(){!Sa()&&!wa()&&this.addPrivacyPreferencesFooter()}addPrivacyPreferencesFooter(){let e=document.createElement(`div`);e.className=`adthrive-privacy-preferences`;let t=document.createElement(`a`);t.href=`javascript:adthrive.cmd.push(adthrive.showPrivacyPreferences);`,t.innerText=`Update Privacy Preferences`,e.appendChild(t),this._config.footer.elements.push({order:1,element:e})}},nw=D([Q(`GDPRComponent`),S(),A(`design:paramtypes`,[typeof(tw=z!==void 0&&z)==`function`?tw:Object])],nw)})),rw,iw,aw,ow,sw=o((()=>{H(),B(),$(),Ta(),Rm(),w(),so(),j(),E(),O(),aw={LOADING:`loading`,TC_LOADED:`tcloaded`,USER_ACTION_COMPLETE:`useractioncomplete`},ow=class extends V{constructor(e,t){super(),this._events=e,this._config=t,T(this,`_queues`,void 0),this._queues=[U,M]}init(){this.checkConsentOnLoad().then(e=>{let t=e&&e.tcString;t?(this._config.gdpr.consentCaptured=!0,this._config.gdpr.revokedPurposeConsent=this._checkForRevokedPurpose(e.purpose),this._config.gdpr.consentCapturedData.consentString=t,e&&e.addtlConsent&&(this._config.gdpr.consentCapturedData.additionalConsent=e.addtlConsent),this._events.consentResponseCaptured.emit(t),this._clearGdprQueues()):this.listenForConsentSubmit().catch(e=>{M.error(`GDPREnforcementComponent`,`init`,`listenForConsentSubmit`,e)})}).catch(e=>{M.error(`GDPREnforcementComponent`,`init`,`checkConsentOnLoad`,e)})}checkConsentOnLoad(){return new Promise(e=>{window.__tcfapi(`addEventListener`,2,(t,n)=>{if(n&&t&&t.eventStatus===`tcloaded`&&t.tcString&&!Sa())return e(t);if(!(t&&t.eventStatus===aw.LOADING))return e({})})})}checkConsentForVendor(e,t){var n;let r=window.__cmp(`getCMPData`),i=(r==null||(n=r.vendorConsents)==null?void 0:n[e])===!0,a=!!(t!=null&&t.every(e=>(r==null?void 0:r.purposeConsents[e])===!0));return Promise.resolve(i&&a)}_clearGdprQueues(){this._queues.forEach(e=>{this.checkConsentForVendor(this._config.gdpr.raptiveVendorId,e.gdprPurposes).then(t=>{t?e.clearQueue(!0):(e.disable=!0,e.clearQueue(!1))}).catch(e=>{M.error(`listenForConsentSubmit`,`clearGdprQueues`,e)})})}listenForConsentSubmit(){return new Promise(e=>{window.__tcfapi(`addEventListener`,2,(t,n)=>{n&&([aw.TC_LOADED,aw.USER_ACTION_COMPLETE].includes(t==null?void 0:t.eventStatus)&&(this._config.gdpr.consentCaptured=!0,this._config.gdpr.cmpUserActionCompleteFired=!0,this._config.gdpr.revokedPurposeConsent=this._checkForRevokedPurpose(t.purpose),t&&t.tcString&&t.tcString.length&&(this._config.gdpr.consentCapturedData.consentString=t.tcString),t&&t.addtlConsent&&t.addtlConsent.length&&(this._config.gdpr.consentCapturedData.additionalConsent=t.addtl_consent),this._events.consentResponseCaptured.emit(t.tcString),this._clearGdprQueues(),window.__tcfapi(`removeEventListener`,2,e=>{},t.listenerId)),e(!0)),e(!1)})})}_checkForRevokedPurpose(e){let t=e&&e.consents||{};return!t[1]||!t[4]}get enabled(){return typeof window.__tcfapi==`function`}},ow=D([Q(`GDPREnforcementComponent`),S(),A(`design:paramtypes`,[typeof(rw=oo!==void 0&&oo)==`function`?rw:Object,typeof(iw=z!==void 0&&z)==`function`?iw:Object])],ow)})),cw=o((()=>{pse(),sw()})),lw,mse=o((()=>{w(),Ui(),E(),O(),lw=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`AmazonTrafficShaping`,this._lookup=`AMZNTS`}},lw=D([C()],lw)})),uw,dw,fw=o((()=>{w(),B(),$(),X(),j(),E(),O(),dw=class{constructor(e){this._config=e,T(this,`_dealExclusion`,{[P.MediaGrid]:{outstream:[`G-TRUSTX`]}}),T(this,`_priceBucket`,[.1,5,20,100]),T(this,`_priceBucketRules`,new Map([[.1,100],[5,20],[20,10],[100,2]])),T(this,`bucketBidPrice`,e=>{let t=this._priceBucket.find(t=>e<=t)||100,n=this._priceBucketRules.get(t);return(Math.floor(e*n)/n).toFixed(2)}),T(this,`adjustAmazonBidPrice`,(e,t,n,r)=>{var i;let a={...e};a.mediaType=r,a.isAmazon=!0,a.amzndeal_sp=(a==null?void 0:a.amzndeal_sp)||((i=a.targeting)==null?void 0:i.amzndeal_sp);let o=this.adjustCpmFromBidResponse(n,t,a);return Math.max(o,0)}),T(this,`adjustCpmFromBidResponse`,(e,t,n)=>{let r=this._getCombinedFees(t,n),i=this._calculateAdjustment(e,r,n);return Math.max(i,0)}),T(this,`adjustFloorFromBidRequest`,(e,t,n,r=!1)=>{let i=this._config.prebid.bidderInflatorMap.get(e)||1;n*=r?i:1;let a=this._getCombinedFees(e,t),o=this._calculateAdjustment(n,a,t,r);return o/(r?1:i)}),T(this,`_getMediaTypeFromBidResponse`,e=>{var t;let n=`default`,r=`mediaTypes`in e?e.mediaTypes:{},i=Object.keys(r).length>1||(t=Object.keys(r)[0])==null?`default`:t,a=`mediaType`in e?e.mediaType:i,o=`adUnitCode`in e?e.adUnitCode:e.slotID,s=`meta`in e?e.meta:{},c=this._config.video.instreamAdUnits.has(o),l=o==null?void 0:o.includes(F.Video_StickyOutstream),u=(s==null?void 0:s.isInBannerVideo)||a===`video`&&!c&&!l,d=a===`native`;return c?n=`instream`:l?n=`stickyOutstream`:u?n=`outstream`:d&&(n=`native`),n}),T(this,`_getConfigData`,e=>{var t,n,r,i,a,o,s,c;let l=this._config.partners,u=qn,d=(t=(n=e.cpmMap)==null?void 0:n.get(u.default))==null?l.getDefaultDiscount():t,f=(r=e.cpmMap)==null?void 0:r.get(u.native),p=(i=e.cpmMap)==null?void 0:i.get(u.outstream),m=(a=e.cpmMap)==null?void 0:a.get(u.stickyOutstream),h=(o=(s=e.cpmMap)==null?void 0:s.get(u.instream))==null?l.getDefaultInstreamDiscount(d):o,g=(c=e.cpmMap)==null?void 0:c.get(u.pmp);return{...d&&{default:d},...f&&{native:f},...p&&{outstream:p},...m&&{stickyOutstream:m},...h&&{instream:h},...g&&{pmp:g}}}),T(this,`_getViewabilityDiscounts`,(e,t)=>{let n=qn,r=Jn,i=e===n.outstream&&`viewability`in t&&t.viewability;return i?{viewability:{flat:r.flat,percent:i}}:void 0})}_applyAdjustment(e,t,n,r,i=!0,a=!1){var o;let s=(o=t[n])==null?0:o,c=e;return e=i?a?e/r:e*r:a?e+r:e-r,t[n]=s+Number((c-e).toFixed(4)),e}_calculateAdjustment(e,t,n,r=!1){let i=e,a={flat:{},percent:{}},o={},s=Jn;for(let[e,n]of Object.entries(t)){var c,l;a.flat[e]=((c=a.flat[e])==null?s.flat:c)+n.flat,a.percent[e]=((l=a.percent[e])==null?s.percent:l)*n.percent}return i=this._getAdjustment(i,o,a,r),this._isFloorsBidRequestData(n)||(n.dscnt={...o},n.aug={...a}),i}_isFloorsBidRequestData(e){return!(`meta`in e||`bidder`in e)}_getAdjustment(e,t,n,r){let i=r?[`flat`,`percent`]:[`percent`,`flat`],a=e;for(let[e,o]of Object.entries(n[i[0]])){let n=i[0]===`percent`;a=this._applyAdjustment(a,t,e,o,n,r)}for(let[e,o]of Object.entries(n[i[1]])){let n=i[1]===`percent`;a=this._applyAdjustment(a,t,e,o,n,r)}return a}_shouldExcludeDealId(e,t,n){var r;let i=(r=this._dealExclusion[e])==null?void 0:r[n];return t&&(i==null?void 0:i.includes(t))}_getCombinedFees(e,t){var n,r,i;let a=this._getMediaTypeFromBidResponse(t),o=`dealId`in t&&t.dealId||`amzndeal_sp`in t&&t.amzndeal_sp||``,s=o&&!this._shouldExcludeDealId(e,o==null?void 0:o.toString(),a),c=this._config.partners.getBidderConfig(e),l=this._getConfigData(c),u=(n=(r=a&&l[a])==null?l.default:r)==null?{}:n,d=s&&l.pmp||{},f=s&&d&&`deals`in d?d==null||(i=d.deals)==null?void 0:i[o.toString()]:{},p=this._getViewabilityDiscounts(a,t),m=[u,d,{discounts:f}].reduce((e,t)=>{var n,r,i,a;return e.flat+=(n=(r=t.discounts)==null?void 0:r.flat)==null?0:n,e.percent*=(i=(a=t.discounts)==null?void 0:a.percent)==null?1:i,e},{flat:0,percent:1}),h={...u,...p&&{...p},discounts:{...m}};return h}},dw=D([Q(`BidCPMAdjuster`),C(),A(`design:paramtypes`,[typeof(uw=z!==void 0&&z)==`function`?uw:Object])],dw)})),pw,mw,hw,gw,_w,vw,yw,bw,xw,Sw,Cw,ww,Tw,Ew,Dw,Ow,hse=o((()=>{$h(),rd(),B(),tU(),X(),IK(),Lt(),Z(),w(),tg(),rg(),vie(),yie(),bie(),Yi(),Vg(),ew(),cw(),so(),rU(),Kh(),mse(),fw(),j(),E(),O(),Dw=`AmazonAuctionManager`,Ow=class extends eg{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p){super(),this._config=e,this._amazonMethods=t,this._amazonHoldDisplayExperiment=n,this._videoEventBus=r,this._bootstrapConfig=i,this._firstPartyDataComponent=a,this._ortb2=o,this._gdprEnforcement=s,this._gdprEvents=c,this._slotEventBus=l,this._floorsEventBus=u,this._amazonEventBus=d,this._amazonTrafficShapingExperiment=f,this._bidCPMAdjuster=p,T(this,`videoSlotNames`,new Map),T(this,`_amazonConfig`,void 0),T(this,`_gptSlot`,new Map),T(this,`_encrypted_cpm_key`,`amznbid`),T(this,`_encrypted_bidder_key`,`amznp`),T(this,`_encrypted_deal_cpm_key`,`amznbid_sp`),T(this,`_encrypted_deal_bidder_key`,`amznp_sp`),T(this,`_decrypted_cpm_key`,`amz_pb`),T(this,`_decrypted_bidder_key`,`amz_bidder`),T(this,`_decrypted_deal_cpm_key`,`amz_pb_sp`),T(this,`_decrypted_deal_bidder_key`,`amz_bidder_sp`),T(this,`_amazon_size_key`,`amznsz`),T(this,`_amazonEncryptedTargetingKeysToRemove`,[`amznp`,`amznp_sp`]),T(this,`_amazonRaptiveFloorKeys`,new Map),T(this,`_floors`,new Map),T(this,`_initialized`,!1),T(this,`_unitBidMapping`,new Map),this._amazonConfig={pubID:this._config.amazon.pubId,deals:this._config.adOptions.pmp,adServer:`googletag`,videoAdServer:`DFP`,...this._config.ccpa.required&&this._config.ccpa.privacyString&&{params:{us_privacy:this._config.ccpa.privacyString}},schain:new ng().getSupplyChainConfig(this._config.site.id)}}init(){this.videoSlotNames=this._initVideoSlotMap(),this._setup()}async _awaitAmazonReady(){return new Promise(e=>{this._amazonEventBus.initialized.once(()=>{e()})})}async _setup(){await this.checkLibLoaded(`init`),this._listenForOutsideGAMRender(),this._listenForAmazonFloors(),this._setupFpdForCCPA(),this._setupFpdForGDPR(),!this._config.ccpa.required&&!this._config.gdpr.enabled&&this._toggleFPDToAmzConfig(!0),this._amazonMethods.init(this._amazonConfig),this._initialized=!0,this._amazonEventBus.initialized.emit()}_listenForAmazonFloors(){this._floorsEventBus.setAmazonFloors.on(e=>{e.forEach(({code:e,value:t,currency:n})=>{this._floors.set(e,{value:t,currency:n})})}),this._floorsEventBus.clearAllFloorData.on(()=>{this._floors=new Map})}_listenForOutsideGAMRender(){this._slotEventBus.adRenderingOutsideGAM.on(({slotId:e})=>{this._config.amazon.availableBids.delete(e)}),this._videoEventBus.videoAdRenderingOutsideGam.on(e=>{this._config.amazon.availableBids.delete(e)})}_setupFpdForGDPR(){this._config.gdpr.enabled&&this._gdprEvents.consentResponseCaptured.on(()=>{this._gdprEnforcement.checkConsentForVendor(this._config.gdpr.raptiveVendorId,[1]).then(e=>{this._toggleFPDToAmzConfig(!!e),this._amazonMethods.init(this._amazonConfig)}).catch(()=>{})})}_setupFpdForCCPA(){this._config.ccpa.required&&(this._config.ccpa.userOptedOut||this._toggleFPDToAmzConfig(!0),this._config.ccpa.consentChange.on(e=>{this._amazonConfig.params&&e&&(this._amazonConfig.params.us_privacy=e),this._toggleFPDToAmzConfig(e!==this._config.ccpa.ccpaOptOut),this._amazonMethods.init(this._amazonConfig)}))}_toggleFPDToAmzConfig(e=!0){if(e){let e={site:{...this._ortb2.data.site,cattax:1},user:{...this._ortb2.data.user}},t={ext:{data:{mcmp:[...this._config.marmalade.mcmp,...this._config.marmalade.rfMcmpCodes.map(e=>e[0])],...this._firstPartyDataComponent.staticFirstPartyData}}};e.site={...e.site,...t},this._amazonConfig={...this._amazonConfig,signals:{ortb2:{...e}}}}else delete this._amazonConfig.signals}clearAuctionTargeting(e){this._clearAmazonKeys([e])}async requestBids(e,t=this._config.timeouts.initialBidsRequest-200,n=!1){try{if(!await this.checkLibLoaded(`requestBids`))return;let r=e.map(e=>e.name),i=Gh.markStartTask(`microtask`,[`AmazonAuctionManager`,`requestBids`]);i.addMetadata({slotNames:r});let a=this.filterExcludedSlots(e,this._config.amazon.adUnitExclusions);if(!a.length){i.markEndTask();return}this._initialized||await this._awaitAmazonReady(),a.forEach(e=>{this._resetAmazonBidMapCpm(e)}),this._mapGptSlotsFromManagedSlots(a);let o=this._requestBidsFromAmazon(a,t,n);return i.markEndTask(),await o}catch(e){M.error(Dw,`requestBids`,e);return}}_getBidsInCache(e,t){let n=this._unitBidMapping.get(e);return{bids:n?[{cpm:n}]:[],requests:1,responses:n?1:0,refresh:t}}async _setBidsInCache(e){let t=`_setBidsInCache`,n=new Map;try{if(!await this.checkLibLoaded(t))return n;e.forEach(e=>{var t;let r=`id`in e?e.id:e.name,i=(t=this._unitBidMapping.get(r))==null?0:t,a=i?1:0;n.set(r,a)})}catch(e){return M.error(Dw,t,e),n}return n}async setPreAuctionBidCacheData(e){return this._setBidsInCache(e)}async setDisplayBidCacheTargeting(e){return this._setDecryptedBidsBasedOnSlotTargetingForSlots(e),this._removeAmazonEncryptedSlotTargetingForSlots(e),this._setBidCacheTargeting(e)}async setInstreamBidCacheTargeting(e){return this._setBidCacheTargeting(e)}async _setBidCacheTargeting(e){let t=`_setBidCacheTargeting`,n=new Map;try{if(!await this.checkLibLoaded(t))return n;e.forEach(e=>{let t=`id`in e,r=t?e.id:e.name,i=t?e.refreshCount:e.prerollNum,a=this._getBidsInCache(r,i);n.set(r,a)})}catch(e){return M.error(Dw,t,e),n}return n}filterExcludedSlots(e,t){let n=this._config.trafficShaping;return e.filter(e=>{var r;let i=n.active&&this._amazonTrafficShapingExperiment.result&&((r=n.getTrafficShapingRule(e.location,e.refreshCount))==null?void 0:r.tam);return e.googleTagSlot!==void 0&&!t.has(e.location)&&e.location!==F.Native_Recipe&&!i})}getAmazonSlots(e){let{id:t}=this._config.site,{networkCode:n,prefix:r}=this._config.gam;return e.map(e=>{let i=e.element.id,a=this._getAmazonFloors(i,e.hvp);return{slotID:i,slotName:`/${n}/${r}_${e.name}/${t}`,sizes:e.sizes,...e.location===F.Video_StickyOutstream&&{mediaType:`video`},...a&&a.value>0&&a.currency&&{floor:{value:Math.ceil(a.value*100),currency:a.currency}}}})}_getAmazonRaptiveFloorKeys(e){let t=e.join(`-`),n=this._amazonRaptiveFloorKeys.get(t)||[];if(!n.length){let r=e.map(e=>[e,`*`]);n=KW(r,`-`),this._amazonRaptiveFloorKeys.set(t,n)}return n}_getAmazonFloors(e,t){let n=this._config,r=this._floors,i=e.toLowerCase(),a=r.get(i),o=n.floors.floorsExperiment;if(!a&&(o.raptive||o.fbrap)){let e=this._getAmazonRaptiveFloorKeys([i,`${t||0}`]);for(let t of e){let e=r.get(t);if(e)return e}}return a}_mapGptSlotsFromManagedSlots(e,t=this._gptSlot){e.forEach(e=>t.set(e.element.id,e.googleTagSlot))}get amazonHoldDisplayExperimentResult(){return this._amazonHoldDisplayExperiment.result}_requestBidsFromAmazon(e,t,n){return new Promise(r=>{let i=()=>{e.forEach(e=>{this._resetAmazonSlotCpm(e)})},a=t+(e[0].refreshCount?0:this._config.amazon.failsafeTimeout),o=setTimeout(()=>void this._failsafe(i,r),a),s=()=>{r(),clearTimeout(o)},c=()=>{Zh.pushToQueue(async()=>{try{await this._amazonMethods.setDisplayBids()}catch(e){M.error(Dw,`_requestBidsFromAmazon`,e)}i(),s()})},l={slots:this.getAmazonSlots(e),timeout:t,params:{adRefresh:n?`1`:`0`}};this._makeAmazonRequest(l,c),this.amazonHoldDisplayExperimentResult||s()})}async _failsafe(e,t){await this._amazonMethods.setDisplayBids(),e(),t()}async _makeAmazonRequest(e,t){await this._amazonMethods.fetchBids(e,t)}_resetAmazonBidMapCpm(e){let t=`id`in e?e.id:e.name,n=this._unitBidMapping.get(t);n&&this._unitBidMapping.delete(t)}_resetAmazonSlotCpm(e){let t=`id`in e?e.id:e.name,n=this.amazonSlotCpm.get(t);n&&this.amazonSlotCpm.delete(t)}_setDecryptedBidsBasedOnSlotTargetingForSlots(e){e.forEach(e=>this._setDecryptedBidsBasedOnSlotTargeting(e))}_removeAmazonEncryptedSlotTargetingForSlots(e){e.forEach(e=>this._removeAmazonEncryptedSlotTargeting(e))}_removeAmazonEncryptedSlotTargeting(e){let t=e.googleTagSlot.getTargetingKeys()||[];this._amazonEncryptedTargetingKeysToRemove.forEach(n=>{t.includes(n)&&e.googleTagSlot.clearTargeting(n)})}_setDecryptedBidsBasedOnSlotTargeting(e,t=this._gptSlot){this._decryptAmazonDisplayBidAndSetTargeting(this._getReconstructedAmazonBidBasedOnSlotTargeting(e),t,e)}_getReconstructedAmazonBidBasedOnSlotTargeting(e){var t;let n={};return this._config.amazon.getEncryptedTargetingKeys().forEach(t=>{var r;let i=(r=e.googleTagSlot)==null?void 0:r.getTargeting(t);i!=null&&i.length&&(n[t]=i[0])}),{slotID:e.element.id,size:(t=n.amznsz)==null?``:t,targeting:n}}_decryptAmazonDisplayBidAndSetTargeting(e,t=this._gptSlot,n){let r=t.get(e.slotID),i=this._decryptAmazonBid(e),{bidder:a,cpm:o,mediaType:s,pmpCpm:c,pmpBidder:l,pmpMediaType:u}=i,d=!!a&&this._partnerEnabled(a),f=!!l&&this._partnerEnabled(l),p={standard:{originalCpm:0,discount:0},pmp:{originalCpm:0,discount:0}};if(!r)return;let m=this._bidCPMAdjuster;if(o&&a&&d){let t=m.adjustAmazonBidPrice(i,a,o,s),n=m.bucketBidPrice(t),c=o-t;p.standard.originalCpm=o,p.standard.discount=c,this._setDisplayTargeting(e,a,n,r,s,this._decrypted_cpm_key,this._decrypted_bidder_key)}else this._clearAmazonKeys([n],this._config.amazon.getEncryptedTargetingKeys({nonDealKeys:!0}));if(c&&l&&f){let t=m.adjustAmazonBidPrice(i,l,c,u),n=m.bucketBidPrice(t),a=c-t;p.pmp.originalCpm=c,p.pmp.discount=a,this._setDisplayTargeting(e,l,n,r,u,this._decrypted_deal_cpm_key,this._decrypted_deal_bidder_key)}else this._clearAmazonKeys([n],this._config.amazon.getEncryptedTargetingKeys({dealKeys:!0}));(d||f)&&(this._config.amazon.availableBids.set(e.slotID,i),this._setAmazonSlotCpm(n,p.standard.originalCpm,p.pmp.originalCpm),this._setAmazonDiscountTargeting(p,n))}_partnerEnabled(e){return this._config.partners.getBidderConfig(e,!1).enabled}_setAmazonSlotCpm(e,t,n){let r=t>n?t:n;if(`id`in e){let i=e.id;this.amazonSlotCpm.set(i,r),this._unitBidMapping.set(i,r),this._slotEventBus.amazonBidResponseReceived.emit([{slotId:e.id,cpm:t,location:e.location,lazy:e.lazy},{slotId:e.id,cpm:n,location:e.location,lazy:e.lazy}])}else{let i=e.name;this.amazonSlotCpm.set(i,r),this._unitBidMapping.set(i,r),this._videoEventBus.amazonVideoBidResponseReceived.emit([{video:e,cpm:t},{video:e,cpm:n}])}}_setAmazonDiscountTargeting(e,t){let{standard:n,pmp:r}=e,i=(e,n)=>{t.setSlotTargetingFlag(e,[n.toFixed(6).toString()],!0)};n.originalCpm&&i(`aop`,n.originalCpm),n.discount&&i(`apd`,n.discount),r.originalCpm&&i(`aopp`,r.originalCpm),r.discount&&i(`appd`,r.discount)}_setDisplayTargeting(e,t,n,r,i,a,o){r.setTargeting(a,n),r.setTargeting(o,t)}refreshBids(e){return this._clearAmazonKeys(e),this.requestBids(e,this._config.timeouts.refreshBidsRequest-200,!0)}_clearAmazonKeys(e,t){let n=t||this._config.amazon.amznTargetingKeys;e.forEach(e=>{if(e.googleTagSlot){let t=e.googleTagSlot.getTargetingKeys()||[];n.forEach(n=>t.includes(n)&&e.googleTagSlot.clearTargeting(n))}})}async requestVideoBids(e,t=this._config.timeouts.initialBidsRequest-200){if(!await this.checkLibLoaded(`requestBids`))return;let n=this._amazonMethods;return e.forEach(e=>{this._resetAmazonSlotCpm(e)}),Promise.all(e.map(e=>{let r=this._getAmazonFloors(e.name,0)||{value:0,currency:`USD`},i=r&&r.value||0,a=Math.ceil((Number(i)+this._config.video.minFloor)*100),o={slotID:this.videoSlotNames.get(e.amzName),mediaType:`video`,floor:{value:a,currency:r.currency||`USD`}};return new Promise(r=>{let i=t+(e.prerollNum?0:this._config.amazon.failsafeTimeout),a=setTimeout(()=>{r()},i),s=e=>{e?r(e):r(),clearTimeout(a)};this.checkLibLoaded(`requestVideoBids`).then(r=>{if(!r)return s();o?n.fetchBids({slots:[o],timeout:t},t=>{t.length?(e.setAmznBids(t),t.forEach(t=>{let{cpm:n,amznBid:r,discounts:i}=this._setDecryptedAmazonVideoKVs(t);n-i.standard.discount>0?this._setAmazonInstreamCPM(e,n,i,r,s):s()})):s()}):s()}).catch(e=>{M.error(Dw,`requestVideoBids`,e)})})})).then(()=>Promise.resolve()).catch()}get videoEnabled(){return this._config.partners.video.get(`AmazonUAM`)}get enabled(){return this._amazonMethods.isAmazonLoaded()&&this._config.amazon.enabled}get amazonSlotCpm(){return this._config.floors.amazonSlotCpm}_decryptAmazonBid(e){var t,n,r,i,a,o,s,c,l;let u={...e,...e.targeting},d=(t=u[Tn.amznbid])==null?``:t,f=sg(d),p=(n=u[Tn.amznp])==null?``:n,m=(r=ig.get(p))==null?``:r,h=(i=u.amznbid_sp)==null?``:i,g=`slotID`in u?u.slotID:``,_=this._getMediaType(h,g),v=sg(h),y=(a=u[`${Tn.amznp}_sp`])==null?``:a,b=(o=ig.get(y))==null?``:o,ee=(s=u[`${Tn.amzniid}_sp`])==null?``:s,te=u[`${Tn.amznsz}_sp`],ne=(c=u.amznbid_sp)==null?``:c,re=(l=u.amzndeal_sp)==null?``:l,ie=this._getMediaType(d,g),ae=u[Tn.amznsz];return{...u,amznbid:d,amzniid:u.amzniid,bidder:m,cpm:f,mediaType:ie,slotID:g,...h.length&&{pmpAmznBid:ne,pmpAmazoniid:ee,pmpBidder:b,pmpCpm:v,pmpDeal:re,pmpMediaType:_,mediaType_sp:_,pmpSize:te},size:ae}}_getMediaType(e,t){let n=t.toLowerCase();return this._isStickyOustreamBid(e,n)?`stickyOutstream`:this._isInstreamOrAccompanyingContentBid(e,n)?`instream`:`default`}_isStickyOustreamBid(e,t){return e.startsWith(`o_`)&&t.indexOf(`stickyoutstream`)>-1}_isInstreamOrAccompanyingContentBid(e,t){return e.startsWith(`v_`)||e.startsWith(`o_`)&&(t.startsWith(`sticky_playlist`)||t.startsWith(`sticky_related`))}async checkLibLoaded(e){try{return await this._bootstrapConfig.bootstrapLoaders[Rn.Amazon],!0}catch(e){return!1}}async _setAmazonInstreamCPM(e,t,n,r,i){this._setAmazonSlotCpm(e,n.standard.originalCpm,n.pmp.originalCpm),await this._videoEventBus.addAPStagSlotBidResponse.legacyEmit({playlistId:e._playlistId,bid:r,discounts:n}),i(t)}_initVideoSlotMap(){return Ei()?new Map([[vW.Video_Collapse_Autoplay_SoundOff,`Sticky_Playlist_Desktop`],[vW.Video_Individual_Autoplay_SOff,`Sticky_Related_Desktop`],[vW.Video_In_Post_ClicktoPlay_SoundOn,`CTP_Desktop`],[vW.Video_Collapse_Autoplay_SoundOff_15s,`Sticky_Playlist_Desktop_15s`],[vW.Video_Individual_Autoplay_SOff_15s,`Sticky_Related_Desktop_15s`],[vW.Video_In_Post_ClicktoPlay_SoundOn_15s,`CTP_Desktop_15s`]]):new Map([[vW.Video_Coll_SOff_Smartphone,`Sticky_Playlist_Mobile`],[vW.Video_Individual_Autoplay_SOff,`Sticky_Related_Mobile`],[vW.Video_In_Post_ClicktoPlay_SoundOn,`CTP_Mobile`],[vW.Video_Coll_SOff_Smartphone_15s,`Sticky_Playlist_Mobile_15s`],[vW.Video_Individual_Autoplay_SOff_15s,`Sticky_Related_Mobile_15s`],[vW.Video_In_Post_ClicktoPlay_SoundOn_15s,`CTP_Mobile_15s`]])}_getAdUnitFromSlotName(e){for(let[t,n]of this.videoSlotNames.entries())if(n===e)return t}_setDecryptedAmazonVideoKVs(e){let t={standard:{originalCpm:0,discount:0},pmp:{originalCpm:0,discount:0}},n=this._decryptAmazonBid(e),r=this._bidCPMAdjuster,{bidder:i,cpm:a,mediaType:o,pmpCpm:s,pmpBidder:c,pmpMediaType:l}=n;if(i&&a){let e=r.adjustAmazonBidPrice(n,i,a,o),s=r.bucketBidPrice(e),c=a-e;t.standard.originalCpm=a,t.standard.discount=c,n[this._decrypted_cpm_key]=`${s}`,n[this._decrypted_bidder_key]=i}if(s&&c){let e=r.adjustAmazonBidPrice(n,c,s,l),i=r.bucketBidPrice(e),a=s-e;t.pmp.originalCpm=s,t.pmp.discount=a,n.targeting?(n.targeting[this._decrypted_deal_cpm_key]=`${i}`,n.targeting[this._decrypted_deal_bidder_key]=`${c}`):(n[this._decrypted_deal_cpm_key]=`${i}`,n[this._decrypted_deal_bidder_key]=`${c}`)}let u=this._getAdUnitFromSlotName(e.slotID);return u&&this._config.amazon.availableBids.set(u,n),{amznBid:n,cpm:a,discounts:t}}},Ow=D([Q(Dw),S(),A(`design:paramtypes`,[typeof(pw=z!==void 0&&z)==`function`?pw:Object,typeof(mw=Ji!==void 0&&Ji)==`function`?mw:Object,typeof(hw=cg!==void 0&&cg)==`function`?hw:Object,typeof(gw=eU!==void 0&&eU)==`function`?gw:Object,typeof(_w=Ki!==void 0&&Ki)==`function`?_w:Object,typeof(vw=Bg!==void 0&&Bg)==`function`?vw:Object,typeof(yw=$C!==void 0&&$C)==`function`?yw:Object,typeof(bw=ow!==void 0&&ow)==`function`?bw:Object,typeof(xw=oo!==void 0&&oo)==`function`?xw:Object,typeof(Sw=Vr!==void 0&&Vr)==`function`?Sw:Object,typeof(Cw=yr!==void 0&&yr)==`function`?Cw:Object,typeof(ww=pr!==void 0&&pr)==`function`?ww:Object,typeof(Tw=lw!==void 0&&lw)==`function`?Tw:Object,typeof(Ew=dw!==void 0&&dw)==`function`?Ew:Object])],Ow)})),gse=o((()=>{hse()})),kw,Aw,jw,Mw,Nw,Pw,Fw,Iw,Lw,Rw,zw,Bw,Vw,Hw,Uw,Ww,Gw,Kw,qw,Jw,Yw=o((()=>{w(),$(),Ra(),_S(),j(),E(),O(),Jw=class{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v){this._context=e,this._connectIdModule=t,this._unifiedIdModule=n,this._id5IdModule=r,this._merkuryIdModule=i,this._identityLinkIdModule=a,this._lotamePanoramaIdModule=o,this._thirtyThreeAcrossIdModule=s,this._fTrackIdModule=c,this._loblawIdModule=l,this._fabrickIdModule=u,this._criteoIdModule=d,this._liveIntentIdModule=f,this._pairIdModule=p,this._unifiedId2IdModule=m,this._sharedIdModule=h,this._linkedInAdsIdModule=g,this._teadsIdModule=_,this._intentIqIdModule=v,T(this,`ids`,void 0),T(this,`_connectIdConfig`,[`connectId`,{id:this._connectIdModule._config,targetingKey:this._connectIdModule.targetingKey,enabled:this._connectIdModule.enabled,eidSource:this._connectIdModule.eidSource,storageKey:this._connectIdModule.storageKey}]),T(this,`_unifiedIdConfig`,[`unifiedId`,{id:this._unifiedIdModule._config,targetingKey:this._unifiedIdModule.targetingKey,enabled:this._unifiedIdModule.enabled,eidSource:this._unifiedIdModule.eidSource,eidSourceAlias:this._unifiedIdModule.eidSourceAlias,storageParser:e=>JSON.parse(decodeURIComponent(e)).TDID}]),T(this,`_unifiedId2Config`,[`uid2`,{id:this._unifiedId2IdModule._config,enabled:this._unifiedId2IdModule.enabled,eidSource:this._unifiedId2IdModule.eidSource,targetingKey:this._unifiedId2IdModule.targetingKey,storageKey:this._unifiedId2IdModule.storageKey}]),T(this,`_id5IdConfig`,[`id5Id`,{id:this._id5IdModule._config,enabled:this._id5IdModule.enabled,targetingKey:this._id5IdModule.targetingKey,eidSource:this._id5IdModule.eidSource,storageParser:e=>JSON.parse(decodeURIComponent(e)).gp}]),T(this,`_merkuryIdConfig`,[`merkuryId`,{id:this._merkuryIdModule._config,enabled:this._merkuryIdModule.enabled,eidSource:this._merkuryIdModule.eidSource,targetingKey:this._merkuryIdModule.targetingKey}]),T(this,`_identityLinkConfig`,[`identityLink`,{id:this._identityLinkIdModule._config,enabled:this._identityLinkIdModule.enabled,eidSource:this._identityLinkIdModule.eidSource,targetingKey:this._identityLinkIdModule.targetingKey}]),T(this,`_pairIdConfig`,[`pairId`,{id:this._pairIdModule._config,enabled:this._pairIdModule.enabled,eidSource:this._pairIdModule.eidSource,targetingKey:this._pairIdModule.targetingKey}]),T(this,`_criteoIdConfig`,[`criteo`,{id:this._criteoIdModule._config,enabled:this._criteoIdModule.enabled,eidSource:this._criteoIdModule.eidSource,targetingKey:this._criteoIdModule.targetingKey}]),T(this,`_sharedIdConfig`,[`sharedId`,{id:this._sharedIdModule._config,enabled:this._sharedIdModule.enabled,eidSource:this._sharedIdModule.eidSource,targetingKey:this._sharedIdModule.targetingKey}]),T(this,`_fabrickIdConfig`,[`fabrickId`,{id:this._fabrickIdModule._config,enabled:this._fabrickIdModule.enabled,eidSource:this._fabrickIdModule.eidSource,targetingKey:this._fabrickIdModule.targetingKey}]),T(this,`_fTrackIdConfig`,[`ftrack`,{id:this._fTrackIdModule._config,enabled:this._fTrackIdModule.enabled,eidSource:this._fTrackIdModule.eidSource,targetingKey:this._fTrackIdModule.targetingKey}]),T(this,`_33AcrossIdConfig`,[`33acrossId`,{id:this._thirtyThreeAcrossIdModule._config,enabled:this._thirtyThreeAcrossIdModule.enabled,eidSource:this._thirtyThreeAcrossIdModule.eidSource,targetingKey:this._thirtyThreeAcrossIdModule.targetingKey}]),T(this,`_liveIntentIdConfig`,[`liveIntentId`,{id:this._liveIntentIdModule._config,enabled:this._liveIntentIdModule.enabled,targetingKey:this._liveIntentIdModule.targetingKey,eidSource:this._liveIntentIdModule.eidSource,storageParser:e=>JSON.parse(decodeURIComponent(e))}]),T(this,`_lotamePanoramaIdConfig`,[`lotamePanoramaId`,{id:this._lotamePanoramaIdModule._config,enabled:this._lotamePanoramaIdModule.enabled,targetingKey:this._lotamePanoramaIdModule.targetingKey,eidSource:this._lotamePanoramaIdModule.eidSource,storageKey:this._lotamePanoramaIdModule.storageKey}]),T(this,`_lmpIdConfig`,[`lmpId`,{id:this._loblawIdModule._config,enabled:this._loblawIdModule.enabled,targetingKey:this._loblawIdModule.targetingKey,eidSource:this._loblawIdModule.eidSource,storageKey:this._loblawIdModule.storageKey}]),T(this,`_linkedInAdsIdConfig`,[`linkedInAdsId`,{id:this._linkedInAdsIdModule._config,enabled:this._linkedInAdsIdModule.enabled,targetingKey:this._linkedInAdsIdModule.targetingKey,eidSource:this._linkedInAdsIdModule.eidSource}]),T(this,`_teadsIdConfig`,[`teadsId`,{id:this._teadsIdModule._config,enabled:this._teadsIdModule.enabled,targetingKey:this._teadsIdModule.targetingKey,eidSource:this._teadsIdModule.eidSource}]),T(this,`_intentIqIdConfig`,[`intentIqId`,{id:this._intentIqIdModule._config,enabled:this._intentIqIdModule.enabled,targetingKey:this._intentIqIdModule.targetingKey}]),this.ids=new Map([this._sharedIdConfig,this._connectIdConfig,this._unifiedIdConfig,this._unifiedId2Config,this._id5IdConfig,this._identityLinkConfig,this._merkuryIdConfig,this._pairIdConfig,this._criteoIdConfig,this._fabrickIdConfig,this._fTrackIdConfig,this._33AcrossIdConfig,this._liveIntentIdConfig,this._lotamePanoramaIdConfig,this._lmpIdConfig,this._linkedInAdsIdConfig,this._teadsIdConfig,this._intentIqIdConfig]),this._removeIdsOnWordpressPage()}_removeIdsOnWordpressPage(){if(this._context.isWordPressLogin)for(let[e]of this.ids){let t=this.ids.get(e);t&&(t.enabled=!1)}}get(e){return e===`FTrack`?this.ids.get(`ftrack`):e===`merkleId`?this.ids.get(`merkuryId`):this.ids.get(e)}forEach(e){return this.ids.forEach(e)}values(){return this.ids.values()}},Jw=D([Q(`UserIds`),C(),A(`design:paramtypes`,[typeof(kw=L!==void 0&&L)==`function`?kw:Object,typeof(Aw=fb!==void 0&&fb)==`function`?Aw:Object,typeof(jw=gb!==void 0&&gb)==`function`?jw:Object,typeof(Mw=Db!==void 0&&Db)==`function`?Mw:Object,typeof(Nw=Mb!==void 0&&Mb)==`function`?Nw:Object,typeof(Pw=Lb!==void 0&&Lb)==`function`?Pw:Object,typeof(Fw=Vb!==void 0&&Vb)==`function`?Fw:Object,typeof(Iw=sx!==void 0&&sx)==`function`?Iw:Object,typeof(Lw=Kb!==void 0&&Kb)==`function`?Lw:Object,typeof(Rw=Zb!==void 0&&Zb)==`function`?Rw:Object,typeof(zw=px!==void 0&&px)==`function`?zw:Object,typeof(Bw=_x!==void 0&&_x)==`function`?Bw:Object,typeof(Vw=Gx!==void 0&&Gx)==`function`?Vw:Object,typeof(Hw=Sx!==void 0&&Sx)==`function`?Hw:Object,typeof(Uw=tS!==void 0&&tS)==`function`?Uw:Object,typeof(Ww=aS!==void 0&&aS)==`function`?Ww:Object,typeof(Gw=lS!==void 0&&lS)==`function`?Gw:Object,typeof(Kw=tx!==void 0&&tx)==`function`?Kw:Object,typeof(qw=gS!==void 0&&gS)==`function`?qw:Object])],Jw)})),Xw,Zw=o((()=>{Xw=class{get enabled(){return!0}}})),Qw,_se=o((()=>{w(),$(),Ui(),E(),j(),O(),Qw=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1),T(this,`source`,``)}init(){this._key=`IdGraphLiveRamp`,this._lookup=`IDGLR`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],Qw.prototype,`run`,null),Qw=D([C()],Qw)})),$w,eT,tT,nT=o((()=>{w(),$(),B(),Zw(),_se(),Rm(),j(),E(),O(),tT=class extends Xw{constructor(e,t){var n;super(),this._config=e,this._idGraphLiveRampExperiment=t,T(this,`_envelopeKey`,`_lr_env`),T(this,`_isEnvelopeModuleReady`,!1),T(this,`_enabled`,!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut&&((n=this._config.liveRampAts)==null?void 0:n.enabled)&&`localStorage`in window),window.addEventListener(`envelopeModuleReady`,()=>{this._isEnvelopeModuleReady=!0})}get enabled(){return this._enabled}_runLiveRamp(e){if(e.collectionMethod===`graph3p`&&!this._idGraphLiveRampExperiment.result||e.collectionMethod===`liveIntent`)return;let t,n=``;if(this._config.gdpr.enabled){var r;t=`gdpr`,n=(r=this._config.gdpr.consentCapturedData.consentString)==null?``:r}else if(this._config.ccpa.required){var i;t=`ccpa`,n=(i=this._config.ccpa.privacyString)==null?this._config.ccpa.ccpaOptIn:i}try{let r=[e.sha256Hash,e.sha1Hash].filter(e=>e&&e.length);r&&r.length&&window.atsenvelopemodule.setAdditionalData({consentString:n,...t===void 0?{}:{consentType:t},id:r,type:e.sha256Hash||e.sha1Hash?`emailHashes`:`email`})}catch(e){M.error(`LiveRampPiiPartner`,`processPii`,`Error setting ATS additional data`,e)}}processPii(e){this._isEnvelopeModuleReady?this._runLiveRamp(e):window.addEventListener(`envelopeModuleReady`,()=>{this._runLiveRamp(e)})}get _shouldSetTargeting(){return this._enabled&&(!!U.readExternalLocalStorage(this._envelopeKey)||!!U.readExternalCookie(this._envelopeKey))}},tT=D([Q(`LiveRampPiiPartner`),S(),A(`design:paramtypes`,[typeof($w=z!==void 0&&z)==`function`?$w:Object,typeof(eT=Qw!==void 0&&Qw)==`function`?eT:Object])],tT)})),rT,iT,aT=o((()=>{jc(),w(),j(),E(),O(),iT=class{constructor(e){this._prebidMethods=e,T(this,`pubmaticBidderLevelEidSource`,void 0)}get isPubmaticEidSetByLiveIntent(){var e;return(e=this._prebidMethods.getUserIdsAsEids().some(e=>e.source===`pubmatic.com`&&e.uids.some(e=>{var t;return((t=e.ext)==null?void 0:t.provider)===`liveintent.com`})))==null?!1:e}},iT=D([C(),A(`design:paramtypes`,[typeof(rT=R!==void 0&&R)==`function`?rT:Object])],iT)})),oT=o((()=>{aT()})),sT,cT,lT,uT,dT,fT,pT,mT,hT,gT=o((()=>{sT=e=>e.uids.some(e=>{var t;let n=(t=e.ext)==null?void 0:t.provider;return n===`liveintent.com`||n===window.location.hostname}),cT=e=>e.matcher===`intentiq.com`,lT=e=>e.matcher===`id5-sync.com`||e.matcher===`id5.com`,uT=e=>e.matcher===`raptive.com`&&e.inserter===`cafemedia.com`,dT=e=>{var t,n;let r=e.source===`adserver.org`||e.source===`adsrvr.org`,i=(t=e.uids[0].ext)==null?void 0:t.rtiPartner,a=(n=e.uids[0].ext)==null?void 0:n.provider;return r&&i===`TDID`&&!a},fT=e=>e.source===`adserver.org`||e.source===`adsrvr.org`,pT=e=>e.source.includes(`openx.com`),mT=e=>e.source.includes(`indexexchange.com`),hT=e=>e.source.includes(`triplelift.com`)})),_T,vse=o((()=>{w(),gT(),O(),_T=class{_getRules(){return[{enabled:!0,excludedSources:[`adserver.org`,`adsrvr.org`],fn:(e,t)=>{let n=sT(t),r=sT(e),i=lT(t),a=lT(e),o=cT(t),s=cT(e);return o===s?n&&a?`b`:r&&i?`a`:`both`:`both`}},{enabled:!0,includedSources:[`adserver.org`,`adsrvr.org`],fn:(e,t)=>{if(e.source===t.source){let n=cT(t),r=cT(e);if(n!==r)return`both`;let i=lT(t),a=lT(e);if(i!==a)return i?`b`:`a`;let o=sT(t),s=sT(e);if(o!==s)return o?`b`:`a`;let c=uT(t),l=uT(e);if(c!==l)return c?`b`:`a`;let u=dT(t),d=dT(e);if(u!==d)return u?`b`:`a`}return`both`}}]}processEids(e){let t={},n=[],r=this._getRules();for(let i of e){let e=i.source;if(!t[e]){t[e]=[i];continue}let a=t[e],o=!1,s=[];for(let[e,t]of a.entries()){let n=this._decidePreferredEid(t,i,r);if(n.excluded.includes(i)){o=!0;break}n.excluded.includes(t)&&s.push(e)}if(o){if(n.push(i),s.length>0){s.sort((e,t)=>t-e);for(let e of s){let[t]=a.splice(e,1);n.push(t)}}}else{if(s.length>0){s.sort((e,t)=>t-e);for(let e of s){let[t]=a.splice(e,1);n.push(t)}}a.push(i)}}let i=Object.values(t).flat();return{included:i,excluded:n}}_decidePreferredEid(e,t,n){for(let r of n){if(!r.enabled||r.includedSources&&(!r.includedSources.includes(e.source)||!r.includedSources.includes(t.source))||r.excludedSources&&(r.excludedSources.includes(e.source)||r.excludedSources.includes(t.source)))continue;let n=r.fn(e,t);if(n===`a`)return{included:[e],excluded:[t]};if(n===`b`)return{included:[t],excluded:[e]};if(n===`none`)return{included:[],excluded:[e,t]};if(n===`both`)continue}return{included:[e,t],excluded:[]}}get rules(){return this._getRules()}},_T=D([C()],_T)})),vT,yse=o((()=>{w(),fa(),O(),vT=class extends da{init(){this._key=`UID1BidderSupression`,this._lookup=`UID1BS`,this._default=[]}get result(){var e;return(e=this._result)==null?this._default:e}},vT=D([C()],vT)})),yT,bT,xT,ST,bse=o((()=>{w(),Yw(),yse(),X(),gT(),tc(),rU(),j(),E(),O(),ST=class{constructor(e,t,n){this._userIds=e,this._uid1BidderSuppressionExperiment=t,this._prebidEventBus=n,T(this,`_bidderCodeToLiveIntentEidSourceMap`,new Map([[P.Rubicon,`rubiconproject.com`],[P.RubiconServer,`rubiconproject.com`],[P.IndexExchange,`liveintent.indexexchange.com`],[P.IndexExchangeServer,`liveintent.indexexchange.com`],[P.Pubmatic,`pubmatic.com`],[P.PubmaticServer,`pubmatic.com`],[P.OpenX,`openx.net`],[P.OpenXServer,`openx.net`],[P.Triplelift,`liveintent.triplelift.com`],[P.TripleliftServer,`liveintent.triplelift.com`]])),T(this,`_liveIntentIds`,void 0),this._liveIntentIds=ec(),this._prebidEventBus.liveIntentResolved.on(e=>{this._liveIntentIds=e},{handleEventsAlreadyEmitted:!0})}processEids(e,t){let n=e,r=[],i=this._getRules();for(let e of i){if(!e.enabled||e.bidders&&(!t||!e.bidders.includes(t)))continue;let i=e.fn(n,t);n=i.included,r=r.concat(i.excluded)}return{included:n,excluded:r}}_getRules(){return[{enabled:!0,fn:e=>{let t=e.some(e=>pT(e)&&sT(e));if(!t)return{included:e,excluded:[]};let n=e.filter(e=>fT(e)&&lT(e)),r=e.filter(e=>!n.includes(e));return{included:r,excluded:n}}},{enabled:this._isDirectUid1BidderSuppressionEnabled(),bidders:this._getDirectUid1BidderSuppressionList(),fn:(e,t)=>{if(!t)return{included:e,excluded:[]};let n=e.some(e=>this._bidderCodeToLiveIntentEidSourceMap.get(t)===e.source&&sT(e));if(!n)return{included:e,excluded:[]};let r=e.filter(e=>dT(e)),i=e.filter(e=>!r.includes(e));return{included:i,excluded:r}}},{enabled:!0,fn:e=>{let t=e.some(e=>e.source===`liveintent.indexexchange.com`&&sT(e));if(!t)return{included:e,excluded:[]};let n=e.filter(e=>mT(e)&&lT(e)),r=e.filter(e=>!n.includes(e));return{included:r,excluded:n}}},{enabled:!0,fn:e=>{let t=e.some(e=>e.source===`liveintent.triplelift.com`&&sT(e));if(!t)return{included:e,excluded:[]};let n=e.filter(e=>hT(e)&&lT(e)),r=e.filter(e=>!n.includes(e));return{included:r,excluded:n}}},{enabled:!0,fn:e=>{let t=e.map(e=>{if(e.source===`uidapi.com`){let t=this._userIds.get(`uid2`),n=t&&t.id?t.id.params:void 0,r;if(sT(e))r={matcher:`liveintent.com`,inserter:`liveintent.com`};else{let e=n!=null&&n.uid2Token&&typeof n.uid2Token==`object`&&`matcher`in n.uid2Token?n.uid2Token.matcher:void 0;e&&(r=this._getProvenanceSpecsForMatcher(e))}return{...e,...r}}return e});return{included:t,excluded:[]}}},{enabled:!0,fn:e=>{let t=e.map(e=>hT(e)&&lT(e)?{...e,matcher:`id5.com`,inserter:`raptive.com`}:e);return{included:t,excluded:[]}}}]}_getProvenanceSpecsForMatcher(e){if(e===`truedata.com`||e===`mediawallah.com`)return{matcher:e,inserter:`optable.co`,mm:5};if(e===`liveintent.com`)return{matcher:e,inserter:`liveintent.com`,mm:5};if(e===`cafemedia.com`)return{matcher:e,mm:3}}_getDirectUid1BidderSuppressionList(){var e;let t=(e=this._uid1BidderSuppressionExperiment.result)==null?[]:e;return t.length===0?[]:t.reduce((e,t)=>{let n=jn.get(t);return n&&e.push(...n),e},[])}_isDirectUid1BidderSuppressionEnabled(){var e,t,n,r;return!!((e=this._userIds.get(`liveIntentId`))!=null&&e.enabled&&(t=this._userIds.get(`unifiedId`))!=null&&t.enabled&&(n=this._liveIntentIds)!=null&&n.nonId&&!((r=this._liveIntentIds)!=null&&r.thetradedesk))}},ST=D([C(),A(`design:paramtypes`,[typeof(yT=Jw!==void 0&&Jw)==`function`?yT:Object,typeof(bT=vT!==void 0&&vT)==`function`?bT:Object,typeof(xT=Pr!==void 0&&Pr)==`function`?xT:Object])],ST)})),CT,wT,TT,ET,DT=o((()=>{w(),jc(),X(),vse(),bse(),j(),O(),ET=class{constructor(e,t,n){this._prebidMethods=e,this._eidSelector=t,this._eidProcessor=n}getSupplementalEids(e=[]){var t;let n=(t=this._prebidMethods.getConfig(`ortb2.user.ext.eids`))==null?[]:t;return n.filter(t=>t.source&&e.length>0?e.includes(t.source):!0)}getModuleEids(e=[]){var t;let n=(t=this._prebidMethods.getUserIdsAsEids())==null?[]:t;return n.filter(t=>t.source&&e.length>0?e.includes(t.source):!0)}getEids(e=[]){return{module:this.getModuleEids(e),supplemental:this.getSupplementalEids(e)}}getProcessedEids(e=[]){let t=this.getEids(e),n=[...t.module,...t.supplemental],{included:r,excluded:i}=this._eidSelector.processEids(n),{included:a,excluded:o}=this._eidProcessor.processEids(r),s=a,c=[...i,...o];return{included:s,excluded:c}}getProcessedEidsForBidder(e,t){return this._eidProcessor.processEids(e,t)}getEidSourcesToBiddersAccessMap(e){let{module:t,supplemental:n}=this.getEids(),r=[...t,...n],i=new Map,a=e||Object.values(P);for(let e of a){let{included:t}=this.getProcessedEidsForBidder(r,e);for(let n of t){var o;let t=n.source;if(!t)continue;let r=(o=i.get(t))==null?[]:o;r.includes(e)||(r.push(e),i.set(t,r))}}for(let[e,t]of i.entries())i.set(e,Array.from(new Set(t)));return i}},ET=D([C(),A(`design:paramtypes`,[typeof(CT=R!==void 0&&R)==`function`?CT:Object,typeof(wT=_T!==void 0&&_T)==`function`?wT:Object,typeof(TT=ST!==void 0&&ST)==`function`?TT:Object])],ET)})),OT,kT,xse=o((()=>{OT=new Map([[`adform.com`,`iiq_adf`],[`adman.gr`,`iiq_adm`],[`adobe.com`,`iiq_ado`],[`adyoulike.com`,`iiq_ady`],[`amobee.com`,`iiq_amb`],[`aol.com`,`iiq_aol`],[`beeswax.com`,`iiq_bee`],[`bidswitch.net`,`iiq_bdswt`],[`criteo.com`,`iiq_cri`],[`epsilon.com`,`iiq_eps`],[`smartadserver.com`,`iiq_equ`],[`freewheel.com`,`iiq_fw`],[`gumgum.com`,`iiq_gum`],[`improvedigital.com`,`iiq_imp`],[`indexexchange.com`,`iiq_ix`],[`intentiq.com`,`iiq_id`],[`iqm.com`,`iiq_iqm`],[`krux.com`,`iiq_krx`],[`loopme.com`,`iiq_loo`],[`rubiconproject.com`,`iiq_mgn`],[`mediaforce.com`,`iiq_mf`],[`media.net`,`iiq_mnet`],[`mgid.com`,`iiq_mgi`],[`nativo.com`,`iiq_nat`],[`neustar.biz`,`iiq_neu`],[`onetag.com`,`iiq_one`],[`openx.net`,`iiq_ox`],[`performmedia.com`,`iiq_per`],[`pubmatic.com`,`iiq_pub`],[`qortex.ai`,`iiq_qtx`],[`quantcast.com`,`iiq_qua`],[`richaudience.com`,`iiq_ra`],[`sharethrough.com`,`iiq_sht`],[`simplifi.com`,`iiq_sim`],[`sonobi.com`,`iiq_son`],[`sovrn.com`,`iiq_svrn`],[`synacor.com`,`iiq_syn`],[`taboola.com`,`iiq_tab`],[`adsrvr.org`,`iiq_uid1`],[`adserver.org`,`iiq_uid1e`],[`uidapi.com`,`iiq_uid2`],[`triplelift.com`,`iiq_tl`],[`verizon.com`,`iiq_ver`],[`adnxs.com`,`iiq_xan`],[`yahoo.com`,`iiq_yah`],[`yieldmo.com`,`iiq_ym`],[`zemanta.com`,`iiq_zem`],[`teads.tv`,`iiq_teads`],[`liveramp.com`,`iiq_lr`]]),kT=new Map([[`liveintent.com`,`liid`],[`uidapi.com`,`li_uid2`],[`rubiconproject.com`,`li_mgn`],[`liveintent.indexexchange.com`,`li_ix`],[`liveintent.sovrn.com`,`li_svrn`],[`media.net`,`li_mnet`],[`pubmatic.com`,`li_pub`],[`openx.net`,`li_ox`],[`bidswitch.net`,`li_bdswt`],[`adserver.org`,`li_uid1`],[`liveintent.triplelift.com`,`li_tl`],[`sharethrough.com`,`li_sht`]])})),AT,jT,MT,NT,PT,FT,IT,LT=o((()=>{$(),w(),Yw(),Ra(),nT(),Rm(),oT(),$h(),DT(),gT(),xse(),j(),O(),IT=class{constructor(e,t,n,r,i,a){this._userIds=e,this._liveRampPiiPartner=t,this._context=n,this._userSyncConfig=r,this._gam=i,this._eidManager=a}getSyncedIdModules(e){return[...e].reduce((e,t)=>{let n=this._userIds.get(t.name);return n&&this.getStoredUserIds(n)&&e.push(n.id.name),e},[])}getSyncedBrowserIdPartners(e){let t=this.getSyncedIdModules(e).map(e=>{var t;return(t=this._userIds.get(e))==null?void 0:t.targetingKey}).filter(e=>!!e);this._context.gpid&&t.push(`gpid`);let n=this.getMagniteCarbonId(),r=this.getAmazonPublisherAudienceId(),i=this._getConditionalPiiPartners(),a=this._getRaptiveConnectedId(),o=this._getDcn1Uid1();return[...t,...n,...r,...i,...a,...o]}_getRaptiveConnectedId(){let e=[];return U.readExternalCookie(`_rcid`)&&e.push(`rcid`),e}_getDcn1Uid1(){let e=U.readInternalLocalStorage(`adt_uid1`);return e?[`r_uid1`]:[]}_getConditionalPiiPartners(){let e=[];return this._liveRampPiiPartner._shouldSetTargeting&&e.push(`ats`),e}setUid1TargetingFlag(e){let t=e.find(e=>e.source===`adserver.org`&&dT(e)),n=e.find(e=>e.source===`adsrvr.org`&&dT(e));t&&n?this._gam.setTargetingFlag(`uid1e`,[`2`],!0):t?this._gam.setTargetingFlag(`uid1e`,[`1`],!0):n&&this._gam.setTargetingFlag(`uid1e`,[`0`],!0)}getSyncedAuctionEidPartners(e){let t=[],{included:n,excluded:r}=this._eidManager.getProcessedEids();if(n){this.setUid1TargetingFlag(n);let r=n.filter(e=>e.matcher!==`id5-sync.com`);t=e.reduce((e,t)=>{let n=r.find(e=>e.source===(t==null?void 0:t.eidSource)||t.eidSourceAlias&&e.source===(t==null?void 0:t.eidSourceAlias));if(n){let r=n.source===`adserver.org`||n.source===`uidapi.com`;if(r&&n.uids.length>0){var i;let t=(i=n.uids[0].ext)==null?void 0:i.provider,r=n.source===`adserver.org`,a=n.source===`uidapi.com`;if(a&&t){if(t===`liveintent.com`)return e}else if(r&&(t===`liveintent.com`||t===window.location.hostname))return e}e.push(t.targetingKey)}return e},[])}let[i,a]=this._getLiveIntentEidPartners(n,r),[o,s]=this._getIntentIqEidPartners(n,r),c=this._getBidderLevelEidPartners(),[l,u]=this._getId5EidPartners(n,r),[d,f]=this._getUid1EidPartners(n,r),p=[...t,...i,...o,...c,...l,...d],m=[...u,...a,...s,...f];return[p,m]}_getLiveIntentEidPartners(e,t){let n=[],r=[];for(let[i,a]of kT){let o=e.find(e=>e.source===i&&sT(e)),s=t.find(e=>e.source===i&&sT(e));o?n.push(a):s&&r.push(a)}return[n,r]}_getIntentIqEidPartners(e,t){let n=[],r=[];for(let[i,a]of OT){let o=e.find(e=>e.source===i&&cT(e)),s=t.find(e=>e.source===i&&cT(e));o?n.push(a):s&&r.push(a)}return[n,r]}_getBidderLevelEidPartners(){let e=[];return this._userSyncConfig.pubmaticBidderLevelEidSource===`mediawallah-dcn`&&e.push(`mw_pub`),e}_getId5EidPartners(e,t){let n=[],r=[],i=new Map([[`adserver.org`,`id5_uid1`],[`adsrvr.org`,`id5_uid1`],[`adnxs.com`,`id5_appn`],[`bidswitch.net`,`id5_bdswt`],[`indexexchange.com`,`id5_ix`],[`kargo.com`,`id5_krg`],[`pubmatic.com`,`id5_pub`],[`rubiconproject.com`,`id5_mgn`],[`triplelift.com`,`id5_tl`],[`yieldmo.com`,`id5_ym`]]);for(let[a,o]of i){let i=e.find(e=>e.source===a&&lT(e)),s=t.find(e=>e.source===a&&lT(e));i?n.push(o):s&&r.push(o)}return[n,r]}_getUid1EidPartners(e,t){let n=[],r=[],i=new Map([[`adserver.org`,`r_uid1`]]);for(let[a,o]of i){let i=e.find(e=>e.source===a&&uT(e)),s=t.find(e=>e.source===a&&uT(e));i?n.push(o):s&&r.push(o)}return[n,r]}getAmazonPublisherAudienceId(){let e=U.readExternalCookie(`AMZN-Token`);return e?[`amzn`]:[]}getMagniteCarbonId(){let e=U.readExternalLocalStorage(`carbon_ccuid`),t=U.readExternalCookie(`ccuid`),n=U.readExternalCookie(`ccsid`);return e||t||n?[`mgncrbn`]:[]}getStoredUserIds(e){let{id:{storage:t},storageKey:n}=e,r;return t&&t.type===`cookie`&&window.navigator.cookieEnabled?r=U.readExternalCookie(t.name):t&&t.type===`html5`?r=U.readExternalLocalStorage(t.name):n&&(r=U.readExternalLocalStorage(n)),r}getParsedUserIdStoredValue(e){let t=this.getStoredUserIds(e);if(t){if(!e.storageParser)return t;try{return e.storageParser(t)}catch(e){return t}}}getLiveRampAtsEnvelopeSourceId(){var e;let t=`_lr_env_src_ats`;return(e=U.readExternalLocalStorage(t)||U.readExternalCookie(t))==null?``:e}},IT=D([Q(`UserIdTargeting`),S(),A(`design:paramtypes`,[typeof(AT=Jw!==void 0&&Jw)==`function`?AT:Object,typeof(jT=tT!==void 0&&tT)==`function`?jT:Object,typeof(MT=L!==void 0&&L)==`function`?MT:Object,typeof(NT=iT!==void 0&&iT)==`function`?NT:Object,typeof(PT=Zh!==void 0&&Zh)==`function`?PT:Object,typeof(FT=ET!==void 0&&ET)==`function`?FT:Object])],IT)})),RT,zT,BT,VT,HT,UT,WT,GT,KT,qT,JT,YT,XT,ZT,QT,Sse=o((()=>{w(),jc(),$(),H(),LT(),$h(),ya(),Da(),Yw(),rU(),Cs(),ks(),Ra(),DT(),j(),E(),O(),XT=e=>e.split(``).map(e=>e.charCodeAt(0).toString(2)).join(` `),ZT=e=>parseInt(e.charAt(e.length-1))%2==0,QT=class extends V{constructor(e,t,n,r,i,a,o,s,c,l,u,d){super(),this._gpcConfig=e,this._ccpaConfig=t,this._prebidMethods=n,this._userIdTargeting=r,this._userIds=i,this._gam=a,this._slotEventBus=o,this._userIdEventBus=s,this._prebidEventBus=c,this._user=l,this._context=u,this._eidManager=d,T(this,`_enabledUserIds`,[]),T(this,`_enabledUserIdConfigs`,[]),T(this,`_ppid`,null),this.enabled&&(this._enabledUserIds=[...i.values()].filter(e=>e.enabled).map(e=>{if(e.id.name===`uid2`){var t;let n=(t=e.id.params)==null?void 0:t.uid2Token;(n==null?void 0:n.provider)===`optable`&&(e.targetingKey=`opt_uid2`)}return e.id}),this._enabledUserIdConfigs=[...i.values()].filter(e=>e.enabled).map(e=>{if(e.id.name===`uid2`){var t;let n=(t=e.id.params)==null?void 0:t.uid2Token;(n==null?void 0:n.provider)===`optable`&&(e.targetingKey=`opt_uid2`)}return e}),this._slotEventBus.requestingBids.once(this._setPPID.bind(this)),this._slotEventBus.refreshingBids.once(this._addPPIDToBidStream.bind(this)),this._userIdEventBus.uid2Refreshed.on(()=>{this._refreshUid2TargetingKey()}),this._context.gpid||this._prebidMethods.getUserIdsAsync().then(()=>{let e=this._eidManager.getModuleEids([`gpid.id5-sync.com`]);e&&e.length>0&&e[0].uids.length>0&&e[0].uids[0].id&&(this._context.gpid=e[0].uids[0].id)}))}_refreshUid2TargetingKey(){this._enabledUserIds=[...this._userIds.values()].filter(e=>e.enabled).map(e=>{if(e.id.name===`uid2`){var t;let n=(t=e.id.params)==null?void 0:t.uid2Token;(n==null?void 0:n.provider)===`optable`&&(e.targetingKey=`opt_uid2`)}return e.id}),this._enabledUserIdConfigs=[...this._userIds.values()].filter(e=>e.enabled).map(e=>{if(e.id.name===`uid2`){var t;let n=(t=e.id.params)==null?void 0:t.uid2Token;(n==null?void 0:n.provider)===`optable`&&(e.targetingKey=`opt_uid2`)}return e})}get enabled(){return!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut}getTargetingData(){if(!this.enabled)return[];let[e,t]=this._userIdTargeting.getSyncedAuctionEidPartners(this._enabledUserIdConfigs),n=this._userIdTargeting.getSyncedBrowserIdPartners(this._enabledUserIds);return this._flattenSyncedIdPartnerData(n,e,t)}_flattenSyncedIdPartnerData(e,t,n){let r=new Set(e),i=new Set(t),a=[],o=[],s=[];for(let t of e)i.has(t)?s.push(t):a.push(`i:${t}`);for(let e of t)r.has(e)||o.push(`e:${e}`);let c=n.filter(e=>!r.has(e)).map(e=>`i:${e}`);return[...a,...o,...c,...s]}get enabledUserIds(){return this.enabled?[...this._userIds.values()].map(e=>e.id):[]}init(){if(!this.enabled)return;let e={userIds:this._enabledUserIds};this.setTAMLiveIntentFlag(),this._prebidMethods.setConfig({userSync:e},!1),this.setLiveRampAtsEnvelopeSourceId(),this._prebidEventBus.auctionInit.on(e=>{if(!(e!=null&&e.bidderRequests))return;let{included:t}=this._eidManager.getProcessedEids(),n={},r=e=>{if(n[e])return n[e];let{included:r}=this._eidManager.getProcessedEidsForBidder(t,e);return n[e]=r,r};e.bidderRequests.forEach(e=>{var t,n;let i=r(e.bidderCode);(t=e.bids)==null||t.forEach(e=>{e.userIdAsEids=i}),(n=e.ortb2)!=null&&n.user&&(e.ortb2.user.ext=e.ortb2.user.ext||{},e.ortb2.user.ext.eids=i)}),e.adUnits.forEach(e=>{var t;(t=e.bids)==null||t.forEach(e=>{e.userIdAsEids=r(e.bidder)})})})}setTAMLiveIntentFlag(){let e=this._enabledUserIdConfigs.find(e=>e.id.name===`liveIntentId`);window.liModuleEnabled=e!==void 0}setLiveRampAtsEnvelopeSourceId(){let e=this._userIdTargeting.getLiveRampAtsEnvelopeSourceId();e&&this._gam.setTargetingFlag(`ats_src`,e===`true`?[`t`]:[`f`])}_setRCIDAsSharedId(){var e;let t=this._userIds.get(`sharedId`);t&&t.enabled&&(e=this._ppid)!=null&&e.value&&(t.id.value={pubcid:this._ppid.value},delete t.id.storage,this._userIdEventBus.userIdNeedsRefresh.emit({options:{submoduleNames:[t==null?void 0:t.id.name]},callback:()=>{}}))}async _setPPID(){var e;let t=this._context.gpid,n=await this._user.getRcid(),r=Os();if(!(n==null||(e=n.value)==null)&&e.sharedId){let e=this._isRCIDConversionEven(n.value.sharedId);e?(this._ppid={value:n.value.sharedId,source:`rcid_e`},this._setRCIDAsSharedId()):this._ppid={value:r,source:`rcid_o`}}else t?this._ppid={value:t,source:`gpid`}:r&&(this._ppid={value:r,source:`sh_id`});this._addPPIDToBidStream()}_addPPIDToBidStream(){var e,t,n;let r=(e=(t=this._ppid)==null?void 0:t.value)==null?null:e;if(r&&(n=this._ppid)!=null&&n.source){let e={userIds:this._enabledUserIds};if(this._ppid.source===`gpid`){var i;(i=this._userIds.get(`id5Id`))!=null&&i.enabled||this._gam.setIdAsPPID(r),e.ppid=`gpid.id5-sync.com`}else{var a;(a=this._userIds.get(`sharedId`))!=null&&a.enabled||this._gam.setIdAsPPID(r),e.ppid=`pubcid.org`}this._prebidMethods.setConfig({userSync:e},!1),this._gam.setTargetingFlag(`ppid`,[this._ppid.source],!0)}}_isRCIDConversionEven(e){let t=XT(e);return!!ZT(t)}},QT=D([Q(`UserIdComponent`),C(),A(`design:paramtypes`,[typeof(RT=va!==void 0&&va)==`function`?RT:Object,typeof(zT=Ea!==void 0&&Ea)==`function`?zT:Object,typeof(BT=R!==void 0&&R)==`function`?BT:Object,typeof(VT=IT!==void 0&&IT)==`function`?VT:Object,typeof(HT=Jw!==void 0&&Jw)==`function`?HT:Object,typeof(UT=Zh!==void 0&&Zh)==`function`?UT:Object,typeof(WT=Vr!==void 0&&Vr)==`function`?WT:Object,typeof(GT=Lr!==void 0&&Lr)==`function`?GT:Object,typeof(KT=Pr!==void 0&&Pr)==`function`?KT:Object,typeof(qT=Ss!==void 0&&Ss)==`function`?qT:Object,typeof(JT=L!==void 0&&L)==`function`?JT:Object,typeof(YT=ET!==void 0&&ET)==`function`?YT:Object])],QT)})),$T=o((()=>{Sse()})),eE,tE=o((()=>{eE=class{}})),nE,rE=o((()=>{w(),$(),mU(),j(),O(),nE=class extends pU{init(){this._key=`Analytics2`,this._lookup=`PBA2`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],nE.prototype,`run`,null),nE=D([C()],nE)})),iE,aE=o((()=>{Ui(),w(),E(),O(),iE=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`AYUserSyncReplaceMacro`,this._lookup=`AYUSRMC`}},iE=D([C()],iE)})),oE,sE,cE,lE,Cse=o((()=>{w(),$(),tE(),rE(),bl(),Z(),aE(),j(),E(),O(),lE=class extends eE{constructor(e,t,n){super(),this._analyticsExperiment=e,this._prebidServerMultiCallExperiment=t,this._userSyncReplaceMacroExperiment=n,T(this,`name`,`Assertive-yield`),T(this,`_url`,`https://ads.adthrive.com/ay/ay.js`),T(this,`_entityId`,`8DBojqDi4uyEa5CBW`)}init(){if(!window.localStorage){M.error(`AssertiveYieldAnalytics`,`init`,Error(`Disabled ay because localStorage is undefined`));return}ta(this._url).then(this.initializeAy.bind(this)).catch(e=>M.error(`AssertiveYieldAnalytics`,`init - failed`,e))}initializeAy(){if(!window.ayS2STag){M.error(`AssertiveYieldAnalytics`,`failed to load ayS2STag`);return}let{bucket:e,deployment:t}=window.adthrive,n=this._userSyncReplaceMacroExperiment.result&&(this._prebidServerMultiCallExperiment.result===`ay`||this._prebidServerMultiCallExperiment.result===`all`);window.ayS2STag.init({entityId:this._entityId,pbjs:`pbjs`,analytics:{enabled:!0,custom_1:this._prebidServerMultiCallExperiment.result,custom_2:e,custom_3:t,...n&&{custom_4:`aysse`}}})}get enabled(){return this._analyticsExperiment.result===`ay`}},lE=D([Q(`AssertiveYieldAnalytics`),S(),A(`design:paramtypes`,[typeof(oE=nE!==void 0&&nE)==`function`?oE:Object,typeof(sE=yl!==void 0&&yl)==`function`?sE:Object,typeof(cE=iE!==void 0&&iE)==`function`?cE:Object])],lE)})),uE,wse=o((()=>{g_(),ko(),uE=h_(Oo,`WeakMap`)}));function Tse(e,t){for(var n=-1,r=e==null?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}var Ese=o((()=>{})),dE,Dse=o((()=>{ov(),dE=av(Object.keys,Object)}));function Ose(e){if(!lv(e))return dE(e);var t=[];for(var n in Object(e))pE.call(e,n)&&n!=`constructor`&&t.push(n);return t}var fE,pE,kse=o((()=>{dv(),Dse(),fE=Object.prototype,pE=fE.hasOwnProperty}));function mE(e){return Ev(e)?Fy(e):Ose(e)}var hE=o((()=>{Ry(),kse(),Dv()}));function gE(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var _E=o((()=>{}));function Ase(e,t){return e&&ky(t,mE(t),e)}var jse=o((()=>{Ay(),hE()}));function Mse(e,t){return e&&ky(t,Vy(t),e)}var Nse=o((()=>{Ay(),Hy()}));function Pse(e,t){for(var n=-1,r=e==null?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a}var Fse=o((()=>{}));function vE(){return[]}var yE=o((()=>{})),bE,xE,SE,CE,wE=o((()=>{Fse(),yE(),bE=Object.prototype,xE=bE.propertyIsEnumerable,SE=Object.getOwnPropertySymbols,CE=SE?function(e){return e==null?[]:(e=Object(e),Pse(SE(e),function(t){return xE.call(e,t)}))}:vE}));function Ise(e,t){return ky(e,CE(e),t)}var Lse=o((()=>{Ay(),wE()})),TE,EE,DE=o((()=>{_E(),cv(),wE(),yE(),TE=Object.getOwnPropertySymbols,EE=TE?function(e){for(var t=[];e;)gE(t,CE(e)),e=sv(e);return t}:vE}));function Rse(e,t){return ky(e,EE(e),t)}var zse=o((()=>{Ay(),DE()}));function OE(e,t,n){var r=t(e);return xv(e)?r:gE(r,n(e))}var kE=o((()=>{_E(),Sv()}));function AE(e){return OE(e,mE,CE)}var jE=o((()=>{kE(),wE(),hE()}));function Bse(e){return OE(e,Vy,EE)}var Vse=o((()=>{kE(),DE(),Hy()})),ME,Hse=o((()=>{g_(),ko(),ME=h_(Oo,`DataView`)})),NE,Use=o((()=>{g_(),ko(),NE=h_(Oo,`Promise`)})),PE,Wse=o((()=>{g_(),ko(),PE=h_(Oo,`Set`)})),FE,IE,LE,RE,zE,BE,VE,HE,UE,WE,GE,KE,qE,JE=o((()=>{Hse(),v_(),Use(),Wse(),wse(),Go(),s_(),FE=`[object Map]`,IE=`[object Object]`,LE=`[object Promise]`,RE=`[object Set]`,zE=`[object WeakMap]`,BE=`[object DataView]`,VE=i_(ME),HE=i_(__),UE=i_(NE),WE=i_(PE),GE=i_(uE),KE=Vo,(ME&&KE(new ME(new ArrayBuffer(1)))!=BE||__&&KE(new __)!=FE||NE&&KE(NE.resolve())!=LE||PE&&KE(new PE)!=RE||uE&&KE(new uE)!=zE)&&(KE=function(e){var t=Vo(e),n=t==IE?e.constructor:void 0,r=n?i_(n):``;if(r)switch(r){case VE:return BE;case HE:return FE;case UE:return LE;case WE:return RE;case GE:return zE}return t}),qE=KE}));function Gse(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]==`string`&&XE.call(e,`index`)&&(n.index=e.index,n.input=e.input),n}var YE,XE,Kse=o((()=>{YE=Object.prototype,XE=YE.hasOwnProperty}));function qse(e,t){var n=t?Z_(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var Jse=o((()=>{Q_()}));function Yse(e){var t=new e.constructor(e.source,ZE.exec(e));return t.lastIndex=e.lastIndex,t}var ZE,Xse=o((()=>{ZE=/\w*$/}));function Zse(e){return $E?Object($E.call(e)):{}}var QE,$E,Qse=o((()=>{Po(),QE=No?No.prototype:void 0,$E=QE?QE.valueOf:void 0}));function $se(e,t,n){var r=e.constructor;switch(t){case cD:return Z_(e);case eD:case tD:return new r(+e);case lD:return qse(e,n);case uD:case dD:case fD:case pD:case mD:case hD:case gD:case _D:case vD:return $_(e,n);case nD:return new r;case rD:case oD:return new r(e);case iD:return Yse(e);case aD:return new r;case sD:return Zse(e)}}var eD,tD,nD,rD,iD,aD,oD,sD,cD,lD,uD,dD,fD,pD,mD,hD,gD,_D,vD,ece=o((()=>{Q_(),Jse(),Xse(),Qse(),ev(),eD=`[object Boolean]`,tD=`[object Date]`,nD=`[object Map]`,rD=`[object Number]`,iD=`[object RegExp]`,aD=`[object Set]`,oD=`[object String]`,sD=`[object Symbol]`,cD=`[object ArrayBuffer]`,lD=`[object DataView]`,uD=`[object Float32Array]`,dD=`[object Float64Array]`,fD=`[object Int8Array]`,pD=`[object Int16Array]`,mD=`[object Int32Array]`,hD=`[object Uint8Array]`,gD=`[object Uint8ClampedArray]`,_D=`[object Uint16Array]`,vD=`[object Uint32Array]`}));function tce(e){return Ko(e)&&qE(e)==yD}var yD,nce=o((()=>{JE(),qo(),yD=`[object Map]`})),bD,xD,rce=o((()=>{nce(),py(),yy(),bD=vy&&vy.isMap,xD=bD?fy(bD):tce}));function ice(e){return Ko(e)&&qE(e)==SD}var SD,ace=o((()=>{JE(),qo(),SD=`[object Set]`})),CD,wD,oce=o((()=>{ace(),py(),yy(),CD=vy&&vy.isSet,wD=CD?fy(CD):ice}));function TD(e,t,n,r,i,a){var o,s=t&ED,c=t&DD,l=t&OD;if(n&&(o=i?n(e,r,i,a):n(e)),o!==void 0)return o;if(!Co(e))return e;var u=xv(e);if(u){if(o=Gse(e),!s)return tv(e,o)}else{var d=qE(e),f=d==PD||d==FD;if(Nv(e))return H_(e,s);if(d==RD||d==kD||f&&!i){if(o=c||f?{}:fv(e),!s)return c?Rse(e,Mse(o,e)):Ise(e,Ase(o,e))}else{if(!tO[d])return i?e:{};o=$se(e,d,s)}}a||(a=new N_);var p=a.get(e);if(p)return p;a.set(e,o),wD(e)?e.forEach(function(r){o.add(TD(r,t,n,r,e,a))}):xD(e)&&e.forEach(function(r,i){o.set(i,TD(r,t,n,i,e,a))});var m=l?c?Bse:AE:c?Vy:mE,h=u?void 0:m(e);return Tse(h||e,function(r,i){h&&(i=r,r=e[i]),Ty(o,i,TD(r,t,n,i,e,a))}),o}var ED,DD,OD,kD,AD,jD,MD,ND,PD,FD,ID,LD,RD,zD,BD,VD,HD,UD,WD,GD,KD,qD,JD,YD,XD,ZD,QD,$D,eO,tO,sce=o((()=>{P_(),Ese(),Oy(),jse(),Nse(),J_(),nv(),Lse(),zse(),jE(),Vse(),JE(),Kse(),ece(),pv(),Sv(),Pv(),rce(),wo(),oce(),hE(),Hy(),ED=1,DD=2,OD=4,kD=`[object Arguments]`,AD=`[object Array]`,jD=`[object Boolean]`,MD=`[object Date]`,ND=`[object Error]`,PD=`[object Function]`,FD=`[object GeneratorFunction]`,ID=`[object Map]`,LD=`[object Number]`,RD=`[object Object]`,zD=`[object RegExp]`,BD=`[object Set]`,VD=`[object String]`,HD=`[object Symbol]`,UD=`[object WeakMap]`,WD=`[object ArrayBuffer]`,GD=`[object DataView]`,KD=`[object Float32Array]`,qD=`[object Float64Array]`,JD=`[object Int8Array]`,YD=`[object Int16Array]`,XD=`[object Int32Array]`,ZD=`[object Uint8Array]`,QD=`[object Uint8ClampedArray]`,$D=`[object Uint16Array]`,eO=`[object Uint32Array]`,tO={},tO[kD]=tO[AD]=tO[WD]=tO[GD]=tO[jD]=tO[MD]=tO[KD]=tO[qD]=tO[JD]=tO[YD]=tO[XD]=tO[ID]=tO[LD]=tO[RD]=tO[zD]=tO[BD]=tO[VD]=tO[HD]=tO[ZD]=tO[QD]=tO[$D]=tO[eO]=!0,tO[ND]=tO[PD]=tO[UD]=!1}));function nO(e){return TD(e,rO|iO)}var rO,iO,cce=o((()=>{sce(),rO=1,iO=4}));function lce(e){return this.__data__.set(e,aO),this}var aO,uce=o((()=>{aO=`__lodash_hash_undefined__`}));function dce(e){return this.__data__.has(e)}var fce=o((()=>{}));function oO(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new A_;++t<n;)this.add(e[t])}var pce=o((()=>{j_(),uce(),fce(),oO.prototype.add=oO.prototype.push=lce,oO.prototype.has=dce}));function mce(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var hce=o((()=>{}));function gce(e,t){return e.has(t)}var _ce=o((()=>{}));function sO(e,t,n,r,i,a){var o=n&cO,s=e.length,c=t.length;if(s!=c&&!(o&&c>s))return!1;var l=a.get(e),u=a.get(t);if(l&&u)return l==t&&u==e;var d=-1,f=!0,p=n&lO?new oO:void 0;for(a.set(e,t),a.set(t,e);++d<s;){var m=e[d],h=t[d];if(r)var g=o?r(h,m,d,t,e,a):r(m,h,d,e,t,a);if(g!==void 0){if(g)continue;f=!1;break}if(p){if(!mce(t,function(e,t){if(!gce(p,t)&&(m===e||i(m,e,n,r,a)))return p.push(t)})){f=!1;break}}else if(!(m===h||i(m,h,n,r,a))){f=!1;break}}return a.delete(e),a.delete(t),f}var cO,lO,uO=o((()=>{pce(),hce(),_ce(),cO=1,lO=2}));function vce(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}var yce=o((()=>{}));function bce(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var xce=o((()=>{}));function Sce(e,t,n,r,i,a,o){switch(n){case CO:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case SO:return!(e.byteLength!=t.byteLength||!a(new Y_(e),new Y_(t)));case pO:case mO:case _O:return Hg(+e,+t);case hO:return e.name==t.name&&e.message==t.message;case vO:case bO:return e==t+``;case gO:var s=vce;case yO:var c=r&dO;if(s||(s=bce),e.size!=t.size&&!c)return!1;var l=o.get(e);if(l)return l==t;r|=fO,o.set(e,t);var u=sO(s(e),s(t),r,i,a,o);return o.delete(e),u;case xO:if(TO)return TO.call(e)==TO.call(t)}return!1}var dO,fO,pO,mO,hO,gO,_O,vO,yO,bO,xO,SO,CO,wO,TO,Cce=o((()=>{Po(),X_(),Ug(),uO(),yce(),xce(),dO=1,fO=2,pO=`[object Boolean]`,mO=`[object Date]`,hO=`[object Error]`,gO=`[object Map]`,_O=`[object Number]`,vO=`[object RegExp]`,yO=`[object Set]`,bO=`[object String]`,xO=`[object Symbol]`,SO=`[object ArrayBuffer]`,CO=`[object DataView]`,wO=No?No.prototype:void 0,TO=wO?wO.valueOf:void 0}));function wce(e,t,n,r,i,a){var o=n&EO,s=AE(e),c=s.length,l=AE(t),u=l.length;if(c!=u&&!o)return!1;for(var d=c;d--;){var f=s[d];if(!(o?f in t:OO.call(t,f)))return!1}var p=a.get(e),m=a.get(t);if(p&&m)return p==t&&m==e;var h=!0;a.set(e,t),a.set(t,e);for(var g=o;++d<c;){f=s[d];var _=e[f],v=t[f];if(r)var y=o?r(v,_,f,t,e,a):r(_,v,f,e,t,a);if(!(y===void 0?_===v||i(_,v,n,r,a):y)){h=!1;break}g||(g=f==`constructor`)}if(h&&!g){var b=e.constructor,ee=t.constructor;b!=ee&&`constructor`in e&&`constructor`in t&&!(typeof b==`function`&&b instanceof b&&typeof ee==`function`&&ee instanceof ee)&&(h=!1)}return a.delete(e),a.delete(t),h}var EO,DO,OO,Tce=o((()=>{jE(),EO=1,DO=Object.prototype,OO=DO.hasOwnProperty}));function Ece(e,t,n,r,i,a){var o=xv(e),s=xv(t),c=o?jO:qE(e),l=s?jO:qE(t);c=c==AO?MO:c,l=l==AO?MO:l;var u=c==MO,d=l==MO,f=c==l;if(f&&Nv(e)){if(!Nv(t))return!1;o=!0,u=!1}if(f&&!u)return a||(a=new N_),o||xy(e)?sO(e,t,n,r,i,a):Sce(e,t,c,n,r,i,a);if(!(n&kO)){var p=u&&PO.call(e,`__wrapped__`),m=d&&PO.call(t,`__wrapped__`);if(p||m){var h=p?e.value():e,g=m?t.value():t;return a||(a=new N_),i(h,g,n,r,a)}}return f?(a||(a=new N_),wce(e,t,n,r,i,a)):!1}var kO,AO,jO,MO,NO,PO,Dce=o((()=>{P_(),uO(),Cce(),Tce(),JE(),Sv(),Pv(),Sy(),kO=1,AO=`[object Arguments]`,jO=`[object Array]`,MO=`[object Object]`,NO=Object.prototype,PO=NO.hasOwnProperty}));function FO(e,t,n,r,i){return e===t?!0:e==null||t==null||!Ko(e)&&!Ko(t)?e!==e&&t!==t:Ece(e,t,n,r,FO,i)}var Oce=o((()=>{Dce(),qo()}));function IO(e,t){return FO(e,t)}var kce=o((()=>{Oce()})),LO=o((()=>{cce(),Sv(),kce(),wp()})),RO,zO,Ace=o((()=>{LO(),RO=(e,t)=>{if(t.length>e.length)return!1;let n=e.length-t.length;for(let r=0;r<t.length;r++)if(e[n+r]!==t[r])return!1;return!0},zO=(e,t,n={})=>{let r=nO(e),i=t.map(e=>e.split(`.`)),a=[],o=[];for(let e of i)e.length===1?a.push(e[0]):o.push(e);let s=Object.entries(n).map(([e,t])=>({pathSegments:e.split(`.`),replacementValue:t})),c=new Map,l=[];for(let{pathSegments:e,replacementValue:t}of s)if(e.length===1)c.set(e[0],t);else{let n=e.slice(0,-1),r=e[e.length-1];l.push({prefix:n,lastKey:r,replacement:t})}let u=(e,t)=>{if(Array.isArray(e)){let n=e.map(e=>u(e,t)).filter(e=>!(e===void 0||Array.isArray(e)&&e.length===0||typeof e==`object`&&e&&Object.keys(e).length===0));return n.length===0?void 0:n}if(typeof e==`object`&&e){for(let n of Object.keys(e)){let r=e[n];if(a.includes(n)){delete e[n];continue}let i=!1;for(let r of o)if(r.length>=2){let a=r.slice(0,-1),o=r[r.length-1];if(RO(t,a)&&n===o){delete e[n],i=!0;break}}if(i)continue;if(c.has(n)){e[n]=c.get(n);continue}let s=!1;for(let{prefix:r,lastKey:i,replacement:a}of l)if(RO(t,r)&&n===i){e[n]=a,s=!0;break}if(s)continue;let d=u(r,[...t,n]);d===void 0||Array.isArray(d)&&d.length===0||typeof d==`object`&&d&&Object.keys(d).length===0?delete e[n]:e[n]=d}return Object.keys(e).length===0?void 0:e}return e},d=u(r,[]);return d==null?{}:d}}));function BO(e,t){return t===`string`?typeof e==`string`:t===`number`?typeof e==`number`:t===`boolean`?typeof e==`boolean`:t===`array`?Array.isArray(e):t===`object`?e&&typeof e==`object`&&!Array.isArray(e):!0}function jce(e,t){if(!t||!Array.isArray(t))return!0;for(let n of t)if(e[n]===void 0)return!1;return!0}function VO(e,t){if(!e||!e.startsWith(`#/definitions/`))return null;let n=e.replace(`#/definitions/`,``);return t[n]||null}function HO(e,t,n=``,r=[],i={}){if(!BO(e,`object`))return r.push({instancePath:n,schemaPath:`#/type`,keyword:`type`,params:{type:`object`},message:`must be object`}),{isValid:!1,errors:r};if(!jce(e,t.required)){let i=(t.required||[]).filter(t=>e[t]===void 0);i.forEach(e=>{r.push({instancePath:n,schemaPath:`#/required`,keyword:`required`,params:{missingProperty:e},message:`must have required property '${e}'`})})}if(t.properties){for(let[a,o]of Object.entries(t.properties))if(e[a]!==void 0){let t=n?`${n}/${a}`:a;if(o.$ref){let n=VO(o.$ref,i);n&&HO(e[a],n,t,r,i)}else o.type===`object`?HO(e[a],o,t,r,i):o.type===`array`&&o.items?BO(e[a],`array`)&&e[a].forEach((e,n)=>{let a=`${t}/${n}`;if(o.items.$ref){let t=VO(o.items.$ref,i);t&&HO(e,t,a,r,i)}else o.items.type===`object`&&HO(e,o.items,a,r,i)}):o.type&&!BO(e[a],o.type)&&r.push({instancePath:t,schemaPath:`#/properties/${a}/type`,keyword:`type`,params:{type:o.type},message:`must be ${o.type}`})}}if(t.additionalProperties===!1){let i=Object.keys(t.properties||{});for(let t in e)i.includes(t)||r.push({instancePath:n,schemaPath:`#/additionalProperties`,keyword:`additionalProperties`,params:{additionalProperty:t},message:`must NOT have additional properties`})}return{isValid:r.length===0,errors:r}}function UO(e){try{let t=HO(e,YO.bidresponse,``,[],YO);return UO.errors=t.isValid?null:t.errors,t.isValid}catch(e){return UO.errors=[{instancePath:``,schemaPath:`#`,keyword:`error`,params:{},message:`Validation error: `+e.message}],!1}}function WO(e){try{let t=HO(e,YO.bidwon,``,[],YO);return WO.errors=t.isValid?null:t.errors,t.isValid}catch(e){return WO.errors=[{instancePath:``,schemaPath:`#`,keyword:`error`,params:{},message:`Validation error: `+e.message}],!1}}function GO(e){try{let t=HO(e,YO.nobid,``,[],YO);return GO.errors=t.isValid?null:t.errors,t.isValid}catch(e){return GO.errors=[{instancePath:``,schemaPath:`#`,keyword:`error`,params:{},message:`Validation error: `+e.message}],!1}}function KO(e){try{let t=HO(e,YO.bidtimeout,``,[],YO);return KO.errors=t.isValid?null:t.errors,t.isValid}catch(e){return KO.errors=[{instancePath:``,schemaPath:`#`,keyword:`error`,params:{},message:`Validation error: `+e.message}],!1}}function qO(e){try{let t=HO(e,YO.bidrequested,``,[],YO);return qO.errors=t.isValid?null:t.errors,t.isValid}catch(e){return qO.errors=[{instancePath:``,schemaPath:`#`,keyword:`error`,params:{},message:`Validation error: `+e.message}],!1}}function JO(e){try{let t=HO(e,YO.pbsanalytics,``,[],YO);return JO.errors=t.isValid?null:t.errors,t.isValid}catch(e){return JO.errors=[{instancePath:``,schemaPath:`#`,keyword:`error`,params:{},message:`Validation error: `+e.message}],!1}}var YO,XO=o((()=>{YO={bidresponse:{type:`object`,properties:{adserverTargeting:{$ref:`#/definitions/adservertargeting`},adUnitCode:{type:`string`},analyticsLabels:{$ref:`#/definitions/analyticslabels`},auctionId:{type:`string`},baseContext:{$ref:`#/definitions/basecontext`},bidder:{type:`string`},bidderCode:{type:`string`},cpm:{type:`number`},currency:{type:`string`},eventType:{type:`string`},floorData:{$ref:`#/definitions/floordata`},floorValue:{type:`number`},height:{type:`number`},mediaType:{type:`string`},meta:{$ref:`#/definitions/meta`},originalCpm:{type:`number`},requestId:{type:`string`},requestTimestamp:{type:`number`},responseCpm:{type:`number`},responseTimeMillis:{type:`number`},responseTimestamp:{type:`number`},size:{type:`string`},source:{type:`string`},statusMessage:{type:`string`},timeToRespond:{type:`number`},transactionId:{type:`string`},ttl:{type:`number`},width:{type:`number`},seatNonBidStatusCode:{type:`number`}},additionalProperties:!1},adservertargeting:{type:`object`,properties:{hbAdid:{type:`string`},hbAdomain:{type:`string`},hbAttr:{type:`string`},hbBidder:{type:`string`},hbCacheHost:{type:`string`},hbCacheId:{type:`string`},hbCachePath:{type:`string`},hbCrid:{type:`string`},hbDeal:{type:`string`},hbDs:{type:`string`},hbDsp:{type:`string`},hbFormat:{type:`string`},hbPb:{type:`string`},hbSize:{type:`string`},hbSource:{type:`string`},hbUuid:{type:`string`}},additionalProperties:!1},analyticslabels:{type:`object`,properties:{deployment:{type:`string`}},additionalProperties:!1},basecontext:{type:`object`,properties:{eventName:{type:`string`},eventTimestamp:{type:`string`},icebergTable:{type:`string`},messageId:{type:`string`},receivedAt:{type:`string`},sentAt:{type:`string`},sourceId:{type:`string`},traceId:{type:`string`}},additionalProperties:!1},floordata:{type:`object`,properties:{floorProvider:{type:`string`},location:{type:`string`},modelTimestamp:{type:`number`},modelVersion:{type:`string`},modelWeight:{type:`number`},noFloorSignaled:{type:`boolean`},skipped:{type:`boolean`},skippedReason:{type:`string`},skipRate:{type:`number`}},additionalProperties:!1},meta:{type:`object`,properties:{adaptercode:{type:`string`},advertiserDomains:{type:`array`,items:{type:`string`}},advertiserId:{type:`string`},advertiserName:{type:`string`},agencyId:{type:`string`},agencyName:{type:`string`},attr:{type:`array`,items:{type:`number`}},bf1:{type:`number`},bf2:{type:`number`},bfc1:{type:`string`},bfc2:{type:`string`},brandId:{type:`string`},brandName:{type:`string`},buyerId:{type:`string`},clickUrl:{type:`string`},dchain:{$ref:`#/definitions/dchain`},demandSource:{type:`string`},dsa:{$ref:`#/definitions/dsa`},isInBannerVideo:{type:`boolean`},mediaType:{type:`string`},networkId:{type:`string`},networkName:{type:`string`},primaryCatId:{type:`string`},s:{type:`number`},seat:{type:`string`},secondaryCatIds:{type:`array`,items:{type:`string`}}},additionalProperties:!1},dchain:{type:`object`,properties:{complete:{type:`number`},nodes:{type:`array`,items:{$ref:`#/definitions/nodes`}},ver:{type:`string`}},additionalProperties:!1},nodes:{type:`object`,properties:{asi:{type:`string`},bsid:{type:`string`}},additionalProperties:!1},dsa:{type:`object`,properties:{adrender:{type:`number`}},additionalProperties:!1},bidwon:{type:`object`,properties:{adserverTargeting:{$ref:`#/definitions/adservertargeting`},adUnitCode:{type:`string`},analyticsLabels:{$ref:`#/definitions/analyticslabels`},auctionId:{type:`string`},baseContext:{$ref:`#/definitions/basecontext`},bidder:{type:`string`},bidderCode:{type:`string`},cpm:{type:`number`},currency:{type:`string`},eventType:{type:`string`},floorData:{$ref:`#/definitions/floordata`},height:{type:`number`},mediaType:{type:`string`},meta:{$ref:`#/definitions/meta`},requestId:{type:`string`},requestTimestamp:{type:`number`},responseCpm:{type:`number`},size:{type:`string`},source:{type:`string`},status:{type:`string`},statusMessage:{type:`string`},timeToRespond:{type:`number`},transactionId:{type:`string`},ttl:{type:`number`},width:{type:`number`}},additionalProperties:!1},nobid:{type:`object`,properties:{floorData:{$ref:`#/definitions/floordata`},eventType:{type:`string`},bidder:{type:`string`},adUnitCode:{type:`string`},auctionId:{type:`string`},analyticsLabels:{$ref:`#/definitions/analyticslabels`},floor:{$ref:`#/definitions/floor`},source:{type:`string`},baseContext:{$ref:`#/definitions/basecontext`}},additionalProperties:!1},floor:{type:`object`,properties:{floor:{type:`number`},currency:{type:`string`}},additionalProperties:!1},bidtimeout:{type:`object`,properties:{bids:{type:`array`,items:{$ref:`#/definitions/bids`}},analyticsLabels:{$ref:`#/definitions/analyticslabels`},eventType:{type:`string`},baseContext:{$ref:`#/definitions/basecontext`}},additionalProperties:!1},bids:{type:`object`,properties:{adUnitCode:{type:`string`},adUnitId:{type:`string`},auctionId:{type:`string`},auctionsCount:{type:`number`},bidder:{type:`string`},bidderRequestId:{type:`string`},bidderRequestsCount:{type:`number`},bidderWinsCount:{type:`number`},bidId:{type:`string`},bidRequestsCount:{type:`number`},deferBilling:{type:`boolean`},floorData:{$ref:`#/definitions/floordata`},labelAll:{type:`array`,items:{type:`string`}},mediaTypes:{$ref:`#/definitions/mediatypes`},metrics:{$ref:`#/definitions/metrics`},nativeOrtbRequest:{type:`boolean`},nativeParams:{type:`boolean`},ortb2Imp:{$ref:`#/definitions/ortb2imp`},params:{$ref:`#/definitions/params`},serverErrors:{type:`array`,items:{$ref:`#/definitions/servererrors`}},serverResponseTimeMs:{type:`number`},src:{type:`string`},startTime:{type:`number`},transactionId:{type:`string`},viewability:{type:`number`},pbsHost:{type:`string`}},additionalProperties:!1},mediatypes:{type:`object`,properties:{banner:{$ref:`#/definitions/banner`},native:{$ref:`#/definitions/native`},video:{$ref:`#/definitions/video`}},additionalProperties:!1},banner:{type:`object`,properties:{w:{type:`number`},pos:{type:`number`},h:{type:`number`}},additionalProperties:!1},native:{type:`object`,properties:{ortb:{$ref:`#/definitions/ortb`}},additionalProperties:!1},ortb:{type:`object`,properties:{privacy:{type:`number`},eventtrackers:{type:`array`,items:{$ref:`#/definitions/eventtrackers`}},seq:{type:`number`},assets:{type:`array`,items:{$ref:`#/definitions/assets`}},contextsubtype:{type:`number`},ver:{type:`string`},plcmttype:{type:`number`},context:{type:`number`}},additionalProperties:!1},eventtrackers:{type:`object`,properties:{methods:{type:`array`,items:{type:`number`}},event:{type:`number`}},additionalProperties:!1},assets:{type:`object`,properties:{data:{$ref:`#/definitions/data`},id:{type:`number`},img:{$ref:`#/definitions/img`},required:{type:`number`},title:{$ref:`#/definitions/title`}},additionalProperties:!1},data:{type:`object`,properties:{adserver:{$ref:`#/definitions/adserver`},hvp:{type:`string`},jwTargeting:{$ref:`#/definitions/jwtargeting`},len:{type:`number`},pbadslot:{type:`string`},pos:{type:`string`},type:{type:`number`}},additionalProperties:!1},adserver:{type:`object`,properties:{name:{type:`string`},adslot:{type:`string`}},additionalProperties:!1},jwtargeting:{type:`object`,properties:{mediaID:{type:`string`},playerID:{type:`string`}},additionalProperties:!1},img:{type:`object`,properties:{hmin:{type:`number`},type:{type:`number`},wmin:{type:`number`}},additionalProperties:!1},title:{type:`object`,properties:{len:{type:`number`}},additionalProperties:!1},video:{type:`object`,properties:{api:{type:`array`,items:{type:`number`}},context:{type:`string`},frameworks:{type:`array`,items:{type:`number`}},h:{type:`number`},language:{type:`string`},linearity:{type:`number`},maxduration:{type:`number`},minduration:{type:`number`},placement:{type:`number`},playbackend:{type:`number`},playbackmethod:{type:`number`},playerSize:{type:`array`,items:{type:`number`}},plcmt:{type:`number`},pos:{type:`number`},skip:{type:`number`},startdelay:{type:`number`},w:{type:`number`}},additionalProperties:!1},metrics:{type:`object`,properties:{requestBidsTotal:{type:`number`}},additionalProperties:!1},ortb2imp:{type:`object`,properties:{banner:{$ref:`#/definitions/banner`},ext:{$ref:`#/definitions/ext`},secure:{type:`number`},video:{$ref:`#/definitions/video`}},additionalProperties:!1},ext:{type:`object`,properties:{data:{$ref:`#/definitions/data`},rpbs:{$ref:`#/definitions/rpbs`},gpid:{type:`string`},tid:{type:`string`},vph:{type:`number`},vpw:{type:`number`},siteId:{type:`string`},ae:{type:`number`}},additionalProperties:!1},rpbs:{type:`object`,properties:{experiments:{$ref:`#/definitions/experiments`}},additionalProperties:!1},experiments:{type:`object`,properties:{itm:{type:`boolean`},bsa:{type:`string`},mstm:{type:`string`},mfb:{type:`number`},rDr:{type:`number`},rShpmlt:{type:`string`},tm:{type:`boolean`},msa:{type:`number`},rrb:{type:`string`},tal:{type:`boolean`},bae:{type:`boolean`},bfc:{type:`number`},sca:{type:`number`},rInfmlt:{type:`number`},rffd:{type:`boolean`},bps:{type:`boolean`},rew:{type:`boolean`},rfsi:{type:`number`}},additionalProperties:!1},params:{type:`object`,properties:{accountId:{type:`number`},adSlot:{type:`string`},allowSmallerSizes:{type:`boolean`},bidonmultiformat:{type:`boolean`},customParams:{$ref:`#/definitions/customparams`},delDomain:{type:`string`},floor:{type:`number`},formats:{type:`array`,items:{type:`string`}},id:{type:`string`},inventoryCode:{type:`string`},keywords:{$ref:`#/definitions/keywords`},networkId:{type:`number`},pageId:{type:`number`},pkey:{type:`string`},placementId:{type:`string`},position:{type:`string`},productId:{type:`string`},publisherId:{type:`string`},siteId:{type:`string`},size:{type:`array`,items:{type:`string`}},slot:{type:`number`},supplySourceId:{type:`string`},tagId:{type:`string`},uid:{type:`number`},unit:{type:`string`},video:{$ref:`#/definitions/video`},wiid:{type:`string`},zone:{type:`string`},zoneId:{type:`number`},dcn:{type:`string`},mname:{type:`string`},pmzoneid:{type:`string`},region:{type:`string`}},additionalProperties:!1},customparams:{type:`object`,properties:{sens:{type:`array`,items:{type:`string`}},bucket:{type:`array`,items:{type:`string`}}},additionalProperties:!1},keywords:{type:`object`,properties:{bucket:{type:`array`,items:{type:`string`}},Chrome:{type:`array`,items:{type:`string`}},hvp:{type:`array`,items:{type:`string`}},mcmp:{type:`array`,items:{type:`string`}},Mobile:{type:`array`,items:{type:`string`}},pmpElig:{type:`array`,items:{type:`string`}},sens:{type:`array`,items:{type:`string`}},siteCode:{type:`array`,items:{type:`string`}},verticals:{type:`array`,items:{type:`string`}}},additionalProperties:!1},servererrors:{type:`object`,properties:{code:{type:`number`},message:{type:`string`}},additionalProperties:!1},bidrequested:{type:`object`,properties:{bids:{type:`array`,items:{$ref:`#/definitions/bids`}},ortb2Imp:{$ref:`#/definitions/ortb2imp`},eventType:{type:`string`},start:{type:`number`},bidderRequestId:{type:`string`},ortb2:{$ref:`#/definitions/ortb2`},timeout:{type:`number`},auctionId:{type:`string`},eidsSources:{type:`array`,items:{type:`string`}},analyticsLabels:{$ref:`#/definitions/analyticslabels`},bidderCode:{type:`string`},auctionStart:{type:`number`},baseContext:{$ref:`#/definitions/basecontext`}},additionalProperties:!1},ortb2:{type:`object`,properties:{source:{$ref:`#/definitions/source`},site:{$ref:`#/definitions/site`},at:{type:`number`},bcat:{type:`array`,items:{type:`string`}},ext:{$ref:`#/definitions/ext`},cur:{type:`array`,items:{type:`string`}},pmp:{$ref:`#/definitions/pmp`},device:{$ref:`#/definitions/device`}},additionalProperties:!1},source:{type:`object`,properties:{fd:{type:`number`},tid:{type:`string`}},additionalProperties:!1},site:{type:`object`,properties:{cat:{type:`array`,items:{type:`string`}},domain:{type:`string`},mobile:{type:`number`},page:{type:`string`},pagecat:{type:`array`,items:{type:`string`}},privacypolicy:{type:`number`},publisher:{$ref:`#/definitions/publisher`}},additionalProperties:!1},publisher:{type:`object`,properties:{domain:{type:`string`}},additionalProperties:!1},pmp:{type:`object`,properties:{privateAuction:{type:`number`},deals:{type:`array`,items:{$ref:`#/definitions/deals`}}},additionalProperties:!1},deals:{type:`object`,properties:{id:{type:`string`},isVideo:{type:`boolean`},at:{type:`number`},bidfloor:{type:`number`},bidfloorcur:{type:`string`}},additionalProperties:!1},device:{type:`object`,properties:{dnt:{type:`number`},ext:{$ref:`#/definitions/ext`},h:{type:`number`},ip:{type:`string`},ipv6:{type:`string`},js:{type:`number`},language:{type:`string`},ua:{type:`string`},w:{type:`number`},sua:{$ref:`#/definitions/sua`}},additionalProperties:!1},sua:{type:`object`,properties:{source:{type:`number`},platform:{$ref:`#/definitions/platform`}},additionalProperties:!1},platform:{type:`object`,properties:{brand:{type:`string`},version:{type:`array`,items:{type:`number`}}},additionalProperties:!1},pbsanalytics:{type:`object`,properties:{response:{$ref:`#/definitions/response`},seatnonbid:{type:`array`,items:{$ref:`#/definitions/seatnonbid`}},eventType:{type:`string`},analyticsLabels:{$ref:`#/definitions/analyticslabels`},requestedBidders:{type:`array`,items:{type:`string`}},auctionId:{type:`string`},baseContext:{$ref:`#/definitions/basecontext`}},additionalProperties:!1},response:{type:`object`,properties:{cur:{type:`string`},seatbid:{type:`array`,items:{$ref:`#/definitions/seatbid`}},id:{type:`string`},ext:{$ref:`#/definitions/ext`},nbr:{type:`number`}},additionalProperties:!1},seatbid:{type:`object`,properties:{group:{type:`number`},bid:{type:`array`,items:{$ref:`#/definitions/bid`}},seat:{type:`string`}},additionalProperties:!1},bid:{type:`object`,properties:{cat:{type:`array`,items:{type:`string`}},ext:{$ref:`#/definitions/ext`},price:{type:`number`},crid:{type:`string`},impid:{type:`string`},id:{type:`string`},exp:{type:`number`},adomain:{type:`array`,items:{type:`string`}},burl:{type:`string`},cid:{type:`string`},w:{type:`number`},h:{type:`number`},iurl:{type:`string`},adid:{type:`string`},cattax:{type:`number`},dealid:{type:`string`},dur:{type:`number`},lurl:{type:`string`},mtype:{type:`number`}},additionalProperties:!1},seatnonbid:{type:`object`,properties:{nonbid:{type:`array`,items:{$ref:`#/definitions/nonbid`}},seat:{type:`string`}},additionalProperties:!1},nonbid:{type:`object`,properties:{impid:{type:`string`},statuscode:{type:`number`}},additionalProperties:!1}},UO.errors=null,WO.errors=null,GO.errors=null,KO.errors=null,qO.errors=null,JO.errors=null})),Mce=o((()=>{XO(),XO()})),ZO,QO,$O,ek,tk,nk,rk,ik,Nce=o((()=>{w(),jc(),$(),tE(),rE(),B(),Z(),LO(),Ace(),Mce(),j(),E(),O(),tk={BIDRESPONSE:UO,BIDWON:WO,NOBID:GO,BIDTIMEOUT:KO,BIDREQUESTED:qO,PBSANALYTICS:JO},nk=[`enforcement`,`jwplayer`,`mimes`,`protocols`,`regs`,`renderer`,`rtd`,`schain`,`segments`,`site.content`,`site.ext`,`sizes`,`user.data`,`user.ext`,`adm`,`prebid.events`,`adapterMetrics`,`ext.errors`,`msdebug`,`ext.rpbs`],rk={"mediaType.native":!0,nativeOrtbRequest:!0,nativeParams:!0},ik=ek=class extends eE{constructor(e,t,n){super(),this._prebidMethods=e,this._analyticsExperiment=t,this._config=n,T(this,`name`,`generic`),T(this,`_loggerEndpoint`,`https://api.adthrive.com/logger`),T(this,`_setLoggerBidResponseFields`,e=>{var t;return{event_type:`BIDRESPONSE`,adserverTargeting:e.adserverTargeting,adUnitCode:e.adUnitCode,auctionId:e.auctionId,bidder:e.bidderCode,bidderCode:e.bidderCode,cpm:e.cpm,currency:e.currency,floorData:e.floorData,floorValue:(t=e.floorData)==null?void 0:t.floorValue,height:e.height,mediaType:e.mediaType,meta:e.meta,originalCpm:e.originalCpm,requestId:e.requestId,requestTimestamp:e.requestTimestamp,responseCpm:e.responseCpm,responseTimestamp:e.responseTimestamp,responseTimeMillis:e.responseTimeMillis,seatNonBidStatusCode:e.seatNonBidStatusCode,size:e.size,source:e.source,statusMessage:e.statusMessage,timeToRespond:e.timeToRespond,transactionId:e.transactionId,ttl:e.ttl,width:e.width,analyticsLabels:e.analyticsLabels}}),T(this,`_setLoggerBidWonFields`,e=>({event_type:`BIDWON`,adserverTargeting:e.adserverTargeting,adUnitCode:e.adUnitCode,auctionId:e.auctionId,bidder:e.bidder,bidderCode:e.bidderCode,cpm:e.cpm,currency:e.currency,floorData:e.floorData,height:e.height,mediaType:e.mediaType,meta:e.meta,requestId:e.requestId,requestTimestamp:e.requestTimestamp,responseCpm:e.responseCpm,size:e.size,source:e.source,status:e.status,statusMessage:e.statusMessage,timeToRespond:e.timeToRespond,transactionId:e.transactionId,ttl:e.ttl,width:e.width,analyticsLabels:e.analyticsLabels})),T(this,`_setLoggerNoBidFields`,e=>{var t;return{event_type:`NOBID`,auctionId:e.auctionId,bidder:e.bidder,source:e.src,adUnitCode:e.adUnitCode,floor:(t=e.getFloor)==null?void 0:t.call(e),floorData:e.floorData,analyticsLabels:e.analyticsLabels}}),T(this,`_setLoggerBidTimeoutFields`,e=>{let{analyticsLabels:t,...n}=e,r=Object.values(n),i=r.length,a=i>1&&r.every(e=>IO(e.ortb2,r[0].ortb2)),o=i>1&&r.every(e=>IO(e.ortb2Imp,r[0].ortb2Imp)),s=a?r[0].ortb2:void 0,c=o?r[0].ortb2Imp:void 0;return{event_type:`BIDTIMEOUT`,bids:r.map(e=>({adUnitCode:e.adUnitCode,auctionId:e.auctionId,bid_id:e.bid_id,bidder:e.bidder,bidderRequestId:e.bidderRequestId,bidderRequestsCount:e.bidRequestsCount,bidderWinsCount:e.bidderWinsCount,bidId:e.bidId,bidRequestsCount:e.bidRequestsCount,floorData:e.floorData,mediaTypes:e.mediaTypes,ortb2:a?void 0:e.ortb2,ortb2Imp:o?void 0:e.ortb2Imp,schain:e.schain,sizes:e.sizes,src:e.src,transactionId:e.transactionId})),...s&&{ortb2:s},...o&&{ortb2Imp:c},analyticsLabels:t}}),T(this,`_setLoggerBidRequestedFields`,e=>{let{truncatedBids:t,eidsSources:n,ortb2:r,ortb2Imp:i}=this.truncateBidRequestBids(e.bids);return{event_type:`BIDREQUESTED`,bidderCode:e.bidderCode,auctionId:e.auctionId,auctionStart:e.auctionStart,bidderRequestId:e.bidderRequestId,bids:t,start:e.start,timeout:e.timeout,ortb2:r==null?e.ortb2:r,...i&&{ortb2Imp:i},...n&&{eidsSources:n},analyticsLabels:e.analyticsLabels}}),T(this,`_setLoggerPbsAnalyticsFields`,e=>{var t;let{response:n,seatnonbid:r}=e,i=IO(r,n==null||(t=n.ext)==null?void 0:t.seatnonbid),a=i?{...n,ext:{...n==null?void 0:n.ext,seatnonbid:void 0}}:n;return{event_type:`PBSANALYTICS`,...e,response:a,analyticsLabels:e.analyticsLabels}})}init(){try{this._prebidMethods.enableAnalytics({provider:this.name,options:{batchSize:40,batchDelay:2e3,gvlid:this._config.gdpr.raptiveVendorId,events:{bidResponse:e=>this._setLoggerBidResponseFields(e),bidWon:e=>this._setLoggerBidWonFields(e),noBid:e=>this._setLoggerNoBidFields(e),bidTimeout:e=>this._setLoggerBidTimeoutFields(e),bidRequested:e=>this._setLoggerBidRequestedFields(e),pbsAnalytics:e=>this._setLoggerPbsAnalyticsFields(e)},handler:e=>{let t=Array.isArray(e),n=t?e:[e],r=n.map(e=>zO(e,nk,rk));r=r.map(e=>{if(e.event_type){e=this.transformEvent(e);let t=tk[e.event_type];t&&(e=this.validateAndClean(e,t))}return e});let i=t?r:r[0];return new Promise((e,t)=>{fetch(this._loggerEndpoint,{method:`POST`,headers:[[`Content-Type`,`application/json`]],body:JSON.stringify({event_type:`generic`,message:JSON.stringify(i)})}).then(t=>{e(t)}).catch(e=>{t(e)})})}}})}catch(e){M.error(`GenericAnalytics`,`init - ignored`,e)}try{this._prebidMethods.setConfig({analyticsLabels:{deployment:`${window.adthrive.deployment}`}},!1)}catch(e){M.error(`GenericAnalytics`,`init - ignored`,e)}}get enabled(){return this._analyticsExperiment.result===`generic`}removeInvalidProperties(e,t){let n=nO(e),r=[];return t.forEach(e=>{if(e.keyword===`additionalProperties`&&e.params.additionalProperty){let t=e.params.additionalProperty;if(ek.PRESERVED_PROPERTIES.has(t))return;let i=e.instancePath.replace(/^\//,``).split(`/`).filter(Boolean),a=n;for(let e of i)a&&typeof a==`object`&&Object.prototype.hasOwnProperty.call(a,e)&&(a=a[e]);a&&typeof a==`object`&&t in a&&(delete a[t],r.push(`${e.instancePath}/${t}`))}}),r.length,n}validateAndClean(e,t){let n=t(e);return!n&&t.errors&&t.errors.length>0?this.removeInvalidProperties(e,t.errors):e}isValidGPTSingleSize(e){return Array.isArray(e)&&e.length===2&&!isNaN(e[0])&&!isNaN(e[1])}sizesToSizeTuples(e){return typeof e==`string`?e.split(/\s*,\s*/).map(e=>e.match(/^(\d+)x(\d+)$/i)).filter(e=>!!e).map(([,e,t])=>[parseInt(e,10),parseInt(t,10)]):Array.isArray(e)?this.isValidGPTSingleSize(e)?[e]:e.filter(this.isValidGPTSingleSize):[]}sizeTupleToSizeString(e){return e[0]+`x`+e[1]}parseSizesInput(e){return this.sizesToSizeTuples(e).map(this.sizeTupleToSizeString)}transformEvent(e){if([`BIDTIMEOUT`,`BIDREQUESTED`].includes(e.event_type)&&e.bids)for(let[o,s]of e.bids.entries()){var t,n,r,i;!((t=s.mediaTypes)==null||(t=t.labelAll)==null||(t=t.metrics)==null)&&t[`requestBids.total`]&&(e.bids[o].mediaTypes.labelAll.metrics.requestBidsTotal=Math.round(s.mediaTypes.labelAll.metrics[`requestBids.total`]),delete e.bids[o].mediaTypes.labelAll.metrics[`requestBids.total`]),!((n=s.params)==null||(n=n.formats)==null)&&n.placement_id&&(e.bids[o].params.formats.placementId=s.params.formats.placement_id,delete e.bids[o].params.formats.placement_id),s.bid_id&&(e.bids[o].bidId=s.bid_id,delete e.bids[o].bid_id),(r=s.params)!=null&&r.size&&(e.bids[o].params.size=this.parseSizesInput(s.params.size)),(i=s.params)!=null&&i.video&&typeof s.params.video==`string`&&delete e.bids[o].params.video;let c=[s.params,s.mediaTypes,s.ortb2Imp];for(let e of c){var a;!(e==null||(a=e.video)==null)&&a.playerSize&&(e.video.playerSize=Array.isArray(e.video.playerSize)&&Array.isArray(e.video.playerSize[0])?e.video.playerSize[0]:e.video.playerSize)}}return e}truncateBidRequestBids(e){let t,n,r,i=e.map(e=>{var t,n;let{userId:r,userIdAsEids:i,metrics:a,ortb2:o,...s}=e,c=(a==null?void 0:a.getMetrics()[`requestBids.total`])||(a==null?void 0:a.getMetrics().requestBidsTotal);c&&Array.isArray(c)?c=c.map(Math.round):c&&(c=Math.round(c));let l=nO(o),u=(l==null||(t=l.user)==null||(t=t.ext)==null?void 0:t.eids)||[],d=i||[],f=[...d,...u].map(e=>e.source).filter(GW);return!(l==null||(n=l.user)==null||(n=n.ext)==null)&&n.eids&&delete l.user.ext.eids,{...s,ortb2:l,eidsSources:f,...c&&{metrics:{requestBidsTotal:c}}}});return i.length>0&&(t=i.every(e=>IO(e.ortb2,i[0].ortb2))?i[0].ortb2:void 0,n=i.every(e=>IO(e.ortb2Imp,i[0].ortb2Imp))?i[0].ortb2Imp:void 0,r=i.every(e=>IO(e.eidsSources,i[0].eidsSources))?i[0].eidsSources:void 0,i.forEach(e=>{t&&delete e.ortb2,n&&delete e.ortb2Imp,r&&delete e.eidsSources})),{truncatedBids:i,ortb2:t,ortb2Imp:n,eidsSources:r}}},T(ik,`PRESERVED_PROPERTIES`,new Set([`event_type`,`eventType`])),ik=ek=D([Q(`GenericAnalytics`),S(),A(`design:paramtypes`,[typeof(ZO=R!==void 0&&R)==`function`?ZO:Object,typeof(QO=nE!==void 0&&nE)==`function`?QO:Object,typeof($O=z!==void 0&&z)==`function`?$O:Object])],ik)})),Pce=o((()=>{tE(),Cse(),Nce()})),ak,ok=o((()=>{X(),LO(),E(),ak=class{constructor(e){this._config=e,T(this,`gvlid`,void 0),T(this,`adServerTargeting`,void 0),T(this,`multiformatBidder`,void 0),T(this,`_multiformat`,void 0),T(this,`_bidders`,[]),T(this,`_settings`,void 0),T(this,`_integrationConfigured`,!1),T(this,`multiformatBannerVideoBidder`,void 0),T(this,`multiformatBannerNativeBidder`,void 0),T(this,`_videoCreativeIds`,[])}updateBidParams(e,t){}_getParamValuesFromClient(e,t){}setup(){this._integrationConfigured||this._setupBidderIntegrationType()}get settings(){return this._settings}get adapterEnablement(){return nO(this._adapterEnablement)}get bidderDisplayEnabled(){return!0}get bidderInstreamEnabled(){return!0}get bidders(){return this._bidders}get bidderCodes(){return this._bidderCodes}get enabled(){var e;let{client:t,server:n}=this._adapterEnablement,r=t.enabled&&t.name||n.enabled&&n.name;return!!(this._bidders.length>0&&((e=this._config.partners.display.get(this.name))==null?r&&this._config.partners.display.get(r):e))}get videoCreativeIds(){return this._videoCreativeIds}get videoEnabled(){let{client:e,server:t}=this._adapterEnablement,n=e.enabled&&e.name||t.enabled&&t.name;return this._bidders.length>0&&(this._config.partners.video.get(this.name)||n&&this._config.partners.video.get(n))}get name(){return this.bidderConfig.bidder_name}getBidderAliases(){let e=this._adapterEnablement,t=new Map,n=e.client.enabled;return this._bidders.forEach(r=>{let i=r.name,a=e[r.type],o=a.enabled?a.name:``;o===i||t.has(i)||(n?t.set(r.name,o):this._config.prebid.s2s.aliases[i]=o)}),t}_addPositionParam(e,t){e.params.position=t}_addPlacementIdParam(e,t){e.params.placementId=t}_applyAuctionLabel(e,t){let n=this._config,r=n.prebid.multistageValue!==`crr`&&n.prebid.multistageValue!==`off`,i=e.location===F.Video_StickyOutstream,a=n.prebid,o=t.bidder,s=[];r&&i&&a.refreshStickyOutstreamAuctionCount>1?s=a.getVideoBidderLabel(o):r&&!i&&a.refreshAuctionCount>1&&(s=a.getBidderLabel(o,t.pbsHost)),s.forEach(e=>{t.labelAll=t.labelAll||[],t.labelAll.includes(e)||t.labelAll.push(e)})}_isS2SBidder(e=``){let t=this._config.prebid.s2s.bidders;return t.includes(e)}_setupBidderIntegrationType(){let{name:e,_adapterEnablement:t}=this,{client:n,server:r}=t,i=n.enabled&&n.name||r.enabled&&r.name||void 0,{primary:a,secondary:o,supplemental:s}=this.bidderCodes,c=o==null?a:o,l=t=>this._getBidderHoldout(e,i,t),u=({name:e,type:t,pbsHost:n})=>{this._bidders.push({name:e,type:t,...n&&{pbsHost:n}})};[a,o].forEach(e=>{!e||l(e)||!this._isS2SBidder(e)&&!this._config.prebidClientSide.enabled||u({name:e,type:this._isS2SBidder(e)?`server`:`client`})}),s==null||s.forEach(e=>{if(!l(e)&&c&&this._isS2SBidder(c)){var t,n;u({name:c,type:`server`,pbsHost:e}),(n=(t=this._config.prebid.s2s).additionalBidders)!=null||(t.additionalBidders=[]),this._config.prebid.s2s.additionalBidders.push(e)}}),this._integrationConfigured=!0}_getBidderHoldout(e,t,n){let r=this._config,i=t?[t]:[],a=n&&n!==e?[n]:[];return[e,...i,...a].some(i=>r.hbho.bidders.includes(i)&&r.vbho.bidders.includes(i)||r.prebid.experimentIntegrationHoldouts.includes(n||t||e))}}})),sk,ck,lk,Fce=o((()=>{B(),Z(),Ra(),w(),$(),al(),j(),E(),O(),lk=class{_getBannerBidMainHeight(e){var t;let n=(t=e.sizes.filter(e=>e[1]!==1)[0])==null?void 0:t[1];return n}_getBannerBidMainWidth(e){var t;let n=(t=e.sizes.filter(e=>e[0]!==1)[0])==null?void 0:t[0];return n}constructor(e,t){this._config=e,this._context=t,T(this,`_enablementByDevice`,tG()?`Mobile`:`Desktop`),T(this,`_macroReplace`,{allowSmallerAdSizes:()=>this._config.adOptions.allowSmallerAdSizes,biddercode:e=>e.bidder.name,category:()=>this._config.site.category,device:()=>this._enablementByDevice.toLowerCase(),integration:e=>e.bidder.type,location:e=>this._isDisplaySlot(e.unit)?e.unit.location:e.unit.name,mainHeight:e=>this._isDisplaySlot(e.unit)?this._getBannerBidMainHeight(e.unit):e.unit.size[1],mainWidth:e=>this._isDisplaySlot(e.unit)?this._getBannerBidMainWidth(e.unit):e.unit.size[0],mediatype:e=>e.mediaTypes[0],placementMapName:e=>(this._isDisplaySlot(e.unit)?e.unit.placementMapName:e.unit.name).toLowerCase(),placementMapSequence:e=>{let t={sidebar:{max:9,value:9},content:{max:9,value:9},recipe:{max:5,value:2}},n=e.unit,r=(this._isDisplaySlot(n)?n.location:n.name).toLowerCase(),i=t[r],a=this._isDisplaySlot(e.unit)&&e.unit.sequence||1,o=!i||a<=i.max?a:i.value;return o},sequence:e=>{var t;return this._isDisplaySlot(e.unit)?Math.min((t=e.unit.sequence)==null?1:t,9):1},siteId:()=>this._config.site.id,slotId:e=>this._isDisplaySlot(e.unit)?e.unit.id:e.unit.name}),T(this,`_bidValidator`,{adTypes:this._validateAdTypes.bind(this),adTypesAny:this._validateAdTypesAny.bind(this),bidderCodes:this._validateBidderCodes.bind(this),browser:this._validateBrowser.bind(this),country:this._validateCountry.bind(this),device:this._validateDevice.bind(this),exp:this._validateExp.bind(this),featureRollout:this._validateFeatureRollout.bind(this),integration:this._validateIntegration.bind(this),largeFormat:this._validateLargeFormat.bind(this),lazy:this._validateLazy.bind(this),locations:this._validateLocations.bind(this),mediaTypesAll:this._validateMediatypesAll.bind(this),mediaTypesAny:this._validateMediatypesAny.bind(this),mobileStickyPlayerOnPage:this._validateMobileStickyPlayerOnPage.bind(this),nativeEnabled:this._validateNativeEnabled.bind(this),outstreamEnabled:this._validateOutstreamEnabled.bind(this),sequence:this._validateSequence.bind(this),sequenceMin:this._validateSequenceMin.bind(this),sequenceMax:this._validateSequenceMax.bind(this),siteIds:this._validateSiteIds.bind(this),sizesAll:this._validateSizesAll.bind(this),sizesAny:this._validateSizesAny.bind(this),stickyOutstreamEnabled:this._validateStickyOutstreamEnabled.bind(this),viewabilityThresholdMet:this._validateViewabilityThresholdMet.bind(this)}),T(this,`generateBids`,(e,t,n,r,i)=>{var a,o,s,c;let l=this._getUnitLocation(n),u={_default:t.placementsLocation._default,_defaultAll:(a=t.placementsLocation._default)==null?void 0:a.applyToAllBids,_defaultAllWithOption:(o=t.placementsLocation._default)==null?void 0:o.applyOptionsToAllBids,all:t.applyToAllBids,allWithOption:t.applyOptionsToAllBids,location:t.placementsLocation[l],locationAll:(s=t.placementsLocation[l])==null?void 0:s.applyToAllBids,locationAllWithOption:(c=t.placementsLocation[l])==null?void 0:c.applyOptionsToAllBids},d=this._getMatchingBids(u,n,r,i),f=this._constructBidParams(e,n,r,i,d);return f}),T(this,`_getMatchingBids`,(e,t,n,r)=>{var i,a;let o=this._filterValidBids((i=e.location)==null?void 0:i.bids,t,n,r),s=o.length===0,c=s?this._filterValidBids((a=e._default)==null?void 0:a.bids,t,n,r):o,l=this._getModifiers(e,t,n,r,s);return this._applyModifiersToPlacements(c,l)}),T(this,`_isBidEligible`,(e,t,n,r,i=!0)=>{var a;let o=(a=i?e.match:e.skip)==null?{}:a,s=!0;for(let a in o){var c,l,u,d;let f=a,p=!this._bidValidator[f],m=o[f],h={value:m,bid:e,unit:t,bidder:n,mediaTypes:r},g=m!==void 0&&i?(c=(l=this._bidValidator)[f])==null?void 0:c.call(l,h):!((u=(d=this._bidValidator)[f])!=null&&u.call(d,h));(p||!g)&&(p&&M.error(`BidFactory`,`_isBidEligible`,`Invalid bid filter key found ${a} for bidder ${n.name}`),s=!1)}return s}),T(this,`_isBidMatch`,(e,t,n,r)=>this._isBidEligible(e,t,n,r)),T(this,`_isBidSkip`,(e,t,n,r)=>this._isBidEligible(e,t,n,r,!1))}_applyGlobalSettingsToBid(e,t){var n;let r=t.reduce((e,t)=>{var n,r,i,a,o;return e.paramLookup={...t.paramLookup,...e.paramLookup},e.retrieveFromFile=[...(n=t.retrieveFromFile)==null?[]:n,...(r=e.retrieveFromFile)==null?[]:r],e.labels=[...(i=t.labels)==null?[]:i,...(a=e.labels)==null?[]:a],e.params={...t.params,...e.params},e.supplemental=(o=e.supplemental)==null?t.supplemental:o,e},this._standardizeBid(e));return r.supplemental=(n=r.supplemental)==null?!0:n,r}_standardizeBid(e){var t,n;return{paramLookup:{...e.paramLookup},retrieveFromFile:[...(t=e.retrieveFromFile)==null?[]:t],labels:[...(n=e.labels)==null?[]:n],params:{...e.params},supplemental:e.supplemental}}_applyModifiersToPlacements(e,t){let n=[],r=[];for(let i of e){let e=this._applyGlobalSettingsToBid(i,t);if(!e.supplemental){n.push(e);break}r.push(e)}return n.length?n:r}_constructBidParams(e,t,n,r,i){return i.forEach(i=>{let a=i;a.mediaTypesList=r,this._replaceMacros(a==null?{}:a,t,n,r),this._paramLookup(a),this._fileRetrieval(a,e,t)}),i}_fileRetrieval(e,t,n){let r=e.retrieveFromFile;if(!(r!=null&&r.length))return;let i=t.getParamValuesFromClient(n,r);e.params={...i,...e.params}}_filterValidBids(e,t,n,r){var i;return(i=e==null?void 0:e.filter(e=>this._isBidMatch(e,t,n,r)&&this._isBidSkip(e,t,n,r)))==null?[]:i}_getModifiers(e,t,n,r,i){var a,o,s;let c=(a=e.all)==null?{}:a,l=this._filterValidBids(e.allWithOption,t,n,r),u=(o=e.locationAll)==null?{}:o,d=this._filterValidBids(e.locationAllWithOption,t,n,r),f=(s=e._defaultAll)==null?{}:s,p=this._filterValidBids(e._defaultAllWithOption,t,n,r);return[{...c},{...i?f:u},...l,...i?p:d]}_getUnitLocation(e){return(`id`in e?e.location:e.name).toLowerCase().replace(`-`,`_`)}_matchWithReverseWildcardPriority(e,t,n){var r;n=(r=n)==null?`-`:r;let i=e.split(n),a=i.length;for(let e=0;e<=a;e++)for(let r=a-e;r>=0;r--){let a=i.map((t,n)=>n>=r&&n<r+e?`*`:t),o=a.join(n);if(t[o]!==void 0)return t[o]}}_paramLookup(e){let t=e.paramLookup;if(!(!t||!Object.keys(t).length))for(let[n,r]of Object.entries(t)){let t=e.params;if(!t)continue;if(typeof t[n]==`string`||typeof t[n]==`number`){let e=r.map,i=r.delimiter,a=this._matchWithReverseWildcardPriority(t[n].toString(),e,i);t[n]=a,t[n]===void 0&&delete t[n]}}}_replaceMacros(e,t,n,r){let i=e.params=e.params||{};for(let[e,a]of Object.entries(i))if(typeof a==`string`){let o=/\{(\w+)\}/g,s=[...a.matchAll(o)],c={params:i,unit:t,bidder:n,mediaTypes:r};if(s.length===1&&a.trim()===`{${s[0][1]}}`){let t=s[0][1];i[e]=this._getValue(t,c)}else i[e]=a.replace(o,(e,t)=>String(this._getValue(t,c)))}}_getValue(e,{params:t,unit:n,bidder:r,mediaTypes:i}){let a=this._macroReplace[e];return typeof a==`function`?a({params:t,unit:n,bidder:r,mediaTypes:i}):`{${e}}`}_isDisplaySlot(e){return`id`in e}_validateAdTypes(e){var t;return!!((t=e.value)!=null&&t.every(e=>this._config.adTypes[e]))}_validateAdTypesAny(e){var t;return!!((t=e.value)!=null&&t.some(e=>this._config.adTypes[e]))}_validateBidderCodes(e){var t;return!!((t=e.value)!=null&&t.some(t=>{var n;return t.toLowerCase()===((n=e.bidder.pbsHost)==null?void 0:n.toLowerCase())||t.toLowerCase()===e.bidder.name.toLowerCase()}))}_validateBrowser(e){var t;return!!((t=e.value)!=null&&t.some(e=>cn().toLowerCase()===e.toLowerCase()))}_validateCountry(e){var t;return!!((t=e.value)!=null&&t.some(e=>{var t;return e.toLowerCase()===((t=this._context.country)==null?void 0:t.toLowerCase())}))}_validateDevice(e){var t,n;let r=tG()&&`mobile`||rG()&&`tablet`||`desktop`;return(t=(n=e.value)==null?void 0:n.includes(r))==null?!0:t}_validateExp(e){var t;return(t=e.value&&Object.entries(e.value).every(([e,t])=>{var n;return((n=this._config.prebid.bidderPlacementsExperimentsResults[e])==null?this._config.prebid.bidderPlacementsExperimentsResultsByLookupKey[e]:n)===t}))==null?!0:t}_validateFeatureRollout(e){var t;return!!((t=e.value)!=null&&t.some(e=>il.isRolloutEnabled(e)))}_validateIntegration(e){var t;return((t=e.value)==null?void 0:t.toLowerCase())===e.bidder.type}_validateLargeFormat(e){return e.value===this._config.adTypes[tG()?`largeFormatsMobile`:`largeFormatsDesktop`]}_validateLazy(e){return e.value===(this._isDisplaySlot(e.unit)?e.unit.lazy:!0)}_validateLocations(e){var t;return!!((t=e.value)!=null&&t.some(t=>t===this._getUnitLocation(e.unit)))}_validateMediatypesAll(e){var t;return!!((t=e.value)!=null&&t.every(t=>e.mediaTypes.includes(t.toLowerCase())))}_validateMediatypesAny(e){var t;return!!((t=e.value)!=null&&t.some(t=>e.mediaTypes.includes(t.toLowerCase())))}_validateMobileStickyPlayerOnPage(e){return e.value===this._config.video.mobileStickyPlayerOnPage}_validateNativeEnabled(e){let t=e.unit,n=`id`in t?t.location:t.name,r=tG()?`Mobile`:`Desktop`;return e.value===!!this._config.adTypes[`native${r}${n}`]}_validateOutstreamEnabled(e){return e.value===!!(`id`in e.unit&&e.unit.outstreamEnabled)}_validateSequence(e){var t;return!!((t=e.value)!=null&&t.some(t=>this._isDisplaySlot(e.unit)?t===e.unit.sequence:!0))}_validateSequenceMin(e){var t,n;return this._isDisplaySlot(e.unit)?((t=e.value)==null?0:t)<=((n=e.unit.sequence)==null?0:n):!0}_validateSequenceMax(e){var t,n;return this._isDisplaySlot(e.unit)?((t=e.value)==null?0:t)>=((n=e.unit.sequence)==null?0:n):!0}_validateSiteIds(e){var t;return!!((t=e.value)!=null&&t.some(e=>e===this._config.site.id))}_validateSizesAll(e){var t;return!!((t=e.value)!=null&&t.every(t=>this._isDisplaySlot(e.unit)?e.unit.sizes.some(e=>e[0]===t[0]&&e[1]===t[1]):e.unit.size[0]===t[0]&&e.unit.size[1]===t[1]))}_validateSizesAny(e){var t;return!!((t=e.value)!=null&&t.some(t=>this._isDisplaySlot(e.unit)?e.unit.sizes.some(e=>e[0]===t[0]&&e[1]===t[1]):e.unit.size[0]===t[0]&&e.unit.size[1]===t[1]))}_validateStickyOutstreamEnabled(e){return e.value===this._config.video.hasStickyOutstream}_validateViewabilityThresholdMet(e){let t=e.unit;if(!this._isDisplaySlot(t))return!0;let n=!1;return(t.highlyViewable||t.lazy||t.viewability>=this._config.marmalade.hvThreshold)&&(n=!0),n}},lk=D([S(),A(`design:paramtypes`,[typeof(sk=z!==void 0&&z)==`function`?sk:Object,typeof(ck=L!==void 0&&L)==`function`?ck:Object])],lk)})),uk,W,dk,fk=o((()=>{X(),ok(),Rt(),Fce(),w(),E(),uk={banner:`banner`,instream:`instream`,native:`native`,outstream:`outstream`,video:`video`,multiformat:`multiformat`,stickyOutstream:`stickyOutstream`},W={banner:`banner`,instream:`instream`,native:`native`,outstream:`outstream`},dk=class extends ak{constructor(e,t){var n;super(e),T(this,`_bidFactory`,void 0),T(this,`_bidMap`,void 0),T(this,`_bidderBidRequestOverrideList`,[P.Triplelift,P.TripleliftServer]),T(this,`_paramKeyMap`,void 0),this._bidFactory=x.resolve(lk),this._bidMap=t.map,this._videoCreativeIds=[...(n=t.videoCreativeIds)==null?[]:n]}getBidRequests(e,t){e.forEach(e=>{let n=this._getUnitEligibleMediaTypes(e),r=this._generateBidParams(e,n);`id`in e?this._getBidderBidRequests(t,r,e.id,e):this._getBidderBidRequests(t,r,e.name)})}_getUnitEligibleMediaTypes(e){let t=[];return`id`in e?(e.location!==F.Video_StickyOutstream&&t.push(W.banner),e.outstreamEnabled&&t.push(W.outstream),e.nativeEnabled&&t.push(W.native)):t.push(W.instream),t}_getBidMediaTypeMap(e){let t=e.includes(W.banner),n=e.includes(W.outstream),r=e.includes(W.native);return e.length===1?{[e[0]]:[e[0]]}:{...t&&{banner:[W.banner]},...n&&{outstream:[W.outstream]},...t&&n&&{multiformatBannerOutstream:[W.banner,W.outstream]},...r&&{native:[W.native]},...t&&r&&{multiformatBannerNative:[W.banner,W.native]}}}getParamValuesFromClient(e,t){let n=t.reduce((t,n)=>{var r;if(typeof((r=this._paramKeyMap)==null?void 0:r[n])==`function`){let r=this._paramKeyMap[n](e);r!==void 0&&(t[n]=r)}return t},{});return n}_validateBids(e,t,n){return t==null?void 0:t.reduce((t,r)=>{var i;let a=r.params||{},o=[],s=Object.keys(a),c=[],l=(i=r.mediaTypesList)==null?[`banner`]:i;return l.forEach(e=>{var t,r,i,a;let o=((t=(r=(i=this._requiredProperties.get(e))==null?void 0:i[n])==null?(a=this._requiredProperties.get(`default`))==null?void 0:a[n]:r)==null?[]:t).filter(e=>!c.includes(e));o.length&&c.push(...o)}),c.forEach(e=>{s.includes(e)||o.push(e)}),o.length?M.error(`Bidder`,`_validateBids`,`${`id`in e?e.id:e.name}`,`invalid bid discarded for ${this.name} ${n} side bidder is missing required ${l.toString()} params: ${o.toString()}`):t.push(r),t},[])}_generateBidParams(e,t){return this._bidders.reduce((n,r)=>{let i=r.pbsHost,a=this._getSlotBidRequests(e,r,t),o=this._validateBids(e,a,r.type);return o==null||o.forEach(t=>{var a;let{params:o,mediaTypesList:s}=t,c=`id`in e&&(s==null?void 0:s.length)===1&&s.includes(W.outstream),l=c?[`outstreamCapable_${e.placementMapName}`,...(a=t.labels)==null?[]:a]:t.labels,u={params:o,bidder:r.name,...i&&{pbsHost:i},...(l==null?void 0:l.length)&&{labelAll:l},mediaTypesList:t.mediaTypesList};n.push(u)}),n},[])}_getSlotBidRequests(e,t,n){let r=[],i=this._getBidMediaTypeMap(n),a=this._mediatypeEnablement,o=this._isBidderOverridden(t.name),s=this._getMultiformatState(i);for(let n in i){let i=n;if(!a.includes(i))continue;this._isMediaTypeEligible(i,s,o)&&r.push(...this._generateBids([i],e,t))}return this._addMultiformatBids(r,e,t,i,s),r}_generateBids(e,t,n){return this._bidFactory.generateBids(this,this._bidMap,t,n,e)}_isBidderOverridden(e){return this._bidderBidRequestOverrideList.includes(e)}_getMultiformatState(e){var t,n;let{native:r,outstream:i}=this._multiformat||{};return{nativeEnabled:!!(r!=null&&r.enabled),nativeBackupOnly:!!(r!=null&&r.backup),outstreamEnabled:!!(i!=null&&i.enabled),outstreamBackupOnly:!!(i!=null&&i.backup),hasMultiformatNative:!!((t=e.multiformatBannerNative)!=null&&t.length)&&!!(r!=null&&r.enabled),hasMultiformatOutstream:!!((n=e.multiformatBannerOutstream)!=null&&n.length)&&!!(i!=null&&i.enabled)}}_isMediaTypeEligible(e,t,n){switch(e){case W.instream:return!0;case W.banner:return this._isBannerEligible(t,n);case W.outstream:return!t.hasMultiformatOutstream||t.hasMultiformatNative&&t.outstreamBackupOnly;case W.native:return!t.hasMultiformatNative||t.hasMultiformatOutstream&&t.nativeBackupOnly;default:return!1}}_isBannerEligible(e,t){let n=e.hasMultiformatOutstream||e.hasMultiformatNative,r=!e.hasMultiformatOutstream&&e.hasMultiformatNative&&t;return!n||r}_addMultiformatBids(e,t,n,r,i){let a=i.hasMultiformatNative&&(!i.hasMultiformatOutstream||!i.nativeBackupOnly),o=i.hasMultiformatOutstream&&(!i.hasMultiformatNative||!i.outstreamBackupOnly);a&&e.push(...this._generateBids(r.multiformatBannerNative,t,n)),o&&e.push(...this._generateBids(r.multiformatBannerOutstream,t,n))}_categorizeBids(e){let t={banner:[],outstream:[],native:[],instream:[],multiformatNative:[],multiformatOutstream:[]};return e.forEach(e=>{var n;let r=(n=e.mediaTypesList)==null?[W.banner]:n,i;i=r.length===1?r[0]:r.includes(W.native)?`multiformatNative`:`multiformatOutstream`,t[i].push(e)}),t}_getBidderBidRequests(e,t,n,r){let i=this._categorizeBids(t==null?[]:t);for(let[t,o]of Object.entries(i)){var a;let i=t,s=this._filterBids(o,n,r),c=(a=e[i])==null?void 0:a.get(n);r&&(s=s==null?void 0:s.reduce((e,t)=>(t&&(this._applyAuctionLabel(r,t),e.push(t)),e),[])),c!=null&&c.length&&(s=(s||[]).concat(c)),s!=null&&s.length&&e[i].set(n,s)}return e}_filterBids(e,t,n){if(!e)return;e=e.filter(e=>e!==void 0);let r=this._config.prebid,{bidders:i,distributedBidders:a}=r.s2s,o=r.ayServerEnabled;return a&&this._preprocessBids(e,i),e.filter(e=>{if(!this._shouldIncludeBidByHoldout(e,t,n))return!1;if(i.includes(e.bidder)){if(a){if(!this._shouldIncludeBidByServer(e,a.rpbsBidders,a.ayBidders)||e.skip)return!1}else if(!!e.pbsHost!=!!o)return!1}return!0})}_shouldIncludeBidByHoldout(e,t,n){let r=this._config,i=Object.values(vW).includes(t),a=i?`vbho`:`hbho`,o=r[a].bidders,s=r.prebid.experimentIntegrationHoldouts,c=this._adapterEnablement.client,l=this._adapterEnablement.server,u=c.enabled&&c.name||l.enabled&&l.name||void 0;return n&&r.trafficShaping.applyTrafficShapingLabel(n,e),!o.includes(u==null?this.name:u)&&!s.includes(e.bidder)&&!o.includes(e.bidder)}_shouldIncludeBidByServer(e,t,n){return e.pbsHost?n.includes(e.bidder):t.includes(e.bidder)}_preprocessBids(e,t){let n=[],r=[`initial`,`refresh`],i=e.some(e=>Mn.includes(e.bidder));if(i){for(let i of e){var a,o;if(!t.includes(i.bidder))continue;let e=((a=i.labelAll)==null?void 0:a.some(e=>r.includes(e)))||((o=i.labelAny)==null?void 0:o.some(e=>r.includes(e)));if(e)continue;n.push(i)}if(n.length>2){n.sort((e,t)=>e.pbsHost===void 0&&t.pbsHost!==void 0?-1:e.pbsHost!==void 0&&t.pbsHost===void 0?1:0);let e=Math.floor(n.length/2),t=Math.random()<.5;for(let r=0;r<e;r++)t?n[r+e].skip=!0:n[r].skip=!0,t=!t}}}}})),pk,mk=o((()=>{E(),pk=class{constructor(e,t){this._config=e,T(this,`_bidMap`,{placementsLocation:{_default:{bids:[]}}}),T(this,`_videoCreativeIds`,void 0),this._bidMap=t}get videoCreativeIds(){return this._videoCreativeIds}get map(){return this._bidMap}}})),hk,gk,_k,Ice=o((()=>{B(),mk(),w(),X(),j(),E(),O(),gk={applyOptionsToAllBids:[{skip:{mediaTypesAll:[`instream`]},params:{productId:`siab`}},{params:{productId:`instream`},match:{mediaTypesAll:[`instream`]}}],placementsLocation:{_default:{bids:[]},content:{applyToAllBids:{paramLookup:{siteId:{map:{1:`dzqsVw_Lqr6iHHaKlId8sQ`,2:`dGYL36_Lqr6iHHaKlId8sQ`,3:`dPmBLW_Lqr6ikXaKkGJozW`,4:`dYmdO4_Lqr6ikXaKkGJozW`,5:`d73_q4_Lqr6ikfaKlId8sQ`,6:`aeCNc8_Lur6ikfaKlId8sQ`,7:`amEJ90_Lur6ikXaKkGJozW`,8:`avcDUU_Lur6ikXaKkGJozW`,9:`aE0F5q_Lur6iHHaKlId8sQ`}}}},bids:[{params:{siteId:`{sequence}`}}]},header:{applyToAllBids:{paramLookup:{siteId:{map:{1:`aZCnyg_Lur6ikfaKlId8sQ`,2:`a7S6ye_Lur6ikXaKkGJozW`}}}},bids:[{params:{siteId:`{sequence}`}}]},footer:{bids:[{params:{siteId:`aMbGkS_Lur6ikXaKkGJozW`}}]},sidebar:{applyToAllBids:{paramLookup:{siteId:{map:{1:`buEy3O_Lur6ikfaKlId8sQ`,2:`bCOsqy_Lur6ikfaKlId8sQ`,3:`bOGvrc_Lur6ikXaKkGJozW`,4:`bW-wb0_Lur6ikfaKlId8sQ`,5:`b8nVxi_Lur6ikXaKkGJozW`,9:`cggK7W_Lur6ikfaKlId8sQ`}}}},bids:[{params:{siteId:`{sequence}`}}]},recipe:{applyToAllBids:{paramLookup:{siteId:{map:{1:`bfXhLW_Lur6ioMaKkGJozW`,2:`bmQVLo_Lur6ikfaKlId8sQ`,3:`d7kcPCUhur6yo-aKkGJozW`,4:`agAjkaUhyr6yo9aKlId8sQ`,5:`a4HY9OrIar8ikorkHcnnVW`}}}},bids:[{params:{siteId:`{placementMapSequence}`}}]},below_post:{bids:[{params:{siteId:`dqjinO_Lqr6i5uaKkv7mNO`}}]},video_collapse_autoplay_soundoff:{bids:[{params:{siteId:`a_lKMg0Iar7k8brkHcnlxd`}}]},video_coll_soff_smartphone:{bids:[{params:{siteId:`b7sKMM0Iar7ikGrkHcnnVW`}}]},video_in_post_clicktoplay_soundon:{bids:[{params:{siteId:`c98www0Iar7ioerkHcnlKl`}}]},video_individual_autoplay_soff:{bids:[{params:{siteId:`bhUZlu0Ier7ioerkHcnlKl`}}]}}},_k=class extends pk{constructor(e){super(e,gk),T(this,`_videoCreativeIds`,[[`138395447475`,P.ThirtyThreeAcross],[`138395937226`,P.ThirtyThreeAcross],[`138395937256`,P.ThirtyThreeAcross],[`138395937310`,P.ThirtyThreeAcross],[`138395937325`,P.ThirtyThreeAcross],[`138395447241`,P.ThirtyThreeAcross],[`138395937274`,P.ThirtyThreeAcross],[`138395937313`,P.ThirtyThreeAcross],[`138395937319`,P.ThirtyThreeAcross],[`138395937343`,P.ThirtyThreeAcross],[`138395937349`,P.ThirtyThreeAcross],[`138395937304`,P.ThirtyThreeAcross],[`138395937307`,P.ThirtyThreeAcross],[`138395937322`,P.ThirtyThreeAcross],[`138395937346`,P.ThirtyThreeAcross],[`138395445846`,P.ThirtyThreeAcross]])}},_k=D([S(),A(`design:paramtypes`,[typeof(hk=z!==void 0&&z)==`function`?hk:Object])],_k)})),vk,yk,bk,Lce=o((()=>{w(),B(),$(),fk(),Fn(),Ice(),j(),E(),O(),bk=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.ThirtyThreeAcross)),T(this,`_adapterEnablement`,{client:{enabled:!1},server:{enabled:!0,name:P.ThirtyThreeAcross}}),T(this,`_bidderCodes`,{primary:P.ThirtyThreeAcross,supplemental:[P.ThirtyThreeAcrossAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`siteId`,`productId`],server:[`siteId`,`productId`]}]]))}get bidderDisplayEnabled(){return!this._config.gdpr.enabled}get bidderInstreamEnabled(){return!!this._config.video.playbackmethod&&!this._config.gdpr.enabled}},bk=D([Q(`ThirtyThreeAcrossBidder`),S(),A(`design:paramtypes`,[typeof(vk=z!==void 0&&z)==`function`?vk:Object,typeof(yk=_k!==void 0&&_k)==`function`?yk:Object])],bk)})),xk,Sk,Ck,Rce=o((()=>{B(),mk(),w(),X(),j(),E(),O(),Sk={placementsLocation:{_default:{bids:[{params:{tagId:`D8WPCjgZ5`}}]}}},Ck=class extends pk{constructor(e){super(e,Sk),T(this,`_videoCreativeIds`,[[`138517239429`,P.AdaptMx],[`138517239558`,P.AdaptMx],[`138517239900`,P.AdaptMx],[`138517239906`,P.AdaptMx],[`138517239912`,P.AdaptMx],[`138517240341`,P.AdaptMx],[`138517240344`,P.AdaptMx],[`138517240347`,P.AdaptMx]])}},Ck=D([S(),A(`design:paramtypes`,[typeof(xk=z!==void 0&&z)==`function`?xk:Object])],Ck)})),wk,Tk,Ek,zce=o((()=>{w(),B(),$(),fk(),Fn(),Rce(),j(),E(),O(),Ek=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.AdaptMx)),T(this,`_adapterEnablement`,{client:{enabled:!1},server:{enabled:!0,name:P.AdaptMx}}),T(this,`_bidderCodes`,{primary:P.AdaptMx,supplemental:[P.AdaptMxAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.instream,W.outstream]),T(this,`_requiredProperties`,new Map([[`default`,{server:[`tagId`]}]]))}},Ek=D([Q(`AdaptMxBidder`),S(),A(`design:paramtypes`,[typeof(wk=z!==void 0&&z)==`function`?wk:Object,typeof(Tk=Ck!==void 0&&Ck)==`function`?Tk:Object])],Ek)})),Dk,Ok,kk,Bce=o((()=>{B(),mk(),w(),X(),j(),E(),O(),Ok={applyOptionsToAllBids:[{params:{mname:`Raptive_Display_RON`},match:{mediaTypesAll:[`banner`]}},{params:{adxDomain:`adx2.adform.net`},match:{country:[`US`],mediaTypesAll:[`banner`]}}],placementsLocation:{_default:{bids:[{params:{mid:1819606},match:{device:[`desktop`,`tablet`],mediaTypesAll:[`banner`]}},{params:{mid:1819607},match:{device:[`mobile`],mediaTypesAll:[`banner`]}},{params:{mid:1819610,mname:`Raptive_Video_RON`,adxDomain:`adx2.adform.net`},match:{mediaTypesAll:[`instream`]}}]},video_stickyoutstream:{bids:[{params:{mid:1819614,mname:`Raptive_StickyOutstream_RON`,adxDomain:`adx2.adform.net`}}]}}},kk=class extends pk{constructor(e){super(e,Ok),T(this,`_videoCreativeIds`,[[`138446479256`,P.Adform],[`138446479406`,P.Adform],[`138446479442`,P.Adform],[`138446479445`,P.Adform],[`138446479505`,P.Adform],[`138446479508`,P.Adform],[`138447155053`,P.Adform],[`138447155056`,P.Adform]])}},kk=D([S(),A(`design:paramtypes`,[typeof(Dk=z!==void 0&&z)==`function`?Dk:Object])],kk)})),Ak,jk,Mk,Nk,Vce=o((()=>{w(),B(),Ra(),$(),Fn(),fk(),Bce(),j(),E(),O(),Nk=class extends dk{constructor(e,t,n){if(super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Adform)),T(this,`gvlid`,50),T(this,`_adapterEnablement`,{client:{enabled:!1},server:{enabled:!0,name:P.Adform}}),T(this,`_bidderCodes`,{primary:P.Adform,supplemental:[P.AdformAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`mname`,`mid`,`adxDomain`],server:[`mname`,`mid`,`adxDomain`]}],[`banner`,{client:[`mname`,`mid`],server:[`mname`,`mid`]}]])),n.country===`US`){var r;let e=(r=this._requiredProperties.get(`banner`))==null?void 0:r.client;e&&(e.push(`adxDomain`),this._requiredProperties.set(`banner`,{client:e,server:e}))}}},Nk=D([Q(`AdformBidder`),S(),A(`design:paramtypes`,[typeof(Ak=z!==void 0&&z)==`function`?Ak:Object,typeof(jk=kk!==void 0&&kk)==`function`?jk:Object,typeof(Mk=L!==void 0&&L)==`function`?Mk:Object])],Nk)})),Pk,Fk,Ik,Hce=o((()=>{B(),mk(),w(),X(),j(),E(),O(),Fk={placementsLocation:{_default:{bids:[{params:{publisherId:`6532804884`,siteId:`{siteId}`,placementId:`{slotId}`}}]}}},Ik=class extends pk{constructor(e){super(e,Fk),T(this,`_videoCreativeIds`,[[`138447954856`,P.AidemServer],[`138447954853`,P.AidemServer],[`138447954850`,P.AidemServer],[`138447954859`,P.AidemServer],[`138447954568`,P.AidemServer],[`138447954574`,P.AidemServer],[`138447954514`,P.AidemServer],[`138447240867`,P.AidemServer]])}},Ik=D([S(),A(`design:paramtypes`,[typeof(Pk=z!==void 0&&z)==`function`?Pk:Object])],Ik)})),Lk,Rk,zk,Bk,Uce=o((()=>{B(),X(),$(),w(),fk(),Ra(),Hce(),j(),E(),O(),Bk=class extends dk{get bidderDisplayEnabled(){let e=this._context.country;return this._allowedCountries.includes(e)}get bidderInstreamEnabled(){let e=this._context.country;return this._allowedCountries.includes(e)}constructor(e,t,n){super(e,t),this._context=n,T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.AidemServer)),T(this,`_adapterEnablement`,{client:{enabled:!1},server:{enabled:!0,name:P.Aidem}}),T(this,`_bidderCodes`,{primary:P.AidemServer,supplemental:[P.AidemAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`publisherId`,`siteId`,`placementId`],server:[`publisherId`,`siteId`,`placementId`]}]])),T(this,`_allowedCountries`,[`GB`,`US`])}},Bk=D([Q(`AidemBidder`),S(),A(`design:paramtypes`,[typeof(Lk=z!==void 0&&z)==`function`?Lk:Object,typeof(Rk=Ik!==void 0&&Ik)==`function`?Rk:Object,typeof(zk=L!==void 0&&L)==`function`?zk:Object])],Bk)})),Vk,Hk,Uk,Wce=o((()=>{B(),mk(),w(),X(),j(),E(),O(),Hk={applyToAllBids:{retrieveFromFile:[`keywords`]},applyOptionsToAllBids:[{params:{allowSmallerSizes:`{allowSmallerAdSizes}`},skip:{mediaTypesAll:[`instream`]}},{params:{position:`above`},match:{viewabilityThresholdMet:!0},skip:{mediaTypesAll:[`instream`]}},{retrieveFromFile:[`video`],params:{position:`above`},match:{mediaTypesAll:[`instream`]}}],placementsLocation:{_default:{bids:[]},content:{applyToAllBids:{paramLookup:{placementId:{map:{"1-*":13036388,"1-*outstream":16808429,"2-*":13036389,"3-*":13036391,"4-*":13036393,"5-*":13036394,"6-*":13036396,"7-*":13036398,"8-*":13036399,"9-*":13036400}}}},bids:[{params:{placementId:`{placementMapSequence}-{mediatype}`},match:{mediaTypesAll:[`banner`]}},{params:{placementId:`{placementMapSequence}-{mediatype}`,playback_method:[`auto_play_sound_off`]},match:{sequence:[1],mediaTypesAll:[`outstream`]}}]},recipe:{applyToAllBids:{paramLookup:{placementId:{map:{1:13036406,2:13036407,3:15014787,4:15998791,5:35983337}}}},bids:[{params:{placementId:`{placementMapSequence}`}}]},footer:{bids:[{params:{placementId:13036401}}]},header:{applyToAllBids:{paramLookup:{placementId:{map:{1:13036404,2:13036405}}}},bids:[{params:{placementId:`{sequence}`}}]},sidebar:{applyToAllBids:{paramLookup:{placementId:{map:{1:13036408,2:13036409,3:13036410,4:13036411,5:13036412,9:13036416}}}},bids:[{params:{placementId:`{sequence}`}}]},below_post:{bids:[{params:{placementId:13036386}}]},interstitial:{bids:[{params:{placementId:21240886}}]},video_stickyoutstream:{bids:[{params:{placementId:22366045}}]},video_collapse_autoplay_soundoff:{bids:[{params:{placementId:15504193,position:`above`,video:{playback_method:[`auto_play_sound_off`]}}}]},video_coll_soff_smartphone:{bids:[{params:{placementId:15504209,position:`above`,video:{playback_method:[`auto_play_sound_off`]}}}]},video_in_post_clicktoplay_soundon:{bids:[{params:{placementId:15504166,position:`above`,video:{playback_method:[`click_to_play`]}}}]},video_individual_autoplay_soff:{bids:[{params:{placementId:17947919,position:`above`,video:{playback_method:[`auto_play_sound_off`]}}}]}}},Uk=class extends pk{constructor(e){super(e,Hk),T(this,`_videoCreativeIds`,[[`138323232312`,P.AppNexus],[`138323908966`,P.AppNexus],[`138323900998`,P.AppNexus],[`138323900548`,P.AppNexus],[`138323457386`,P.AppNexus],[`138323908963`,P.AppNexus],[`138323908960`,P.AppNexus],[`138323901004`,P.AppNexus],[`138323901001`,P.AppNexus],[`138323521089`,P.AppNexus],[`138323457473`,P.AppNexus],[`138323908969`,P.AppNexus],[`138323908957`,P.AppNexus],[`138323908954`,P.AppNexus],[`138323900995`,P.AppNexus],[`138323521092`,P.AppNexus]])}},Uk=D([S(),A(`design:paramtypes`,[typeof(Vk=z!==void 0&&z)==`function`?Vk:Object])],Uk)})),Wk,Gk,Kk,qk,Jk,Gce=o((()=>{B(),Ra(),Fn(),$(),Z(),dn(),w(),fk(),Sg(),Wce(),j(),E(),O(),Jk=class extends dk{constructor(e,t,n,r){super(e,t),this._rfcodes=n,this._context=r,T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.AppNexus)),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.AppNexus},server:{enabled:!0,name:P.AppNexus}}),T(this,`_bidderCodes`,{primary:P.AppNexus,supplemental:[P.AppNexusAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`placementId`,`allowSmallerSizes`,`keywords`],server:[`placementId`,`allowSmallerSizes`,`keywords`]}],[`instream`,{client:[`placementId`,`video`,`keywords`],server:[`placementId`,`video`,`keywords`]}]])),T(this,`_paramKeyMap`,{keywords:this._getKeywordsParam.bind(this),video:this._getVideoParam.bind(this)}),T(this,`_keywords`,{...this._config.site.filteredSensitiveCategories.length&&{sens:this._config.site.filteredSensitiveCategories},bucket:[this._context.bucket],Chrome:[`${Zt()}`],Mobile:[(!!(navigator.userAgent&&navigator.userAgent.search(/Mobi/i)>-1)).toString()],...this._config.site.verticals.length&&{verticals:this._config.site.verticals},mcmp:this._rfcodes.getAllMcmps()}),T(this,`_playbackmethodMap`,new Map([[3,`click_to_play`],[6,`auto_play_sound_off`]])),T(this,`outstreamType`,tG()?`outstreamMobile`:`outstreamDesktop`)}updateBidParams(e){this._addPositionParam(e,`above`)}_getHVP(e){let t=uG(e),n=dG(t);return n.toString()}_getKeywordsParam(e){let t=this._keywords,n={...t,...!t.mcmp.length&&{mcmp:this._rfcodes.getAllMcmps()},...`id`in e&&e.location===`Footer`&&this._getRoadblockDisplayTargeting(e)};return n}_getRoadblockDisplayTargeting(e){return{site_code:this._config.marmalade.filteredRoadblockSiteCodes,pmp_elig:[String(this._config.adOptions.pmp)],hvp:[this._getHVP(e)]}}_getVideoParam(e){var t;let n=`id`in e?e.id:e.name,r=this._config.video.mimeType;return{...r&&{mimes:r},...((t=this._config.video.playbackmethod)==null?void 0:t.get(n))&&{playback_method:this._playbackmethodMap.get(this._config.video.playbackmethod.get(n)[0])},frameworks:this._config.video.apiValue}}},Jk=D([Q(`AppNexusBidder`),S(),A(`design:paramtypes`,[typeof(Wk=z!==void 0&&z)==`function`?Wk:Object,typeof(Gk=Uk!==void 0&&Uk)==`function`?Gk:Object,typeof(Kk=xg!==void 0&&xg)==`function`?Kk:Object,typeof(qk=L!==void 0&&L)==`function`?qk:Object])],Jk)})),Yk,Xk,Zk,Kce=o((()=>{B(),mk(),w(),X(),j(),E(),O(),Xk={placementsLocation:{_default:{bids:[]},video_stickyoutstream:{bids:[{params:{placementId:`358f78e9-4c98-401e-a1da-9bb7cb348d39`},match:{bidderCodes:[P.ConnatixAY]}}]},video_collapse_autoplay_soundoff:{bids:[{params:{placementId:`f3efc93e-f824-4a05-b00d-754b78b652c1`},match:{bidderCodes:[P.ConnatixAY]}}]},video_coll_soff_smartphone:{bids:[{params:{placementId:`649c43f9-8b3a-45f3-bc9e-421973e0f4fb`},match:{bidderCodes:[P.ConnatixAY]}}]},video_in_post_clicktoplay_soundon:{bids:[{params:{placementId:`ba794efe-fe83-41d0-8f02-c9ed40a2cb39`},match:{bidderCodes:[P.ConnatixAY]}}]},video_individual_autoplay_soff:{bids:[{params:{placementId:`d1d9af93-89c6-4c5c-b5af-35a87ad03473`},match:{bidderCodes:[P.ConnatixAY]}}]}}},Zk=class extends pk{constructor(e){super(e,Xk),T(this,`_videoCreativeIds`,[[`138508089465`,P.Connatix],[`138508089483`,P.Connatix],[`138508089486`,P.Connatix],[`138508892635`,P.Connatix],[`138508892647`,P.Connatix],[`138508892650`,P.Connatix],[`138508892653`,P.Connatix],[`138508892656`,P.Connatix]])}},Zk=D([S(),A(`design:paramtypes`,[typeof(Yk=z!==void 0&&z)==`function`?Yk:Object])],Zk)})),Qk,$k,eA,qce=o((()=>{X(),$(),w(),fk(),B(),Kce(),j(),E(),O(),eA=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Connatix)),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.Connatix},server:{enabled:!0,name:P.Connatix}}),T(this,`_bidderCodes`,{primary:P.Connatix,supplemental:[P.ConnatixAY]}),T(this,`_mediatypeEnablement`,[W.outstream,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`placementId`],server:[`placementId`]}]])),T(this,`_settings`,{storageAllowed:[`cookie`]})}},eA=D([Q(`ConnatixBidder`),S(),A(`design:paramtypes`,[typeof(Qk=z!==void 0&&z)==`function`?Qk:Object,typeof($k=Zk!==void 0&&Zk)==`function`?$k:Object])],eA)})),tA,nA,rA,Jce=o((()=>{B(),mk(),w(),j(),O(),nA={applyToAllBids:{params:{site_id:`203587`}},placementsLocation:{_default:{bids:[]},below_post:{bids:[{params:{tag_id:`8c6e3091`}}]},content:{applyToAllBids:{paramLookup:{tag_id:{map:{1:`9cbc79fd`,2:`8c6e3091`,3:`ff6c383c`,4:`972f654c`,5:`bd1aadb5`,6:`ce4f5d6e`,7:`d85e90b`,8:`f02f4ba`,"*":`2c01cbc`}}}},bids:[{params:{tag_id:`{sequence}`}}]},footer:{bids:[{params:{tag_id:`1b2dec1`}}]},header:{applyToAllBids:{paramLookup:{tag_id:{map:{1:`44d21b5`,2:`3488dd9`}}}},bids:[{params:{tag_id:`{sequence}`}}]},recipe:{applyToAllBids:{paramLookup:{tag_id:{map:{1:`f6cf917`,2:`31d9c43`,3:`a7b4d19`,4:`245c673`,"*":`0bf3576`}}}},bids:[{params:{tag_id:`{placementMapSequence}`}}]},sidebar:{applyToAllBids:{paramLookup:{tag_id:{map:{1:`bf73d45`,2:`0a57500`,3:`cceddcd`,4:`872fffd4`,5:`a7653e4`,"*":`517df454`}}}},bids:[{params:{tag_id:`{sequence}`}}]}}},rA=class extends pk{constructor(e){super(e,nA)}},rA=D([S(),A(`design:paramtypes`,[typeof(tA=z!==void 0&&z)==`function`?tA:Object])],rA)})),iA,aA,oA,Yce=o((()=>{w(),B(),$(),fk(),Fn(),Jce(),j(),E(),O(),oA=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Conversant)),T(this,`_adapterEnablement`,{client:{enabled:!1},server:{enabled:!0,name:P.Conversant}}),T(this,`_bidderCodes`,{primary:P.Conversant,supplemental:[P.ConversantAY]}),T(this,`_mediatypeEnablement`,[W.banner]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`tag_id`,`site_id`],server:[`tag_id`,`site_id`]}]]))}},oA=D([Q(`ConversantBidder`),S(),A(`design:paramtypes`,[typeof(iA=z!==void 0&&z)==`function`?iA:Object,typeof(aA=rA!==void 0&&rA)==`function`?aA:Object])],oA)})),sA,cA,lA,Xce=o((()=>{B(),mk(),w(),X(),j(),E(),O(),cA={applyOptionsToAllBids:[{params:{networkId:12180},match:{integration:`server`}}],placementsLocation:{_default:{bids:[{params:{networkId:3927},match:{mediaTypesAll:[`banner`],integration:`client`}},{params:{zoneId:1709027},match:{mediaTypesAll:[`outstream`],integration:`client`},skip:{locations:[`video_stickyoutstream`]}}]},below_post:{applyToAllBids:{paramLookup:{uid:{map:{"0-banner":417066,"0-outstream":417710,"1-banner":417063,"1-outstream":417711}}}},bids:[{params:{uid:`{sequence}-{mediatype}`},match:{sequence:[1],integration:`server`}},{params:{uid:`0-{mediatype}`},match:{integration:`server`},skip:{sequence:[1]}}]},content:{applyToAllBids:{paramLookup:{uid:{map:{"banner-1":417062,"outstream-1":417712,"banner-2":417069,"banner-3":417068,"outstream-3":417713,"banner-4":417070,"banner-5":417064,"outstream-5":417714,"banner-6":417065,"banner-7":417067,"banner-8":417071,"banner-*":417072}}}},bids:[{params:{uid:`{mediatype}-{sequence}`},match:{integration:`server`}}]},footer:{bids:[{params:{uid:417073},match:{mediaTypesAll:[`banner`],integration:`server`}}]},header:{applyToAllBids:{paramLookup:{uid:{map:{1:417074,2:417074}}}},bids:[{params:{uid:`{sequence}`},match:{integration:`server`}}]},sidebar:{applyToAllBids:{paramLookup:{uid:{map:{1:417081,2:417082,3:417083,4:417092,5:417090,"*":417093}}}},bids:[{params:{uid:`{sequence}`},match:{integration:`server`}}]},recipe:{applyToAllBids:{paramLookup:{uid:{map:{"banner-1":417076,"outstream-1":417715,"banner-2":417077,"banner-3":417078,"banner-4":417079,"banner-*":417080}}}},bids:[{params:{uid:`{mediatype}-{placementMapSequence}`},match:{integration:`server`}}]},video_stickyoutstream:{bids:[{params:{zoneId:1709026},match:{integration:`client`}},{params:{uid:417106},match:{integration:`server`}}]},video_collapse_autoplay_soundoff:{bids:[{params:{zoneId:1629631},match:{integration:`client`}},{params:{uid:417103},match:{integration:`server`}}]},video_coll_soff_smartphone:{bids:[{params:{zoneId:1629630},match:{integration:`client`}},{params:{uid:417102},match:{integration:`server`}}]},video_in_post_clicktoplay_soundon:{bids:[{params:{zoneId:1629629},match:{integration:`client`}},{params:{uid:417104},match:{integration:`server`}}]},video_individual_autoplay_soff:{bids:[{params:{zoneId:1629401},match:{integration:`client`}},{params:{uid:417105},match:{integration:`server`}}]}}},lA=class extends pk{constructor(e){super(e,cA),T(this,`_videoCreativeIds`,[[`138381583896`,P.Criteo],[`138381548372`,P.Criteo],[`138381548387`,P.Criteo],[`138381548384`,P.Criteo],[`138381548525`,P.Criteo],[`138381548522`,P.Criteo],[`138381548516`,P.Criteo],[`138381548513`,P.Criteo],[`138382062244`,P.Criteo],[`138382062241`,P.Criteo],[`138382062238`,P.Criteo],[`138382062235`,P.Criteo],[`138382062232`,P.Criteo],[`138382062226`,P.Criteo],[`138382062223`,P.Criteo],[`138381584697`,P.Criteo],[`138485671580`,P.CriteoServer],[`138486258745`,P.CriteoServer],[`138486258748`,P.CriteoServer],[`138486258766`,P.CriteoServer],[`138486258769`,P.CriteoServer],[`138486258772`,P.CriteoServer],[`138486258775`,P.CriteoServer],[`138486259240`,P.CriteoServer]])}},lA=D([S(),A(`design:paramtypes`,[typeof(sA=z!==void 0&&z)==`function`?sA:Object])],lA)})),uA,dA,fA,pA,mA,hA,Zce=o((()=>{w(),B(),Fn(),$(),cw(),so(),fk(),jc(),Xce(),j(),E(),O(),hA=class extends dk{constructor(e,t,n,r,i){super(e,t),this._prebidMethods=n,this._gdprEnforcement=r,this._gdprEvents=i,T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Criteo)),T(this,`gvlid`,91),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.Criteo},server:{enabled:!0,name:P.Criteo}}),T(this,`_bidderCodes`,{primary:P.Criteo,secondary:P.CriteoServer,supplemental:[P.CriteoAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`zoneId`],server:[`networkId`,`uid`]}],[`banner`,{client:[`networkId`],server:[`networkId`,`uid`]}]])),T(this,`_settings`,{storageAllowed:[`html5`]}),this._prebidMethods.setConfig({criteo:{fastBidVersion:`none`}},!1),this._checkConsentAndSetUpInterestGroupIframe().catch(()=>{}),this._config.gdpr.enabled&&this._gdprEvents.consentResponseCaptured.on(()=>{this._checkConsentAndSetUpInterestGroupIframe().catch(()=>{})})}async _checkConsentAndSetUpInterestGroupIframe(){if(this._config.gdpr.enabled){let e=await this._gdprEnforcement.checkConsentForVendor(this._config.gdpr.raptiveVendorId,[1]);if(!e)return}`joinAdInterestGroup`in navigator&&this._setInterestGroupIframe().then(e=>{}).catch(e=>{M.error(`CriteoBidder`,`_setInterestGroupIframe`,e)})}async _setInterestGroupIframe(){let e=document.getElementById(`criteo-ig`);return e||new Promise((e,t)=>{try{let n=document.createElement(`iframe`);n.id=`criteo-ig`,n.style.display=`none`,n.onload=()=>{e(n)},n.onerror=()=>{t(`Interest Group iframe loading failed`)},n.src=`https://gpsb-reims.criteo.com/paapi/join_ig?advertiser_id=500002_500329&ig_name=r6NnpiEx`,document.body.appendChild(n)}catch(e){t(e)}})}},hA=D([Q(`CriteoBidder`),S(),A(`design:paramtypes`,[typeof(uA=z!==void 0&&z)==`function`?uA:Object,typeof(dA=lA!==void 0&&lA)==`function`?dA:Object,typeof(fA=R!==void 0&&R)==`function`?fA:Object,typeof(pA=ow!==void 0&&ow)==`function`?pA:Object,typeof(mA=oo!==void 0&&oo)==`function`?mA:Object])],hA)})),gA,_A,vA,Qce=o((()=>{B(),mk(),w(),j(),O(),_A={applyToAllBids:{retrieveFromFile:[`options`],labels:[`highHVP`]},placementsLocation:{_default:{bids:[]},below_post:{bids:[{params:{siteId:1285424,creativeType:`NativeX`,publisherNameIdentifier:`Raptive Prebid Standard`,options:{startCompact:!1,dwellExpand:!1}},match:{adTypes:[`expandableCatalogAdsDesktop`]},skip:{device:[`mobile`]}},{params:{siteId:1285424,creativeType:`NativeX`,publisherNameIdentifier:`Raptive Prebid Standard`,options:{startCompact:!1,dwellExpand:!1}},match:{adTypes:[`expandableCatalogAdsMobile`],device:[`mobile`]}},{params:{siteId:1285425,creativeType:`NativeX`,publisherNameIdentifier:`Raptive Prebid Compact`,options:{startCompact:!0,dwellExpand:!0}}}]}}},vA=class extends pk{constructor(e){super(e,_A)}},vA=D([S(),A(`design:paramtypes`,[typeof(gA=z!==void 0&&z)==`function`?gA:Object])],vA)})),yA,bA,xA,$ce=o((()=>{IK(),w(),fk(),Tm(),X(),Qce(),Z(),j(),E(),O(),xA=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Flipp)),T(this,`_options`,Hh().get(`test_flipp`)===`true`?{contentCode:`publisher-test`}:{}),T(this,`_adapterEnablement`,{client:{enabled:!1},server:{enabled:!0,name:P.Flipp}}),T(this,`_bidderCodes`,{primary:P.Flipp,supplemental:[P.FlippAY]}),T(this,`_mediatypeEnablement`,[W.banner]),T(this,`_paramKeyMap`,{options:this._getOptionsParam.bind(this)}),T(this,`_requiredProperties`,new Map([[`default`,{client:[`siteId`,`creativeType`,`publisherNameIdentifier`],server:[`siteId`,`creativeType`,`publisherNameIdentifier`]}]]))}get bidderDisplayEnabled(){return this._config.site.filteredSensitiveCategories.includes(`alc`)}_getOptionsParam(){return{...this._options}}},xA=D([Q(`FlippBidder`),S(),A(`design:paramtypes`,[typeof(yA=z!==void 0&&z)==`function`?yA:Object,typeof(bA=vA!==void 0&&vA)==`function`?bA:Object])],xA)})),SA,CA,wA,ele=o((()=>{B(),mk(),w(),X(),j(),E(),O(),CA={placementsLocation:{_default:{bids:[]},footer:{bids:[{params:{zone:`g95nznmj`},match:{integration:`client`,adTypes:[`animatedFooter`]}},{params:{zone:`0yo5ozig`},match:{integration:`server`,adTypes:[`animatedFooter`]},skip:{device:[`mobile`]}},{params:{zone:`nedjcoh9`},match:{integration:`server`,device:[`mobile`],adTypes:[`animatedFooter`]}},{params:{zone:`klpfgzhj`},match:{integration:`client`,adTypes:[`animatedFooter`,`expandableFooter`]}},{params:{zone:`wspaezyl`},match:{integration:`server`,adTypes:[`animatedFooter`,`expandableFooter`]}}]},content:{applyToAllBids:{paramLookup:{slot:{map:{"1-client":913891,"1-client-interscroller":1178411,"2-client":913892,"3-client":913893,"4-client":913894,"5-client":913895,"6-client":913896,"7-client":913897,"8-client":913898,"9-client":913899}},zone:{map:{"client-*":`g95nznmj`,"server-desktop":`0yo5ozig`,"server-mobile":`nedjcoh9`,"client-mobile-interscroller":`yynpv9l1`,"server-mobile-interscroller":`yynpv9l1`}}}},bids:[{params:{zone:`{integration}-{device}`,slot:`{sequence}-{integration}`}},{params:{zone:`{integration}-mobile-interscroller`,slot:`{sequence}-{integration}-interscroller`},match:{sequence:[1],adTypes:[`interscroller`],device:[`mobile`],sizesAll:[[300,250]]}}]},interstitial:{bids:[{params:{zone:`g95nznmj`,slot:110743},match:{integration:`client`}},{params:{zone:`0yo5ozig`},match:{integration:`server`},skip:{device:[`mobile`]}},{params:{zone:`nedjcoh9`},match:{integration:`server`,device:[`mobile`]}}]},video_collapse_autoplay_soundoff:{bids:[{params:{video:`glpmwixo`},match:{integration:`client`}},{params:{video:`glpmwixo`,zone:`0yo5ozig`},match:{integration:`server`}}]},video_coll_soff_smartphone:{bids:[{params:{video:`5zl85htf`},match:{integration:`client`}},{params:{video:`5zl85htf`,zone:`nedjcoh9`},match:{integration:`server`}}]},video_individual_autoplay_soff:{bids:[{params:{video:`5zl85htf`},match:{integration:`client`}},{params:{video:`5zl85htf`,zone:`nedjcoh9`},match:{integration:`server`}}]}}},wA=class extends pk{constructor(e){super(e,CA),T(this,`_videoCreativeIds`,[[`138330842944`,P.GumGum],[`138330432527`,P.GumGum],[`138330466869`,P.GumGum],[`138330842389`,P.GumGum],[`138330842452`,P.GumGum],[`138330432530`,P.GumGum],[`138330432548`,P.GumGum],[`138330432551`,P.GumGum],[`138330466908`,P.GumGum],[`138330842464`,P.GumGum],[`138330842470`,P.GumGum],[`138330466872`,P.GumGum],[`138330842458`,P.GumGum],[`138330842461`,P.GumGum],[`138330842467`,P.GumGum],[`138330842455`,P.GumGum]])}},wA=D([S(),A(`design:paramtypes`,[typeof(SA=z!==void 0&&z)==`function`?SA:Object])],wA)})),TA,EA,DA,tle=o((()=>{w(),B(),$(),Fn(),fk(),ele(),j(),E(),O(),DA=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.GumGum)),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.GumGum},server:{enabled:!0,name:P.GumGum}}),T(this,`_bidderCodes`,{primary:P.GumGum,supplemental:[P.GumGumAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`zone`],server:[`zone`]}],[`instream`,{client:[`video`],server:[`video`]}]]))}},DA=D([Q(`GumGumBidder`),S(),A(`design:paramtypes`,[typeof(TA=z!==void 0&&z)==`function`?TA:Object,typeof(EA=wA!==void 0&&wA)==`function`?EA:Object])],DA)})),OA,kA,AA,nle=o((()=>{B(),mk(),w(),X(),j(),E(),O(),kA={applyToAllBids:{params:{publisherId:2250}},placementsLocation:{_default:{bids:[{params:{placementId:22983142},match:{mediaTypesAll:[`banner`]}},{params:{placementId:23006106},match:{locations:[`video_stickyoutstream`]}},{params:{placementId:22983143},match:{mediaTypesAll:[`instream`]}}]}}},AA=class extends pk{constructor(e){super(e,kA),T(this,`_videoCreativeIds`,[[`138436972580`,P.ImproveDigitalServer],[`138436972724`,P.ImproveDigitalServer],[`138436972727`,P.ImproveDigitalServer],[`138436972736`,P.ImproveDigitalServer],[`138437681002`,P.ImproveDigitalServer],[`138437681251`,P.ImproveDigitalServer],[`138437681254`,P.ImproveDigitalServer],[`138437681257`,P.ImproveDigitalServer]])}},AA=D([S(),A(`design:paramtypes`,[typeof(OA=z!==void 0&&z)==`function`?OA:Object])],AA)})),jA,MA,NA,rle=o((()=>{w(),B(),$(),Fn(),fk(),nle(),j(),E(),O(),NA=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.ImproveDigitalServer)),T(this,`gvlid`,253),T(this,`_adapterEnablement`,{client:{enabled:!1},server:{enabled:!0,name:P.ImproveDigital}}),T(this,`_bidderCodes`,{primary:P.ImproveDigitalServer,supplemental:[P.ImproveDigitalAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`publisherId`,`placementId`],server:[`publisherId`,`placementId`]}]]))}},NA=D([Q(`ImproveDigitalBidder`),S(),A(`design:paramtypes`,[typeof(jA=z!==void 0&&z)==`function`?jA:Object,typeof(MA=AA!==void 0&&AA)==`function`?MA:Object])],NA)})),PA,FA,IA,ile=o((()=>{B(),mk(),w(),X(),j(),E(),O(),FA={placementsLocation:{_default:{bids:[]},below_post:{applyOptionsToAllBids:[{paramLookup:{id:{map:{"728x90-*":`1_1`,"300x250-*":`1_2`}},siteId:{map:{client:`185759`,server:`1170743`}}}}],bids:[{params:{siteId:`{integration}`,id:`728x90-{sequence}`,size:[728,90]},match:{sizesAll:[[728,90]],integration:`client`,mediaTypesAll:[`banner`]}},{params:{siteId:`{integration}`,id:`300x250-{sequence}`,size:[300,250]},match:{sizesAll:[[300,250]],integration:`client`,mediaTypesAll:[`banner`]}},{params:{siteId:`{integration}`},match:{sizesAll:[[300,250],[728,90]],mediaTypesAll:[`banner`],integration:`server`}}]},content:{applyOptionsToAllBids:[{params:{video:{}},match:{sequence:[1],mediaTypesAny:[`outstream`]}},{paramLookup:{size:{map:{"banner-728x250":[728,250],"banner-728x90":[728,90],"banner-300x250":[300,250],"banner-320x480":[320,480],"banner-320x50":[320,50],"banner-320x100":[320,100],"banner-300x50":[300,50],mobile:[320,480],"*":[728,410]}}},match:{integration:`client`,mediaTypesAny:[`banner`,`outstream`]}},{paramLookup:{id:{map:{"728x90-1":`3_1`,"300x250-1":`3_2`,"320x480-1":`3_2`,"320x50-1":`3_4`,"320x100-1":`3_5`,"300x50-1":`3_6`,"728x90-2":`4_1`,"300x250-2":`4_2`,"320x480-2":`4_2`,"320x50-2":`4_4`,"320x100-2":`4_5`,"300x50-2":`4_6`,"300x250-3":`5_1`,"320x50-3":`5_2`,"320x100-3":`5_3`,"300x50-3":`5_4`,"300x250-4":`6_1`,"320x50-4":`6_2`,"320x100-4":`6_3`,"300x50-4":`6_4`,"300x250-5":`7_1`,"320x50-5":`7_2`,"320x100-5":`7_3`,"300x50-5":`7_4`,"300x250-6":`8_1`,"320x50-6":`8_2`,"320x100-6":`8_3`,"300x50-6":`8_4`,"300x250-7":`9_1`,"320x50-7":`9_2`,"300x50-7":`9_3`,"300x250-8":`10_1`,"320x50-8":`10_2`,"300x50-8":`10_3`,"300x250-*":`11_1`,"320x50-*":`11_2`,"300x50-*":`11_3`}},siteId:{map:{"banner-client-1":`185761`,"banner-server-1":`1170753`,"banner-client-2":`185762`,"banner-server-2":`1170757`,"banner-client-3":`185763`,"banner-server-3":`1170760`,"banner-client-4":`185764`,"banner-server-4":`1170761`,"banner-client-5":`185765`,"banner-server-5":`1170762`,"banner-client-6":`185766`,"banner-server-6":`1170763`,"banner-client-7":`185767`,"banner-server-7":`1170764`,"banner-client-8":`185768`,"banner-server-8":`1170744`,"banner-client-*":`185769`,"banner-server-*":`1170745`,"native-client-*":`943837`,"native-server-*":`1170742`,"outstream-client-*":`820298`,"outstream-server-*":`1170771`}}}}],bids:[{params:{siteId:`{mediatype}-{integration}-{sequence}`},match:{mediaTypesAny:[`native`]},skip:{exp:{ixnt:`ec3`}}},{params:{siteId:`{mediatype}-{integration}-{sequence}`},match:{mediaTypesAny:[`native`],sequenceMax:2,exp:{ixnt:`ec3`}}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,size:`{mediatype}-728x250`},match:{sequence:[1],sizesAll:[[728,250]],integration:`client`,mediaTypesAny:[`banner`,`outstream`]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,size:`{mediatype}-728x250`},match:{sizesAll:[[728,250]],integration:`client`,mediaTypesAny:[`banner`]},skip:{sequence:[1]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`728x90-{sequence}`,size:`{mediatype}-728x90`},match:{sequence:[1,2],sizesAll:[[728,90]],integration:`client`,mediaTypesAny:[`banner`,`outstream`]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`300x250-{sequence}`,size:`{mediatype}-300x250`},match:{sequence:[1],sizesAll:[[300,250]],integration:`client`,mediaTypesAny:[`banner`,`outstream`]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`300x250-{sequence}`,size:`{mediatype}-300x250`},match:{sizesAll:[[300,250]],integration:`client`,mediaTypesAny:[`banner`]},skip:{sequence:[1]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`320x50-{sequence}`,size:`{mediatype}-320x50`},match:{sequence:[1],sizesAll:[[320,50]],integration:`client`,mediaTypesAny:[`banner`,`outstream`]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`320x50-{sequence}`,size:`{mediatype}-320x50`},match:{sizesAll:[[320,50]],integration:`client`,mediaTypesAny:[`banner`]},skip:{sequence:[1]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`320x100-{sequence}`,size:`{mediatype}-320x100`},match:{sequence:[1],sizesAll:[[320,100]],integration:`client`,mediaTypesAny:[`banner`,`outstream`]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`320x100-{sequence}`,size:`{mediatype}-320x100`},match:{sequenceMax:6,sizesAll:[[320,100]],integration:`client`,mediaTypesAny:[`banner`]},skip:{sequence:[1]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`300x50-{sequence}`,size:`{mediatype}-300x50`},match:{sequence:[1],sizesAll:[[300,50]],integration:`client`,mediaTypesAny:[`banner`,`outstream`]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`300x50-{sequence}`,size:`{mediatype}-300x50`},match:{sizesAll:[[300,50]],integration:`client`,mediaTypesAny:[`banner`]},skip:{sequence:[1]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`},match:{sequence:[1,2],sizesAny:[[728,90],[300,250],[320,50],[320,100],[300,50],[728,250]],integration:`server`,mediaTypesAny:[`banner`,`outstream`]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`},match:{sequenceMin:3,sequenceMax:6,sizesAny:[[300,250],[320,50],[320,100],[300,50],[728,250]],integration:`server`,mediaTypesAny:[`banner`]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`},match:{sequenceMin:7,sizesAny:[[300,250],[320,50],[300,50],[728,250]],integration:`server`}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,size:`{device}`},match:{sequence:[1],integration:`client`,largeFormat:!0,mediaTypesAny:[`banner`,`outstream`]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,size:`{device}`},match:{sequence:[2],integration:`client`,largeFormat:!0,mediaTypesAny:[`banner`,`outstream`]}}]},footer:{applyOptionsToAllBids:[{paramLookup:{id:{map:{"728x90":`12_1`,"970x90":`12_2`,"320x50":`12_3`,"320x100":`12_4`,"300x50":`12_5`}},siteId:{map:{client:`185770`,server:`1170746`}}}}],bids:[{params:{siteId:`{integration}`,id:`728x90`,size:[728,90]},match:{sizesAll:[[728,90]],integration:`client`}},{params:{siteId:`{integration}`,id:`970x90`,size:[970,90]},match:{sizesAll:[[970,90]],integration:`client`}},{params:{siteId:`{integration}`,id:`320x50`,size:[320,50]},match:{sizesAll:[[320,50]],integration:`client`}},{params:{siteId:`{integration}`,id:`320x100`,size:[320,100]},match:{sizesAll:[[320,100]],integration:`client`}},{params:{siteId:`{integration}`,id:`300x50`,size:[300,50]},match:{sizesAll:[[300,50]],integration:`client`}},{params:{siteId:`{integration}`},match:{sequence:[1],sizesAny:[[728,90],[970,90],[320,50],[320,100],[300,50]],integration:`server`}}]},header:{applyOptionsToAllBids:[{paramLookup:{id:{map:{"728x90":`15_1`,"970x90":`15_2`,"970x250":`15_3`,"320x50":`15_4`,"320x100":`15_5`,"300x50":`15_6`}},siteId:{map:{"*-client-1":`185774`,"*-server-1":`1170747`,"*-client-2":`1265870`,"*-server-2":`1265871`}}}}],bids:[{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`728x90-{sequence}`,size:[728,90]},match:{sizesAll:[[728,90]],integration:`client`}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`970x90-{sequence}`,size:[970,90]},match:{sizesAll:[[970,90]],integration:`client`}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`970x250-{sequence}`,size:[970,250]},match:{sizesAll:[[970,250]],integration:`client`}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`320x50-{sequence}`,size:[320,50]},match:{sizesAll:[[320,50]],integration:`client`}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`320x100-{sequence}`,size:[320,100]},match:{sizesAll:[[320,100]],integration:`client`}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`300x50-{sequence}`,size:[300,50]},match:{sizesAll:[[300,50]],integration:`client`}},{params:{siteId:`{mediatype}-{integration}-{sequence}`},match:{sizesAny:[[728,90],[970,90],[970,250],[320,50],[320,100],[300,50]],integration:`server`}}]},interstitial:{bids:[{params:{siteId:`631834`,id:`36_1`,size:[300,600]},match:{sizesAll:[[300,600]],integration:`client`}},{params:{siteId:`631834`,id:`36_2`,size:[336,280]},match:{sequence:[1],sizesAll:[[336,280]],integration:`client`}},{params:{siteId:`631834`,id:`36_3`,size:[320,480]},match:{sequence:[1],sizesAll:[[320,480]],integration:`client`}},{params:{siteId:`631834`,id:`36_4`,size:[300,250]},match:{sequence:[1],sizesAll:[[300,250]],integration:`client`}},{params:{siteId:`631834`,id:`36_5`,size:[320,50]},match:{sequence:[1],sizesAll:[[320,50]],integration:`client`}}]},recipe:{applyOptionsToAllBids:[{paramLookup:{id:{map:{"300x250-1":`3_2`,"320x50-1":`3_4`,"320x100-1":`3_5`,"300x50-1":`3_6`,"300x250-2":`3_2`,"320x50-2":`3_4`,"320x100-2":`3_5`,"300x50-2":`3_6`,"300x250-3":`3_2`,"320x50-3":`3_4`,"320x100-3":`3_5`,"300x50-3":`3_6`,"300x250-4":`3_2`,"320x50-4":`3_4`,"320x100-4":`3_5`,"300x50-4":`3_6`}},siteId:{map:{"*-client-1":`185776`,"banner-server-1":`1170748`,"banner-client-2":`185777`,"banner-server-2":`1170749`,"banner-client-3":`304909`,"banner-server-3":`1170758`,"banner-client-4":`371523`,"banner-server-4":`1170759`,"banner-client-5":`1265872`,"banner-server-5":`1265873`,"native-client-*":`1094729`,"native-server-*":`1170773`}}}}],bids:[{params:{siteId:`{mediatype}-{integration}-{sequence}`},match:{integration:`client`,mediaTypesAll:[`native`]},skip:{exp:{ixntr:`er3`}}},{params:{siteId:`{mediatype}-{integration}-{sequence}`},match:{integration:`client`,mediaTypesAll:[`native`],sequenceMax:2,exp:{ixntr:`er3`}}},{params:{siteId:`{mediatype}-{integration}-{placementMapSequence}`,id:`300x250-{placementMapSequence}`,size:[300,250]},match:{sizesAll:[[300,250]],integration:`client`,mediaTypesAll:[`banner`]}},{params:{siteId:`{mediatype}-{integration}-{placementMapSequence}`,id:`320x50-{placementMapSequence}`,size:[320,50]},match:{sizesAll:[[320,50]],integration:`client`,mediaTypesAll:[`banner`]}},{params:{siteId:`{mediatype}-{integration}-{placementMapSequence}`,id:`320x100-{placementMapSequence}`,size:[320,100]},match:{sizesAll:[[320,100]],integration:`client`,mediaTypesAll:[`banner`]}},{params:{siteId:`{mediatype}-{integration}-{placementMapSequence}`,id:`300x50-{placementMapSequence}`,size:[300,50]},match:{sizesAll:[[300,50]],integration:`client`,mediaTypesAll:[`banner`]}},{params:{siteId:`{mediatype}-{integration}-{placementMapSequence}`},match:{sizesAny:[[300,250],[320,50],[320,100],[300,50]],integration:`server`,mediaTypesAll:[`banner`]}}]},sidebar:{applyOptionsToAllBids:[{paramLookup:{id:{map:{"300x250-1":`27_1`,"300x600-1":`27_2`,"300x1050-1":`27_3`,"160x600-1":`27_4`,"300x50-1":`27_5`,"300x250-2":`28_1`,"300x600-2":`28_2`,"160x600-2":`28_2`,"300x50-2":`28_4`,"300x250-3":`29_1`,"300x600-3":`29_2`,"160x600-3":`29_3`,"300x50-3":`29_4`,"300x250-4":`30_1`,"300x600-4":`30_2`,"160x600-4":`30_3`,"300x50-4":`30_4`,"300x250-5":`31_1`,"300x600-5":`31_2`,"160x600-5":`31_3`,"300x50-5":`31_4`,"300x250-*":`35_1`,"300x600-*":`35_2`,"300x1050-*":`35_3`,"160x600-*":`35_4`,"300x50-*":`35_5`}},siteId:{map:{"banner-client-1":`185787`,"banner-server-1":`1170750`,"banner-client-2":`185788`,"banner-server-2":`1170751`,"banner-client-3":`185789`,"banner-server-3":`1170752`,"banner-client-4":`185790`,"banner-server-4":`1170754`,"banner-client-5":`185791`,"banner-server-5":`1170755`,"banner-client-*":`185795`,"banner-server-*":`1170756`}}}}],bids:[{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`300x250-{sequence}`,size:[300,250]},match:{sizesAll:[[300,250]],integration:`client`}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`300x600-{sequence}`,size:[300,600]},match:{sizesAll:[[300,600]],integration:`client`}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`300x1050-{sequence}`,size:[300,1050]},match:{sizesAll:[[300,1050]],integration:`client`},skip:{sequence:[2,3,4,5]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`160x600-{sequence}`,size:[160,600]},match:{sequence:[1],sizesAll:[[160,600]],integration:`client`}},{params:{siteId:`{mediatype}-{integration}-{sequence}`,id:`300x50-{sequence}`,size:[300,50]},match:{sequence:[1],sizesAll:[[300,50]],integration:`client`}},{params:{siteId:`{mediatype}-{integration}-{sequence}`},match:{sizesAny:[[300,1050]],integration:`server`},skip:{sequence:[2,3,4,5]}},{params:{siteId:`{mediatype}-{integration}-{sequence}`},match:{sizesAny:[[300,250],[300,600],[160,600],[300,50]],integration:`server`}}]},video_stickyoutstream:{bids:[{params:{siteId:`745167`,id:`48_1`,video:{}},match:{sizesAll:[[300,250]],integration:`client`}},{params:{siteId:`1170775`,video:{}},match:{sizesAll:[[300,250]],integration:`server`}},{params:{siteId:`745167`,id:`48_2`,video:{}},match:{sizesAll:[[300,50]],integration:`client`}},{params:{siteId:`1170775`,video:{}},match:{sizesAll:[[300,50]],integration:`server`}}]},video_collapse_autoplay_soundoff:{bids:[{retrieveFromFile:[`video`],params:{siteId:`185255`,id:`Video_Collapse_Autoplay_SoundOff`,size:[640,360]},match:{sizesAll:[[640,360]],integration:`client`}},{retrieveFromFile:[`video`],params:{siteId:`1170770`,size:[640,360]},match:{sizesAll:[[640,360]],integration:`server`}}]},video_coll_soff_smartphone:{bids:[{retrieveFromFile:[`video`],params:{siteId:`321341`,id:`Video_Coll_SOff_Smartphone`,size:[400,225]},match:{sizesAll:[[400,225]],integration:`client`}},{retrieveFromFile:[`video`],params:{siteId:`1170765`,size:[400,225]},match:{sizesAll:[[400,225]],integration:`server`}}]},video_in_post_clicktoplay_soundon:{bids:[{retrieveFromFile:[`video`],params:{siteId:`385287`,id:`Video_In-Post_ClicktoPlay_SoundOn`,size:[640,360]},match:{integration:`client`},skip:{device:[`mobile`]}},{retrieveFromFile:[`video`],params:{siteId:`385288`,id:`Video_In-Post_ClicktoPlay_SoundOn`,size:[400,225]},match:{integration:`client`,device:[`mobile`]}},{retrieveFromFile:[`video`],params:{siteId:`1170768`,size:[640,360]},match:{integration:`server`},skip:{device:[`mobile`]}},{retrieveFromFile:[`video`],params:{siteId:`1170769`,size:[400,225]},match:{integration:`server`,device:[`mobile`]}}]},video_individual_autoplay_soff:{bids:[{retrieveFromFile:[`video`],params:{siteId:`385285`,id:`Video_Individual_Autoplay_SOff`,size:[640,360]},match:{integration:`client`},skip:{device:[`mobile`]}},{retrieveFromFile:[`video`],params:{siteId:`385286`,id:`Video_Individual_Autoplay_SOff`,size:[400,225]},match:{integration:`client`,device:[`mobile`]}},{retrieveFromFile:[`video`],params:{siteId:`1170766`,size:[640,360]},match:{integration:`server`},skip:{device:[`mobile`]}},{retrieveFromFile:[`video`],params:{siteId:`1170767`,size:[400,225]},match:{integration:`server`,device:[`mobile`]}}]}}},IA=class extends pk{constructor(e){super(e,FA),T(this,`_videoCreativeIds`,[[`138323461889`,P.IndexExchange],[`138365130553`,P.IndexExchange],[`138323602520`,P.IndexExchange],[`138323911414`,P.IndexExchange],[`138365130307`,P.IndexExchange],[`138323648223`,P.IndexExchange],[`138323911009`,P.IndexExchange],[`138364758402`,P.IndexExchange],[`138323523396`,P.IndexExchange],[`138364703774`,P.IndexExchange],[`138323464748`,P.IndexExchange],[`138364758405`,P.IndexExchange],[`138323911423`,P.IndexExchange],[`138365130310`,P.IndexExchange],[`138323911420`,P.IndexExchange],[`138365130313`,P.IndexExchange],[`138323911411`,P.IndexExchange],[`138364758408`,P.IndexExchange],[`138323911012`,P.IndexExchange],[`138364703777`,P.IndexExchange],[`138323523390`,P.IndexExchange],[`138364758411`,P.IndexExchange],[`138323523387`,P.IndexExchange],[`138365130316`,P.IndexExchange],[`138323911426`,P.IndexExchange],[`138364758414`,P.IndexExchange],[`138323911408`,P.IndexExchange],[`138364703780`,P.IndexExchange],[`138323911405`,P.IndexExchange],[`138364703783`,P.IndexExchange],[`138323523393`,P.IndexExchange],[`138364758417`,P.IndexExchange],[`138323911417`,P.IndexExchange],[`138365130319`,P.IndexExchange],[`138500837694`,P.IndexExchangeServer],[`138500837883`,P.IndexExchangeServer],[`138501656857`,P.IndexExchangeServer],[`138501657097`,P.IndexExchangeServer],[`138501657115`,P.IndexExchangeServer],[`138501657118`,P.IndexExchangeServer],[`138501657121`,P.IndexExchangeServer],[`138501657124`,P.IndexExchangeServer]])}},IA=D([S(),A(`design:paramtypes`,[typeof(PA=z!==void 0&&z)==`function`?PA:Object])],IA)})),LA,RA,zA,BA,VA,ale=o((()=>{jc(),B(),Ra(),Fn(),$(),Z(),w(),fk(),ile(),j(),E(),O(),VA=class extends dk{constructor(e,t,n,r){super(e,t),this._prebidMethods=n,this._context=r,T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.IndexExchange)),T(this,`gvlid`,10),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.IndexExchange},server:{enabled:!0,name:P.IndexExchange}}),T(this,`_bidderCodes`,{primary:P.IndexExchange,secondary:P.IndexExchangeServer,supplemental:[P.IndexExchangeAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.native,W.outstream,W.instream]),T(this,`_paramKeyMap`,{video:this._getVideoParam.bind(this)}),T(this,`_requiredProperties`,new Map([[`default`,{client:[`siteId`,`size`],server:[`siteId`]}],[`outstream`,{client:[`siteId`,`video`],server:[`siteId`,`video`]}],[`instream`,{client:[`siteId`,`video`],server:[`siteId`,`video`]}],[`native`,{client:[`siteId`],server:[`siteId`]}]])),T(this,`_device`,Ei()?`desktop`:`mobile`),T(this,`_hasLargeFormatsEnabled`,Ei()?this._config.adTypes.largeFormatsDesktop:this._config.adTypes.largeFormatsMobile)}init(){let e=hG(this._context.savedReferrer),t=this._config,n=t.site,r=[...n.verticals].filter(GW),i=n.filteredSensitiveCategories,a={PD:`${t.adOptions.pmp?``:`no`}${this._context.device}`,...r.length&&{Topic:r.join(`#Topic:`)},...i.length&&{Sens:i.join(`#Sens:`)},Source:zG(e),Browser:cn(),vp:`0`};IG(a,this._prebidMethods),this._largeFormatSizes.length&&LG(this._largeFormatSizes,this._prebidMethods)}get _largeFormatSizes(){return this._hasLargeFormatsEnabled?this._device===`desktop`?[[728,410]]:[[320,480]]:[]}_getVideoParam(e){var t,n;let r=`id`in e?e.id:e.name,i={...this._config.video},a=(t=i.playbackmethod)==null?void 0:t.get(r),o=new Map([[3,[3]],[6,[2]]]),s=a&&{playbackmethod:o.get(a[0])},c=i.mimeType,l=(n=i.videoProtocols)==null?void 0:n.protocols;if(!l){let e=i.videoProtocols?`protocols is undefined`:`videoProtocols is undefined`;M.error(`IndexExchangeBidder`,`getVideoParams`,e)}return{api:i.apiValue,...c&&{mimes:c},...s,minduration:0,maxduration:30,...l&&{protocols:l},pos:i.position.id}}},VA=D([Q(`IndexExchangeBidder`),S(),A(`design:paramtypes`,[typeof(LA=z!==void 0&&z)==`function`?LA:Object,typeof(RA=IA!==void 0&&IA)==`function`?RA:Object,typeof(zA=R!==void 0&&R)==`function`?zA:Object,typeof(BA=L!==void 0&&L)==`function`?BA:Object])],VA)})),HA,UA,WA,GA,KA,ole=o((()=>{B(),mk(),w(),X(),j(),E(),O(),UA={"1-desktop-client-55bccc97303edab84afd77e2":`_hGHupdqGkR`,"1-desktop-client-541917f5a90318f9194874cf":`_tHHlCZoftJ`,"1-desktop-client-5daf495ed42c8605cfc74b0b":`_nVsVVfpDjN`,"1-desktop-client-55cb7e3b4bc841bd0c4ea577":`_iRqGIvmzUs`,"1-desktop-client-566aefa94856897050ee7303":`_nJqZtOhz0Q`,"1-desktop-client-*":`_hIMWOFYOkG`,"1-mobile-client-55bccc97303edab84afd77e2":`_hAsShWhZrX`,"1-mobile-client-541917f5a90318f9194874cf":`_ua1Af0iqiz`,"1-mobile-client-5daf495ed42c8605cfc74b0b":`_lI4BEQnUxI`,"1-mobile-client-55cb7e3b4bc841bd0c4ea577":`_wVm3mYeRml`,"1-mobile-client-566aefa94856897050ee7303":`_jvVwL9Fnun`,"1-mobile-client-*":`_htv2gWQDl4`,"2-desktop-client-55bccc97303edab84afd77e2":`_eD6ub757kw`,"2-desktop-client-541917f5a90318f9194874cf":`_fTyEwORc0V`,"2-desktop-client-5daf495ed42c8605cfc74b0b":`_d3ReNcjIse`,"2-desktop-client-55cb7e3b4bc841bd0c4ea577":`_eWSWxaV6Xx`,"2-desktop-client-566aefa94856897050ee7303":`_k0TLw869op`,"2-desktop-client-*":`_zxmQwsW17E`,"2-mobile-client-55bccc97303edab84afd77e2":`_eD6ub757kw`,"2-mobile-client-541917f5a90318f9194874cf":`_fTyEwORc0V`,"2-mobile-client-5daf495ed42c8605cfc74b0b":`_d3ReNcjIse`,"2-mobile-client-55cb7e3b4bc841bd0c4ea577":`_eWSWxaV6Xx`,"2-mobile-client-566aefa94856897050ee7303":`_k0TLw869op`,"2-mobile-client-*":`_zxmQwsW17E`,"3-desktop-client-55bccc97303edab84afd77e2":`_byCkELixPr`,"3-desktop-client-541917f5a90318f9194874cf":`_q3eCqZRhdS`,"3-desktop-client-5daf495ed42c8605cfc74b0b":`_ohqIx8jj4D`,"3-desktop-client-55cb7e3b4bc841bd0c4ea577":`_c8mUVLDZhB`,"3-desktop-client-566aefa94856897050ee7303":`_hYVLy7Ua4r`,"3-desktop-client-*":`_vzS4k9rMKu`,"3-mobile-client-55bccc97303edab84afd77e2":`_eIhMof7yqe`,"3-mobile-client-541917f5a90318f9194874cf":`_f1sGSYRKR3`,"3-mobile-client-5daf495ed42c8605cfc74b0b":`_qwYKU8Qi3G`,"3-mobile-client-55cb7e3b4bc841bd0c4ea577":`_whqXDci8eJ`,"3-mobile-client-566aefa94856897050ee7303":`_fp2BsPBxqI`,"3-mobile-client-*":`_bDJEtXJaCQ`,"4-desktop-client-55bccc97303edab84afd77e2":`_hqpdpEgPND`,"4-desktop-client-541917f5a90318f9194874cf":`_u8FSFfE7br`,"4-desktop-client-5daf495ed42c8605cfc74b0b":`_eEANDb6t2k`,"4-desktop-client-55cb7e3b4bc841bd0c4ea577":`_jaMt5ZbQgI`,"4-desktop-client-566aefa94856897050ee7303":`_rFrgDRiaQp`,"4-desktop-client-*":`_oCKJ4D9jsI`,"4-mobile-client-55bccc97303edab84afd77e2":`_finwQXYsdW`,"4-mobile-client-541917f5a90318f9194874cf":`_f8CIFfN0X9`,"4-mobile-client-5daf495ed42c8605cfc74b0b":`_agHXJxfEse`,"4-mobile-client-55cb7e3b4bc841bd0c4ea577":`_gSKH6aK6R4`,"4-mobile-client-566aefa94856897050ee7303":`_kIAYcCNe7d`,"4-mobile-client-*":`_rEapvpk6cZ`,"5-desktop-client-55bccc97303edab84afd77e2":`_hDLFEUkifu`,"5-desktop-client-541917f5a90318f9194874cf":`_hDLFEUkifu`,"5-desktop-client-5daf495ed42c8605cfc74b0b":`_hDLFEUkifu`,"5-desktop-client-55cb7e3b4bc841bd0c4ea577":`_hDLFEUkifu`,"5-desktop-client-566aefa94856897050ee7303":`_hDLFEUkifu`,"5-desktop-client-*":`_hDLFEUkifu`,"5-mobile-client-55bccc97303edab84afd77e2":`_ecQ46kpFH4`,"5-mobile-client-541917f5a90318f9194874cf":`_vOhgG6ZGQc`,"5-mobile-client-5daf495ed42c8605cfc74b0b":`_dZU1BlrcQe`,"5-mobile-client-55cb7e3b4bc841bd0c4ea577":`_zcdgs90WxP`,"5-mobile-client-566aefa94856897050ee7303":`_lLcxnJnUL0`,"5-mobile-client-*":`_hDLFEUkifu`,"6-desktop-client-55bccc97303edab84afd77e2":`_kEvPWSnblw`,"6-desktop-client-541917f5a90318f9194874cf":`_kEvPWSnblw`,"6-desktop-client-5daf495ed42c8605cfc74b0b":`_kEvPWSnblw`,"6-desktop-client-55cb7e3b4bc841bd0c4ea577":`_kEvPWSnblw`,"6-desktop-client-566aefa94856897050ee7303":`_kEvPWSnblw`,"6-desktop-client-*":`_kEvPWSnblw`,"6-mobile-client-55bccc97303edab84afd77e2":`_qy8FZvprXY`,"6-mobile-client-541917f5a90318f9194874cf":`_gsOgkDslR3`,"6-mobile-client-5daf495ed42c8605cfc74b0b":`_lGIFrPovZn`,"6-mobile-client-55cb7e3b4bc841bd0c4ea577":`_gn64RSSM57`,"6-mobile-client-566aefa94856897050ee7303":`_gD0lSine9a`,"6-mobile-client-*":`_kEvPWSnblw`,"7-desktop-client-55bccc97303edab84afd77e2":`_fTbDngf8Ub`,"7-desktop-client-541917f5a90318f9194874cf":`_zQGKRsK2OR`,"7-desktop-client-5daf495ed42c8605cfc74b0b":`_pXYJ80T5VN`,"7-desktop-client-55cb7e3b4bc841bd0c4ea577":`_gGD1SYrcGe`,"7-desktop-client-566aefa94856897050ee7303":`_mzspF6n1E6`,"7-desktop-client-*":`_yI7yqradgk`,"7-mobile-client-55bccc97303edab84afd77e2":`_v5SMFEjDrr`,"7-mobile-client-541917f5a90318f9194874cf":`_lX0mmLqXOH`,"7-mobile-client-5daf495ed42c8605cfc74b0b":`_lUXeoSZAf0`,"7-mobile-client-55cb7e3b4bc841bd0c4ea577":`_qQ8NEcQY1C`,"7-mobile-client-566aefa94856897050ee7303":`_kFc3pV1c0n`,"7-mobile-client-*":`_hRaLC9FgYn`,"8-desktop-client-55bccc97303edab84afd77e2":`_baT851TDWI`,"8-desktop-client-541917f5a90318f9194874cf":`_l4gY7l7f5a`,"8-desktop-client-5daf495ed42c8605cfc74b0b":`_d7BTJmSlpc`,"8-desktop-client-55cb7e3b4bc841bd0c4ea577":`_p950SHR2Xv`,"8-desktop-client-566aefa94856897050ee7303":`_lZNyxSw6Ss`,"8-desktop-client-*":`_fPM3feDxUE`,"8-mobile-client-55bccc97303edab84afd77e2":`_r4fIEDQTLY`,"8-mobile-client-541917f5a90318f9194874cf":`_rAF97HOGTF`,"8-mobile-client-5daf495ed42c8605cfc74b0b":`_mqFteTH9Rj`,"8-mobile-client-55cb7e3b4bc841bd0c4ea577":`_qs6lmj0Pbf`,"8-mobile-client-566aefa94856897050ee7303":`_maZsbF5qjH`,"8-mobile-client-*":`_iyznbek6ki`,"9-desktop-client-55bccc97303edab84afd77e2":`_paxUDMm9of`,"9-desktop-client-541917f5a90318f9194874cf":`_iGYXTwKJkq`,"9-desktop-client-5daf495ed42c8605cfc74b0b":`_gaEp6ub3Uz`,"9-desktop-client-55cb7e3b4bc841bd0c4ea577":`_p3pvAJLdvb`,"9-desktop-client-566aefa94856897050ee7303":`_x7OEkwJGD9`,"9-desktop-client-*":`_wtAZ5wepHr`,"9-mobile-client-55bccc97303edab84afd77e2":`_cxVgq7bff1`,"9-mobile-client-541917f5a90318f9194874cf":`_nhQCrEk0GT`,"9-mobile-client-5daf495ed42c8605cfc74b0b":`_yc0KcUV2Sb`,"9-mobile-client-55cb7e3b4bc841bd0c4ea577":`_vwzo4mlIdf`,"9-mobile-client-566aefa94856897050ee7303":`_vKGlgbERMK`,"9-mobile-client-*":`_g1dEyYpnCU`,"10-desktop-client-55bccc97303edab84afd77e2":`_bRbD9p9sZK`,"10-desktop-client-541917f5a90318f9194874cf":`_x8sgYI55G4`,"10-desktop-client-5daf495ed42c8605cfc74b0b":`_d4LW55Tz6Z`,"10-desktop-client-55cb7e3b4bc841bd0c4ea577":`_hhjZvYrxAc`,"10-desktop-client-566aefa94856897050ee7303":`_uEi7eMPnxq`,"10-desktop-client-*":`_kWJDXIuROl`,"11-mobile-client-55bccc97303edab84afd77e2":`_oqaQNDGjZ4`,"11-mobile-client-541917f5a90318f9194874cf":`_g47ukW03bo`,"11-mobile-client-5daf495ed42c8605cfc74b0b":`_ghA53Kjqrh`,"11-mobile-client-55cb7e3b4bc841bd0c4ea577":`_kp8W0sdhdE`,"11-mobile-client-566aefa94856897050ee7303":`_rsmG36HH8x`,"11-mobile-client-*":`_kUg4kKElHf`,"12-desktop-client-55bccc97303edab84afd77e2":`_iSNq3tefXu`,"12-desktop-client-541917f5a90318f9194874cf":`_lCb7dfvNjq`,"12-desktop-client-5daf495ed42c8605cfc74b0b":`_tyYmCc4eCT`,"12-desktop-client-55cb7e3b4bc841bd0c4ea577":`_bB1dCkFu32`,"12-desktop-client-566aefa94856897050ee7303":`_g9cki8b6xC`,"12-desktop-client-*":`_fR1aawM8Zo`,"12-mobile-client-55bccc97303edab84afd77e2":`_tBeS7Z4US3`,"12-mobile-client-541917f5a90318f9194874cf":`_lsGboL0uST`,"12-mobile-client-5daf495ed42c8605cfc74b0b":`_qaJQvOMII9`,"12-mobile-client-55cb7e3b4bc841bd0c4ea577":`_wqAAlYzlij`,"12-mobile-client-566aefa94856897050ee7303":`_zn7ZLevuPn`,"12-mobile-client-*":`_upDLM7q4jV`,"13-desktop-client-55bccc97303edab84afd77e2":`_cSmQNecEfo`,"13-desktop-client-541917f5a90318f9194874cf":`_atcYOwsv5N`,"13-desktop-client-5daf495ed42c8605cfc74b0b":`_qdsWDke6KD`,"13-desktop-client-55cb7e3b4bc841bd0c4ea577":`_eZmQSTrIMN`,"13-desktop-client-566aefa94856897050ee7303":`_gVAQIoM4cp`,"13-desktop-client-*":`_nmpcOw19lD`,"13-mobile-client-55bccc97303edab84afd77e2":`_vWJq7i6Hsr`,"13-mobile-client-541917f5a90318f9194874cf":`_mx5iL6Bejc`,"13-mobile-client-5daf495ed42c8605cfc74b0b":`_uFi5ptAWHm`,"13-mobile-client-55cb7e3b4bc841bd0c4ea577":`_oUwmSg3ct7`,"13-mobile-client-566aefa94856897050ee7303":`_akUrKNgwMu`,"13-mobile-client-*":`_fyab3CymN5`},WA={"1-desktop-server-55bccc97303edab84afd77e2":`_bNu9DxaovG`,"1-desktop-server-541917f5a90318f9194874cf":`_zOvUvvugIj`,"1-desktop-server-5daf495ed42c8605cfc74b0b":`_uo8nEFxOVu`,"1-desktop-server-55cb7e3b4bc841bd0c4ea577":`_yaaHKyz3Zk`,"1-desktop-server-566aefa94856897050ee7303":`_yC15vgTB1T`,"1-desktop-server-*":`_p9dR36E2p7`,"1-mobile-server-55bccc97303edab84afd77e2":`_bNu9DxaovG`,"1-mobile-server-541917f5a90318f9194874cf":`_yiSiyTNTr9`,"1-mobile-server-5daf495ed42c8605cfc74b0b":`_d2hBOhJhxF`,"1-mobile-server-55cb7e3b4bc841bd0c4ea577":`_fK6uPhLCLl`,"1-mobile-server-566aefa94856897050ee7303":`_dzb8opas5y`,"1-mobile-server-*":`_fc3We7MSf8`,"2-desktop-server-55bccc97303edab84afd77e2":`_hXKlqSHoHB`,"2-desktop-server-541917f5a90318f9194874cf":`_gvad3bdvqr`,"2-desktop-server-5daf495ed42c8605cfc74b0b":`_r5n7qvMsMJ`,"2-desktop-server-55cb7e3b4bc841bd0c4ea577":`_kvd1znrrGJ`,"2-desktop-server-566aefa94856897050ee7303":`_lrQyIIv5M6`,"2-desktop-server-*":`_npLCsRl0pb`,"2-mobile-server-55bccc97303edab84afd77e2":`_hXKlqSHoHB`,"2-mobile-server-541917f5a90318f9194874cf":`_gvad3bdvqr`,"2-mobile-server-5daf495ed42c8605cfc74b0b":`_r5n7qvMsMJ`,"2-mobile-server-55cb7e3b4bc841bd0c4ea577":`_kvd1znrrGJ`,"2-mobile-server-566aefa94856897050ee7303":`_lrQyIIv5M6`,"2-mobile-server-*":`_npLCsRl0pb`,"3-desktop-server-55bccc97303edab84afd77e2":`_c0YtPZCFAN`,"3-desktop-server-541917f5a90318f9194874cf":`_wwAn0mcH6d`,"3-desktop-server-5daf495ed42c8605cfc74b0b":`_go3v3cJHBo`,"3-desktop-server-55cb7e3b4bc841bd0c4ea577":`_ry2nukXJCM`,"3-desktop-server-566aefa94856897050ee7303":`_e1zarT1nQu`,"3-desktop-server-*":`_uBJBQkzM4x`,"3-mobile-server-55bccc97303edab84afd77e2":`_lCC4Vz5HVq`,"3-mobile-server-541917f5a90318f9194874cf":`_d6K4oqtod2`,"3-mobile-server-5daf495ed42c8605cfc74b0b":`_ycHhS8LeQg`,"3-mobile-server-55cb7e3b4bc841bd0c4ea577":`_a4F7BDxYvO`,"3-mobile-server-566aefa94856897050ee7303":`_jHYRZMA3Rv`,"3-mobile-server-*":`_mTkU31vSyD`,"4-desktop-server-55bccc97303edab84afd77e2":`_hY1xJfGGVe`,"4-desktop-server-541917f5a90318f9194874cf":`_s5QXHlZsTW`,"4-desktop-server-5daf495ed42c8605cfc74b0b":`_zhrJRRWVYf`,"4-desktop-server-55cb7e3b4bc841bd0c4ea577":`_nn2s0plngX`,"4-desktop-server-566aefa94856897050ee7303":`_cKmNoetgxX`,"4-desktop-server-*":`_pJRjrqANDE`,"4-mobile-server-55bccc97303edab84afd77e2":`_aMXALPX3fS`,"4-mobile-server-541917f5a90318f9194874cf":`_ijhi0w8YvT`,"4-mobile-server-5daf495ed42c8605cfc74b0b":`_l2FGd0utDq`,"4-mobile-server-55cb7e3b4bc841bd0c4ea577":`_ePFeBkTZqT`,"4-mobile-server-566aefa94856897050ee7303":`_wUz9lluZW9`,"4-mobile-server-*":`_d1ofpEpOuE`,"5-desktop-server-55bccc97303edab84afd77e2":`_hDLFEUkifu`,"5-desktop-server-541917f5a90318f9194874cf":`_hDLFEUkifu`,"5-desktop-server-5daf495ed42c8605cfc74b0b":`_hDLFEUkifu`,"5-desktop-server-55cb7e3b4bc841bd0c4ea577":`_hDLFEUkifu`,"5-desktop-server-566aefa94856897050ee7303":`_hDLFEUkifu`,"5-desktop-server-*":`_hDLFEUkifu`,"5-mobile-server-55bccc97303edab84afd77e2":`_cRzdV4tRUN`,"5-mobile-server-541917f5a90318f9194874cf":`_oBErk6NgT9`,"5-mobile-server-5daf495ed42c8605cfc74b0b":`_aGjeC3sjY2`,"5-mobile-server-55cb7e3b4bc841bd0c4ea577":`_sRHWp1P95W`,"5-mobile-server-566aefa94856897050ee7303":`_mKff6SG1V4`,"5-mobile-server-*":`_d4LMbFjRkk`,"6-desktop-server-55bccc97303edab84afd77e2":`_kEvPWSnblw`,"6-desktop-server-541917f5a90318f9194874cf":`_kEvPWSnblw`,"6-desktop-server-5daf495ed42c8605cfc74b0b":`_kEvPWSnblw`,"6-desktop-server-55cb7e3b4bc841bd0c4ea577":`_kEvPWSnblw`,"6-desktop-server-566aefa94856897050ee7303":`_kEvPWSnblw`,"6-desktop-server-*":`_kEvPWSnblw`,"6-mobile-server-55bccc97303edab84afd77e2":`_aYXzmplV9F`,"6-mobile-server-541917f5a90318f9194874cf":`_u5EkrC5vYV`,"6-mobile-server-5daf495ed42c8605cfc74b0b":`_f4bL87KId1`,"6-mobile-server-55cb7e3b4bc841bd0c4ea577":`_yDuCGfXmql`,"6-mobile-server-566aefa94856897050ee7303":`_lx9tkSimU2`,"6-mobile-server-*":`_jiqa71nZQy`,"7-desktop-server-55bccc97303edab84afd77e2":`_rzRzo7jEiB`,"7-desktop-server-541917f5a90318f9194874cf":`_pBJnthmHgl`,"7-desktop-server-5daf495ed42c8605cfc74b0b":`_ndFYWLoiBo`,"7-desktop-server-55cb7e3b4bc841bd0c4ea577":`_yG4Q6pfCcA`,"7-desktop-server-566aefa94856897050ee7303":`_oFaxWSuc5h`,"7-desktop-server-*":`_cw6zRI7FoH`,"7-mobile-server-55bccc97303edab84afd77e2":`_jGV537FxMJ`,"7-mobile-server-541917f5a90318f9194874cf":`_qH1l1kyPi3`,"7-mobile-server-5daf495ed42c8605cfc74b0b":`_jxiRracsTG`,"7-mobile-server-55cb7e3b4bc841bd0c4ea577":`_dbjFQeqonB`,"7-mobile-server-566aefa94856897050ee7303":`_aSfWWLCYIF`,"7-mobile-server-*":`_qkzet6WYFk`,"8-desktop-server-55bccc97303edab84afd77e2":`_qQwA2mxuBj`,"8-desktop-server-541917f5a90318f9194874cf":`_hBe1suFVbp`,"8-desktop-server-5daf495ed42c8605cfc74b0b":`_r9dNt9173p`,"8-desktop-server-55cb7e3b4bc841bd0c4ea577":`_lLRgz2kTfw`,"8-desktop-server-566aefa94856897050ee7303":`_gund5mIKg5`,"8-desktop-server-*":`_uqR67yraqv`,"8-mobile-server-55bccc97303edab84afd77e2":`_ecjCX4kPwm`,"8-mobile-server-541917f5a90318f9194874cf":`_jTzFFJiTJD`,"8-mobile-server-5daf495ed42c8605cfc74b0b":`_vuHz64bKFd`,"8-mobile-server-55cb7e3b4bc841bd0c4ea577":`_lx5UxDlx0g`,"8-mobile-server-566aefa94856897050ee7303":`_vTQcRjZrSS`,"8-mobile-server-*":`_xgNGHBHpEp`,"9-desktop-server-55bccc97303edab84afd77e2":`_uXClSLcqiX`,"9-desktop-server-541917f5a90318f9194874cf":`_ix2Vu5yio6`,"9-desktop-server-5daf495ed42c8605cfc74b0b":`_s1YBpsN41s`,"9-desktop-server-55cb7e3b4bc841bd0c4ea577":`_k5zqurOzN9`,"9-desktop-server-566aefa94856897050ee7303":`_wzZeDPhHwx`,"9-desktop-server-*":`_bSkTYI5gwN`,"9-mobile-server-55bccc97303edab84afd77e2":`_oMCKtxsq0T`,"9-mobile-server-541917f5a90318f9194874cf":`_vg5Tj9cQlS`,"9-mobile-server-5daf495ed42c8605cfc74b0b":`_lhuIK8d0HO`,"9-mobile-server-55cb7e3b4bc841bd0c4ea577":`_ol6ZhRXMRV`,"9-mobile-server-566aefa94856897050ee7303":`_vaUAWXhKWM`,"9-mobile-server-*":`_p2WCSP0fm1`,"10-desktop-server-55bccc97303edab84afd77e2":`_tyXFRsb7b4`,"10-desktop-server-541917f5a90318f9194874cf":`_jg4wlPdEog`,"10-desktop-server-5daf495ed42c8605cfc74b0b":`_vw404TGZKZ`,"10-desktop-server-55cb7e3b4bc841bd0c4ea577":`_rsajlrnhno`,"10-desktop-server-566aefa94856897050ee7303":`_gPZIDLm8j2`,"10-desktop-server-*":`_kkLiJTt47x`,"11-mobile-server-55bccc97303edab84afd77e2":`_cjATjOt7M3`,"11-mobile-server-541917f5a90318f9194874cf":`_jdef3qyaew`,"11-mobile-server-5daf495ed42c8605cfc74b0b":`_xRJtnJlLcg`,"11-mobile-server-55cb7e3b4bc841bd0c4ea577":`_p3pJYWNuxp`,"11-mobile-server-566aefa94856897050ee7303":`_ngr9SeXdE7`,"11-mobile-server-*":`_wraUX6ObGH`,"12-desktop-server-55bccc97303edab84afd77e2":`_zXaUPeITLG`,"12-desktop-server-541917f5a90318f9194874cf":`_cHXAF6BKmN`,"12-desktop-server-5daf495ed42c8605cfc74b0b":`_g2LAwxEvEs`,"12-desktop-server-55cb7e3b4bc841bd0c4ea577":`_sBUGeiExbU`,"12-desktop-server-566aefa94856897050ee7303":`_mBNCdbBCg7`,"12-desktop-server-*":`_j08PBtvK4B`,"12-mobile-server-55bccc97303edab84afd77e2":`_pnaFOGgJHk`,"12-mobile-server-541917f5a90318f9194874cf":`_el6JVb9qoD`,"12-mobile-server-5daf495ed42c8605cfc74b0b":`_pCPyKofX1S`,"12-mobile-server-55cb7e3b4bc841bd0c4ea577":`_dc6prrDilF`,"12-mobile-server-566aefa94856897050ee7303":`_bjw2WhZN1K`,"12-mobile-server-*":`_iNqGr1ZsCR`,"13-desktop-server-55bccc97303edab84afd77e2":`_s5shEWGvJC`,"13-desktop-server-541917f5a90318f9194874cf":`_vx63n2bPCt`,"13-desktop-server-5daf495ed42c8605cfc74b0b":`_ySOwZdo8WZ`,"13-desktop-server-55cb7e3b4bc841bd0c4ea577":`_qxKutqq3kR`,"13-desktop-server-566aefa94856897050ee7303":`_i2ILdAGFrc`,"13-desktop-server-*":`_mX7o0eM1jT`,"13-mobile-server-55bccc97303edab84afd77e2":`_jE3UrcJ5WA`,"13-mobile-server-541917f5a90318f9194874cf":`_rRtn5dy9zf`,"13-mobile-server-5daf495ed42c8605cfc74b0b":`_kCaQmZiXGS`,"13-mobile-server-55cb7e3b4bc841bd0c4ea577":`_bCZv43HA5e`,"13-mobile-server-566aefa94856897050ee7303":`_dZQibxLKPI`,"13-mobile-server-*":`_qeYOrszj4C`},GA={applyOptionsToAllBids:[{paramLookup:{adSlotID:{map:{...WA}},placementId:{map:{...UA}}}}],placementsLocation:{_default:{bids:[]},below_post:{bids:[{params:{adSlotID:`1-desktop-{integration}-{siteId}`,placementId:`1-desktop-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],mediaTypesAll:[`banner`]},skip:{device:[`mobile`],outstreamEnabled:!0}},{params:{adSlotID:`1-mobile-{integration}-{siteId}`,placementId:`1-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`banner`]},skip:{adTypes:[`interscroller`]}},{params:{adSlotID:`6-mobile-{integration}-{siteId}`,placementId:`6-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`banner`],adTypes:[`interscroller`]}},{params:{adSlotID:`4-desktop-{integration}-{siteId}`,placementId:`4-desktop-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],outstreamEnabled:!0,mediaTypesAny:[`banner`,`outstream`]},skip:{device:[`mobile`]}},{params:{adSlotID:`4-mobile-{integration}-{siteId}`,placementId:`4-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`outstream`]},skip:{adTypes:[`interscroller`]}},{params:{placementId:`5-mobile-{integration}-{siteId}`,adSlotID:`5-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`outstream`],adTypes:[`interscroller`]}}]},content:{bids:[{params:{adSlotID:`1-desktop-{integration}-{siteId}`,placementId:`1-desktop-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],mediaTypesAll:[`banner`]},skip:{outstreamEnabled:!0,device:[`mobile`]}},{params:{adSlotID:`1-mobile-{integration}-{siteId}`,placementId:`1-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`banner`],lazy:!1},skip:{sequence:[1]}},{params:{adSlotID:`1-mobile-{integration}-{siteId}`,placementId:`1-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`banner`],lazy:!0},skip:{sequence:[1],adTypes:[`interscroller`]}},{params:{adSlotID:`1-mobile-{integration}-{siteId}`,placementId:`1-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`banner`],sequence:[1]},skip:{adTypes:[`interscroller`]}},{params:{adSlotID:`6-mobile-{integration}-{siteId}`,placementId:`6-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`banner`],adTypes:[`interscroller`],sequence:[1]}},{params:{adSlotID:`6-mobile-{integration}-{siteId}`,placementId:`6-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`banner`],adTypes:[`interscroller`],lazy:!0},skip:{sequence:[1]}},{params:{adSlotID:`4-desktop-{integration}-{siteId}`,placementId:`4-desktop-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],outstreamEnabled:!0,mediaTypesAny:[`banner`,`outstream`]},skip:{device:[`mobile`]}},{params:{adSlotID:`4-mobile-{integration}-{siteId}`,placementId:`4-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`outstream`]},skip:{sequence:[1]}},{params:{adSlotID:`4-mobile-{integration}-{siteId}`,placementId:`4-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`outstream`],sequence:[1]},skip:{adTypes:[`interscroller`]}},{params:{adSlotID:`5-mobile-{integration}-{siteId}`,placementId:`5-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`outstream`],adTypes:[`interscroller`],sequence:[1]}}]},footer:{bids:[{params:{adSlotID:`8-desktop-{integration}-{siteId}`,placementId:`8-desktop-{integration}-{siteId}`},match:{sizesAny:[[320,50]]},skip:{device:[`mobile`]}},{params:{adSlotID:`8-mobile-{integration}-{siteId}`,placementId:`8-mobile-{integration}-{siteId}`},match:{sizesAny:[[320,50]],device:[`mobile`],adTypes:[`animatedFooter`]},skip:{adTypes:[`expandableFooter`]}},{params:{adSlotID:`9-mobile-{integration}-{siteId}`,placementId:`9-mobile-{integration}-{siteId}`},match:{sizesAny:[[320,50]],adTypes:[`expandableFooter`],device:[`mobile`]},skip:{adTypes:[`animatedFooter`]}},{params:{adSlotID:`7-mobile-{integration}-{siteId}`,placementId:`7-mobile-{integration}-{siteId}`},match:{sizesAny:[[320,50]],adTypes:[`animatedFooter`,`expandableFooter`],device:[`mobile`]}}]},header:{bids:[{params:{adSlotID:`3-{device}-{integration}-{siteId}`,placementId:`3-{device}-{integration}-{siteId}`},match:{sizesAny:[[728,90],[320,50]]}}]},recipe:{bids:[{params:{adSlotID:`1-desktop-{integration}-{siteId}`,placementId:`1-desktop-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],mediaTypesAll:[`banner`]},skip:{outstreamEnabled:!0,device:[`mobile`]}},{params:{adSlotID:`1-mobile-{integration}-{siteId}`,placementId:`1-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`banner`]},skip:{sequence:[1]}},{params:{adSlotID:`1-mobile-{integration}-{siteId}`,placementId:`1-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`banner`],sequence:[1]},skip:{outstreamEnabled:!0}},{params:{adSlotID:`4-desktop-{integration}-{siteId}`,placementId:`4-desktop-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],outstreamEnabled:!0,mediaTypesAny:[`banner`,`outstream`]},skip:{device:[`mobile`]}},{params:{adSlotID:`4-mobile-{integration}-{siteId}`,placementId:`4-mobile-{integration}-{siteId}`},match:{sizesAny:[[300,250],[320,50]],device:[`mobile`],mediaTypesAll:[`outstream`]}}]},sidebar:{bids:[{params:{adSlotID:`1-{device}-{integration}-{siteId}`,placementId:`1-{device}-{integration}-{siteId}`},match:{sizesAny:[[320,50]]},skip:{sizesAny:[[300,250],[300,600]]}},{params:{adSlotID:`2-{device}-{integration}-{siteId}`,placementId:`2-{device}-{integration}-{siteId}`},match:{sizesAny:[[300,250],[300,600]],sizesAll:[[320,50]]}},{params:{adSlotID:`2-{device}-{integration}-{siteId}`,placementId:`2-{device}-{integration}-{siteId}`},match:{sizesAny:[[300,250],[300,600]]},skip:{sizesAll:[[320,50]]}}]},video_collapse_autoplay_soundoff:{bids:[{params:{adSlotID:`10-desktop-{integration}-{siteId}`,placementId:`10-desktop-{integration}-{siteId}`}}]},video_coll_soff_smartphone:{bids:[{params:{adSlotID:`11-mobile-{integration}-{siteId}`,placementId:`11-mobile-{integration}-{siteId}`}}]},video_in_post_clicktoplay_soundon:{bids:[{params:{adSlotID:`12-{device}-{integration}-{siteId}`,placementId:`12-{device}-{integration}-{siteId}`}}]},video_individual_autoplay_soff:{bids:[{params:{adSlotID:`13-{device}-{integration}-{siteId}`,placementId:`13-{device}-{integration}-{siteId}`}}]}}},KA=class extends pk{constructor(e){super(e,GA),T(this,`_videoCreativeIds`,[[`138381592896`,P.Kargo],[`138381553202`,P.Kargo],[`138381553217`,P.Kargo],[`138381553238`,P.Kargo],[`138381553328`,P.Kargo],[`138381553214`,P.Kargo],[`138381553235`,P.Kargo],[`138381553244`,P.Kargo],[`138381553331`,P.Kargo],[`138381553334`,P.Kargo],[`138382066465`,P.Kargo],[`138381553241`,P.Kargo],[`138381553325`,P.Kargo],[`138381553337`,P.Kargo],[`138381553340`,P.Kargo],[`138382066468`,P.Kargo]])}},KA=D([S(),A(`design:paramtypes`,[typeof(HA=z!==void 0&&z)==`function`?HA:Object])],KA)})),qA,JA,YA,sle=o((()=>{w(),B(),Fn(),$(),fk(),ole(),j(),E(),O(),YA=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Kargo)),T(this,`gvlid`,972),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.Kargo},server:{enabled:!0,name:P.Kargo}}),T(this,`_bidderCodes`,{primary:P.Kargo}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`placementId`],server:[`adSlotID`]}]])),T(this,`_settings`,{storageAllowed:[`html5`]})}},YA=D([Q(`KargoBidder`),C(),A(`design:paramtypes`,[typeof(qA=z!==void 0&&z)==`function`?qA:Object,typeof(JA=KA!==void 0&&KA)==`function`?JA:Object])],YA)})),XA,ZA,QA,$A=o((()=>{B(),mk(),w(),X(),j(),E(),O(),ZA={placementsLocation:{_default:{bids:[]},below_post:{bids:[{params:{uid:357},match:{mediaTypesAll:[`banner`]}},{params:{uid:415475},match:{mediaTypesAll:[`outstream`]}}]},content:{applyToAllBids:{paramLookup:{uid:{map:{"1-banner":358,"1-outstream":415482,"2-banner":359,"3-banner":360,"3-outstream":415479,"4-banner":361,"5-banner":362,"5-outstream":415481,"6-banner":363,"7-banner":364,"8-banner":365,"9-banner":366}}}},bids:[{params:{uid:`{sequence}-{mediatype}`}}]},footer:{bids:[{params:{uid:367}}]},header:{bids:[{params:{uid:368},match:{sequence:[1]}},{params:{uid:369},match:{sequence:[2]}}]},recipe:{applyToAllBids:{paramLookup:{uid:{map:{"1-banner":370,"1-outstream":420057,"2-banner":371,"3-banner":372,"4-banner":373,"5-banner":374}}}},bids:[{params:{uid:`{placementMapSequence}-{mediatype}`},match:{mediaTypesAll:[`banner`]}}]},sidebar:{applyToAllBids:{paramLookup:{uid:{map:{1:375,2:376,3:377,4:378,5:379,9:380}}}},bids:[{params:{uid:`{placementMapSequence}`}}]},interstitial:{bids:[{params:{uid:48428}}]},video_stickyoutstream:{bids:[{params:{uid:133519}}]},video_collapse_autoplay_soundoff:{bids:[{params:{uid:2163}}]},video_coll_soff_smartphone:{bids:[{params:{uid:2165}}]},video_in_post_clicktoplay_soundon:{bids:[{params:{uid:2164},match:{device:[`desktop`]}},{params:{uid:6056},skip:{device:[`desktop`]}}]},video_individual_autoplay_soff:{bids:[{params:{uid:2166},match:{device:[`desktop`]}},{params:{uid:6057},skip:{device:[`desktop`]}}]}}},QA=class extends pk{constructor(e){super(e,ZA),T(this,`_videoCreativeIds`,[[`138323922262`,P.MediaGridVideo],[`138323922901`,P.MediaGridVideo],[`138323922886`,P.MediaGridVideo],[`138323922898`,P.MediaGridVideo],[`138323922904`,P.MediaGridVideo],[`138323923042`,P.MediaGridVideo],[`138323922889`,P.MediaGridVideo],[`138323923018`,P.MediaGridVideo],[`138323922907`,P.MediaGridVideo],[`138323922859`,P.MediaGridVideo],[`138323923048`,P.MediaGridVideo],[`138323923045`,P.MediaGridVideo],[`138323923051`,P.MediaGridVideo],[`138323923021`,P.MediaGridVideo],[`138323922895`,P.MediaGridVideo],[`138323922892`,P.MediaGridVideo]])}},QA=D([S(),A(`design:paramtypes`,[typeof(XA=z!==void 0&&z)==`function`?XA:Object])],QA)})),ej,tj=o((()=>{fk(),Fn(),E(),ej=class extends dk{constructor(e,t){super(e,t),T(this,`gvlid`,686),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.MediaGrid)),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.MediaGrid},server:{enabled:!0,name:P.MediaGrid}}),T(this,`_requiredProperties`,new Map([[`default`,{client:[`uid`],server:[`uid`]}]]))}}})),nj,rj,ij,cle=o((()=>{w(),B(),$(),fk(),Fn(),tj(),$A(),j(),E(),O(),ij=class extends ej{constructor(e,t){super(e,t),T(this,`_bidderCodes`,{primary:P.MediaGrid,supplemental:[P.MediaGridAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream]),T(this,`_settings`,{adserverTargeting:[{key:`hb_attr`,val:e=>{var t,n;let r=(e==null||(t=e.meta)==null?void 0:t.demandSource)===`trustx`?`trustx_${e.mediaType}`:e.mediaType,i=e==null||(n=e.meta)==null?void 0:n.isInBannerVideo;return i&&(r=`ibv`),r}}]})}},ij=D([Q(`MediaGridBidder`),S(),A(`design:paramtypes`,[typeof(nj=z!==void 0&&z)==`function`?nj:Object,typeof(rj=QA!==void 0&&QA)==`function`?rj:Object])],ij)})),aj,oj,sj,lle=o((()=>{w(),B(),$(),Fn(),tj(),$A(),fk(),j(),E(),O(),sj=class extends ej{constructor(e,t){super(e,t),T(this,`_bidderCodes`,{primary:P.MediaGridVideo}),T(this,`_mediatypeEnablement`,[W.instream])}},sj=D([Q(`MediaGridVideoBidder`),S(),A(`design:paramtypes`,[typeof(aj=z!==void 0&&z)==`function`?aj:Object,typeof(oj=QA!==void 0&&QA)==`function`?oj:Object])],sj)})),cj,lj,uj,ule=o((()=>{B(),mk(),w(),X(),j(),E(),O(),lj={placementsLocation:{_default:{bids:[]},header:{bids:[{params:{},match:{sequence:[1],adTypes:[`nativeMobileHeader`],device:[`mobile`]}},{params:{},match:{sequence:[1],adTypes:[`nativeDesktopHeader`]},skip:{device:[`mobile`]}}]},footer:{bids:[{params:{}}]},sidebar:{bids:[{params:{},match:{sequenceMin:1,sequenceMax:2,adTypes:[`nativeDesktopSidebar`]},skip:{device:[`mobile`]}}]},recipe:{bids:[{params:{},match:{sequenceMin:1,sequenceMax:3,device:[`mobile`],adTypes:[`nativeMobileRecipe`],integration:`client`,mediaTypesAll:[`banner`]}},{params:{},match:{sequenceMin:1,sequenceMax:3,adTypes:[`nativeDesktopRecipe`],integration:`client`,mediaTypesAll:[`banner`]},skip:{device:[`mobile`]}},{params:{},match:{sequenceMin:1,sequenceMax:3,device:[`mobile`],adTypes:[`nativeMobileRecipe`],integration:`server`}},{params:{},match:{sequenceMin:1,sequenceMax:3,adTypes:[`nativeDesktopRecipe`],integration:`server`},skip:{device:[`mobile`]}}]},content:{bids:[{params:{},match:{device:[`mobile`],adTypes:[`nativeMobileContent`],integration:`client`,mediaTypesAll:[`banner`]}},{params:{},match:{adTypes:[`nativeDesktopContent`],integration:`client`,mediaTypesAll:[`banner`]},skip:{device:[`mobile`]}},{params:{},match:{device:[`mobile`],adTypes:[`nativeMobileContent`],integration:`server`}},{params:{},match:{adTypes:[`nativeDesktopContent`],integration:`server`},skip:{device:[`mobile`]}}]},video_stickyoutstream:{bids:[{params:{},match:{integration:`server`}}]},video_collapse_autoplay_soundoff:{bids:[{params:{},match:{integration:`server`}}]},video_coll_soff_smartphone:{bids:[{params:{},match:{integration:`server`}}]},video_in_post_clicktoplay_soundon:{bids:[{params:{},match:{integration:`server`}}]},video_individual_autoplay_soff:{bids:[{params:{},match:{integration:`server`}}]}}},uj=class extends pk{constructor(e){super(e,lj),T(this,`_videoCreativeIds`,[[`138501015328`,P.NativoServer],[`138500434457`,P.NativoServer],[`138500434454`,P.NativoServer],[`138500434427`,P.NativoServer],[`138500433788`,P.NativoServer],[`138500433785`,P.NativoServer],[`138500433770`,P.NativoServer],[`138500198436`,P.NativoServer]])}},uj=D([S(),A(`design:paramtypes`,[typeof(cj=z!==void 0&&z)==`function`?cj:Object])],uj)})),dj,fj,pj,dle=o((()=>{w(),B(),$(),fk(),Fn(),ule(),j(),E(),O(),pj=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Nativo)),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.Nativo},server:{enabled:!0,name:P.Nativo}}),T(this,`_bidderCodes`,{primary:P.Nativo,secondary:P.NativoServer,supplemental:[P.NativoAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream,W.instream]),T(this,`_requiredProperties`,new Map)}},pj=D([Q(`NativoBidder`),S(),A(`design:paramtypes`,[typeof(dj=z!==void 0&&z)==`function`?dj:Object,typeof(fj=uj!==void 0&&uj)==`function`?fj:Object])],pj)})),mj,hj,gj,fle=o((()=>{B(),mk(),w(),X(),j(),E(),O(),hj={applyToAllBids:{params:{delDomain:`cafemedia-d.openx.net`}},applyOptionsToAllBids:[{retrieveFromFile:[`customParams`]},{retrieveFromFile:[`video`],match:{mediaTypesAll:[`instream`]}},{params:{customParams:{hi_au:[`interscroller`]}},match:{adTypes:[`interscroller`],lazy:!0,locations:[`below_post`,`content`]},skip:{adTypes:[`miniscroller`]}},{params:{customParams:{hi_au:[`miniscroller`]}},match:{adTypes:[`miniscroller`],lazy:!0,locations:[`below_post`,`content`]},skip:{adTypes:[`interscroller`]}},{params:{customParams:{hi_au:[`interscroller`,`miniscroller`]}},match:{adTypes:[`interscroller`,`miniscroller`],lazy:!0,locations:[`below_post`,`content`]}}],placementsLocation:{_default:{bids:[]},below_post:{bids:[{params:{unit:`538699862`},match:{bidderCodes:[`openx`]}},{params:{unit:`558245996`},skip:{bidderCodes:[`openx`]}}]},footer:{bids:[{params:{unit:`538699840`},match:{bidderCodes:[`openx`]}},{params:{unit:`558246006`},skip:{bidderCodes:[`openx`]}}]},header:{applyToAllBids:{paramLookup:{unit:{map:{"1-openx":`538699873`,"1-*":`558246007`,"2-openx":`538699874`,"2-*":`558246008`}}}},bids:[{params:{unit:`{sequence}-{biddercode}`}}]},sidebar:{applyToAllBids:{paramLookup:{unit:{map:{"1-openx":`538699853`,"1-*":`558246014`,"2-openx":`538699854`,"2-*":`558246015`,"3-openx":`538699855`,"3-*":`558246016`,"4-openx":`538699856`,"4-*":`558246017`,"5-openx":`538699857`,"5-*":`558246018`,"*-openx":`538699861`,"*-*":`558246019`}}}},bids:[{params:{unit:`{sequence}-{biddercode}`}}]},recipe:{applyToAllBids:{paramLookup:{unit:{map:{"1-openx":`538699843`,"1-*":`558246009`,"2-openx":`538699844`,"2-*":`558246010`,"3-openx":`540594416`,"3-*":`558246011`,"4-openx":`540751624`,"4-*":`558246012`,"5-openx":`540751637`,"5-*":`558246013`}}}},applyOptionsToAllBids:[{params:{customParams:{hi_au:[`miniscroller`]}},match:{adTypes:[`miniscroller`],lazy:!0}}],bids:[{params:{unit:`{placementMapSequence}-{biddercode}`}}]},content:{applyToAllBids:{paramLookup:{unit:{map:{"1-openx":`538699864`,"1-*":`558245997`,"2-openx":`538699865`,"2-*":`558245998`,"3-openx":`538699866`,"3-*":`558245999`,"4-openx":`538699867`,"4-*":`558246000`,"5-openx":`538699868`,"5-*":`558246001`,"6-openx":`538699869`,"6-*":`558246002`,"7-openx":`538699870`,"7-*":`558246003`,"8-openx":`538699871`,"8-*":`558246004`,"*-openx":`538699872`,"*-*":`558246005`}}}},applyOptionsToAllBids:[{params:{customParams:{hi_au:[`interscroller`]}},match:{adTypes:[`interscroller`],sequence:[1]},skip:{adTypes:[`miniscroller`]}},{params:{customParams:{hi_au:[`miniscroller`]}},match:{adTypes:[`miniscroller`],sequence:[1]},skip:{adTypes:[`interscroller`]}},{params:{customParams:{hi_au:[`interscroller, miniscroller`]}},match:{adTypes:[`interscroller, miniscroller`],sequence:[1]}}],bids:[{params:{unit:`{sequence}-{biddercode}`}}]},video_stickyoutstream:{bids:[{params:{unit:`545721971`},match:{bidderCodes:[`openx`]}},{params:{unit:`558246697`},skip:{bidderCodes:[`openx`]}}]},video_collapse_autoplay_soundoff:{bids:[{params:{unit:`540679731`},match:{bidderCodes:[`openx`]}},{params:{unit:`558246727`},skip:{bidderCodes:[`openx`]}}]},video_coll_soff_smartphone:{bids:[{params:{unit:`540679733`},match:{bidderCodes:[`openx`]}},{params:{unit:`558246726`},skip:{bidderCodes:[`openx`]}}]},video_in_post_clicktoplay_soundon:{bids:[{params:{unit:`540679727`},match:{bidderCodes:[`openx`]}},{params:{unit:`558246662`},skip:{bidderCodes:[`openx`]}}]},video_individual_autoplay_soff:{bids:[{params:{unit:`540925853`},match:{bidderCodes:[`openx`]}},{params:{unit:`558246728`},skip:{bidderCodes:[`openx`]}}]},interstitial:{bids:[{params:{unit:`543876568`},match:{bidderCodes:[`openx`]}},{params:{unit:`543876568`},match:{},skip:{bidderCodes:[`openx`]}}]}}},gj=class extends pk{constructor(e){super(e,hj),T(this,`_videoCreativeIds`,[[`138323525262`,P.OpenX],[`138323914702`,P.OpenX],[`138323526741`,P.OpenX],[`138323526186`,P.OpenX],[`138323526738`,P.OpenX],[`138323526744`,P.OpenX],[`138323526747`,P.OpenX],[`138323526189`,P.OpenX],[`138323914588`,P.OpenX],[`138323526192`,P.OpenX],[`138323526750`,P.OpenX],[`138323466806`,P.OpenX],[`138323468969`,P.OpenX],[`138323914705`,P.OpenX],[`138323526183`,P.OpenX],[`138323526753`,P.OpenX],[`138411286398`,P.OpenXServer],[`138411786451`,P.OpenXServer],[`138411286395`,P.OpenXServer],[`138411286392`,P.OpenXServer],[`138411286401`,P.OpenXServer],[`138411286389`,P.OpenXServer],[`13841117744`,P.OpenXServer],[`138411178055`,P.OpenXServer]])}},gj=D([S(),A(`design:paramtypes`,[typeof(mj=z!==void 0&&z)==`function`?mj:Object])],gj)})),_j,vj,yj,bj,ple=o((()=>{w(),B(),Ra(),Fn(),$(),fk(),fle(),j(),E(),O(),bj=class extends dk{constructor(e,t,n){super(e,t),this._context=n,T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.OpenX)),T(this,`gvlid`,69),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.OpenX},server:{enabled:!0,name:P.OpenX}}),T(this,`_bidderCodes`,{primary:P.OpenX,secondary:P.OpenXServer,supplemental:[P.OpenXAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream,W.instream]),T(this,`_paramKeyMap`,{customParams:this._getCustomParamsParam.bind(this),video:this._getVideoParam.bind(this)}),T(this,`_requiredProperties`,new Map([[`default`,{client:[`delDomain`,`unit`,`customParams`],server:[`delDomain`,`unit`,`customParams`]}],[`instream`,{client:[`delDomain`,`unit`,`video`],server:[`delDomain`,`unit`,`video`]}]])),T(this,`_custParams`,{...this._config.site.filteredSensitiveCategories.length&&{sens:this._config.site.filteredSensitiveCategories},bucket:[this._context.bucket]})}_getCustomParamsParam(){return{...this._custParams}}_getVideoParam(e){var t,n;let r=`id`in e?e.id:e.name,i=((t=this._config.video.videoProtocols)==null?void 0:t.scope)===`all`?{protocols:this._config.video.videoProtocols.protocols}:``,a=this._config.video.mimeType;return{...a&&{mimes:a},api:this._config.video.apiValue,...i,pos:this._config.video.position.id,...((n=this._config.video.playbackmethod)==null?void 0:n.get(r))&&{playbackmethod:this._config.video.playbackmethod.get(r)}}}},bj=D([Q(`OpenXBidder`),S(),A(`design:paramtypes`,[typeof(_j=z!==void 0&&z)==`function`?_j:Object,typeof(vj=gj!==void 0&&gj)==`function`?vj:Object,typeof(yj=L!==void 0&&L)==`function`?yj:Object])],bj)})),xj,Sj,Cj,mle=o((()=>{B(),mk(),w(),j(),O(),Sj={placementsLocation:{_default:{bids:[{params:{},match:{mediaTypesAll:[`banner`]}}]}}},Cj=class extends pk{constructor(e){super(e,Sj)}},Cj=D([S(),A(`design:paramtypes`,[typeof(xj=z!==void 0&&z)==`function`?xj:Object])],Cj)})),wj,Tj,Ej,hle=o((()=>{X(),$(),w(),fk(),B(),mle(),j(),E(),O(),Ej=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Ogury)),T(this,`_adapterEnablement`,{client:{enabled:!1},server:{enabled:!0,name:P.Ogury}}),T(this,`_bidderCodes`,{primary:P.Ogury,supplemental:[P.OguryAY]}),T(this,`_mediatypeEnablement`,[W.banner]),T(this,`_requiredProperties`,new Map)}get bidderInstreamEnabled(){return!1}getBannerSlotBidRequests(){return this.bidders.map(e=>{let t=e.pbsHost;return{bidder:e.name,params:{},...t&&{pbsHost:t}}})}},Ej=D([Q(`OguryBidder`),S(),A(`design:paramtypes`,[typeof(wj=z!==void 0&&z)==`function`?wj:Object,typeof(Tj=Cj!==void 0&&Cj)==`function`?Tj:Object])],Ej)})),Dj,Oj,kj,gle=o((()=>{B(),mk(),w(),j(),O(),Oj={applyToAllBids:{params:{publisherId:`OZONERAP0001`,siteId:`1500000160`}},placementsLocation:{_default:{bids:[]},below_post:{bids:[{params:{placementId:`3500013108`},match:{sequence:[1]},skip:{mediaTypesAll:[`outstream`]}},{params:{placementId:`3500013107`},skip:{mediaTypesAll:[`outstream`],sequence:[1]}}]},footer:{bids:[{params:{placementId:`3500013109`}}]},header:{bids:[{params:{placementId:`3500013099`},match:{sequence:[1]}},{params:{placementId:`3500013100`},match:{sequence:[2]}}]},sidebar:{applyToAllBids:{paramLookup:{placementId:{map:{1:`3500013101`,2:`3500013102`,3:`3500013103`,4:`3500013104`,5:`3500013105`,"*":`3500013106`}}}},bids:[{params:{placementId:`{sequence}`}}]},recipe:{applyToAllBids:{paramLookup:{placementId:{map:{1:`3500013110`,2:`3500013111`,3:`3500013112`,4:`3500013113`,"*":`3500013114`}}}},bids:[{params:{placementId:`{placementMapSequence}`},skip:{mediaTypesAll:[`outstream`]}}]},content:{applyToAllBids:{paramLookup:{placementId:{map:{1:`3500013090`,2:`3500013091`,3:`3500013092`,4:`3500013093`,5:`3500013094`,6:`3500013095`,7:`3500013096`,8:`3500013097`,"*":`3500013098`}}}},bids:[{params:{placementId:`{sequence}`},skip:{mediaTypesAll:[`outstream`]}}]},video_stickyoutstream:{bids:[{params:{placementId:`1500000360`}}]}}},kj=class extends pk{constructor(e){super(e,Oj)}},kj=D([S(),A(`design:paramtypes`,[typeof(Dj=z!==void 0&&z)==`function`?Dj:Object])],kj)})),Aj,jj,Mj,Nj,_le=o((()=>{B(),Ra(),X(),$(),w(),fk(),gle(),j(),E(),O(),Nj=class extends dk{constructor(e,t,n){super(e,t),this._context=n,T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Ozone)),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.OpenX},server:{enabled:!1}}),T(this,`_bidderCodes`,{primary:P.Ozone}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`publisherId`,`siteId`,`placementId`],server:[`publisherId`,`siteId`,`placementId`]}]]))}get bidderDisplayEnabled(){return this._isCountryValid()}_isCountryValid(){let e=this._config;switch(this._context.country){case`GB`:return e.gdpr.enabled;case`CA`:return!0;default:return!1}}},Nj=D([Q(`OzoneBidder`),S(),A(`design:paramtypes`,[typeof(Aj=z!==void 0&&z)==`function`?Aj:Object,typeof(jj=kj!==void 0&&kj)==`function`?jj:Object,typeof(Mj=L!==void 0&&L)==`function`?Mj:Object])],Nj)})),Pj,Fj,Ij,vle=o((()=>{B(),mk(),w(),X(),j(),E(),O(),Fj={applyToAllBids:{retrieveFromFile:[`pmzoneid`],params:{publisherId:`157347`}},applyOptionsToAllBids:[{retrieveFromFile:[`video`,`dctr`],match:{mediaTypesAll:[`instream`]}}],placementsLocation:{_default:{bids:[]},video_stickyoutstream:{bids:[{params:{adSlot:`2267845`},match:{integration:`client`}},{params:{adSlot:`4018943`},match:{integration:`server`}}]},video_collapse_autoplay_soundoff:{bids:[{params:{adSlot:`1961309`},match:{integration:`client`}},{params:{adSlot:`3437231`},match:{integration:`server`}}]},video_coll_soff_smartphone:{bids:[{params:{adSlot:`1961310`},match:{integration:`client`}},{params:{adSlot:`3437234`},match:{integration:`server`}}]},video_in_post_clicktoplay_soundon:{bids:[{params:{adSlot:`1961308`},match:{integration:`client`}},{params:{adSlot:`3437232`},match:{integration:`server`}}]},video_individual_autoplay_soff:{bids:[{params:{adSlot:`2503033`},match:{integration:`client`}},{params:{adSlot:`3443766`},match:{integration:`server`}}]},below_post:{bids:[{params:{adSlot:`BelowPost1`},match:{integration:`client`}},{params:{adSlot:`BelowPost1_XandrS2S`},match:{integration:`server`}}]},footer:{bids:[{params:{adSlot:`Footer1`},match:{integration:`client`}},{params:{adSlot:`Footer1_XandrS2S`},match:{integration:`server`}}]},header:{bids:[{params:{adSlot:`Header{sequence}`},match:{integration:`client`}},{params:{adSlot:`Header{sequence}_XandrS2S`},match:{integration:`server`}}]},sidebar:{bids:[{params:{adSlot:`Sidebar{placementMapSequence}`},match:{integration:`client`}},{params:{adSlot:`Sidebar{placementMapSequence}_XandrS2S`},match:{integration:`server`}}]},recipe:{bids:[{params:{adSlot:`Recipe{placementMapSequence}`},match:{integration:`client`,mediaTypesAll:[`banner`]},skip:{sequence:[5]}},{params:{adSlot:`Recipe{placementMapSequence}_XandrS2S`},match:{integration:`server`,mediaTypesAll:[`banner`]},skip:{sequence:[5]}},{params:{adSlot:`Recipe{placementMapSequence}_Native`},match:{integration:`client`,mediaTypesAll:[`native`]}},{params:{adSlot:`Recipe{placementMapSequence}_Native_S2S`},match:{integration:`server`,mediaTypesAll:[`native`]}}]},content:{bids:[{params:{adSlot:`Content{placementMapSequence}`},match:{integration:`client`,mediaTypesAll:[`banner`]}},{params:{adSlot:`Content{placementMapSequence}_XandrS2S`},match:{integration:`server`,mediaTypesAll:[`banner`]}},{params:{adSlot:`Content{placementMapSequence}_Native`},match:{integration:`client`,mediaTypesAll:[`native`]}},{params:{adSlot:`Content{placementMapSequence}_Native_S2S`},match:{integration:`server`,mediaTypesAll:[`native`]}}]}}},Ij=class extends pk{constructor(e){super(e,Fj),T(this,`_videoCreativeIds`,[[`138323526825`,P.Pubmatic],[`138323915419`,P.Pubmatic],[`138323915299`,P.Pubmatic],[`138323527095`,P.Pubmatic],[`138323469392`,P.Pubmatic],[`138323915422`,P.Pubmatic],[`138323469395`,P.Pubmatic],[`138323469389`,P.Pubmatic],[`138323469383`,P.Pubmatic],[`138323469320`,P.Pubmatic],[`138323469317`,P.Pubmatic],[`138323527092`,P.Pubmatic],[`138323469401`,P.Pubmatic],[`138323469398`,P.Pubmatic],[`138323469386`,P.Pubmatic],[`138323469404`,P.Pubmatic],[`138337271609`,P.PubmaticServer],[`138337343196`,P.PubmaticServer],[`138337343229`,P.PubmaticServer],[`138337720879`,P.PubmaticServer],[`138337720885`,P.PubmaticServer],[`138337343202`,P.PubmaticServer],[`138337343211`,P.PubmaticServer],[`138337343217`,P.PubmaticServer],[`138337343232`,P.PubmaticServer],[`138337720597`,P.PubmaticServer],[`138337720888`,P.PubmaticServer],[`138337343199`,P.PubmaticServer],[`138337343214`,P.PubmaticServer],[`138337343223`,P.PubmaticServer],[`138337343226`,P.PubmaticServer],[`138337343220`,P.PubmaticServer]])}},Ij=D([S(),A(`design:paramtypes`,[typeof(Pj=z!==void 0&&z)==`function`?Pj:Object])],Ij)})),Lj,Rj,zj,Bj,Vj,yle=o((()=>{w(),B(),$(),vg(),Fn(),fk(),Dg(),vle(),j(),E(),O(),Vj=class extends dk{constructor(e,t,n,r){super(e,t),this._irisTvTracker=n,this._pubMaticBcatExperiment=r,T(this,`multiformatBidder`,!0),T(this,`multiformatBannerVideoBidder`,!0),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Pubmatic)),T(this,`gvlid`,76),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.Pubmatic},server:{enabled:!0,name:P.Pubmatic}}),T(this,`_bidderCodes`,{primary:P.Pubmatic,secondary:P.PubmaticServer,supplemental:[P.PubmaticAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.native,W.outstream,W.instream]),T(this,`_multiformat`,{outstream:{enabled:!0}}),T(this,`_requiredProperties`,new Map([[`default`,{client:[`publisherId`,`adSlot`],server:[`publisherId`,`adSlot`]}],[`instream`,{client:[`publisherId`,`adSlot`,`video`],server:[`publisherId`,`adSlot`,`video`]}]])),T(this,`_paramKeyMap`,{dctr:this._getDCTRParam.bind(this),pmzoneid:this._getPMZoneIdParam.bind(this),video:this._getVideoParam.bind(this)})}_getDCTRParam(){let e=[],t=this._irisTvTracker.enabled?this._irisTvTracker.irisContextualData:void 0;return t!=null&&t.length&&e.push(`iris_context=${t.toString()}`),e.join(`|`)}_getPMZoneIdParam(){return this._config.site.filteredSensitiveCategories.length>0&&this._shouldSendPMZoneId()?this._config.site.filteredSensitiveCategories.join(`,`):void 0}_getVideoParam(e){var t,n;let r=this._config.video.mimeType;return{...r&&{mimes:r},api:this._config.video.apiValue,...((t=this._config.video.videoProtocols)==null?void 0:t.scope)===`all`&&{protocols:this._config.video.videoProtocols.protocols},...((n=this._config.video.playbackmethod)==null?void 0:n.get(e.name))&&{playbackmethod:this._config.video.playbackmethod.get(e.name)}}}_shouldSendPMZoneId(){return this._pubMaticBcatExperiment.result!==`bc`}},Vj=D([Q(`PubMaticBidder`),S(),A(`design:paramtypes`,[typeof(Lj=z!==void 0&&z)==`function`?Lj:Object,typeof(Rj=Ij!==void 0&&Ij)==`function`?Rj:Object,typeof(zj=_g!==void 0&&_g)==`function`?zj:Object,typeof(Bj=Eg!==void 0&&Eg)==`function`?Bj:Object])],Vj)})),Hj,Uj,Wj,ble=o((()=>{B(),mk(),w(),X(),j(),E(),O(),Uj={placementsLocation:{_default:{bids:[{params:{org:`670f50ccaaffbb00017d70d5`},match:{mediaTypesAny:[`banner`,`instream`]}}]}}},Wj=class extends pk{constructor(e){super(e,Uj),T(this,`_videoCreativeIds`,[[`138495438845`,P.Rise],[`138495438842`,P.Rise],[`138495438824`,P.Rise],[`138495438689`,P.Rise],[`138495438686`,P.Rise],[`138495438653`,P.Rise],[`138495438416`,P.Rise],[`138495437750`,P.Rise]])}},Wj=D([S(),A(`design:paramtypes`,[typeof(Hj=z!==void 0&&z)==`function`?Hj:Object])],Wj)})),Gj,Kj,qj,Jj,xle=o((()=>{w(),B(),$(),fk(),Fn(),Ra(),ble(),j(),E(),O(),Jj=class extends dk{constructor(e,t,n){super(e,t),this._context=n,T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Rise)),T(this,`_adapterEnablement`,{client:{enabled:!1},server:{enabled:!0,name:P.Rise}}),T(this,`_bidderCodes`,{primary:P.Rise,supplemental:[P.RiseAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`org`],server:[`org`]}]]))}get bidderDisplayEnabled(){return this._context.country===`US`}get bidderInstreamEnabled(){return this._context.country===`US`}},Jj=D([Q(`RiseBidder`),S(),A(`design:paramtypes`,[typeof(Gj=z!==void 0&&z)==`function`?Gj:Object,typeof(Kj=Wj!==void 0&&Wj)==`function`?Kj:Object,typeof(qj=L!==void 0&&L)==`function`?qj:Object])],Jj)})),Yj,Sle=o((()=>{Ui(),w(),E(),O(),Yj=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`RtbHouseExperiment`,this._lookup=`RTBF`}},Yj=D([C()],Yj)})),Xj,Zj,Qj,Cle=o((()=>{B(),mk(),w(),j(),O(),Zj={placementsLocation:{_default:{bids:[{params:{publisherId:`puHY4pgB9FOPeQBYYZEM`,region:`prebid-us`},match:{mediaTypesAny:[`banner`]}}]}}},Qj=class extends pk{constructor(e){super(e,Zj)}},Qj=D([S(),A(`design:paramtypes`,[typeof(Xj=z!==void 0&&z)==`function`?Xj:Object])],Qj)})),$j,eM,tM,nM,wle=o((()=>{w(),B(),$(),Fn(),fk(),Sle(),Cle(),j(),E(),O(),nM=class extends dk{constructor(e,t,n){super(e,t),this._rtbHouseExperiment=n,T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Rtbhouse)),T(this,`gvlid`,16),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.Rtbhouse},server:{enabled:!1}}),T(this,`_bidderCodes`,{primary:P.Rtbhouse}),T(this,`_mediatypeEnablement`,[W.banner]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`publisherId`,`region`],server:[`publisherId`,`region`]}]]))}get bidderDisplayEnabled(){let e=this._config;return this._rtbHouseExperiment.result&&e.fledge.enabled}},nM=D([Q(`RtbHouseBidder`),S(),A(`design:paramtypes`,[typeof($j=z!==void 0&&z)==`function`?$j:Object,typeof(eM=Qj!==void 0&&Qj)==`function`?eM:Object,typeof(tM=Yj!==void 0&&Yj)==`function`?tM:Object])],nM)})),rM,iM,aM,Tle=o((()=>{B(),mk(),w(),X(),j(),E(),O(),iM={applyToAllBids:{params:{accountId:9262}},applyOptionsToAllBids:[{params:{position:`atf`},match:{mediaTypesAny:[`banner`,`outstream`,`native`],viewabilityThresholdMet:!0}},{params:{bidonmultiformat:!0},match:{mediaTypesAll:[`banner`,`native`]}},{params:{siteId:180726},match:{integration:`client`,mediaTypesAny:[`banner`]}},{params:{siteId:363698},match:{integration:`server`,mediaTypesAny:[`banner`,`outstream`]}},{params:{siteId:253996,video:{language:`en`}},match:{integration:`client`,mediaTypesAll:[`instream`]}},{params:{siteId:375144,video:{language:`en`}},match:{integration:`server`,mediaTypesAll:[`instream`]}}],placementsLocation:{_default:{bids:[]},below_post:{applyToAllBids:{paramLookup:{zoneId:{map:{"banner-client":881394,"*-server":1974272}}}},bids:[{params:{zoneId:`{mediatype}-{integration}`},match:{integration:`client`,mediaTypesAll:[`banner`]}},{params:{zoneId:`{mediatype}-{integration}`},match:{integration:`server`}}]},content:{applyToAllBids:{paramLookup:{zoneId:{map:{"1-banner-client":881398,"1-*-server":1974276,"2-banner-client":881400,"2-*-server":1974280,"3-banner-client":881402,"3-*-server":1974282,"4-banner-client":881404,"4-*-server":1974284,"5-banner-client":881406,"5-*-server":1974286,"6-banner-client":881408,"6-*-server":1974288,"7-banner-client":881410,"7-*-server":1974290,"8-banner-client":881412,"8-*-server":1974292,"*-banner-client":881414,"*-*-server":1974294}}}},bids:[{params:{zoneId:`{placementMapSequence}-{mediatype}-{integration}`},match:{integration:`client`,mediaTypesAll:[`banner`]}},{params:{zoneId:`{placementMapSequence}-{mediatype}-{integration}`},match:{integration:`server`}}]},footer:{bids:[{params:{zoneId:881416},match:{integration:`client`}},{params:{zoneId:1974296},match:{integration:`server`}}]},header:{applyToAllBids:{paramLookup:{zoneId:{map:{"1-client":881422,"1-server":1974304,"2-client":881426,"2-server":1974306}}}},bids:[{params:{zoneId:`{sequence}-{integration}`}}]},recipe:{applyToAllBids:{paramLookup:{zoneId:{map:{"1-banner-client":881428,"1-*-server":1974308,"2-banner-client":881430,"2-*-server":1974310,"3-banner-client":1187188,"3-*-server":1974312,"4-banner-client":1279328,"4-*-server":1974314,"5-banner-client":3813388,"5-*-server":3813390}}}},bids:[{params:{zoneId:`{placementMapSequence}-{mediatype}-{integration}`},match:{integration:`client`},skip:{mediaTypesAny:[`outstream`]}},{params:{zoneId:`{placementMapSequence}-{mediatype}-{integration}`},match:{integration:`server`}}]},sidebar:{applyToAllBids:{paramLookup:{zoneId:{map:{"1-client":881440,"1-server":1974316,"2-client":881430,"2-server":1974318,"3-client":881460,"3-server":1974320,"4-client":881462,"4-server":1974322,"5-client":881466,"5-server":1974324,"*-client":881478,"*-server":1974332}}}},bids:[{params:{zoneId:`{placementMapSequence}-{integration}`}}]},interstitial:{bids:[{params:{zoneId:1979348},match:{integration:`client`}},{params:{zoneId:1979354},match:{integration:`server`}}]},video_stickyoutstream:{bids:[{params:{siteId:386004,zoneId:2150398,video:{language:`en`}},match:{integration:`client`}},{params:{siteId:420534,zoneId:2384630,video:{language:`en`}},match:{integration:`server`}}]},video_collapse_autoplay_soundoff:{bids:[{params:{zoneId:1259006},match:{integration:`client`}},{params:{zoneId:2055644},match:{integration:`server`}}]},video_coll_soff_smartphone:{bids:[{params:{zoneId:1259010},match:{integration:`client`}},{params:{zoneId:2055648},match:{integration:`server`}}]},video_in_post_clicktoplay_soundon:{bids:[{params:{zoneId:1259008},match:{integration:`client`}},{params:{zoneId:2055642},match:{integration:`server`}}]},video_individual_autoplay_soff:{bids:[{params:{zoneId:1506800},match:{integration:`client`}},{params:{zoneId:2055646},match:{integration:`server`}}]}}},aM=class extends pk{constructor(e){super(e,iM),T(this,`_videoCreativeIds`,[[`138323536473`,P.Rubicon],[`138323540955`,P.Rubicon],[`138323540961`,P.Rubicon],[`138323540964`,P.Rubicon],[`138323929606`,P.Rubicon],[`138323480624`,P.Rubicon],[`138323536455`,P.Rubicon],[`138323540856`,P.Rubicon],[`138323929612`,P.Rubicon],[`138323480642`,P.Rubicon],[`138323929516`,P.Rubicon],[`138323480600`,P.Rubicon],[`138323480636`,P.Rubicon],[`138323536467`,P.Rubicon],[`138323926693`,P.Rubicon],[`138323536476`,P.Rubicon],[`138323542002`,P.RubiconServer],[`138323932663`,P.RubiconServer],[`138323544525`,P.RubiconServer],[`138323932642`,P.RubiconServer],[`138323544531`,P.RubiconServer],[`138323544528`,P.RubiconServer],[`138323932765`,P.RubiconServer],[`138323932768`,P.RubiconServer],[`138323932852`,P.RubiconServer],[`138323932855`,P.RubiconServer],[`138323544354`,P.RubiconServer],[`138323932858`,P.RubiconServer],[`138323544357`,P.RubiconServer],[`138323544339`,P.RubiconServer],[`138323932672`,P.RubiconServer],[`138323932669`,P.RubiconServer]])}},aM=D([S(),A(`design:paramtypes`,[typeof(rM=z!==void 0&&z)==`function`?rM:Object])],aM)})),oM,sM,cM,Ele=o((()=>{w(),B(),$(),Fn(),fk(),Tle(),j(),E(),O(),cM=class extends dk{constructor(e,t){super(e,t),T(this,`multiformatBidder`,!0),T(this,`multiformatBannerNativeBidder`,!0),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Rubicon)),T(this,`gvlid`,52),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.Rubicon},server:{enabled:!0,name:P.Rubicon}}),T(this,`_bidderCodes`,{primary:P.Rubicon,secondary:P.RubiconServer,supplemental:[P.RubiconAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.native,W.outstream,W.instream]),T(this,`_multiformat`,{native:{enabled:!0}}),T(this,`_requiredProperties`,new Map([[`default`,{client:[`accountId`,`siteId`,`zoneId`],server:[`accountId`,`siteId`,`zoneId`]}],[`instream`,{client:[`accountId`,`siteId`,`zoneId`,`video`],server:[`accountId`,`siteId`,`zoneId`,`video`]}]]))}updateBidParams(e){this._addPositionParam(e,`atf`)}},cM=D([Q(`RubiconBidder`),S(),A(`design:paramtypes`,[typeof(oM=z!==void 0&&z)==`function`?oM:Object,typeof(sM=aM!==void 0&&aM)==`function`?sM:Object])],cM)})),lM,uM,dM,Dle=o((()=>{B(),mk(),w(),X(),j(),E(),O(),uM={placementsLocation:{_default:{bids:[]},below_post:{bids:[{params:{pkey:`WoVFJAUvQg9oowjifOQLhHfb`},match:{integration:`client`}},{params:{pkey:`LIEwvmMuVmssQ5NeNnA3LG7j`},match:{integration:`server`}}]},content:{applyToAllBids:{paramLookup:{pkey:{map:{"1-client":`9kDU40A4BJXchR7ikuWND5Ui`,"1-server":`UzMWqNiQufIagUwXXcUnC3RR`,"2-client":`ocdg6DMXhAfaTk7KgImuPCPi`,"2-server":`AgAUrutbIGojlToE3k84bzxl`,"3-client":`JQXmRwXj1jOjHCQF8ufXkKIJ`,"3-server":`yZZZxVNiOjM4qj37cnZmOhpm`,"4-client":`7DEh5436UHnmeKGzVXQVsvRk`,"4-server":`4mtr3RYgMDNCr8MiQN6QNN7A`,"5-client":`ZWVmSVe4txKlxxCQoqMcGIus`,"5-server":`EWFEzPp8DyciUpd7S2IbClhb`,"6-client":`T3CRI7sep8LYNDkOrvgSZUPQ`,"6-server":`19cNdBQ7O8p6vuuVMO7qDAlj`,"7-client":`T4LKxfIKZJCqFzBemjae6MGu`,"7-server":`GXckyQRgDUWb23RX4J75FZxG`,"8-client":`TIHmP6MqapPY4RpbkOm3pYpV`,"8-server":`SQZkIoibuQubwnJWlqMB0wyD`,"*-client":`mBGMr6mqftj8c2qcQky6UjEB`,"*-server":`C0WBeOXHffjxuUxTVCV95pEe`}}}},bids:[{params:{pkey:`{sequence}-{integration}`}}]},footer:{bids:[{params:{pkey:`B1C8tQAkMN7kpCuxh1hW6CY8`},match:{integration:`client`}},{params:{pkey:`47ay7QLdBDSeZxqhcmhI1GCJ`},match:{integration:`server`}}]},header:{applyToAllBids:{paramLookup:{pkey:{map:{"1-client":`jStKXZxN8Ccuf6XS4dKqhKr9`,"1-server":`m9Fpkq4iFy20pGMo6N3MIo5s`,"2-client":`TJx2N6gevlYeFawnBbRy4gRl`,"2-server":`oRnFtrhEhljXqLbZoTCwLhKI`}}}},bids:[{params:{pkey:`{sequence}-{integration}`}}]},recipe:{applyToAllBids:{paramLookup:{pkey:{map:{"1-client":`lklI3sAvIozfaIGNQGORtPOR`,"1-server":`3T7FySyUW1tYZTIj40NTh1v7`,"2-client":`nWhVYiRycgz0snwL4hTcS3vA`,"2-server":`KHkUCj4p7S5QUtqs4PHAL6Wm`,"3-client":`XTsNJ5wTa3CksG40rnRNHiib`,"3-server":`5l5aa7MPO4kmL72O9HPJh09l`,"4-client":`BpO7D8zDzdyGmFUOGNcRhUUm`,"4-server":`F0iZGMeqWPGsxl3T89ciqsoa`,"5-client":`XTckGeWn0TZXTDDgqFI9OkdQ`,"5-server":`fvFAWXIxDuRk7AACIi1DWb20`}}}},bids:[{params:{pkey:`{placementMapSequence}-{integration}`}}]},sidebar:{applyToAllBids:{paramLookup:{pkey:{map:{"1-client":`1BptSVedVseFELcEHmSjZmDr`,"1-server":`FERgtCkBYYJlLAMdOfrwzSUv`,"2-client":`TAk15aJmBw3jMFoV9vSYYWLl`,"2-server":`M0ETJ1WkxrBImmFZBDafhwfv`,"3-client":`oSwBRQCb6174NZ0wDEyxZW9E`,"3-server":`y0G8OyxjMjcTCOA0A8teaect`,"4-client":`UMKQPvhCYMOH1sOPVdYEDEQt`,"4-server":`UnGAf9ltEFV09DpREkqrEpK0`,"5-client":`WdPWJ92IfPqKgO5vRXvlsDO4`,"5-server":`hd3wbcwtoeg0OfouZfTDIfTD`,"*-client":`k8W1t71k8qmkYsiK4v3pop6j`,"*-server":`TDRVoNcJZQhrS1VJr0Qq6xq9`}}}},bids:[{params:{pkey:`{sequence}-{integration}`}}]},video_stickyoutstream:{bids:[{params:{pkey:`qKjlCz8NOStHzB15G18scbgS`},match:{integration:`client`}},{params:{pkey:`RUx5hQX5rX4bhGZWzZ0ta4op`},match:{integration:`server`}}]},video_collapse_autoplay_soundoff:{bids:[{params:{pkey:`I5VjN89qESPMegBdpCt92W8S`},match:{integration:`client`}},{params:{pkey:`pQwHn4uCAr3kQ8SE9qjIzMtV`},match:{integration:`server`}}]},video_coll_soff_smartphone:{bids:[{params:{pkey:`iZXbFkwkNrOgpI7ue8o3mJda`},match:{integration:`client`}},{params:{pkey:`8EIqVDI1c2TA7IKq8rLk6oRG`},match:{integration:`server`}}]},video_in_post_clicktoplay_soundon:{bids:[{params:{pkey:`sMLWZBQNa6GaKC2khQiIg5Tj`},match:{integration:`client`}},{params:{pkey:`yHkEhAMj24ubV101Fklbp6fA`},match:{integration:`client`}},{params:{pkey:`XQu5Rud4EL34FXVySow4WkgR`},match:{integration:`server`}}]},video_individual_autoplay_soff:{bids:[{params:{pkey:`GCV9Do84nDBEFaVjb507H4iE`},match:{integration:`client`}},{params:{pkey:`6lY8mDlZX6W7ijhbh6OuDCfj`},match:{integration:`client`}},{params:{pkey:`uUSzUB6i3CeQ2y1A514w2lxL`},match:{integration:`server`}}]}}},dM=class extends pk{constructor(e){super(e,uM),T(this,`_videoCreativeIds`,[[`138377683089`,P.Sharethrough],[`138377670131`,P.Sharethrough],[`138377670158`,P.Sharethrough],[`138377670173`,P.Sharethrough],[`138378141751`,P.Sharethrough],[`138377670161`,P.Sharethrough],[`138377670167`,P.Sharethrough],[`138377670170`,P.Sharethrough],[`138377670209`,P.Sharethrough],[`138377670212`,P.Sharethrough],[`138377670224`,P.Sharethrough],[`138377669645`,P.Sharethrough],[`138377670218`,P.Sharethrough],[`138377670221`,P.Sharethrough],[`138378141754`,P.Sharethrough],[`138377670215`,P.Sharethrough],[`138495437207`,P.SharethroughServer],[`138495437120`,P.SharethroughServer],[`138495437117`,P.SharethroughServer],[`138495437114`,P.SharethroughServer],[`138495437111`,P.SharethroughServer],[`138495437087`,P.SharethroughServer],[`138495437057`,P.SharethroughServer],[`138495142563`,P.SharethroughServer]])}},dM=D([S(),A(`design:paramtypes`,[typeof(lM=z!==void 0&&z)==`function`?lM:Object])],dM)})),fM,pM,mM,Ole=o((()=>{B(),Fn(),$(),w(),fk(),Dle(),j(),E(),O(),mM=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Sharethrough)),T(this,`gvlid`,80),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.Sharethrough},server:{enabled:!0,name:P.Sharethrough}}),T(this,`_bidderCodes`,{primary:P.Sharethrough,secondary:P.SharethroughServer,supplemental:[P.SharethroughAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`pkey`],server:[`pkey`]}]]))}},mM=D([Q(`SharethroughBidder`),S(),A(`design:paramtypes`,[typeof(fM=z!==void 0&&z)==`function`?fM:Object,typeof(pM=dM!==void 0&&dM)==`function`?pM:Object])],mM)})),hM,gM,_M,kle=o((()=>{B(),mk(),w(),X(),j(),E(),O(),gM={applyToAllBids:{paramLookup:{placementId:{map:{"Below_Post-*":`1428235`,"Content-*":`1600857`,"Content-1":`1605035`,"Content-2":`1327675`,"Content-3":`1764581`,"Content-4":`1744128`,"Content-5":`1845743`,"Content-6":`1687684`,"Content-7":`1354671`,"Content-8":`1381559`,"Content-9":`1462998`,"Footer-*":`1807924`,"Header-1":`1461334`,"Header-2":`1893163`,"Recipe-1":`1157928`,"Recipe-2":`1317399`,"Recipe-3":`1328764`,"Recipe-4":`1479814`,"Recipe-*":`1182664`,"Sidebar-1":`1656231`,"Sidebar-2":`1263544`,"Sidebar-3":`1840493`,"Sidebar-4":`1307359`,"Sidebar-5":`1324345`,"Sidebar-*":`1926917`,"Video_StickyOutstream-*":`1908311`,"Video_Coll_SOff_Smartphone-*":`1762083`,"Video_Collapse_Autoplay_SoundOff-*":`1493428`,"Video_In-Post_ClicktoPlay_SoundOn-*":`1008653`,"Video_Individual_Autoplay_SOff-*":`1347103`}}}},placementsLocation:{_default:{bids:[{params:{publisherId:`1927123`,placementId:`{location}-{placementMapSequence}`}}]}}},_M=class extends pk{constructor(e){super(e,gM),T(this,`_videoCreativeIds`,[[`138514339302`,P.StackAdapt],[`138514339467`,P.StackAdapt],[`138514339479`,P.StackAdapt],[`138514516163`,P.StackAdapt],[`138514516166`,P.StackAdapt],[`138514516184`,P.StackAdapt],[`138514516187`,P.StackAdapt],[`138514516190`,P.StackAdapt]])}},_M=D([S(),A(`design:paramtypes`,[typeof(hM=z!==void 0&&z)==`function`?hM:Object])],_M)})),vM,yM,bM,Ale=o((()=>{w(),B(),Fn(),$(),fk(),kle(),j(),E(),O(),bM=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.StackAdapt)),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.StackAdapt},server:{enabled:!1}}),T(this,`_bidderCodes`,{primary:P.StackAdapt}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`publisherId`,`placementId`]}]]))}},bM=D([Q(`StackAdaptBidder`),S(),A(`design:paramtypes`,[typeof(vM=z!==void 0&&z)==`function`?vM:Object,typeof(yM=_M!==void 0&&_M)==`function`?yM:Object])],bM)})),xM,SM,CM,jle=o((()=>{B(),mk(),w(),j(),O(),SM={applyToAllBids:{params:{pageId:112062}},placementsLocation:{_default:{bids:[]},below_post:{bids:[{params:{placementId:121842},skip:{device:[`mobile`],mediaTypesAll:[`outstream`]}},{params:{placementId:121842},match:{mediaTypesAll:[`outstream`]},skip:{device:[`mobile`],adTypes:[`outstreamDesktop`]}},{params:{placementId:121834},match:{adTypes:[`outstreamDesktop`],mediaTypesAll:[`outstream`]},skip:{device:[`mobile`]}},{params:{placementId:121842},match:{device:[`mobile`]},skip:{lazy:!0}},{params:{placementId:121842},match:{device:[`mobile`],mediaTypesAll:[`outstream`],lazy:!0},skip:{adTypesAny:[`outstreamMobile`,`miniscroller`,`interscroller`]}},{params:{placementId:121842},match:{device:[`mobile`],lazy:!0},skip:{mediaTypesAll:[`outstream`],adTypesAny:[`miniscroller`,`interscroller`]}},{params:{placementId:121895},match:{device:[`mobile`],lazy:!0,adTypes:[`outstreamMobile`,`miniscroller`,`interscroller`],mediaTypesAll:[`outstream`]}},{params:{placementId:121834},match:{device:[`mobile`],adTypes:[`outstreamMobile`],mediaTypesAll:[`outstream`],lazy:!0},skip:{adTypesAny:[`miniscroller`,`interscroller`]}},{params:{placementId:121837},match:{device:[`mobile`],adTypes:[`outstreamMobile`,`miniscroller`],mediaTypesAll:[`outstream`],lazy:!0},skip:{adTypes:[`interscroller`]}},{params:{placementId:121838},match:{device:[`mobile`],adTypes:[`outstreamMobile`,`interscroller`],mediaTypesAll:[`outstream`],lazy:!0},skip:{adTypes:[`miniscroller`]}},{params:{placementId:121840},match:{device:[`mobile`],adTypes:[`miniscroller`,`interscroller`],mediaTypesAll:[`outstream`],lazy:!0},skip:{adTypes:[`outstreamMobile`]}},{params:{placementId:121840},match:{device:[`mobile`],adTypes:[`miniscroller`,`interscroller`],lazy:!0},skip:{mediaTypesAll:[`outstream`]}},{params:{placementId:121835},match:{device:[`mobile`],adTypes:[`miniscroller`],mediaTypesAll:[`outstream`],lazy:!0},skip:{adTypesAny:[`outstreamMobile`,`interscroller`]}},{params:{placementId:121835},match:{device:[`mobile`],adTypes:[`miniscroller`],lazy:!0},skip:{mediaTypesAll:[`outstream`],adTypes:[`interscroller`]}},{params:{placementId:121836},match:{device:[`mobile`],adTypes:[`interscroller`],mediaTypesAll:[`outstream`],lazy:!0},skip:{adTypesAny:[`outstreamMobile`,`miniscroller`]}},{params:{placementId:121836},match:{device:[`mobile`],adTypes:[`interscroller`],lazy:!0},skip:{mediaTypesAll:[`outstream`],adTypes:[`miniscroller`]}}]},content:{bids:[{params:{placementId:121842},skip:{device:[`mobile`],mediaTypesAll:[`outstream`]}},{params:{placementId:121842},match:{mediaTypesAll:[`outstream`]},skip:{device:[`mobile`],adTypes:[`outstreamDesktop`]}},{params:{placementId:121834},match:{adTypes:[`outstreamDesktop`],mediaTypesAll:[`outstream`]},skip:{device:[`mobile`]}},{params:{placementId:121842},match:{device:[`mobile`],mediaTypesAll:[`outstream`]},skip:{adTypesAny:[`outstreamMobile`,`miniscroller`,`interscroller`]}},{params:{placementId:121842},match:{device:[`mobile`]},skip:{mediaTypesAll:[`outstream`],adTypesAny:[`miniscroller`,`interscroller`]}},{params:{placementId:121895},match:{device:[`mobile`],adTypes:[`outstreamMobile`,`miniscroller`,`interscroller`],mediaTypesAll:[`outstream`]}},{params:{placementId:121834},match:{device:[`mobile`],adTypes:[`outstreamMobile`],mediaTypesAll:[`outstream`]},skip:{adTypesAny:[`miniscroller`,`interscroller`]}},{params:{placementId:121837},match:{device:[`mobile`],adTypes:[`outstreamMobile`,`miniscroller`],mediaTypesAll:[`outstream`]},skip:{adTypes:[`interscroller`]}},{params:{placementId:121838},match:{device:[`mobile`],adTypes:[`outstreamMobile`,`interscroller`],mediaTypesAll:[`outstream`]},skip:{adTypes:[`miniscroller`]}},{params:{placementId:121840},match:{device:[`mobile`],adTypes:[`miniscroller`,`interscroller`],mediaTypesAll:[`outstream`]},skip:{adTypes:[`outstreamMobile`]}},{params:{placementId:121840},match:{device:[`mobile`],adTypes:[`miniscroller`,`interscroller`]},skip:{mediaTypesAll:[`outstream`]}},{params:{placementId:121835},match:{device:[`mobile`],adTypes:[`miniscroller`],mediaTypesAll:[`outstream`]},skip:{adTypesAny:[`outstreamMobile`,`interscroller`]}},{params:{placementId:121835},match:{device:[`mobile`],adTypes:[`miniscroller`]},skip:{mediaTypesAll:[`outstream`],adTypes:[`interscroller`]}},{params:{placementId:121836},match:{device:[`mobile`],adTypes:[`interscroller`],mediaTypesAll:[`outstream`]},skip:{adTypesAny:[`outstreamMobile`,`miniscroller`]}},{params:{placementId:121836},match:{device:[`mobile`],adTypes:[`interscroller`]},skip:{mediaTypesAll:[`outstream`],adTypes:[`miniscroller`]}}]},footer:{bids:[{params:{placementId:121842}}]},header:{bids:[{params:{placementId:121842}}]},recipe:{bids:[{params:{placementId:121842},skip:{device:[`mobile`],mediaTypesAll:[`outstream`]}},{params:{placementId:121842},match:{mediaTypesAll:[`outstream`]},skip:{device:[`mobile`],adTypes:[`outstreamDesktop`]}},{params:{placementId:121834},match:{adTypes:[`outstreamDesktop`],mediaTypesAll:[`outstream`]},skip:{device:[`mobile`]}},{params:{placementId:121842},match:{device:[`mobile`],mediaTypesAll:[`outstream`]},skip:{adTypesAny:[`outstreamMobile`,`miniscroller`]}},{params:{placementId:121842},match:{device:[`mobile`]},skip:{mediaTypesAll:[`outstream`],adTypes:[`miniscroller`]}},{params:{placementId:121834},match:{device:[`mobile`],adTypes:[`outstreamMobile`],mediaTypesAll:[`outstream`]},skip:{adTypes:[`miniscroller`]}},{params:{placementId:121837},match:{device:[`mobile`],adTypes:[`outstreamMobile`,`miniscroller`],mediaTypesAll:[`outstream`]}},{params:{placementId:121835},match:{device:[`mobile`],adTypes:[`miniscroller`],mediaTypesAll:[`outstream`]},skip:{adTypes:[`outstreamMobile`]}},{params:{placementId:121835},match:{device:[`mobile`],adTypes:[`miniscroller`]},skip:{mediaTypesAll:[`outstream`]}}]},sidebar:{bids:[{params:{placementId:121842}}]}}},CM=class extends pk{constructor(e){super(e,SM)}},CM=D([S(),A(`design:paramtypes`,[typeof(xM=z!==void 0&&z)==`function`?xM:Object])],CM)})),wM,TM,EM,Mle=o((()=>{w(),B(),$(),Fn(),fk(),jle(),j(),E(),O(),EM=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Teads)),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.Teads},server:{enabled:!1}}),T(this,`_bidderCodes`,{primary:P.Teads}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`placementId`,`pageId`],server:[`placementId`,`pageId`]}]]))}},EM=D([Q(`TeadsBidder`),S(),A(`design:paramtypes`,[typeof(wM=z!==void 0&&z)==`function`?wM:Object,typeof(TM=CM!==void 0&&CM)==`function`?TM:Object])],EM)})),DM,OM,kM,Nle=o((()=>{B(),mk(),w(),X(),j(),E(),O(),OM={applyOptionsToAllBids:[{retrieveFromFile:[`video`],match:{mediaTypesAll:[`instream`]}}],placementsLocation:{_default:{bids:[]},content:{bids:[{params:{inventoryCode:`adthrive_communities_{placementMapName}_{device}`},match:{featureRollout:[`communities-enabled`],integration:`client`},supplemental:!1},{params:{inventoryCode:`adthrive_communities_{placementMapName}_{device}_pbs2s`},match:{featureRollout:[`communities-enabled`],integration:`server`},supplemental:!1},{params:{inventoryCode:`adthrive_content_{placementMapSequence}_hdx`},match:{integration:`client`},skip:{nativeEnabled:!0}},{params:{inventoryCode:`adthrive_content_{placementMapSequence}_hdx_pbs2s`},match:{integration:`server`},skip:{nativeEnabled:!0}},{params:{inventoryCode:`adthrive{category}_content_fixed_{device}`},match:{nativeEnabled:!0,integration:`client`,sequence:[1]}},{params:{inventoryCode:`adthrive{category}_content_fixed_{device}_pbs2s`},match:{nativeEnabled:!0,integration:`server`,sequence:[1]}},{params:{inventoryCode:`adthrive{category}_content{placementMapSequence}_fixed_{device}`},match:{nativeEnabled:!0,integration:`client`},skip:{sequence:[1]}},{params:{inventoryCode:`adthrive{category}_content{placementMapSequence}_fixed_{device}_pbs2s`},match:{nativeEnabled:!0,integration:`server`},skip:{sequence:[1]}},{params:{inventoryCode:`adthriveron_content_{device}_hive`},match:{mediaTypesAll:[`outstream`],integration:`client`}},{params:{inventoryCode:`adthriveron_content_{device}_hive_pbs2s`},match:{mediaTypesAll:[`outstream`],integration:`server`}},{params:{inventoryCode:`adthriveron_content_mobile_largeformat_opt_in`},match:{adTypes:[`largeFormatsMobile`],device:[`mobile`],integration:`client`}},{params:{inventoryCode:`adthriveron_content_mobile_largeformat_opt_in_pbs2s`},match:{adTypes:[`largeFormatsMobile`],device:[`mobile`],integration:`server`}}]},below_post:{bids:[{params:{inventoryCode:`adthrive_below_post_1_hdx`},match:{integration:`client`}},{params:{inventoryCode:`adthrive_below_post_1_hdx_pbs2s`},match:{integration:`server`}},{params:{inventoryCode:`adthriveron_belowpost_{device}_728x250`},match:{sizesAll:[[728,250]],integration:`client`},skip:{device:[`mobile`]}},{params:{inventoryCode:`adthriveron_belowpost_{device}_728x250_pbs2s`},match:{sizesAll:[[728,250]],integration:`server`},skip:{device:[`mobile`]}},{params:{inventoryCode:`adthriveron_belowpost_{device}_728x90`},match:{sizesAll:[[728,90]],integration:`client`},skip:{device:[`mobile`]}},{params:{inventoryCode:`adthriveron_belowpost_{device}_728x90_pbs2s`},match:{sizesAll:[[728,90]],integration:`server`},skip:{device:[`mobile`]}},{params:{inventoryCode:`adthriveron_belowpost_{device}_300x250`},match:{device:[`mobile`],sizesAll:[[300,250]],integration:`client`}},{params:{inventoryCode:`adthriveron_belowpost_{device}_300x250_pbs2s`},match:{device:[`mobile`],sizesAll:[[300,250]],integration:`server`}},{params:{inventoryCode:`adthriveron_belowpost_{device}_320x100`},match:{device:[`mobile`],sizesAll:[[320,100]],integration:`client`}},{params:{inventoryCode:`adthriveron_belowpost_{device}_320x100_pbs2s`},match:{device:[`mobile`],sizesAll:[[320,100]],integration:`server`}}]},header:{bids:[{params:{inventoryCode:`adthrive_header_{sequence}_hdx`},match:{integration:`client`}},{params:{inventoryCode:`adthrive_header_{sequence}_hdx_pbs2s`},match:{integration:`server`}},{params:{inventoryCode:`adthriveron_header_{device}_970x250`},match:{sizesAll:[[970,250]],integration:`client`},skip:{device:[`mobile`]}},{params:{inventoryCode:`adthriveron_header_{device}_970x250_pbs2s`},match:{sizesAll:[[970,250]],integration:`server`},skip:{device:[`mobile`]}},{params:{inventoryCode:`adthriveron_header_{device}_728x90`},match:{sizesAll:[[728,90]],integration:`client`},skip:{device:[`mobile`]}},{params:{inventoryCode:`adthriveron_header_{device}_728x90_pbs2s`},match:{sizesAll:[[728,90]],integration:`server`},skip:{device:[`mobile`]}},{params:{inventoryCode:`adthriveron_header_{device}_320x100`},match:{device:[`mobile`],sizesAll:[[320,100]],integration:`client`}},{params:{inventoryCode:`adthriveron_header_{device}_320x100_pbs2s`},match:{device:[`mobile`],sizesAll:[[320,100]],integration:`server`}}]},footer:{bids:[{params:{inventoryCode:`adthrive_footer_1_hdx`},match:{integration:`client`},skip:{device:[`mobile`]}},{params:{inventoryCode:`adthrive_footer_1_hdx_pbs2s`},match:{integration:`server`},skip:{device:[`mobile`]}},{params:{inventoryCode:`adthrive_footer_1_hdx_{device}`},match:{device:[`mobile`],integration:`client`}},{params:{inventoryCode:`adthrive_footer_1_hdx_pbs2s_{device}`},match:{device:[`mobile`],integration:`server`}}]},recipe:{bids:[{params:{inventoryCode:`adthrive_recipe_{placementMapSequence}_hdx`},match:{integration:`client`},skip:{device:[`mobile`],nativeEnabled:!0}},{params:{inventoryCode:`adthrive_recipe_{placementMapSequence}_hdx_pbs2s`},match:{integration:`server`},skip:{device:[`mobile`],nativeEnabled:!0}},{params:{inventoryCode:`adthrive{category}_recipe{placementMapSequence}_fixed_{device}`},match:{nativeEnabled:!0,integration:`client`}},{params:{inventoryCode:`adthrive{category}_recipe{placementMapSequence}_fixed_{device}_pbs2s`},match:{nativeEnabled:!0,integration:`server`}},{params:{inventoryCode:`adthrive_recipe_{placementMapSequence}_hdx`},match:{device:[`mobile`],integration:`client`},skip:{nativeEnabled:!0}},{params:{inventoryCode:`adthrive_recipe_{placementMapSequence}_hdx_pbs2s`},match:{device:[`mobile`],integration:`server`},skip:{nativeEnabled:!0}}]},sidebar:{bids:[{params:{inventoryCode:`adthrive_communities_{placementMapName}_{device}`},match:{sequence:[1],featureRollout:[`communities-enabled`],integration:`client`},supplemental:!1},{params:{inventoryCode:`adthrive_communities_{placementMapName}_{device}_pbs2s`},match:{sequence:[1],featureRollout:[`communities-enabled`],integration:`server`},supplemental:!1},{params:{inventoryCode:`adthrive_sidebar_{placementMapSequence}_hdx`},match:{integration:`client`},skip:{device:[`mobile`],adTypes:[`nativeDesktopSidebar`]}},{params:{inventoryCode:`adthrive_sidebar_{placementMapSequence}_hdx_pbs2s`},match:{integration:`server`},skip:{device:[`mobile`],adTypes:[`nativeDesktopSidebar`]}},{params:{inventoryCode:`adthrive{category}_sidebar{placementMapSequence}_fixed_{device}`},match:{adTypes:[`nativeDesktopSidebar`],integration:`client`,sequenceMax:5},skip:{device:[`mobile`]}},{params:{inventoryCode:`adthrive{category}_sidebar{placementMapSequence}_fixed_{device}_pbs2s`},match:{adTypes:[`nativeDesktopSidebar`],integration:`server`,sequenceMax:5},skip:{device:[`mobile`]}},{params:{inventoryCode:`adthrive{category}_sidebar_fixed_{device}`},match:{adTypes:[`nativeDesktopSidebar`],integration:`client`,sequenceMin:9},skip:{device:[`mobile`]}},{params:{inventoryCode:`adthrive{category}_sidebar_fixed_{device}_pbs2s`},match:{adTypes:[`nativeDesktopSidebar`],integration:`server`,sequenceMin:9},skip:{device:[`mobile`]}},{params:{inventoryCode:`adthrive_sidebar_{placementMapSequence}_hdx`},match:{device:[`mobile`],integration:`client`}},{params:{inventoryCode:`adthrive_sidebar_{placementMapSequence}_hdx_pbs2s`},match:{device:[`mobile`],integration:`server`}}]},interstitial:{bids:[{params:{inventoryCode:`adthriveron_interstitial_multisize`},match:{integration:`client`}},{params:{inventoryCode:`adthriveron_interstitial_multisize`},match:{integration:`server`}}]},video_stickyoutstream:{bids:[{params:{inventoryCode:`adthrive_video_stickyoutstream_1_{device}_hdx`},match:{integration:`client`}},{params:{inventoryCode:`adthrive_video_stickyoutstream_1_{device}_hdx_pbs2s`},match:{integration:`server`}}]},video_collapse_autoplay_soundoff:{bids:[{params:{inventoryCode:`AdThriveRON_instream_desktopcollapse_prebid_c2s`},match:{integration:`client`}},{params:{inventoryCode:`AdThriveRON_instream_desktopcollapse_prebid`},match:{integration:`server`}}]},video_coll_soff_smartphone:{bids:[{params:{inventoryCode:`AdThriveRON_instream_mwebsticky_prebid_c2s`},match:{integration:`client`}},{params:{inventoryCode:`AdThriveRON_instream_mwebsticky_prebid`},match:{integration:`server`}}]},video_in_post_clicktoplay_soundon:{bids:[{params:{inventoryCode:`AdThriveRON_instream_CTP_prebid_c2s`},match:{integration:`client`}},{params:{inventoryCode:`AdThriveRON_instream_CTP_prebid`},match:{integration:`server`}}]},video_individual_autoplay_soff:{bids:[{params:{inventoryCode:`AdThriveRON_instream_contextcollapse_prebid_c2s`},match:{integration:`client`}},{params:{inventoryCode:`AdThriveRON_instream_contextcollapse_prebid`},match:{integration:`server`}}]}}},kM=class extends pk{constructor(e){super(e,OM),T(this,`_videoCreativeIds`,[[`138323510289`,P.Triplelift],[`138323472959`,P.Triplelift],[`138323472731`,P.Triplelift],[`138323472671`,P.Triplelift],[`138323472641`,P.Triplelift],[`138323473061`,P.Triplelift],[`138323473058`,P.Triplelift],[`138323473019`,P.Triplelift],[`138323473016`,P.Triplelift],[`138323472986`,P.Triplelift],[`138323472734`,P.Triplelift],[`138323473064`,P.Triplelift],[`138323473055`,P.Triplelift],[`138323472728`,P.Triplelift],[`138323472674`,P.Triplelift],[`138323472737`,P.Triplelift],[`138326649881`,P.Triplelift],[`138326691825`,P.Triplelift],[`138326691828`,P.Triplelift],[`138326691831`,P.Triplelift],[`138326691834`,P.Triplelift],[`138326691837`,P.Triplelift],[`138326691840`,P.Triplelift],[`138326691843`,P.Triplelift],[`138326691846`,P.Triplelift],[`138326691783`,P.Triplelift],[`138326691786`,P.Triplelift],[`138326691789`,P.Triplelift],[`138326691792`,P.Triplelift],[`138326691753`,P.Triplelift],[`138326691756`,P.Triplelift],[`138326691570`,P.Triplelift],[`138348653814`,P.TripleliftServer],[`138348654438`,P.TripleliftServer],[`138349054156`,P.TripleliftServer],[`138349054168`,P.TripleliftServer],[`138349054201`,P.TripleliftServer],[`138348654432`,P.TripleliftServer],[`138348654444`,P.TripleliftServer],[`138349054186`,P.TripleliftServer],[`138349054204`,P.TripleliftServer],[`138349054210`,P.TripleliftServer],[`138349054435`,P.TripleliftServer],[`138349054189`,P.TripleliftServer],[`138349054207`,P.TripleliftServer],[`138349054426`,P.TripleliftServer],[`138349054429`,P.TripleliftServer],[`138349054432`,P.TripleliftServer]])}},kM=D([S(),A(`design:paramtypes`,[typeof(DM=z!==void 0&&z)==`function`?DM:Object])],kM)})),AM,jM,MM,Ple=o((()=>{w(),B(),X(),$(),Z(),fk(),Nle(),j(),E(),O(),MM=class extends dk{constructor(e,t){super(e,t),T(this,`multiformatBidder`,!0),T(this,`multiformatBannerVideoBidder`,!0),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Triplelift)),T(this,`gvlid`,28),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.Triplelift},server:{enabled:!0,name:P.Triplelift}}),T(this,`_bidderCodes`,{primary:P.Triplelift,secondary:P.TripleliftServer,supplemental:[P.TripleliftAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream,W.instream]),T(this,`_multiformat`,{outstream:{enabled:!0},native:{enabled:!0,backup:!0}}),T(this,`_paramKeyMap`,{video:this._getVideoParam.bind(this)}),T(this,`_requiredProperties`,new Map([[`default`,{client:[`inventoryCode`],server:[`inventoryCode`]}],[`instream`,{client:[`inventoryCode`,`video`],server:[`inventoryCode`,`video`]}]])),T(this,`_settings`,{adserverTargeting:[{key:`hb_attr`,val:({mediaType:e,meta:t,tl_source:n})=>{var r,i;let a=(r=(i=t==null?void 0:t.mediaType)==null?this._tlSourceMap.get(n==null?``:n):i)==null?e:r,o=e===`banner`&&(t==null?void 0:t.mediaType)===`video`||(t==null?void 0:t.isInBannerVideo);return o&&(a=`ibv`),a}}]}),T(this,`_tlSourceMap`,new Map([[`hdx`,`banner`],[`tlx`,`native`]]))}_getVideoParam(e){var t,n;let r=`id`in e?e.id:e.name,i=this._config.video.mimeType,a=(t=this._config.video.playbackmethod)==null||(t=t.get(r))==null?void 0:t[0];return{...Ei()?{w:640,h:360}:{w:400,h:225},api:this._config.video.apiValue,...i&&{mimes:i},...((n=this._config.video.videoProtocols)==null?void 0:n.scope)===`all`&&{protocols:this._config.video.videoProtocols.protocols},...a&&{playbackmethod:a},pos:this._config.video.position.id}}},MM=D([Q(`TripleLiftBidder`),S(),A(`design:paramtypes`,[typeof(AM=z!==void 0&&z)==`function`?AM:Object,typeof(jM=kM!==void 0&&kM)==`function`?jM:Object])],MM)})),NM,PM,FM,Fle=o((()=>{B(),mk(),w(),X(),j(),E(),O(),PM={applyToAllBids:{params:{supplySourceId:`cafemedia`,siteId:`{siteId}`,publisherId:`{siteId}`}},placementsLocation:{_default:{bids:[{params:{placementId:`AdThrive_{location}_{placementMapSequence}`},skip:{mediaTypesAll:[`instream`]}}]},recipe:{bids:[{params:{placementId:`AdThrive_{location}_{placementMapSequence}`}}]},video_collapse_autoplay_soundoff:{bids:[{params:{placementId:`Video_Collapse_Autoplay_SoundOff`}}]},video_coll_soff_smartphone:{bids:[{params:{placementId:`Video_Coll_SOff_Smartphone`}}]},video_in_post_clicktoplay_soundon:{bids:[{params:{placementId:`Video_In-Post_ClicktoPlay_SoundOn`}}]},video_individual_autoplay_soff:{bids:[{params:{placementId:`Video_Individual_Autoplay_SOff`}}]}}},FM=class extends pk{constructor(e){super(e,PM),T(this,`_videoCreativeIds`,[[`138323472896`,P.TTD],[`138323532681`,P.TTD],[`138323532645`,P.TTD],[`138323532675`,P.TTD],[`138323532678`,P.TTD],[`138323922211`,P.TTD],[`138323530488`,P.TTD],[`138323532606`,P.TTD],[`138323532648`,P.TTD],[`138323922202`,P.TTD],[`138323532672`,P.TTD],[`138323922205`,P.TTD],[`138323922010`,P.TTD],[`138323922208`,P.TTD],[`138323532642`,P.TTD],[`138323921998`,P.TTD]])}},FM=D([S(),A(`design:paramtypes`,[typeof(NM=z!==void 0&&z)==`function`?NM:Object])],FM)})),IM,LM,RM,Ile=o((()=>{w(),B(),Fn(),$(),fk(),Fle(),j(),E(),O(),RM=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.TTD)),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.TTD},server:{enabled:!0,name:P.TTD}}),T(this,`_bidderCodes`,{primary:P.TTD}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`publisherId`,`siteId`,`placementId`,`supplySourceId`],server:[`publisherId`,`siteId`,`placementId`,`supplySourceId`]}]]))}},RM=D([Q(`TTDBidder`),S(),A(`design:paramtypes`,[typeof(IM=z!==void 0&&z)==`function`?IM:Object,typeof(LM=FM!==void 0&&FM)==`function`?LM:Object])],RM)})),zM,BM,VM,HM=o((()=>{B(),mk(),w(),X(),j(),E(),O(),BM={applyToAllBids:{params:{publisherId:2002}},placementsLocation:{_default:{bids:[]},below_post:{bids:[{params:{placementId:`2002034`,size:[[1,2]]},match:{adTypes:[`interscroller`],viewabilityThresholdMet:!0}},{params:{placementId:`2002034`,size:[[1,2]]},labels:[`refresh`],match:{adTypes:[`interscroller`],viewabilityThresholdMet:!1}}]},content:{bids:[{params:{placementId:`2002001`,size:[[1,2]]},match:{adTypes:[`interscroller`],sequence:[1]}},{retrieveFromFile:[`size`],params:{placementId:`2002002`},match:{sizesAny:[[1,2],[300,250],[728,90]],sequence:[1]}},{retrieveFromFile:[`size`],params:{placementId:`2002003`},match:{sizesAny:[[1,2],[300,250],[728,90]],sequence:[2]}},{retrieveFromFile:[`size`],params:{placementId:`2002004`},match:{sizesAny:[[1,2],[300,250],[728,90]],sequence:[3]}},{retrieveFromFile:[`size`],params:{placementId:`2002005`},match:{sizesAny:[[1,2],[300,250],[728,90]],sequence:[4]}}]},footer:{bids:[{params:{placementId:`2002033`,size:[[320,50]]},match:{adTypes:[`expandableFooter`],device:[`mobile`]}},{params:{placementId:`2002038`,size:[[1,1]]},match:{adTypes:[`expandableFooter`],device:[`mobile`]},skip:{mobileStickyPlayerOnPage:!0}},{params:{placementId:`2002039`,size:[[1,1]]},match:{adTypes:[`animatedFooter`],device:[`mobile`]}}]},interstitial:{bids:[{params:{placementId:`2002040`,size:[[1,1]]},match:{sizesAll:[[1,1]]}}]},sidebar:{bids:[{retrieveFromFile:[`size`],params:{placementId:`2002032`},match:{sequenceMin:9,sizesAny:[[300,250],[160,600],[300,600]]}}]},video_collapse_autoplay_soundoff:{bids:[{params:{placementId:2002044}}]},video_coll_soff_smartphone:{bids:[{params:{placementId:2002045}}]}}},VM=class extends pk{constructor(e){super(e,BM),T(this,`_videoCreativeIds`,[[`138422425195`,P.UndertoneServer],[`138421771020`,P.UndertoneServer],[`138421771017`,P.UndertoneServer],[`138421771014`,P.UndertoneServer],[`138421761770`,P.UndertoneServer],[`138421761767`,P.UndertoneServer],[`138421761764`,P.UndertoneServer],[`138421761761`,P.UndertoneServer]])}},VM=D([S(),A(`design:paramtypes`,[typeof(zM=z!==void 0&&z)==`function`?zM:Object])],VM)})),UM,WM=o((()=>{fk(),Fn(),E(),UM=class extends dk{constructor(e,t){super(e,t),T(this,`gvlid`,677),T(this,`_adapterEnablement`,{client:{enabled:!0,name:P.Undertone},server:{enabled:!0,name:P.Undertone}}),T(this,`_requiredProperties`,new Map([[`default`,{client:[`publisherId`,`placementId`],server:[`publisherId`,`placementId`]}]]))}}})),GM,KM,qM,Lle=o((()=>{w(),B(),$(),fk(),Fn(),WM(),HM(),X(),j(),E(),O(),qM=class extends UM{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Undertone)),T(this,`_bidderCodes`,{primary:P.Undertone}),T(this,`_mediatypeEnablement`,[W.banner]),T(this,`_paramKeyMap`,{size:this._getSizeParam.bind(this)}),T(this,`_sizeMap`,{[F.Content]:[[1,2],[300,250],[728,90]],[F.Sidebar]:[[300,250],[160,600],[300,600]]})}_getSizeParam(e){var t;let n=`id`in e,r=n?e.location:e.name;return(t=this._sizeMap[r])==null?void 0:t.reduce((t,r)=>{let i=n&&e.sizes.some(e=>e[0]===r[0]&&e[1]===r[1]);return i&&t.push(r),t},[])}},qM=D([Q(`UndertoneBidder`),C(),A(`design:paramtypes`,[typeof(GM=z!==void 0&&z)==`function`?GM:Object,typeof(KM=VM!==void 0&&VM)==`function`?KM:Object])],qM)})),JM,YM,XM,Rle=o((()=>{w(),B(),$(),Fn(),WM(),HM(),fk(),j(),E(),O(),XM=class extends UM{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.UndertoneServer)),T(this,`_bidderCodes`,{primary:P.UndertoneServer,supplemental:[P.UndertoneAY]}),T(this,`_mediatypeEnablement`,[W.instream])}},XM=D([Q(`UndertoneServerBidder`),S(),A(`design:paramtypes`,[typeof(JM=z!==void 0&&z)==`function`?JM:Object,typeof(YM=VM!==void 0&&VM)==`function`?YM:Object])],XM)})),ZM,QM,$M,zle=o((()=>{B(),mk(),w(),X(),j(),E(),O(),QM={placementsLocation:{_default:{bids:[{params:{siteId:249232},skip:{mediaTypesAll:[`outstream`]}}]}}},$M=class extends pk{constructor(e){super(e,QM),T(this,`_videoCreativeIds`,[[`138398568419`,P.Unruly],[`138398715243`,P.Unruly],[`138398716629`,P.Unruly],[`138398716632`,P.Unruly],[`138398716656`,P.Unruly],[`138398716659`,P.Unruly],[`138398716662`,P.Unruly],[`138398716665`,P.Unruly],[`138398716683`,P.Unruly],[`138398716686`,P.Unruly],[`138398716689`,P.Unruly],[`138398716692`,P.Unruly],[`138398716695`,P.Unruly],[`138398716698`,P.Unruly],[`138398716701`,P.Unruly],[`138398716704`,P.Unruly]])}},$M=D([S(),A(`design:paramtypes`,[typeof(ZM=z!==void 0&&z)==`function`?ZM:Object])],$M)})),eN,tN,nN,Ble=o((()=>{w(),B(),$(),fk(),Fn(),zle(),j(),E(),O(),nN=class extends dk{constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Unruly)),T(this,`_adapterEnablement`,{client:{enabled:!1},server:{enabled:!0,name:P.Unruly}}),T(this,`_bidderCodes`,{primary:P.Unruly,supplemental:[P.UnrulyAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`siteId`],server:[`siteId`]}]]))}},nN=D([Q(`UnrulyBidder`),S(),A(`design:paramtypes`,[typeof(eN=z!==void 0&&z)==`function`?eN:Object,typeof(tN=$M!==void 0&&$M)==`function`?tN:Object])],nN)})),rN,iN,aN,Vle=o((()=>{B(),mk(),w(),X(),j(),E(),O(),iN={applyOptionsToAllBids:[{params:{dcn:`8a9694d00177771bcae21c6941d30023`},match:{integration:`client`,mediaTypesAll:[`banner`]},skip:{device:[`mobile`]}},{params:{dcn:`8a969d580177771bc13c2047d6290082`},match:{integration:`client`,device:[`mobile`],mediaTypesAll:[`banner`]}},{params:{dcn:`8a9698af01888852cc626cda97350021`},match:{integration:`server`,mediaTypesAll:[`banner`]},skip:{device:[`mobile`]}},{params:{dcn:`8a9691d801888852d23d6cda98130025`},match:{integration:`server`,device:[`mobile`],mediaTypesAll:[`banner`]}},{params:{dcn:`8a969469017b7bdf59b2e07862af0281`},match:{integration:`client`},skip:{mediaTypesAll:[`banner`]}},{params:{dcn:`8a9695b901888852d78e6cda98760033`},match:{integration:`server`},skip:{mediaTypesAll:[`banner`]}}],placementsLocation:{_default:{bids:[]},content:{applyToAllBids:{paramLookup:{pos:{map:{"1-client-mobile-300x250":`8a969d580177771bc13c2048bd0e0085`,"1-server-mobile-300x250":`8a9698af01888852cc626cdca59d0028`,"1-client-mobile-320x50":`8a969d580177771bc13c204b68670088`,"1-server-mobile-320x50":`8a9698af01888852cc626cdca7a8002a`,"2-client-mobile-300x250":`8a96918c0177771bc652204877c50094`,"2-server-mobile-300x250":`8a9695b901888852d78e6cdca71a003c`,"2-client-mobile-320x50":`8a96918c0177771bc652204b257e0097`,"2-server-mobile-320x50":`8a9695b901888852d78e6cdca952003d`,"3-client-mobile-300x250":`8a96918c0177771bc6522048f24e0095`,"3-server-mobile-300x250":`8a9698af01888852cc626cdca8b7002b`,"4-client-mobile-300x250":`8a9694d00177771bcae220497831005a`,"4-server-mobile-300x250":`8a9691d801888852d23d6cdca525002c`,"5-client-mobile-300x250":`8a969d580177771bc13c204a5f240087`,"5-server-mobile-300x250":`8a9698af01888852cc626cdcab10002d`,"6-client-mobile-300x250":`8a9694d00177771bcae2204a9092005c`,"6-server-mobile-300x250":`8a9691d801888852d23d6cdca44d002b`,"1-client-*-300x250":`8a969d580177771bc13c20458198007e`,"1-server-*-300x250":`8a9698af01888852cc626cdc9c8a0024`,"1-client-*-728x90":`8a96918c0177771bc65220467ff60092`,"1-server-*-728x90":`8a9698af01888852cc626cdca2ac0026`,"2-client-*-300x250":`8a96918c0177771bc652204531fe0091`,"2-server-*-300x250":`8a9695b901888852d78e6cdc9c0a0036`,"3-client-*-300x250":`8a9694d00177771bcae220463a710058`,"3-server-*-300x250":`8a9698af01888852cc626cdc9e100025`}}}},bids:[{params:{pos:`{sequence}-{integration}-{device}-300x250`},match:{sizesAll:[[300,250]],sequenceMax:3},skip:{device:[`mobile`]}},{params:{pos:`{sequence}-{integration}-{device}-300x250`},match:{sizesAll:[[300,250]],sequenceMax:6,device:[`mobile`]}},{params:{pos:`1-{integration}-desktop-728x90`},match:{sizesAll:[[728,90]],sequence:[1]},skip:{device:[`mobile`]}},{params:{pos:`{sequence}-{integration}-mobile-320x50`},match:{sizesAll:[[320,50]],sequence:[1,2],device:[`mobile`]}}]},footer:{applyToAllBids:{paramLookup:{pos:{map:{"client-*-728x90":`8a9694d00177771bcae21c6a7d880025`,"server-*-728x90":`8a9691d801888852d23d6cdc9b7e0027`,"client-*-970x90":`8a969d580177771bc13c2046cd280081`,"server-*-970x90":`8a9695b901888852d78e6cdc9fb40039`,"client-*-320x50":`8a9694d00177771bcae2204408520056`,"server-*-320x50":`8a9691d801888852d23d6cdc9f220029`,"client-mobile-320x100":`8a96918c0177771bc652204a27cb0096`,"client-mobile-300x50":`8a9694d00177771bcae22049449a0059`,"client-mobile-728x90":`8a9694d00177771bcae2204ad481005d`,"client-mobile-320x50":`8a969d580177771bc13c20480cf50084`,"server-mobile-320x100":`8a9698af01888852cc626cdca68b0029`,"server-mobile-300x50":`8a9695b901888852d78e6cdca4b6003b`,"server-mobile-728x90":`8a9691d801888852d23d6cdca60e002d`,"server-mobile-320x50":`8a9691d801888852d23d6cdcab9a0030`}}}},bids:[{params:{pos:`{integration}-{device}-728x90`},match:{sizesAll:[[728,90]]}},{params:{pos:`{integration}-{device}-320x50`},match:{sizesAll:[[320,50]]}},{params:{pos:`{integration}-desktop-970x90`},match:{sizesAll:[[970,90]]},skip:{device:[`mobile`]}},{params:{pos:`{integration}-mobile-320x100`},match:{sizesAll:[[320,100]],device:[`mobile`]}},{params:{pos:`{integration}-mobile-300x50`},match:{sizesAll:[[300,50]],device:[`mobile`]}}]},header:{bids:[{params:{pos:`8a969d580177771bc13c2045cac4007f`},match:{sequence:[1],sizesAll:[[728,90]],integration:`client`},skip:{device:[`mobile`]}},{params:{pos:`8a9691d801888852d23d6cdca335002a`},match:{sequence:[1],sizesAll:[[728,90]],integration:`server`},skip:{device:[`mobile`]}}]},interstitial:{applyToAllBids:{paramLookup:{pos:{map:{"*-300x250":`8a969449017c7c9d384d9f8170b10066`,"*-300x600":`8a969449017c7c9d384d9f80b9970064`,"*-320x480":`8a969958017c7c9d2d8a9f812d360081`,"*-336x280":`8a969449017c7c9d384d9f80f2a20065`,"mobile-300x250":`8a969161017c7c9d32879f82491c007d`,"mobile-300x600":`8a969161017c7c9d32879f8195b3007c`,"mobile-320x480":`8a969958017c7c9d2d8a9f81f2c50082`,"mobile-336x280":`8a969449017c7c9d384d9f81c5660067`,"mobile-320x50":`8a969449017c7c9d384d9f8279950068`}}}},bids:[{params:{pos:`{device}-300x250`},match:{sizesAll:[[300,250]]}},{params:{pos:`{device}-300x600`},match:{sizesAll:[[300,600]]}},{params:{pos:`{device}-320x480`},match:{sizesAll:[[320,480]]}},{params:{pos:`{device}-336x280`},match:{sizesAll:[[336,280]]}},{params:{pos:`{device}-320x50`},match:{sizesAll:[[320,50]],device:[`mobile`]}}]},sidebar:{applyToAllBids:{paramLookup:{pos:{map:{"1-client-300x250":`8a9694d00177771bcae2204449d80057`,"1-server-300x250":`8a9695b901888852d78e6cdc9a960035`,"9-client-320x50":`8a969d580177771bc13c2045ff6b0080`,"9-client-300x600":`8a96918c0177771bc6522043c8540090`,"9-client-160x600":`8a969d580177771bc13c2044ea91007d`,"9-client-300x250":`8a96918c0177771bc6521c6b5f4e003f`,"9-server-320x50":`8a9695b901888852d78e6cdca1b7003a`,"9-server-300x600":`8a9698af01888852cc626cdc9b0e0023`,"9-server-160x600":`8a9698af01888852cc626cdca3db0027`,"9-server-300x250":`8a9691d801888852d23d6cdc9cfd0028`}}}},bids:[{params:{pos:`{placementMapSequence}-{integration}-300x250`},match:{sizesAll:[[300,250]],sequence:[1,9]},skip:{device:[`mobile`]}},{params:{pos:`9-{integration}-320x50`},match:{sizesAll:[[320,50]],sequenceMin:9},skip:{device:[`mobile`]}},{params:{pos:`9-{integration}-300x600`},match:{sizesAll:[[300,600]],sequenceMin:9},skip:{device:[`mobile`]}},{params:{pos:`9-{integration}-160x600`},match:{sizesAll:[[160,600]],sequenceMin:9},skip:{device:[`mobile`]}}]},recipe:{applyToAllBids:{paramLookup:{pos:{map:{"1-client-*-300x250":`8a9694d00177771bcae21c6bc7e80027`,"1-server-*-300x250":`8a9695b901888852d78e6cdc9d800037`,"2-client-*-300x250":`8a969d580177771bc13c2044ac08007c`,"2-server-*-300x250":`8a9695b901888852d78e6cdc9ea70038`,"1-client-mobile-300x250":`8a96918c0177771bc6522048483a0093`,"1-server-mobile-300x250":`8a9691d801888852d23d6cdcaa71002f`,"2-client-mobile-300x250":`8a9694d00177771bcae22049e596005b`,"2-server-mobile-300x250":`8a9691d801888852d23d6cdca826002e`,"3-client-mobile-300x250":`8a969d580177771bc13c2049b47f0086`,"3-server-mobile-300x250":`8a9698af01888852cc626cdca9ed002c`}}}},bids:[{params:{pos:`{placementMapSequence}-{integration}-*-300x250`},match:{sizesAll:[[300,250]]},skip:{sequence:[3,4,5],device:[`mobile`]}},{params:{pos:`{placementMapSequence}-{integration}-mobile-300x250`},match:{sizesAll:[[300,250]],device:[`mobile`]},skip:{sequence:[4,5]}}]},video_stickyoutstream:{bids:[{params:{pos:`8a969d87017b7be074aae07a22b70005`},match:{sizesAny:[[300,250],[300,50]],integration:`client`}},{params:{pos:`8a9695b901888852d78e6ce0245f0040`},match:{sizesAny:[[300,250],[300,50]],integration:`server`}}]},video_collapse_autoplay_soundoff:{bids:[{params:{pos:`8a96941a017e7e91c49492261bdf000c`},match:{integration:`client`}},{params:{pos:`8a9695b901888852d78e6cde78c2003e`},match:{integration:`server`}}]},video_coll_soff_smartphone:{bids:[{params:{pos:`8a9690ee017e7e91bee0922682f1000b`},match:{integration:`client`}},{params:{pos:`8a9698af01888852cc626cde79b3002e`},match:{integration:`server`}}]},video_in_post_clicktoplay_soundon:{bids:[{params:{pos:`8a969951017e7e91ba38923576c20011`},match:{integration:`client`}},{params:{pos:`8a9695b901888852d78e6cde7a3b003f`},match:{integration:`server`}}]},video_individual_autoplay_soff:{bids:[{params:{pos:`8a969951017e7e91ba389236dc470014`},match:{integration:`client`}},{params:{pos:`8a9691d801888852d23d6cde79390031`},match:{integration:`server`}}]}}},aN=class extends pk{constructor(e){super(e,iN),T(this,`_videoCreativeIds`,[[`138379204183`,P.YahooSSP],[`138378707447`,P.YahooSSP],[`138378707558`,P.YahooSSP],[`138378717711`,P.YahooSSP],[`138378717726`,P.YahooSSP],[`138378706907`,P.YahooSSP],[`138378706928`,P.YahooSSP],[`138378707468`,P.YahooSSP],[`138378707561`,P.YahooSSP],[`138378717720`,P.YahooSSP],[`138378717783`,P.YahooSSP],[`138378707552`,P.YahooSSP],[`138378717723`,P.YahooSSP],[`138378717780`,P.YahooSSP],[`138378717786`,P.YahooSSP],[`138378707555`,P.YahooSSP],[`138437164046`,P.YahooSSPServer],[`138437164367`,P.YahooSSPServer],[`138437170553`,P.YahooSSPServer],[`138437192487`,P.YahooSSPServer],[`138437199522`,P.YahooSSPServer],[`138437199525`,P.YahooSSPServer],[`138437199528`,P.YahooSSPServer],[`138437854447`,P.YahooSSPServer]])}},aN=D([S(),A(`design:paramtypes`,[typeof(rN=z!==void 0&&z)==`function`?rN:Object])],aN)})),oN,sN,cN,lN,Hle=o((()=>{w(),B(),Fn(),$(),Z(),fk(),jc(),Vle(),j(),E(),O(),lN=class extends dk{constructor(e,t,n){super(e,t),this._prebidMethods=n,T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.YahooSSP)),T(this,`gvlid`,25),T(this,`_adapterEnablement`,{client:Oi()?{enabled:!1}:{enabled:!0,name:P.YahooSSP},server:{enabled:!0,name:P.YahooSSP}}),T(this,`_bidderCodes`,{primary:P.YahooSSP,secondary:P.YahooSSPServer,supplemental:[P.YahooSSPAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`dcn`,`pos`],server:[`dcn`,`pos`]}]])),this._setYahooMediaConfig()}_setYahooMediaConfig(){this._prebidMethods.setConfig({yahoossp:{mode:`all`}},!1)}},lN=D([Q(`YahooSSPBidder`),S(),A(`design:paramtypes`,[typeof(oN=z!==void 0&&z)==`function`?oN:Object,typeof(sN=aN!==void 0&&aN)==`function`?sN:Object,typeof(cN=R!==void 0&&R)==`function`?cN:Object])],lN)})),uN,dN,fN,Ule=o((()=>{B(),mk(),w(),X(),j(),E(),O(),dN={placementsLocation:{_default:{bids:[{params:{placementId:`2626064683911553041`},match:{mediaTypesAll:[`banner`]},skip:{locations:[`below_post`,`content`,`recipe`,`sidebar`]}},{params:{placementId:`2626064683911553041`},match:{mediaTypesAll:[`banner`],nativeEnabled:!1,locations:[`content`,`recipe`]},skip:{adTypes:[`miniscroller`]}},{params:{placementId:`2626064685606051869`},match:{mediaTypesAll:[`banner`],nativeEnabled:!0,locations:[`content`,`recipe`]},skip:{adTypes:[`miniscroller`]}},{params:{placementId:`2626064685069180953`},match:{mediaTypesAll:[`banner`],adTypes:[`miniscroller`],nativeEnabled:!1,locations:[`content`,`recipe`]}},{params:{placementId:`2626064685203398682`},match:{mediaTypesAll:[`banner`],nativeEnabled:!0,adTypes:[`miniscroller`],locations:[`content`,`recipe`]}},{params:{placementId:`2626064684062547986`},match:{mediaTypesAll:[`outstream`],nativeEnabled:!1},skip:{adTypes:[`miniscroller`],locations:[`below_post`]}},{params:{placementId:`2626064684339372052`},match:{mediaTypesAll:[`outstream`],nativeEnabled:!0},skip:{adTypes:[`miniscroller`],locations:[`below_post`]}},{params:{placementId:`2626064684196765715`},match:{mediaTypesAll:[`outstream`],nativeEnabled:!1,adTypes:[`miniscroller`]},skip:{locations:[`below_post`]}},{params:{placementId:`2626064684632973334`},match:{mediaTypesAll:[`outstream`],nativeEnabled:!0,adTypes:[`miniscroller`],locations:[`content`,`recipe`]},skip:{locations:[`below_post`]}}]},below_post:{bids:[{params:{placementId:`2626064683911553041`},match:{mediaTypesAll:[`banner`],lazy:!1}},{params:{placementId:`2626064683911553041`},match:{mediaTypesAll:[`banner`],lazy:!0},skip:{adTypes:[`miniscroller`]}},{params:{placementId:`2626064685069180953`},match:{mediaTypesAll:[`banner`],adTypes:[`miniscroller`],lazy:!0}},{params:{placementId:`2626064684062547986`},match:{mediaTypesAll:[`outstream`],lazy:!0},skip:{adTypes:[`miniscroller`]}},{params:{placementId:`2626064684196765715`},match:{mediaTypesAll:[`outstream`],adTypes:[`miniscroller`],lazy:!0}},{params:{placementId:`2626064684062547986`},match:{mediaTypesAll:[`outstream`],lazy:!1}}]},content:{bids:[{params:{placementId:`2626064684498755605`},match:{mediaTypesAll:[`outstream`],nativeEnabled:!1,sequence:[1],device:[`mobile`],mobileStickyPlayerOnPage:!1},skip:{adTypes:[`miniscroller`]},supplemental:!1},{params:{placementId:`2626807131797397582`},match:{mediaTypesAll:[`outstream`],nativeEnabled:!0,sequence:[1],device:[`mobile`],mobileStickyPlayerOnPage:!1},skip:{adTypes:[`miniscroller`]},supplemental:!1},{params:{placementId:`2626064684775579671`},match:{mediaTypesAll:[`outstream`],nativeEnabled:!1,sequence:[1],adTypes:[`miniscroller`],device:[`mobile`],mobileStickyPlayerOnPage:!1},supplemental:!1},{params:{placementId:`2626064684934963224`},match:{mediaTypesAll:[`outstream`],nativeEnabled:!0,sequence:[1],adTypes:[`miniscroller`],device:[`mobile`],mobileStickyPlayerOnPage:!1},supplemental:!1}]},footer:{bids:[{params:{placementId:`3457550240226157077`},match:{stickyOutstreamEnabled:!1}}]},sidebar:{bids:[{params:{placementId:`2626064683911553041`},match:{mediaTypesAll:[`banner`],device:[`mobile`]}},{params:{placementId:`2626064683911553041`},match:{mediaTypesAll:[`banner`],nativeEnabled:!1},skip:{device:[`mobile`]}},{params:{placementId:`2626064685606051869`},match:{mediaTypesAll:[`banner`],nativeEnabled:!0},skip:{device:[`mobile`]}}]},video_stickyoutstream:{bids:[{params:{placementId:`3154492104504189746`}}]},video_collapse_autoplay_soundoff:{bids:[{params:{placementId:`3137192266624344610`}}]},video_coll_soff_smartphone:{bids:[{params:{placementId:`3137192266808893988`}}]},video_individual_autoplay_soff:{bids:[{params:{placementId:`3137192266716619299`}}]}}},fN=class extends pk{constructor(e){super(e,dN),T(this,`_videoCreativeIds`,[[`138463806447`,P.Yieldmo],[`138463975208`,P.Yieldmo],[`138463975223`,P.Yieldmo],[`138464489752`,P.Yieldmo],[`138464489758`,P.Yieldmo],[`138464489761`,P.Yieldmo],[`138464490757`,P.Yieldmo],[`138464490775`,P.Yieldmo]])}},fN=D([S(),A(`design:paramtypes`,[typeof(uN=z!==void 0&&z)==`function`?uN:Object])],fN)})),pN,mN,hN,Wle=o((()=>{w(),B(),$(),fk(),Fn(),Ule(),j(),E(),O(),hN=class extends dk{getCreativeFormatId(e){let t=/creative_format_id":(\d*)/.exec(e);if(t!==null)return t[1]}constructor(e,t){super(e,t),T(this,`bidderConfig`,this._config.partners.getBidderConfig(P.Yieldmo)),T(this,`_adapterEnablement`,{client:{enabled:!1},server:{enabled:!0,name:P.Yieldmo}}),T(this,`_bidderCodes`,{primary:P.Yieldmo,supplemental:[P.YieldmoAY]}),T(this,`_mediatypeEnablement`,[W.banner,W.outstream,W.instream]),T(this,`_requiredProperties`,new Map([[`default`,{client:[`placementId`],server:[`placementId`]}]])),T(this,`_settings`,{adserverTargeting:[{key:`hb_attr`,val:e=>{var t,n,r;let i=(t=this._creativeFormatMap.get(this.getCreativeFormatId(e.ad)))==null?e.mediaType:t,a=e.mediaType===`banner`&&((n=e.meta)==null?void 0:n.mediaType)===`video`||((r=e.meta)==null?void 0:r.isInBannerVideo);return a&&(i=`ibv`),i}}]}),T(this,`_creativeFormatMap`,new Map([[`44`,`banner`],[`47`,`banner`],[`49`,`banner`],[`50`,`banner`],[`43`,`banner`],[`17`,`banner`],[`23`,`banner`],[`33`,`banner`],[`40`,`outstream`],[`51`,`outstream`],[`48`,`outstream`],[`34`,`outstream`],[`14`,`miniscroller`],[`16`,`miniscroller`],[`37`,`miniscroller`],[`15`,`miniscroller`],[`18`,`native`],[`36`,`native`],[`46`,`native`],[`10`,`native`],[`6`,`native`]]))}},hN=D([Q(`YieldmoBidder`),S(),A(`design:paramtypes`,[typeof(pN=z!==void 0&&z)==`function`?pN:Object,typeof(mN=fN!==void 0&&fN)==`function`?mN:Object])],hN)})),gN={};c(gN,{AdaptMxBidder:()=>Ek,AdformBidder:()=>Nk,AidemBidder:()=>Bk,AppNexusBidder:()=>Jk,BidMediaTypes:()=>W,Bidder:()=>dk,BidderBase:()=>ak,ConnatixBidder:()=>eA,ConversantBidder:()=>oA,CriteoBidder:()=>hA,FlippBidder:()=>xA,GumGumBidder:()=>DA,ImproveDigitalBidder:()=>NA,IndexExchangeBidder:()=>VA,KargoBidder:()=>YA,MediaGridBidder:()=>ij,MediaGridVideoBidder:()=>sj,MediaTypes:()=>uk,NativoBidder:()=>pj,OguryBidder:()=>Ej,OpenXBidder:()=>bj,OzoneBidder:()=>Nj,PubMaticBidder:()=>Vj,RiseBidder:()=>Jj,RtbHouseBidder:()=>nM,RubiconBidder:()=>cM,SharethroughBidder:()=>mM,StackAdaptBidder:()=>bM,TTDBidder:()=>RM,TeadsBidder:()=>EM,ThirtyThreeAcrossBidder:()=>bk,TripleLiftBidder:()=>MM,UndertoneBidder:()=>qM,UndertoneServerBidder:()=>XM,UnrulyBidder:()=>nN,YahooSSPBidder:()=>lN,YieldmoBidder:()=>hN});var Gle=o((()=>{fk(),ok(),Lce(),zce(),Vce(),Uce(),Gce(),qce(),Yce(),Zce(),$ce(),tle(),rle(),ale(),sle(),cle(),lle(),dle(),ple(),hle(),_le(),yle(),xle(),wle(),Ele(),Ole(),Ale(),Mle(),Ple(),Ile(),Lle(),Rle(),Ble(),Hle(),Wle()})),_N,vN,yN,bN,xN,SN,CN,wN,TN,EN,DN,ON,kN,AN,jN,MN,NN,PN,FN,IN,LN,RN,zN,BN,VN,HN,UN,WN,GN,KN,qN,JN,YN,XN,ZN,Kle=o((()=>{w(),B(),Gle(),j(),E(),O(),ZN=class{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v,y,b,ee,te,ne,re,ie,ae,oe,se,ce,le,ue,de,fe){this._config=e,T(this,`_orderedDisplayBidders`,[]),T(this,`_orderedVideoBidders`,[]),T(this,`_biddersParams`,new Map),T(this,`_videoCreativeIdMapping`,void 0),T(this,`_multiFormatBidders`,void 0);let pe=[u,r,l,re,y,p,b,_,m,ie,f,a,d,ne,h,s,o,g,i,ee,v,n,ae,te,c,oe,se,ce,le,ue,de,fe,t];pe.forEach(e=>{e.setup();let{display:t,video:n}=this._getBidderEnablement(e);t&&this._orderedDisplayBidders.push(e),n&&this._orderedVideoBidders.push(e)}),this._multiFormatBidders=this._orderedDisplayBidders.filter(e=>e.multiformatBidder),this._videoCreativeIdMapping=this._setVideoCreativeIdMap()}get orderedDisplayBidders(){return this._orderedDisplayBidders}get multiFormatBidders(){return this._multiFormatBidders}get orderedVideoBidders(){return this._orderedVideoBidders}get biddersParams(){return this._biddersParams}get videoCreativeIdMapping(){return this._videoCreativeIdMapping}_setVideoCreativeIdMap(){return new Map(this._orderedVideoBidders.reduce((e,t)=>e.concat(t.videoCreativeIds),[]))}_getBidderEnablement(e){let t=this._config,n=e.name,r=e.adapterEnablement.client.enabled?`client`:`server`,i=e.adapterEnablement[r].enabled?e.adapterEnablement[r].name:e.name,a={adapterName:i,bidderName:n,ccpa:t.ccpa,gdpr:t.gdpr,enablement:{display:{holdout:t.hbho.bidders,enabled:[`bidderDisplayEnabled`,`enabled`]},video:{holdout:t.vbho.bidders,enabled:[`bidderInstreamEnabled`,`videoEnabled`]}}};return this._getEnablement(e,a)}_getEnablement(e,t){let n={display:!1,video:!1},r=[`display`,`video`],{adapterName:i,bidderName:a,ccpa:o,gdpr:s}=t;return r.forEach(r=>{let c=t.enablement[r],l=c.holdout,u=c.enabled,d=r===`video`||!e.updateBidParams;n[r]=!!(u.every(t=>e[t])&&this._holdoutValidation(l,a,i)&&this._ccpaValidation(o,a,i)&&this._gdprValidation(s,a,i)&&(d||this._biddersParams.set(a,e)))}),n}_holdoutValidation(e,t,n){return!e.length||(!n||!e.includes(n))&&!e.includes(t)}_ccpaValidation(e,t,n=``){return!e.enabled||!e.nonCompliantBidders.includes(n)&&!e.nonCompliantBidders.includes(t)}_gdprValidation(e,t,n=``){return!e.enabled||!e.nonCompliantBidders.includes(n)&&!e.nonCompliantBidders.includes(t)}},ZN=D([C(),A(`design:paramtypes`,[typeof(_N=z!==void 0&&z)==`function`?_N:Object,typeof(vN=gN!==void 0&&gN.AdaptMxBidder)==`function`?vN:Object,typeof(yN=gN!==void 0&&gN.AdformBidder)==`function`?yN:Object,typeof(bN=gN!==void 0&&gN.AppNexusBidder)==`function`?bN:Object,typeof(xN=gN!==void 0&&gN.ConversantBidder)==`function`?xN:Object,typeof(SN=gN!==void 0&&gN.CriteoBidder)==`function`?SN:Object,typeof(CN=gN!==void 0&&gN.MediaGridVideoBidder)==`function`?CN:Object,typeof(wN=gN!==void 0&&gN.GumGumBidder)==`function`?wN:Object,typeof(TN=gN!==void 0&&gN.ImproveDigitalBidder)==`function`?TN:Object,typeof(EN=gN!==void 0&&gN.IndexExchangeBidder)==`function`?EN:Object,typeof(DN=gN!==void 0&&gN.KargoBidder)==`function`?DN:Object,typeof(ON=gN!==void 0&&gN.MediaGridBidder)==`function`?ON:Object,typeof(kN=gN!==void 0&&gN.OpenXBidder)==`function`?kN:Object,typeof(AN=gN!==void 0&&gN.PubMaticBidder)==`function`?AN:Object,typeof(jN=gN!==void 0&&gN.RubiconBidder)==`function`?jN:Object,typeof(MN=gN!==void 0&&gN.NativoBidder)==`function`?MN:Object,typeof(NN=gN!==void 0&&gN.SharethroughBidder)==`function`?NN:Object,typeof(PN=gN!==void 0&&gN.TeadsBidder)==`function`?PN:Object,typeof(FN=gN!==void 0&&gN.ThirtyThreeAcrossBidder)==`function`?FN:Object,typeof(IN=gN!==void 0&&gN.TripleLiftBidder)==`function`?IN:Object,typeof(LN=gN!==void 0&&gN.TTDBidder)==`function`?LN:Object,typeof(RN=gN!==void 0&&gN.UndertoneBidder)==`function`?RN:Object,typeof(zN=gN!==void 0&&gN.UndertoneServerBidder)==`function`?zN:Object,typeof(BN=gN!==void 0&&gN.UnrulyBidder)==`function`?BN:Object,typeof(VN=gN!==void 0&&gN.YahooSSPBidder)==`function`?VN:Object,typeof(HN=gN!==void 0&&gN.YieldmoBidder)==`function`?HN:Object,typeof(UN=gN!==void 0&&gN.RtbHouseBidder)==`function`?UN:Object,typeof(WN=gN!==void 0&&gN.OzoneBidder)==`function`?WN:Object,typeof(GN=gN!==void 0&&gN.AidemBidder)==`function`?GN:Object,typeof(KN=gN!==void 0&&gN.FlippBidder)==`function`?KN:Object,typeof(qN=gN!==void 0&&gN.RiseBidder)==`function`?qN:Object,typeof(JN=gN!==void 0&&gN.OguryBidder)==`function`?JN:Object,typeof(YN=gN!==void 0&&gN.StackAdaptBidder)==`function`?YN:Object,typeof(XN=gN!==void 0&&gN.ConnatixBidder)==`function`?XN:Object])],ZN)})),QN,qle=o((()=>{Ui(),w(),E(),O(),QN=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`CreativeMonitoring`,this._lookup=`CRTVMON`}},QN=D([C()],QN)})),$N,eP,tP,nP,rP,iP,aP,Jle=o((()=>{w(),B(),Ra(),$(),qle(),vh(),Bh(),rU(),j(),E(),O(),aP=class{constructor(e,t,n,r,i,a){this._config=e,this._context=t,this._prebidEventBus=n,this._slots=r,this._creativeMonitoringExperiment=i,this._gamEventBus=a,T(this,`_auctionData`,new Set),T(this,`_gamRenderedData`,new Map)}setupCreativeEventListeners(){let e=this._prebidEventBus;e.auctionInit.on(this._storeAuctionData.bind(this)),e.adRenderFailed.on(this._renderFailedHandler.bind(this)),e.adRenderSucceeded.on(this._renderSucceededHandler.bind(this)),e.staleRender.on(this._staleRenderHandler.bind(this)),this._gamEventBus.slotRenderEnded.on(this._slotRenderEnded.bind(this)),this._gamEventBus.slotRequested.on(this._slotRequested.bind(this))}_slotRequested(e){let t=this._slots.get(e.slotId);if(!t)return;let n=t.id;this._gamRenderedData.has(n)&&this._gamRenderedData.delete(n)}_slotRenderEnded(e){let t=this._slots.get(e.slotId);t&&(this._gamRenderedData.set(t.id,e),this._creativeMonitoringExperiment.result&&this._checkSlotRender(e))}_storeAuctionData(e){e.adUnitCodes.forEach(t=>this._auctionData.add(`${e.auctionId}-${t}`))}_deleteStoredAuction(e,t){this._auctionData.delete(`${e}-${t}`)}_getSlotData(e){let t=this._slots.get(e);return{...t&&{slot:t.location,sequence:t.sequence,nref:t.refreshCount}}}_getGAMCreativeData(e){let t=this._gamRenderedData.get(e);return t?{lineItemId:t.event.lineItemId,creativeId:t.event.creativeId,campaignId:t.event.campaignId}:{}}_getBidData(e){return e?{...this._getPrebidBidDataFromBid(e),...this._getSlotData(e.adUnitCode),...this._getGAMCreativeData(e.adUnitCode)}:{}}_renderFailedHandler(e){setTimeout(()=>{let t=e.bid;t&&this._deleteStoredAuction(t.auctionId,t.adUnitCode);let n={message:e.message,reason:e.reason,...this._getBidData(t)};t&&t.meta&&Object.keys(t.meta).length>0?n.buyerInformation=t.meta:n.markup=t&&t.ad,M.error(`PrebidAuctionManager`,`init`,`adRenderFailed`,n)},2e3)}_staleRenderHandler(e){e&&this._deleteStoredAuction(e.auctionId,e.adUnitCode),setTimeout(()=>{M.error(`PrebidAuctionManager`,`init`,`staleRender`,{...this._getBidData(e)})},2e3)}_renderSucceededHandler(e){let t=e.bid;t&&this._deleteStoredAuction(t.auctionId,t.adUnitCode)}_isSafeFrame(e){let t=e.element.querySelector(`iframe`);return!!(t&&t.src)}_checkSlotRender(e){let t=e.event,n=this._slots.get(e.slotId),r=this._config.prebid.advertiserId;!n||this._isSafeFrame(n)||t.advertiserId!==r||setTimeout(()=>{this._logUnknownFailure(e)},2e3)}_getHeightWidth(e){if(!e)return{};let t=e.split(`x`).map(Number);return{...Array.isArray(t)&&t.length===2&&{height:t[1],width:t[0]}}}_getPrebidCreativeWindowData(e){return{adId:e.bidderAdId,bidder:e.bidder,size:e.bidderSize,adserverTargeting:e.targeting}}_getPrebidBidDataFromBid(e){return{price:e.adserverTargeting.hb_pb,bidderSize:e.size||e.adserverTargeting.hb_size,advertiserDomains:e.meta&&e.meta.advertiserDomains||e.adserverTargeting.hb_adomain,bidder:e.bidder}}_getPrebidBidderDataFromIframe(e){let t=e.element.querySelector(`iframe`),n=t.contentWindow;if(!n)return{};let{adId:r,adserverTargeting:i,bidder:a,size:o}=this._getPrebidCreativeWindowData(n),{height:s,width:c}=this._getHeightWidth(n&&n.bidderSize);return{adId:r,adserverTargeting:i,adUnitCode:e.id,bidder:a,height:s,size:o,width:c}}_logUnknownFailure(e){let t=this._context,n=this._slots.get(e.slotId);if(!n)return;let r=e.event,{adId:i,adserverTargeting:a,auctionId:o,adUnitCode:s,bidder:c,height:l,meta:u,size:d,width:f}=n.servedPrebidBidResponse||this._getPrebidBidderDataFromIframe(n);if(o&&s&&!this._auctionData.has(`${o}-${s}`))return;let p={adId:i,advertiserDomains:u&&u.advertiserDomains||a&&a.hb_adomain,bidderSize:d||a&&a.hb_size,bidder:c,branch:t.branch,bucket:t.bucket,campaignId:r.campaignId,creativeId:r.creativeId||r.sourceAgnosticCreativeId,lineItemId:r.lineItemId||r.sourceAgnosticLineItemId,message:`An unknown error occurred rendering the Prebid creative`,nref:n.refreshCount,price:a&&a.hb_pb,sequence:n.sequence,slotSizes:n.sizes,slot:n.location,...f&&l&&{size:[f,l]},...u&&(u.dchain&&{dchain:u.dchain}||u.networkId&&{networkId:u.networkId}),...(!i||i.length<2)&&a&&{hbAdId:a.hb_adid}};M.error(`PrebidAuctionManager`,`init`,`prebidCreativeFailure`,p),o&&s&&this._deleteStoredAuction(o,s)}},aP=D([C(),A(`design:paramtypes`,[typeof($N=z!==void 0&&z)==`function`?$N:Object,typeof(eP=L!==void 0&&L)==`function`?eP:Object,typeof(tP=Pr!==void 0&&Pr)==`function`?tP:Object,typeof(nP=_h!==void 0&&_h)==`function`?nP:Object,typeof(rP=QN!==void 0&&QN)==`function`?rP:Object,typeof(iP=zh!==void 0&&zh)==`function`?iP:Object])],aP)})),oP,Yle=o((()=>{w(),$(),O(),oP=class{setOseq(e,t,n){let r=`${e.sequence}`,{id:i,bidPoolId:a}=e,{hb_bidder:o,hb_adid:s}=n;if(t){for(let e=t.length-1;e>=0;e--)if(t[e].bidderCode===o&&t[e].adId===s){r=this.getSeqFromAdUnitCode(t[e].adUnitCode),t[e];break}}e&&e.setSlotTargetingFlag(`oseq`,[r],!0)}getSeqFromAdUnitCode(e){let t=(e||``).match(/AdThrive_.*?_(\d+)\_\S+$/);return t&&t.length?t[1]:``}},oP=D([Q(`OSeq`),S()],oP)})),sP,Xle=o((()=>{mU(),$(),w(),j(),O(),sP=class extends pU{init(){this._key=`DemandChain`,this._lookup=`DCO`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],sP.prototype,`run`,null),sP=D([C()],sP)})),cP,Zle=o((()=>{cP={buckets:[{precision:2,max:.1,increment:.01},{precision:2,max:5,increment:.05},{precision:2,max:20,increment:.1},{precision:2,max:100,increment:.5}]}})),lP,uP,dP,Qle=o((()=>{w(),B(),Ra(),Z(),X(),j(),E(),O(),dP=class{constructor(e,t){this._config=e,this._context=t,T(this,`_configuration`,{suppressEmptyKeys:!0,adserverTargeting:[{key:`hb_bidder`,val:e=>e.bidderCode},{key:`hb_adid`,val:e=>e.adId},{key:`hb_pb`,val:e=>e.pbCg},{key:`hb_size`,val:e=>this._config.video.instreamAdUnits.has(e.adUnitCode)?``:e.size},{key:`hb_deal`,val:e=>e.dealId},{key:`hb_format`,val:e=>e.mediaType},{key:`hb_adomain`,val:e=>e.meta&&e.meta.advertiserDomains?e.meta.advertiserDomains[0]:e.meta&&e.meta.advertiserId},{key:`hb_dsp`,val:e=>this.getDsp(e)},{key:`hb_crid`,val:e=>e.creativeId},{key:`hb_dur`,val:e=>e.duration},{key:`hb_source`,val:e=>{let t=this._config.prebid,n=e==null?void 0:e.pbsHost,r;if(t.s2s.bidders.includes(e.bidderCode)){let{ayServerEnabled:e}=t,i=n&&e?`sa`:`sr`;r=i==null?`sr`:i}else r=`c`;return r}},{key:`hb_attr`,val:e=>{var t,n;if(e.mediaType===`banner`&&((t=e.meta)==null?void 0:t.mediaType)===`video`||(n=e.meta)!=null&&n.isInBannerVideo)return`ibv`}},{key:`ismobile`,val:e=>{let t=e.mediaType===`native`&&tG();return t?String(t):void 0}}]})}get configuration(){return this._configuration}getDsp(e){var t;let n=e.bidderCode,r=(t=e.creativeId)==null||(t=t.toString().split(`_`))==null?void 0:t[0],i=e.meta;if(r&&(n===P.TripleliftServer||n===P.Kargo))return r;if(n===P.TTD)return`ttd`;if(n===P.YahooSSP||n===P.YahooSSPServer)return`yahoo`;if(i!=null&&i.dspid&&(n===P.IndexExchangeServer||n===P.PubmaticServer))return i.dspid;if(i!=null&&i.demandSource&&n===P.MediaGrid)return i.demandSource;if(i){var a,o,s;return(a=(o=i.networkId)==null?i.networkName:o)==null?(s=i.dchain)==null?void 0:s.nodes.reverse()[0].bsid:a}}},dP=D([C(),A(`design:paramtypes`,[typeof(lP=z!==void 0&&z)==`function`?lP:Object,typeof(uP=L!==void 0&&L)==`function`?uP:Object])],dP)})),fP,pP,$le=o((()=>{Ui(),$(),w(),E(),j(),O(),fP=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`OpenPathLiveIntent`,this._lookup=`OPLI`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],fP.prototype,`run`,null),fP=D([Q(`OpenPathLiveIntentExperiment`),C()],fP),pP=fP})),mP,eue=o((()=>{mU(),w(),E(),O(),mP=class extends pU{constructor(...e){super(...e),T(this,`eidMap`,new Map([[`idl`,`idl_env`],[`id5`,`id5id`],[`pubcid`,`pubcid`],[`uid1`,`tdid`],[`li_uid2`,`uid2`],[`cid`,`connectId`],[`lpid`,`lotamePanoramaId`],[`li_bdsw`,`bidswitch`]]))}init(){this._key=`FirstEidExperiment`,this._lookup=`1ST_EID2`}get result(){if(!(!this._result||this._result===`none`))return this.eidMap.get(this._result)}},mP=D([C()],mP)})),hP,tue=o((()=>{mU(),$(),w(),O(),hP=class extends pU{init(){this._key=`Uid1AdserverExperiment`,this._lookup=`UID1SRC`}},hP=D([Q(`Uid1AdserverExperiment`),C()],hP)})),gP,_P,vP,yP,bP,nue=o((()=>{w(),B(),$le(),eue(),tue(),X(),j(),O(),bP=class{constructor(e,t,n,r){this._config=e,this._openPathLiveIntentExperiment=t,this._firstEidExperiment=n,this._uid1AdserverExperiment=r}getUserSyncConfig(){return{...this._firstEidExperiment.result&&{firstEid:this._firstEidExperiment.result},syncEnabled:!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut,idPriority:{tdid:this._openPathLiveIntentExperiment.result?[`liveIntentId`,`unifiedId`]:[`unifiedId`,`liveIntentId`]},auctionDelay:this._config.prebid.auctionDelay,syncsPerBidder:1,aliasSyncEnabled:!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut,enableOverride:!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut,filterSettings:{iframe:{bidders:`*`,filter:`include`}},topics:{bidders:[{bidder:P.Pubmatic,iframeURL:`https://ads.pubmatic.com/AdServer/js/topics/topics_frame.html`}]},...this._uid1AdserverExperiment.result&&{uid1Adsrvr:this._uid1AdserverExperiment.result}}}},bP=D([C(),A(`design:paramtypes`,[typeof(gP=z!==void 0&&z)==`function`?gP:Object,typeof(_P=pP!==void 0&&pP)==`function`?_P:Object,typeof(vP=mP!==void 0&&mP)==`function`?vP:Object,typeof(yP=hP!==void 0&&hP)==`function`?yP:Object])],bP)})),xP,SP,rue=o((()=>{w(),B(),j(),E(),O(),SP=class{constructor(e){this._config=e,T(this,`_clientVendorExceptions`,[`appnexus`]),T(this,`_serverVendorExceptions`,void 0),T(this,`_uspConfig`,{usp:this._getUspConfig()}),T(this,`_gdprConfig`,{}),this._serverVendorExceptions=this._config.prebid.s2s.bidders,this._gdprConfig={gdpr:{cmpApi:`iab`,timeout:25e3,defaultGdprScope:!0,rules:[{purpose:`storage`,enforcePurpose:!0,enforceVendor:!0},{purpose:`basicAds`,enforcePurpose:!0,enforceVendor:!0,vendorExceptions:this._clientVendorExceptions.concat(this._serverVendorExceptions)},{purpose:`personalizedAds`,enforcePurpose:!0,enforceVendor:!0},{purpose:`measurement`,enforcePurpose:!0,enforceVendor:!0}]}}}_getUspConfig(){return this._config.ccpa.required?{cmpApi:`iab`,timeout:0}:{cmpApi:`static`,consentData:{getUSPData:{uspString:`1---`}}}}getConsentManagementConfig(){return this._config.gdpr.enabled===!0?this._gdprConfig:this._uspConfig}},SP=D([C(),A(`design:paramtypes`,[typeof(xP=z!==void 0&&z)==`function`?xP:Object])],SP)})),CP,wP,iue=o((()=>{w(),B(),j(),E(),O(),wP=class{constructor(e){this._config=e,T(this,`_checkPurpose1Consent`,e=>{if(typeof window.__cmp!=`function`)return!1;try{let r=window.__cmp(`getCMPData`);if(r){var t,n;let i=(r==null||(t=r.vendorConsents)==null?void 0:t[e])===!0,a=(r==null||(n=r.purposeConsents)==null?void 0:n[1])===!0;return!i||!a}}catch(t){return console.warn(`Raptive::Error while checking consent for vendorId: ${e} `,t),!1}return!1})}_isCCPAConsentDenied(){return!!this._config.ccpa.userOptedOut}_isAct25ConsentDenied(){return this._config.act25.required&&!this._config.act25.consented}getAllowActivities(){let e={rules:[{condition:()=>this._isCCPAConsentDenied()||this._isAct25ConsentDenied(),allow:!1}]};return{reportAnalytics:{rules:[{condition:()=>this._isCCPAConsentDenied(),allow:!1}]},enrichUfpd:{...e},enrichEids:{...e},syncUser:{...e},transmitEids:{...e},transmitPreciseGeo:{...e},transmitUfpd:{...e},...this._config.gdpr.enabled&&{fetchBids:{rules:[{condition:({componentType:e,adapterCode:t})=>t===`ozone`&&e===`bidder`?this._checkPurpose1Consent(`s1119`):!1,allow:!1}]}}}}},wP=D([C(),A(`design:paramtypes`,[typeof(CP=z!==void 0&&z)==`function`?CP:Object])],wP)})),TP,EP,DP,OP,kP,AP,jP,MP,NP,PP,FP,IP,LP,aue=o((()=>{w(),B(),Xle(),ew(),jc(),Zle(),Qle(),rg(),X(),vh(),uu(),Wr(),nue(),rue(),iue(),fw(),FS(),j(),E(),O(),LP=class{constructor(e,t,n,r,i,a,o,s,c,l,u,d){this._config=e,this._prebidMethods=t,this._dcoExperiment=n,this._ortb2=r,this._standardPrebidBidderSetting=i,this._slotManager=a,this._slotManagerEventBus=o,this._slots=s,this._userSyncConfiguration=c,this._regulatoryConfiguration=l,this._allowActivitiesConfiguration=u,this._bidCPMAdjuster=d,T(this,`_map`,{Content:F.Content,Sidebar:F.Sidebar_1,Recipe:F.Recipe_1}),T(this,`_defaultConfig`,{allowActivities:this._allowActivitiesConfiguration.getAllowActivities(),auctionOptions:{secondaryBidders:[`unruly`,`undertone`,`33across`,`nativo`]},bidderSequence:`fixed`,bidPooling:{excludedBidders:[P.Teads]},cache:{url:`https://prebid.adnxs.com/pbc/v1/cache`},consentManagement:{},dchain:{validation:this._dcoExperiment.result},disableAjaxTimeout:!0,enableTIDs:!1,enableSendAllBids:!0,eventHistoryTTL:0,gptPreAuction:{mcmEnabled:!0,enabled:!0,customPreAuction:this.customPreAuction.bind(this)},gvlMapping:{generic:this._config.gdpr.raptiveVendorId},maxRequestsPerOrigin:6,ortb2:this._ortb2.data,pageUrl:window.location.origin+window.location.pathname,priceGranularity:cP,requestQueue:{enabled:!0,timeout:this._config.prebid.requestQueueTimeout},schain:{validation:`strict`,config:new ng().getSupplyChainConfig(this._config.site.id)},sendBidsControl:{bidLimit:3},sizeConfig:[],targetingControls:{allowTargetingKeys:this._config.prebid.targetingKeys,allowSendAllBidsTargetingKeys:this._config.prebid.sendAllBidsTargetingKeys},useBidCache:!0,userSync:this._userSyncConfiguration.getUserSyncConfig()}),this._slotManagerEventBus.added.on(e=>{this._setIsSidebarNineAvailable(e)})}setDefaultConfig(e){let t=this._regulatoryConfiguration.getConsentManagementConfig(),n={...this._defaultConfig,...e&&{eventHistoryTTL:60},consentManagement:t,...this._config.prebid.currencyConversionEnabled&&{currency:{adServerCurrency:`USD`}}};this._prebidMethods.setConfig(n)}applyClientAndServerBidderSettings(e){this._prebidMethods.setBidderSettings(e.reduce((e,t)=>this._setupBidderSettings(e,t),{standard:this._standardPrebidBidderSetting.configuration}))}aliasBidders(e){[...new Set(e)].forEach(e=>{let t=e.gvlid,n=e.getBidderAliases();for(let[e,r]of n)this._setAlias(r,e,t)})}getRevertedFloor(e,t,n){let r=this._config.prebid.s2s.bidders.includes(e)?`server`:e,i=this._bidCPMAdjuster.adjustFloorFromBidRequest(r,t,n);return i}customPreAuction(e,t){let n=e&&this._slotManager.getSlot(e.code);if(!(!t||!e))return this._getGPID(n,e.code,t)}_getGPID(e,t,n){let r=n.split(`/`),i=this._getGPIDLocation(e,t),a=i?`/${r[1]}/AdThrive_${i}/${r[r.length-1]}`:n;return a}_getGPIDLocation(e,t){let n=this._map,r=lu.includes(t);if(e)return!r&&n[e.location]?n[e.location]:e.placementMapName;for(let e in n)if(t.includes(e))return n[e]}_setAlias(e,t,n){n?this._prebidMethods.setAliasBidder(e,t,{gvlid:n}):this._prebidMethods.setAliasBidder(e,t)}_setupBidderSettings(e,t){let{primary:n,secondary:r,supplemental:i}=t.bidderCodes;return e[n]=this.getBidderSettings(t,t.name),r&&(e[r]=this.getBidderSettings(t,r)),i==null||i.forEach(n=>{e[n]=this.getBidderSettings(t,n)}),e.standard.adserverTargeting&&t.adServerTargeting&&e.standard.adserverTargeting.push(...t.adServerTargeting),e}_setIsSidebarNineAvailable(e){let t=this._slots.get(e);for(let e of t)if(e.location===F.Sidebar&&e.sequence===9){this._map.Sidebar=F.Sidebar_9;return}}getBidderSettings(e,t){return{bidCpmAdjustment:(e,n)=>{let r=this._bidCPMAdjuster.adjustCpmFromBidResponse(e,t,n);return r},inverseBidAdjustment:(e,t)=>{let n=this._config.prebid.s2s.bidders.includes(t.bidder)?`server`:t.bidder,r=this._bidCPMAdjuster.adjustFloorFromBidRequest(n,t,e,!0);return r},...e.settings}}},LP=D([C(),A(`design:paramtypes`,[typeof(TP=z!==void 0&&z)==`function`?TP:Object,typeof(EP=R!==void 0&&R)==`function`?EP:Object,typeof(DP=sP!==void 0&&sP)==`function`?DP:Object,typeof(OP=$C!==void 0&&$C)==`function`?OP:Object,typeof(kP=dP!==void 0&&dP)==`function`?kP:Object,typeof(AP=PS!==void 0&&PS)==`function`?AP:Object,typeof(jP=Ur!==void 0&&Ur)==`function`?jP:Object,typeof(MP=_h!==void 0&&_h)==`function`?MP:Object,typeof(NP=bP!==void 0&&bP)==`function`?NP:Object,typeof(PP=SP!==void 0&&SP)==`function`?PP:Object,typeof(FP=wP!==void 0&&wP)==`function`?FP:Object,typeof(IP=dw!==void 0&&dw)==`function`?IP:Object])],LP)})),RP,oue=o((()=>{w(),$(),mU(),j(),O(),RP=class extends pU{init(){this._key=`PredictiveAnalysis`,this._lookup=`VPRED_1`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],RP.prototype,`run`,null),RP=D([C()],RP)})),zP,sue=o((()=>{w(),mU(),$(),j(),O(),zP=class extends pU{init(){this._key=`UserSyncLimit`,this._lookup=`CSYNC_LIM`}run(){try{let e=super.run();return this._validateResult(e),e}catch(e){return M.error(`UserSyncLimitExperiment`,`run`,e),-1}}_validateResult(e){if(typeof e!=`number`)throw Error(`Result is not a number: ${e}`);if(!Number.isInteger(e))throw Error(`Result is not an integer: ${e}`);if(e<0||e>100)throw Error(`Result out of range: ${e}`);return e}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],zP.prototype,`run`,null),zP=D([C()],zP)})),BP,cue=o((()=>{mU(),w(),O(),BP=class extends pU{init(){this._key=`S2STimeOutExperiment`,this._lookup=`S2STO`}},BP=D([C()],BP)})),VP,lue=o((()=>{mU(),w(),O(),VP=class extends pU{init(){this._key=`S2SRefreshTimeout`,this._lookup=`S2STORE`}},VP=D([C()],VP)})),HP,UP,WP,uue=o((()=>{HP={Default:`default`,Experiment1:`experiment-1`,Experiment2:`experiment-2`,Experiment3:`experiment-3`,Experiment4:`experiment-4`,Experiment5:`experiment-5`,Experiment6:`experiment-6`,Experiment7:`experiment-7`,Experiment8:`experiment-8`,Experiment9:`experiment-9`,Experiment10:`experiment-10`,Experiment11:`experiment-11`,Experiment12:`experiment-12`,Holdback:`holdback`},UP=HP.Default,WP=()=>UP})),GP,due=o((()=>{w(),Ui(),E(),O(),GP=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`RaptivePrebidServerProxyExperiment`,this._lookup=`RPBSP`}},GP=D([C()],GP)})),KP,fue=o((()=>{w(),mU(),O(),KP=class extends pU{init(){this._key=`RaptivePBSMultistageAuctionExperiment`,this._lookup=`MULTISERVERAUC`}},KP=D([C()],KP)})),qP,JP=o((()=>{E(),qP=class{constructor(){T(this,`_auctionSuffix`,`/openrtb2/auction`),T(this,`_syncSuffix`,`/cookie_sync`),T(this,`_baseUrl`,void 0),T(this,`_auctionUrl`,void 0),T(this,`_syncUrl`,void 0)}init(){this._setupURLs()}get auction(){return this._auctionUrl.toString()}get sync(){return this._syncUrl.toString()}_setupURLs(){this._baseUrl=new URL(this._url),this._auctionUrl=new URL(this._auctionSuffix,this._baseUrl),this._syncUrl=new URL(this._syncSuffix,this._baseUrl)}}})),YP,XP=o((()=>{w(),uue(),due(),fue(),JP(),YP=class extends qP{init(){this._setShouldUseProxy()&&this._setAuctionParams(),super.init()}_setAuctionParams(){this._handleSetVersionParam(WP())}_setShouldUseProxy(){return!!(x.resolve(GP).result&&x.resolve(KP).result!==`off`)}_handleSetVersionParam(e){this._shouldSetVersionParam(e)&&(this._setAuctionVersionParam(e),this._setSyncVersionParam(e))}_shouldSetVersionParam(e){return e!==HP.Default}_setAuctionVersionParam(e){this._auctionSuffix+=`?version=${e}`}_setSyncVersionParam(e){this._syncSuffix+=`?version=${e}`}}})),ZP,pue=o((()=>{w(),XP(),j(),E(),O(),ZP=class extends YP{constructor(){super(),T(this,`_url`,`https://prebid.production.adthrive.com`),this.init()}},ZP=D([C(),A(`design:paramtypes`,[])],ZP)})),QP,mue=o((()=>{mU(),w(),O(),QP=class extends pU{init(){this._key=`ayp`,this._lookup=`AYP`}},QP=D([S()],QP)})),$P,eF=o((()=>{w(),JP(),aE(),$P=class extends qP{constructor(e){super(),this._experimentParam=e}init(){this._setupExperimentParam(),super.init()}_setupExperimentParam(){let e=this._experimentParam===`off`?``:`?experiment=${this._experimentParam}`;this._auctionSuffix+=e;let t=x.resolve(iE);t.result&&(this._syncSuffix+=`?aysse=true`)}}})),tF,hue=o((()=>{w(),eF(),j(),E(),O(),tF=class extends $P{constructor(e){super(e),T(this,`_url`,`https://pbs-raptive-us.ay.delivery`),this.init()}},tF=D([C(),A(`design:paramtypes`,[Object])],tF)})),nF,gue=o((()=>{w(),eF(),j(),E(),O(),nF=class extends $P{constructor(e){super(e),T(this,`_url`,`https://pbs-raptive-eu.ay.delivery/`),this.init()}},nF=D([C(),A(`design:paramtypes`,[Object])],nF)})),rF,_ue=o((()=>{w(),XP(),j(),E(),O(),rF=class extends YP{constructor(){super(),T(this,`_url`,`https://prebid-eu.production.adthrive.com`),this.init()}},rF=D([C(),A(`design:paramtypes`,[])],rF)})),iF,aF,oF,sF,cF,lF,uF,dF,fF,pF,mF,vue=o((()=>{w(),B(),Ra(),jc(),sue(),X(),cue(),lue(),Z(),ew(),pue(),mue(),hue(),gue(),_ue(),aE(),DT(),j(),E(),O(),mF=class{constructor(e,t,n,r,i,a,o,s,c,l){this._config=e,this._context=t,this._prebidMethods=n,this._userSyncLimitExperiment=r,this._s2sTimeoutExperiment=i,this._ortb2=a,this._s2sRefreshTimeoutExperiment=o,this._aypExperiment=s,this._userSyncReplaceMacroExperiment=c,this._eidManager=l,T(this,`_appData`,void 0),T(this,`_useRaptivePBS`,!1),T(this,`_useAYPBS`,!1),T(this,`_accountId`,`1234`),T(this,`_appAccountId`,`6666`),T(this,`_s2sConfig`,[]),T(this,`_highEntropyUserHints`,[`architecture`,`model`,`platform`,`platformVersion`,`fullVersionList`]),this._appData=eG(this._context.domain,this._ortb2.data.site),this._runRaptivePrebidServerExperiments()}_runRaptivePrebidServerExperiments(){let{rpbsEnabled:e,ayServerEnabled:t}=this._config.prebid;this._useRaptivePBS=e,this._useAYPBS=t}_generateAliases(e){let t=this._config.prebid.s2s.aliases,n=Object.keys(t).reduce((n,r)=>(e.includes(r)&&(n[r]=t[r]),n),{});return n}_getRaptiveServer2ServerConfig(e,t){let n=this._getRPBSEndpoint(t);return this._generateServer2ServerConfig(e,n)}_getAssertiveYieldServer2ServerConfig(e,t,n){let r=this._getAYPBSEndpoint(t),i=this._generateServer2ServerConfig(e,r,n);return this._userSyncReplaceMacroExperiment.result&&this._updateAYConfigSharedId(i,n),i}_updateAYConfigSharedId(e,t){let n=`dummy_iiq_bidder`;t.push(n);let r=(e,t,r)=>{var i;let a=jG(this._context.gpid);if(!a||!a.uids||a.uids.length===0)return t;let o=(i=a.uids[0])==null?void 0:i.id,s=`[SHAREDID]`,c=o&&r===n&&t.includes(s)&&t.includes(`sync.intentiq.com`);return c?t.replace(s,o):t};e.syncUrlModifier=this._addSyncModifierToBidder(t,n,r)}_addSyncModifierToBidder(e,t,n){return e.reduce((e,r)=>(r===t&&(e[r]=n),e),{})}_getRPBSEndpoint(e=!1){var t,n;let r=[`CN`,`HK`,`MY`,`PH`,`SG`,`TH`,`IN`,`SA`,`AE`].includes((t=(n=this._context.country)==null?void 0:n.toUpperCase())==null?``:t),i=!e&&(r||this._config.gdpr.enabled);return i?new rF:new ZP}_getAYPBSEndpoint(e=!1){let t=this._aypExperiment.result;return e?new tF(t):new nF(t)}getServer2ServerConfigWithAppData(e,t,n=!1){var r;let i=this._appData;if(!i||!this._config.prebid.appBidders.length)return;let a=(r=this._config.prebid.s2s.additionalBidders)==null?[]:r,o=t?this._getRaptiveServer2ServerConfig(e,n):this._getAssertiveYieldServer2ServerConfig(e,n,a);if(o.accountId=this._appAccountId,i&&Object.keys(i).length!==0)return o.ignoreDuplicateBidders=!0,o.appData=i,o}_generateServer2ServerConfig(e,t,n){var r,i,a;return{accountId:this._accountId,enabled:!0,...this._config.prebid.ortbEnrich&&{secure:1},bidders:n==null?e:n,syncBidders:n?e:void 0,extPrebid:{aliases:this._generateAliases(e),eidPermissions:[{source:`bidswitch.net`,bidders:e.filter(e=>e!==P.ThirtyThreeAcross)}],returnallbidstatus:!0},defaultTtl:300,timeout:(r=this._s2sTimeoutExperiment.result)==null?750:r,maxTimeout:(i=this._s2sTimeoutExperiment.result)==null?750:i,refreshTimeout:(a=this._s2sRefreshTimeoutExperiment.result)==null?1e3:a,adapter:`prebidServer`,coopSync:!1,userSyncLimit:this._userSyncLimitExperiment.result,endpoint:{p1Consent:t.auction,noP1Consent:t.auction},syncEndpoint:{p1Consent:!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut?t.sync:``,noP1Consent:!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut?t.sync:``}}}_buildS2SConfigs(){let e=this._config.prebid,t=e.s2s.bidders,n=e.s2s.additionalBidders||[],r=[`us`,`ca`].some(e=>{var t;return e===((t=this._context.country)==null?void 0:t.toLowerCase())}),i=this._useRaptivePBS;this._useAYPBS&&this._s2sConfig.push(this._getAssertiveYieldServer2ServerConfig(t,r,n));let a=jG(this._context.gpid);a&&this._ortb2.addEidsToOrtb2(a),i&&this._s2sConfig.push(this._getRaptiveServer2ServerConfig(t,r));let o=this.getServer2ServerConfigWithAppData(t,i,r);o&&this._s2sConfig.push(o)}init(){this._buildS2SConfigs();let e={s2sConfig:this._s2sConfig.filter(e=>e.bidders.length)};e.firstPartyData={uaHints:this._highEntropyUserHints},this._prebidMethods.setConfig(e,!1),this._prebidMethods.getUserIdsAsync().then(()=>{var t;(t=this._s2sConfig)==null||t.forEach(e=>{let t=this._eidManager.getEidSourcesToBiddersAccessMap(e.bidders),n=[`adserver.org`,`adsrvr.org`];n.forEach(n=>{let r=t.get(n)||[];if(r.length){var i;(i=e.extPrebid)==null||(i=i.eidPermissions)==null||i.push({source:n,bidders:r})}})}),this._prebidMethods.setConfig(e,!1)}).catch(e=>{})}},mF=D([S(),A(`design:paramtypes`,[typeof(iF=z!==void 0&&z)==`function`?iF:Object,typeof(aF=L!==void 0&&L)==`function`?aF:Object,typeof(oF=R!==void 0&&R)==`function`?oF:Object,typeof(sF=zP!==void 0&&zP)==`function`?sF:Object,typeof(cF=BP!==void 0&&BP)==`function`?cF:Object,typeof(lF=$C!==void 0&&$C)==`function`?lF:Object,typeof(uF=VP!==void 0&&VP)==`function`?uF:Object,typeof(dF=QP!==void 0&&QP)==`function`?dF:Object,typeof(fF=iE!==void 0&&iE)==`function`?fF:Object,typeof(pF=ET!==void 0&&ET)==`function`?pF:Object])],mF)})),hF,yue=o((()=>{w(),mU(),O(),hF=class extends pU{init(){this._key=`UserSyncTrigger`,this._lookup=`USYNCTRIG`}},hF=D([C()],hF)})),gF,_F,vF,bue=o((()=>{H(),jc(),yue(),w(),$(),j(),E(),O(),vF=class extends V{constructor(e,t){super(),this._userSyncTriggerExperiment=e,this._prebidMethods=t,T(this,`_alreadyCalled`,!1),T(this,`_userSyncTriggerMap`,new Map([[2,`onConfigSet`],[3,`onBeforeRequestEvent`]]))}triggerUserSyncBasedOnExperiment(e){let t=this._userSyncTriggerExperiment.result;t&&this._userSyncTriggerMap.get(t)===e&&!this._alreadyCalled&&(this._prebidMethods.triggerUserSyncs(),this._alreadyCalled=!0)}},vF=D([Q(`UserSyncTriggerComponent`),C(),A(`design:paramtypes`,[typeof(gF=hF!==void 0&&hF)==`function`?gF:Object,typeof(_F=R!==void 0&&R)==`function`?_F:Object])],vF)})),yF,xue=o((()=>{Ui(),w(),E(),O(),yF=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`SspTakeRateMonitor`,this._lookup=`SSPTRM`}},yF=D([C()],yF)})),bF,Sue=o((()=>{Ui(),w(),E(),O(),bF=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`LiverampSecureSignals`,this._lookup=`LRSS`}},bF=D([C()],bF)})),xF,SF,Cue=o((()=>{w(),Bh(),j(),E(),O(),SF=class{constructor(e){this._gamEventBus=e,T(this,`_gamSlotRequested`,!1),T(this,`_appnexusAdvertiserId`,10645616),T(this,`creativeId`,void 0),this._init()}isRoadblock(e){let t=Object.keys(e);return this._gamSlotRequested?!1:!!t.filter(t=>t.indexOf(`Footer`)>-1&&e[t].bids.filter(e=>e.meta&&e.meta.advertiserId&&e.meta.advertiserId===this._appnexusAdvertiserId&&e.creativeId?(this.creativeId=e.creativeId,!0):!1).length).length}_init(){this._gamEventBus.slotRequested.once(()=>{this._gamSlotRequested=!0,this.creativeId=void 0})}},SF=D([S(),A(`design:paramtypes`,[typeof(xF=zh!==void 0&&zh)==`function`?xF:Object])],SF)})),CF,wue=o((()=>{Ui(),$(),w(),E(),j(),O(),CF=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`SSPUserSync`,this._lookup=`SSPUS`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],CF.prototype,`run`,null),CF=D([C()],CF)})),wF,TF,EF,DF,OF,kF,Tue=o((()=>{w(),jc(),$(),Rm(),H(),ya(),Da(),Ua(),X(),aT(),wue(),j(),E(),O(),kF=class extends V{constructor(e,t,n,r,i){super(),this._gpcConfig=e,this._ccpaConfig=t,this._prebidMethods=n,this._userSyncConfig=r,this._sspUserSyncExperiment=i,T(this,`_allowedDomains`,[`https://ads.pubmatic.com`]),T(this,`_sspToDetailsMap`,{pubmatic:{storageKey:`pubm`,bidderCode:P.Pubmatic}}),T(this,`_cachedMessages`,{})}get enabled(){return!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut&&this._sspUserSyncExperiment.result}async init(){this.enabled&&(await Ha(),this._loadMessagesFromStorage(),this._setupPostMessageListener())}getTargetingData(){let e=Object.keys(this._cachedMessages),t=e.filter(e=>{let t=this._cachedMessages[e],n=this._sspToDetailsMap[t.ssp.toLowerCase()].bidderCode;return!(n===P.Pubmatic&&this._userSyncConfig.isPubmaticEidSetByLiveIntent&&t.eid.source===`pubmatic.com`)});return t?t.map(e=>`ssp:${this._sspToDetailsMap[e].storageKey}`):[``]}_setupPostMessageListener(){window.addEventListener(`message`,e=>{if(this._isOriginAllowed(e.origin)){let t=null;try{typeof e.data==`string`?t=JSON.parse(e.data):typeof e.data==`object`&&(t=e.data)}catch(t){M.error(`SSPUserSyncComponent`,`_setupPostMessageListener`,`Error parsing message`,t,e.data)}t&&t.type===`ssp-user-sync`&&this._handlePostMessage(t)}})}_handlePostMessage(e){try{let t=e.ssp.toLowerCase();this._cachedMessages[t]||(this._storeMessage(e),this._processMessage(e),this._cachedMessages[t]=e)}catch(e){M.error(`SSPUserSyncComponent`,`_handlePostMessage`,`Error processing message`,e)}}_isOriginAllowed(e){return this._allowedDomains.includes(e)}_storeMessage(e){try{let t=e.ssp.toLowerCase(),n=this._sspToDetailsMap[t].storageKey||t.toLowerCase();U.setInternalLocalStorage(`adthrive_sspus_${n}`,e)}catch(e){M.error(`SSPUserSyncComponent`,`_storeMessage`,`Error storing SSPUserSyncMessage`,e)}}_loadMessagesFromStorage(){let e=Object.values(this._sspToDetailsMap).map(({storageKey:e})=>U.readInternalLocalStorage(`adthrive_sspus_${e}`)).filter(e=>e!==null);this._cachedMessages=e.reduce((e,t)=>{let n=t.ssp.toLowerCase();return e[n]=t,e},this._cachedMessages),e.forEach(e=>{this._processMessage(e)})}async _processMessage(e){let t=e.eid,n=this._sspToDetailsMap[e.ssp.toLowerCase()].bidderCode;if(!t||!n)return;let r=await this._prebidMethods.waitForQueue();n===P.Pubmatic&&r&&this._userSyncConfig.isPubmaticEidSetByLiveIntent&&t.source===`pubmatic.com`||n===P.Pubmatic&&this._userSyncConfig.pubmaticBidderLevelEidSource===`mediawallah-dcn`||(this._prebidMethods.setBidderConfig({bidders:[n],config:{ortb2:{user:{ext:{data:{eids:[t]}}}}}}),n===P.Pubmatic&&(this._userSyncConfig.pubmaticBidderLevelEidSource=`pubmatic-iframe`))}},kF=D([Q(`SSPUserSyncComponent`),C(),A(`design:paramtypes`,[typeof(wF=va!==void 0&&va)==`function`?wF:Object,typeof(TF=Ea!==void 0&&Ea)==`function`?TF:Object,typeof(EF=R!==void 0&&R)==`function`?EF:Object,typeof(DF=iT!==void 0&&iT)==`function`?DF:Object,typeof(OF=CF!==void 0&&CF)==`function`?OF:Object])],kF)})),AF=o((()=>{Tue()})),jF,Eue=o((()=>{mU(),$(),Z(),Ni(),w(),j(),O(),jF=class extends pU{init(){this._key=`LimitBidPoolExperiment`,this._lookup=`LBPE`}run(){return super.run()}isEnabled(){return super.isEnabled()&&Oi()&&tG()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],jF.prototype,`run`,null),jF=D([C()],jF)})),MF,NF,PF,FF,IF,LF,Due=o((()=>{w(),jc(),rU(),Eue(),Bh(),X(),FS(),j(),E(),O(),LF=class{constructor(e,t,n,r,i){this._prebidMethods=e,this._limitBidPoolExperiment=t,this._gamEventBus=n,this._slotManager=r,this._slotEventBus=i,T(this,`_bidAmount`,void 0),typeof this._limitBidPoolExperiment.result==`number`?this._bidAmount=this._limitBidPoolExperiment.result:this._bidAmount=1/0}init(){this.setupListeners()}setupListeners(){this._bidAmount!==1/0&&this._gamEventBus.slotOnload.on(({slotId:e})=>{let t=this._slotManager.getSlot(e);t&&t.location===F.Footer&&setTimeout(()=>{this._prebidMethods.trimBidPoolForAdUnit(t.id,this._bidAmount)},1e3)}),this._slotEventBus.stickyOutstreamSlotDestroyedUserClick.on(e=>{let t=this._prebidMethods.getBidResponsesForAdUnitCode(e);t.bids.forEach(e=>{this._prebidMethods.clearAuctionBids(e.auctionId)})})}},LF=D([S(),A(`design:paramtypes`,[typeof(MF=R!==void 0&&R)==`function`?MF:Object,typeof(NF=jF!==void 0&&jF)==`function`?NF:Object,typeof(PF=zh!==void 0&&zh)==`function`?PF:Object,typeof(FF=PS!==void 0&&PS)==`function`?FF:Object,typeof(IF=Vr!==void 0&&Vr)==`function`?IF:Object])],LF)})),RF,zF=o((()=>{w(),bt(),wt(),E(),O(),RF=class extends Ct{constructor(...e){super(...e),T(this,`blockCreativeIds`,new k)}},RF=D([C()],RF)})),BF,VF,HF,UF,WF,GF,KF,qF,JF,YF,XF,ZF,QF,$F,eI,tI,nI,rI,iI,aI,oI,sI,cI,lI,uI,dI,fI,pI,mI,hI,gI,Oue=o((()=>{w(),$h(),rd(),cw(),$T(),B(),Ra(),X(),$(),bt(),vh(),Z(),Pce(),Kle(),Jle(),VC(),ew(),Yle(),jc(),aue(),oue(),vue(),bue(),tg(),Hr(),tU(),xue(),Bh(),Sue(),Cue(),AF(),Fr(),Kh(),WC(),LO(),al(),br(),Due(),kC(),zF(),j(),E(),At(),O(),gI=class extends eg{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v,y,b,ee,te,ne,re,ie,ae,oe,se,ce,le){super(),this._bootstrapConfig=t,this._config=n,this._context=r,this._gam=i,this._s2s=a,this._bidderSetup=o,this._mediaType=s,this._prebidMethods=c,this._prebidConfiguration=l,this._predictiveAnalysisExperiment=u,this._userSyncTriggerComponent=d,this._slots=f,this._creativeMonitoring=p,this._ortb2=m,this._oseq=h,this._gdprEnforcement=g,this._prebidEventBus=_,this._slotEventBus=v,this._videoEventBus=y,this._floorsEventBus=b,this._sspTakeRateMonitorExperiment=ee,this._userIdComponent=te,this._sspUserSyncComponent=ne,this._googleAdManagerEventBus=re,this._roadblocksDetection=ie,this._genericAnalytics=ae,this._liveRampSecureSignalsExperiment=oe,this._assertiveYieldAnalytics=se,this._limitBidPool=ce,this._creativeBlockEventBus=le,T(this,`_analytics`,void 0),T(this,`_orderedDisplayBidders`,void 0),T(this,`_orderedVideoBidders`,void 0),T(this,`_orderedMultiformatBidders`,void 0),T(this,`_videoCreativeIdMapping`,void 0),T(this,`_predictiveAnalysisResult`,void 0),T(this,`videoAdUnits`,[]),T(this,`bidsRequested`,new k),T(this,`_predictiveAnalysis`,void 0),T(this,`_isBeforeRequestEventLoaded`,!1),T(this,`_excludedSlots`,[F.Interstitial,F.Native_Recipe]),T(this,`_defaultVideoDuration`,30),T(this,`_appDataBidders`,void 0),T(this,`_bidResponseForAdUnitCount`,new Map),T(this,`_highRevGeoCountries`,[`US`,`CA`,`AU`,`DE`,`NZ`,`GB`,`UK`]),T(this,`_bseatAppRequests`,[`537073292`,`2307`,`377`,`39`,`5510`]),T(this,`_initialized`,!1),T(this,`_previousAuctionData`,new Map),T(this,`_previousBidRateData`,void 0),T(this,`_instreamAuctionRefreshByPlayer`,new Map),T(this,`_usedFloorAuctionIds`,[]),T(this,`_maxClearBidAttempts`,3),T(this,`_raptiveFilteredCrids`,new Map),T(this,`_processBidRequested`,e=>{this._setAuctionFloors(e),this._setIXServerSiteId(e),this.bidsRequested.emit()}),T(this,`_setAuctionFloors`,e=>{var t,n;let r=(e==null?void 0:e.auctionId)&&!this._usedFloorAuctionIds.includes(e.auctionId),i=((t=e.bids)==null?void 0:t.length)>0&&((n=e.bids)==null||(n=n[0])==null?void 0:n.floorData),a=this._config.prebid.s2s.bidders.includes(e.bidderCode),o=this._config.prebid.serverBidderInflatorMap.get(e.bidderCode);r&&i&&this._setBidRequestedFloorData(e),i&&a&&o&&this._applyServerBidderInflator(e,o)}),this._orderedDisplayBidders=this._bidderSetup.orderedDisplayBidders,this._orderedVideoBidders=this._bidderSetup.orderedVideoBidders,this._videoCreativeIdMapping=this._bidderSetup.videoCreativeIdMapping,this._predictiveAnalysisResult=this._predictiveAnalysisExperiment.result||void 0,this._predictiveAnalysis=e.core.predictiveAnalysis,this._orderedMultiformatBidders=this._bidderSetup.multiFormatBidders,this._appDataBidders=this._config.prebid.appBidders,this._analytics=[this._genericAnalytics,this._assertiveYieldAnalytics].filter(e=>e.enabled)}init(){let e=this._prebidConfiguration,t=this._orderedDisplayBidders,n=this._orderedVideoBidders,r=[...t,...n],i=eG(this._context.domain,this._ortb2.data.site),a=this._appDataBidders,o=!!this._analytics.length;a.length&&this._prebidMethods.setConfig({appDataConfig:{appData:i,bidders:this._appDataBidders,bseat:this._bseatAppRequests}}),this._setEvents(),e.setDefaultConfig(o),this._userSyncTriggerComponent.triggerUserSyncBasedOnExperiment(`onConfigSet`),e.aliasBidders(r),r.filter(GW).forEach(e=>e.init!==void 0&&e.init()),this._config.prebid.distributeServerBidders(),this._s2s.init(),this._analytics.forEach(e=>e.init!==void 0&&e.init()),e.applyClientAndServerBidderSettings(r),fK().then(()=>this._registerSignalSources()).catch(e=>{M.error(`PrebidAuctionManager`,`init`,`pageLoaded`,e)}),this._prebidEventBus.initialized.emit(),this._initialized=!0,this._limitBidPool.init()}get multiFormatBidders(){return this._orderedMultiformatBidders}lastAuctionData(e){return this._previousAuctionData.get(e)}_logAuctionDebug(){this._prebidEventBus.auctionDebug.on(e=>{if(e&&e.type===`ERROR`){let t=[...e.arguments],n=t.some(e=>typeof e==`string`&&e.indexOf(`Error trying to write ad`)>-1);n||M.error(`PrebidAuctionManager`,`_logAuctionDebug`,`auctionDebug`,e)}})}async _registerSignalSources(){if(this._config.ccpa.userOptedOut||this._config.gpc.gpcEnabled)return;if(this._config.gdpr.enabled){let e=await this._gdprEnforcement.checkConsentForVendor(this._config.gdpr.raptiveVendorId,[1]);if(!e)return}let e=[`esp.criteo.com`,`33across.com`,`crwdcntrl.net`];this._liveRampSecureSignalsExperiment.result&&e.push(`liveramp.com`),this._prebidMethods.setConfig({userSync:{encryptedSignalSources:{sources:[{source:e,encrypt:!1}],registerDelay:2e3}}}),this._prebidMethods.registerSignalSources()}_getNoBidReason(e,t){return Object.keys(e==null?{}:e).length?``:t==null?`noBid`:t}_setLastAuctionData(e,t,n,r){let i=this._previousAuctionData.get(e),a=i==null?void 0:i.refresh,o=a===t&&i?i.bids.concat(n):n,s=a===t&&i?i.requests.concat(r):r;this._previousAuctionData.set(e,{bids:o,requests:s,refresh:t})}_handleAuctionEnd(){this._prebidEventBus.auctionEnd.on(e=>{let t=e.bidderRequests||[],n=e.bidsReceived||[],r=e.adUnits||[],i=n.filter(e=>e.app);r.forEach(e=>{var r;let{code:a,noBidReason:o}=e,s=this._slots.get(a),c=s?s.id:a,l=s?s.refreshCount:(r=this._instreamAuctionRefreshByPlayer.get(c))==null?0:r,u=this._prebidMethods.getAdserverTargetingForAdUnitCode(c),d=this._getNoBidReason(u,o);if(this._setLastAuctionData(c,l,n,t),s&&this._config.creativeBlock.creativeBlockEnabled&&(this._handleBlockingOfFilteredCrids(a),this._handleTargetingForRaptiveBlocking(s,a)),s){var f;s==null||s.setSlotAppBids(i,a),d&&((f=s.googleTagSlot)==null||f.setTargeting(`hb_bidder`,d))}else{let e=d?{noBid:d}:u;this._config.video.bidRate=(n.length/(t.length||1)).toFixed(2),this._slotEventBus.addPrebidSlotTargeting.emit({adUnitCode:a,slotTargeting:e})}}),this._setClearBidsTimeout(e.auctionId,e.bidsReceived)})}_handleBlockingOfFilteredCrids(e){let t=this._raptiveFilteredCrids.get(e)||new Set,n=new Set;t.forEach(e=>{e.creativeId&&n.add(e.creativeId.toString())}),n.size>0&&this._creativeBlockEventBus.blockCreativeIds.emit({source:`raptive`,crids:n})}_handleTargetingForRaptiveBlocking(e,t){let{bids:n}=this._prebidMethods.getBidResponsesForAdUnitCode(t),r=n.filter(e=>this._filterUnusedBids(e,t)),i=this._raptiveFilteredCrids.get(t)||new Set;e.rbTotalBadCrids=this._config.creativeBlock.crids.length;for(let e of[...i])this._filterUnusedBids(e,t)||r.push(e);if(r.length===0)return;let a=r.reduce((e,t)=>t.cpm>e.cpm?t:e,r[0]);a!=null&&a.creativeId&&a.blockedByRaptive&&e.rbWinningBidsFiltered.add(a.adId),this._raptiveFilteredCrids.set(t,new Set),e.updateTargetingForRaptiveBlocking()}_getHighestBidTTL(e){let t=e.map(e=>e.ttl?e.ttl*1e3:0);return Math.max(6e4,...t)}_setupTTLTimeout(e,t,n=1){setTimeout(()=>{let t=this._prebidMethods.clearAuctionBids(e);if(t!=null&&t.length&&n<this._maxClearBidAttempts){let r=this._getHighestBidTTL(t);this._setupTTLTimeout(e,r,++n)}},t)}_setClearBidsTimeout(e,t){if(!t.length)return;let n=this._getHighestBidTTL(t);this._setupTTLTimeout(e,n)}_getBidsInCache(e,t,n){let r=this._getActiveBidsInPool(e,n)||[],i=r.map(e=>({cpm:e.cpm})),{requests:a,responses:o}=this._previousBidRateData=this._getBiddingData(e);return{bids:i,requests:a,responses:o,refresh:t}}_handleAuctionInit(){this._prebidEventBus.auctionInit.on(e=>{e.adUnitCodes.forEach(t=>{let n=(this._prebidMethods.getPrebidAdUnits()||[]).filter(e=>e.code===t);n.length&&n.forEach(t=>{t.lastAuctionId=e.auctionId})})})}_handleBidWon(){this._prebidEventBus.bidWon.on(e=>{let t=this._slots.get(e.adUnitCode);if(t){t.servedPrebidBidResponse=e,this._slots.bidServed.emit(t);let n=Math.floor(Math.random()*100)>=95;n&&this._sspTakeRateMonitorExperiment.result&&this._logBidResponseInfo(e.adUnitCode,t)}})}_logBidResponseInfo(e,t){let n=this._prebidMethods.getBidResponsesForAdUnitCode(e).bids,r=this._bidResponseForAdUnitCount.get(e)||0,i=n.slice(r);i.forEach(e=>{let{bidder:n,cpm:r,adUnitCode:i,dealId:a,originalCpm:o,responseCpm:s,meta:c,transactionId:l}=e,{hb_pb:u,hb_format:d}=e.adserverTargeting,{bp:f,wp:p}=this._extractPriceInfoFromPixelUrl(e),m=n&&r&&u&&i;m&&M.event(`PrebidAuctionManager`,`_logBidResponseInfo`,`Info from bid response`,{tid:l,bidder:n,cpm:r,originalCpm:o,responseCpm:s,hb_pb:u,hb_format:d,hb_crid:e.creativeId,meta:c,...f&&{bp:f},...p&&{wp:p},adUnitCode:i,nref:t.refreshCount,dealId:a})}),this._bidResponseForAdUnitCount.set(e,n.length)}_extractPriceInfoFromPixelUrl(e){let{ad:t,adUrl:n}=e,r,i;if(!t&&!n)return{bp:void 0,wp:void 0};if(t){let e=t.match(/[?&]bp=([^&]*)/),n=t.match(/[?&]wp=([^&]*)/);r=e&&e[1],i=n&&n[1]}if(n){let e=n.match(/[?&]bp=([^&]*)/),t=n.match(/[?&]wp=([^&]*)/);r=!r&&e&&e[1],i=!i&&t&&t[1]}return{bp:r,wp:i}}_handleSetTargeting(){this._prebidEventBus.setTargeting.on(e=>{for(let t in e){let n=this._slots.get(t);if(n){let{hb_adid:r,hb_bidder:i}=e[t];try{let e=n.bidPoolId,{bids:t}=e?this._prebidMethods.getBidResponsesForBidPoolId(e):this._prebidMethods.getBidResponsesForAdUnitCode(n.id);this._oseq.setOseq(n,t,{hb_adid:r,hb_bidder:i})}catch(e){let t=this._prebidMethods.getVersion();M.error(`PrebidAuctionManager`,`setEvents`,e,t)}}}})}_handleBeforeRequestEvent(){let e=e=>{this._prebidMethods.addToQueue(()=>{var t,n;this._userSyncTriggerComponent.triggerUserSyncBasedOnExperiment(`onBeforeRequestEvent`),(this._mediaType.additionalOutstreamUnitsExperiment||!this._mediaType.isOutstreamAllowed())&&!this._isBeforeRequestEventLoaded&&this._updateHighImpactUnitTargeting();let r=this._userIdComponent.getTargetingData(),i=this._sspUserSyncComponent.getTargetingData(),a=[...r,...i];((t=this._ortb2.data.device)!=null&&t.ip||(n=this._ortb2.data.device)!=null&&n.ipv6)&&a.push(`cfip`),e.forEach(e=>{this._setupSlotRequestTargeting(e,a)}),this._isBeforeRequestEventLoaded=!0})};this._prebidEventBus.beforeRequestBids.on(e)}_handleGamOnLoad(){this._googleAdManagerEventBus.slotOnload.on(({slotId:e})=>{let t=this._slots.get(e);!t||t.lazy&&!t.refreshCount||setTimeout(()=>{this._prebidMethods.clearTargetingForSharedBidPool(t.id)},2e3)})}_setIXServerSiteId(e){var t;(t=e.bids)==null||t.forEach(t=>{if(t.bidder===P.IndexExchangeServer){var n;(n=e.adUnitsS2SCopy)==null||n.forEach(e=>{let n=e.bids.filter(e=>e.bidder===t.bidder);n.forEach(e=>{if(e.params.siteId){var t,n,r;(t=e.ortb2Imp)!=null||(e.ortb2Imp={}),(r=(n=e.ortb2Imp).ext)!=null||(n.ext={}),e.ortb2Imp.ext.siteId=e.params.siteId}})})}})}_applyServerBidderInflator(e,t){var n;(n=e.bids)==null||n.forEach(n=>{let{floor:r}=this._getFloor([n]),i=r==null?void 0:r.floor;if(i){var a;let r=i*t;(a=e.adUnitsS2SCopy)==null||a.forEach(e=>{let t=e.bids.filter(e=>e.bidder===n.bidder);t.forEach(e=>{var t;(t=e.ortb2Imp)!=null||(e.ortb2Imp={}),e.ortb2Imp.bidfloor=r})})}})}_setBidRequestedFloorData(e){let{floor:t,floorData:n}=this._getFloor(e.bids),r=e.bids[0],i=this._config.prebid.s2s.bidders.includes(r.bidder)?`server`:r.bidder;if(t&&typeof t.floor==`number`||n!=null&&n.skipped){let a=e.auctionId,o=n!=null&&n.skipped?-1:this._prebidConfiguration.getRevertedFloor(i,r,t.floor);this._usedFloorAuctionIds.push(a),this._floorsEventBus.setAuctionFloorData.emit({auctionId:a,price:o,floorData:n,bidder:i})}}_getFloor(e){let t,n,r=e[0];try{n=(r==null?void 0:r.floorData)||{},t=typeof e[0].getFloor==`function`&&r.getFloor()}catch(e){M.error(`PrebidAuctionManager`,`_handleBidRequested`,`could not call getFloor`,e)}return{floor:t,floorData:n}}_handleBidRequested(){this._prebidEventBus.bidRequested.on(this._processBidRequested.bind(this))}_setEvents(){this._logAuctionDebug(),this._handleAuctionEnd(),this._handleBidWon(),this._handleSetTargeting(),this._handleBeforeRequestEvent(),this._handleBidRequested(),this._handleGamOnLoad(),this._handleAuctionInit(),this._creativeMonitoring.setupCreativeEventListeners(),this._setBidsFilter(),this._setupEventListeners(),this._handleExpiredRender()}_setupEventListeners(){let e=this._prebidMethods,t=this._prebidEventBus;e.onEvent(`adRenderFailed`,e=>t.adRenderFailed.emit(e)),e.onEvent(`adRenderSucceeded`,e=>t.adRenderSucceeded.emit(e)),e.onEvent(`auctionDebug`,e=>t.auctionDebug.emit(e)),e.onEvent(`auctionEnd`,e=>t.auctionEnd.emit(e)),e.onEvent(`auctionInit`,e=>t.auctionInit.emit(e)),e.onEvent(`beforeRequestBids`,e=>t.beforeRequestBids.emit(e)),e.onEvent(`bidRequested`,e=>t.bidRequested.emit(e)),e.onEvent(`bidWon`,e=>t.bidWon.emit(e)),e.onEvent(`rubiconBidError`,e=>t.rubiconBidError.emit(e)),e.onEvent(`setTargeting`,e=>t.setTargeting.emit(e)),e.onEvent(`staleRender`,e=>t.staleRender.emit(e)),e.onEvent(`tcf2Enforcement`,e=>t.tcf2Enforcement.emit(e)),e.onEvent(`vastExceededLimit`,e=>t.vastExceededLimit.emit(e)),e.onEvent(`liveIntentResolved`,e=>t.liveIntentResolved.emit(e)),e.onEvent(`expiredRender`,e=>t.expiredRender.emit(e)),e.onEvent(`id5Resolved`,e=>t.id5Resolved.emit(e))}_setBidsFilter(){let e=this._config.prebid,t=this._getPredictiveAnalysisInvalidBidMap(),n=new Set([...this._config.creativeBlock.crids]),r=new Set([...e.blockedCreativeIds]);this._prebidMethods.setBidsReceivedFilter(e=>{var i;if(!e)return!1;let a=!1,o=(i=e.creativeId)==null?void 0:i.toString(),s=o&&r.has(o),c=t[`${o},${e.bidder}`],l=e.dealId!==void 0;if(this._config.creativeBlock.creativeBlockEnabled){a=!!o&&n.has(o)&&!l;let t=this._slots.get(e.adUnitCode);if(t==null||t.rbTotalBidsCompared.add(e.adId),a){e.blockedByRaptive=!0,t==null||t.rbTotalBidsFiltered.add(e.adId);let n=this._raptiveFilteredCrids.get(e.adUnitCode)||new Set;n.add(e),this._raptiveFilteredCrids.set(e.adUnitCode,n)}}return!s&&!a&&!c})}_getPredictiveAnalysisInvalidBidMap(){let e=e=>e===`1`===Zt(),t=e=>{let t=this._context.device;return e===`1`?t===`phone`:t===`tablet`||t===`desktop`},n=this._predictiveAnalysis.filter(n=>parseFloat(n.error_rate)>(this._predictiveAnalysisResult||.9)&&e(n.chrome)&&t(n.mobile)),r={};return this._predictiveAnalysis.length&&n.forEach(e=>{let t=`${e.crid},${e.bidder}`;r[t]=!0}),r}_updateSlotTargeting(e){let t=this._mediaType;if(!t.outstreamSlots.has(`${e.placementMapName}`))return;let n=this._config.adTypes.enabledMinified.map(e=>e.toLowerCase()).filter(e=>e===`od`||e===`om`);n.length&&this._gam.setSlotTargeting({key:`hi_au`,value:n},e.googleTagSlot)}instlEnabled(e){return e===`Interstitial`&&this._config.adOptions.interstitial.prebid}get videoCreativeIdMapping(){return this._videoCreativeIdMapping}addSlots(e){let t=e.filter(e=>this._shouldIncludeSlot(e));this._applySlotFlags(t);let n=this._getBidsForSlots(t),r={bannerBidderBidRequests:n.banner,outstreamBidderBidRequests:n.outstream,nativeBidderBidRequests:n.native,multiFormatBannerVideoBidderBidRequests:n.multiformatOutstream,multiFormatBannerNativeBidderBidRequests:n.multiformatNative},i=t.sort((e,t)=>e.auctionPriority-t.auctionPriority).reduce((e,t)=>{let n=this._generateAdUnits(t,r);return e.concat(n)},[]);return this._prebidMethods.addAdUnits(i),this._setAdUnitOnSLot(t),this._setBidsFilter(),i}reset(e=!0){return this._prebidMethods.removeAllAdUnits(e)}_getUnitMap(e){let t={display:[],instream:[]};return e.forEach(e=>{if(`id`in e)t.display.push(e);else{var n;(n=t.instream)==null||n.push(e)}}),t}_getBidsForSlots(e){let t={banner:new Map,outstream:new Map,native:new Map,instream:new Map,multiformatNative:new Map,multiformatOutstream:new Map},{display:n,instream:r}=this._getUnitMap(e);return n.length&&this._orderedDisplayBidders.forEach(e=>{e.getBidRequests(n,t)}),r.length&&this._orderedVideoBidders.forEach(e=>{e.getBidRequests(r,t)}),t}_applySlotFlags(e){e.forEach(e=>{this._mediaType.outstreamEnabled(e).outstreamCapable&&(e.location!==F.Video_StickyOutstream&&(e.multiformat=!0),e.outstreamEnabled=!0),this._mediaType.nativeEnabled(e)&&(e.multiformat=!0,e.nativeEnabled=!0)})}_generateAdUnits(e,t){let n=[],r=e.location===F.Video_StickyOutstream,i=this._mediaType.outstreamEnabled(e).outstreamCapable&&!r,a=this._mediaType.nativeEnabled(e);if(this._mediaType.additionalOutstreamUnitsExperiment&&this._updateSlotTargeting(e),!r)this.getDisplayAdUnitsFromRequests(e,n,i,a,t);else{let r=this._getOutstreamUnit(e,t.outstreamBidderBidRequests);r&&n.push(r)}return n}getDisplayAdUnitsFromRequests(e,t,n,r,i){let{bannerBidderBidRequests:a,outstreamBidderBidRequests:o,nativeBidderBidRequests:s,multiFormatBannerVideoBidderBidRequests:c,multiFormatBannerNativeBidderBidRequests:l}=i,u=this._getBannerUnit(e,a);if(u&&t.push(u),o.size&&n){let n=this._getOutstreamUnit(e,o);n!=null&&n.bids.length&&t.push(n)}if(s.size&&r){let n=this._getNativeUnit(e,s);n!=null&&n.bids.length&&t.push(n)}if(c.size&&e.multiformat){let n=this._getMultiformatBannerVideoUnit(e,c);n!=null&&n.bids.length&&t.push(n)}if(l.size&&e.multiformat){let n=this._getMultiformatBannerNativeUnit(e,l);n!=null&&n.bids.length&&t.push(n)}}_getMultiformatBannerNativeUnit(e,t){let n=this._mediaType.nativeEnabled(e)&&!0,r={banner:!0,native:this._mediaType.nativeEnabled(e)&&!0,outstream:!1},i={banner:!0,native:n,outstream:!1};return this._getBannerUnit(e,t,!0,i,r)}_getMultiformatBannerVideoUnit(e,t){let n={banner:!0,native:!1,outstream:this._mediaType.outstreamEnabled(e).outstreamCapable&&!0},r={banner:!0,native:!1,outstream:this._mediaType.outstreamEnabled(e).outstreamCapable&&!0};return this._getBannerUnit(e,t,!0,r,n)}_getBannerUnit(e,t,n=!1,r={banner:!0,native:!1,outstream:!1},i={banner:!0,native:!1,outstream:!1}){let a=this.instlEnabled(e.location),o=t.get(e.id),s=this._ortb2.addOrtb2Imp({slot:e},o,a),c=r.outstream,l=r.native;return o?{...n&&{multiformat:n,multiformatNative:l,multiformatVideo:c},...e.bidPoolId&&{bidPoolId:e.bidPoolId},...e.passiveBidPoolId&&{passiveBidPoolId:e.passiveBidPoolId},code:a?this._config.prebid.interstitialAdUnitCode:e.element.id,mediaTypes:this._mediaType.getMediaType({slot:e},i),...s?{ortb2Imp:s}:{},bids:o,viewability:e.viewability}:void 0}_getOutstreamUnit(e,t){let n=this.instlEnabled(e.location),r=t.get(e.id),i=this._ortb2.addOrtb2Imp({slot:e},r,n),a={outstream:!0};return r?{...e.bidPoolId&&{bidPoolId:e.bidPoolId},...e.passiveBidPoolId&&{passiveBidPoolId:e.passiveBidPoolId},code:n?this._config.prebid.interstitialAdUnitCode:e.element.id,mediaTypes:this._mediaType.getMediaType({slot:e},a),...i?{ortb2Imp:i}:{},viewability:e.viewability,bids:r}:void 0}_getNativeUnit(e,t){let n=this.instlEnabled(e.location),r=t.get(e.id),i=this._ortb2.addOrtb2Imp({slot:e},r,n),a={native:!0};return r?{...e.bidPoolId&&{bidPoolId:e.bidPoolId},...e.passiveBidPoolId&&{passiveBidPoolId:e.passiveBidPoolId},code:n?this._config.prebid.interstitialAdUnitCode:e.element.id,mediaTypes:this._mediaType.getMediaType({slot:e},a),...i?{ortb2Imp:i}:{},viewability:e.viewability,bids:r}:void 0}_setAdUnitOnSLot(e){e.length&&this._prebidMethods.addToQueue(()=>{let t=this._prebidMethods.getPrebidAdUnits();t&&e.forEach(e=>{let n=t.filter(t=>t.code===e.element.id);n.length&&(e.prebidAdUnit=n)})})}_updateSlots(e){e.forEach(e=>{this._updateAdUnitData(e,e.prebidAdUnit);let t=e.prebidAdUnit||[];t.length&&(this._updateAdUnitOrtb2Imp(e,t),this._updateBidderBidParams(e,t),this.updateBidsTrafficShapingLabels(e,t))})}updateBidsTrafficShapingLabels(e,t){t.forEach(t=>{t.bids&&t.bids.length&&t.bids.forEach(t=>{this._config.trafficShaping.applyTrafficShapingLabel(e,t)})})}_updateAdUnitOrtb2Imp(e,t){let n=`location`in e,r=n?e:void 0,i=n?void 0:e;t.forEach(e=>{var t;let n=this._ortb2.addOrtb2Imp({slot:r,video:i});n.ext={...e==null||(t=e.ortb2Imp)==null?void 0:t.ext,...n==null?void 0:n.ext},e.ortb2Imp=n})}_updateBidderBidParams(e,t){t.forEach(t=>{t.bids&&t.bids.length&&t.bids.forEach(t=>{let n=this._bidderSetup.biddersParams.get(t.bidder);n&&e.highlyViewable&&n&&n.updateBidParams(t,e)})})}_updateAdUnitData(e,t){let n=t&&e.location!==F.Video_StickyOutstream;n&&t.forEach(t=>{var n;if(t.multiformat){let n={banner:!0,native:t.multiformatNative,outstream:t.multiformatVideo};t.mediaTypes=this._mediaType.getMediaType({slot:e},n)}t.viewability=e.refreshCount?Math.max(e.viewability,.7):e.viewability;let r=(n=t.mediaTypes)==null?void 0:n.banner;r&&e.originalSizes&&e.refreshCount>0&&(e.sizes=e.originalSizes,e.originalSizes=void 0,r.sizes=e.sizes)})}_updateHighImpactUnitTargeting(){let e=this._gam;Zh.pushToQueue(()=>{let t=`hi_au`,n=e.getTargetingValuesForKey(t).filter(e=>e!==`od`&&e!==`om`);n.length?e.setTargeting({key:t,value:n}):e.clearTargetingForKey(t)})}_shouldIncludeSlot(e){return!this._excludedSlots.includes(e.location)||e.location===F.Interstitial&&this.instlEnabled(e.location)}_addLabels(e,t,n,r){this._addInitialLabel(e,t),this._addRefreshLabel(e,t),this._addOutstreamLabel(e,t),this._addHvpLabel(e,t),this._addAuctionLabels(e,t,n,r)}_addOutstreamLabel(e,t){return this._mediaType.isOutstreamAllowed()&&e.forEach(e=>{this._mediaType.outstreamEnabled(e).outstreamCapable&&t.push(`outstreamCapable_${e.placementMapName}`)}),t}_addHvpLabel(e,t){e.forEach(e=>{e.isHighlyViewable()&&t.push(`hvp_${e.placementMapName}`)})}_addRefreshLabel(e,t){e.forEach(e=>{e.refreshCount>0&&t.push(`refresh`)})}_addInitialLabel(e,t){e.forEach(e=>{e.refreshCount===0&&t.push(`initial`)})}_addAuctionLabels(e,t,n,r){let i=e.some(e=>e.location===F.Video_StickyOutstream),a=(i?this._config.prebid.refreshStickyOutstreamAuctionCount:this._config.prebid.refreshAuctionCount)||1;if(n&&!(n===1&&r)){t.push(`auction-${n}`);return}for(let e=0;e<a;e++){let n=e+1;t.push(`auction-${n}`)}}_setDiscountTargeting(e){var t;let n=(e==null||(t=e.googleTagSlot)==null?void 0:t.getTargeting(`hb_adid`))||[],r=e.bidPoolId?this._prebidMethods.getBidResponsesForBidPoolId(e.bidPoolId):this._prebidMethods.getBidResponsesForAdUnitCode(e.id),i=r.bids.filter(e=>e.adId===n[0])[0]||{},a=i.responseCpm;if(a){let t=a-i.cpm;e.setSlotTargetingFlag(`pbop`,[a.toFixed(6).toString()]),e.setSlotTargetingFlag(`pbpd`,[t.toFixed(6).toString()])}}async _setRefreshOnVideoAdUnit(e){let t=this._prebidMethods;await t.waitForQueue();let n=t.getPrebidAdUnits();e.forEach(e=>{let t=n==null?void 0:n.filter(t=>t.code===e.name)[0];t&&(t.refresh=!0)})}async _awaitPrebidReady(){return new Promise(e=>{this._prebidEventBus.initialized.once(()=>{e()})})}_getBiddingData(e){var t;let{bids:n,requests:r}=(t=this._previousAuctionData.get(e))==null?{bids:[],requests:[]}:t,i=[],a=[];if(!r.length){var o;return(o=this._previousBidRateData)==null?{requests:0,responses:0}:o}return r.forEach(e=>{var t;let n=(t=e.bidder)==null?e.bidderCode:t;i.includes(n)||i.push(n)}),n.forEach(e=>{var t;let n=(t=e.bidderCode)==null?e.bidder:t;a.includes(n)||a.push(n)}),{requests:i.length,responses:a.length}}async _setBidsInCache(e){let t=new Map;return new Promise(n=>{this.checkLibLoaded().then(async r=>{if(!r||!e.length){n(t);return}this._initialized||await this._awaitPrebidReady(),e.forEach(e=>{let n=`id`in e?e.id:e.name,r=this._getActiveBidsInPool(n)||[],i=r.length;t.set(n,i)}),n(t)}).catch(e=>{n(t)})})}_getBidCacheTargeting(e){let t=new Map;return new Promise(n=>{this.checkLibLoaded().then(async r=>{if(!r||!e.length){n(t);return}this._initialized||await this._awaitPrebidReady(),e.forEach(e=>{let n=`id`in e?e.id:e.name,r=`id`in e?e.refreshCount:e.prerollNum,i=`id`in e?e.bidPoolId:void 0;t.set(n,this._getBidsInCache(n,r,i))}),n(t)}).catch(e=>{n(t)})})}async setPreAuctionBidCacheData(e){return this._setBidsInCache(e)}setDisplayBidCacheTargeting(e){return this._getBidCacheTargeting(e)}setInstreamBidCacheTargeting(e){return this._getBidCacheTargeting(e)}clearAuctionTargeting(e){this._prebidMethods.clearSlotTargeting(e)}requestBids(e,t=this._config.timeouts.initialBidsRequest,n=[],r=0,i=!0,a=!1){return e=e.filter(e=>this._shouldIncludeSlot(e)),new Promise(o=>{this.checkLibLoaded().then(async s=>{let c=e.map(e=>e.name),l=Gh.markStartTask(`microtask`,[`PrebidAuctionManager`,`requestBids`,`first`,`task`]);l.addMetadata({slotNames:c});let u=e.map(e=>this.instlEnabled(e.location)?this._config.prebid.interstitialAdUnitCode:e.element.id),d=!1,{reducer:f,sorter:p}=this._getBidSorters(u,e),m=()=>{d=!0,l.markEndTask(),o()},h=()=>{d||(i&&this._displayBidsBackhandler({},u,e,f,p),m())};if(!s||!e.length){m();return}l.markEndTask(),this._initialized||await this._awaitPrebidReady();let g=Gh.markStartTask(`microtask`,[`PrebidAuctionManager`,`requestBids`,`second`,`task`]);g.addMetadata({slotNames:c}),this._addLabels(e,n,r,i),a&&this._updateSlots(e),this._buildRequest(u,e,t,n,i,m);let _=t+(e[0].refreshCount?0:this._config.prebid.failsafeTimeout),v=()=>{this._prebidMethods.addToQueue(()=>{setTimeout(h,_)})};this._bootstrapConfig.gptLibFailedToLoad?v():Zh.pushToQueue(()=>v),g.markEndTask()}).catch(e=>{M.error(`PrebidAuctionManager`,`requestBids`,e),o()})})}_buildRequest(e,t,n=this._config.timeouts.initialBidsRequest,r=[],i=!0,a,o,s){this._prebidMethods.requestBids({adUnitCodes:e,timeout:n,bidsBackHandler:n=>{i&&this._displayBidsBackhandler(n,e,t,o,s),a()},labels:r})}_getBidSorters(e,t){var n;let r=e.length>1,i=((n=t[0])==null?void 0:n.location)===F.Video_StickyOutstream,a,o;return!r&&i&&(a=this.cpmByDurationReducer.bind(this),o=this.cpmByDurationSorter.bind(this)),{reducer:a,sorter:o}}_displayBidsBackhandler(e,t,n,r,i){if(this._bootstrapConfig.gptLibFailedToLoad){this.handleRenderingSlotsWhenGoogleAdManagerFailed(n);return}else{var a;this._config.fledge.enabled&&this._prebidMethods.setPAAPIConfigForGPT({adUnitCode:t[0]});let o=((a=n[0])==null?void 0:a.location)===F.Footer,s=o?this._roadblocksDetection.isRoadblock(e):!1;s&&this._gam.setTargeting({key:`rb_crid`,value:String(this._roadblocksDetection.creativeId)});let c=s?2:1;this._prebidMethods.setTargetingForGPTAsync(t,null,n[0].bidPoolId,c,r,i),this._setDiscountTargeting(n[0]),n.forEach(e=>{e.addRequestTypeSlotFlag()}),this.setCurrencySlotTargetingFlag(n[0])}}_updateOrtb2WithJwPlayerSegments(e,t){var n,r,i,a;let o=nO(t),s=((n=o.site)==null||(n=n.content)==null||(n=n.data)==null?void 0:n.filter(e=>e.name!==`jwplayer.com`))||[],c={ext:{segtax:502,cids:[e.nextMediaId]},name:`jwplayer.com`,segment:(r=(i=e.jwPlayerSegments)==null?void 0:i.map(e=>({id:e})))==null?[]:r};return s.push(c),o.site={...o.site,content:{...(a=o.site)==null?void 0:a.content,data:s}},o}_updateVideoAdUnitData(e){e.forEach(e=>{var t;let n=OC(this._config.video.plcmtUnits,e);n&&!((t=e.videoAdUnit)==null||(t=t.mediaTypes)==null)&&t.video&&(e.videoAdUnit.mediaTypes.video.plcmt=n,e.plcmt=n)})}async requestVideoBids(e,t=this._config.timeouts.initialBidsRequest){return new Promise(n=>{let r=!1,i=()=>{n(),r=!0},a=()=>{r||n()};this.checkLibLoaded().then(async n=>{n||i(),this._initialized||await this._awaitPrebidReady(),e.forEach(e=>this._instreamAuctionRefreshByPlayer.set(e.name,e.prerollNum));let r=e.map(({name:e})=>e),o=this._prebidMethods.getConfig(`ortb2`)||{},s=!UC(e[0]),c={};s&&(c=this._updateOrtb2WithJwPlayerSegments(e[0],o),this._updateVideoAdUnitData(e)),e.forEach(e=>{if(e.prerollNum>0){var t;let n=(t=this._prebidMethods.getPrebidAdUnits())==null?void 0:t.filter(t=>t.code===e.name);n&&n.length&&(this._updateAdUnitOrtb2Imp(e,n),this.updateBidsTrafficShapingLabels(e,n))}}),this._setRefreshOnVideoAdUnit(e),this._prebidMethods.requestBids({adUnitCodes:r,timeout:t,bidsBackHandler:t=>{this._videoBidsBackhandler(t,e),i()},...s?{ortb2:c}:{}});let l=t+(e[0].prerollNum?0:this._config.prebid.failsafeTimeout),u=()=>{this._prebidMethods.addToQueue(()=>{setTimeout(a,l)})};this._bootstrapConfig.gptLibFailedToLoad?u():Zh.pushToQueue(()=>u)}).catch(e=>{M.error(`PrebidAuctionManager`,`requestVideoBids`,e),i()})})}_getActiveBidsInPool(e,t){var n;let r=this._prebidMethods,i=(n=t?r.getBidResponsesForBidPoolId(t):r.getBidResponsesForAdUnitCode(e))==null?{}:n,a=i.bids;return a==null?void 0:a.filter(t=>this._filterUnusedBids(t,e))}_filterUnusedBids(e,t){let n=e.ttl||300;e.responseTimestamp=e.responseTimestamp||new Date().getTime();let r=e.responseTimestamp+n*1e3>new Date().getTime(),i=e&&(!e.sharedBidInUse||e.sharedBidInUse===t)&&e.status!==`rendered`;return r&&i}_videoBidsBackhandler(e,t){var n;let r=t[0].videoAdUnit,i=r==null||(n=r.mediaTypes)==null||(n=n.video)==null?void 0:n.maxduration;if(r&&i&&e[r.code]){let n=e[r.code].bids;n.forEach(e=>{e.maxDuration=i}),t[0].setPrebidBids(n)}}setCurrencySlotTargetingFlag(e){if(this._config.prebid.currencyConversionEnabled){let t=`bidcur`,n=[];n=e.bidPoolId?this._prebidMethods.getHighestCpmBidsForPoolId(e.bidPoolId):this._prebidMethods.getHighestCpmBids(e.id);let r=n==null?void 0:n[0],i=r==null?void 0:r.originalCurrency,a=r==null?void 0:r.currency;r&&a&&i!==a?e.setSlotTargetingFlag(t,[i||`undefined`,a],!0):e.clearSlotTargetingFlag([t])}}handleRenderingSlotsWhenGoogleAdManagerFailed(e){e.forEach(e=>{e.isRefreshing=!1,this._slotEventBus.triggerRenderOutsideGam.emit(e.id)})}addVideoSlots(e){let t=this._getBidsForSlots(e).instream,n=e.map(e=>{let n=t.get(e.name),r=this._ortb2.addOrtb2Imp({video:e},n),i={code:e.name,ortb2Imp:r,mediaTypes:this._mediaType.getMediaType({video:e}),bids:n};return e.videoAdUnit=i,i});this._prebidMethods.addAdUnits(n),this._videoEventBus.videoAdUnitAdded.emit()}refreshBids(e,t=0,n=!0){return e.forEach(e=>{var t;(t=e.prebidAdUnit)==null||t.forEach(e=>e.refresh=!0)}),this.requestBids(e,this._config.timeouts.refreshBidsRequest,[],t,n,!0)}checkLibLoaded(){return new Promise(e=>{this._bootstrapConfig.bootstrapLoaders[Rn.Prebid].then(()=>e(!0)).catch(()=>e(!1))})}shouldTurnOffPrebidBasedOnGeoAndDevice(){var e;let t=(e=this._context.country)==null?`US`:e,n=!this._highRevGeoCountries.includes(t)&&tG()&&Qt(),r=il.isRolloutEnabled(`disable-prebid-non-high-geo-mob-chromium`),i=n?r:!1;return i}get enabled(){return!(this.shouldTurnOffPrebidBasedOnGeoAndDevice()||Yt())}cpmByDurationReducer(e,t){return this.getBidCpmByDuration(e)<this.getBidCpmByDuration(t)?t:e}cpmByDurationSorter(e,t){return this.getBidCpmByDuration(t)-this.getBidCpmByDuration(e)}getBidCpmByDuration(e){var t;let n=Math.max(1,(t=e.duration)==null?this._defaultVideoDuration:t);return e.cpm/n}_setupSlotRequestTargeting(e,t){var n;let r=this._slots.get(e.code),i=(n=e&&e.ortb2Imp&&e.ortb2Imp.ext&&e.ortb2Imp.ext.tid)==null?``:n;if(r&&(r.setTransactionId(i),r.setSlotTargetingFlag(`tid`,[r.transactionId],!0),r.setTargeting({key:`idp`,value:t}),r.multiformat&&r.refreshCount<2)){let e=`b`;this._mediaType.nativeEnabled(r)&&(e+=`n`),this._mediaType.outstreamEnabled(r).outstreamCapable&&(e+=`v`),r.setSlotTargetingFlag(`mtr`,[e],!0)}}_handleExpiredRender(){this._prebidEventBus.expiredRender.on(e=>{let{bidder:t,cpm:n,adUnitCode:r,dealId:i,originalCpm:a,responseCpm:o,meta:s}=e,{hb_pb:c,hb_format:l}=e.adserverTargeting,u=this._slots.get(r),d=u?u.refreshCount:``;M.event(`PrebidAuctionManager`,`_handleExpiredRender`,{bidder:t,cpm:n,originalCpm:a,responseCpm:o,hb_pb:c,hb_format:l,meta:s,adUnitCode:r,nref:d,dealId:i})})}},gI=D([Q(`PrebidAuctionManager`),C(),A(`design:paramtypes`,[Object,typeof(BF=Ki!==void 0&&Ki)==`function`?BF:Object,typeof(VF=z!==void 0&&z)==`function`?VF:Object,typeof(HF=L!==void 0&&L)==`function`?HF:Object,typeof(UF=Zh!==void 0&&Zh)==`function`?UF:Object,typeof(WF=mF!==void 0&&mF)==`function`?WF:Object,typeof(GF=ZN!==void 0&&ZN)==`function`?GF:Object,typeof(KF=BC!==void 0&&BC)==`function`?KF:Object,typeof(qF=R!==void 0&&R)==`function`?qF:Object,typeof(JF=LP!==void 0&&LP)==`function`?JF:Object,typeof(YF=RP!==void 0&&RP)==`function`?YF:Object,typeof(XF=vF!==void 0&&vF)==`function`?XF:Object,typeof(ZF=_h!==void 0&&_h)==`function`?ZF:Object,typeof(QF=aP!==void 0&&aP)==`function`?QF:Object,typeof($F=$C!==void 0&&$C)==`function`?$F:Object,typeof(eI=oP!==void 0&&oP)==`function`?eI:Object,typeof(tI=ow!==void 0&&ow)==`function`?tI:Object,typeof(nI=Pr!==void 0&&Pr)==`function`?nI:Object,typeof(rI=Vr!==void 0&&Vr)==`function`?rI:Object,typeof(iI=eU!==void 0&&eU)==`function`?iI:Object,typeof(aI=yr!==void 0&&yr)==`function`?aI:Object,typeof(oI=yF!==void 0&&yF)==`function`?oI:Object,typeof(sI=QT!==void 0&&QT)==`function`?sI:Object,typeof(cI=kF!==void 0&&kF)==`function`?cI:Object,typeof(lI=zh!==void 0&&zh)==`function`?lI:Object,typeof(uI=SF!==void 0&&SF)==`function`?uI:Object,typeof(dI=ik!==void 0&&ik)==`function`?dI:Object,typeof(fI=bF!==void 0&&bF)==`function`?fI:Object,typeof(pI=lE!==void 0&&lE)==`function`?pI:Object,typeof(mI=LF!==void 0&&LF)==`function`?mI:Object,typeof(hI=RF!==void 0&&RF)==`function`?hI:Object]),kt(0,ot(`AdThrive`))],gI)})),_I=o((()=>{Oue()})),vI,yI=o((()=>{vI=e=>{if(!Number.isFinite(e))return``;let t=``;return t=e<=.04?`00.00_00.04`:e<=3?`00.05_03.00`:e<=5?`03.05_05.00`:e<=10?`05.05_10.00`:`10.10_100.00`,t}})),bI,kue=o((()=>{Ui(),w(),E(),O(),bI=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`ViewportSampling`,this._lookup=`VPSM`}},bI=D([C()],bI)})),xI,SI,CI,wI,TI,EI,DI,OI,kI,Aue=o((()=>{w(),$(),gse(),_I(),tU(),Hr(),Ua(),yI(),B(),kue(),Bh(),vh(),j(),E(),O(),kI=class{constructor(e,t,n,r,i,a,o,s){this._config=e,this._slotEventBus=r,this._videoEventBus=i,this._gamEventBus=a,this._viewportSamplingExperiment=o,this._slots=s,T(this,`_auctionManagers`,void 0),T(this,`_bidsInCacheMap`,new Map),T(this,`_lastAuctionData`,new Map),this._auctionManagers=[n,t].filter(e=>e.enabled),this._setSlotEvents(),this._setVideoEvents()}_setSlotEvents(){this._slotEventBus.addSlots.on(e=>this._addSlots(e)),this._slotEventBus.requestingBids.on(e=>this._requestBids(e)),this._slotEventBus.beforeGoogleAdManagerRefreshSlots.on(e=>this._beforeGoogleAdManagerRefreshSlots(e)),this._slotEventBus.refreshingBids.on(e=>this._refreshBids(e.managedSlotsIds,e.auctionCount,e.setTargeting)),this._slotEventBus.addRangeSlotTargeting.on(e=>this._addRangeSlotTargeting(e)),this._gamEventBus.slotRenderEnded.on(e=>{this._clearLastAuctionKeyValueTargeting(e.slotId)})}_setVideoEvents(){this._videoEventBus.videoPlayerAdded.on(e=>this._addVideoSlots(e)),this._videoEventBus.requestingVideoBids.on(({videos:e,timeout:t})=>this._requestVideoBids(e,t)),this._videoEventBus.buildingVastAdURL.on(e=>this._setInstreamBidCacheTargeting(e))}_awaitMarmaladeLoaded(){return this._config.marmalade.marmaladeEventPromise}_awaitTrafficShapingLoaded(){return this._config.trafficShaping.trafficShapingEventPromise}_awaitRaptiveMLFloorsLoaded(){return this._config.floors.raptiveMLFloorsEventPromise}init(){this._auctionManagers.forEach(e=>void this._auctionManagerInit(e))}async _awaitSetup(){let e=this._config,t=[];e.marmalade.loaded||t.push(this._awaitMarmaladeLoaded()),e.trafficShaping.trafficShapingLoaded||t.push(this._awaitTrafficShapingLoaded()),e.floors.raptiveMLFloorsLoaded||t.push(this._awaitRaptiveMLFloorsLoaded()),this._config.creativeBlock.creativeBlockEnabled&&!this._config.creativeBlock.cridsLoaded&&t.push(this._config.creativeBlock.cridEventPromise),await Promise.all(t)}async _auctionManagerInit(e){await this._awaitSetup(),e.init!==void 0&&e.init()}_clearLastAuctionKeyValueTargeting(e){let t=this._slots.get(e);t&&setTimeout(()=>{this._auctionManagers.forEach(e=>e.clearAuctionTargeting(t))},1e3)}_addRangeSlotTargeting(e){let t=this._slots.get(e);t.forEach(e=>{let t=e.googleTagSlot,n=(t==null?void 0:t.getTargetingKeys())||[],r=[`hb_pb`,`amz_pb`,`amz_pb_sp`],i=null;r.forEach(e=>{if(n.includes(e)){let n=Number(t==null?void 0:t.getTargeting(e)[0]);(!i||i&&n>i)&&(i=n)}}),i&&e.setTargeting({key:`hb_rpb`,value:vI(i)})})}async _beforeGoogleAdManagerRefreshSlots(e){let t=this._slots.get(e);await this._setDisplayBidCacheTargeting(t)}async _requestBids(e){let t=this._slots.get(e);await this._setPreAuctionBidCacheData(t),await Ha(),await Promise.all(this._auctionManagers.map(e=>e.requestBids(t)))}async _setDisplayBidCacheTargeting(e){let t=await Promise.all(this._auctionManagers.map(t=>t.setDisplayBidCacheTargeting(e)));e.forEach(e=>{let n=this._getBidCacheTargeting(e.id,t,e.refreshCount);this._setDisplayBidCacheTargetingOnSlot(e,n)})}_setDisplayBidCacheTargetingOnSlot(e,t){let n=e.id,r=this._getTargetingMap(n,t);if(Object.keys(r).forEach(t=>{var n;let i=t;e.setSlotTargetingFlag(t,[(n=r[i])==null?`none`:n],!0)}),this._viewportSamplingExperiment.result){let t=e.getPositionFromViewport().toString();e.setSlotTargetingFlag(`v`,[t],!0)}}async _setInstreamBidCacheTargeting(e){let t=await Promise.all(this._auctionManagers.map(t=>t.setInstreamBidCacheTargeting(e)));e.forEach(e=>{let n=this._getBidCacheTargeting(e.name,t,e.prerollNum);this._setInstreamBidCacheTargetingMap(e,n)})}_getTargetingMap(e,t){var n,r,i,a,o,s;let c=t.bids.sort((e,t)=>t.cpm-e.cpm),l=(n=this._getBidRate(t))==null?`none`:n;return this._lastAuctionData.set(e,{...t,bidRate:l}),{bic:((r=this._bidsInCacheMap.get(e))==null?0:r).toString(),tbc:c==null||(i=c[0])==null?void 0:i.cpm.toFixed(2),"2bc":(a=c==null||(o=c[1])==null?void 0:o.cpm.toFixed(2))==null?`none`:a,medb:(s=this._getMedianBid(c))==null?`none`:s,bidr:l}}async _setPreAuctionBidCacheData(e){let t=await Promise.all(this._auctionManagers.map(t=>t.setPreAuctionBidCacheData(e)));e.forEach(e=>{let n=`id`in e?e.id:e.name,r=this._getBidsInCacheValue(n,t);this._setBidsInCache(n,r.bids)})}_setBidsInCache(e,t){this._bidsInCacheMap.set(e,t)}_getBidsInCacheValue(e,t){let n={bids:0};return t.reduce((t,n)=>{var r;let i=(r=n.get(e))==null?0:r;return t.bids+=i,t},n)}_getBidCacheTargeting(e,t,n){let r=this._lastAuctionData.get(e),i=(r==null?void 0:r.refresh)===n?r:{bids:[],requests:0,responses:0,refresh:0,bidRate:0};return t.reduce((t,n)=>{let r=n.get(e);return r&&Object.keys(r).forEach(e=>{let n=e,i=r[n];i&&(n===`bids`&&Array.isArray(i)&&i.length?t[n]=[...t[n],...i]:n===`refresh`&&typeof i==`number`?t[n]=i:n!==`bids`&&typeof i==`number`&&(t[n]+=i))}),t},i)}_setInstreamBidCacheTargetingMap(e,t){let n=e.name;e.lastAuctionBidDetails=this._getTargetingMap(n,t)}_getBidRate(e){let{requests:t,responses:n}=e;return(n/(t||1)).toFixed(2)}_getMedianBid(e){let t=e.length;if(!t)return;let n;if(t===1)n=e[0].cpm;else{let r=t%2==0,i=Math.floor(t/2);n=r?(e[i].cpm+e[i-1].cpm)/2:e[i].cpm}return n.toFixed(2)}async _refreshBids(e,t=0,n=!0){let r=this._slots.get(e);r.forEach(e=>{var t;(t=e.googleTagSlot)==null||t.clearTargeting(`hb_rpb`)}),await this._setPreAuctionBidCacheData(r),await Promise.all(this._auctionManagers.map(e=>e.refreshBids(r,t,n)))}_addSlots(e){let t=this._slots.get(e);this._auctionManagers.forEach(e=>{e.addSlots!==void 0&&e.addSlots(t)})}_addVideoSlots(e){this._auctionManagers.filter(e=>e.videoEnabled&&e.addVideoSlots).forEach(t=>t.addVideoSlots(e))}async _requestVideoBids(e,t){await this._setPreAuctionBidCacheData(e),await Promise.all(this._auctionManagers.filter(e=>e.videoEnabled).map(n=>n.requestVideoBids(e,t)))}getPrebidAuctionManager(){for(let e of this._auctionManagers)if(e instanceof gI)return e}getAmazonAuctionManager(){for(let e of this._auctionManagers)if(e instanceof Ow)return e}},kI=D([Q(`AuctionManagers`),C(),A(`design:paramtypes`,[typeof(xI=z!==void 0&&z)==`function`?xI:Object,typeof(SI=gI!==void 0&&gI)==`function`?SI:Object,typeof(CI=Ow!==void 0&&Ow)==`function`?CI:Object,typeof(wI=Vr!==void 0&&Vr)==`function`?wI:Object,typeof(TI=eU!==void 0&&eU)==`function`?TI:Object,typeof(EI=zh!==void 0&&zh)==`function`?EI:Object,typeof(DI=bI!==void 0&&bI)==`function`?DI:Object,typeof(OI=_h!==void 0&&_h)==`function`?OI:Object])],kI)})),AI=o((()=>{Aue(),tg(),fw()})),jI,jue=o((()=>{E(),jI=class{constructor(e){T(this,`_container`,document.createElement(`DIV`)),this._container.className=`adthrive-loading-spinner-container`,this._container.style.display=`none`,this._container.appendChild(this._createSpinner()),e.appendChild(this._container)}_createSpinner(){let e=document.createElement(`DIV`);return e.className=`adthrive-loading-spinner`,e}get el(){return this._container}show(){this._container.style.display=`inline-flex`}hide(){this._container.style.display=`none`}}})),MI,NI,Mue=o((()=>{$(),j(),E(),O(),NI=MI=class{constructor(){T(this,`_adCountDownElement`,document.createElement(`div`)),T(this,`_canStartAdCountDown`,!1),T(this,`_count`,0),T(this,`_hardcodedTimeLeft`,void 0),T(this,`_builtInCountdownElements`,[`adAttribution`,`countdown`]),T(this,`_hiddenClassElement`,`adthrive-hidden`),this._adCountDownElement.classList.add(`adthrive-count-down`)}get canStartAdCountDown(){return this._canStartAdCountDown}addAdTimer(e){this._adCountDownElement.classList.add(this._hiddenClassElement),e.appendChild(this._adCountDownElement)}displayAdTimer(){this._adCountDownElement.classList.remove(this._hiddenClassElement)}hideAdTimer(){this._adCountDownElement.classList.add(this._hiddenClassElement),this._canStartAdCountDown=!1}setAdTimer(e,t,n){let{uiElements:r}=e==null?void 0:e.ad,i=(r==null?void 0:r.length)&&this._hasBuiltInCountdownElements(r);this._canStartAdCountDown=!i||t,!this._hardcodedTimeLeft&&t&&n&&(this._hardcodedTimeLeft=n*15)}reset(){this._hardcodedTimeLeft=void 0,this._count=0}updateAdCountdown(e,t){let n=Math.round(e-t);if(n!==this._count&&n>=0){this._count=n;let e=this._hardcodedTimeLeft===void 0?n:this._hardcodedTimeLeft;this._updateCountdownText(e),this._hardcodedTimeLeft&&this._hardcodedTimeLeft--}else n<=0&&this.hideAdTimer()}_updateCountdownText(e){let t=this._hardcodedTimeLeft?MI.POD_COUNTDOWN_TEXT:MI.INDIVIDUAL_COUNTDOWN_TEXT;this._adCountDownElement.innerHTML=`${t} ${e}`}_hasBuiltInCountdownElements(e){return e.includes(this._builtInCountdownElements[0])&&e.includes(this._builtInCountdownElements[1])}},T(NI,`INDIVIDUAL_COUNTDOWN_TEXT`,`Ad ends in`),T(NI,`POD_COUNTDOWN_TEXT`,`Ads end in`),NI=MI=D([Q(`AdCountDownTimer`),A(`design:paramtypes`,[])],NI)})),PI,Nue=o((()=>{Ui(),w(),E(),O(),PI=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`AdxStickyOutstream`,this._lookup=`ADXISO`}},PI=D([C()],PI)})),FI,II,LI,Pue=o((()=>{$(),w(),H(),B(),Nue(),j(),E(),O(),II={InContainer:1,OutContainerLeft:2,OutContainerRight:3,TopCollapse:4},LI=class extends V{constructor(e){super(),this._config=e,T(this,`_hasTitleBar`,!1),T(this,`_position`,II.OutContainerLeft),T(this,`_adxStickyOutstreamExperiment`,x.resolve(PI).result)}createPlayerCloseButton(e,t,n,r=!1,i){this._hasTitleBar=r,this._position=i?this._getPositionForMobile(t,i):this._getPositionForDesktop(t);let a=this._config.isStickyOutstreamTopCenterColorsDisabled&&t===`sticky outstream`;if(a){let e=document.createElement(`style`);e.textContent=`#adthrive-sticky-outstream-close > svg > * { stroke: white; }`,document.head.appendChild(e)}let o=this._getButtonClasses(),s=this._getSvgOptions(this._position===II.TopCollapse&&(t===`instream`||!a)?this._config.adOptions.secColor:null),c=this._createCloseButton(o,n,s);return c.onclick=e,c.onkeydown=e=>{e.code===`Space`&&e.preventDefault()},c.onkeyup=t=>{[`Space`,`Enter`].includes(t.code)&&e()},this._position===II.InContainer?this.applyCloseButtonWrapper(c):c}_getPositionForMobile(e,t){return t===`top-center`?II.TopCollapse:e===`sticky outstream`?this._adxStickyOutstreamExperiment?t===`bottom-right`?II.OutContainerRight:II.OutContainerLeft:II.InContainer:II.OutContainerLeft}_getPositionForDesktop(e){return e===`sticky outstream`?this._adxStickyOutstreamExperiment?II.OutContainerRight:II.InContainer:II.OutContainerLeft}_getButtonClasses(){var e;let t=[`adthrive-video-close`],n={[II.TopCollapse]:[`adthrive-top-collapse-close`],[II.OutContainerLeft]:[`adthrive-wrapper-float-close`,`adthrive-top-left-outer`,`adthrive-video-close-float-left`],[II.OutContainerRight]:[`adthrive-wrapper-float-close`,`adthrive-top-right-outer`,`adthrive-video-close-float-right`],[II.InContainer]:[`adthrive-close-in-container`]},r=(e=n[this._position])==null?[]:e;return[...t,...r]}_getSvgOptions(e){let t=`white`,n=`black`;return(this._position===II.InContainer||this._position===II.TopCollapse)&&(t=`transparent`,n=`white`),e&&(n=e),{fillColor:t,strokeColor:n}}_buildNewCloseButton(e,t){e.appendChild(this._createCloseButtonX(t)),e.appendChild(this._createCloseButtonCircleThatGoesAroundTheX(t))}_createCloseButton(e,t,n){let{fillColor:r,strokeColor:i}=n,a=this._createButtonHtml(e,t),o=this._createSvg(r);if(this._position===II.TopCollapse)this._buildNewCloseButton(o,i);else{let e=this._createPath(i);o.appendChild(e)}return a.appendChild(o),a}_createButtonHtml(e,t){let n=document.createElement(`div`);return n.tabIndex=0,n.className=e.join(` `),n.id=t,n}_createSvg(e){let t=document.createElementNS(`http://www.w3.org/2000/svg`,`svg`);return t.setAttribute(`width`,`18`),t.setAttribute(`height`,`18`),t.setAttribute(`text-anchor`,`middle`),t.setAttribute(`dominant-baseline`,`central`),t.setAttribute(`fill`,e),t.setAttribute(`text-anchor`,`middle`),t.setAttribute(`dominant-baseline`,`central`),t}_createPath(e){let t=document.createElementNS(`http://www.w3.org/2000/svg`,`path`);return t.setAttribute(`d`,`M 0.5 9 A 5 5 0 0 0 17.5 9 A 5 5 0 0 0 0.5 9 M 9 9 L 7 7 L 11 11 M 9 9 L 7 11 L 11 7`),t.setAttribute(`stroke`,e),t.setAttribute(`stroke-width`,`1`),t}_createCloseButtonCircleThatGoesAroundTheX(e){let t=document.createElementNS(`http://www.w3.org/2000/svg`,`circle`);return t.setAttribute(`cx`,`9`),t.setAttribute(`cy`,`9`),t.setAttribute(`r`,`8`),t.setAttribute(`stroke`,e),t.setAttribute(`stroke-width`,`2`),t.setAttribute(`fill`,`none`),t}_createCloseButtonX(e){let t=document.createElementNS(`http://www.w3.org/2000/svg`,`text`);return t.setAttribute(`x`,`9`),t.setAttribute(`y`,`9`),t.setAttribute(`text-anchor`,`middle`),t.setAttribute(`stroke`,e),t.setAttribute(`fill`,e),t.setAttribute(`stroke-width`,`1px`),t.setAttribute(`font-size`,`13px`),t.setAttribute(`alignment-baseline`,`middle`),t.textContent=`x`,t}applyCloseButtonWrapper(e){let t=document.createElement(`div`),n=[`adthrive-wrapper-float-close`,`adthrive-wrapper-close-bkgd-50`];return this._hasTitleBar?n.push(`adthrive-top-left-inner-wrapper`):n.push(`adthrive-top-left-inner`),t.classList.add(...n),t.appendChild(e),t}},LI=D([Q(`VideoCloseButtonComponent`),S(),A(`design:paramtypes`,[typeof(FI=z!==void 0&&z)==`function`?FI:Object])],LI)})),RI=o((()=>{Pue()})),zI,BI,VI,Fue=o((()=>{$(),w(),_W(),Z(),j(),E(),O(),VI=class{constructor(e,t){this._raptiveMobilePlayerExperiment=e,this._raptiveDesktopPlayerExperiment=t,T(this,`_pushVideoPlayerDown`,()=>{}),T(this,`_pushVideoPlayerUp`,()=>{}),T(this,`_header`,null),T(this,`_isHeaderVisible`,!0),T(this,`_desktopRaptivePlayerEnabled`,!1),T(this,`_mobileRaptivePlayerEnabled`,!1),T(this,`_isMobile`,tG()),T(this,`_open`,!1),T(this,`handleUncollapse`,(e,t)=>{let{playerContainer:n,topBackgroundElement:r}=e;if(n.style.removeProperty(`top`),r.style.removeProperty(`top`),t){this.collapsiblePersistentHeaderObserver.disconnect();let e=this.getSiteHeader(t);e&&(e.onclick=null)}}),T(this,`handleCollapse`,e=>{if(e.mobileHeaderSelector){this.anchorVideoPlayerBelowNavbar(e,e.mobileHeaderSelector);let t=this.getSiteHeader(e.mobileHeaderSelector);t&&(this.collapsiblePersistentHeaderObserver.observe(t),t.onclick=()=>{this._open=!this._open,this._open?(e.programmaticPause(),e.playerContainer.style.display=`none`):(e.programmaticPlay(),e.playerContainer.style.display=`block`)})}}),T(this,`collapsiblePersistentHeaderObserver`,new IntersectionObserver(e=>{for(let t of e)this._isHeaderVisible=t.isIntersecting,this._isHeaderVisible?this._pushVideoPlayerDown():this._pushVideoPlayerUp()},{threshold:.95}));let n=x.resolve(JU).result;this._desktopRaptivePlayerEnabled=n||!this._isMobile&&this._raptiveDesktopPlayerExperiment.result,this._mobileRaptivePlayerEnabled=n||this._isMobile&&this._raptiveMobilePlayerExperiment.result}applyTransitionToElement(e){!this._mobileRaptivePlayerEnabled&&!this._desktopRaptivePlayerEnabled&&(e.style.transition=`all 0.2s ease-in-out`)}pushElementBelowHeader(e,t){t!==null&&e.style.setProperty(`top`,`${t}px`)}anchorVideoPlayerBelowNavbar(e,t){let{playerContainer:n,topBackgroundElement:r}=e,i=()=>{let e=this.getHeaderHeight(t);if(e!==null){this.applyTransitionToElement(r),this.applyTransitionToElement(n),this.pushElementBelowHeader(r,e),this.pushElementBelowHeader(n,e);let t=n.querySelector(`.adthrive-top-collapse-wrapper-bar`);t&&this.pushElementBelowHeader(t,e)}},a=()=>{r.style.top=`0`,n.style.top=`0`};this._isHeaderVisible?i():a(),this._pushVideoPlayerDown=i,this._pushVideoPlayerUp=a}getHeaderHeight(e){let t=this.getSiteHeader(e);if(!t)return null;let n=this.getElementHeight(t);return n}getElementHeight(e){return e.getBoundingClientRect().height}getSiteHeader(e){if(this._header)return this._header;let t=document.querySelector(e);return t?(this._header=t,this._header):null}},VI=D([C(),Q(`TopCenterVideoPlayerForPersistentHeaderUtils`),A(`design:paramtypes`,[typeof(zI=KU!==void 0&&KU)==`function`?zI:Object,typeof(BI=WU!==void 0&&WU)==`function`?BI:Object])],VI)})),HI,UI,WI,GI,KI=o((()=>{rU(),$(),bt(),Ff(),Z(),w(),X(),Fue(),O(),E(),UI=Pf.getScrollTop(),WI=void 0,GI=HI=class{static changeState(e,t){let n=this._handleOtherVideoPlaying(t,e),r=e.playerState&&(e.playerState===Y.UserPauseCollapsed||n||e.playerState===Y.UserPauseUncollapsed)&&t===SW.UserClick;if(!r){let n=this._shouldCollapse(e);switch(e.playerState){case Y.Unstarted:this._handleUnstarted(t,e);break;case Y.UncollapsedPlay:this._handleUncollapsedPlay(t,n,e);break;case Y.CollapsedPlay:this._handleCollapsedPlay(t,n,e);break;case Y.UserPauseUncollapsed:this._handleUserPauseUncollapsed(t,n,e);break;case Y.UserPauseCollapsed:this._handleUserPauseCollapsed(t,n,e);break;case Y.PausedNotVisible:this._handlePausedNotVisible(t,e);break;case Y.Overlapped:this._handleOverlapped(t,n,e);break;default:return e.playerState}}return e.playerState}static _handleUnstarted(e,t){if(this.offsetheight||(this.offsetheight=t.playerContainer.offsetHeight),e===SW.InView){let e=t.isAcAlwaysStickyEnabled?!t.playerCollapsed:!0;e&&(t.programmaticPlay({logEvent:!1}),t.collapseTimer.firstInView||(t.collapseTimer.firstInView=new Date)),HI.startEvent.emit(),t.playerState=Y.UncollapsedPlay}}static _setPlayerClosed(e){e.playerState=Y.Closed,this._isTopCollapse(e)&&x.resolve(eU).topCenterVideoClosed.emit()}static _handleOtherVideoPlaying(e,t){let{programmaticPause:n}=t;return e===SW.OtherVideoPlaying?(this.uncollapse(t),n({pausedByOtherPlayer:!0}),this._setPlayerClosed(t),!0):!1}static _handleUncollapsedPlay(e,t,n){let{programmaticPause:r,programmaticPlay:i}=n;e===SW.InView?t&&(this.collapse(n),n.playerState=Y.CollapsedPlay):e===SW.OutOfView?t?(i(),this.collapse(n),n.playerState=Y.CollapsedPlay):n.playerState!==Y.UserPauseUncollapsed&&(r(),n.playerState=Y.PausedNotVisible):e===SW.UserClick&&(n.playerState=Y.UserPauseUncollapsed)}static _handleCollapsedPlay(e,t,n){let{programmaticPause:r,playerContainer:i}=n;e===SW.InView?t||(this.uncollapse(n),n.playerState=Y.UncollapsedPlay):e===SW.OutOfView?t||(this.uncollapse(n),r(),n.playerState=Y.PausedNotVisible):e===SW.UserClick?n.playerState=Y.UserPauseCollapsed:e===SW.Overlapping?(n.lastCollapsedClasses=i.className,this.uncollapse(n),r(),n.playerState=Y.Overlapped):e===SW.Close&&(this.uncollapse(n),r(),this._setPlayerClosed(n))}static _handleUserPauseCollapsed(e,t,n){let{programmaticPause:r}=n;e===SW.InView&&!t?(this.uncollapse(n),n.playerState=Y.UserPauseUncollapsed):e===SW.UserClick?n.playerState=Y.CollapsedPlay:e===SW.Close&&(this.uncollapse(n),r(),this._setPlayerClosed(n))}static _handleUserPauseUncollapsed(e,t,n){let{programmaticPlay:r}=n;e===SW.InView&&t?t?(this.collapse(n),n.playerState=Y.UserPauseCollapsed):r():e===SW.UserClick&&(n.playerState=Y.UncollapsedPlay)}static _handlePausedNotVisible(e,t){let{programmaticPlay:n}=t;e===SW.InView&&(n(),t.playerState=Y.UncollapsedPlay)}static _handleOverlapped(e,t,n){let{programmaticPlay:r}=n;t&&!this.playerWouldOverlapFooter(n)&&(this.collapse(n),r(),n.playerState=Y.CollapsedPlay)}static handleResize(e){this._isCollapsed(e.playerState)&&e.collapseType===yW.Mobile&&e.collapseMobileSubType===`adthrive-collapse-top-center`&&e.topBackgroundElement&&(e.topBackgroundElement.style.height=`${e.playerContainer.offsetHeight}px`,e.topBackgroundElement.style.width=`${window.innerWidth}px`)}static handleScroll(e){let{playerState:t,playerContainer:n,playbackStarted:r}=e,i=Pf.getScrollTop(),a=i>UI;UI=i;let o=this._shouldCollapseOnScrollUp(e),s=Pf.playerViewable(n),c=!s&&(o?!r:!0),l=this._isWarmupComplete(e),u;u=c?e.isAcAlwaysStickyEnabled&&!e.playbackStarted?SW.InView:SW.OutOfView:this.playerWouldOverlapFooter(e)?SW.Overlapping:SW.InView;let d=RW(n)&&t===Y.PausedNotVisible&&!l;this._isTopOfPage()?this.stopCollapseWarmupTimer(e):a&&d?(this.startCollapseWarmupTimer(e),u=SW.OutOfView,clearTimeout(WI),WI=setTimeout(()=>{this._isWarmupComplete(e)&&(this.stopCollapseWarmupTimer(e),e.playerState=Y.UncollapsedPlay,this.changeState(e,u))},1e3)):l&&this.stopCollapseWarmupTimer(e),this.changeState(e,u),e.playerState===Y.CollapsedPlay||e.playerState===Y.UserPauseCollapsed?HI.startCollapseTimer(e):HI.stopCollapseTimer(e)}static handleOtherVideoPlaying(e){this.changeState(e,SW.OtherVideoPlaying)}static handlePageVisibilityChange(e,t){if(t.playerState!==Y.Closed&&t.playerState!==Y.Unstarted&&t.playerState!==Y.UserPauseUncollapsed&&t.playerState!==Y.UserPauseCollapsed&&t.playerState!==Y.PausedNotVisible&&t.playerState!==Y.Overlapped){let{programmaticPause:n,programmaticPlay:r}=t;e?n():r()}}static handleWidthBreak(e,t){t.playerState===Y.Closed||t.playerState===Y.Unstarted||(e.matches?(this._isCollapsed(t.playerState)&&(this.toggleCollapsedPlayerClasses(!1,t),t.forceMobile=!0,this.toggleCollapsedPlayerClasses(!0,t)),t.forceMobile=!0):(this.toggleCollapsedPlayerClasses(!1,t),t.forceMobile=!1,this._isCollapsed(t.playerState)&&this.toggleCollapsedPlayerClasses(!0,t)))}static handleClose(e,t=0){HI.closeEvent.emit(),this.changeState(e,SW.Close),HI.stopCollapseTimer(e),M.event(`RaptivePlayer`,`handleClose`,{timeElapsed:e.collapseTimer.timeCollapsed,device:Ei()?`desktop`:`mobile`,playerType:e.playerType,vp:t})}static handleUserClick(e){this.changeState(e,SW.UserClick)}static collapse(e){let{playerContainer:t,topBackgroundElement:n,programmaticPause:r,programmaticPlay:i}=e;if(this.disableCollapse)return;e.playerCollapsed=!0,e.hidePlayer(),this.toggleCollapsedPlayerClasses(!0,e),e.showPlayer(),this.repositionCollapseMobile(e,!0),e.hasPreviouslyCollapsed=!0,this.collapseEvent.emit(),n&&x.resolve(VI).handleCollapse({topBackgroundElement:n,mobileHeaderSelector:e.mobileHeaderSelector,playerContainer:t,programmaticPause:r,programmaticPlay:i}),setTimeout(e=>{this.displayCloseButton(e)},0,e);let a=x.resolve(eU);a.topCenterVideoCollapsed.emit(e),a.videoCollapsed.emit(e)}static displayCloseButton(e){this._isCollapsed(e.playerState)&&(e.closeButton.style.display=`inline-flex`)}static uncollapse(e){let{playerContainer:t,topBackgroundElement:n,mobileHeaderSelector:r}=e,i=x.resolve(eU);e.hidePlayer(),this.toggleCollapsedPlayerClasses(!1,e),e.showPlayer(),this.repositionCollapseMobile(e,!1),this._unstickFromSidebar(t),e.playerCollapsed=!1,HI.uncollapseEvent.emit(),e.closeButton.style.display=`none`,n&&(x.resolve(VI).handleUncollapse({playerContainer:t,topBackgroundElement:n},r),i.topCenterVideoUnCollapsed.emit()),i.videoUnCollapsed.emit()}static _shouldCollapse(e){let{playbackStarted:t,playerPosition:n}=e;if(!e.isAcAlwaysStickyEnabled&&!t)return!1;let r=this._shouldCollapseOnScrollUp(e);if(Pf.isMobileLandscape())return!1;let i=this._isTopCollapse(e);if(i){let t=!!e.collapseTimer.warmupStartTime,n=this._isWarmupComplete(e);if(this._isTopOfPage()||t&&!n)return!1}let a=Pf.getScrollTop(),o=Pf.getScrollBottom(),s=IW(n),c=this.offsetheight,l=s.top,u=l+c,d=a>=l||r&&o<=u,f=a>=l+c/2||r&&o<=u-c/2;return i?d:f}static _shouldCollapseOnScrollUp(e){let{collapseTimer:{firstInView:t}}=e;return!!t}static _isCollapsed(e){return e===Y.CollapsedPlay||e===Y.UserPauseCollapsed}static _isWarmupComplete(e){let{collapseTimer:t}=e;return t.warmupStartTime?Date.now()-t.warmupStartTime.getTime()>1e3:!1}static _isTopOfPage(){return window.scrollY<1}static _isTopCollapse(e){return e.collapseMobileSubType&&e.collapseMobileSubType===`adthrive-collapse-top-center`}static _stickToSidebar(e){e.stickyElement&&(e.playerContainer.style.left=`${e.stickyElement.getBoundingClientRect().left}px`,e.playerContainer.style.width=`${e.stickyElement.clientWidth}px`),e.playerContainer.style.top=`${e.topMargin}px`}static _unstickFromSidebar(e){e.style.bottom=``,e.style.removeProperty(`transform`)}static playerWouldOverlapFooter(e){if(!e.footerElement||eK(e.footerElement))return!1;if(e.playerContainer.className.includes(`adthrive-collapse-bottom`)||e.lastCollapsedClasses&&e.lastCollapsedClasses.includes(`adthrive-collapse-bottom`)){let t=_n();return!(window.innerHeight-t<e.footerElement.getBoundingClientRect().top)}return!((e.topMargin||0)+e.playerContainer.getBoundingClientRect().height<e.footerElement.getBoundingClientRect().top)}static _castArray(e){return Array.isArray(e)?e:[e]}static toggleClass(e,t,n){t=this._castArray(t),t.forEach(t=>{n?e.playerContainer.classList.add(t):e.playerContainer.classList.remove(t)})}static toggleCollapsedPlayerClasses(e,t){this.toggleClass(t,`raptive-player-collapse`,e),t.forceMobile?(this.toggleClass(t,yW.Mobile,e),this.toggleClass(t,t.collapseMobileSizeType,e),this.toggleClass(t,t.collapseMobileSubType,e),this.classesToggled.emit()):(this.toggleClass(t,t.collapseType,e),t.collapseSubType&&this.toggleClass(t,t.collapseSubType,e),t.collapseMobileSizeType&&this.toggleClass(t,t.collapseMobileSizeType,e),t.collapseType===yW.Mobile&&t.collapseMobileSubType&&this.toggleClass(t,t.collapseMobileSubType,e),this.classesToggled.emit())}static repositionCollapseMobile(e,t){e.collapseMobileSubType===`adthrive-collapse-bottom-left`||e.collapseMobileSubType===`adthrive-collapse-bottom-right`?this.repositionCollapseMobileBottom(e):e.collapseMobileSubType===`adthrive-collapse-top-center`&&this.repositionCollapseMobileTop(e,t)}static repositionCollapseMobileTop(e,t){e.topBackgroundElement&&(t?e.topBackgroundElement.style.height=`${e.playerContainer.offsetHeight}px`:(e.topBackgroundElement.style.height=`0`,e.topBackgroundElement.classList.remove(`extra-height`)))}static repositionCollapseMobileBottom(e){if(e.playerContainer.className.includes(`adthrive-collapse-bottom`)||e.collapseMobileSubType&&e.collapseMobileSubType.indexOf(`bottom`)>-1){let t=_n();e.playerContainer.style.setProperty(`top`,`auto`,`important`),e.playerContainer.style.setProperty(`bottom`,`${t}px`,`important`)}}static startCollapseTimer(e){e.collapseTimer.isRunning||(e.collapseTimer.startTime?e.collapseTimer.lastCollapsedTime=new Date:(e.collapseTimer.startTime=new Date,e.collapseTimer.lastCollapsedTime=e.collapseTimer.startTime),e.collapseTimer.isRunning=!0)}static stopCollapseTimer(e){e.collapseTimer.isRunning&&(e.collapseTimer.lastCollapsedTime&&(e.collapseTimer.timeCollapsed+=Yr()-e.collapseTimer.lastCollapsedTime.getTime()),e.collapseTimer.isRunning=!1)}static startCollapseWarmupTimer(e){e.collapseTimer.warmupStartTime||(e.collapseTimer.warmupStartTime=new Date)}static stopCollapseWarmupTimer(e){e.collapseTimer.warmupStartTime&&(e.collapseTimer.warmupStartTime=void 0)}},T(GI,`collapseEvent`,new k),T(GI,`uncollapseEvent`,new k),T(GI,`classesToggled`,new k),T(GI,`closeEvent`,new k),T(GI,`startEvent`,new k),T(GI,`disableCollapse`,!1),T(GI,`offsetheight`,0),GI=HI=D([Q(`CollapseUtils`)],GI)}));function Iue(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,`default`)?e.default:e}function qI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function JI(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?qI(Object(n),!0).forEach(function(t){Lue(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qI(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Lue(e,t,n){return t=zue(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YI(){return YI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YI.apply(this,arguments)}function Rue(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function zue(e){var t=Rue(e,`string`);return typeof t==`symbol`?t:String(t)}function Bue(e){let t=self.console[e];return t?t.bind(self.console,`[${e}] >`):QR}function Vue(e,...t){t.forEach(function(t){ez[t]=e[t]?e[t].bind(e):Bue(t)})}function Hue(e,t){if(self.console&&e===!0||typeof e==`object`){Vue(e,`debug`,`log`,`info`,`warn`,`error`);try{ez.log(`Debug logs enabled for "${t}" in hls.js version 1.4.12`)}catch(e){ez=$R}}else ez=$R}function Uue(e){return e!==`ID`&&e!==`CLASS`&&e!==`START-DATE`&&e!==`DURATION`&&e!==`END-DATE`&&e!==`END-ON-NEXT`}function Wue(e){return e===`SCTE35-OUT`||e===`SCTE35-IN`}function XI(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}function Gue(e){let t=ZI(e).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}function Kue(e){let t=function(e,t,n){let r=e[t];e[t]=e[n],e[n]=r};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}function que(e){let t=e.split(`:`),n=null;if(t[0]===`data`&&t.length===2){let e=t[1].split(`;`),r=e[e.length-1].split(`,`);if(r.length===2){let t=r[0]===`base64`,i=r[1];t?(e.splice(-1,1),n=XI(i)):n=Gue(i)}}return n}function ZI(e){return Uint8Array.from(unescape(encodeURIComponent(e)),e=>e.charCodeAt(0))}function QI(e){switch(e){case pz.FAIRPLAY:return fz.FAIRPLAY;case pz.PLAYREADY:return fz.PLAYREADY;case pz.WIDEVINE:return fz.WIDEVINE;case pz.CLEARKEY:return fz.CLEARKEY}}function Jue(e){if(e===mz.WIDEVINE)return fz.WIDEVINE}function $I(e){switch(e){case fz.FAIRPLAY:return pz.FAIRPLAY;case fz.PLAYREADY:return pz.PLAYREADY;case fz.WIDEVINE:return pz.WIDEVINE;case fz.CLEARKEY:return pz.CLEARKEY}}function eL(e){let{drmSystems:t,widevineLicenseUrl:n}=e,r=t?[fz.FAIRPLAY,fz.WIDEVINE,fz.PLAYREADY,fz.CLEARKEY].filter(e=>!!t[e]):[];return!r[fz.WIDEVINE]&&n&&r.push(fz.WIDEVINE),r}function Yue(e,t,n,r){let i;switch(e){case fz.FAIRPLAY:i=[`cenc`,`sinf`];break;case fz.WIDEVINE:case fz.PLAYREADY:i=[`cenc`];break;case fz.CLEARKEY:i=[`cenc`,`keyids`];break;default:throw Error(`Unknown key-system: ${e}`)}return Xue(i,t,n,r)}function Xue(e,t,n,r){let i={initDataTypes:e,persistentState:r.persistentState||`not-allowed`,distinctiveIdentifier:r.distinctiveIdentifier||`not-allowed`,sessionTypes:r.sessionTypes||[r.sessionType||`temporary`],audioCapabilities:t.map(e=>({contentType:`audio/mp4; codecs="${e}"`,robustness:r.audioRobustness||``,encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:n.map(e=>({contentType:`video/mp4; codecs="${e}"`,robustness:r.videoRobustness||``,encryptionScheme:r.videoEncryptionScheme||null}))};return[i]}function tL(e,t,n){return Uint8Array.prototype.slice?e.slice(t,n):new Uint8Array(Array.prototype.slice.call(e,t,n))}function Zue(){return!jz&&self.TextDecoder!==void 0&&(jz=new self.TextDecoder(`utf-8`)),jz}function nL(e){return String.fromCharCode.apply(null,e)}function rL(e,t){let n=e[t]<<8|e[t+1];return n<0?65536+n:n}function iL(e,t){let n=aL(e,t);return n<0?4294967296+n:n}function aL(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function oL(e,t,n){e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=n&255}function sL(e,t){let n=[];if(!t.length)return n;let r=e.byteLength;for(let i=0;i<r;){let a=iL(e,i),o=nL(e.subarray(i+4,i+8)),s=a>1?i+a:r;if(o===t[0])if(t.length===1)n.push(e.subarray(i+8,s));else{let r=sL(e.subarray(i+8,s),t.slice(1));r.length&&Pz.apply(n,r)}i=s}return n}function Que(e){let t=[],n=e[0],r=8,i=iL(e,r);r+=4,n===0?r+=8:r+=16,r+=2;let a=e.length+0,o=rL(e,r);r+=2;for(let n=0;n<o;n++){let n=r,o=iL(e,n);n+=4;let s=o&2147483647,c=(o&2147483648)>>>31;if(c===1)return q.warn(`SIDX has hierarchical references (not supported)`),null;let l=iL(e,n);n+=4,t.push({referenceSize:s,subsegmentDuration:l,info:{duration:l/i,start:a,end:a+s-1}}),a+=s,n+=4,r=n}return{earliestPresentationTime:0,timescale:i,version:n,referencesCount:o,references:t}}function cL(e){let t=[],n=sL(e,[`moov`,`trak`]);for(let e=0;e<n.length;e++){let r=n[e],i=sL(r,[`tkhd`])[0];if(i){let e=i[0],n=e===0?12:20,a=iL(i,n),o=sL(r,[`mdia`,`mdhd`])[0];if(o){e=o[0],n=e===0?12:20;let i=iL(o,n),s=sL(r,[`mdia`,`hdlr`])[0];if(s){let e=nL(s.subarray(8,12)),n={soun:oz.AUDIO,vide:oz.VIDEO}[e];if(n){let e=sL(r,[`mdia`,`minf`,`stbl`,`stsd`])[0],o;e&&(o=nL(e.subarray(12,16))),t[a]={timescale:i,type:n},t[n]={timescale:i,id:a,codec:o}}}}}}let r=sL(e,[`moov`,`mvex`,`trex`]);return r.forEach(e=>{let n=iL(e,4),r=t[n];r&&(r.default={duration:iL(e,12),flags:iL(e,20)})}),t}function $ue(e,t){if(!e||!t)return e;let n=t.keyId;if(n&&t.isCommonEncryption){let t=sL(e,[`moov`,`trak`]);t.forEach(e=>{let t=sL(e,[`mdia`,`minf`,`stbl`,`stsd`])[0],r=t.subarray(8),i=sL(r,[`enca`]),a=i.length>0;a||(i=sL(r,[`encv`])),i.forEach(e=>{let t=a?e.subarray(28):e.subarray(78),r=sL(t,[`sinf`]);r.forEach(e=>{let t=lL(e);if(t){let e=t.subarray(8,24);e.some(e=>e!==0)||(q.log(`[eme] Patching keyId in 'enc${a?`a`:`v`}>sinf>>tenc' box: ${Mz.hexDump(e)} -> ${Mz.hexDump(n)}`),t.set(n,8))}})})})}return e}function lL(e){let t=sL(e,[`schm`])[0];if(t){let n=nL(t.subarray(4,8));if(n===`cbcs`||n===`cenc`)return sL(e,[`schi`,`tenc`])[0]}return q.error(`[eme] missing 'schm' box`),null}function ede(e,t){return sL(t,[`moof`,`traf`]).reduce((t,n)=>{let r=sL(n,[`tfdt`])[0],i=r[0],a=sL(n,[`tfhd`]).reduce((t,n)=>{let a=iL(n,4),o=e[a];if(o){let e=iL(r,4);if(i===1){if(e===Nz)return q.warn(`[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time`),t;e*=Nz+1,e+=iL(r,8)}let n=o.timescale||9e4,a=e/n;if(isFinite(a)&&(t===null||a<t))return a}return t},null);return a!==null&&isFinite(a)&&(t===null||a<t)?a:t},null)}function tde(e,t){let n=0,r=0,i=0,a=sL(e,[`moof`,`traf`]);for(let e=0;e<a.length;e++){let o=a[e],s=sL(o,[`tfhd`])[0],c=iL(s,4),l=t[c];if(!l)continue;let u=l.default,d=iL(s,0)|(u==null?void 0:u.flags),f=u==null?void 0:u.duration;d&8&&(f=d&2?iL(s,12):iL(s,8));let p=l.timescale||9e4,m=sL(o,[`trun`]);for(let e=0;e<m.length;e++){if(n=nde(m[e]),!n&&f){let t=iL(m[e],4);n=f*t}l.type===oz.VIDEO?r+=n/p:l.type===oz.AUDIO&&(i+=n/p)}}if(r===0&&i===0){let t=0,n=sL(e,[`sidx`]);for(let e=0;e<n.length;e++){let r=Que(n[e]);r!=null&&r.references&&(t+=r.references.reduce((e,t)=>e+t.info.duration||0,0))}return t}return r||i}function nde(e){let t=iL(e,0),n=8;t&1&&(n+=4),t&4&&(n+=4);let r=0,i=iL(e,4);for(let a=0;a<i;a++){if(t&256){let t=iL(e,n);r+=t,n+=4}t&512&&(n+=4),t&1024&&(n+=4),t&2048&&(n+=4)}return r}function rde(e,t,n){sL(t,[`moof`,`traf`]).forEach(t=>{sL(t,[`tfhd`]).forEach(r=>{let i=iL(r,4),a=e[i];if(!a)return;let o=a.timescale||9e4;sL(t,[`tfdt`]).forEach(e=>{let t=e[0],r=iL(e,4);if(t===0)r-=n*o,r=Math.max(r,0),oL(e,4,r);else{r*=2**32,r+=iL(e,8),r-=n*o,r=Math.max(r,0);let t=Math.floor(r/(Nz+1)),i=Math.floor(r%(Nz+1));oL(e,4,t),oL(e,8,i)}})})})}function ide(e){let t={valid:null,remainder:null},n=sL(e,[`moof`]);if(n){if(n.length<2)return t.remainder=e,t}else return t;let r=n[n.length-1];return t.valid=tL(e,0,r.byteOffset-8),t.remainder=tL(e,r.byteOffset-8),t}function uL(e,t){let n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function dL(e,t){let n=[],r=t.samples,i=t.timescale,a=t.id,o=!1,s=sL(r,[`moof`]);return s.map(s=>{let c=s.byteOffset-8,l=sL(s,[`traf`]);l.map(s=>{let l=sL(s,[`tfdt`]).map(e=>{let t=e[0],n=iL(e,4);return t===1&&(n*=2**32,n+=iL(e,8)),n/i})[0];return l!==void 0&&(e=l),sL(s,[`tfhd`]).map(l=>{let u=iL(l,4),d=iL(l,0)&16777215,f=(d&1)!=0,p=(d&2)!=0,m=(d&8)!=0,h=0,g=(d&16)!=0,_=0,v=(d&32)!=0,y=8;u===a&&(f&&(y+=8),p&&(y+=4),m&&(h=iL(l,y),y+=4),g&&(_=iL(l,y),y+=4),v&&(y+=4),t.type===`video`&&(o=ade(t.codec)),sL(s,[`trun`]).map(a=>{let s=a[0],l=iL(a,0)&16777215,u=(l&1)!=0,d=0,f=(l&4)!=0,p=(l&256)!=0,m=0,g=(l&512)!=0,v=0,y=(l&1024)!=0,b=(l&2048)!=0,ee=0,te=iL(a,4),ne=8;u&&(d=iL(a,ne),ne+=4),f&&(ne+=4);let re=d+c;for(let c=0;c<te;c++){if(p?(m=iL(a,ne),ne+=4):m=h,g?(v=iL(a,ne),ne+=4):v=_,y&&(ne+=4),b&&(ee=s===0?iL(a,ne):aL(a,ne),ne+=4),t.type===oz.VIDEO){let t=0;for(;t<v;){let a=iL(r,re);if(re+=4,ode(o,r[re])){let t=r.subarray(re,re+a);fL(t,o?2:1,e+ee/i,n)}re+=a,t+=a+4}}e+=m/i}}))})})}),n}function ade(e){if(!e)return!1;let t=e.indexOf(`.`),n=t<0?e:e.substring(0,t);return n===`hvc1`||n===`hev1`||n===`dvh1`||n===`dvhe`}function ode(e,t){if(e){let e=t>>1&63;return e===39||e===40}else{let e=t&31;return e===6}}function fL(e,t,n,r){let i=pL(e),a=0;a+=t;let o=0,s=0,c=!1,l=0;for(;a<i.length;){o=0;do{if(a>=i.length)break;l=i[a++],o+=l}while(l===255);s=0;do{if(a>=i.length)break;l=i[a++],s+=l}while(l===255);let e=i.length-a;if(!c&&o===4&&a<i.length){c=!0;let e=i[a++];if(e===181){let e=rL(i,a);if(a+=2,e===49){let e=iL(i,a);if(a+=4,e===1195456820){let e=i[a++];if(e===3){let t=i[a++],s=31&t,c=64&t,l=c?2+s*3:0,u=new Uint8Array(l);if(c){u[0]=t;for(let e=1;e<l;e++)u[e]=i[a++]}r.push({type:e,payloadType:o,pts:n,bytes:u})}}}}}else if(o===5&&s<e){if(c=!0,s>16){let e=[];for(let t=0;t<16;t++){let n=i[a++].toString(16);e.push(n.length==1?`0`+n:n),(t===3||t===5||t===7||t===9)&&e.push(`-`)}let t=s-16,c=new Uint8Array(t);for(let e=0;e<t;e++)c[e]=i[a++];r.push({payloadType:o,pts:n,uuid:e.join(``),userData:Az(c),userDataBytes:c})}}else if(s<e)a+=s;else if(s>e)break}}function pL(e){let t=e.byteLength,n=[],r=1;for(;r<t-2;)e[r]===0&&e[r+1]===0&&e[r+2]===3?(n.push(r+2),r+=2):r++;if(n.length===0)return e;let i=t-n.length,a=new Uint8Array(i),o=0;for(r=0;r<i;o++,r++)o===n[0]&&(o++,n.shift()),a[r]=e[o];return a}function sde(e){let t=e[0],n=``,r=``,i=0,a=0,o=0,s=0,c=0,l=0;if(t===0){for(;nL(e.subarray(l,l+1))!==`\0`;)n+=nL(e.subarray(l,l+1)),l+=1;for(n+=nL(e.subarray(l,l+1)),l+=1;nL(e.subarray(l,l+1))!==`\0`;)r+=nL(e.subarray(l,l+1)),l+=1;r+=nL(e.subarray(l,l+1)),l+=1,i=iL(e,12),a=iL(e,16),s=iL(e,20),c=iL(e,24),l=28}else if(t===1){l+=4,i=iL(e,l),l+=4;let t=iL(e,l);l+=4;let a=iL(e,l);for(l+=4,o=2**32*t+a,Number.isSafeInteger(o)||(o=2**53-1,q.warn(`Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box`)),s=iL(e,l),l+=4,c=iL(e,l),l+=4;nL(e.subarray(l,l+1))!==`\0`;)n+=nL(e.subarray(l,l+1)),l+=1;for(n+=nL(e.subarray(l,l+1)),l+=1;nL(e.subarray(l,l+1))!==`\0`;)r+=nL(e.subarray(l,l+1)),l+=1;r+=nL(e.subarray(l,l+1)),l+=1}let u=e.subarray(l,e.byteLength);return{schemeIdUri:n,value:r,timeScale:i,presentationTime:o,presentationTimeDelta:a,eventDuration:s,id:c,payload:u}}function cde(e,...t){let n=t.length,r=8,i=n;for(;i--;)r+=t[i].byteLength;let a=new Uint8Array(r);for(a[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=r&255,a.set(e,4),i=0,r=8;i<n;i++)a.set(t[i],r),r+=t[i].byteLength;return a}function lde(e,t,n){if(e.byteLength!==16)throw RangeError(`Invalid system id`);let r,i;if(t){r=1,i=new Uint8Array(t.length*16);for(let e=0;e<t.length;e++){let n=t[e];if(n.byteLength!==16)throw RangeError(`Invalid key`);i.set(n,e*16)}}else r=0,i=new Uint8Array;let a;r>0?(a=new Uint8Array(4),t.length>0&&new DataView(a.buffer).setUint32(0,t.length,!1)):a=new Uint8Array;let o=new Uint8Array(4);return n&&n.byteLength>0&&new DataView(o.buffer).setUint32(0,n.byteLength,!1),cde([112,115,115,104],new Uint8Array([r,0,0,0]),e,a,i,o,n||new Uint8Array)}function ude(e){if(!(e instanceof ArrayBuffer)||e.byteLength<32)return null;let t={version:0,systemId:``,kids:null,data:null},n=new DataView(e),r=n.getUint32(0);if(e.byteLength!==r&&r>44)return null;let i=n.getUint32(4);if(i!==1886614376||(t.version=n.getUint32(8)>>>24,t.version>1))return null;t.systemId=Mz.hexDump(new Uint8Array(e,12,16));let a=n.getUint32(28);if(t.version===0){if(r-32<a)return null;t.data=new Uint8Array(e,32,a)}else if(t.version===1){t.kids=[];for(let n=0;n<a;n++)t.kids.push(new Uint8Array(e,32+n*16,16))}return t}function dde(e){let t=new Uint8Array(16);for(let n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}function mL(e){return Rz.test(e)}function hL(e,t,n){if(e.variableList!==null||e.hasVariableRefs)for(let r=n.length;r--;){let i=n[r],a=t[i];a&&(t[i]=gL(e,a))}}function gL(e,t){if(e.variableList!==null||e.hasVariableRefs){let n=e.variableList;return t.replace(Rz,t=>{let r=t.substring(2,t.length-1),i=n==null?void 0:n[r];return i===void 0?(e.playlistParsingError||(e.playlistParsingError=Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),t):i})}return t}function _L(e,t,n){let r=e.variableList;r||(e.variableList=r={});let i,a;if(`QUERYPARAM`in t){i=t.QUERYPARAM;try{let e=new self.URL(n).searchParams;if(e.has(i))a=e.get(i);else throw Error(`"${i}" does not match any query parameter in URI: "${n}"`)}catch(t){e.playlistParsingError||(e.playlistParsingError=Error(`EXT-X-DEFINE QUERYPARAM: ${t.message}`))}}else i=t.NAME,a=t.VALUE;i in r?e.playlistParsingError||(e.playlistParsingError=Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):r[i]=a||``}function fde(e,t,n){let r=t.IMPORT;if(n&&r in n){let t=e.variableList;t||(e.variableList=t={}),t[r]=n[r]}else e.playlistParsingError||(e.playlistParsingError=Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}function vL(){if(!(typeof self>`u`))return self.MediaSource||self.WebKitMediaSource}function pde(e,t){let n=zz[t];return!!n&&n[e.slice(0,4)]===!0}function yL(e,t){var n;return(n=Bz==null?void 0:Bz.isTypeSupported(`${t||`video`}/mp4;codecs="${e}"`))==null?!1:n}function bL(e,t,n){var r,i;let a=new rz(e);hL(n,a,[`KEYFORMAT`,`KEYFORMATVERSIONS`,`URI`,`IV`,`URI`]);let o=(r=a.METHOD)==null?``:r,s=a.URI,c=a.hexadecimalInteger(`IV`),l=a.KEYFORMATVERSIONS,u=(i=a.KEYFORMAT)==null?`identity`:i;s&&a.IV&&!c&&q.error(`Invalid IV: ${a.IV}`);let d=s?Kz.resolve(s,t):``,f=(l||`1`).split(`/`).map(Number).filter(Number.isFinite);return new Lz(o,d,u,f,c)}function xL(e){let t=new rz(e),n=t.decimalFloatingPoint(`TIME-OFFSET`);return XR(n)?n:null}function mde(e,t){[`video`,`audio`,`text`].forEach(n=>{let r=e.filter(e=>pde(e,n));if(r.length){let i=r.filter(e=>e.lastIndexOf(`avc1`,0)===0||e.lastIndexOf(`mp4a`,0)===0);t[`${n}Codec`]=i.length>0?i[0]:r[0],e=e.filter(e=>r.indexOf(e)===-1)}}),t.unknownCodecs=e}function SL(e,t,n){let r=t[n];r&&(e[n]=r)}function hde(e,t){let n=e[t];for(let r=t;r--;){let t=e[r];if(!t)return;t.programDateTime=n.programDateTime-t.duration*1e3,n=t}}function CL(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):t!=null&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),XR(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function wL(e,t,n,r){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=n,e.sn=`initSegment`,r&&(e.levelkeys=r),e.initSegment=null}function TL(e,t,n){e.levelkeys=t;let{encryptedFragments:r}=n;(!r.length||r[r.length-1].levelkeys!==t)&&Object.keys(t).some(e=>t[e].isCommonEncryption)&&r.push(e)}function EL(e){let{type:t}=e;switch(t){case qz.AUDIO_TRACK:return Jz.AUDIO;case qz.SUBTITLE_TRACK:return Jz.SUBTITLE;default:return Jz.MAIN}}function DL(e,t){let n=e.url;return(n===void 0||n.indexOf(`data:`)===0)&&(n=t.url),n}function OL(e,t){let n;try{n=new Event(`addtrack`)}catch(e){n=document.createEvent(`Event`),n.initEvent(`addtrack`,!1,!1)}n.track=e,t.dispatchEvent(n)}function kL(e,t){let n=e.mode;if(n===`disabled`&&(e.mode=`hidden`),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw Error(`addCue is failed for: ${t}`)}catch(n){q.debug(`[texttrack-utils]: ${n}`);try{let n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(e){q.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${e}`)}}n===`disabled`&&(e.mode=n)}function AL(e){let t=e.mode;if(t===`disabled`&&(e.mode=`hidden`),e.cues)for(let t=e.cues.length;t--;)e.removeCue(e.cues[t]);t===`disabled`&&(e.mode=t)}function jL(e,t,n,r){let i=e.mode;if(i===`disabled`&&(e.mode=`hidden`),e.cues&&e.cues.length>0){let i=_de(e.cues,t,n);for(let t=0;t<i.length;t++)(!r||r(i[t]))&&e.removeCue(i[t])}i===`disabled`&&(e.mode=i)}function gde(e,t){if(t<e[0].startTime)return 0;let n=e.length-1;if(t>e[n].endTime)return-1;let r=0,i=n;for(;r<=i;){let a=Math.floor((i+r)/2);if(t<e[a].startTime)i=a-1;else if(t>e[a].startTime&&r<n)r=a+1;else return a}return e[r].startTime-t<t-e[i].startTime?r:i}function _de(e,t,n){let r=[],i=gde(e,t);if(i>-1)for(let a=i,o=e.length;a<o;a++){let i=e[a];if(i.startTime>=t&&i.endTime<=n)r.push(i);else if(i.startTime>n)return r}return r}function ML(){if(!(typeof self>`u`))return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}function NL(e,t){return e.getTime()/1e3-t}function vde(e){return Uint8Array.from(e.replace(/^0x/,``).replace(/([\da-fA-F]{2}) ?/g,`0x$1 `).replace(/ +$/,``).split(` `)).buffer}function yde(e,t){let{canSkipUntil:n,canSkipDateRanges:r,endSN:i}=e,a=t===void 0?0:t-i;return n&&a<n?r?nB.v2:nB.Yes:nB.No}function PL(e,t){let n=t.startPTS;if(XR(n)){let r=0,i;t.sn>e.sn?(r=n-e.start,i=e):(r=e.start-n,i=t),i.duration!==r&&(i.duration=r)}else if(t.sn>e.sn){let n=e.cc===t.cc;n&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration}else t.start=Math.max(e.start-t.duration,0)}function FL(e,t,n,r,i,a){let o=r-n;o<=0&&(q.warn(`Fragment should have a positive duration`,t),r=n+t.duration,a=i+t.duration);let s=n,c=r,l=t.startPTS,u=t.endPTS;if(XR(l)){let e=Math.abs(l-n);XR(t.deltaPTS)?t.deltaPTS=Math.max(e,t.deltaPTS):t.deltaPTS=e,s=Math.max(n,l),n=Math.min(n,l),i=Math.min(i,t.startDTS),c=Math.min(r,u),r=Math.max(r,u),a=Math.max(a,t.endDTS)}let d=n-t.start;t.start!==0&&(t.start=n),t.duration=r-t.start,t.startPTS=n,t.maxStartPTS=s,t.startDTS=i,t.endPTS=r,t.minEndPTS=c,t.endDTS=a;let f=t.sn;if(!e||f<e.startSN||f>e.endSN)return 0;let p,m=f-e.startSN,h=e.fragments;for(h[m]=t,p=m;p>0;p--)PL(h[p],h[p-1]);for(p=m;p<h.length-1;p++)PL(h[p],h[p+1]);return e.fragmentHint&&PL(h[h.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,d}function bde(e,t){let n=null,r=e.fragments;for(let e=r.length-1;e>=0;e--){let t=r[e].initSegment;if(t){n=t;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;let i=0,a;if(Cde(e,t,(e,r)=>{e.relurl&&(i=e.cc-r.cc),XR(e.startPTS)&&XR(e.endPTS)&&(r.start=r.startPTS=e.startPTS,r.startDTS=e.startDTS,r.maxStartPTS=e.maxStartPTS,r.endPTS=e.endPTS,r.endDTS=e.endDTS,r.minEndPTS=e.minEndPTS,r.duration=e.endPTS-e.startPTS,r.duration&&(a=r),t.PTSKnown=t.alignedSliding=!0),r.elementaryStreams=e.elementaryStreams,r.loader=e.loader,r.stats=e.stats,r.urlId=e.urlId,e.initSegment&&(r.initSegment=e.initSegment,n=e.initSegment)}),n){let e=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments;e.forEach(e=>{var t;(!e.initSegment||e.initSegment.relurl===((t=n)==null?void 0:t.relurl))&&(e.initSegment=n)})}if(t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some(e=>!e),t.deltaUpdateFailed){q.warn(`[level-helper] Previous playlist missing segments skipped in delta playlist`);for(let e=t.skippedSegments;e--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=xde(e.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));let o=t.fragments;if(i){q.warn(`discontinuity sliding from playlist, take drift into account`);for(let e=0;e<o.length;e++)o[e].cc+=i}t.skippedSegments&&(t.startCC=t.fragments[0].cc),Sde(e.partList,t.partList,(e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats}),a?FL(t,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS):IL(e,t),o.length&&(t.totalduration=t.edge-o[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;let s=t.advancedDateTime;if(t.advanced&&s){let e=t.edge;t.driftStart||(t.driftStartTime=s,t.driftStart=e),t.driftEndTime=s,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}function xde(e,t,n){let r=YI({},e);return n&&n.forEach(e=>{delete r[e]}),Object.keys(t).forEach(e=>{let n=new iz(t[e].attr,r[e]);n.isValid?r[e]=n:q.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(t[e].attr)}"`)}),r}function Sde(e,t,n){if(e&&t){let r=0;for(let i=0,a=e.length;i<=a;i++){let a=e[i],o=t[i+r];a&&o&&a.index===o.index&&a.fragment.sn===o.fragment.sn?n(a,o):r--}}}function Cde(e,t,n){let r=t.skippedSegments,i=Math.max(e.startSN,t.startSN)-t.startSN,a=(e.fragmentHint?1:0)+(r?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,o=t.startSN-e.startSN,s=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,c=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let e=i;e<=a;e++){let i=c[o+e],a=s[e];r&&!a&&e<r&&(a=t.fragments[e]=i),i&&a&&n(i,a)}}function IL(e,t){let n=t.startSN+t.skippedSegments-e.startSN,r=e.fragments;n<0||n>=r.length||LL(t,r[n].start)}function LL(e,t){if(t){let n=e.fragments;for(let r=e.skippedSegments;r<n.length;r++)n[r].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function wde(e,t=1/0){let n=1e3*e.targetduration;if(e.updated){let r=e.fragments;if(r.length&&n*4>t){let e=r[r.length-1].duration*1e3;e<n&&(n=e)}}else n/=2;return Math.round(n)}function Tde(e,t,n){if(!(e!=null&&e.details))return null;let r=e.details,i=r.fragments[t-r.startSN];return i||(i=r.fragmentHint,i&&i.sn===t)?i:t<r.startSN&&n&&n.sn===t?n:null}function RL(e,t,n){var r;return e!=null&&e.details?zL((r=e.details)==null?void 0:r.partList,t,n):null}function zL(e,t,n){if(e)for(let r=e.length;r--;){let i=e[r];if(i.index===n&&i.fragment.sn===t)return i}return null}function BL(e){switch(e.details){case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_TIMEOUT:case K.LEVEL_LOAD_TIMEOUT:case K.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function VL(e,t){let n=BL(t);return e.default[`${n?`timeout`:`error`}Retry`]}function HL(e,t){let n=e.backoff===`linear`?1:2**t;return Math.min(n*e.retryDelayMs,e.maxRetryDelayMs)}function UL(e){return JI(JI({},e),{errorRetry:null,timeoutRetry:null})}function WL(e,t,n,r){return!!e&&t<e.maxNumRetry&&(Ede(r)||!!n)}function Ede(e){return e===0&&navigator.onLine===!1||!!e&&(e<400||e>499)}function Dde(e,t,n){if(t===null||!Array.isArray(e)||!e.length||!XR(t))return null;let r=e[0].programDateTime;if(t<(r||0))return null;let i=e[e.length-1].endProgramDateTime;if(t>=(i||0))return null;n=n||0;for(let r=0;r<e.length;++r){let i=e[r];if(Ode(t,n,i))return i}return null}function GL(e,t,n=0,r=0){let i=null;if(e?i=t[e.sn-t[0].sn+1]||null:n===0&&t[0].start===0&&(i=t[0]),i&&KL(n,r,i)===0)return i;let a=aB.search(t,KL.bind(null,n,r));return a&&(a!==e||!i)?a:i}function KL(e=0,t=0,n){if(n.start<=e&&n.start+n.duration>e)return 0;let r=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-r<=e?1:n.start-r>e&&n.start?-1:0}function Ode(e,t,n){let r=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0))*1e3,i=n.endProgramDateTime||0;return i-r>e}function kde(e,t){return aB.search(e,e=>e.cc<t?1:e.cc>t?-1:0)}function Ade(e,t,n){if(performance.now()-e.lastErrorPerfMs>oB)return!0;let r=e.details;if(t.details===K.FRAG_GAP&&r&&t.frag){let e=t.frag.start,n=GL(null,r.fragments,e);if(n&&!n.gap)return!0}if(n&&e.errors.length<n.errors.length){let n=e.errors[e.errors.length-1];if(r&&n.frag&&t.frag&&Math.abs(n.frag.start-t.frag.start)>r.targetduration*3)return!0}return!1}function qL(e,t,n){n&&(t===`audio`?(e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds[e.url.length-1]=n):t===`text`&&(e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds[e.url.length-1]=n))}function JL(e){let t={};e.forEach(e=>{let n=e.groupId||``;e.id=t[n]=t[n]||0,t[n]++})}function YL(e){var t,n,r;return e.buffered&&(e.body.gap||((t=e.range.video)==null?void 0:t.partial)||((n=e.range.audio)==null?void 0:n.partial)||((r=e.range.audiovideo)==null?void 0:r.partial))}function XL(e){return`${e.type}_${e.level}_${e.urlId}_${e.sn}`}function ZL(e,t=null){let n=t||e,r={frag:e,part:t,responseType:`arraybuffer`,url:n.url,headers:{},rangeStart:0,rangeEnd:0},i=n.byteRangeStartOffset,a=n.byteRangeEndOffset;if(XR(i)&&XR(a)){var o;let t=i,n=a;if(e.sn===`initSegment`&&((o=e.decryptdata)==null?void 0:o.method)===`AES-128`){let e=a-i;e%16&&(n=a+(16-e%16)),i!==0&&(r.resetIV=!0,t=i-16)}r.rangeStart=t,r.rangeEnd=n}return r}function QL(e,t){let n=Error(`GAP ${e.gap?`tag`:`attribute`} found`),r={type:ZR.MEDIA_ERROR,details:K.FRAG_GAP,fatal:!1,frag:e,error:n,networkDetails:null};return t&&(r.part=t),(t||e).stats.aborted=!0,new _B(r)}function $L(){return{start:0,executeStart:0,executeEnd:0,end:0}}function eR(e,t){let n=null;for(let r=0,i=e.length;r<i;r++){let i=e[r];if(i&&i.cc===t){n=i;break}}return n}function jde(e,t,n){return!!(t.details&&(n.endCC>n.startCC||e&&e.cc<n.startCC))}function Mde(e,t,n=0){let r=e.fragments,i=t.fragments;if(!i.length||!r.length){q.log(`No fragments to align`);return}let a=eR(r,i[0].cc);if(!a||a&&!a.startPTS){q.log(`No frag in previous level to align on`);return}return a}function tR(e,t){if(e){let n=e.start+t;e.start=e.startPTS=n,e.endPTS=n+e.duration}}function nR(e,t){let n=t.fragments;for(let t=0,r=n.length;t<r;t++)tR(n[t],e);t.fragmentHint&&tR(t.fragmentHint,e),t.alignedSliding=!0}function Nde(e,t,n){t&&(Pde(e,n,t),!n.alignedSliding&&t.details&&Fde(n,t.details),!n.alignedSliding&&t.details&&!n.skippedSegments&&IL(t.details,n))}function Pde(e,t,n){if(jde(e,n,t)){let e=Mde(n.details,t);e&&XR(e.start)&&(q.log(`Adjusting PTS using last level due to CC increase within current level ${t.url}`),nR(e.start,t))}}function Fde(e,t){if(!t.fragments.length||!e.hasProgramDateTime||!t.hasProgramDateTime)return;let n=t.fragments[0].programDateTime,r=e.fragments[0].programDateTime,i=(r-n)/1e3+t.fragments[0].start;i&&XR(i)&&(q.log(`Adjusting PTS using programDateTime delta ${r-n}ms, sliding:${i.toFixed(3)} ${e.url} `),nR(i,e))}function rR(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;let n=e.fragments,r=t.fragments;if(!n.length||!r.length)return;let i=Math.round(r.length/2)-1,a=r[i],o=eR(n,a.cc)||n[Math.round(n.length/2)-1],s=a.programDateTime,c=o.programDateTime;if(s===null||c===null)return;let l=(c-s)/1e3-(o.start-a.start);nR(l,e)}function Ide(e){let t=e.byteLength,n=t&&new DataView(e.buffer).getUint8(t-1);return n?tL(e,0,t-n):e}function iR(){return self.SourceBuffer||self.WebKitSourceBuffer}function Lde(){let e=vL();if(!e)return!1;let t=iR(),n=e&&typeof e.isTypeSupported==`function`&&e.isTypeSupported(`video/mp4; codecs="avc1.42E01E,mp4a.40.2"`),r=!t||t.prototype&&typeof t.prototype.appendBuffer==`function`&&typeof t.prototype.remove==`function`;return!!n&&!!r}function Rde(){var e;let t=iR();return typeof(t==null||(e=t.prototype)==null?void 0:e.changeType)==`function`}function zde(){return typeof __HLS_WORKER_BUNDLE__==`function`}function Bde(){let e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:`text/javascript`}),t=self.URL.createObjectURL(e),n=new self.Worker(t);return{worker:n,objectURL:t}}function Vde(e){let t=new self.URL(e,self.location.href).href,n=new self.Worker(t);return{worker:n,scriptURL:t}}function aR(e=``,t=9e4){return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}function Hde(e,t,n,r){let i,a,o,s,c=navigator.userAgent.toLowerCase(),l=r,u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=((t[n+2]&192)>>>6)+1;let d=(t[n+2]&60)>>>2;if(d>u.length-1){e.trigger(G.ERROR,{type:ZR.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${d}`});return}return o=(t[n+2]&1)<<2,o|=(t[n+3]&192)>>>6,q.log(`manifest codec:${r}, ADTS type:${i}, samplingIndex:${d}`),/firefox/i.test(c)?d>=6?(i=5,s=[,,,,],a=d-3):(i=2,s=[,,],a=d):c.indexOf(`android`)===-1?(i=5,s=[,,,,],r&&(r.indexOf(`mp4a.40.29`)!==-1||r.indexOf(`mp4a.40.5`)!==-1)||!r&&d>=6?a=d-3:((r&&r.indexOf(`mp4a.40.2`)!==-1&&(d>=6&&o===1||/vivaldi/i.test(c))||!r&&o===1)&&(i=2,s=[,,]),a=d)):(i=2,s=[,,],a=d),s[0]=i<<3,s[0]|=(d&14)>>1,s[1]|=(d&1)<<7,s[1]|=o<<3,i===5&&(s[1]|=(a&14)>>1,s[2]=(a&1)<<7,s[2]|=8,s[3]=0),{config:s,samplerate:u[d],channelCount:o,codec:`mp4a.40.`+i,manifestCodec:l}}function oR(e,t){return e[t]===255&&(e[t+1]&246)==240}function sR(e,t){return e[t+1]&1?7:9}function cR(e,t){return(e[t+3]&3)<<11|e[t+4]<<3|(e[t+5]&224)>>>5}function Ude(e,t){return t+5<e.length}function lR(e,t){return t+1<e.length&&oR(e,t)}function Wde(e,t){return Ude(e,t)&&oR(e,t)&&cR(e,t)<=e.length-t}function Gde(e,t){if(lR(e,t)){let n=sR(e,t);if(t+n>=e.length)return!1;let r=cR(e,t);if(r<=n)return!1;let i=t+r;return i===e.length||lR(e,i)}return!1}function uR(e,t,n,r,i){if(!e.samplerate){let a=Hde(t,n,r,i);if(!a)return;e.config=a.config,e.samplerate=a.samplerate,e.channelCount=a.channelCount,e.codec=a.codec,e.manifestCodec=a.manifestCodec,q.log(`parsed codec:${e.codec}, rate:${a.samplerate}, channels:${a.channelCount}`)}}function dR(e){return 1024*9e4/e}function Kde(e,t){let n=sR(e,t);if(t+n<=e.length){let r=cR(e,t)-n;if(r>0)return{headerLength:n,frameLength:r}}}function fR(e,t,n,r,i){let a=dR(e.samplerate),o=r+i*a,s=Kde(t,n),c;if(s){let{frameLength:r,headerLength:i}=s,a=i+r,l=Math.max(0,n+a-t.length);l?(c=new Uint8Array(a-i),c.set(t.subarray(n+i,t.length),0)):c=t.subarray(n+i,n+a);let u={unit:c,pts:o};return l||e.samples.push(u),{sample:u,length:a,missing:l}}let l=t.length-n;c=new Uint8Array(l),c.set(t.subarray(n,t.length),0);let u={unit:c,pts:o};return{sample:u,length:l,missing:-1}}function pR(e,t,n,r,i){if(n+24>t.length)return;let a=mR(t,n);if(a&&n+a.frameLength<=t.length){let o=a.samplesPerFrame*9e4/a.sampleRate,s=r+i*o,c={unit:t.subarray(n,n+a.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(c),{sample:c,length:a.frameLength,missing:0}}}function mR(e,t){let n=e[t+1]>>3&3,r=e[t+1]>>1&3,i=e[t+2]>>4&15,a=e[t+2]>>2&3;if(n!==1&&i!==0&&i!==15&&a!==3){let o=e[t+2]>>1&1,s=e[t+3]>>6,c=n===3?3-r:r===3?3:4,l=IB[c*14+i-1]*1e3,u=n===3?0:n===2?1:2,d=LB[u*3+a],f=s===3?1:2,p=RB[n][r],m=zB[r],h=p*8*m,g=Math.floor(p*l/d+o)*m;if(FB===null){let e=navigator.userAgent||``,t=e.match(/Chrome\/(\d+)/i);FB=t?parseInt(t[1]):0}let _=!!FB&&FB<=87;return _&&r===2&&l>=224e3&&s===0&&(e[t+3]=e[t+3]|128),{sampleRate:d,channelCount:f,frameLength:g,samplesPerFrame:h}}}function hR(e,t){return e[t]===255&&(e[t+1]&224)==224&&(e[t+1]&6)!=0}function gR(e,t){return t+1<e.length&&hR(e,t)}function qde(e,t){return hR(e,t)&&4<=e.length-t}function Jde(e,t){if(t+1<e.length&&hR(e,t)){let n=mR(e,t),r=4;n!=null&&n.frameLength&&(r=n.frameLength);let i=t+r;return i===e.length||gR(e,i)}return!1}function _R(e,t,n,r){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:r,length:0}}function vR(e,t){return((e[t+1]&31)<<8)+e[t+2]}function Yde(e,t){return(e[t+10]&31)<<8|e[t+11]}function Xde(e,t,n,r){let i={audio:-1,avc:-1,id3:-1,segmentCodec:`aac`},a=(e[t+1]&15)<<8|e[t+2],o=t+3+a-4,s=(e[t+10]&15)<<8|e[t+11];for(t+=12+s;t<o;){let a=vR(e,t);switch(e[t]){case 207:if(!r){q.log(`ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream`);break}case 15:i.audio===-1&&(i.audio=a);break;case 21:i.id3===-1&&(i.id3=a);break;case 219:if(!r){q.log(`H.264 with AES-128-CBC slice encryption found in unencrypted stream`);break}case 27:i.avc===-1&&(i.avc=a);break;case 3:case 4:n.mpeg!==!0&&n.mp3!==!0?q.log(`MPEG audio found, not supported in this browser`):i.audio===-1&&(i.audio=a,i.segmentCodec=`mp3`);break;case 36:q.warn(`Unsupported HEVC stream type found`);break}t+=((e[t+3]&15)<<8|e[t+4])+5}return i}function yR(e){let t=0,n,r,i,a,o,s=e.data;if(!e||e.size===0)return null;for(;s[0].length<19&&s.length>1;){let e=new Uint8Array(s[0].length+s[1].length);e.set(s[0]),e.set(s[1],s[0].length),s[0]=e,s.splice(1,1)}n=s[0];let c=(n[0]<<16)+(n[1]<<8)+n[2];if(c===1){if(r=(n[4]<<8)+n[5],r&&r>e.size-6)return null;let c=n[7];c&192&&(a=(n[9]&14)*536870912+(n[10]&255)*4194304+(n[11]&254)*16384+(n[12]&255)*128+(n[13]&254)/2,c&64?(o=(n[14]&14)*536870912+(n[15]&255)*4194304+(n[16]&254)*16384+(n[17]&255)*128+(n[18]&254)/2,a-o>60*9e4&&(q.warn(`${Math.round((a-o)/9e4)}s delta between PTS and DTS, align them`),a=o)):o=a),i=n[8];let l=i+9;if(e.size<=l)return null;e.size-=l;let u=new Uint8Array(e.size);for(let e=0,r=s.length;e<r;e++){n=s[e];let r=n.byteLength;if(l)if(l>r){l-=r;continue}else n=n.subarray(l),r-=l,l=0;u.set(n,t),t+=r}return r&&(r-=i+3),{data:u,pts:a,dts:o,len:r}}return null}function bR(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){let n=t.samples,r=n.length;if(r){let t=n[r-1];e.pts=t.pts,e.dts=t.dts}else{t.dropped++;return}}t.samples.push(e)}e.debug.length&&q.log(e.pts+`/`+e.dts+`:`+e.debug)}function xR(e,t,n=1,r=!1){let i=e*t*n;return r?Math.round(i):i}function Zde(e,t,n=1,r=!1){return xR(e,t,1/n,r)}function SR(e,t=!1){return xR(e,1e3,1/JB,t)}function Qde(e,t=1){return xR(e,JB,1/t)}function CR(e,t){let n;if(t===null)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e}function $de(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}function wR(e,t,n,r){let i=e.samples.length;if(!i)return;let a=e.inputTimeScale;for(let o=0;o<i;o++){let i=e.samples[o];i.pts=CR(i.pts-n.baseTime*a/n.timescale,t*a)/a,i.dts=CR(i.dts-r.baseTime*a/r.timescale,t*a)/a}let o=e.samples;return e.samples=[],{samples:o}}function TR(e,t,n){let r=e.samples.length;if(!r)return;let i=e.inputTimeScale;for(let a=0;a<r;a++){let r=e.samples[a];r.pts=CR(r.pts-n.baseTime*i/n.timescale,t*i)/i}e.samples.sort((e,t)=>e.pts-t.pts);let a=e.samples;return e.samples=[],{samples:a}}function efe(e,t,n,r){if(e===null)return!0;let i=Math.max(r,1),a=t-e.baseTime/e.timescale;return Math.abs(a-n)>i}function ER(e,t){let n=e==null?void 0:e.codec;return n&&n.length>4?n:n===`hvc1`||n===`hev1`?`hvc1.1.6.L120.90`:n===`av01`?`av01.0.04M.08`:n===`avc1`||t===oz.VIDEO?`avc1.42e01e`:`mp4a.40.5`}function tfe(e,t){let n=null;return e.byteLength>0&&t!=null&&t.key!=null&&t.iv!==null&&t.method!=null&&(n=t),n}function DR(e){return`then`in e&&e.then instanceof Function}function nfe(e,t){let n=new Uint8Array(t),r=0;for(let t=0;t<e.length;t++){let i=e[t];n.set(i,r),r+=i.length}return n}function OR(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!rfe(e[n].attrs,t[n].attrs))return!1;return!0}function rfe(e,t){let n=e[`STABLE-RENDITION-ID`];return n?n===t[`STABLE-RENDITION-ID`]:![`LANGUAGE`,`NAME`,`CHARACTERISTICS`,`AUTOSELECT`,`DEFAULT`,`FORCED`].some(n=>e[n]!==t[n])}function kR(e){let t=[];for(let n=0;n<e.length;n++){let r=e[n];(r.kind===`subtitles`||r.kind===`captions`)&&r.label&&t.push(e[n])}return t}function AR(e,t,n){n.a=e,n.b=t}function jR(e,t,n){return n.a===e&&n.b===t}function MR(){return{a:null,b:null}}function NR(e){function t(e,t,n,r){return(e|0)*3600+(t|0)*60+(n|0)+parseFloat(r||0)}let n=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}function PR(e,t,n,r){let i=r?e.split(r):[e];for(let e in i){if(typeof i[e]!=`string`)continue;let r=i[e].split(n);if(r.length!==2)continue;let a=r[0],o=r[1];t(a,o)}}function ife(e,t,n){let r=e;function i(){let t=NR(e);if(t===null)throw Error(`Malformed timestamp: `+r);return e=e.replace(/^[^\sa-zA-Z-]+/,``),t}function a(e,t){let r=new rH;PR(e,function(e,t){let i;switch(e){case`region`:for(let i=n.length-1;i>=0;i--)if(n[i].id===t){r.set(e,n[i].region);break}break;case`vertical`:r.alt(e,t,[`rl`,`lr`]);break;case`line`:i=t.split(`,`),r.integer(e,i[0]),r.percent(e,i[0])&&r.set(`snapToLines`,!1),r.alt(e,i[0],[`auto`]),i.length===2&&r.alt(`lineAlign`,i[1],[`start`,aH,`end`]);break;case`position`:i=t.split(`,`),r.percent(e,i[0]),i.length===2&&r.alt(`positionAlign`,i[1],[`start`,aH,`end`,`line-left`,`line-right`,`auto`]);break;case`size`:r.percent(e,t);break;case`align`:r.alt(e,t,[`start`,aH,`end`,`left`,`right`]);break}},/:/,/\s/),t.region=r.get(`region`,null),t.vertical=r.get(`vertical`,``);let i=r.get(`line`,`auto`);i===`auto`&&iH.line===-1&&(i=-1),t.line=i,t.lineAlign=r.get(`lineAlign`,`start`),t.snapToLines=r.get(`snapToLines`,!0),t.size=r.get(`size`,100),t.align=r.get(`align`,aH);let a=r.get(`position`,`auto`);a===`auto`&&iH.position===50&&(a=t.align===`start`||t.align===`left`?0:t.align===`end`||t.align===`right`?100:50),t.position=a}function o(){e=e.replace(/^\s+/,``)}if(o(),t.startTime=i(),o(),e.slice(0,3)!==`-->`)throw Error(`Malformed time stamp (time stamps must be separated by '-->'): `+r);e=e.slice(3),o(),t.endTime=i(),o(),a(e,t)}function FR(e){return e.replace(/<br(?: \/)?>/gi,`
`)}function IR(e,t,n){return uH(e.toString())+uH(t.toString())+uH(n)}function afe(e,t,n,r,i,a,o){let s=new oH,c=Az(new Uint8Array(e)).trim().replace(sH,`
`).split(`
`),l=[],u=t?Qde(t.baseTime,t.timescale):0,d=`00:00.000`,f=0,p=0,m,h=!0;s.oncue=function(e){let a=n[r],o=n.ccOffset,s=(f-u)/9e4;if(a!=null&&a.new&&(p===void 0?dH(n,r,s):o=n.ccOffset=a.start),s){if(!t){m=Error(`Missing initPTS for VTT MPEGTS`);return}o=s-n.presentationOffset}let c=e.endTime-e.startTime,d=CR((e.startTime+o-p)*9e4,i*9e4)/9e4;e.startTime=Math.max(d,0),e.endTime=Math.max(d+c,0);let h=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(h)),e.id||(e.id=IR(e.startTime,e.endTime,h)),e.endTime>0&&l.push(e)},s.onparsingerror=function(e){m=e},s.onflush=function(){if(m){o(m);return}a(l)},c.forEach(e=>{if(h)if(cH(e,`X-TIMESTAMP-MAP=`)){h=!1,e.slice(16).split(`,`).forEach(e=>{cH(e,`LOCAL:`)?d=e.slice(6):cH(e,`MPEGTS:`)&&(f=parseInt(e.slice(7)))});try{p=lH(d)/1e3}catch(e){m=e}return}else e===``&&(h=!1);s.parse(e+`
`)}),s.flush()}function LR(e,t,n,r){let i=sL(new Uint8Array(e),[`mdat`]);if(i.length===0){r(Error(`Could not parse IMSC1 mdat`));return}let a=i.map(e=>Az(e)),o=Zde(t.baseTime,1,t.timescale);try{a.forEach(e=>n(ofe(e,o)))}catch(e){r(e)}}function ofe(e,t){let n=new DOMParser,r=n.parseFromString(e,`text/xml`),i=r.getElementsByTagName(`tt`)[0];if(!i)throw Error(`Invalid ttml`);let a={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(a).reduce((e,t)=>(e[t]=i.getAttribute(`ttp:${t}`)||a[t],e),{}),s=i.getAttribute(`xml:space`)!==`preserve`,c=zR(RR(i,`styling`,`style`)),l=zR(RR(i,`layout`,`region`)),u=RR(i,`body`,`[begin]`);return[].map.call(u,e=>{let n=BR(e,s);if(!n||!e.hasAttribute(`begin`))return null;let r=UR(e.getAttribute(`begin`),o),i=UR(e.getAttribute(`dur`),o),a=UR(e.getAttribute(`end`),o);if(r===null)throw HR(e);if(a===null){if(i===null)throw HR(e);a=r+i}let u=new tH(r-t,a-t,n);u.id=IR(u.startTime,u.endTime,u.text);let d=l[e.getAttribute(`region`)],f=c[e.getAttribute(`style`)],p=sfe(d,f,c),{textAlign:m}=p;if(m){let e=hH[m];e&&(u.lineAlign=e),u.align=m}return YI(u,p),u}).filter(e=>e!==null)}function RR(e,t,n){let r=e.getElementsByTagName(t)[0];return r?[].slice.call(r.querySelectorAll(n)):[]}function zR(e){return e.reduce((e,t)=>{let n=t.getAttribute(`xml:id`);return n&&(e[n]=t),e},{})}function BR(e,t){return[].slice.call(e.childNodes).reduce((e,n,r)=>{var i;return n.nodeName===`br`&&r?e+`
`:(i=n.childNodes)!=null&&i.length?BR(n,t):t?e+n.textContent.trim().replace(/\s+/g,` `):e+n.textContent},``)}function sfe(e,t,n){let r=`http://www.w3.org/ns/ttml#styling`,i=null,a=[`displayAlign`,`textAlign`,`color`,`backgroundColor`,`fontSize`,`fontFamily`],o=e!=null&&e.hasAttribute(`style`)?e.getAttribute(`style`):null;return o&&n.hasOwnProperty(o)&&(i=n[o]),a.reduce((n,a)=>{let o=VR(t,r,a)||VR(e,r,a)||VR(i,r,a);return o&&(n[a]=o),n},{})}function VR(e,t,n){return e&&e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function HR(e){return Error(`Could not parse ttml timestamp ${e}`)}function UR(e,t){if(!e)return null;let n=NR(e);return n===null&&(pH.test(e)?n=cfe(e,t):mH.test(e)&&(n=lfe(e,t))),n}function cfe(e,t){let n=pH.exec(e),r=(n[4]|0)+(n[5]|0)/t.subFrameRate;return(n[1]|0)*3600+(n[2]|0)*60+(n[3]|0)+r/t.frameRate}function lfe(e,t){let n=mH.exec(e),r=Number(n[1]),i=n[2];switch(i){case`h`:return r*3600;case`m`:return r*60;case`ms`:return r*1e3;case`f`:return r/t.frameRate;case`t`:return r/t.tickRate}return r}function ufe(e,t){return!!e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}function dfe(e,t,n,r){return Math.min(t,r)-Math.max(e,n)}function WR(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}function GR(e,t,n,r){e&&Object.keys(t).forEach(i=>{let a=e.filter(e=>e.groupId===i).map(e=>{let a=YI({},e);return a.details=void 0,a.attrs=new rz(a.attrs),a.url=a.attrs.URI=KR(e.url,e.attrs[`STABLE-RENDITION-ID`],`PER-RENDITION-URIS`,n),a.groupId=a.attrs[`GROUP-ID`]=t[i],a.attrs[`PATHWAY-ID`]=r,a});e.push(...a)})}function KR(e,t,n,r){let{HOST:i,PARAMS:a,[n]:o}=r,s;t&&(s=o==null?void 0:o[t],s&&(e=s));let c=new self.URL(e);return i&&!s&&(c.host=i),a&&Object.keys(a).sort().forEach(e=>{e&&c.searchParams.set(e,a[e])}),c.href}function ffe(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}function pfe(e,t){let n={method:`GET`,mode:`cors`,credentials:`same-origin`,signal:t,headers:new self.Headers(YI({},e.headers))};return e.rangeEnd&&n.headers.set(`Range`,`bytes=`+e.rangeStart+`-`+String(e.rangeEnd-1)),n}function mfe(e){let t=AH.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}function hfe(e){let t=e.get(`Content-Range`);if(t){let e=mfe(t);if(XR(e))return e}let n=e.get(`Content-Length`);if(n)return parseInt(n)}function gfe(e,t){return new self.Request(e.url,t)}function _fe(){return{cueHandler:PH,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:`English`,captionsTextTrack1LanguageCode:`en`,captionsTextTrack2Label:`Spanish`,captionsTextTrack2LanguageCode:`es`,captionsTextTrack3Label:`Unknown CC`,captionsTextTrack3LanguageCode:``,captionsTextTrack4Label:`Unknown CC`,captionsTextTrack4LanguageCode:``,renderTextTracksNatively:!0}}function vfe(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw Error(`Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration`);if(t.liveMaxLatencyDurationCount!==void 0&&(t.liveSyncDurationCount===void 0||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw Error(`Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"`);if(t.liveMaxLatencyDuration!==void 0&&(t.liveSyncDuration===void 0||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw Error(`Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"`);let n=qR(e),r=[`manifest`,`level`,`frag`],i=[`TimeOut`,`MaxRetry`,`RetryDelay`,`MaxRetryTimeout`];return r.forEach(e=>{let r=`${e===`level`?`playlist`:e}LoadPolicy`,a=t[r]===void 0,o=[];i.forEach(i=>{let s=`${e}Loading${i}`,c=t[s];if(c!==void 0&&a){o.push(s);let e=n[r].default;switch(t[r]={default:e},i){case`TimeOut`:e.maxLoadTimeMs=c,e.maxTimeToFirstByteMs=c;break;case`MaxRetry`:e.errorRetry.maxNumRetry=c,e.timeoutRetry.maxNumRetry=c;break;case`RetryDelay`:e.errorRetry.retryDelayMs=c,e.timeoutRetry.retryDelayMs=c;break;case`MaxRetryTimeout`:e.errorRetry.maxRetryDelayMs=c,e.timeoutRetry.maxRetryDelayMs=c;break}}}),o.length&&q.warn(`hls.js config: "${o.join(`", "`)}" setting(s) are deprecated, use "${r}": ${JSON.stringify(t[r])}`)}),JI(JI({},n),t)}function qR(e){return e&&typeof e==`object`?Array.isArray(e)?e.map(qR):Object.keys(e).reduce((t,n)=>(t[n]=qR(e[n]),t),{}):e}function yfe(e){let t=e.loader;if(t!==jH&&t!==kH)q.log(`[config]: Custom loader detected, cannot enable progressive streaming`),e.progressive=!1;else{let t=ffe();t&&(e.loader=jH,e.progressive=!0,e.enableSoftwareAES=!0,q.log(`[config]: Progressive streaming enabled, using FetchLoader`))}}var JR,YR,XR,G,ZR,K,QR,$R,ez,q,tz,nz,rz,iz,az,oz,sz,cz,lz,uz,dz,fz,pz,mz,hz,gz,_z,vz,yz,bz,xz,Sz,Cz,wz,Tz,Ez,Dz,Oz,kz,Az,jz,Mz,Nz,Pz,Fz,Iz,Lz,Rz,zz,Bz,Vz,Hz,Uz,Wz,Gz,Kz,qz,Jz,Yz,Xz,Zz,Qz,$z,eB,tB,nB,rB,iB,aB,oB,sB,cB,lB,uB,dB,fB,pB,mB,hB,gB,_B,vB,yB,bB,xB,SB,CB,wB,TB,EB,DB,OB,J,kB,AB,jB,MB,NB,PB,FB,IB,LB,RB,zB,BB,VB,HB,UB,WB,GB,KB,qB,JB,YB,XB,ZB,QB,$B,eV,tV,nV,rV,iV,aV,oV,sV,cV,lV,uV,dV,fV,pV,mV,hV,gV,_V,vV,yV,bV,xV,SV,CV,wV,TV,EV,DV,OV,kV,AV,jV,MV,NV,PV,FV,IV,LV,RV,zV,BV,VV,HV,UV,WV,GV,KV,qV,JV,YV,XV,ZV,QV,$V,eH,tH,nH,rH,iH,aH,oH,sH,cH,lH,uH,dH,fH,pH,mH,hH,gH,_H,vH,yH,bH,xH,SH,CH,wH,TH,EH,DH,OH,kH,AH,jH,MH,NH,PH,FH,IH,LH,bfe=o((()=>{JR={exports:{}},(function(e,t){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),t=t.trim(),!t){if(!n.alwaysNormalize)return e;var i=o.parseURL(e);if(!i)throw Error(`Error trying to parse base URL.`);return i.path=o.normalizePath(i.path),o.buildURLFromParts(i)}var a=o.parseURL(t);if(!a)throw Error(`Error trying to parse relative URL.`);if(a.scheme)return n.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw Error(`Error trying to parse base URL.`);if(!s.netLoc&&s.path&&s.path[0]!==`/`){var c=r.exec(s.path);s.netLoc=c[1],s.path=c[2]}s.netLoc&&!s.path&&(s.path=`/`);var l={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(l.netLoc=s.netLoc,a.path[0]!==`/`))if(!a.path)l.path=s.path,a.params||(l.params=s.params,a.query||(l.query=s.query));else{var u=s.path,d=u.substring(0,u.lastIndexOf(`/`)+1)+a.path;l.path=o.normalizePath(d)}return l.path===null&&(l.path=n.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(l)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||``,netLoc:t[2]||``,path:t[3]||``,params:t[4]||``,query:t[5]||``,fragment:t[6]||``}:null},normalizePath:function(e){for(e=e.split(``).reverse().join(``).replace(i,``);e.length!==(e=e.replace(a,``)).length;);return e.split(``).reverse().join(``)},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=o})()})(JR),YR=JR.exports,XR=Number.isFinite||function(e){return typeof e==`number`&&isFinite(e)},G=function(e){return e.MEDIA_ATTACHING=`hlsMediaAttaching`,e.MEDIA_ATTACHED=`hlsMediaAttached`,e.MEDIA_DETACHING=`hlsMediaDetaching`,e.MEDIA_DETACHED=`hlsMediaDetached`,e.BUFFER_RESET=`hlsBufferReset`,e.BUFFER_CODECS=`hlsBufferCodecs`,e.BUFFER_CREATED=`hlsBufferCreated`,e.BUFFER_APPENDING=`hlsBufferAppending`,e.BUFFER_APPENDED=`hlsBufferAppended`,e.BUFFER_EOS=`hlsBufferEos`,e.BUFFER_FLUSHING=`hlsBufferFlushing`,e.BUFFER_FLUSHED=`hlsBufferFlushed`,e.MANIFEST_LOADING=`hlsManifestLoading`,e.MANIFEST_LOADED=`hlsManifestLoaded`,e.MANIFEST_PARSED=`hlsManifestParsed`,e.LEVEL_SWITCHING=`hlsLevelSwitching`,e.LEVEL_SWITCHED=`hlsLevelSwitched`,e.LEVEL_LOADING=`hlsLevelLoading`,e.LEVEL_LOADED=`hlsLevelLoaded`,e.LEVEL_UPDATED=`hlsLevelUpdated`,e.LEVEL_PTS_UPDATED=`hlsLevelPtsUpdated`,e.LEVELS_UPDATED=`hlsLevelsUpdated`,e.AUDIO_TRACKS_UPDATED=`hlsAudioTracksUpdated`,e.AUDIO_TRACK_SWITCHING=`hlsAudioTrackSwitching`,e.AUDIO_TRACK_SWITCHED=`hlsAudioTrackSwitched`,e.AUDIO_TRACK_LOADING=`hlsAudioTrackLoading`,e.AUDIO_TRACK_LOADED=`hlsAudioTrackLoaded`,e.SUBTITLE_TRACKS_UPDATED=`hlsSubtitleTracksUpdated`,e.SUBTITLE_TRACKS_CLEARED=`hlsSubtitleTracksCleared`,e.SUBTITLE_TRACK_SWITCH=`hlsSubtitleTrackSwitch`,e.SUBTITLE_TRACK_LOADING=`hlsSubtitleTrackLoading`,e.SUBTITLE_TRACK_LOADED=`hlsSubtitleTrackLoaded`,e.SUBTITLE_FRAG_PROCESSED=`hlsSubtitleFragProcessed`,e.CUES_PARSED=`hlsCuesParsed`,e.NON_NATIVE_TEXT_TRACKS_FOUND=`hlsNonNativeTextTracksFound`,e.INIT_PTS_FOUND=`hlsInitPtsFound`,e.FRAG_LOADING=`hlsFragLoading`,e.FRAG_LOAD_EMERGENCY_ABORTED=`hlsFragLoadEmergencyAborted`,e.FRAG_LOADED=`hlsFragLoaded`,e.FRAG_DECRYPTED=`hlsFragDecrypted`,e.FRAG_PARSING_INIT_SEGMENT=`hlsFragParsingInitSegment`,e.FRAG_PARSING_USERDATA=`hlsFragParsingUserdata`,e.FRAG_PARSING_METADATA=`hlsFragParsingMetadata`,e.FRAG_PARSED=`hlsFragParsed`,e.FRAG_BUFFERED=`hlsFragBuffered`,e.FRAG_CHANGED=`hlsFragChanged`,e.FPS_DROP=`hlsFpsDrop`,e.FPS_DROP_LEVEL_CAPPING=`hlsFpsDropLevelCapping`,e.ERROR=`hlsError`,e.DESTROYING=`hlsDestroying`,e.KEY_LOADING=`hlsKeyLoading`,e.KEY_LOADED=`hlsKeyLoaded`,e.LIVE_BACK_BUFFER_REACHED=`hlsLiveBackBufferReached`,e.BACK_BUFFER_REACHED=`hlsBackBufferReached`,e}({}),ZR=function(e){return e.NETWORK_ERROR=`networkError`,e.MEDIA_ERROR=`mediaError`,e.KEY_SYSTEM_ERROR=`keySystemError`,e.MUX_ERROR=`muxError`,e.OTHER_ERROR=`otherError`,e}({}),K=function(e){return e.KEY_SYSTEM_NO_KEYS=`keySystemNoKeys`,e.KEY_SYSTEM_NO_ACCESS=`keySystemNoAccess`,e.KEY_SYSTEM_NO_SESSION=`keySystemNoSession`,e.KEY_SYSTEM_NO_CONFIGURED_LICENSE=`keySystemNoConfiguredLicense`,e.KEY_SYSTEM_LICENSE_REQUEST_FAILED=`keySystemLicenseRequestFailed`,e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED=`keySystemServerCertificateRequestFailed`,e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED=`keySystemServerCertificateUpdateFailed`,e.KEY_SYSTEM_SESSION_UPDATE_FAILED=`keySystemSessionUpdateFailed`,e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED=`keySystemStatusOutputRestricted`,e.KEY_SYSTEM_STATUS_INTERNAL_ERROR=`keySystemStatusInternalError`,e.MANIFEST_LOAD_ERROR=`manifestLoadError`,e.MANIFEST_LOAD_TIMEOUT=`manifestLoadTimeOut`,e.MANIFEST_PARSING_ERROR=`manifestParsingError`,e.MANIFEST_INCOMPATIBLE_CODECS_ERROR=`manifestIncompatibleCodecsError`,e.LEVEL_EMPTY_ERROR=`levelEmptyError`,e.LEVEL_LOAD_ERROR=`levelLoadError`,e.LEVEL_LOAD_TIMEOUT=`levelLoadTimeOut`,e.LEVEL_PARSING_ERROR=`levelParsingError`,e.LEVEL_SWITCH_ERROR=`levelSwitchError`,e.AUDIO_TRACK_LOAD_ERROR=`audioTrackLoadError`,e.AUDIO_TRACK_LOAD_TIMEOUT=`audioTrackLoadTimeOut`,e.SUBTITLE_LOAD_ERROR=`subtitleTrackLoadError`,e.SUBTITLE_TRACK_LOAD_TIMEOUT=`subtitleTrackLoadTimeOut`,e.FRAG_LOAD_ERROR=`fragLoadError`,e.FRAG_LOAD_TIMEOUT=`fragLoadTimeOut`,e.FRAG_DECRYPT_ERROR=`fragDecryptError`,e.FRAG_PARSING_ERROR=`fragParsingError`,e.FRAG_GAP=`fragGap`,e.REMUX_ALLOC_ERROR=`remuxAllocError`,e.KEY_LOAD_ERROR=`keyLoadError`,e.KEY_LOAD_TIMEOUT=`keyLoadTimeOut`,e.BUFFER_ADD_CODEC_ERROR=`bufferAddCodecError`,e.BUFFER_INCOMPATIBLE_CODECS_ERROR=`bufferIncompatibleCodecsError`,e.BUFFER_APPEND_ERROR=`bufferAppendError`,e.BUFFER_APPENDING_ERROR=`bufferAppendingError`,e.BUFFER_STALLED_ERROR=`bufferStalledError`,e.BUFFER_FULL_ERROR=`bufferFullError`,e.BUFFER_SEEK_OVER_HOLE=`bufferSeekOverHole`,e.BUFFER_NUDGE_ON_STALL=`bufferNudgeOnStall`,e.INTERNAL_EXCEPTION=`internalException`,e.INTERNAL_ABORTED=`aborted`,e.UNKNOWN=`unknown`,e}({}),QR=function(){},$R={trace:QR,debug:QR,log:QR,warn:QR,info:QR,error:QR},ez=$R,q=ez,tz=/^(\d+)x(\d+)$/,nz=/(.+?)=(".*?"|.*?)(?:,|$)/g,rz=class e{constructor(t){for(let n in typeof t==`string`&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(n)&&(n.substring(0,2)===`X-`&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(n)),this[n]=t[n])}decimalInteger(e){let t=parseInt(this[e],10);return t>2**53-1?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||`0x`).slice(2);t=(t.length&1?`0`:``)+t;let n=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)n[e]=parseInt(t.slice(e*2,e*2+2),16);return n}else return null}hexadecimalIntegerAsNumber(e){let t=parseInt(this[e],16);return t>2**53-1?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){let n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return this[e]===`YES`}decimalResolution(e){let t=tz.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t,n={};for(nz.lastIndex=0;(t=nz.exec(e))!==null;){let e=t[2];e.indexOf(`"`)===0&&e.lastIndexOf(`"`)===e.length-1&&(e=e.slice(1,-1));let r=t[1].trim();n[r]=e}return n}},iz=class{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){let n=t.attr;for(let t in n)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==n[t]){q.warn(`DATERANGE tag attribute: "${t}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=t;break}e=YI(new rz({}),n,e)}if(this.attr=e,this._startDate=new Date(e[`START-DATE`]),`END-DATE`in this.attr){let e=new Date(this.attr[`END-DATE`]);XR(e.getTime())&&(this._endDate=e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;let e=this.duration;return e===null?null:new Date(this._startDate.getTime()+e*1e3)}get duration(){if(`DURATION`in this.attr){let e=this.attr.decimalFloatingPoint(`DURATION`);if(XR(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return`PLANNED-DURATION`in this.attr?this.attr.decimalFloatingPoint(`PLANNED-DURATION`):null}get endOnNext(){return this.attr.bool(`END-ON-NEXT`)}get isValid(){return!!this.id&&!this._badValueForSameId&&XR(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}},az=class{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},oz={AUDIO:`audio`,VIDEO:`video`,AUDIOVIDEO:`audiovideo`},sz=class{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[oz.AUDIO]:null,[oz.VIDEO]:null,[oz.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){let n=e.split(`@`,2),r=[];n.length===1?r[0]=t?t.byteRangeEndOffset:0:r[0]=parseInt(n[1]),r[1]=parseInt(n[0])+r[0],this._byteRange=r}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=YR.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||``}set url(e){this._url=e}},cz=class extends sz{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new az,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=e}get decryptdata(){let{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){let e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{let e=Object.keys(this.levelkeys);if(e.length===1)return this._decryptdata=this.levelkeys[e[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!XR(this.programDateTime))return null;let e=XR(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){let e=Object.keys(this.levelkeys),t=e.length;if(t>1||t===1&&this.levelkeys[e[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){let t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,r,i,a=!1){let{elementaryStreams:o}=this,s=o[e];if(!s){o[e]={startPTS:t,endPTS:n,startDTS:r,endDTS:i,partial:a};return}s.startPTS=Math.min(s.startPTS,t),s.endPTS=Math.max(s.endPTS,n),s.startDTS=Math.min(s.startDTS,r),s.endDTS=Math.max(s.endDTS,i)}clearElementaryStreamInfo(){let{elementaryStreams:e}=this;e[oz.AUDIO]=null,e[oz.VIDEO]=null,e[oz.AUDIOVIDEO]=null}},lz=class extends sz{constructor(e,t,n,r,i){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new az,this.duration=e.decimalFloatingPoint(`DURATION`),this.gap=e.bool(`GAP`),this.independent=e.bool(`INDEPENDENT`),this.relurl=e.enumeratedString(`URI`),this.fragment=t,this.index=r;let a=e.enumeratedString(`BYTERANGE`);a&&this.setByteRange(a,i),i&&(this.fragOffset=i.fragOffset+i.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){let{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}},uz=10,dz=class{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8=``,this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}let t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?XR(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||uz}get drift(){let e=this.driftEndTime-this.driftStartTime;if(e>0){let t=this.driftEnd-this.driftStart;return t*1e3/e}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}},fz={CLEARKEY:`org.w3.clearkey`,FAIRPLAY:`com.apple.fps`,PLAYREADY:`com.microsoft.playready`,WIDEVINE:`com.widevine.alpha`},pz={CLEARKEY:`org.w3.clearkey`,FAIRPLAY:`com.apple.streamingkeydelivery`,PLAYREADY:`com.microsoft.playready`,WIDEVINE:`urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed`},mz={WIDEVINE:`edef8ba979d64acea3c827dcd51d21ed`},hz=function(){return typeof self<`u`&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}(),gz=(e,t)=>t+10<=e.length&&e[t]===73&&e[t+1]===68&&e[t+2]===51&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,_z=(e,t)=>t+10<=e.length&&e[t]===51&&e[t+1]===68&&e[t+2]===73&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,vz=(e,t)=>{let n=t,r=0;for(;gz(e,t);){r+=10;let n=yz(e,t+6);r+=n,_z(e,t+10)&&(r+=10),t+=r}if(r>0)return e.subarray(n,n+r)},yz=(e,t)=>{let n=0;return n=(e[t]&127)<<21,n|=(e[t+1]&127)<<14,n|=(e[t+2]&127)<<7,n|=e[t+3]&127,n},bz=(e,t)=>gz(e,t)&&yz(e,t+6)+10<=e.length-t,xz=e=>{let t=wz(e);for(let e=0;e<t.length;e++){let n=t[e];if(Sz(n))return kz(n)}},Sz=e=>e&&e.key===`PRIV`&&e.info===`com.apple.streaming.transportStreamTimestamp`,Cz=e=>{let t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=yz(e,4);return{type:t,size:n,data:e.subarray(10,10+n)}},wz=e=>{let t=0,n=[];for(;gz(e,t);){let r=yz(e,t+6);t+=10;let i=t+r;for(;t+8<i;){let r=Cz(e.subarray(t)),i=Tz(r);i&&n.push(i),t+=r.size+10}_z(e,t)&&(t+=10)}return n},Tz=e=>e.type===`PRIV`?Ez(e):e.type[0]===`W`?Oz(e):Dz(e),Ez=e=>{if(e.size<2)return;let t=Az(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}},Dz=e=>{if(e.size<2)return;if(e.type===`TXXX`){let t=1,n=Az(e.data.subarray(t),!0);t+=n.length+1;let r=Az(e.data.subarray(t));return{key:e.type,info:n,data:r}}let t=Az(e.data.subarray(1));return{key:e.type,data:t}},Oz=e=>{if(e.type===`WXXX`){if(e.size<2)return;let t=1,n=Az(e.data.subarray(t),!0);t+=n.length+1;let r=Az(e.data.subarray(t));return{key:e.type,info:n,data:r}}let t=Az(e.data);return{key:e.type,data:t}},kz=e=>{if(e.data.byteLength===8){let t=new Uint8Array(e.data),n=t[3]&1,r=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return r/=45,n&&(r+=47721858.84),Math.round(r)}},Az=(e,t=!1)=>{let n=Zue();if(n){let r=n.decode(e);if(t){let e=r.indexOf(`\0`);return e===-1?r:r.substring(0,e)}return r.replace(/\0/g,``)}let r=e.length,i,a,o,s=``,c=0;for(;c<r;){if(i=e[c++],i===0&&t)return s;if(!(i===0||i===3))switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:s+=String.fromCharCode(i);break;case 12:case 13:a=e[c++],s+=String.fromCharCode((i&31)<<6|a&63);break;case 14:a=e[c++],o=e[c++],s+=String.fromCharCode((i&15)<<12|(a&63)<<6|(o&63)<<0);break}}return s},Mz={hexDump:function(e){let t=``;for(let n=0;n<e.length;n++){let r=e[n].toString(16);r.length<2&&(r=`0`+r),t+=r}return t}},Nz=2**32-1,Pz=[].push,Fz={video:1,audio:2,id3:3,text:4},Iz={},Lz=class e{static clearKeyUriToKeyIdMap(){Iz={}}constructor(e,t,n,r=[1],i=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=r,this.iv=i,this.encrypted=e?e!==`NONE`:!1,this.isCommonEncryption=this.encrypted&&e!==`AES-128`}isSupported(){if(this.method){if(this.method===`AES-128`||this.method===`NONE`)return!0;if(this.keyFormat===`identity`)return this.method===`SAMPLE-AES`;switch(this.keyFormat){case pz.FAIRPLAY:case pz.WIDEVINE:case pz.PLAYREADY:case pz.CLEARKEY:return[`ISO-23001-7`,`SAMPLE-AES`,`SAMPLE-AES-CENC`,`SAMPLE-AES-CTR`].indexOf(this.method)!==-1}}return!1}getDecryptData(t){if(!this.encrypted||!this.uri)return null;if(this.method===`AES-128`&&this.uri&&!this.iv){typeof t!=`number`&&(this.method===`AES-128`&&!this.iv&&q.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),t=0);let n=dde(t),r=new e(this.method,this.uri,`identity`,this.keyFormatVersions,n);return r}let n=que(this.uri);if(n)switch(this.keyFormat){case pz.WIDEVINE:this.pssh=n,n.length>=22&&(this.keyId=n.subarray(n.length-22,n.length-6));break;case pz.PLAYREADY:{let e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=lde(e,null,n);let t=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),r=String.fromCharCode.apply(null,Array.from(t)),i=r.substring(r.indexOf(`<`),r.length),a=new DOMParser,o=a.parseFromString(i,`text/xml`),s=o.getElementsByTagName(`KID`)[0];if(s){let e=s.childNodes[0]?s.childNodes[0].nodeValue:s.getAttribute(`VALUE`);if(e){let t=XI(e).subarray(0,16);Kue(t),this.keyId=t}}break}default:{let e=n.subarray(0,16);if(e.length!==16){let t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e;break}}if(!this.keyId||this.keyId.byteLength!==16){let e=Iz[this.uri];if(!e){let t=Object.keys(Iz).length%(2**53-1);e=new Uint8Array(16);let n=new DataView(e.buffer,12,4);n.setUint32(0,t),Iz[this.uri]=e}this.keyId=e}return this}},Rz=/\{\$([a-zA-Z0-9-_]+)\}/g,zz={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},Bz=vL(),Vz=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Hz=/#EXT-X-MEDIA:(.*)/g,Uz=/^#EXT(?:INF|-X-TARGETDURATION):/m,Wz=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join(`|`),`g`),Gz=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join(`|`)),Kz=class e{static findGroup(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(r.id===t)return r}}static convertAVC1ToAVCOTI(e){let t=e.split(`.`);if(t.length>2){let e=t.shift()+`.`;return e+=parseInt(t.shift()).toString(16),e+=(`000`+parseInt(t.shift()).toString(16)).slice(-4),e}return e}static resolve(e,t){return YR.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return Uz.test(e)}static parseMasterPlaylist(t,n){let r=mL(t),i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:r},a=[];Vz.lastIndex=0;let o;for(;(o=Vz.exec(t))!=null;)if(o[1]){var s;let t=new rz(o[1]);hL(i,t,[`CODECS`,`SUPPLEMENTAL-CODECS`,`ALLOWED-CPC`,`PATHWAY-ID`,`STABLE-VARIANT-ID`,`AUDIO`,`VIDEO`,`SUBTITLES`,`CLOSED-CAPTIONS`,`NAME`]);let r=gL(i,o[2]),c={attrs:t,bitrate:t.decimalInteger(`AVERAGE-BANDWIDTH`)||t.decimalInteger(`BANDWIDTH`),name:t.NAME,url:e.resolve(r,n)},l=t.decimalResolution(`RESOLUTION`);l&&(c.width=l.width,c.height=l.height),mde((t.CODECS||``).split(/[ ,]+/).filter(e=>e),c),c.videoCodec&&c.videoCodec.indexOf(`avc1`)!==-1&&(c.videoCodec=e.convertAVC1ToAVCOTI(c.videoCodec)),(s=c.unknownCodecs)!=null&&s.length||a.push(c),i.levels.push(c)}else if(o[3]){let t=o[3],r=o[4];switch(t){case`SESSION-DATA`:{let e=new rz(r);hL(i,e,[`DATA-ID`,`LANGUAGE`,`VALUE`,`URI`]);let t=e[`DATA-ID`];t&&(i.sessionData===null&&(i.sessionData={}),i.sessionData[t]=e);break}case`SESSION-KEY`:{let e=bL(r,n,i);e.encrypted&&e.isSupported()?(i.sessionKeys===null&&(i.sessionKeys=[]),i.sessionKeys.push(e)):q.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${r}"`);break}case`DEFINE`:{let e=new rz(r);hL(i,e,[`NAME`,`VALUE`,`QUERYPARAM`]),_L(i,e,n)}break;case`CONTENT-STEERING`:{let t=new rz(r);hL(i,t,[`SERVER-URI`,`PATHWAY-ID`]),i.contentSteering={uri:e.resolve(t[`SERVER-URI`],n),pathwayId:t[`PATHWAY-ID`]||`.`};break}case`START`:i.startTimeOffset=xL(r);break}}let c=a.length>0&&a.length<i.levels.length;return i.levels=c?a:i.levels,i.levels.length===0&&(i.playlistParsingError=Error(`no levels found in manifest`)),i}static parseMasterPlaylistMedia(t,n,r){let i,a={},o=r.levels,s={AUDIO:o.map(e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec})),SUBTITLES:o.map(e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec})),"CLOSED-CAPTIONS":[]},c=0;for(Hz.lastIndex=0;(i=Hz.exec(t))!==null;){let t=new rz(i[1]),o=t.TYPE;if(o){let i=s[o],l=a[o]||[];a[o]=l,hL(r,t,[`URI`,`GROUP-ID`,`LANGUAGE`,`ASSOC-LANGUAGE`,`STABLE-RENDITION-ID`,`NAME`,`INSTREAM-ID`,`CHARACTERISTICS`,`CHANNELS`]);let u={attrs:t,bitrate:0,id:c++,groupId:t[`GROUP-ID`]||``,instreamId:t[`INSTREAM-ID`],name:t.NAME||t.LANGUAGE||``,type:o,default:t.bool(`DEFAULT`),autoselect:t.bool(`AUTOSELECT`),forced:t.bool(`FORCED`),lang:t.LANGUAGE,url:t.URI?e.resolve(t.URI,n):``};if(i!=null&&i.length){let t=e.findGroup(i,u.groupId)||i[0];SL(u,t,`audioCodec`),SL(u,t,`textCodec`)}l.push(u)}}return a}static parseLevelPlaylist(e,t,n,r,i,a){let o=new dz(t),s=o.fragments,c=null,l=0,u=0,d=0,f=0,p=null,m=new cz(r,t),h,g,_,v=-1,y=!1;for(Wz.lastIndex=0,o.m3u8=e,o.hasVariableRefs=mL(e);(h=Wz.exec(e))!==null;){y&&(y=!1,m=new cz(r,t),m.start=d,m.sn=l,m.cc=f,m.level=n,c&&(m.initSegment=c,m.rawProgramDateTime=c.rawProgramDateTime,c.rawProgramDateTime=null));let e=h[1];if(e){m.duration=parseFloat(e);let t=(` `+h[2]).slice(1);m.title=t||null,m.tagList.push(t?[`INF`,e,t]:[`INF`,e])}else if(h[3]){if(XR(m.duration)){m.start=d,_&&TL(m,_,o),m.sn=l,m.level=n,m.cc=f,m.urlId=i,s.push(m);let e=(` `+h[3]).slice(1);m.relurl=gL(o,e),CL(m,p),p=m,d+=m.duration,l++,u=0,y=!0}}else if(h[4]){let e=(` `+h[4]).slice(1);p?m.setByteRange(e,p):m.setByteRange(e)}else if(h[5])m.rawProgramDateTime=(` `+h[5]).slice(1),m.tagList.push([`PROGRAM-DATE-TIME`,m.rawProgramDateTime]),v===-1&&(v=s.length);else{if(h=h[0].match(Gz),!h){q.warn(`No matches on slow regex match for level playlist!`);continue}for(g=1;g<h.length&&h[g]===void 0;g++);let e=(` `+h[g]).slice(1),i=(` `+h[g+1]).slice(1),d=h[g+2]?(` `+h[g+2]).slice(1):``;switch(e){case`PLAYLIST-TYPE`:o.type=i.toUpperCase();break;case`MEDIA-SEQUENCE`:l=o.startSN=parseInt(i);break;case`SKIP`:{let e=new rz(i);hL(o,e,[`RECENTLY-REMOVED-DATERANGES`]);let t=e.decimalInteger(`SKIPPED-SEGMENTS`);if(XR(t)){o.skippedSegments=t;for(let e=t;e--;)s.unshift(null);l+=t}let n=e.enumeratedString(`RECENTLY-REMOVED-DATERANGES`);n&&(o.recentlyRemovedDateranges=n.split(`	`));break}case`TARGETDURATION`:o.targetduration=Math.max(parseInt(i),1);break;case`VERSION`:o.version=parseInt(i);break;case`EXTM3U`:break;case`ENDLIST`:o.live=!1;break;case`#`:(i||d)&&m.tagList.push(d?[i,d]:[i]);break;case`DISCONTINUITY`:f++,m.tagList.push([`DIS`]);break;case`GAP`:m.gap=!0,m.tagList.push([e]);break;case`BITRATE`:m.tagList.push([e,i]);break;case`DATERANGE`:{let e=new rz(i);hL(o,e,[`ID`,`CLASS`,`START-DATE`,`END-DATE`,`SCTE35-CMD`,`SCTE35-OUT`,`SCTE35-IN`]),hL(o,e,e.clientAttrs);let t=new iz(e,o.dateRanges[e.ID]);t.isValid||o.skippedSegments?o.dateRanges[t.id]=t:q.warn(`Ignoring invalid DATERANGE tag: "${i}"`),m.tagList.push([`EXT-X-DATERANGE`,i]);break}case`DEFINE`:{let e=new rz(i);hL(o,e,[`NAME`,`VALUE`,`IMPORT`,`QUERYPARAM`]),`IMPORT`in e?fde(o,e,a):_L(o,e,t)}break;case`DISCONTINUITY-SEQUENCE`:f=parseInt(i);break;case`KEY`:{let e=bL(i,t,o);if(e.isSupported()){if(e.method===`NONE`){_=void 0;break}_||(_={}),_[e.keyFormat]&&(_=YI({},_)),_[e.keyFormat]=e}else q.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${i}"`);break}case`START`:o.startTimeOffset=xL(i);break;case`MAP`:{let e=new rz(i);if(hL(o,e,[`BYTERANGE`,`URI`]),m.duration){let i=new cz(r,t);wL(i,e,n,_),c=i,m.initSegment=c,c.rawProgramDateTime&&!m.rawProgramDateTime&&(m.rawProgramDateTime=c.rawProgramDateTime)}else wL(m,e,n,_),c=m,y=!0;break}case`SERVER-CONTROL`:{let e=new rz(i);o.canBlockReload=e.bool(`CAN-BLOCK-RELOAD`),o.canSkipUntil=e.optionalFloat(`CAN-SKIP-UNTIL`,0),o.canSkipDateRanges=o.canSkipUntil>0&&e.bool(`CAN-SKIP-DATERANGES`),o.partHoldBack=e.optionalFloat(`PART-HOLD-BACK`,0),o.holdBack=e.optionalFloat(`HOLD-BACK`,0);break}case`PART-INF`:{let e=new rz(i);o.partTarget=e.decimalFloatingPoint(`PART-TARGET`);break}case`PART`:{let e=o.partList;e||(e=o.partList=[]);let n=u>0?e[e.length-1]:void 0,r=u++,a=new rz(i);hL(o,a,[`BYTERANGE`,`URI`]);let s=new lz(a,m,t,r,n);e.push(s),m.duration+=s.duration;break}case`PRELOAD-HINT`:{let e=new rz(i);hL(o,e,[`URI`]),o.preloadHint=e;break}case`RENDITION-REPORT`:{let e=new rz(i);hL(o,e,[`URI`]),o.renditionReports=o.renditionReports||[],o.renditionReports.push(e);break}default:q.warn(`line parsed but not handled: ${h}`);break}}}p&&!p.relurl?(s.pop(),d-=p.duration,o.partList&&(o.fragmentHint=p)):o.partList&&(CL(m,p),m.cc=f,o.fragmentHint=m,_&&TL(m,_,o));let b=s.length,ee=s[0],te=s[b-1];if(d+=o.skippedSegments*o.targetduration,d>0&&b&&te){o.averagetargetduration=d/b;let e=te.sn;o.endSN=e===`initSegment`?0:e,o.live||(te.endList=!0),ee&&(o.startCC=ee.cc)}else o.endSN=0,o.startCC=0;return o.fragmentHint&&(d+=o.fragmentHint.duration),o.totalduration=d,o.endCC=f,v>0&&hde(s,v),o}},qz={MANIFEST:`manifest`,LEVEL:`level`,AUDIO_TRACK:`audioTrack`,SUBTITLE_TRACK:`subtitleTrack`},Jz={MAIN:`main`,AUDIO:`audio`,SUBTITLE:`subtitle`},Yz=class{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){let{hls:e}=this;e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.LEVEL_LOADING,this.onLevelLoading,this),e.on(G.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(G.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){let{hls:e}=this;e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.LEVEL_LOADING,this.onLevelLoading,this),e.off(G.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(G.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){let t=this.hls.config,n=t.pLoader,r=t.loader,i=n||r,a=new i(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(let e in this.loaders){let t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){let{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:`text`,type:qz.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,t){let{id:n,level:r,url:i,deliveryDirectives:a}=t;this.load({id:n,level:r,responseType:`text`,type:qz.LEVEL,url:i,deliveryDirectives:a})}onAudioTrackLoading(e,t){let{id:n,groupId:r,url:i,deliveryDirectives:a}=t;this.load({id:n,groupId:r,level:null,responseType:`text`,type:qz.AUDIO_TRACK,url:i,deliveryDirectives:a})}onSubtitleTrackLoading(e,t){let{id:n,groupId:r,url:i,deliveryDirectives:a}=t;this.load({id:n,groupId:r,level:null,responseType:`text`,type:qz.SUBTITLE_TRACK,url:i,deliveryDirectives:a})}load(e){var t;let n=this.hls.config,r=this.getInternalLoader(e);if(r){let t=r.context;if(t&&t.url===e.url){q.trace(`[playlist-loader]: playlist request ongoing`);return}q.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}let i;if(i=e.type===qz.MANIFEST?n.manifestLoadPolicy.default:YI({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),(t=e.deliveryDirectives)!=null&&t.part){let t;if(e.type===qz.LEVEL&&e.level!==null?t=this.hls.levels[e.level].details:e.type===qz.AUDIO_TRACK&&e.id!==null?t=this.hls.audioTracks[e.id].details:e.type===qz.SUBTITLE_TRACK&&e.id!==null&&(t=this.hls.subtitleTracks[e.id].details),t){let e=t.partTarget,n=t.targetduration;if(e&&n){let t=Math.max(e*3,n*.8)*1e3;i=YI({},i,{maxTimeToFirstByteMs:Math.min(t,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,i.maxTimeToFirstByteMs)})}}}let a=i.errorRetry||i.timeoutRetry||{},o={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},s={onSuccess:(e,t,n,r)=>{let i=this.getInternalLoader(n);this.resetInternalLoader(n.type);let a=e.data;if(a.indexOf(`#EXTM3U`)!==0){this.handleManifestParsingError(e,n,Error(`no EXTM3U delimiter`),r||null,t);return}t.parsing.start=performance.now(),Kz.isMediaPlaylist(a)?this.handleTrackOrLevelPlaylist(e,t,n,r||null,i):this.handleMasterPlaylist(e,t,n,r)},onError:(e,t,n,r)=>{this.handleNetworkError(t,n,!1,e,r)},onTimeout:(e,t,n)=>{this.handleNetworkError(t,n,!0,void 0,e)}};r.load(e,o,s)}handleMasterPlaylist(e,t,n,r){let i=this.hls,a=e.data,o=DL(e,n),s=Kz.parseMasterPlaylist(a,o);if(s.playlistParsingError){this.handleManifestParsingError(e,n,s.playlistParsingError,r,t);return}let{contentSteering:c,levels:l,sessionData:u,sessionKeys:d,startTimeOffset:f,variableList:p}=s;this.variableList=p;let{AUDIO:m=[],SUBTITLES:h,"CLOSED-CAPTIONS":g}=Kz.parseMasterPlaylistMedia(a,o,s);if(m.length){let e=m.some(e=>!e.url);!e&&l[0].audioCodec&&!l[0].attrs.AUDIO&&(q.log(`[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one`),m.unshift({type:`main`,name:`main`,groupId:`main`,default:!1,autoselect:!1,forced:!1,id:-1,attrs:new rz({}),bitrate:0,url:``}))}i.trigger(G.MANIFEST_LOADED,{levels:l,audioTracks:m,subtitles:h,captions:g,contentSteering:c,url:o,stats:t,networkDetails:r,sessionData:u,sessionKeys:d,startTimeOffset:f,variableList:p})}handleTrackOrLevelPlaylist(e,t,n,r,i){let a=this.hls,{id:o,level:s,type:c}=n,l=DL(e,n),u=XR(o)?o:0,d=XR(s)?s:u,f=EL(n),p=Kz.parseLevelPlaylist(e.data,l,d,f,u,this.variableList);if(c===qz.MANIFEST){let e={attrs:new rz({}),bitrate:0,details:p,name:``,url:l};a.trigger(G.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:l,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=p,this.handlePlaylistLoaded(p,e,t,n,r,i)}handleManifestParsingError(e,t,n,r,i){this.hls.trigger(G.ERROR,{type:ZR.NETWORK_ERROR,details:K.MANIFEST_PARSING_ERROR,fatal:t.type===qz.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:r,stats:i})}handleNetworkError(e,t,n=!1,r,i){let a=`A network ${n?`timeout`:`error`+(r?` (status `+r.code+`)`:``)} occurred while loading ${e.type}`;e.type===qz.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===qz.AUDIO_TRACK||e.type===qz.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);let o=Error(a);q.warn(`[playlist-loader]: ${a}`);let s=K.UNKNOWN,c=!1,l=this.getInternalLoader(e);switch(e.type){case qz.MANIFEST:s=n?K.MANIFEST_LOAD_TIMEOUT:K.MANIFEST_LOAD_ERROR,c=!0;break;case qz.LEVEL:s=n?K.LEVEL_LOAD_TIMEOUT:K.LEVEL_LOAD_ERROR,c=!1;break;case qz.AUDIO_TRACK:s=n?K.AUDIO_TRACK_LOAD_TIMEOUT:K.AUDIO_TRACK_LOAD_ERROR,c=!1;break;case qz.SUBTITLE_TRACK:s=n?K.SUBTITLE_TRACK_LOAD_TIMEOUT:K.SUBTITLE_LOAD_ERROR,c=!1;break}l&&this.resetInternalLoader(e.type);let u={type:ZR.NETWORK_ERROR,details:s,fatal:c,url:e.url,loader:l,context:e,error:o,networkDetails:t,stats:i};if(r){let n=(t==null?void 0:t.url)||e.url;u.response=JI({url:n,data:void 0},r)}this.hls.trigger(G.ERROR,u)}handlePlaylistLoaded(e,t,n,r,i,a){let o=this.hls,{type:s,level:c,id:l,groupId:u,deliveryDirectives:d}=r,f=DL(t,r),p=EL(r),m=typeof r.level==`number`&&p===Jz.MAIN?c:void 0;if(!e.fragments.length){let e=Error(`No Segments found in Playlist`);o.trigger(G.ERROR,{type:ZR.NETWORK_ERROR,details:K.LEVEL_EMPTY_ERROR,fatal:!1,url:f,error:e,reason:e.message,response:t,context:r,level:m,parent:p,networkDetails:i,stats:n});return}e.targetduration||(e.playlistParsingError=Error(`Missing Target Duration`));let h=e.playlistParsingError;if(h){o.trigger(G.ERROR,{type:ZR.NETWORK_ERROR,details:K.LEVEL_PARSING_ERROR,fatal:!1,url:f,error:h,reason:h.message,response:t,context:r,level:m,parent:p,networkDetails:i,stats:n});return}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),s){case qz.MANIFEST:case qz.LEVEL:o.trigger(G.LEVEL_LOADED,{details:e,level:m||0,id:l||0,stats:n,networkDetails:i,deliveryDirectives:d});break;case qz.AUDIO_TRACK:o.trigger(G.AUDIO_TRACK_LOADED,{details:e,id:l||0,groupId:u||``,stats:n,networkDetails:i,deliveryDirectives:d});break;case qz.SUBTITLE_TRACK:o.trigger(G.SUBTITLE_TRACK_LOADED,{details:e,id:l||0,groupId:u||``,stats:n,networkDetails:i,deliveryDirectives:d});break}}},Xz={audioId3:`org.id3`,dateRange:`com.apple.quicktime.HLS`,emsg:`https://aomedia.org/emsg/ID3`},Zz=.25,Qz=(()=>{let e=ML();try{new e(0,1/0,``)}catch(e){return Number.MAX_VALUE}return 1/0})(),$z=class{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){let{hls:e}=this;e.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(G.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(G.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){let{hls:e}=this;e.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(G.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(G.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(AL(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){let t=this.getID3Track(e.textTracks);return t.mode=`hidden`,t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){let n=e[t];if(n.kind===`metadata`&&n.label===`id3`)return OL(n,this.media),n}return this.media.addTextTrack(`metadata`,`id3`)}}onFragParsingMetadata(e,t){if(!this.media)return;let{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:r}}}=this;if(!n&&!r)return;let{samples:i}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));let a=ML();for(let e=0;e<i.length;e++){let t=i[e].type;if(t===Xz.emsg&&!n||!r)continue;let o=wz(i[e].data);if(o){let n=i[e].pts,r=n+i[e].duration;r>Qz&&(r=Qz);let s=r-n;s<=0&&(r=n+Zz);for(let e=0;e<o.length;e++){let i=o[e];if(!Sz(i)){this.updateId3CueEnds(n,t);let e=new a(n,r,``);e.value=i,t&&(e.type=t),this.id3Track.addCue(e)}}}}}updateId3CueEnds(e,t){var n;let r=(n=this.id3Track)==null?void 0:n.cues;if(r)for(let n=r.length;n--;){let i=r[n];i.type===t&&i.startTime<e&&i.endTime===Qz&&(i.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:r}){let{id3Track:i,hls:a}=this;if(!a)return;let{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:s}}=a;if(i&&(o||s)){let e;e=r===`audio`?e=>e.type===Xz.audioId3&&s:r===`video`?e=>e.type===Xz.emsg&&o:e=>e.type===Xz.audioId3&&s||e.type===Xz.emsg&&o,jL(i,t,n,e)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;let{dateRangeCuesAppended:n,id3Track:r}=this,{dateRanges:i}=t,a=Object.keys(i);if(r){let e=Object.keys(n).filter(e=>!a.includes(e));for(let t=e.length;t--;){let i=e[t];Object.keys(n[i].cues).forEach(e=>{r.removeCue(n[i].cues[e])}),delete n[i]}}let o=t.fragments[t.fragments.length-1];if(a.length===0||!XR(o==null?void 0:o.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));let s=o.programDateTime/1e3-o.start,c=ML();for(let e=0;e<a.length;e++){let t=a[e],r=i[t],o=n[t],l=(o==null?void 0:o.cues)||{},u=(o==null?void 0:o.durationKnown)||!1,d=NL(r.startDate,s),f=Qz,p=r.endDate;if(p)f=NL(p,s),u=!0;else if(r.endOnNext&&!u){let e=a.reduce((e,t)=>{let n=i[t];return n.class===r.class&&n.id!==t&&n.startDate>r.startDate&&e.push(n),e},[]).sort((e,t)=>e.startDate.getTime()-t.startDate.getTime())[0];e&&(f=NL(e.startDate,s),u=!0)}let m=Object.keys(r.attr);for(let e=0;e<m.length;e++){let n=m[e];if(!Uue(n))continue;let i=l[n];if(i)u&&!o.durationKnown&&(i.endTime=f);else{let e=r.attr[n];i=new c(d,f,``),Wue(n)&&(e=vde(e)),i.value={key:n,data:e},i.type=Xz.dateRange,i.id=t,this.id3Track.addCue(i),l[n]=i}}n[t]={cues:l,dateRange:r,durationKnown:u}}}},eB=class{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){let{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration===void 0?t?e.liveMaxLatencyDurationCount*t.targetduration:0:e.liveMaxLatencyDuration}get targetLatency(){let{levelDetails:e}=this;if(e===null)return null;let{holdBack:t,partHoldBack:n,targetduration:r}=e,{liveSyncDuration:i,liveSyncDurationCount:a,lowLatencyMode:o}=this.config,s=this.hls.userConfig,c=o&&n||t;(s.liveSyncDuration||s.liveSyncDurationCount||c===0)&&(c=i===void 0?a*r:i);let l=r;return c+Math.min(this.stallCount*1,l)}get liveSyncPosition(){let e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(e===null||t===null||n===null)return null;let r=n.edge,i=e-t-this.edgeStalled,a=r-n.totalduration,o=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(a,i),o)}get drift(){let{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){let{levelDetails:e}=this;if(e===null)return 0;let t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){let{media:e,levelDetails:t}=this;if(!e||!t)return 0;let n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(G.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(G.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(G.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(G.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(G.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(G.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener(`timeupdate`,this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener(`timeupdate`,this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener(`timeupdate`,this.timeupdateHandler)}onError(e,t){var n;t.details===K.BUFFER_STALLED_ERROR&&(this.stallCount++,(n=this.levelDetails)!=null&&n.live&&q.warn(`[playback-rate-controller]: Stall detected, adjusting target latency`))}timeupdate(){let{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;let n=this.computeLatency();if(n===null)return;this._latency=n;let{lowLatencyMode:r,maxLiveSyncPlaybackRate:i}=this.config;if(!r||i===1)return;let a=this.targetLatency;if(a===null)return;let o=n-a,s=Math.min(this.maxLatency,a+t.targetduration),c=o<s;if(t.live&&c&&o>.05&&this.forwardBufferLength>1){let t=Math.min(2,Math.max(1,i)),n=Math.round(2/(1+Math.exp(-.75*o-this.edgeStalled))*20)/20;e.playbackRate=Math.min(t,Math.max(1,n))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){let{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){let e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}},tB=[`NONE`,`TYPE-0`,`TYPE-1`,null],nB={No:``,Yes:`YES`,v2:`v2`},rB=class{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){let t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set(`_HLS_msn`,this.msn.toString()),this.part!==void 0&&t.searchParams.set(`_HLS_part`,this.part.toString()),this.skip&&t.searchParams.set(`_HLS_skip`,this.skip),t.href}},iB=class{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter(e=>e).join(`,`).replace(/\.[^.,]+/g,``)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs[`PATHWAY-ID`]||`.`}get uri(){return this.url[this._urlId]||``}get urlId(){return this._urlId}set urlId(e){let t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var e;return(e=this.audioGroupIds)==null?void 0:e[this.urlId]}get textGroupId(){var e;return(e=this.textGroupIds)==null?void 0:e[this.urlId]}addFallback(e){this.url.push(e.url),this._attrs.push(e.attrs)}},aB={search:function(e,t){let n=0,r=e.length-1,i=null,a=null;for(;n<=r;){i=(n+r)/2|0,a=e[i];let o=t(a);if(o>0)n=i+1;else if(o<0)r=i-1;else return a}return null}},oB=3e5,sB={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},cB={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4},lB=class{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=q.log.bind(q,`[info]:`),this.warn=q.warn.bind(q,`[warning]:`),this.error=q.error.bind(q,`[error]:`),this.registerListeners()}registerListeners(){let e=this.hls;e.on(G.ERROR,this.onError,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){let e=this.hls;e&&(e.off(G.ERROR,this.onError,this),e.off(G.ERROR,this.onErrorOut,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){this.playlistError=0}stopLoad(){}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Jz.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,r;if(t.fatal)return;let i=this.hls,a=t.context;switch(t.details){case K.FRAG_LOAD_ERROR:case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_ERROR:case K.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case K.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction={action:sB.DoNothing,flags:cB.None};return}case K.FRAG_GAP:case K.FRAG_DECRYPT_ERROR:t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=sB.SendAlternateToPenaltyBox;return;case K.LEVEL_EMPTY_ERROR:case K.LEVEL_PARSING_ERROR:{var o,s;let e=t.parent===Jz.MAIN?t.level:i.loadLevel;t.details===K.LEVEL_EMPTY_ERROR&&(o=t.context)!=null&&(s=o.levelDetails)!=null&&s.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case K.LEVEL_LOAD_ERROR:case K.LEVEL_LOAD_TIMEOUT:typeof(a==null?void 0:a.level)==`number`&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.level));return;case K.AUDIO_TRACK_LOAD_ERROR:case K.AUDIO_TRACK_LOAD_TIMEOUT:case K.SUBTITLE_LOAD_ERROR:case K.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){let e=i.levels[i.loadLevel];if(e&&(a.type===qz.AUDIO_TRACK&&a.groupId===e.audioGroupId||a.type===qz.SUBTITLE_TRACK&&a.groupId===e.textGroupId)){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=sB.SendAlternateToPenaltyBox,t.errorAction.flags=cB.MoveAllAlternatesMatchingHost;return}}return;case K.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{let e=i.levels[i.loadLevel],n=e==null?void 0:e.attrs[`HDCP-LEVEL`];n&&(t.errorAction={action:sB.SendAlternateToPenaltyBox,flags:cB.MoveAllAlternatesMatchingHDCP,hdcpLevel:n})}return;case K.BUFFER_ADD_CODEC_ERROR:case K.REMUX_ALLOC_ERROR:t.errorAction=this.getLevelSwitchAction(t,(r=t.level)==null?i.loadLevel:r);return;case K.INTERNAL_EXCEPTION:case K.BUFFER_APPENDING_ERROR:case K.BUFFER_APPEND_ERROR:case K.BUFFER_FULL_ERROR:case K.LEVEL_SWITCH_ERROR:case K.BUFFER_STALLED_ERROR:case K.BUFFER_SEEK_OVER_HOLE:case K.BUFFER_NUDGE_ON_STALL:t.errorAction={action:sB.DoNothing,flags:cB.None};return}if(t.type===ZR.KEY_SYSTEM_ERROR){let e=this.getVariantLevelIndex(t.frag);t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e);return}}getPlaylistRetryOrSwitchAction(e,t){var n;let r=this.hls,i=VL(r.config.playlistLoadPolicy,e),a=this.playlistError++,o=(n=e.response)==null?void 0:n.code,s=WL(i,a,BL(e),o);if(s)return{action:sB.RetryRequest,flags:cB.None,retryConfig:i,retryCount:a};let c=this.getLevelSwitchAction(e,t);return i&&(c.retryConfig=i,c.retryCount=a),c}getFragRetryOrSwitchAction(e){let t=this.hls,n=this.getVariantLevelIndex(e.frag),r=t.levels[n],{fragLoadPolicy:i,keyLoadPolicy:a}=t.config,o=VL(e.details.startsWith(`key`)?a:i,e),s=t.levels.reduce((e,t)=>e+t.fragmentError,0);if(r){var c;e.details!==K.FRAG_GAP&&r.fragmentError++;let t=(c=e.response)==null?void 0:c.code,n=WL(o,s,BL(e),t);if(n)return{action:sB.RetryRequest,flags:cB.None,retryConfig:o,retryCount:s}}let l=this.getLevelSwitchAction(e,n);return o&&(l.retryConfig=o,l.retryCount=s),l}getLevelSwitchAction(e,t){let n=this.hls;t==null&&(t=n.loadLevel);let r=this.hls.levels[t];if(r&&(r.loadError++,n.autoLevelEnabled)){var i,a;let t=-1,{levels:o,loadLevel:s,minAutoLevel:c,maxAutoLevel:l}=n,u=(i=e.frag)==null?void 0:i.type,{type:d,groupId:f}=(a=e.context)==null?{}:a;for(let n=o.length;n--;){let i=(n+s)%o.length;if(i!==s&&i>=c&&i<=l&&o[i].loadError===0){let n=o[i];if(e.details===K.FRAG_GAP&&e.frag){let t=o[i].details;if(t){let n=GL(e.frag,t.fragments,e.frag.start);if(n!=null&&n.gap)continue}}else if(d===qz.AUDIO_TRACK&&f===n.audioGroupId||d===qz.SUBTITLE_TRACK&&f===n.textGroupId)continue;else if(u===Jz.AUDIO&&r.audioGroupId===n.audioGroupId||u===Jz.SUBTITLE&&r.textGroupId===n.textGroupId)continue;t=i;break}}if(t>-1&&n.loadLevel!==t)return e.levelRetry=!0,this.playlistError=0,{action:sB.SendAlternateToPenaltyBox,flags:cB.None,nextAutoLevel:t}}return{action:sB.SendAlternateToPenaltyBox,flags:cB.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case sB.DoNothing:break;case sB.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==K.FRAG_GAP&&(t.fatal=!0);break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){let t=this.hls,n=e.errorAction;if(!n)return;let{flags:r,hdcpLevel:i,nextAutoLevel:a}=n;switch(r){case cB.None:this.switchLevel(e,a);break;case cB.MoveAllAlternatesMatchingHost:n.resolved||(n.resolved=this.redundantFailover(e));break;case cB.MoveAllAlternatesMatchingHDCP:i&&(t.maxHdcpLevel=tB[tB.indexOf(i)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,a)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){let{hls:t,penalizedRenditions:n}=this,r=e.parent===Jz.MAIN?e.level:t.loadLevel,i=t.levels[r],a=i.url.length,o=e.frag?e.frag.urlId:i.urlId;i.urlId===o&&(!e.frag||i.details)&&this.penalizeRendition(i,e);for(let s=1;s<a;s++){let c=(o+s)%a,l=n[c];if(!l||Ade(l,e,n[o]))return this.warn(`Switching to Redundant Stream ${c+1}/${a}: "${i.url[c]}" after ${e.details}`),this.playlistError=0,t.levels.forEach(e=>{e.urlId=c}),t.nextLoadLevel=r,!0}return!1}penalizeRendition(e,t){let{penalizedRenditions:n}=this,r=n[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};r.lastErrorPerfMs=performance.now(),r.errors.push(t),r.details=e.details,n[e.urlId]=r}},uB=class{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=q.log.bind(q,`${t}:`),this.warn=q.warn.bind(q,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){let n=t==null?void 0:t.renditionReports;if(n){let r=-1;for(let i=0;i<n.length;i++){let a=n[i],o;try{o=new self.URL(a.URI,t.url).href}catch(e){q.warn(`Could not construct new URL for Rendition Report: ${e}`),o=a.URI||``}if(o===e){r=i;break}else o===e.substring(0,o.length)&&(r=i)}if(r!==-1){let e=n[r],i=parseInt(e[`LAST-MSN`])||(t==null?void 0:t.lastPartSn),a=parseInt(e[`LAST-PART`])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){let e=Math.min(t.age-t.partTarget,t.targetduration);a>=0&&e>t.partTarget&&(a+=1)}return new rB(i,a>=0?a:void 0,nB.No)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){let{details:r,stats:i}=t,a=self.performance.now(),o=i.loading.first?Math.max(0,a-i.loading.first):0;if(r.advancedDateTime=Date.now()-o,r.live||n!=null&&n.live){if(r.reloaded(n),n&&this.log(`live playlist ${e} ${r.advanced?`REFRESHED `+r.lastPartSn+`-`+r.lastPartIndex:r.updated?`UPDATED`:`MISSED`}`),n&&r.fragments.length>0&&bde(n,r),!this.canLoad||!r.live)return;let o,s,c;if(r.canBlockReload&&r.endSN&&r.advanced){let e=this.hls.config.lowLatencyMode,i=r.lastPartSn,a=r.endSN,l=r.lastPartIndex,u=l!==-1,d=i===a,f=e?0:l;u?(s=d?a+1:i,c=d?f:l+1):s=a+1;let p=r.age,m=p+r.ageHeader,h=Math.min(m-r.partTarget,r.targetduration*1.5);if(h>0){if(n&&h>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${h} with playlist age: ${r.age}`),h=0;else{let e=Math.floor(h/r.targetduration);if(s+=e,c!==void 0){let e=Math.round(h%r.targetduration/r.partTarget);c+=e}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${p.toFixed(2)}s goal: ${h} skip sn ${e} to part ${c}`)}r.tuneInGoal=h}if(o=this.getDeliveryDirectives(r,t.deliveryDirectives,s,c),e||!d){this.loadPlaylist(o);return}}else (r.canBlockReload||r.canSkipUntil)&&(o=this.getDeliveryDirectives(r,t.deliveryDirectives,s,c));let l=this.hls.mainForwardBufferInfo,u=l?l.end-l.len:0,d=(r.edge-u)*1e3,f=wde(r,d);r.updated&&a>this.requestScheduled+f&&(this.requestScheduled=i.loading.start),s!==void 0&&r.canBlockReload?this.requestScheduled=i.loading.first+f-(r.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+f<a?this.requestScheduled=a:this.requestScheduled-a<=0&&(this.requestScheduled+=f);let p=this.requestScheduled-a;p=Math.max(0,p),this.log(`reload live playlist ${e} in ${Math.round(p)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(o),p)}else this.clearTimer()}getDeliveryDirectives(e,t,n,r){let i=yde(e,n);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,r=t.part,i=nB.No),new rB(n,r,i)}checkRetry(e){let t=e.details,n=BL(e),r=e.errorAction,{action:i,retryCount:a=0,retryConfig:o}=r||{},s=!!r&&!!o&&(i===sB.RetryRequest||!r.resolved&&i===sB.SendAlternateToPenaltyBox);if(s){var c;if(this.requestScheduled=-1,a>=o.maxNumRetry)return!1;if(n&&(c=e.context)!=null&&c.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{let e=HL(o,a);this.timer=self.setTimeout(()=>this.loadPlaylist(),e),this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" in ${e}ms`)}e.levelRetry=!0,r.resolved=!0}return s}},fB=class extends uB{constructor(e,t){super(e,`[level-controller]`),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){let{hls:e}=this;e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(G.LEVEL_LOADED,this.onLevelLoaded,this),e.on(G.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(G.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(G.FRAG_LOADED,this.onFragLoaded,this),e.on(G.ERROR,this.onError,this)}_unregisterListeners(){let{hls:e}=this;e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(G.LEVEL_LOADED,this.onLevelLoaded,this),e.off(G.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(G.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(G.FRAG_LOADED,this.onFragLoaded,this),e.off(G.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){let e=this._levels;e.forEach(e=>{e.loadError=0,e.fragmentError=0}),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){let n=[],r={},i;t.levels.forEach(e=>{var t;let a=e.attrs;((t=e.audioCodec)==null?void 0:t.indexOf(`mp4a.40.34`))!==-1&&(dB||(dB=/chrome|firefox/i.test(navigator.userAgent)),dB&&(e.audioCodec=void 0));let{AUDIO:o,CODECS:s,"FRAME-RATE":c,"PATHWAY-ID":l,RESOLUTION:u,SUBTITLES:d}=a,f=`${l||`.`}-`,p=`${f}${e.bitrate}-${u}-${c}-${s}`;i=r[p],i?i.addFallback(e):(i=new iB(e),r[p]=i,n.push(i)),qL(i,`audio`,o),qL(i,`text`,d)}),this.filterAndSortMediaOptions(n,t)}filterAndSortMediaOptions(e,t){let n=[],r=[],i=!1,a=!1,o=!1,s=e.filter(({audioCodec:e,videoCodec:t,width:n,height:r,unknownCodecs:s})=>(i||(i=!!(n&&r)),a||(a=!!t),o||(o=!!e),!(s!=null&&s.length)&&(!e||yL(e,`audio`))&&(!t||yL(t,`video`))));if((i||a)&&o&&(s=s.filter(({videoCodec:e,width:t,height:n})=>!!e||!!(t&&n))),s.length===0){Promise.resolve().then(()=>{if(this.hls){let e=Error(`no level with compatible codecs found in manifest`);this.hls.trigger(G.ERROR,{type:ZR.MEDIA_ERROR,details:K.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:e,reason:e.message})}});return}t.audioTracks&&(n=t.audioTracks.filter(e=>!e.audioCodec||yL(e.audioCodec,`audio`)),JL(n)),t.subtitles&&(r=t.subtitles,JL(r));let c=s.slice(0);s.sort((e,t)=>e.attrs[`HDCP-LEVEL`]===t.attrs[`HDCP-LEVEL`]?e.bitrate===t.bitrate?e.attrs[`FRAME-RATE`]===t.attrs[`FRAME-RATE`]?e.attrs.SCORE===t.attrs.SCORE?i&&e.height!==t.height?e.height-t.height:0:e.attrs.decimalFloatingPoint(`SCORE`)-t.attrs.decimalFloatingPoint(`SCORE`):e.attrs.decimalFloatingPoint(`FRAME-RATE`)-t.attrs.decimalFloatingPoint(`FRAME-RATE`):e.bitrate-t.bitrate:(e.attrs[`HDCP-LEVEL`]||``)>(t.attrs[`HDCP-LEVEL`]||``)?1:-1);let l=c[0];if(this.steering&&(s=this.steering.filterParsedLevels(s),s.length!==c.length)){for(let e=0;e<c.length;e++)if(c[e].pathwayId===s[0].pathwayId){l=c[e];break}}this._levels=s;for(let e=0;e<s.length;e++)if(s[e]===l){this._firstLevel=e,this.log(`manifest loaded, ${s.length} level(s) found, first bitrate: ${l.bitrate}`);break}let u=o&&!a,d={levels:s,audioTracks:n,subtitleTracks:r,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:o,video:a,altAudio:!u&&n.some(e=>!!e.url)};this.hls.trigger(G.MANIFEST_PARSED,d),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){let t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){let n=Error(`invalid level idx`),r=e<0;if(this.hls.trigger(G.ERROR,{type:ZR.OTHER_ERROR,details:K.LEVEL_SWITCH_ERROR,level:e,fatal:r,error:n,reason:n.message}),r)return;e=Math.min(e,t.length-1)}let n=this.currentLevelIndex,r=this.currentLevel,i=r?r.attrs[`PATHWAY-ID`]:void 0,a=t[e],o=a.attrs[`PATHWAY-ID`];if(this.currentLevelIndex=e,this.currentLevel=a,n===e&&a.details&&r&&i===o)return;this.log(`Switching to level ${e}${o?` with Pathway `+o:``} from level ${n}${i?` with Pathway `+i:``}`);let s=YI({},a,{level:e,maxBitrate:a.maxBitrate,attrs:a.attrs,uri:a.uri,urlId:a.urlId});delete s._attrs,delete s._urlId,this.hls.trigger(G.LEVEL_SWITCHING,s);let c=a.details;if(!c||c.live){let e=this.switchParams(a.uri,r==null?void 0:r.details);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){let e=this.hls.config.startLevel;return e===void 0?this._firstLevel:e}else return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===qz.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragLoaded(e,{frag:t}){if(t!==void 0&&t.type===Jz.MAIN){let e=this._levels[t.level];e!==void 0&&(e.loadError=0)}}onLevelLoaded(e,t){var n;let{level:r,details:i}=t,a=this._levels[r];if(!a){var o;this.warn(`Invalid level index ${r}`),(o=t.deliveryDirectives)!=null&&o.skip&&(i.deltaUpdateFailed=!0);return}r===this.currentLevelIndex?(a.fragmentError===0&&(a.loadError=0),this.playlistLoaded(r,t,a.details)):(n=t.deliveryDirectives)!=null&&n.skip&&(i.deltaUpdateFailed=!0)}onAudioTrackSwitched(e,t){let n=this.currentLevel;if(!n)return;let r=this.hls.audioTracks[t.id].groupId;if(n.audioGroupIds&&n.audioGroupId!==r){let e=-1;for(let t=0;t<n.audioGroupIds.length;t++)if(n.audioGroupIds[t]===r){e=t;break}e!==-1&&e!==n.urlId&&(n.urlId=e,this.canLoad&&this.startLoad())}}loadPlaylist(e){super.loadPlaylist();let t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let r=n.urlId,i=n.uri;if(e)try{i=e.addDirectives(i)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}let a=n.attrs[`PATHWAY-ID`];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)===void 0?``:` at sn `+e.msn+` part `+e.part} with${a?` Pathway `+a:``} URI ${r+1}/${n.url.length} ${i}`),this.clearTimer(),this.hls.trigger(G.LEVEL_LOADING,{url:i,level:t,id:r,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex===-1?this.hls.nextAutoLevel:this.manualLevelIndex}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e,t){let n=(e,n)=>n!==t,r=this._levels.filter((r,i)=>i===e?r.url.length>1&&t!==void 0?(r.url=r.url.filter(n),r.audioGroupIds&&(r.audioGroupIds=r.audioGroupIds.filter(n)),r.textGroupIds&&(r.textGroupIds=r.textGroupIds.filter(n)),r.urlId=0,!0):(this.steering&&this.steering.removeLevel(r),!1):!0);this.hls.trigger(G.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){t.forEach((e,t)=>{let{details:n}=e;n!=null&&n.fragments&&n.fragments.forEach(e=>{e.level=t})}),this._levels=t}},pB={NOT_LOADED:`NOT_LOADED`,APPENDING:`APPENDING`,PARTIAL:`PARTIAL`,OK:`OK`},mB=class{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){let{hls:e}=this;e.on(G.BUFFER_APPENDED,this.onBufferAppended,this),e.on(G.FRAG_BUFFERED,this.onFragBuffered,this),e.on(G.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){let{hls:e}=this;e.off(G.BUFFER_APPENDED,this.onBufferAppended,this),e.off(G.FRAG_BUFFERED,this.onFragBuffered,this),e.off(G.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){let n=this.activePartLists[t];if(n)for(let t=n.length;t--;){let r=n[t];if(!r)break;let i=r.end;if(r.start<=e&&i!==null&&e<=i)return r}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){let{fragments:n}=this,r=Object.keys(n);for(let i=r.length;i--;){let a=n[r[i]];if((a==null?void 0:a.body.type)===t&&a.buffered){let t=a.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,n,r){this.timeRanges&&(this.timeRanges[e]=t);let i=(r==null?void 0:r.fragment.sn)||-1;Object.keys(this.fragments).forEach(r=>{let a=this.fragments[r];if(!a||i>=a.body.sn)return;if(!a.buffered&&!a.loaded){a.body.type===n&&this.removeFragment(a.body);return}let o=a.range[e];o&&o.time.some(e=>{let n=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return n&&this.removeFragment(a.body),n})})}detectPartialFragments(e){let t=this.timeRanges,{frag:n,part:r}=e;if(!t||n.sn===`initSegment`)return;let i=XL(n),a=this.fragments[i];if(!a||a.buffered&&n.gap)return;let o=!n.relurl;if(Object.keys(t).forEach(e=>{let i=n.elementaryStreams[e];if(!i)return;let s=t[e],c=o||i.partial===!0;a.range[e]=this.getBufferedTimes(n,r,c,s)}),a.loaded=null,Object.keys(a.range).length){a.buffered=!0;let e=a.body.endList=n.endList||a.body.endList;e&&(this.endListFragments[a.body.type]=a),YL(a)||this.removeParts(n.sn-1,n.type)}else this.removeFragment(a.body)}removeParts(e,t){let n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter(t=>t.fragment.sn>=e))}fragBuffered(e,t){let n=XL(e),r=this.fragments[n];!r&&t&&(r=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,n,r){let i={time:[],partial:n},a=e.start,o=e.end,s=e.minEndPTS||o,c=e.maxStartPTS||a;for(let e=0;e<r.length;e++){let t=r.start(e)-this.bufferPadding,n=r.end(e)+this.bufferPadding;if(c>=t&&s<=n){i.time.push({startPTS:Math.max(a,r.start(e)),endPTS:Math.min(o,r.end(e))});break}else if(a<n&&o>t)i.partial=!0,i.time.push({startPTS:Math.max(a,r.start(e)),endPTS:Math.min(o,r.end(e))});else if(o<=t)break}return i}getPartialFragment(e){let t=null,n,r,i,a=0,{bufferPadding:o,fragments:s}=this;return Object.keys(s).forEach(c=>{let l=s[c];l&&YL(l)&&(r=l.body.start-o,i=l.body.end+o,e>=r&&e<=i&&(n=Math.min(e-r,i-e),a<=n&&(t=l.body,a=n)))}),t}isEndListAppended(e){let t=this.endListFragments[e];return t!==void 0&&(t.buffered||YL(t))}getState(e){let t=XL(e),n=this.fragments[t];return n?n.buffered?YL(n)?pB.PARTIAL:pB.OK:pB.APPENDING:pB.NOT_LOADED}isTimeBuffered(e,t,n){let r,i;for(let a=0;a<n.length;a++){if(r=n.start(a)-this.bufferPadding,i=n.end(a)+this.bufferPadding,e>=r&&t<=i)return!0;if(t<=r)return!1}return!1}onFragLoaded(e,t){let{frag:n,part:r}=t;if(n.sn===`initSegment`||n.bitrateTest)return;let i=r?null:t,a=XL(n);this.fragments[a]={body:n,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){let{frag:n,part:r,timeRanges:i}=t;if(n.sn===`initSegment`)return;let a=n.type;if(r){let e=this.activePartLists[a];e||(this.activePartLists[a]=e=[]),e.push(r)}this.timeRanges=i,Object.keys(i).forEach(e=>{let t=i[e];this.detectEvictedFragments(e,t,a,r)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){let t=XL(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,r,i){r&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{let o=this.fragments[a];if(!o)return;let s=o.body;s.type!==n||r&&!s.gap||s.start<t&&s.end>e&&(o.buffered||i)&&this.removeFragment(s)})}removeFragment(e){let t=XL(e);e.stats.loaded=0,e.clearElementaryStreamInfo();let n=this.activePartLists[e.type];if(n){let t=e.sn;this.activePartLists[e.type]=n.filter(e=>e.fragment.sn!==t)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}},hB=2**17,gB=class{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){let n=e.url;if(!n)return Promise.reject(new _B({type:ZR.NETWORK_ERROR,details:K.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:Error(`Fragment does not have a ${n?`part list`:`url`}`),networkDetails:null}));this.abort();let r=this.config,i=r.fLoader,a=r.loader;return new Promise((o,s)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(e=>e[0]===`GAP`)){s(QL(e));return}else e.gap=!1;let c=this.loader=e.loader=i?new i(r):new a(r),l=ZL(e),u=UL(r.fragLoadPolicy.default),d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn===`initSegment`?1/0:hB};e.stats=c.stats,c.load(l,d,{onSuccess:(t,n,r,i)=>{this.resetLoader(e,c);let a=t.data;r.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(a.slice(0,16)),a=a.slice(16)),o({frag:e,part:null,payload:a,networkDetails:i})},onError:(t,r,i,a)=>{this.resetLoader(e,c),s(new _B({type:ZR.NETWORK_ERROR,details:K.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:JI({url:n,data:void 0},t),error:Error(`HTTP Error ${t.code} ${t.text}`),networkDetails:i,stats:a}))},onAbort:(t,n,r)=>{this.resetLoader(e,c),s(new _B({type:ZR.NETWORK_ERROR,details:K.INTERNAL_ABORTED,fatal:!1,frag:e,error:Error(`Aborted`),networkDetails:r,stats:t}))},onTimeout:(t,n,r)=>{this.resetLoader(e,c),s(new _B({type:ZR.NETWORK_ERROR,details:K.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:Error(`Timeout after ${d.timeout}ms`),networkDetails:r,stats:t}))},onProgress:(n,r,i,a)=>{t&&t({frag:e,part:null,payload:i,networkDetails:a})}})})}loadPart(e,t,n){this.abort();let r=this.config,i=r.fLoader,a=r.loader;return new Promise((o,s)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){s(QL(e,t));return}let c=this.loader=e.loader=i?new i(r):new a(r),l=ZL(e,t),u=UL(r.fragLoadPolicy.default),d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:hB};t.stats=c.stats,c.load(l,d,{onSuccess:(r,i,a,s)=>{this.resetLoader(e,c),this.updateStatsFromPart(e,t);let l={frag:e,part:t,payload:r.data,networkDetails:s};n(l),o(l)},onError:(n,r,i,a)=>{this.resetLoader(e,c),s(new _B({type:ZR.NETWORK_ERROR,details:K.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:JI({url:l.url,data:void 0},n),error:Error(`HTTP Error ${n.code} ${n.text}`),networkDetails:i,stats:a}))},onAbort:(n,r,i)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,c),s(new _B({type:ZR.NETWORK_ERROR,details:K.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:Error(`Aborted`),networkDetails:i,stats:n}))},onTimeout:(n,r,i)=>{this.resetLoader(e,c),s(new _B({type:ZR.NETWORK_ERROR,details:K.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:Error(`Timeout after ${d.timeout}ms`),networkDetails:i,stats:n}))}})})}updateStatsFromPart(e,t){let n=e.stats,r=t.stats,i=r.total;if(n.loaded+=r.loaded,i){let r=Math.round(e.duration/t.duration),a=Math.min(Math.round(n.loaded/i),r),o=r-a,s=o*Math.round(n.loaded/a);n.total=n.loaded+s}else n.total=Math.max(n.loaded,n.total);let a=n.loading,o=r.loading;a.start?a.first+=o.first-o.start:(a.start=o.start,a.first=o.first),a.end=o.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}},_B=class extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}},vB=class{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(let t in this.keyUriToKeyInfo){let n=this.keyUriToKeyInfo[t].loader;if(n){if(e&&e!==n.context.frag.type)return;n.abort()}}}detach(){for(let e in this.keyUriToKeyInfo){let t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){for(let e in this.detach(),this.keyUriToKeyInfo){let t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=K.KEY_LOAD_ERROR,n,r,i){return new _B({type:ZR.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:i,error:n,networkDetails:r})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){let{sn:n,cc:r}=e;for(let e=0;e<t.length;e++){let i=t[e];if(r<=i.cc&&(n===`initSegment`||i.sn===`initSegment`||n<i.sn)){this.emeController.selectKeySystemFormat(i).then(e=>{i.setKeyFormat(e)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,r;t&&e.setKeyFormat(t);let i=e.decryptdata;if(!i){let n=Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:`Missing decryption data on fragment in onKeyLoading`);return Promise.reject(this.createKeyLoadError(e,K.KEY_LOAD_ERROR,n))}let a=i.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,K.KEY_LOAD_ERROR,Error(`Invalid key URI: "${a}"`)));let o=this.keyUriToKeyInfo[a];if((n=o)!=null&&n.decryptdata.key)return i.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if((r=o)!=null&&r.keyLoadPromise){var s;switch((s=o.mediaKeySessionContext)==null?void 0:s.keyStatus){case void 0:case`status-pending`:case`usable`:case`usable-in-future`:return o.keyLoadPromise.then(t=>(i.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:o}))}}switch(o=this.keyUriToKeyInfo[a]={decryptdata:i,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},i.method){case`ISO-23001-7`:case`SAMPLE-AES`:case`SAMPLE-AES-CENC`:case`SAMPLE-AES-CTR`:return i.keyFormat===`identity`?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case`AES-128`:return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,K.KEY_LOAD_ERROR,Error(`Key supplied with unsupported METHOD: "${i.method}"`)))}}loadKeyEME(e,t){let n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){let t=this.emeController.loadKey(n);if(t)return(e.keyLoadPromise=t.then(t=>(e.mediaKeySessionContext=t,n))).catch(t=>{throw e.keyLoadPromise=null,t})}return Promise.resolve(n)}loadKeyHTTP(e,t){let n=this.config,r=n.loader,i=new r(n);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise((r,a)=>{let o={keyInfo:e,frag:t,responseType:`arraybuffer`,url:e.decryptdata.uri},s=n.keyLoadPolicy.default,c={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},l={onSuccess:(e,t,n,i)=>{let{frag:o,keyInfo:s,url:c}=n;if(!o.decryptdata||s!==this.keyUriToKeyInfo[c])return a(this.createKeyLoadError(o,K.KEY_LOAD_ERROR,Error(`after key load, decryptdata unset or changed`),i));s.decryptdata.key=o.decryptdata.key=new Uint8Array(e.data),o.keyLoader=null,s.loader=null,r({frag:o,keyInfo:s})},onError:(e,n,r,i)=>{this.resetLoader(n),a(this.createKeyLoadError(t,K.KEY_LOAD_ERROR,Error(`HTTP Error ${e.code} loading key ${e.text}`),r,JI({url:o.url,data:void 0},e)))},onTimeout:(e,n,r)=>{this.resetLoader(n),a(this.createKeyLoadError(t,K.KEY_LOAD_TIMEOUT,Error(`key loading timed out`),r))},onAbort:(e,n,r)=>{this.resetLoader(n),a(this.createKeyLoadError(t,K.INTERNAL_ABORTED,Error(`key loading aborted`),r))}};i.load(o,c,l)})}resetLoader(e){let{frag:t,keyInfo:n,url:r}=e,i=n.loader;t.keyLoader===i&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[r],i&&i.destroy()}},yB=class{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}},bB={length:0,start:()=>0,end:()=>0},xB=class e{static isBuffered(t,n){try{if(t){let r=e.getBuffered(t);for(let e=0;e<r.length;e++)if(n>=r.start(e)&&n<=r.end(e))return!0}}catch(e){}return!1}static bufferInfo(t,n,r){try{if(t){let i=e.getBuffered(t),a=[],o;for(o=0;o<i.length;o++)a.push({start:i.start(o),end:i.end(o)});return this.bufferedInfo(a,n,r)}}catch(e){}return{len:0,start:n,end:n,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort(function(e,t){let n=e.start-t.start;return n||t.end-e.end});let r=[];if(n)for(let t=0;t<e.length;t++){let i=r.length;if(i){let a=r[i-1].end;e[t].start-a<n?e[t].end>a&&(r[i-1].end=e[t].end):r.push(e[t])}else r.push(e[t])}else r=e;let i=0,a,o=t,s=t;for(let e=0;e<r.length;e++){let c=r[e].start,l=r[e].end;if(t+n>=c&&t<l)o=c,s=l,i=s-t;else if(t+n<c){a=c;break}}return{len:i,start:o||0,end:s||0,nextStart:a}}static getBuffered(e){try{return e.buffered}catch(e){return q.log(`failed to get media.buffered`,e),bB}}},SB=class{constructor(e,t,n,r=0,i=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=$L(),this.buffering={audio:$L(),video:$L(),audiovideo:$L()},this.level=e,this.sn=t,this.id=n,this.size=r,this.part=i,this.partial=a}},CB=class{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:`AES-CBC`,iv:this.aesIV},t,e)}},wB=class{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey(`raw`,this.key,{name:`AES-CBC`},!1,[`encrypt`,`decrypt`])}},TB=class{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array,this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){let t=new DataView(e),n=new Uint32Array(4);for(let e=0;e<4;e++)n[e]=t.getUint32(e*4);return n}initTable(){let e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],i=n[1],a=n[2],o=n[3],s=this.invSubMix,c=s[0],l=s[1],u=s[2],d=s[3],f=new Uint32Array(256),p=0,m=0,h=0;for(h=0;h<256;h++)h<128?f[h]=h<<1:f[h]=h<<1^283;for(h=0;h<256;h++){let n=m^m<<1^m<<2^m<<3^m<<4;n=n>>>8^n&255^99,e[p]=n,t[n]=p;let s=f[p],h=f[s],g=f[h],_=f[n]*257^n*16843008;r[p]=_<<24|_>>>8,i[p]=_<<16|_>>>16,a[p]=_<<8|_>>>24,o[p]=_,_=g*16843009^h*65537^s*257^p*16843008,c[n]=_<<24|_>>>8,l[n]=_<<16|_>>>16,u[n]=_<<8|_>>>24,d[n]=_,p?(p=s^f[f[f[g^s]]],m^=f[f[m]]):p=m=1}}expandKey(e){let t=this.uint8ArrayToUint32Array_(e),n=!0,r=0;for(;r<t.length&&n;)n=t[r]===this.key[r],r++;if(n)return;this.key=t;let i=this.keySize=t.length;if(i!==4&&i!==6&&i!==8)throw Error(`Invalid aes key size=`+i);let a=this.ksRows=(i+6+1)*4,o,s,c=this.keySchedule=new Uint32Array(a),l=this.invKeySchedule=new Uint32Array(a),u=this.sBox,d=this.rcon,f=this.invSubMix,p=f[0],m=f[1],h=f[2],g=f[3],_,v;for(o=0;o<a;o++){if(o<i){_=c[o]=t[o];continue}v=_,o%i===0?(v=v<<8|v>>>24,v=u[v>>>24]<<24|u[v>>>16&255]<<16|u[v>>>8&255]<<8|u[v&255],v^=d[o/i|0]<<24):i>6&&o%i===4&&(v=u[v>>>24]<<24|u[v>>>16&255]<<16|u[v>>>8&255]<<8|u[v&255]),c[o]=_=(c[o-i]^v)>>>0}for(s=0;s<a;s++)o=a-s,v=s&3?c[o]:c[o-4],s<4||o<=4?l[s]=v:l[s]=p[u[v>>>24]]^m[u[v>>>16&255]]^h[u[v>>>8&255]]^g[u[v&255]],l[s]=l[s]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){let r=this.keySize+6,i=this.invKeySchedule,a=this.invSBox,o=this.invSubMix,s=o[0],c=o[1],l=o[2],u=o[3],d=this.uint8ArrayToUint32Array_(n),f=d[0],p=d[1],m=d[2],h=d[3],g=new Int32Array(e),_=new Int32Array(g.length),v,y,b,ee,te,ne,re,ie,ae,oe,se,ce,le,ue,de=this.networkToHostOrderSwap;for(;t<g.length;){for(ae=de(g[t]),oe=de(g[t+1]),se=de(g[t+2]),ce=de(g[t+3]),te=ae^i[0],ne=ce^i[1],re=se^i[2],ie=oe^i[3],le=4,ue=1;ue<r;ue++)v=s[te>>>24]^c[ne>>16&255]^l[re>>8&255]^u[ie&255]^i[le],y=s[ne>>>24]^c[re>>16&255]^l[ie>>8&255]^u[te&255]^i[le+1],b=s[re>>>24]^c[ie>>16&255]^l[te>>8&255]^u[ne&255]^i[le+2],ee=s[ie>>>24]^c[te>>16&255]^l[ne>>8&255]^u[re&255]^i[le+3],te=v,ne=y,re=b,ie=ee,le+=4;v=a[te>>>24]<<24^a[ne>>16&255]<<16^a[re>>8&255]<<8^a[ie&255]^i[le],y=a[ne>>>24]<<24^a[re>>16&255]<<16^a[ie>>8&255]<<8^a[te&255]^i[le+1],b=a[re>>>24]<<24^a[ie>>16&255]<<16^a[te>>8&255]<<8^a[ne&255]^i[le+2],ee=a[ie>>>24]<<24^a[te>>16&255]<<16^a[ne>>8&255]<<8^a[re&255]^i[le+3],_[t]=de(v^f),_[t+1]=de(ee^p),_[t+2]=de(b^m),_[t+3]=de(y^h),f=ae,p=oe,m=se,h=ce,t+=4}return _.buffer}},EB=16,DB=class{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{let e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(e){}this.subtle===null&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){let{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;let n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?Ide(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((r,i)=>{this.softwareDecrypt(new Uint8Array(e),t,n);let a=this.flush();a?r(a.buffer):i(Error(`[softwareDecrypt] Failed to decrypt data`))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){let{currentIV:r,currentResult:i,remainderData:a}=this;this.logOnce(`JS AES decrypt`),a&&(e=uL(a,e),this.remainderData=null);let o=this.getValidChunk(e);if(!o.length)return null;r&&(n=r);let s=this.softwareDecrypter;s||(s=this.softwareDecrypter=new TB),s.expandKey(t);let c=i;return this.currentResult=s.decrypt(o.buffer,0,n),this.currentIV=tL(o,-16).buffer,c||null}webCryptoDecrypt(e,t,n){let r=this.subtle;return(this.key!==t||!this.fastAesKey)&&(this.key=t,this.fastAesKey=new wB(r,t)),this.fastAesKey.expandKey().then(t=>{if(!r)return Promise.reject(Error(`web crypto not initialized`));this.logOnce(`WebCrypto AES decrypt`);let i=new CB(r,new Uint8Array(n));return i.decrypt(e.buffer,t)}).catch(r=>(q.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,n)))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);let r=this.flush();if(r)return r.buffer;throw Error(`WebCrypto and softwareDecrypt: failed to decrypt data`)}getValidChunk(e){let t=e,n=e.length-e.length%EB;return n!==e.length&&(t=tL(e,0,n),this.remainderData=tL(e,n)),t}logOnce(e){this.logEnabled&&(q.log(`[decrypter]: ${e}`),this.logEnabled=!1)}},OB={toString:function(e){let t=``,n=e.length;for(let r=0;r<n;r++)t+=`[${e.start(r).toFixed(3)}-${e.end(r).toFixed(3)}]`;return t}},J={STOPPED:`STOPPED`,IDLE:`IDLE`,KEY_LOADING:`KEY_LOADING`,FRAG_LOADING:`FRAG_LOADING`,FRAG_LOADING_WAITING_RETRY:`FRAG_LOADING_WAITING_RETRY`,WAITING_TRACK:`WAITING_TRACK`,PARSING:`PARSING`,PARSED:`PARSED`,ENDED:`ENDED`,ERROR:`ERROR`,WAITING_INIT_PTS:`WAITING_INIT_PTS`,WAITING_LEVEL:`WAITING_LEVEL`},kB=class extends yB{constructor(e,t,n,r,i){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=J.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix=``,this.log=void 0,this.warn=void 0,this.playlistType=i,this.logPrefix=r,this.log=q.log.bind(q,`${r}:`),this.warn=q.warn.bind(q,`${r}:`),this.hls=e,this.fragmentLoader=new gB(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new DB(e.config),e.on(G.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);let e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=J.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;let n=t.partList;if(n!=null&&n.length){let e=n[n.length-1],t=xB.isBuffered(this.media,e.start+e.duration/2);return t}let r=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(r)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levels[this.levelLastLoaded])==null?void 0:e.details}}onMediaAttached(e,t){let n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener(`seeking`,this.onvseeking),n.addEventListener(`ended`,this.onvended);let r=this.config;this.levels&&r.autoStartLoad&&this.state===J.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(){let e=this.media;e!=null&&e.ended&&(this.log(`MSE detaching and video ended, reset startPosition`),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener(`seeking`,this.onvseeking),e.removeEventListener(`ended`,this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){let{config:e,fragCurrent:t,media:n,mediaBuffer:r,state:i}=this,a=n?n.currentTime:0,o=xB.bufferInfo(r||n,a,e.maxBufferHole);if(this.log(`media seeking to ${XR(a)?a.toFixed(3):a}, state: ${i}`),this.state===J.ENDED)this.resetLoadingState();else if(t){let n=e.maxFragLookUpTolerance,r=t.start-n,i=t.start+t.duration+n;if(!o.len||i<o.start||r>o.end){let e=a>i;(a<r||e)&&(e&&t.loader&&(this.log(`seeking outside of buffer while fragment load in progress, cancel fragment load`),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(a,1/0,this.playlistType,!0),this.lastCurrentTime=a),!this.loadedmetadata&&!o.len&&(this.nextLoadPosition=this.startPosition=a),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=J.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){let r=t=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${t.part?` p: `+t.part.index:``} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(t)};this._doFragLoad(e,t,n,r).then(t=>{if(!t)return;let n=this.state;if(this.fragContextChanged(e)){(n===J.FRAG_LOADING||!this.fragCurrent&&n===J.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=J.IDLE);return}`payload`in t&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(G.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t)}).catch(t=>{this.state===J.STOPPED||this.state===J.ERROR||(this.warn(t),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;let{fragmentTracker:n}=this,r=n.getState(e);if(r===pB.APPENDING){let t=e.type,r=this.getFwdBufferInfo(this.mediaBuffer,t),i=Math.max(e.duration,r?r.len:this.config.maxBufferLength);this.reduceMaxBufferLength(i)&&n.removeFragment(e)}else ((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===pB.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){let t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,n=null){if(!(e-t))return;let r={startOffset:e,endOffset:t,type:n};this.hls.trigger(G.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(t=>{if(!t||this.fragContextChanged(e)||!this.levels)throw Error(`init load aborted`);return t}).then(t=>{let{hls:n}=this,{payload:r}=t,i=e.decryptdata;if(r&&r.byteLength>0&&i&&i.key&&i.iv&&i.method===`AES-128`){let a=self.performance.now();return this.decrypter.decrypt(new Uint8Array(r),i.key.buffer,i.iv.buffer).catch(t=>{throw n.trigger(G.ERROR,{type:ZR.MEDIA_ERROR,details:K.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t}).then(r=>{let i=self.performance.now();return n.trigger(G.FRAG_DECRYPTED,{frag:e,payload:r,stats:{tstart:a,tdecrypt:i}}),t.payload=r,t})}return t}).then(n=>{let{fragCurrent:r,hls:i,levels:a}=this;if(!a)throw Error(`init load aborted, missing levels`);let o=e.stats;this.state=J.IDLE,t.fragmentError=0,e.data=new Uint8Array(n.payload),o.parsing.start=o.buffering.start=self.performance.now(),o.parsing.end=o.buffering.end=self.performance.now(),n.frag===r&&i.trigger(G.FRAG_BUFFERED,{stats:o,frag:r,part:null,id:e.type}),this.tick()}).catch(t=>{this.state===J.STOPPED||this.state===J.ERROR||(this.warn(t),this.resetFragmentLoading(e))})}fragContextChanged(e){let{fragCurrent:t}=this;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId}fragBufferedComplete(e,t){var n,r,i,a;let o=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${e.type} sn: ${e.sn}${t?` part: `+t.index:``} of ${this.playlistType===Jz.MAIN?`level`:`track`} ${e.level} (frag:[${((n=e.startPTS)==null?NaN:n).toFixed(3)}-${((r=e.endPTS)==null?NaN:r).toFixed(3)}] > buffer:${o?OB.toString(xB.getBuffered(o)):`(detached)`})`),this.state=J.IDLE,o&&(!this.loadedmetadata&&e.type==Jz.MAIN&&o.buffered.length&&((i=this.fragCurrent)==null?void 0:i.sn)===((a=this.fragPrevious)==null?void 0:a.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){let{transmuxer:t}=this;if(!t)return;let{frag:n,part:r,partsLoaded:i}=e,a=!i||i.length===0||i.some(e=>!e),o=new SB(n.level,n.sn,n.stats.chunkCount+1,0,r?r.index:-1,!a);t.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,r){var i;let a=t==null?void 0:t.details;if(!this.levels||!a)throw Error(`frag load aborted, missing level${a?``:` detail`}s`);let o=null;if(e.encrypted&&!((i=e.decryptdata)!=null&&i.key)?(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.logPrefix===`[stream-controller]`?`level`:`track`} ${e.level}`),this.state=J.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger(G.KEY_LOADED,e),this.state===J.KEY_LOADING&&(this.state=J.IDLE),e}),this.hls.trigger(G.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(o=Promise.reject(Error(`frag load aborted, context changed in KEY_LOADING`)))):!e.encrypted&&a.encryptedFragments.length&&this.keyLoader.loadClear(e,a.encryptedFragments),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&e.sn!==`initSegment`){let i=a.partList;if(i&&r){n>e.end&&a.fragmentHint&&(e=a.fragmentHint);let s=this.getNextPart(i,e,n);if(s>-1){let c=i[s];this.log(`Loading part sn: ${e.sn} p: ${c.index} cc: ${e.cc} of playlist [${a.startSN}-${a.endSN}] parts [0-${s}-${i.length-1}] ${this.logPrefix===`[stream-controller]`?`level`:`track`}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=c.start+c.duration,this.state=J.FRAG_LOADING;let l;return l=o?o.then(n=>!n||this.fragContextChanged(n.frag)?null:this.doFragPartsLoad(e,c,t,r)).catch(e=>this.handleFragLoadError(e)):this.doFragPartsLoad(e,c,t,r).catch(e=>this.handleFragLoadError(e)),this.hls.trigger(G.FRAG_LOADING,{frag:e,part:c,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(Error(`frag load aborted, context changed in FRAG_LOADING parts`)):l}else if(!e.url||this.loadedEndOfParts(i,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${a?`of [`+a.startSN+`-`+a.endSN+`] `:``}${this.logPrefix===`[stream-controller]`?`level`:`track`}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),XR(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=J.FRAG_LOADING;let s=this.config.progressive,c;return c=s&&o?o.then(t=>!t||this.fragContextChanged(t==null?void 0:t.frag)?null:this.fragmentLoader.load(e,r)).catch(e=>this.handleFragLoadError(e)):Promise.all([this.fragmentLoader.load(e,s?r:void 0),o]).then(([e])=>(!s&&e&&r&&r(e),e)).catch(e=>this.handleFragLoadError(e)),this.hls.trigger(G.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(Error(`frag load aborted, context changed in FRAG_LOADING`)):c}doFragPartsLoad(e,t,n,r){return new Promise((i,a)=>{var o;let s=[],c=(o=n.details)==null?void 0:o.partList,l=t=>{this.fragmentLoader.loadPart(e,t,r).then(r=>{s[t.index]=r;let a=r.part;this.hls.trigger(G.FRAG_LOADED,r);let o=RL(n,e.sn,t.index+1)||zL(c,e.sn,t.index+1);if(o)l(o);else return i({frag:e,part:a,partsLoaded:s})}).catch(a)};l(t)})}handleFragLoadError(e){if(`data`in e){let t=e.data;e.data&&t.details===K.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(G.ERROR,t)}else this.hls.trigger(G.ERROR,{type:ZR.OTHER_ERROR,details:K.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){let t=this.getCurrentContext(e);if(!t||this.state!==J.PARSING){!this.fragCurrent&&this.state!==J.STOPPED&&this.state!==J.ERROR&&(this.state=J.IDLE);return}let{frag:n,part:r,level:i}=t,a=self.performance.now();n.stats.parsing.end=a,r&&(r.stats.parsing.end=a),this.updateLevelTiming(n,r,i,e.partial)}getCurrentContext(e){let{levels:t,fragCurrent:n}=this,{level:r,sn:i,part:a}=e;if(!(t!=null&&t[r]))return this.warn(`Levels object was unset while buffering fragment ${i} of level ${r}. The current chunk will not be buffered.`),null;let o=t[r],s=a>-1?RL(o,i,a):null,c=s?s.fragment:Tde(o,i,n);return c?(n&&n!==c&&(c.stats=n.stats),{frag:c,part:s,level:o}):null}bufferFragmentData(e,t,n,r,i){var a;if(!e||this.state!==J.PARSING)return;let{data1:o,data2:s}=e,c=o;if(o&&s&&(c=uL(o,s)),!((a=c)!=null&&a.length))return;let l={type:e.type,frag:t,part:n,chunkMeta:r,parent:t.type,data:c};if(this.hls.trigger(G.BUFFER_APPENDING,l),e.dropped&&e.independent&&!n){if(i)return;this.flushBufferGap(t)}}flushBufferGap(e){let t=this.media;if(!t)return;if(!xB.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}let n=t.currentTime,r=xB.bufferInfo(t,n,0),i=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,i*.25),o=Math.max(Math.min(e.start-a,r.end-a),n+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,t){let n=this.getLoadPosition();return XR(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){let{config:{maxBufferHole:r}}=this,i=xB.bufferInfo(e,t,r);if(i.len===0&&i.nextStart!==void 0){let a=this.fragmentTracker.getBufferedFrag(t,n);if(a&&i.nextStart<a.end)return xB.bufferInfo(e,t,Math.max(i.nextStart,r))}return i}getMaxBufferLength(e){let{config:t}=this,n;return n=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e){let t=this.config,n=e||t.maxBufferLength;return t.maxMaxBufferLength>=n?(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0):!1}getAppendedFrag(e,t=Jz.MAIN){let n=this.fragmentTracker.getAppendedFrag(e,Jz.MAIN);return n&&`fragment`in n?n.fragment:n}getNextFragment(e,t){let n=t.fragments,r=n.length;if(!r)return null;let{config:i}=this,a=n[0].start,o;if(t.live){let a=i.initialLiveManifestSize;if(r<a)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${a})`),null;!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(o=this.getInitialLiveFragment(t,n),this.startPosition=o?this.hls.liveSyncPosition||o.start:e)}else e<=a&&(o=n[0]);if(!o){let n=i.lowLatencyMode?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,n,t)}return this.mapToInitFragWhenRequired(o)}isLoopLoading(e,t){let n=this.fragmentTracker.getState(e);return(n===pB.OK||n===pB.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,r,i){let a=e.gap,o=this.getNextFragment(this.nextLoadPosition,t);if(o===null)return o;if(e=o,a&&e&&!e.gap&&n.nextStart){let t=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,r);if(t!==null&&n.len+t.len>=i)return this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let r=-1,i=!1,a=!0;for(let o=0,s=e.length;o<s;o++){let s=e[o];if(a=a&&!s.independent,r>-1&&n<s.start)break;let c=s.loaded;c?r=-1:(i||s.independent||a)&&s.fragment===t&&(r=o),i=c}return r}loadedEndOfParts(e,t){let n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){let n=this.fragPrevious,r=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),r=Dde(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){let i=n.sn+1;if(i>=e.startSN&&i<=e.endSN){let a=t[i-e.startSN];n.cc===a.cc&&(r=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=kde(t,n.cc),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{let t=this.hls.liveSyncPosition;t!==null&&(r=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,n){let{config:r}=this,{fragPrevious:i}=this,{fragments:a,endSN:o}=n,{fragmentHint:s}=n,c=r.maxFragLookUpTolerance,l=n.partList,u=!!(r.lowLatencyMode&&l!=null&&l.length&&s);u&&s&&!this.bitrateTest&&(a=a.concat(s),o=s.sn);let d;if(e<t){let n=e>t-c?0:c;d=GL(i,a,e,n)}else d=a[a.length-1];if(d){let e=d.sn-n.startSN,t=this.fragmentTracker.getState(d);if((t===pB.OK||t===pB.PARTIAL&&d.gap)&&(i=d),i&&d.sn===i.sn&&(!u||l[0].fragment.sn>d.sn)){let t=i&&d.level===i.level;if(t){let t=a[e+1];d=d.sn<o&&this.fragmentTracker.getState(t)!==pB.OK?t:null}}}return d}synchronizeToLiveEdge(e){let{config:t,media:n}=this;if(!n)return;let r=this.hls.liveSyncPosition,i=n.currentTime,a=e.fragments[0].start,o=e.edge,s=i>=a-t.maxFragLookUpTolerance&&i<=o;if(r!==null&&n.duration>r&&(i<r||!s)){let a=t.liveMaxLatencyDuration===void 0?t.liveMaxLatencyDurationCount*e.targetduration:t.liveMaxLatencyDuration;(!s&&n.readyState<4||i<o-a)&&(this.loadedmetadata||(this.nextLoadPosition=r),n.readyState&&(this.warn(`Playback: ${i.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${r.toFixed(3)}`),n.currentTime=r))}}alignPlaylists(e,t){let{levels:n,levelLastLoaded:r,fragPrevious:i}=this,a=r===null?null:n[r],o=e.fragments.length;if(!o)return this.warn(`No fragments in live playlist`),0;let s=e.fragments[0].start,c=!t,l=e.alignedSliding&&XR(s);if(c||!l&&!s){Nde(i,a,e);let n=e.fragments[0].start;return this.log(`Live playlist sliding: ${n.toFixed(2)} start-sn: ${t?t.startSN:`na`}->${e.startSN} prev-sn: ${i?i.sn:`na`} fragments: ${o}`),n}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),n===-1||this.lastCurrentTime===-1){let r=this.startTimeOffset!==null,i=r?this.startTimeOffset:e.startTimeOffset;i!==null&&XR(i)?(n=t+i,i<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${i} found in ${r?`multivariant`:`media`} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){let{media:e}=this,t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!==`initSegment`&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?` part `+t.index:``} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==J.FRAG_LOADING_WAITING_RETRY)&&(this.state=J.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){let e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}let n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var r;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(r=this.fragCurrent)==null?void 0:r.url}`);return}let i=t.details===K.FRAG_GAP;i&&this.fragmentTracker.fragBuffered(n,!0);let a=t.errorAction,{action:o,retryCount:s=0,retryConfig:c}=a||{};if(a&&o===sB.RetryRequest&&c){var l;this.resetStartWhenNotLoaded((l=this.levelLastLoaded)==null?n.level:l);let r=HL(c,s);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${s+1}/${c.maxNumRetry} in ${r}ms`),a.resolved=!0,this.retryDate=self.performance.now()+r,this.state=J.FRAG_LOADING_WAITING_RETRY}else c&&a?(this.resetFragmentErrors(e),s<c.maxNumRetry?i||(a.resolved=!0):q.warn(`${t.details} reached or exceeded max retry (${s})`)):(a==null?void 0:a.action)===sB.SendAlternateToPenaltyBox?this.state=J.WAITING_LEVEL:this.state=J.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===J.PARSING||this.state===J.PARSED){let t=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,t),r=n&&n.len>.5;r&&this.reduceMaxBufferLength(n.len);let i=!r;return i&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),i}return!1}resetFragmentErrors(e){e===Jz.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==J.STOPPED&&(this.state=J.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;let r=xB.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,n),this.state===J.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log(`Reset loading state`),this.fragCurrent=null,this.fragPrevious=null,this.state=J.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;let t=this.levels?this.levels[e].details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){var t;this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded((t=this.levelLastLoaded)==null?e.level:t),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,r){var i;let a=n.details;if(!a){this.warn(`level.details undefined`);return}let o=Object.keys(e.elementaryStreams).reduce((t,i)=>{let o=e.elementaryStreams[i];if(o){let s=o.endPTS-o.startPTS;if(s<=0)return this.warn(`Could not parse fragment ${e.sn} ${i} duration reliably (${s})`),t||!1;let c=r?0:FL(a,e,o.startPTS,o.endPTS,o.startDTS,o.endDTS);return this.hls.trigger(G.LEVEL_PTS_UPDATED,{details:a,level:n,drift:c,type:i,frag:e,start:o.startPTS,end:o.endPTS}),!0}return t},!1);if(o)n.fragmentError=0;else if(((i=this.transmuxer)==null?void 0:i.error)===null){let t=Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(n.fragmentError===0&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(t.message),this.hls.trigger(G.ERROR,{type:ZR.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=J.PARSED,this.hls.trigger(G.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){if(e.event===`demuxerWorker`){var t,n,r;this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded((t=(n=this.levelLastLoaded)==null?(r=this.fragCurrent)==null?void 0:r.level:n)==null?0:t),this.resetLoadingState()}}set state(e){let t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}},AB=class{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,r){this._id3Track={type:`id3`,id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=uL(this.cachedData,e),this.cachedData=null);let n=vz(e,0),r=n?n.length:0,i,a=this._audioTrack,o=this._id3Track,s=n?xz(n):void 0,c=e.length;for((this.basePTS===null||this.frameIndex===0&&XR(s))&&(this.basePTS=jB(s,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Xz.audioId3,duration:1/0});r<c;){if(this.canParse(e,r)){let t=this.appendFrame(a,e,r);t?(this.frameIndex++,this.lastPTS=t.sample.pts,r+=t.length,i=r):r=c}else bz(e,r)?(n=vz(e,r),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Xz.audioId3,duration:1/0}),r+=n.length,i=r):r++;if(r===c&&i!==c){let t=tL(e,i);this.cachedData?this.cachedData=uL(this.cachedData,t):this.cachedData=t}}return{audioTrack:a,videoTrack:aR(),id3Track:o,textTrack:aR()}}demuxSampleAes(e,t,n){return Promise.reject(Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){let t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:aR(),id3Track:this._id3Track,textTrack:aR()}}destroy(){}},jB=(e,t,n)=>{if(XR(e))return e*90;let r=n?n.baseTime*9e4/n.timescale:0;return t*9e4+r},MB=class extends AB{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:`audio/adts`,type:`audio`,id:2,pid:-1,sequenceNumber:0,segmentCodec:`aac`,samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=vz(e,0)||[],n=t.length;for(let t=e.length;n<t;n++)if(Gde(e,n))return q.log(`ADTS sync word found !`),!0;return!1}canParse(e,t){return Wde(e,t)}appendFrame(e,t,n){uR(e,this.observer,t,n,e.manifestCodec);let r=fR(e,t,n,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}},NB=/\/emsg[-/]ID3/i,PB=class{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,r){let i=this.videoTrack=aR(`video`,1),a=this.audioTrack=aR(`audio`,1),o=this.txtTrack=aR(`text`,1);if(this.id3Track=aR(`id3`,1),this.timeOffset=0,!(e!=null&&e.byteLength))return;let s=cL(e);if(s.video){let{id:e,timescale:t,codec:n}=s.video;i.id=e,i.timescale=o.timescale=t,i.codec=n}if(s.audio){let{id:e,timescale:t,codec:n}=s.audio;a.id=e,a.timescale=t,a.codec=n}o.id=Fz.text,i.sampleDuration=0,i.duration=a.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return e=e.length>16384?e.subarray(0,16384):e,sL(e,[`moof`]).length>0}demux(e,t){this.timeOffset=t;let n=e,r=this.videoTrack,i=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=uL(this.remainderData,e));let t=ide(n);this.remainderData=t.remainder,r.samples=t.valid||new Uint8Array}else r.samples=n;let a=this.extractID3Track(r,t);return i.samples=dL(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){let e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;let r=this.extractID3Track(t,this.timeOffset);return n.samples=dL(e,t),{videoTrack:t,audioTrack:aR(),id3Track:r,textTrack:aR()}}extractID3Track(e,t){let n=this.id3Track;if(e.samples.length){let r=sL(e.samples,[`emsg`]);r&&r.forEach(e=>{let r=sde(e);if(NB.test(r.schemeIdUri)){let e=XR(r.presentationTime)?r.presentationTime/r.timeScale:t+r.presentationTimeDelta/r.timeScale,i=r.eventDuration===4294967295?1/0:r.eventDuration/r.timeScale;i<=.001&&(i=1/0);let a=r.payload;n.samples.push({data:a,len:a.byteLength,dts:e,pts:e,type:Xz.emsg,duration:i})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(Error(`The MP4 demuxer does not support SAMPLE-AES decryption`))}destroy(){}},FB=null,IB=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],LB=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],RB=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],zB=[0,1,1,4],BB=class{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){let e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),i=Math.min(4,t);if(i===0)throw Error(`no bytes available`);r.set(e.subarray(n,n+i)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=i*8,this.bytesAvailable-=i}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;if(e>32&&q.error(`Cannot read more than 32 bits at a time`),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw Error(`no bits available`);return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){let e=this.skipLZ();return this.readBits(e+1)-1}readEG(){let e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,n=8,r;for(let i=0;i<e;i++)n!==0&&(r=this.readEG(),n=(t+r+256)%256),t=n===0?t:n}readSPS(){let e=0,t=0,n=0,r=0,i,a,o,s=this.readUByte.bind(this),c=this.readBits.bind(this),l=this.readUEG.bind(this),u=this.readBoolean.bind(this),d=this.skipBits.bind(this),f=this.skipEG.bind(this),p=this.skipUEG.bind(this),m=this.skipScalingList.bind(this);s();let h=s();if(c(5),d(3),s(),p(),h===100||h===110||h===122||h===244||h===44||h===83||h===86||h===118||h===128){let e=l();if(e===3&&d(1),p(),p(),d(1),u())for(a=e===3?12:8,o=0;o<a;o++)u()&&m(o<6?16:64)}p();let g=l();if(g===0)l();else if(g===1)for(d(1),f(),f(),i=l(),o=0;o<i;o++)f();p(),d(1);let _=l(),v=l(),y=c(1);y===0&&d(1),d(1),u()&&(e=l(),t=l(),n=l(),r=l());let b=[1,1];if(u()&&u()){let e=s();switch(e){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:b=[s()<<8|s(),s()<<8|s()];break}}return{width:Math.ceil((_+1)*16-e*2-t*2),height:(2-y)*(v+1)*16-(y?2:4)*(n+r),pixelRatio:b}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}},VB=class{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new DB(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){let r=e[t].unit;if(r.length<=16)return;let i=r.subarray(16,r.length-r.length%16),a=i.buffer.slice(i.byteOffset,i.byteOffset+i.length);this.decryptBuffer(a).then(i=>{let a=new Uint8Array(i);r.set(a,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){let t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t),r=0;for(let t=32;t<e.length-16;t+=160,r+=16)n.set(e.subarray(t,t+16),r);return n}getAvcDecryptedUnit(e,t){let n=new Uint8Array(t),r=0;for(let t=32;t<e.length-16;t+=160,r+=16)e.set(n.subarray(r,r+16),t);return e}decryptAvcSample(e,t,n,r,i){let a=pL(i.data),o=this.getAvcEncryptedData(a);this.decryptBuffer(o.buffer).then(o=>{i.data=this.getAvcDecryptedUnit(a,o),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,r)})}decryptAvcSamples(e,t,n,r){if(e instanceof Uint8Array)throw Error(`Cannot decrypt samples of type Uint8Array`);for(;;t++,n=0){if(t>=e.length){r();return}let i=e[t].units;for(;!(n>=i.length);n++){let a=i[n];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,t,n,r,a),!this.decrypter.isSync()))return}}}},HB=188,UB=class e{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=n}static probe(t){let n=e.syncOffset(t);return n>0&&q.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),n!==-1}static syncOffset(e){let t=e.length,n=Math.min(HB*5,e.length-HB)+1,r=0;for(;r<n;){let i=!1,a=-1,o=0;for(let s=r;s<t;s+=HB)if(e[s]===71){if(o++,a===-1&&(a=s,a!==0&&(n=Math.min(a+HB*99,e.length-HB)+1)),i||(i=vR(e,s)===0),i&&o>1&&(a===0&&o>2||s+HB>n))return a}else if(o)return-1;else break;r++}return-1}static createTrack(e,t){return{container:e===`video`||e===`audio`?`video/mp2t`:void 0,type:e,id:Fz[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e===`audio`?t:void 0}}resetInitSegment(t,n,r,i){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack(`video`),this._audioTrack=e.createTrack(`audio`,i),this._id3Track=e.createTrack(`id3`),this._txtTrack=e.createTrack(`text`),this._audioTrack.segmentCodec=`aac`,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=n,this.videoCodec=r,this._duration=i}resetTimeStamp(){}resetContiguity(){let{_audioTrack:e,_avcTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(t,n,r=!1,i=!1){r||(this.sampleAes=null);let a,o=this._avcTrack,s=this._audioTrack,c=this._id3Track,l=this._txtTrack,u=o.pid,d=o.pesData,f=s.pid,p=c.pid,m=s.pesData,h=c.pesData,g=null,_=this.pmtParsed,v=this._pmtId,y=t.length;if(this.remainderData&&(t=uL(this.remainderData,t),y=t.length,this.remainderData=null),y<HB&&!i)return this.remainderData=t,{audioTrack:s,videoTrack:o,id3Track:c,textTrack:l};let b=Math.max(0,e.syncOffset(t));y-=(y-b)%HB,y<t.byteLength&&!i&&(this.remainderData=new Uint8Array(t.buffer,y,t.buffer.byteLength-y));let ee=0;for(let e=b;e<y;e+=HB)if(t[e]===71){let n=!!(t[e+1]&64),i=vR(t,e),y=(t[e+3]&48)>>4,ee;if(y>1){if(ee=e+5+t[e+4],ee===e+HB)continue}else ee=e+4;switch(i){case u:n&&(d&&(a=yR(d))&&this.parseAVCPES(o,l,a,!1),d={data:[],size:0}),d&&(d.data.push(t.subarray(ee,e+HB)),d.size+=e+HB-ee);break;case f:if(n){if(m&&(a=yR(m)))switch(s.segmentCodec){case`aac`:this.parseAACPES(s,a);break;case`mp3`:this.parseMPEGPES(s,a);break}m={data:[],size:0}}m&&(m.data.push(t.subarray(ee,e+HB)),m.size+=e+HB-ee);break;case p:n&&(h&&(a=yR(h))&&this.parseID3PES(c,a),h={data:[],size:0}),h&&(h.data.push(t.subarray(ee,e+HB)),h.size+=e+HB-ee);break;case 0:n&&(ee+=t[ee]+1),v=this._pmtId=Yde(t,ee);break;case v:{n&&(ee+=t[ee]+1);let i=Xde(t,ee,this.typeSupported,r);u=i.avc,u>0&&(o.pid=u),f=i.audio,f>0&&(s.pid=f,s.segmentCodec=i.segmentCodec),p=i.id3,p>0&&(c.pid=p),g!==null&&!_&&(q.warn(`MPEG-TS PMT found at ${e} after unknown PID '${g}'. Backtracking to sync byte @${b} to parse all TS packets.`),g=null,e=b-188),_=this.pmtParsed=!0;break}case 17:case 8191:break;default:g=i;break}}else ee++;if(ee>0){let e=Error(`Found ${ee} TS packet/s that do not start with 0x47`);this.observer.emit(G.ERROR,G.ERROR,{type:ZR.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message})}o.pesData=d,s.pesData=m,c.pesData=h;let te={audioTrack:s,videoTrack:o,id3Track:c,textTrack:l};return i&&this.extractRemainingSamples(te),te}flush(){let{remainderData:e}=this;this.remainderData=null;let t;return t=e?this.demux(e,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){let{audioTrack:t,videoTrack:n,id3Track:r,textTrack:i}=e,a=n.pesData,o=t.pesData,s=r.pesData,c;if(a&&(c=yR(a))?(this.parseAVCPES(n,i,c,!0),n.pesData=null):n.pesData=a,o&&(c=yR(o))){switch(t.segmentCodec){case`aac`:this.parseAACPES(t,c);break;case`mp3`:this.parseMPEGPES(t,c);break}t.pesData=null}else o!=null&&o.size&&q.log(`last AAC PES packet truncated,might overlap between fragments`),t.pesData=o;s&&(c=yR(s))?(this.parseID3PES(r,c),r.pesData=null):r.pesData=s}demuxSampleAes(e,t,n){let r=this.demux(e,n,!0,!this.config.progressive),i=this.sampleAes=new VB(this.observer,this.config,t);return this.decrypt(r,i)}decrypt(e,t){return new Promise(n=>{let{audioTrack:r,videoTrack:i}=e;r.samples&&r.segmentCodec===`aac`?t.decryptAacSamples(r.samples,0,()=>{i.samples?t.decryptAvcSamples(i.samples,0,0,()=>{n(e)}):n(e)}):i.samples&&t.decryptAvcSamples(i.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAVCPES(e,t,n,r){let i=this.parseAVCNALu(e,n.data),a=this.avcSample,o,s=!1;n.data=null,a&&i.length&&!e.audFound&&(bR(a,e),a=this.avcSample=_R(!1,n.pts,n.dts,``)),i.forEach(r=>{var i;switch(r.type){case 1:{let t=!1;o=!0;let i=r.data;if(s&&i.length>4){let e=new BB(i).readSliceType();(e===2||e===4||e===7||e===9)&&(t=!0)}if(t){var c;(c=a)!=null&&c.frame&&!a.key&&(bR(a,e),a=this.avcSample=null)}a||(a=this.avcSample=_R(!0,n.pts,n.dts,``)),a.frame=!0,a.key=t;break}case 5:o=!0,(i=a)!=null&&i.frame&&!a.key&&(bR(a,e),a=this.avcSample=null),a||(a=this.avcSample=_R(!0,n.pts,n.dts,``)),a.key=!0,a.frame=!0;break;case 6:o=!0,fL(r.data,1,n.pts,t.samples);break;case 7:if(o=!0,s=!0,!e.sps){let t=r.data,n=new BB(t),i=n.readSPS();e.width=i.width,e.height=i.height,e.pixelRatio=i.pixelRatio,e.sps=[t],e.duration=this._duration;let a=t.subarray(1,4),o=`avc1.`;for(let e=0;e<3;e++){let t=a[e].toString(16);t.length<2&&(t=`0`+t),o+=t}e.codec=o}break;case 8:o=!0,e.pps||(e.pps=[r.data]);break;case 9:o=!1,e.audFound=!0,a&&bR(a,e),a=this.avcSample=_R(!1,n.pts,n.dts,``);break;case 12:o=!0;break;default:o=!1,a&&(a.debug+=`unknown NAL `+r.type+` `);break}if(a&&o){let e=a.units;e.push(r)}}),r&&a&&(bR(a,e),this.avcSample=null)}getLastNalUnit(e){var t;let n=this.avcSample,r;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){let e=n.units;r=e[e.length-1]}return r}parseAVCNALu(e,t){let n=t.byteLength,r=e.naluState||0,i=r,a=[],o=0,s,c,l,u=-1,d=0;for(r===-1&&(u=0,d=t[0]&31,r=0,o=1);o<n;){if(s=t[o++],!r){r=s?0:1;continue}if(r===1){r=s?0:2;continue}if(!s)r=3;else if(s===1){if(u>=0){let e={data:t.subarray(u,o-r-1),type:d};a.push(e)}else{let n=this.getLastNalUnit(e.samples);if(n&&(i&&o<=4-i&&n.state&&(n.data=n.data.subarray(0,n.data.byteLength-i)),c=o-r-1,c>0)){let e=new Uint8Array(n.data.byteLength+c);e.set(n.data,0),e.set(t.subarray(0,c),n.data.byteLength),n.data=e,n.state=0}}o<n?(l=t[o]&31,u=o,d=l,r=0):r=-1}else r=0}if(u>=0&&r>=0){let e={data:t.subarray(u,n),type:d,state:r};a.push(e)}if(a.length===0){let n=this.getLastNalUnit(e.samples);if(n){let e=new Uint8Array(n.data.byteLength+t.byteLength);e.set(n.data,0),e.set(t,n.data.byteLength),n.data=e}}return e.naluState=r,a}parseAACPES(e,t){let n=0,r=this.aacOverFlow,i=t.data;if(r){this.aacOverFlow=null;let t=r.missing,a=r.sample.unit.byteLength;if(t===-1){let e=new Uint8Array(a+i.byteLength);e.set(r.sample.unit,0),e.set(i,a),i=e}else{let o=a-t;r.sample.unit.set(i.subarray(0,t),o),e.samples.push(r.sample),n=r.missing}}let a,o;for(a=n,o=i.length;a<o-1&&!lR(i,a);a++);if(a!==n){let e,t=a<o-1;e=t?`AAC PES did not start with ADTS header,offset:${a}`:`No ADTS header found in AAC PES`;let n=Error(e);if(q.warn(`parsing error: ${e}`),this.observer.emit(G.ERROR,G.ERROR,{type:ZR.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:n,reason:e}),!t)return}uR(e,this.observer,i,a,this.audioCodec);let s;if(t.pts!==void 0)s=t.pts;else if(r){let t=dR(e.samplerate);s=r.sample.pts+t}else{q.warn(`[tsdemuxer]: AAC PES unknown PTS`);return}let c=0,l;for(;a<o;)if(l=fR(e,i,a,s,c),a+=l.length,l.missing){this.aacOverFlow=l;break}else for(c++;a<o-1&&!lR(i,a);a++);}parseMPEGPES(e,t){let n=t.data,r=n.length,i=0,a=0,o=t.pts;if(o===void 0){q.warn(`[tsdemuxer]: MPEG PES unknown PTS`);return}for(;a<r;)if(gR(n,a)){let t=pR(e,n,a,o,i);if(t)a+=t.length,i++;else break}else a++}parseID3PES(e,t){if(t.pts===void 0){q.warn(`[tsdemuxer]: ID3 PES unknown PTS`);return}let n=YI({},t,{type:this._avcTrack?Xz.emsg:Xz.audioId3,duration:1/0});e.samples.push(n)}},WB=class extends AB{resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:`audio/mpeg`,type:`audio`,id:2,pid:-1,sequenceNumber:0,segmentCodec:`mp3`,samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=vz(e,0)||[],n=t.length;for(let t=e.length;n<t;n++)if(Jde(e,n))return q.log(`MPEG Audio sync word found !`),!0;return!1}canParse(e,t){return qde(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return pR(e,t,n,this.basePTS,this.frameIndex)}},GB=class{static getSilentFrame(e,t){switch(e){case`mp4a.40.2`:if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2||t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}},KB=2**32-1,qB=class e{static init(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let t;for(t in e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);let n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:n,audio:r};let i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);let o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),c=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,c,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))}static box(e,...t){let n=8,r=t.length,i=r;for(;r--;)n+=t[r].byteLength;let a=new Uint8Array(n);for(a[0]=n>>24&255,a[1]=n>>16&255,a[2]=n>>8&255,a[3]=n&255,a.set(e,4),r=0,n=8;r<i;r++)a.set(t[r],n),n+=t[r].byteLength;return a}static hdlr(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}static mdat(t){return e.box(e.types.mdat,t)}static mdhd(t,n){n*=t;let r=Math.floor(n/(KB+1)),i=Math.floor(n%(KB+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,r>>24,r>>16&255,r>>8&255,r&255,i>>24,i>>16&255,i>>8&255,i&255,85,196,0,0]))}static mdia(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}static mfhd(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))}static minf(t){return t.type===`audio`?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}static moof(t,n,r){return e.box(e.types.moof,e.mfhd(t),e.traf(r,n))}static moov(t){let n=t.length,r=[];for(;n--;)r[n]=e.trak(t[n]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(r,e.mvex(t)))}static mvex(t){let n=t.length,r=[];for(;n--;)r[n]=e.trex(t[n]);return e.box.apply(null,[e.types.mvex,...r])}static mvhd(t,n){n*=t;let r=Math.floor(n/(KB+1)),i=Math.floor(n%(KB+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,r>>24,r>>16&255,r>>8&255,r&255,i>>24,i>>16&255,i>>8&255,i&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,a)}static sdtp(t){let n=t.samples||[],r=new Uint8Array(4+n.length),i,a;for(i=0;i<n.length;i++)a=n[i].flags,r[i+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy;return e.box(e.types.sdtp,r)}static stbl(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}static avc1(t){let n=[],r=[],i,a,o;for(i=0;i<t.sps.length;i++)a=t.sps[i],o=a.byteLength,n.push(o>>>8&255),n.push(o&255),n=n.concat(Array.prototype.slice.call(a));for(i=0;i<t.pps.length;i++)a=t.pps[i],o=a.byteLength,r.push(o>>>8&255),r.push(o&255),r=r.concat(Array.prototype.slice.call(a));let s=e.box(e.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|t.sps.length].concat(n,[t.pps.length],r))),c=t.width,l=t.height,u=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,c&255,l>>8&255,l&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,u&255,d>>24,d>>16&255,d>>8&255,d&255])))}static esds(e){let t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5,t].concat(e.config,[6,1,2]))}static mp4a(t){let n=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,n&255,0,0]),e.box(e.types.esds,e.esds(t)))}static mp3(t){let n=t.samplerate;return e.box(e.types[`.mp3`],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,n&255,0,0]))}static stsd(t){return t.type===`audio`?t.segmentCodec===`mp3`&&t.codec===`mp3`?e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}static tkhd(t){let n=t.id,r=t.duration*t.timescale,i=t.width,a=t.height,o=Math.floor(r/(KB+1)),s=Math.floor(r%(KB+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,n&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,s>>24,s>>16&255,s>>8&255,s&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,i&255,0,0,a>>8&255,a&255,0,0]))}static traf(t,n){let r=e.sdtp(t),i=t.id,a=Math.floor(n/(KB+1)),o=Math.floor(n%(KB+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255])),e.trun(t,r.length+16+20+8+16+8+8),r)}static trak(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}static trex(t){let n=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,n){let r=t.samples||[],i=r.length,a=12+16*i,o=new Uint8Array(a),s,c,l,u,d,f;for(n+=8+a,o.set([t.type===`video`?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,i&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255],0),s=0;s<i;s++)c=r[s],l=c.duration,u=c.size,d=c.flags,f=c.cts,o.set([l>>>24&255,l>>>16&255,l>>>8&255,l&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,d.degradPrio&61440,d.degradPrio&15,f>>>24&255,f>>>16&255,f>>>8&255,f&255],12+16*s);return e.box(e.types.trun,o)}static initSegment(t){e.types||e.init();let n=e.moov(t),r=new Uint8Array(e.FTYP.byteLength+n.byteLength);return r.set(e.FTYP),r.set(n,e.FTYP.byteLength),r}},qB.types=void 0,qB.HDLR_TYPES=void 0,qB.STTS=void 0,qB.STSC=void 0,qB.STCO=void 0,qB.STSZ=void 0,qB.VMHD=void 0,qB.SMHD=void 0,qB.STSD=void 0,qB.FTYP=void 0,qB.DINF=void 0,JB=9e4,YB=10*1e3,XB=1024,ZB=1152,QB=null,$B=null,eV=class{constructor(e,t,n,r=``){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,QB===null){let e=navigator.userAgent||``,t=e.match(/Chrome\/(\d+)/i);QB=t?parseInt(t[1]):0}if($B===null){let e=navigator.userAgent.match(/Safari\/(\d+)/i);$B=e?parseInt(e[1]):0}}destroy(){}resetTimeStamp(e){q.log(`[mp4-remuxer]: initPTS & initDTS reset`),this._initPTS=this._initDTS=e}resetNextTimestamp(){q.log(`[mp4-remuxer]: reset next timestamp`),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){q.log(`[mp4-remuxer]: ISGenerated flag reset`),this.ISGenerated=!1}getVideoStartPts(e){let t=!1,n=e.reduce((e,n)=>{let r=n.pts-e;return r<-4294967296?(t=!0,CR(e,n.pts)):r>0?e:n.pts},e[0].pts);return t&&q.debug(`PTS rollover detected`),n}remux(e,t,n,r,i,a,o,s){let c,l,u,d,f,p,m=i,h=i,g=e.pid>-1,_=t.pid>-1,v=t.samples.length,y=e.samples.length>0,b=o&&v>0||v>1,ee=(!g||y)&&(!_||b)||this.ISGenerated||o;if(ee){this.ISGenerated||(u=this.generateIS(e,t,i,a));let n=this.isVideoContiguous,r=-1,o;if(b&&(r=$de(t.samples),!n&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,r>0){q.warn(`[mp4-remuxer]: Dropped ${r} out of ${v} video samples due to a missing keyframe`);let e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(r),t.dropped+=r,h+=(t.samples[0].pts-e)/t.inputTimeScale,o=h}else r===-1&&(q.warn(`[mp4-remuxer]: No keyframe found out of ${v} video samples`),p=!1);if(this.ISGenerated){if(y&&b){let n=this.getVideoStartPts(t.samples),r=CR(e.samples[0].pts,n)-n,i=r/t.inputTimeScale;m+=Math.max(0,i),h+=Math.max(0,-i)}if(y){if(e.samplerate||(q.warn(`[mp4-remuxer]: regenerate InitSegment as audio detected`),u=this.generateIS(e,t,i,a)),l=this.remuxAudio(e,m,this.isAudioContiguous,a,_||b||s===Jz.AUDIO?h:void 0),b){let r=l?l.endPTS-l.startPTS:0;t.inputTimeScale||(q.warn(`[mp4-remuxer]: regenerate InitSegment as video detected`),u=this.generateIS(e,t,i,a)),c=this.remuxVideo(t,h,n,r)}}else b&&(c=this.remuxVideo(t,h,n,0));c&&(c.firstKeyFrame=r,c.independent=r!==-1,c.firstKeyFramePTS=o)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(f=wR(n,i,this._initPTS,this._initDTS)),r.samples.length&&(d=TR(r,i,this._initPTS))),{audio:l,video:c,initSegment:u,independent:p,text:d,id3:f}}generateIS(e,t,n,r){let i=e.samples,a=t.samples,o=this.typeSupported,s={},c=this._initPTS,l=!c||r,u=`audio/mp4`,d,f,p;if(l&&(d=f=1/0),e.config&&i.length){switch(e.timescale=e.samplerate,e.segmentCodec){case`mp3`:o.mpeg?(u=`audio/mpeg`,e.codec=``):o.mp3&&(e.codec=`mp3`);break}s.audio={id:`audio`,container:u,codec:e.codec,initSegment:e.segmentCodec===`mp3`&&o.mpeg?new Uint8Array:qB.initSegment([e]),metadata:{channelCount:e.channelCount}},l&&(p=e.inputTimeScale,!c||p!==c.timescale?d=f=i[0].pts-Math.round(p*n):l=!1)}if(t.sps&&t.pps&&a.length&&(t.timescale=t.inputTimeScale,s.video={id:`main`,container:`video/mp4`,codec:t.codec,initSegment:qB.initSegment([t]),metadata:{width:t.width,height:t.height}},l))if(p=t.inputTimeScale,!c||p!==c.timescale){let e=this.getVideoStartPts(a),t=Math.round(p*n);f=Math.min(f,CR(a[0].dts,e)-t),d=Math.min(d,e-t)}else l=!1;if(Object.keys(s).length)return this.ISGenerated=!0,l?(this._initPTS={baseTime:d,timescale:p},this._initDTS={baseTime:f,timescale:p}):d=p=void 0,{tracks:s,initPTS:d,timescale:p}}remuxVideo(e,t,n,r){let i=e.inputTimeScale,a=e.samples,o=[],s=a.length,c=this._initPTS,l=this.nextAvcDts,u=8,d=this.videoSampleDuration,f,p,m=1/0,h=-1/0,g=!1;if(!n||l===null){let e=t*i,n=a[0].pts-CR(a[0].dts,a[0].pts);l=e-n}let _=c.baseTime*i/c.timescale;for(let e=0;e<s;e++){let t=a[e];t.pts=CR(t.pts-_,l),t.dts=CR(t.dts-_,l),t.dts<a[e>0?e-1:e].dts&&(g=!0)}g&&a.sort(function(e,t){let n=e.dts-t.dts,r=e.pts-t.pts;return n||r}),f=a[0].dts,p=a[a.length-1].dts;let v=p-f,y=v?Math.round(v/(s-1)):d||e.inputTimeScale/30;if(n){let e=f-l,t=e>y,n=e<-1;if((t||n)&&(t?q.warn(`AVC: ${SR(e,!0)} ms (${e}dts) hole between fragments detected, filling it`):q.warn(`AVC: ${SR(-e,!0)} ms (${e}dts) overlapping between fragments detected`),!n||l>=a[0].pts)){f=l;let t=a[0].pts-e;a[0].dts=f,a[0].pts=t,q.log(`Video: First PTS/DTS adjusted: ${SR(t,!0)}/${SR(f,!0)}, delta: ${SR(e,!0)} ms`)}}f=Math.max(0,f);let b=0,ee=0;for(let e=0;e<s;e++){let t=a[e],n=t.units,r=n.length,i=0;for(let e=0;e<r;e++)i+=n[e].data.length;ee+=i,b+=r,t.length=i,t.dts=Math.max(t.dts,f),m=Math.min(t.pts,m),h=Math.max(t.pts,h)}p=a[s-1].dts;let te=ee+4*b+8,ne;try{ne=new Uint8Array(te)}catch(e){this.observer.emit(G.ERROR,G.ERROR,{type:ZR.MUX_ERROR,details:K.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:te,reason:`fail allocating video mdat ${te}`});return}let re=new DataView(ne.buffer);re.setUint32(0,te),ne.set(qB.types.mdat,4);let ie=!1,ae=1/0,oe=1/0,se=-1/0,ce=-1/0;for(let e=0;e<s;e++){let t=a[e],n=t.units,c=0;for(let e=0,t=n.length;e<t;e++){let t=n[e],r=t.data,i=t.data.byteLength;re.setUint32(u,i),u+=4,ne.set(r,u),u+=i,c+=4+i}let l;if(e<s-1)d=a[e+1].dts-t.dts,l=a[e+1].pts-t.pts;else{let n=this.config,o=e>0?t.dts-a[e-1].dts:y;if(l=e>0?t.pts-a[e-1].pts:y,n.stretchShortVideoTrack&&this.nextAudioPts!==null){let e=Math.floor(n.maxBufferHole*i),a=(r?m+r*i:this.nextAudioPts)-t.pts;a>e?(d=a-o,d<0?d=o:ie=!0,q.log(`[mp4-remuxer]: It is approximately ${a/90} ms to the next segment; using duration ${d/90} ms for the last video frame.`)):d=o}else d=o}let f=Math.round(t.pts-t.dts);ae=Math.min(ae,d),se=Math.max(se,d),oe=Math.min(oe,l),ce=Math.max(ce,l),o.push(new tV(t.key,d,c,f))}if(o.length){if(QB){if(QB<70){let e=o[0].flags;e.dependsOn=2,e.isNonSync=0}}else if($B&&ce-oe<se-ae&&y/se<.025&&o[0].cts===0){q.warn(`Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.`);let e=f;for(let t=0,n=o.length;t<n;t++){let r=e+o[t].duration,i=e+o[t].cts;if(t<n-1){let e=r+o[t+1].cts;o[t].duration=e-i}else o[t].duration=t?o[t-1].duration:y;o[t].cts=0,e=r}}}d=ie||!d?y:d,this.nextAvcDts=l=p+d,this.videoSampleDuration=d,this.isVideoContiguous=!0;let le=qB.moof(e.sequenceNumber++,f,YI({},e,{samples:o})),ue={data1:le,data2:ne,startPTS:m/i,endPTS:(h+d)/i,startDTS:f/i,endDTS:l/i,type:`video`,hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,ue}remuxAudio(e,t,n,r,i){let a=e.inputTimeScale,o=e.samplerate?e.samplerate:a,s=a/o,c=e.segmentCodec===`aac`?XB:ZB,l=c*s,u=this._initPTS,d=e.segmentCodec===`mp3`&&this.typeSupported.mpeg,f=[],p=i!==void 0,m=e.samples,h=d?0:8,g=this.nextAudioPts||-1,_=t*a,v=u.baseTime*a/u.timescale;if(this.isAudioContiguous=n=n||m.length&&g>0&&(r&&Math.abs(_-g)<9e3||Math.abs(CR(m[0].pts-v,_)-g)<20*l),m.forEach(function(e){e.pts=CR(e.pts-v,_)}),!n||g<0){if(m=m.filter(e=>e.pts>=0),!m.length)return;g=i===0?0:r&&!p?Math.max(0,_):m[0].pts}if(e.segmentCodec===`aac`){let t=this.config.maxAudioFramesDrift;for(let n=0,r=g;n<m.length;n++){let i=m[n],o=i.pts,s=o-r,c=Math.abs(1e3*s/a);if(s<=-t*l&&p)n===0&&(q.warn(`Audio frame @ ${(o/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*s/a)} ms.`),this.nextAudioPts=g=r=o);else if(s>=t*l&&c<YB&&p){let t=Math.round(s/l);r=o-t*l,r<0&&(t--,r+=l),n===0&&(this.nextAudioPts=g=r),q.warn(`[mp4-remuxer]: Injecting ${t} audio frame @ ${(r/a).toFixed(3)}s due to ${Math.round(1e3*s/a)} ms gap.`);for(let a=0;a<t;a++){let t=Math.max(r,0),a=GB.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);a||(q.log(`[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead.`),a=i.unit.subarray()),m.splice(n,0,{unit:a,pts:t}),r+=l,n++}}i.pts=r,r+=l}}let y=null,b=null,ee,te=0,ne=m.length;for(;ne--;)te+=m[ne].unit.byteLength;for(let t=0,r=m.length;t<r;t++){let r=m[t],i=r.unit,a=r.pts;if(b!==null){let e=f[t-1];e.duration=Math.round((a-b)/s)}else if(n&&e.segmentCodec===`aac`&&(a=g),y=a,te>0){te+=h;try{ee=new Uint8Array(te)}catch(e){this.observer.emit(G.ERROR,G.ERROR,{type:ZR.MUX_ERROR,details:K.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:te,reason:`fail allocating audio mdat ${te}`});return}if(!d){let e=new DataView(ee.buffer);e.setUint32(0,te),ee.set(qB.types.mdat,4)}}else return;ee.set(i,h);let o=i.byteLength;h+=o,f.push(new tV(!0,c,o,0)),b=a}let re=f.length;if(!re)return;let ie=f[f.length-1];this.nextAudioPts=g=b+s*ie.duration;let ae=d?new Uint8Array:qB.moof(e.sequenceNumber++,y/s,YI({},e,{samples:f}));e.samples=[];let oe=y/a,se=g/a,ce={data1:ae,data2:ee,startPTS:oe,endPTS:se,startDTS:oe,endDTS:se,type:`audio`,hasAudio:!0,hasVideo:!1,nb:re};return this.isAudioContiguous=!0,ce}remuxEmptyAudio(e,t,n,r){let i=e.inputTimeScale,a=e.samplerate?e.samplerate:i,o=i/a,s=this.nextAudioPts,c=this._initDTS,l=c.baseTime*9e4/c.timescale,u=(s===null?r.startDTS*i:s)+l,d=r.endDTS*i+l,f=o*XB,p=Math.ceil((d-u)/f),m=GB.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(q.warn(`[mp4-remuxer]: remux empty Audio`),!m){q.trace(`[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec`);return}let h=[];for(let e=0;e<p;e++){let t=u+e*f;h.push({unit:m,pts:t,dts:t})}return e.samples=h,this.remuxAudio(e,t,n,!1)}},tV=class{constructor(e,t,n,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=r,this.flags=new nV(e)}},nV=class{constructor(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}},rV=class{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,r){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment($ue(e,r)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}let r=this.initData=cL(e);t||(t=ER(r.audio,oz.AUDIO)),n||(n=ER(r.video,oz.VIDEO));let i={};r.audio&&r.video?i.audiovideo={container:`video/mp4`,codec:t+`,`+n,initSegment:e,id:`main`}:r.audio?i.audio={container:`audio/mp4`,codec:t,initSegment:e,id:`audio`}:r.video?i.video={container:`video/mp4`,codec:n,initSegment:e,id:`main`}:q.warn(`[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes.`),this.initTracks=i}remux(e,t,n,r,i,a){var o,s;let{initPTS:c,lastEndTime:l}=this,u={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};XR(l)||(l=this.lastEndTime=i||0);let d=t.samples;if(!(d!=null&&d.length))return u;let f={initPTS:void 0,timescale:1},p=this.initData;if((o=p)!=null&&o.length||(this.generateInitSegment(d),p=this.initData),!((s=p)!=null&&s.length))return q.warn(`[passthrough-remuxer.ts]: Failed to generate initSegment.`),u;this.emitInitSegment&&(f.tracks=this.initTracks,this.emitInitSegment=!1);let m=tde(d,p),h=ede(p,d),g=h===null?i:h;(efe(c,g,i,m)||f.timescale!==c.timescale&&a)&&(f.initPTS=g-i,c&&c.timescale===1&&q.warn(`Adjusting initPTS by ${f.initPTS-c.baseTime}`),this.initPTS=c={baseTime:f.initPTS,timescale:1});let _=e?g-c.baseTime/c.timescale:l,v=_+m;rde(p,d,c.baseTime/c.timescale),m>0?this.lastEndTime=v:(q.warn(`Duration parsed from mp4 should be greater than zero`),this.resetNextTimestamp());let y=!!p.audio,b=!!p.video,ee=``;y&&(ee+=`audio`),b&&(ee+=`video`);let te={data1:d,startPTS:_,startDTS:_,endPTS:v,endDTS:v,type:ee,hasAudio:y,hasVideo:b,nb:1,dropped:0};return u.audio=te.type===`audio`?te:void 0,u.video=te.type===`audio`?void 0:te,u.initSegment=f,u.id3=wR(n,i,c,c),r.samples.length&&(u.text=TR(r,i,c)),u}};try{iV=self.performance.now.bind(self.performance)}catch(e){q.debug(`Unable to use Performance API on this environment`),iV=typeof self<`u`&&self.Date.now}aV=[{demux:PB,remux:rV},{demux:UB,remux:eV},{demux:MB,remux:eV},{demux:WB,remux:eV}],oV=class{constructor(e,t,n,r,i){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=r,this.id=i}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,r){let i=n.transmuxing;i.executeStart=iV();let a=new Uint8Array(e),{currentTransmuxState:o,transmuxConfig:s}=this;r&&(this.currentTransmuxState=r);let{contiguous:c,discontinuity:l,trackSwitch:u,accurateTimeOffset:d,timeOffset:f,initSegmentChange:p}=r||o,{audioCodec:m,videoCodec:h,defaultInitPts:g,duration:_,initSegmentData:v}=s,y=tfe(a,t);if(y&&y.method===`AES-128`){let e=this.getDecrypter();if(e.isSync()){let t=e.softwareDecrypt(a,y.key.buffer,y.iv.buffer),r=n.part>-1;if(r&&(t=e.flush()),!t)return i.executeEnd=iV(),sV(n);a=new Uint8Array(t)}else return this.decryptionPromise=e.webCryptoDecrypt(a,y.key.buffer,y.iv.buffer).then(e=>{let t=this.push(e,null,n);return this.decryptionPromise=null,t}),this.decryptionPromise}let b=this.needsProbing(l,u);if(b){let e=this.configureTransmuxer(a);if(e)return q.warn(`[transmuxer] ${e.message}`),this.observer.emit(G.ERROR,G.ERROR,{type:ZR.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),i.executeEnd=iV(),sV(n)}(l||u||p||b)&&this.resetInitSegment(v,m,h,_,t),(l||p||b)&&this.resetInitialTimestamp(g),c||this.resetContiguity();let ee=this.transmux(a,y,f,d,n),te=this.currentTransmuxState;return te.contiguous=!0,te.discontinuity=!1,te.trackSwitch=!1,i.executeEnd=iV(),ee}flush(e){let t=e.transmuxing;t.executeStart=iV();let{decrypter:n,currentTransmuxState:r,decryptionPromise:i}=this;if(i)return i.then(()=>this.flush(e));let a=[],{timeOffset:o}=r;if(n){let t=n.flush();t&&a.push(this.push(t,null,e))}let{demuxer:s,remuxer:c}=this;if(!s||!c)return t.executeEnd=iV(),[sV(e)];let l=s.flush(o);return DR(l)?l.then(t=>(this.flushRemux(a,t,e),a)):(this.flushRemux(a,l,e),a)}flushRemux(e,t,n){let{audioTrack:r,videoTrack:i,id3Track:a,textTrack:o}=t,{accurateTimeOffset:s,timeOffset:c}=this.currentTransmuxState;q.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?` p: `+n.part:``} of level ${n.level}`);let l=this.remuxer.remux(r,i,a,o,c,s,!0,this.id);e.push({remuxResult:l,chunkMeta:n}),n.transmuxing.executeEnd=iV()}resetInitialTimestamp(e){let{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){let{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,r,i){let{demuxer:a,remuxer:o}=this;!a||!o||(a.resetInitSegment(e,t,n,r),o.resetInitSegment(e,t,n,i))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,r,i){let a;return a=t&&t.method===`SAMPLE-AES`?this.transmuxSampleAes(e,t,n,r,i):this.transmuxUnencrypted(e,n,r,i),a}transmuxUnencrypted(e,t,n,r){let{audioTrack:i,videoTrack:a,id3Track:o,textTrack:s}=this.demuxer.demux(e,t,!1,!this.config.progressive),c=this.remuxer.remux(i,a,o,s,t,n,!1,this.id);return{remuxResult:c,chunkMeta:r}}transmuxSampleAes(e,t,n,r,i){return this.demuxer.demuxSampleAes(e,t,n).then(e=>{let t=this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,n,r,!1,this.id);return{remuxResult:t,chunkMeta:i}})}configureTransmuxer(e){let{config:t,observer:n,typeSupported:r,vendor:i}=this,a;for(let t=0,n=aV.length;t<n;t++)if(aV[t].demux.probe(e)){a=aV[t];break}if(!a)return Error(`Failed to find demuxer by probing fragment data`);let o=this.demuxer,s=this.remuxer,c=a.remux,l=a.demux;(!s||!(s instanceof c))&&(this.remuxer=new c(n,t,r,i)),(!o||!(o instanceof l))&&(this.demuxer=new l(n,t,r),this.probe=l.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new DB(this.config)),e}},sV=e=>({remuxResult:{},chunkMeta:e}),cV=class{constructor(e,t,n,r,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=r,this.defaultInitPts=i||null}},lV=class{constructor(e,t,n,r,i,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=r,this.timeOffset=i,this.initSegmentChange=a}},uV={exports:{}},(function(e){var t=Object.prototype.hasOwnProperty,n=`~`;function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,r,a,o){if(typeof r!=`function`)throw TypeError(`The listener must be a function`);var s=new i(r,a||e,o),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function o(e,t){--e._eventsCount===0?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var e=[],r,i;if(this._eventsCount===0)return e;for(i in r=this._events)t.call(r,i)&&e.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,o=Array(a);i<a;i++)o[i]=r[i].fn;return o},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,a,o){var s=n?n+e:e;if(!this._events[s])return!1;var c=this._events[s],l=arguments.length,u,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,i),!0;case 5:return c.fn.call(c.context,t,r,i,a),!0;case 6:return c.fn.call(c.context,t,r,i,a,o),!0}for(d=1,u=Array(l-1);d<l;d++)u[d-1]=arguments[d];c.fn.apply(c.context,u)}else{var f=c.length,p;for(d=0;d<f;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),l){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,r);break;case 4:c[d].fn.call(c[d].context,t,r,i);break;default:if(!u)for(p=1,u=Array(l-1);p<l;p++)u[p-1]=arguments[p];c[d].fn.apply(c[d].context,u)}}return!0},s.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn===t&&(!i||s.once)&&(!r||s.context===r)&&o(this,a);else{for(var c=0,l=[],u=s.length;c<u;c++)(s[c].fn!==t||i&&!s[c].once||r&&s[c].context!==r)&&l.push(s[c]);l.length?this._events[a]=l.length===1?l[0]:l:o(this,a)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})(uV),dV=uV.exports,fV=Iue(dV),pV=vL()||{isTypeSupported:()=>!1},mV=class{constructor(e,t,n,r){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;let i=e.config;this.hls=e,this.id=t,this.useWorker=!!i.enableWorker,this.onTransmuxComplete=n,this.onFlush=r;let a=(e,t)=>{t=t||{},t.frag=this.frag,t.id=this.id,e===G.ERROR&&(this.error=t.error),this.hls.trigger(e,t)};this.observer=new fV,this.observer.on(G.FRAG_DECRYPTED,a),this.observer.on(G.ERROR,a);let o={mp4:pV.isTypeSupported(`video/mp4`),mpeg:pV.isTypeSupported(`audio/mpeg`),mp3:pV.isTypeSupported(`audio/mp4; codecs="mp3"`)},s=navigator.vendor;if(this.useWorker&&typeof Worker<`u`){let e=i.workerPath||zde();if(e){try{i.workerPath?(q.log(`loading Web Worker ${i.workerPath} for "${t}"`),this.workerContext=Vde(i.workerPath)):(q.log(`injecting Web Worker for "${t}"`),this.workerContext=Bde()),this.onwmsg=e=>this.onWorkerMessage(e);let{worker:e}=this.workerContext;e.addEventListener(`message`,this.onwmsg),e.onerror=e=>{let n=Error(`${e.message}  (${e.filename}:${e.lineno})`);i.enableWorker=!1,q.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(G.ERROR,{type:ZR.OTHER_ERROR,details:K.INTERNAL_EXCEPTION,fatal:!1,event:`demuxerWorker`,error:n})},e.postMessage({cmd:`init`,typeSupported:o,vendor:s,id:t,config:JSON.stringify(i)})}catch(e){q.warn(`Error setting up "${t}" Web Worker, fallback to inline`,e),this.resetWorker(),this.error=null,this.transmuxer=new oV(this.observer,o,i,s,t)}return}}this.transmuxer=new oV(this.observer,o,i,s,t)}resetWorker(){if(this.workerContext){let{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener(`message`,this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{let e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}let e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,r,i,a,o,s,c,l){var u,d;c.transmuxing.start=self.performance.now();let{transmuxer:f}=this,p=a?a.start:i.start,m=i.decryptdata,h=this.frag,g=!(h&&i.cc===h.cc),_=!(h&&c.level===h.level),v=h?c.sn-h.sn:-1,y=this.part?c.part-this.part.index:-1,b=v===0&&c.id>1&&c.id===(h==null?void 0:h.stats.chunkCount),ee=!_&&(v===1||v===0&&(y===1||b&&y<=0)),te=self.performance.now();(_||v||i.stats.parsing.start===0)&&(i.stats.parsing.start=te),a&&(y||!ee)&&(a.stats.parsing.start=te);let ne=!(h&&((u=i.initSegment)==null?void 0:u.url)===((d=h.initSegment)==null?void 0:d.url)),re=new lV(g,ee,s,_,p,ne);if(!ee||g||ne){q.log(`[transmuxer-interface, ${i.type}]: Starting new transmux session for sn: ${c.sn} p: ${c.part} level: ${c.level} id: ${c.id}
        discontinuity: ${g}
        trackSwitch: ${_}
        contiguous: ${ee}
        accurateTimeOffset: ${s}
        timeOffset: ${p}
        initSegmentChange: ${ne}`);let e=new cV(n,r,t,o,l);this.configureTransmuxer(e)}if(this.frag=i,this.part=a,this.workerContext)this.workerContext.worker.postMessage({cmd:`demux`,data:e,decryptdata:m,chunkMeta:c,state:re},e instanceof ArrayBuffer?[e]:[]);else if(f){let t=f.push(e,m,c,re);DR(t)?(f.async=!0,t.then(e=>{this.handleTransmuxComplete(e)}).catch(e=>{this.transmuxerError(e,c,`transmuxer-interface push error`)})):(f.async=!1,this.handleTransmuxComplete(t))}}flush(e){e.transmuxing.start=self.performance.now();let{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:`flush`,chunkMeta:e});else if(t){let n=t.flush(e),r=DR(n);r||t.async?(DR(n)||(n=Promise.resolve(n)),n.then(t=>{this.handleFlushResult(t,e)}).catch(t=>{this.transmuxerError(t,e,`transmuxer-interface flush error`)})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(G.ERROR,{type:ZR.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(e=>{this.handleTransmuxComplete(e)}),this.onFlush(t)}onWorkerMessage(e){let t=e.data,n=this.hls;switch(t.event){case`init`:{var r;let e=(r=this.workerContext)==null?void 0:r.objectURL;e&&self.URL.revokeObjectURL(e);break}case`transmuxComplete`:this.handleTransmuxComplete(t.data);break;case`flush`:this.onFlush(t.data);break;case`workerLog`:q[t.data.logType]&&q[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}}configureTransmuxer(e){let{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:`configure`,config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}},hV=250,gV=2,_V=.1,vV=.05,yV=class{constructor(e,t,n,r){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=r}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){let{config:n,media:r,stalled:i}=this;if(r===null)return;let{currentTime:a,seeking:o}=r,s=this.seeking&&!o,c=!this.seeking&&o;if(this.seeking=o,a!==e){if(this.moved=!0,i!==null){if(this.stallReported){let e=self.performance.now()-i;q.warn(`playback not stuck anymore @${a}, after ${Math.round(e)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(c||s){this.stalled=null;return}if(r.paused&&!o||r.ended||r.playbackRate===0||!xB.getBuffered(r).length)return;let l=xB.bufferInfo(r,a,0),u=l.len>0,d=l.nextStart||0;if(!u&&!d)return;if(o){let e=l.len>gV,n=!d||t&&t.start<=a||d-a>gV&&!this.fragmentTracker.getPartialFragment(a);if(e||n)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var f;let e=Math.max(d,l.start||0)-a,t=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,n=t==null||(f=t.details)==null?void 0:f.live,r=n?t.details.targetduration*2:gV,i=this.fragmentTracker.getPartialFragment(a);if(e>0&&(e<=r||i)){this._trySkipBufferHole(i);return}}let p=self.performance.now();if(i===null){this.stalled=p;return}let m=p-i;if(!o&&m>=hV&&(this._reportStall(l),!this.media))return;let h=xB.bufferInfo(r,a,n.maxBufferHole);this._tryFixBufferStall(h,m)}_tryFixBufferStall(e,t){let{config:n,fragmentTracker:r,media:i}=this;if(i===null)return;let a=i.currentTime,o=r.getPartialFragment(a);if(o){let e=this._trySkipBufferHole(o);if(e||!this.media)return}(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-a<n.maxBufferHole)&&t>n.highBufferWatchdogPeriod*1e3&&(q.warn(`Trying to nudge playhead over buffer-hole`),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){let{hls:t,media:n,stallReported:r}=this;if(!r&&n){this.stallReported=!0;let r=Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);q.warn(r.message),t.trigger(G.ERROR,{type:ZR.MEDIA_ERROR,details:K.BUFFER_STALLED_ERROR,fatal:!1,error:r,buffer:e.len})}}_trySkipBufferHole(e){let{config:t,hls:n,media:r}=this;if(r===null)return 0;let i=r.currentTime,a=xB.bufferInfo(r,i,0),o=i<a.start?a.start:a.nextStart;if(o){let s=a.len<=t.maxBufferHole,c=a.len>0&&a.len<1&&r.readyState<3,l=o-i;if(l>0&&(s||c)){if(l>t.maxBufferHole){let{fragmentTracker:t}=this,n=!1;if(i===0){let e=t.getAppendedFrag(0,Jz.MAIN);e&&o<e.end&&(n=!0)}if(!n){let n=e||t.getAppendedFrag(i,Jz.MAIN);if(n){let e=!1,r=n.end;for(;r<o;){let n=t.getPartialFragment(r);if(n)r+=n.duration;else{e=!0;break}}if(e)return 0}}}let a=Math.max(o+vV,i+_V);if(q.warn(`skipping hole, adjusting currentTime from ${i} to ${a}`),this.moved=!0,this.stalled=null,r.currentTime=a,e&&!e.gap){let t=Error(`fragment loaded with buffer holes, seeking from ${i} to ${a}`);n.trigger(G.ERROR,{type:ZR.MEDIA_ERROR,details:K.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:t,reason:t.message,frag:e})}return a}}return 0}_tryNudgeBuffer(){let{config:e,hls:t,media:n,nudgeRetry:r}=this;if(n===null)return;let i=n.currentTime;if(this.nudgeRetry++,r<e.nudgeMaxRetry){let a=i+(r+1)*e.nudgeOffset,o=Error(`Nudging 'currentTime' from ${i} to ${a}`);q.warn(o.message),n.currentTime=a,t.trigger(G.ERROR,{type:ZR.MEDIA_ERROR,details:K.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1})}else{let n=Error(`Playhead still not moving while enough data buffered @${i} after ${e.nudgeMaxRetry} nudges`);q.error(n.message),t.trigger(G.ERROR,{type:ZR.MEDIA_ERROR,details:K.BUFFER_STALLED_ERROR,error:n,fatal:!0})}}},bV=100,xV=class extends kB{constructor(e,t,n){super(e,t,n,`[stream-controller]`,Jz.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){let{hls:e}=this;e.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.MANIFEST_PARSED,this.onManifestParsed,this),e.on(G.LEVEL_LOADING,this.onLevelLoading,this),e.on(G.LEVEL_LOADED,this.onLevelLoaded,this),e.on(G.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(G.ERROR,this.onError,this),e.on(G.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(G.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(G.BUFFER_CREATED,this.onBufferCreated,this),e.on(G.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(G.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(G.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let{hls:e}=this;e.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.MANIFEST_PARSED,this.onManifestParsed,this),e.off(G.LEVEL_LOADED,this.onLevelLoaded,this),e.off(G.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(G.ERROR,this.onError,this),e.off(G.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(G.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(G.BUFFER_CREATED,this.onBufferCreated,this),e.off(G.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(G.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(G.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(e){if(this.levels){let{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(bV),this.level=-1,!this.startFragRequested){let e=n.startLevel;e===-1&&(n.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=n.nextAutoLevel),this.level=n.nextLoadLevel=e,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=J.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=J.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case J.WAITING_LEVEL:{var e;let{levels:t,level:n}=this,r=t==null||(e=t[n])==null?void 0:e.details;if(r&&(!r.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(r))break;this.state=J.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=J.IDLE;break}break}case J.FRAG_LOADING_WAITING_RETRY:{var t;let e=self.performance.now(),n=this.retryDate;(!n||e>=n||(t=this.media)!=null&&t.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=J.IDLE)}break}this.state===J.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){let{hls:e,levelLastLoaded:t,levels:n,media:r}=this,{config:i,nextLoadLevel:a}=e;if(t===null||!r&&(this.startFragRequested||!i.startFragPrefetch)||this.altAudio&&this.audioOnly||!(n!=null&&n[a]))return;let o=n[a],s=this.getMainFwdBufferInfo();if(s===null)return;let c=this.getLevelDetails();if(c&&this._streamEnded(s,c)){let e={};this.altAudio&&(e.type=`video`),this.hls.trigger(G.BUFFER_EOS,e),this.state=J.ENDED;return}e.loadLevel!==a&&e.manualLevel===-1&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=e.nextLoadLevel=a;let l=o.details;if(!l||this.state===J.WAITING_LEVEL||l.live&&this.levelLastLoaded!==a){this.level=a,this.state=J.WAITING_LEVEL;return}let u=s.len,d=this.getMaxBufferLength(o.maxBitrate);if(u>=d)return;this.backtrackFragment&&this.backtrackFragment.start>s.end&&(this.backtrackFragment=null);let f=this.backtrackFragment?this.backtrackFragment.start:s.end,p=this.getNextFragment(f,l);if(this.couldBacktrack&&!this.fragPrevious&&p&&p.sn!==`initSegment`&&this.fragmentTracker.getState(p)!==pB.OK){var m;let e=((m=this.backtrackFragment)==null?p:m).sn,t=e-l.startSN,n=l.fragments[t-1];n&&p.cc===n.cc&&(p=n,this.fragmentTracker.removeFragment(n))}else this.backtrackFragment&&s.len&&(this.backtrackFragment=null);if(p&&this.isLoopLoading(p,f)){let e=p.gap;if(!e){let e=this.audioOnly&&!this.altAudio?oz.AUDIO:oz.VIDEO,t=(e===oz.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,Jz.MAIN)}p=this.getNextFragmentLoopLoading(p,l,s,Jz.MAIN,d)}p&&(p.initSegment&&!p.initSegment.data&&!this.bitrateTest&&(p=p.initSegment),this.loadFragment(p,o,f))}loadFragment(e,t,n){let r=this.fragmentTracker.getState(e);this.fragCurrent=e,r===pB.NOT_LOADED||r===pB.PARTIAL?e.sn===`initSegment`?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Jz.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,1/0)}nextLevelSwitch(){let{levels:e,media:t}=this;if(t!=null&&t.readyState){let n,r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);let i=this.getLevelDetails();if(i!=null&&i.live){let e=this.getMainFwdBufferInfo();if(!e||e.len<i.targetduration*2)return}if(!t.paused&&e){let t=this.hls.nextLoadLevel,r=e[t],i=this.fragLastKbps;n=i&&this.fragCurrent?this.fragCurrent.duration*r.maxBitrate/(1e3*i)+1:0}else n=0;let a=this.getBufferedFrag(t.currentTime+n);if(a){let e=this.followingBufferedFrag(a);if(e){this.abortCurrentFrag();let t=e.maxStartPTS?e.maxStartPTS:e.start,n=e.duration,r=Math.max(a.end,t+Math.min(Math.max(n-this.config.maxFragLookUpTolerance,n*.5),n*.75));this.flushMainBuffer(r,1/0)}}}}abortCurrentFrag(){let e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case J.KEY_LOADING:case J.FRAG_LOADING:case J.FRAG_LOADING_WAITING_RETRY:case J.PARSING:case J.PARSED:this.state=J.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?`video`:null)}onMediaAttached(e,t){super.onMediaAttached(e,t);let n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener(`playing`,this.onvplaying),n.addEventListener(`seeked`,this.onvseeked),this.gapController=new yV(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){let{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener(`playing`,this.onvplaying),e.removeEventListener(`seeked`,this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){let e=this.media,t=e?e.currentTime:null;XR(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);let n=this.getMainFwdBufferInfo();if(n===null||n.len===0){this.warn(`Main forward buffer length on "seeked" event ${n?n.len:`empty`})`);return}this.tick()}onManifestLoading(){this.log(`Trigger BUFFER_RESET`),this.hls.trigger(G.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(e,t){let n=!1,r=!1,i;t.levels.forEach(e=>{i=e.audioCodec,i&&(i.indexOf(`mp4a.40.2`)!==-1&&(n=!0),i.indexOf(`mp4a.40.5`)!==-1&&(r=!0))}),this.audioCodecSwitch=n&&r&&!Rde(),this.audioCodecSwitch&&this.log(`Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC`),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){let{levels:n}=this;if(!n||this.state!==J.IDLE)return;let r=n[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(r.details))&&(this.state=J.WAITING_LEVEL)}onLevelLoaded(e,t){var n;let{levels:r}=this,i=t.level,a=t.details,o=a.totalduration;if(!r){this.warn(`Levels were reset while loading level ${i}`);return}this.log(`Level ${i} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:``}, cc [${a.startCC}, ${a.endCC}] duration:${o}`);let s=r[i],c=this.fragCurrent;c&&(this.state===J.FRAG_LOADING||this.state===J.FRAG_LOADING_WAITING_RETRY)&&(c.level!==t.level||c.urlId!==s.urlId)&&c.loader&&this.abortCurrentFrag();let l=0;if(a.live||(n=s.details)!=null&&n.live){if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;l=this.alignPlaylists(a,s.details)}if(s.details=a,this.levelLastLoaded=i,this.hls.trigger(G.LEVEL_UPDATED,{details:a,level:i}),this.state===J.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=J.IDLE}this.startFragRequested?a.live&&this.synchronizeToLiveEdge(a):this.setStartPosition(a,l),this.tick()}_handleFragmentLoadProgress(e){var t;let{frag:n,part:r,payload:i}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}let o=a[n.level],s=o.details;if(!s){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}let c=o.videoCodec,l=s.PTSKnown||!s.live,u=(t=n.initSegment)==null?void 0:t.data,d=this._getAudioCodec(o),f=this.transmuxer=this.transmuxer||new mV(this.hls,Jz.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),p=r?r.index:-1,m=p!==-1,h=new SB(n.level,n.sn,n.stats.chunkCount,i.byteLength,p,m),g=this.initPTS[n.cc];f.push(i,u,d,c,n,r,s.totalduration,l,h,g)}onAudioTrackSwitching(e,t){let n=this.altAudio,r=!!t.url;if(!r){if(this.mediaBuffer!==this.media){this.log(`Switching on main audio, use media.buffered to schedule main fragment loading`),this.mediaBuffer=this.media;let e=this.fragCurrent;e&&(this.log(`Switching to main audio track, cancel main fragment load`),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();let e=this.hls;n&&(e.trigger(G.BUFFER_FLUSHING,{startOffset:0,endOffset:1/0,type:null}),this.fragmentTracker.removeAllFragments()),e.trigger(G.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){let n=t.id,r=!!this.hls.audioTracks[n].url;if(r){let e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log(`Switching on alternate audio, use video.buffered to schedule main fragment loading`),this.mediaBuffer=e)}this.altAudio=r,this.tick()}onBufferCreated(e,t){let n=t.tracks,r,i,a=!1;for(let e in n){let t=n[e];if(t.id===`main`){if(i=e,r=t,e===`video`){let t=n[e];t&&(this.videoBuffer=t.buffer)}}else a=!0}a&&r?(this.log(`Alternate track found, use ${i}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){let{frag:n,part:r}=t;if(n&&n.type!==Jz.MAIN)return;if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?` p: `+r.index:``} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===J.PARSED&&(this.state=J.IDLE);return}let i=r?r.stats:n.stats;this.fragLastKbps=Math.round(8*i.total/(i.buffering.end-i.loading.first)),n.sn!==`initSegment`&&(this.fragPrevious=n),this.fragBufferedComplete(n,r)}onError(e,t){var n;if(t.fatal){this.state=J.ERROR;return}switch(t.details){case K.FRAG_GAP:case K.FRAG_PARSING_ERROR:case K.FRAG_DECRYPT_ERROR:case K.FRAG_LOAD_ERROR:case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_ERROR:case K.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Jz.MAIN,t);break;case K.LEVEL_LOAD_ERROR:case K.LEVEL_LOAD_TIMEOUT:case K.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===J.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===qz.LEVEL&&(this.state=J.IDLE);break;case K.BUFFER_FULL_ERROR:if(!t.parent||t.parent!==`main`)return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,1/0);break;case K.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){let{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!xB.getBuffered(e).length){let e=this.state===J.IDLE?null:this.fragCurrent;t.poll(this.lastCurrentTime,e)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=J.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==oz.AUDIO||this.audioOnly&&!this.altAudio){let e=(t===oz.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(e,t,Jz.MAIN)}}onLevelsUpdated(e,t){this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){let{media:e}=this;if(!e)return;let t=e.currentTime,n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}let r=xB.getBuffered(e),i=r.length?r.start(0):0,a=i-n;a>0&&(a<this.config.maxBufferHole||a<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${a} to match buffer start`),n+=a,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log(`Swapping audio codec`),t=t.indexOf(`mp4a.40.5`)===-1?`mp4a.40.5`:`mp4a.40.2`),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{let{hls:r}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=J.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;let i=e.stats;i.parsing.start=i.parsing.end=i.buffering.start=i.buffering.end=self.performance.now(),r.trigger(G.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;let n=`main`,{hls:r}=this,{remuxResult:i,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}let{frag:s,part:c,level:l}=o,{video:u,text:d,id3:f,initSegment:p}=i,{details:m}=l,h=this.altAudio?void 0:i.audio;if(this.fragContextChanged(s)){this.fragmentTracker.removeFragment(s);return}if(this.state=J.PARSING,p){if(p!=null&&p.tracks){let e=s.initSegment||s;this._bufferInitSegment(l,p.tracks,e,a),r.trigger(G.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:p.tracks})}let e=p.initPTS,t=p.timescale;XR(e)&&(this.initPTS[s.cc]={baseTime:e,timescale:t},r.trigger(G.INIT_PTS_FOUND,{frag:s,id:n,initPTS:e,timescale:t}))}if(u&&m&&s.sn!==`initSegment`){let e=m.fragments[s.sn-1-m.startSN],t=s.sn===m.startSN,n=!e||s.cc>e.cc;if(i.independent!==!1){let{startPTS:e,endPTS:r,startDTS:i,endDTS:o}=u;if(c)c.elementaryStreams[u.type]={startPTS:e,endPTS:r,startDTS:i,endDTS:o};else if(u.firstKeyFrame&&u.independent&&a.id===1&&!n&&(this.couldBacktrack=!0),u.dropped&&u.independent){let i=this.getMainFwdBufferInfo(),a=(i?i.end:this.getLoadPosition())+this.config.maxBufferHole,c=u.firstKeyFramePTS?u.firstKeyFramePTS:e;if(!t&&a<c-this.config.maxBufferHole&&!n){this.backtrack(s);return}else n&&(s.gap=!0);s.setElementaryStreamInfo(u.type,s.start,r,s.start,o,!0)}s.setElementaryStreamInfo(u.type,e,r,i,o),this.backtrackFragment&&(this.backtrackFragment=s),this.bufferFragmentData(u,s,c,a,t||n)}else if(t||n)s.gap=!0;else{this.backtrack(s);return}}if(h){let{startPTS:e,endPTS:t,startDTS:n,endDTS:r}=h;c&&(c.elementaryStreams[oz.AUDIO]={startPTS:e,endPTS:t,startDTS:n,endDTS:r}),s.setElementaryStreamInfo(oz.AUDIO,e,t,n,r),this.bufferFragmentData(h,s,c,a)}if(m&&f!=null&&(t=f.samples)!=null&&t.length){let e={id:n,frag:s,details:m,samples:f.samples};r.trigger(G.FRAG_PARSING_METADATA,e)}if(m&&d){let e={id:n,frag:s,details:m,samples:d.samples};r.trigger(G.FRAG_PARSING_USERDATA,e)}}_bufferInitSegment(e,t,n,r){if(this.state!==J.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;let{audio:i,video:a,audiovideo:o}=t;if(i){let t=e.audioCodec,n=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(t&&(t=t.indexOf(`mp4a.40.5`)===-1?`mp4a.40.5`:`mp4a.40.2`),i.metadata.channelCount!==1&&n.indexOf(`firefox`)===-1&&(t=`mp4a.40.5`)),n.indexOf(`android`)!==-1&&i.container!==`audio/mpeg`&&(t=`mp4a.40.2`,this.log(`Android: force audio codec to ${t}`)),e.audioCodec&&e.audioCodec!==t&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${t}"`),i.levelCodec=t,i.id=`main`,this.log(`Init audio buffer, container:${i.container}, codecs[selected/level/parsed]=[${t||``}/${e.audioCodec||``}/${i.codec}]`)}a&&(a.levelCodec=e.videoCodec,a.id=`main`,this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||``}/${a.codec}]`)),o&&this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.attrs.CODECS||``}/${o.codec}]`),this.hls.trigger(G.BUFFER_CODECS,t),Object.keys(t).forEach(e=>{let i=t[e],a=i.initSegment;a!=null&&a.byteLength&&this.hls.trigger(G.BUFFER_APPENDING,{type:e,data:a,frag:n,part:null,chunkMeta:r,parent:n.type})}),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Jz.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=J.IDLE}checkFragmentChanged(){let e=this.media,t=null;if(e&&e.readyState>1&&e.seeking===!1){let n=e.currentTime;if(xB.isBuffered(e,n)?t=this.getAppendedFrag(n):xB.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;let e=this.fragPlaying,n=t.level;(!e||t.sn!==e.sn||e.level!==n||t.urlId!==e.urlId)&&(this.fragPlaying=t,this.hls.trigger(G.FRAG_CHANGED,{frag:t}),(!e||e.level!==n)&&this.hls.trigger(G.LEVEL_SWITCHED,{level:n}))}}}get nextLevel(){let e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){let e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){let e=this.media;if(e){let t=e.currentTime,n=this.currentFrag;if(n&&XR(t)&&XR(n.programDateTime)){let e=n.programDateTime+(t-n.start)*1e3;return new Date(e)}}return null}get currentLevel(){let e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){let e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}},SV=class{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){let n=this.alpha_**+e;this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){let e=1-this.alpha_**+this.totalWeight_;if(e)return this.estimate_/e}return this.estimate_}},CV=class{constructor(e,t,n,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new SV(e),this.fast_=new SV(t),this.defaultTTFB_=r,this.ttfb_=new SV(e)}update(e,t){let{slow_:n,fast_:r,ttfb_:i}=this;n.halfLife!==e&&(this.slow_=new SV(e,n.getEstimate(),n.getTotalWeight())),r.halfLife!==t&&(this.fast_=new SV(t,r.getEstimate(),r.getTotalWeight())),i.halfLife!==e&&(this.ttfb_=new SV(e,i.getEstimate(),i.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);let n=8*t,r=e/1e3,i=n/r;this.fast_.sample(r,i),this.slow_.sample(r,i)}sampleTTFB(e){let t=e/1e3,n=Math.sqrt(2)*Math.exp(-(t**2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}},wV=class{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;let t=e.config;this.bwEstimator=new CV(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){let{hls:e}=this;e.on(G.FRAG_LOADING,this.onFragLoading,this),e.on(G.FRAG_LOADED,this.onFragLoaded,this),e.on(G.FRAG_BUFFERED,this.onFragBuffered,this),e.on(G.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(G.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){let{hls:e}=this;e.off(G.FRAG_LOADING,this.onFragLoading,this),e.off(G.FRAG_LOADED,this.onFragLoaded,this),e.off(G.FRAG_BUFFERED,this.onFragBuffered,this),e.off(G.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(G.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(e,t){var n;let r=t.frag;this.ignoreFragment(r)||(this.fragCurrent=r,this.partCurrent=(n=t.part)==null?null:n,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(e,t){this.clearTimer()}getTimeToLoadFrag(e,t,n,r){let i=e+n/t,a=r?this.lastLevelLoadSec:0;return i+a}onLevelLoaded(e,t){let n=this.hls.config,{total:r,bwEstimate:i}=t.stats;XR(r)&&XR(i)&&(this.lastLevelLoadSec=8*r/i),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}_abandonRulesCheck(){let{fragCurrent:e,partCurrent:t,hls:n}=this,{autoLevelEnabled:r,media:i}=n;if(!e||!i)return;let a=performance.now(),o=t?t.stats:e.stats,s=t?t.duration:e.duration,c=a-o.loading.start;if(o.aborted||o.loaded&&o.loaded===o.total||e.level===0){this.clearTimer(),this._nextAutoLevel=-1;return}if(!r||i.paused||!i.playbackRate||!i.readyState)return;let l=n.mainForwardBufferInfo;if(l===null)return;let u=this.bwEstimator.getEstimateTTFB(),d=Math.abs(i.playbackRate);if(c<=Math.max(u,1e3*(s/(d*2))))return;let f=l.len/d;if(f>=2*s/d)return;let p=o.loading.first?o.loading.first-o.loading.start:-1,m=o.loaded&&p>-1,h=this.bwEstimator.getEstimate(),{levels:g,minAutoLevel:_}=n,v=g[e.level],y=o.total||Math.max(o.loaded,Math.round(s*v.maxBitrate/8)),b=c-p;b<1&&m&&(b=Math.min(c,o.loaded*8/h));let ee=m?o.loaded*1e3/b:0,te=ee?(y-o.loaded)/ee:y*8/h+u/1e3;if(te<=f)return;let ne=ee?ee*8:h,re=1/0,ie;for(ie=e.level-1;ie>_;ie--){let e=g[ie].maxBitrate;if(re=this.getTimeToLoadFrag(u/1e3,ne,s*e,!g[ie].details),re<f)break}re>=te||re>s*10||(n.nextLoadLevel=ie,m?this.bwEstimator.sample(c-Math.min(u,p),o.loaded):this.bwEstimator.sampleTTFB(c),this.clearTimer(),q.warn(`[abr] Fragment ${e.sn}${t?` part `+t.index:``} of level ${e.level} is loading too slowly;
      Time to underbuffer: ${f.toFixed(3)} s
      Estimated load time for current fragment: ${te.toFixed(3)} s
      Estimated load time for down switch fragment: ${re.toFixed(3)} s
      TTFB estimate: ${p}
      Current BW estimate: ${XR(h)?(h/1024).toFixed(3):`Unknown`} Kb/s
      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s
      Aborting and switching to level ${ie}`),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),n.trigger(G.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:o}))}onFragLoaded(e,{frag:t,part:n}){let r=n?n.stats:t.stats;if(t.type===Jz.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){let e=n?n.duration:t.duration,i=this.hls.levels[t.level],a=(i.loaded?i.loaded.bytes:0)+r.loaded,o=(i.loaded?i.loaded.duration:0)+e;i.loaded={bytes:a,duration:o},i.realBitrate=Math.round(8*a/o)}if(t.bitrateTest){let e={stats:r,frag:t,part:n,id:t.type};this.onFragBuffered(G.FRAG_BUFFERED,e),t.bitrateTest=!1}}}onFragBuffered(e,t){let{frag:n,part:r}=t,i=r!=null&&r.stats.loaded?r.stats:n.stats;if(i.aborted||this.ignoreFragment(n))return;let a=i.parsing.end-i.loading.start-Math.min(i.loading.first-i.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,i.loaded),i.bwEstimate=this.bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Jz.MAIN||e.sn===`initSegment`}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){let e=this._nextAutoLevel,t=this.bwEstimator;if(e!==-1&&!t.canEstimate())return e;let n=this.getNextABRAutoLevel();if(e!==-1){let t=this.hls.levels;if(t.length>Math.max(e,n)&&t[e].loadError<=t[n].loadError)return e}return e!==-1&&(n=Math.min(e,n)),n}getNextABRAutoLevel(){let{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:r,config:i,minAutoLevel:a,media:o}=n,s=t?t.duration:e?e.duration:0,c=o&&o.playbackRate!==0?Math.abs(o.playbackRate):1,l=this.bwEstimator?this.bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,u=n.mainForwardBufferInfo,d=(u?u.len:0)/c,f=this.findBestLevel(l,a,r,d,i.abrBandWidthFactor,i.abrBandWidthUpFactor);if(f>=0)return f;q.trace(`[abr] ${d?`rebuffering expected`:`buffer is empty`}, finding optimal quality level`);let p=s?Math.min(s,i.maxStarvationDelay):i.maxStarvationDelay,m=i.abrBandWidthFactor,h=i.abrBandWidthUpFactor;if(!d){let e=this.bitrateTestDelay;if(e){let t=s?Math.min(s,i.maxLoadingDelay):i.maxLoadingDelay;p=t-e,q.trace(`[abr] bitrate test took ${Math.round(1e3*e)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),m=h=1}}return f=this.findBestLevel(l,a,r,d+p,m,h),Math.max(f,0)}findBestLevel(e,t,n,r,i,a){var o;let{fragCurrent:s,partCurrent:c,lastLoadedFragLevel:l}=this,{levels:u}=this.hls,d=u[l],f=!!(d!=null&&(o=d.details)!=null&&o.live),p=d==null?void 0:d.codecSet,m=c?c.duration:s?s.duration:0,h=this.bwEstimator.getEstimateTTFB()/1e3,g=t,_=-1;for(let o=n;o>=t;o--){let t=u[o];if(!t||p&&t.codecSet!==p){t&&(g=Math.min(o,g),_=Math.max(o,_));continue}_!==-1&&q.trace(`[abr] Skipped level(s) ${g}-${_} with CODECS:"${u[_].attrs.CODECS}"; not compatible with "${d.attrs.CODECS}"`);let n=t.details,s=(c?n==null?void 0:n.partTarget:n==null?void 0:n.averagetargetduration)||m,v;v=o<=l?i*e:a*e;let y=u[o].maxBitrate,b=this.getTimeToLoadFrag(h,v,y*s,n===void 0);if(q.trace(`[abr] level:${o} adjustedbw-bitrate:${Math.round(v-y)} avgDuration:${s.toFixed(1)} maxFetchDuration:${r.toFixed(1)} fetchDuration:${b.toFixed(1)}`),v>y&&(b===0||!XR(b)||f&&!this.bitrateTestDelay||b<r))return o}return-1}set nextAutoLevel(e){this._nextAutoLevel=e}},TV=class{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){let{chunks:e,dataLength:t}=this,n;if(e.length)n=e.length===1?e[0]:nfe(e,t);else return new Uint8Array;return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}},EV=100,DV=class extends kB{constructor(e,t,n){super(e,t,n,`[audio-stream-controller]`,Jz.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){let{hls:e}=this;e.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.LEVEL_LOADED,this.onLevelLoaded,this),e.on(G.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(G.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(G.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(G.ERROR,this.onError,this),e.on(G.BUFFER_RESET,this.onBufferReset,this),e.on(G.BUFFER_CREATED,this.onBufferCreated,this),e.on(G.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(G.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(G.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let{hls:e}=this;e.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.LEVEL_LOADED,this.onLevelLoaded,this),e.off(G.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(G.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(G.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(G.ERROR,this.onError,this),e.off(G.BUFFER_RESET,this.onBufferReset,this),e.off(G.BUFFER_CREATED,this.onBufferCreated,this),e.off(G.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(G.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(G.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:i}){if(n===`main`){let e=t.cc;this.initPTS[t.cc]={baseTime:r,timescale:i},this.log(`InitPTS for cc: ${e} found from main: ${r}`),this.videoTrackCC=e,this.state===J.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=J.STOPPED;return}let t=this.lastCurrentTime;this.stopLoad(),this.setInterval(EV),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=J.IDLE):(this.loadedmetadata=!1,this.state=J.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case J.IDLE:this.doTickIdle();break;case J.WAITING_TRACK:{var e;let{levels:t,trackId:n}=this,r=t==null||(e=t[n])==null?void 0:e.details;if(r){if(this.waitForCdnTuneIn(r))break;this.state=J.WAITING_INIT_PTS}break}case J.FRAG_LOADING_WAITING_RETRY:{var t;let e=performance.now(),n=this.retryDate;(!n||e>=n||(t=this.media)!=null&&t.seeking)&&(this.log(`RetryDate reached, switch back to IDLE state`),this.resetStartWhenNotLoaded(this.trackId),this.state=J.IDLE);break}case J.WAITING_INIT_PTS:{let e=this.waitingData;if(e){let{frag:t,part:n,cache:r,complete:i}=e;if(this.initPTS[t.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=J.FRAG_LOADING;let e=r.flush(),a={frag:t,part:n,payload:e,networkDetails:null};this._handleFragmentLoadProgress(a),i&&super._handleFragmentLoadComplete(a)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${t.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{let e=this.getLoadPosition(),n=xB.bufferInfo(this.mediaBuffer,e,this.config.maxBufferHole),r=KL(n.end,this.config.maxFragLookUpTolerance,t);r<0&&(this.log(`Waiting fragment cc (${t.cc}) @ ${t.start} cancelled because another fragment at ${n.end} is needed`),this.clearWaitingFragment())}}else this.state=J.IDLE}}this.onTickEnd()}clearWaitingFragment(){let e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=J.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){let{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){let{hls:e,levels:t,media:n,trackId:r}=this,i=e.config;if(!(t!=null&&t[r])||!n&&(this.startFragRequested||!i.startFragPrefetch))return;let a=t[r],o=a.details;if(!o||o.live&&this.levelLastLoaded!==r||this.waitForCdnTuneIn(o)){this.state=J.WAITING_TRACK;return}let s=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&s&&(this.bufferFlushed=!1,this.afterBufferFlushed(s,oz.AUDIO,Jz.AUDIO));let c=this.getFwdBufferInfo(s,Jz.AUDIO);if(c===null)return;let{bufferedTrack:l,switchingTrack:u}=this;if(!u&&this._streamEnded(c,o)){e.trigger(G.BUFFER_EOS,{type:`audio`}),this.state=J.ENDED;return}let d=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Jz.MAIN),f=c.len,p=this.getMaxBufferLength(d==null?void 0:d.len);if(f>=p&&!u)return;let m=o.fragments,h=m[0].start,g=c.end;if(u&&n){let e=this.getLoadPosition();l&&u.attrs!==l.attrs&&(g=e),o.PTSKnown&&e<h&&(c.end>h||c.nextStart)&&(this.log(`Alt audio track ahead of main track, seek to start of alt audio track`),n.currentTime=h+.05)}let _=this.getNextFragment(g,o),v=!1;if(_&&this.isLoopLoading(_,g)&&(v=!!_.gap,_=this.getNextFragmentLoopLoading(_,o,c,Jz.MAIN,p)),!_){this.bufferFlushed=!0;return}let y=d&&_.start>d.end+o.targetduration;if(y||!(d!=null&&d.len)&&c.len){let e=this.getAppendedFrag(_.start,Jz.MAIN);if(e===null||(v||(v=!!e.gap||!!y&&d.len===0),y&&!v||v&&c.nextStart&&c.nextStart<e.end))return}this.loadFragment(_,a,g)}getMaxBufferLength(e){let t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(e=>new iB(e))}onAudioTrackSwitching(e,t){let n=!!t.url;this.trackId=t.id;let{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),n?this.setInterval(EV):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=J.IDLE):(this.switchingTrack=null,this.bufferedTrack=t,this.state=J.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(G.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}let{levels:r}=this,{details:i,id:a}=t;if(!r){this.warn(`Audio tracks were reset while loading level ${a}`);return}this.log(`Track ${a} loaded [${i.startSN},${i.endSN}]${i.lastPartSn?`[part-${i.lastPartSn}-${i.lastPartIndex}]`:``},duration:${i.totalduration}`);let o=r[a],s=0;if(i.live||(n=o.details)!=null&&n.live){this.checkLiveUpdate(i);let e=this.mainDetails;if(i.deltaUpdateFailed||!e)return;!o.details&&i.hasProgramDateTime&&e.hasProgramDateTime?(rR(i,e),s=i.fragments[0].start):s=this.alignPlaylists(i,o.details)}o.details=i,this.levelLastLoaded=a,!this.startFragRequested&&(this.mainDetails||!i.live)&&this.setStartPosition(o.details,s),this.state===J.WAITING_TRACK&&!this.waitForCdnTuneIn(i)&&(this.state=J.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;let{frag:n,part:r,payload:i}=e,{config:a,trackId:o,levels:s}=this;if(!s){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}let c=s[o];if(!c){this.warn(`Audio track is undefined on fragment load progress`);return}let l=c.details;if(!l){this.warn(`Audio track details undefined on fragment load progress`),this.removeUnbufferedFrags(n.start);return}let u=a.defaultAudioCodec||c.audioCodec||`mp4a.40.2`,d=this.transmuxer;d||(d=this.transmuxer=new mV(this.hls,Jz.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));let f=this.initPTS[n.cc],p=(t=n.initSegment)==null?void 0:t.data;if(f!==void 0){let e=r?r.index:-1,t=e!==-1,a=new SB(n.level,n.sn,n.stats.chunkCount,i.byteLength,e,t);d.push(i,p,u,``,n,r,l.totalduration,!1,a,f)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${l.startSN} ,${l.endSN}],track ${o}`);let{cache:e}=this.waitingData=this.waitingData||{frag:n,part:r,cache:new TV,complete:!1};e.push(new Uint8Array(i)),this.waitingVideoCC=this.videoTrackCC,this.state=J.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){let n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){let{frag:n,part:r}=t;if(n.type!==Jz.AUDIO){if(!this.loadedmetadata&&n.type===Jz.MAIN){let e=this.videoBuffer||this.media;if(e){let t=xB.getBuffered(e);t.length&&(this.loadedmetadata=!0)}}return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?` p: `+r.index:``} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:`false`}`);return}if(n.sn!==`initSegment`){this.fragPrevious=n;let e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger(G.AUDIO_TRACK_SWITCHED,JI({},e)))}this.fragBufferedComplete(n,r)}onError(e,t){var n;if(t.fatal){this.state=J.ERROR;return}switch(t.details){case K.FRAG_GAP:case K.FRAG_PARSING_ERROR:case K.FRAG_DECRYPT_ERROR:case K.FRAG_LOAD_ERROR:case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_ERROR:case K.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Jz.AUDIO,t);break;case K.AUDIO_TRACK_LOAD_ERROR:case K.AUDIO_TRACK_LOAD_TIMEOUT:case K.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===J.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===qz.AUDIO_TRACK&&(this.state=J.IDLE);break;case K.BUFFER_FULL_ERROR:if(!t.parent||t.parent!==`audio`)return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,1/0,`audio`));break;case K.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushed(e,{type:t}){t===oz.AUDIO&&(this.bufferFlushed=!0,this.state===J.ENDED&&(this.state=J.IDLE))}_handleTransmuxComplete(e){var t;let n=`audio`,{hls:r}=this,{remuxResult:i,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}let{frag:s,part:c,level:l}=o,{details:u}=l,{audio:d,text:f,id3:p,initSegment:m}=i;if(this.fragContextChanged(s)||!u){this.fragmentTracker.removeFragment(s);return}if(this.state=J.PARSING,this.switchingTrack&&d&&this.completeAudioSwitch(this.switchingTrack),m!=null&&m.tracks){let e=s.initSegment||s;this._bufferInitSegment(m.tracks,e,a),r.trigger(G.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:m.tracks})}if(d){let{startPTS:e,endPTS:t,startDTS:n,endDTS:r}=d;c&&(c.elementaryStreams[oz.AUDIO]={startPTS:e,endPTS:t,startDTS:n,endDTS:r}),s.setElementaryStreamInfo(oz.AUDIO,e,t,n,r),this.bufferFragmentData(d,s,c,a)}if(p!=null&&(t=p.samples)!=null&&t.length){let e=YI({id:n,frag:s,details:u},p);r.trigger(G.FRAG_PARSING_METADATA,e)}if(f){let e=YI({id:n,frag:s,details:u},f);r.trigger(G.FRAG_PARSING_USERDATA,e)}}_bufferInitSegment(e,t,n){if(this.state!==J.PARSING)return;e.video&&delete e.video;let r=e.audio;if(!r)return;r.levelCodec=r.codec,r.id=`audio`,this.log(`Init audio buffer, container:${r.container}, codecs[parsed]=[${r.codec}]`),this.hls.trigger(G.BUFFER_CODECS,e);let i=r.initSegment;if(i!=null&&i.byteLength){let e={type:`audio`,frag:t,part:null,chunkMeta:n,parent:t.type,data:i};this.hls.trigger(G.BUFFER_APPENDING,e)}this.tick()}loadFragment(e,t,n){let r=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||r===pB.NOT_LOADED||r===pB.PARTIAL){var i;e.sn===`initSegment`?this._loadInitSegment(e,t):(i=t.details)!=null&&i.live&&!this.initPTS[e.cc]?(this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=J.WAITING_INIT_PTS):(this.startFragRequested=!0,super.loadFragment(e,t,n))}else this.clearTrackerIfNeeded(e)}completeAudioSwitch(e){let{hls:t,media:n,bufferedTrack:r}=this,i=r==null?void 0:r.attrs,a=e.attrs;n&&i&&(i.CHANNELS!==a.CHANNELS||i.NAME!==a.NAME||i.LANGUAGE!==a.LANGUAGE)&&(this.log(`Switching audio track : flushing all audio`),super.flushMainBuffer(0,1/0,`audio`)),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(G.AUDIO_TRACK_SWITCHED,JI({},e))}},OV=class extends uB{constructor(e){super(e,`[audio-track-controller]`),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){let{hls:e}=this;e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.MANIFEST_PARSED,this.onManifestParsed,this),e.on(G.LEVEL_LOADING,this.onLevelLoading,this),e.on(G.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(G.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(G.ERROR,this.onError,this)}unregisterListeners(){let{hls:e}=this;e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.MANIFEST_PARSED,this.onManifestParsed,this),e.off(G.LEVEL_LOADING,this.onLevelLoading,this),e.off(G.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(G.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(G.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){let{id:n,groupId:r,details:i}=t,a=this.tracksInGroup[n];if(!a||a.groupId!==r){this.warn(`Track with id:${n} and group:${r} not found in active group ${a.groupId}`);return}let o=a.details;a.details=t.details,this.log(`audio-track ${n} "${a.name}" lang:${a.lang} group:${r} loaded [${i.startSN}-${i.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){let t=this.hls.levels[e];if(!(t!=null&&t.audioGroupIds))return;let n=t.audioGroupIds[t.urlId];if(this.groupId!==n){this.groupId=n||null;let e=this.tracks.filter(e=>!n||e.groupId===n);this.selectDefaultTrack&&!e.some(e=>e.default)&&(this.selectDefaultTrack=!1),this.tracksInGroup=e;let t={audioTracks:e};this.log(`Updating audio tracks, ${e.length} track(s) found in group:${n}`),this.hls.trigger(G.AUDIO_TRACKS_UPDATED,t),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===qz.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioTrack(e){let t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid id passed to audio-track controller`);return}this.clearTimer();let n=this.currentTrack;t[this.trackId];let r=t[e],{groupId:i,name:a}=r;if(this.log(`Switching to audio-track ${e} "${a}" lang:${r.lang} group:${i}`),this.trackId=e,this.currentTrack=r,this.selectDefaultTrack=!1,this.hls.trigger(G.AUDIO_TRACK_SWITCHING,JI({},r)),r.details&&!r.details.live)return;let o=this.switchParams(r.url,n==null?void 0:n.details);this.loadPlaylist(o)}selectInitialTrack(){let e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(t!==-1)this.setAudioTrack(t);else{let t=Error(`No track found for running audio group-ID: ${this.groupId} track count: ${e.length}`);this.warn(t.message),this.hls.trigger(G.ERROR,{type:ZR.MEDIA_ERROR,details:K.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}findTrackId(e){let t=this.tracksInGroup;for(let n=0;n<t.length;n++){let r=t[n];if((!this.selectDefaultTrack||r.default)&&(!e||e.attrs[`STABLE-RENDITION-ID`]!==void 0&&e.attrs[`STABLE-RENDITION-ID`]===r.attrs[`STABLE-RENDITION-ID`]||e.name===r.name&&e.lang===r.lang))return r.id}return-1}loadPlaylist(e){super.loadPlaylist();let t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){let n=t.id,r=t.groupId,i=t.url;if(e)try{i=e.addDirectives(i)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${r}`),this.clearTimer(),this.hls.trigger(G.AUDIO_TRACK_LOADING,{url:i,id:n,groupId:r,deliveryDirectives:e||null})}}},kV=500,AV=class extends kB{constructor(e,t,n){super(e,t,n,`[subtitle-stream-controller]`,Jz.SUBTITLE),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){let{hls:e}=this;e.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.LEVEL_LOADED,this.onLevelLoaded,this),e.on(G.ERROR,this.onError,this),e.on(G.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(G.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(G.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(G.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(G.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(G.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let{hls:e}=this;e.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.LEVEL_LOADED,this.onLevelLoaded,this),e.off(G.ERROR,this.onError,this),e.off(G.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(G.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(G.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(G.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(G.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(G.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=J.IDLE,this.setInterval(kV),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){let{frag:n,success:r}=t;if(this.fragPrevious=n,this.state=J.IDLE,!r)return;let i=this.tracksBuffered[this.currentTrackId];if(!i)return;let a,o=n.start;for(let e=0;e<i.length;e++)if(o>=i[e].start&&o<=i[e].end){a=i[e];break}let s=n.start+n.duration;a?a.end=s:(a={start:o,end:s},i.push(a)),this.fragmentTracker.fragBuffered(n)}onBufferFlushing(e,t){let{startOffset:n,endOffset:r}=t;if(n===0&&r!==1/0){let e=r-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach(t=>{for(let n=0;n<t.length;){if(t[n].end<=e){t.shift();continue}else if(t[n].start<e)t[n].start=e;else break;n++}}),this.fragmentTracker.removeFragmentsInRange(n,e,Jz.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===Jz.MAIN){var n;(n=this.media)!=null&&n.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){let n=t.frag;(n==null?void 0:n.type)===Jz.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==J.STOPPED&&(this.state=J.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(OR(this.levels,t)){this.levels=t.map(e=>new iB(e));return}this.tracksBuffered=[],this.levels=t.map(e=>{let t=new iB(e);return this.tracksBuffered[t.id]=[],t}),this.fragmentTracker.removeFragmentsInRange(0,1/0,Jz.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){if(this.currentTrackId=t.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}let n=this.levels[this.currentTrackId];n!=null&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.setInterval(kV)}onSubtitleTrackLoaded(e,t){var n;let{details:r,id:i}=t,{currentTrackId:a,levels:o}=this;if(!o.length)return;let s=o[a];if(i>=o.length||i!==a||!s)return;this.mediaBuffer=this.mediaBufferTimeRanges;let c=0;if(r.live||(n=s.details)!=null&&n.live){let e=this.mainDetails;if(r.deltaUpdateFailed||!e)return;let t=e.fragments[0];s.details?(c=this.alignPlaylists(r,s.details),c===0&&t&&(c=t.start,LL(r,c))):r.hasProgramDateTime&&e.hasProgramDateTime?(rR(r,e),c=r.fragments[0].start):t&&(c=t.start,LL(r,c))}if(s.details=r,this.levelLastLoaded=i,!this.startFragRequested&&(this.mainDetails||!r.live)&&this.setStartPosition(s.details,c),this.tick(),r.live&&!this.fragCurrent&&this.media&&this.state===J.IDLE){let e=GL(null,r.fragments,this.media.currentTime,0);e||(this.warn(`Subtitle playlist not aligned with playback`),s.details=void 0)}}_handleFragmentLoadComplete(e){let{frag:t,payload:n}=e,r=t.decryptdata,i=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&r&&r.key&&r.iv&&r.method===`AES-128`){let e=performance.now();this.decrypter.decrypt(new Uint8Array(n),r.key.buffer,r.iv.buffer).catch(e=>{throw i.trigger(G.ERROR,{type:ZR.MEDIA_ERROR,details:K.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e}).then(n=>{let r=performance.now();i.trigger(G.FRAG_DECRYPTED,{frag:t,payload:n,stats:{tstart:e,tdecrypt:r}})}).catch(e=>{this.warn(`${e.name}: ${e.message}`),this.state=J.IDLE})}}doTick(){if(!this.media){this.state=J.IDLE;return}if(this.state===J.IDLE){let{currentTrackId:e,levels:t}=this,n=t[e];if(!t.length||!n||!n.details)return;let{config:r}=this,i=this.getLoadPosition(),a=xB.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i,r.maxBufferHole),{end:o,len:s}=a,c=this.getFwdBufferInfo(this.media,Jz.MAIN),l=n.details,u=this.getMaxBufferLength(c==null?void 0:c.len)+l.levelTargetDuration;if(s>u)return;let d=l.fragments,f=d.length,p=l.edge,m=null,h=this.fragPrevious;if(o<p){let e=r.maxFragLookUpTolerance,t=o>p-e?0:e;m=GL(h,d,Math.max(d[0].start,o),t),!m&&h&&h.start<d[0].start&&(m=d[0])}else m=d[f-1];if(!m)return;if(m=this.mapToInitFragWhenRequired(m),m.sn!==`initSegment`){let e=m.sn-l.startSN,t=d[e-1];t&&t.cc===m.cc&&this.fragmentTracker.getState(t)===pB.NOT_LOADED&&(m=t)}this.fragmentTracker.getState(m)===pB.NOT_LOADED&&this.loadFragment(m,n,o)}}getMaxBufferLength(e){let t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,e.sn===`initSegment`?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new jV(this.tracksBuffered[this.currentTrackId]||[])}},jV=class{constructor(e){this.buffered=void 0;let t=(t,n,r)=>{if(n>>>=0,n>r-1)throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${r})`);return e[n][t]};this.buffered={get length(){return e.length},end(n){return t(`end`,n,e.length)},start(n){return t(`start`,n,e.length)}}}},MV=class extends uB{constructor(e){super(e,`[subtitle-track-controller]`),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){let{hls:e}=this;e.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.MANIFEST_PARSED,this.onManifestParsed,this),e.on(G.LEVEL_LOADING,this.onLevelLoading,this),e.on(G.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(G.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(G.ERROR,this.onError,this)}unregisterListeners(){let{hls:e}=this;e.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.MANIFEST_PARSED,this.onManifestParsed,this),e.off(G.LEVEL_LOADING,this.onLevelLoading,this),e.off(G.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(G.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(G.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&`onchange`in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener(`change`,this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener(`change`,this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);let e=kR(this.media.textTracks);e.forEach(e=>{AL(e)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){let{id:n,details:r}=t,{trackId:i}=this,a=this.tracksInGroup[i];if(!a){this.warn(`Invalid subtitle track id ${n}`);return}let o=a.details;a.details=t.details,this.log(`subtitle track ${n} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){let t=this.hls.levels[e];if(!(t!=null&&t.textGroupIds))return;let n=t.textGroupIds[t.urlId],r=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==n){let e=this.tracks.filter(e=>!n||e.groupId===n);this.tracksInGroup=e;let t=this.findTrackId(r==null?void 0:r.name)||this.findTrackId();this.groupId=n||null;let i={subtitleTracks:e};this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${n}" group-id`),this.hls.trigger(G.SUBTITLE_TRACKS_UPDATED,i),t!==-1&&this.setSubtitleTrack(t,r)}else this.shouldReloadPlaylist(r)&&this.setSubtitleTrack(this.trackId,r)}findTrackId(e){let t=this.tracksInGroup;for(let n=0;n<t.length;n++){let r=t[n];if((!this.selectDefaultTrack||r.default)&&(!e||e===r.name))return r.id}return-1}onError(e,t){t.fatal||!t.context||t.context.type===qz.SUBTITLE_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1;let t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}loadPlaylist(e){super.loadPlaylist();let t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){let n=t.id,r=t.groupId,i=t.url;if(e)try{i=e.addDirectives(i)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(G.SUBTITLE_TRACK_LOADING,{url:i,id:n,groupId:r,deliveryDirectives:e||null})}}toggleTrackModes(e){let{media:t,trackId:n}=this;if(!t)return;let r=kR(t.textTracks),i=r.filter(e=>e.groupId===this.groupId);if(e===-1)[].slice.call(r).forEach(e=>{e.mode=`disabled`});else{let e=i[n];e&&(e.mode=`disabled`)}let a=i[e];a&&(a.mode=this.subtitleDisplay?`showing`:`hidden`)}setSubtitleTrack(e,t){var n;let r=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(this.trackId!==e&&this.toggleTrackModes(e),this.trackId===e&&(e===-1||(n=r[e])!=null&&n.details)||e<-1||e>=r.length)return;this.clearTimer();let i=r[e];if(this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:``)),this.trackId=e,i){let{id:e,groupId:n=``,name:r,type:a,url:o}=i;this.hls.trigger(G.SUBTITLE_TRACK_SWITCH,{id:e,groupId:n,name:r,type:a,url:o});let s=this.switchParams(i.url,t==null?void 0:t.details);this.loadPlaylist(s)}else this.hls.trigger(G.SUBTITLE_TRACK_SWITCH,{id:e})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=-1,t=kR(this.media.textTracks);for(let n=0;n<t.length;n++)if(t[n].mode===`hidden`)e=n;else if(t[n].mode===`showing`){e=n;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}},NV=class{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t){let n=this.queues[t];n.push(e),n.length===1&&this.buffers[t]&&this.executeNext(t)}insertAbort(e,t){let n=this.queues[t];n.unshift(e),this.executeNext(t)}appendBlocker(e){let t,n=new Promise(e=>{t=e}),r={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(r,e),n}executeNext(e){let{buffers:t,queues:n}=this,r=t[e],i=n[e];if(i.length){let t=i[0];try{t.execute()}catch(n){q.warn(`[buffer-operation-queue]: Unhandled exception executing the current operation`),t.onError(n),r!=null&&r.updating||(i.shift(),this.executeNext(e))}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}},PV=vL(),FV=/([ha]vc.)(?:\.[^.,]+)+/,IV=class{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{let{media:e,mediaSource:t}=this;q.log(`[buffer-controller]: Media source opened`),e&&(e.removeEventListener(`emptied`,this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(G.MEDIA_ATTACHED,{media:e})),t&&t.removeEventListener(`sourceopen`,this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{q.log(`[buffer-controller]: Media source closed`)},this._onMediaSourceEnded=()=>{q.log(`[buffer-controller]: Media source ended`)},this._onMediaEmptied=()=>{let{media:e,_objectUrl:t}=this;e&&e.src!==t&&q.error(`Media element src was set while attaching MediaSource (${t} > ${e.src})`)},this.hls=e,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){let{hls:e}=this;e.on(G.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.MANIFEST_PARSED,this.onManifestParsed,this),e.on(G.BUFFER_RESET,this.onBufferReset,this),e.on(G.BUFFER_APPENDING,this.onBufferAppending,this),e.on(G.BUFFER_CODECS,this.onBufferCodecs,this),e.on(G.BUFFER_EOS,this.onBufferEos,this),e.on(G.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(G.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(G.FRAG_PARSED,this.onFragParsed,this),e.on(G.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){let{hls:e}=this;e.off(G.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.MANIFEST_PARSED,this.onManifestParsed,this),e.off(G.BUFFER_RESET,this.onBufferReset,this),e.off(G.BUFFER_APPENDING,this.onBufferAppending,this),e.off(G.BUFFER_CODECS,this.onBufferCodecs,this),e.off(G.BUFFER_EOS,this.onBufferEos,this),e.off(G.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(G.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(G.FRAG_PARSED,this.onFragParsed,this),e.off(G.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new NV(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,q.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){let n=this.media=t.media;if(n&&PV){let e=this.mediaSource=new PV;e.addEventListener(`sourceopen`,this._onMediaSourceOpen),e.addEventListener(`sourceended`,this._onMediaSourceEnded),e.addEventListener(`sourceclose`,this._onMediaSourceClose),n.src=self.URL.createObjectURL(e),this._objectUrl=n.src,n.addEventListener(`emptied`,this._onMediaEmptied)}}onMediaDetaching(){let{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(q.log(`[buffer-controller]: media source detaching`),t.readyState===`open`)try{t.endOfStream()}catch(e){q.warn(`[buffer-controller]: onMediaDetaching: ${e.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener(`sourceopen`,this._onMediaSourceOpen),t.removeEventListener(`sourceended`,this._onMediaSourceEnded),t.removeEventListener(`sourceclose`,this._onMediaSourceClose),e&&(e.removeEventListener(`emptied`,this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),e.src===n?(e.removeAttribute(`src`),e.load()):q.warn(`[buffer-controller]: media.src was changed by a third party - skip cleanup`)),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(G.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{let t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(t){q.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,t)}}),this._initSourceBuffer()}onBufferCodecs(e,t){let n=this.getSourceBufferTypes().length;Object.keys(t).forEach(e=>{if(n){let n=this.tracks[e];if(n&&typeof n.buffer.changeType==`function`){let{id:r,codec:i,levelCodec:a,container:o,metadata:s}=t[e],c=(n.levelCodec||n.codec).replace(FV,`$1`),l=(a||i).replace(FV,`$1`);if(c!==l){let t=`${o};codecs=${a||i}`;this.appendChangeType(e,t),q.log(`[buffer-controller]: switching codec ${c} to ${l}`),this.tracks[e]={buffer:n.buffer,codec:i,container:o,levelCodec:a,metadata:s,id:r}}}}else this.pendingTracks[e]=t[e]}),!n&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState===`open`&&this.checkPendingTracks())}appendChangeType(e,t){let{operationQueue:n}=this,r={execute:()=>{let r=this.sourceBuffer[e];r&&(q.log(`[buffer-controller]: changing ${e} sourceBuffer type to ${t}`),r.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{q.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,t)}};n.append(r,e)}onBufferAppending(e,t){let{hls:n,operationQueue:r,tracks:i}=this,{data:a,type:o,frag:s,part:c,chunkMeta:l}=t,u=l.buffering[o],d=self.performance.now();u.start=d;let f=s.stats.buffering,p=c?c.stats.buffering:null;f.start===0&&(f.start=d),p&&p.start===0&&(p.start=d);let m=i.audio,h=!1;o===`audio`&&(m==null?void 0:m.container)===`audio/mpeg`&&(h=!this.lastMpegAudioChunk||l.id===1||this.lastMpegAudioChunk.sn!==l.sn,this.lastMpegAudioChunk=l);let g=s.start,_={execute:()=>{if(u.executeStart=self.performance.now(),h){let e=this.sourceBuffer[o];if(e){let t=g-e.timestampOffset;Math.abs(t)>=.1&&(q.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${g} (delta: ${t}) sn: ${s.sn})`),e.timestampOffset=g)}}this.appendExecutor(a,o)},onStart:()=>{},onComplete:()=>{let e=self.performance.now();u.executeEnd=u.end=e,f.first===0&&(f.first=e),p&&p.first===0&&(p.first=e);let{sourceBuffer:t}=this,n={};for(let e in t)n[e]=xB.getBuffered(t[e]);this.appendError=0,this.hls.trigger(G.BUFFER_APPENDED,{type:o,frag:s,part:c,chunkMeta:l,parent:s.type,timeRanges:n})},onError:e=>{q.error(`[buffer-controller]: Error encountered while trying to append to the ${o} SourceBuffer`,e);let t={type:ZR.MEDIA_ERROR,parent:s.type,details:K.BUFFER_APPEND_ERROR,frag:s,part:c,chunkMeta:l,error:e,err:e,fatal:!1};e.code===DOMException.QUOTA_EXCEEDED_ERR?t.details=K.BUFFER_FULL_ERROR:(this.appendError++,t.details=K.BUFFER_APPEND_ERROR,this.appendError>n.config.appendErrorMaxRetry&&(q.error(`[buffer-controller]: Failed ${n.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),t.fatal=!0)),n.trigger(G.ERROR,t)}};r.append(_,o)}onBufferFlushing(e,t){let{operationQueue:n}=this,r=e=>({execute:this.removeExecutor.bind(this,e,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(G.BUFFER_FLUSHED,{type:e})},onError:t=>{q.warn(`[buffer-controller]: Failed to remove from ${e} SourceBuffer`,t)}});t.type?n.append(r(t.type),t.type):this.getSourceBufferTypes().forEach(e=>{n.append(r(e),e)})}onFragParsed(e,t){let{frag:n,part:r}=t,i=[],a=r?r.elementaryStreams:n.elementaryStreams;a[oz.AUDIOVIDEO]?i.push(`audiovideo`):(a[oz.AUDIO]&&i.push(`audio`),a[oz.VIDEO]&&i.push(`video`));let o=()=>{let e=self.performance.now();n.stats.buffering.end=e,r&&(r.stats.buffering.end=e);let t=r?r.stats:n.stats;this.hls.trigger(G.FRAG_BUFFERED,{frag:n,part:r,stats:t,id:n.type})};i.length===0&&q.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(o,i)}onFragChanged(e,t){this.flushBackBuffer()}onBufferEos(e,t){let n=this.getSourceBufferTypes().reduce((e,n)=>{let r=this.sourceBuffer[n];return r&&(!t.type||t.type===n)&&(r.ending=!0,r.ended||(r.ended=!0,q.log(`[buffer-controller]: ${n} sourceBuffer now EOS`))),e&&!!(!r||r.ended)},!0);n&&(q.log(`[buffer-controller]: Queueing mediaSource.endOfStream()`),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(e=>{let t=this.sourceBuffer[e];t&&(t.ending=!1)});let{mediaSource:e}=this;if(!e||e.readyState!==`open`){e&&q.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${e.readyState}`);return}q.log(`[buffer-controller]: Calling mediaSource.endOfStream()`),e.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){let{hls:e,details:t,media:n,sourceBuffer:r}=this;if(!n||t===null)return;let i=this.getSourceBufferTypes();if(!i.length)return;let a=t.live&&e.config.liveBackBufferLength!==null?e.config.liveBackBufferLength:e.config.backBufferLength;if(!XR(a)||a<0)return;let o=n.currentTime,s=t.levelTargetDuration,c=Math.max(a,s),l=Math.floor(o/s)*s-c;i.forEach(n=>{let i=r[n];if(i){let r=xB.getBuffered(i);if(r.length>0&&l>r.start(0)){if(e.trigger(G.BACK_BUFFER_REACHED,{bufferEnd:l}),t.live)e.trigger(G.LIVE_BACK_BUFFER_REACHED,{bufferEnd:l});else if(i.ended&&r.end(r.length-1)-o<s*2){q.info(`[buffer-controller]: Cannot flush ${n} back buffer while SourceBuffer is in ended state`);return}e.trigger(G.BUFFER_FLUSHING,{startOffset:0,endOffset:l,type:n})}}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!==`open`)return;let{details:e,hls:t,media:n,mediaSource:r}=this,i=e.fragments[0].start+e.totalduration,a=n.duration,o=XR(r.duration)?r.duration:0;e.live&&t.config.liveDurationInfinity?(q.log(`[buffer-controller]: Media Source duration is set to Infinity`),r.duration=1/0,this.updateSeekableRange(e)):(i>o&&i>a||!XR(a))&&(q.log(`[buffer-controller]: Updating Media Source duration to ${i.toFixed(3)}`),r.duration=i)}updateSeekableRange(e){let t=this.mediaSource,n=e.fragments,r=n.length;if(r&&e.live&&t!=null&&t.setLiveSeekableRange){let r=Math.max(0,n[0].start),i=Math.max(r,r+e.totalduration);t.setLiveSeekableRange(r,i)}}checkPendingTracks(){let{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,r=Object.keys(n).length;if(r&&!e||r===2){this.createSourceBuffers(n),this.pendingTracks={};let e=this.getSourceBufferTypes();if(e.length)this.hls.trigger(G.BUFFER_CREATED,{tracks:this.tracks}),e.forEach(e=>{t.executeNext(e)});else{let e=Error(`could not create source buffer for media codec(s)`);this.hls.trigger(G.ERROR,{type:ZR.MEDIA_ERROR,details:K.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}}createSourceBuffers(e){let{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error(`createSourceBuffers called when mediaSource was null`);for(let r in e)if(!t[r]){let i=e[r];if(!i)throw Error(`source buffer exists for track ${r}, however track does not`);let a=i.levelCodec||i.codec,o=`${i.container};codecs=${a}`;q.log(`[buffer-controller]: creating sourceBuffer(${o})`);try{let e=t[r]=n.addSourceBuffer(o),s=r;this.addBufferListener(s,`updatestart`,this._onSBUpdateStart),this.addBufferListener(s,`updateend`,this._onSBUpdateEnd),this.addBufferListener(s,`error`,this._onSBUpdateError),this.tracks[r]={buffer:e,codec:a,container:i.container,levelCodec:i.levelCodec,metadata:i.metadata,id:i.id}}catch(e){q.error(`[buffer-controller]: error while trying to add sourceBuffer: ${e.message}`),this.hls.trigger(G.ERROR,{type:ZR.MEDIA_ERROR,details:K.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,mimeType:o})}}}_onSBUpdateStart(e){let{operationQueue:t}=this,n=t.current(e);n.onStart()}_onSBUpdateEnd(e){let{operationQueue:t}=this,n=t.current(e);n.onComplete(),t.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){let n=Error(`${e} SourceBuffer error`);q.error(`[buffer-controller]: ${n}`,t),this.hls.trigger(G.ERROR,{type:ZR.MEDIA_ERROR,details:K.BUFFER_APPENDING_ERROR,error:n,fatal:!1});let r=this.operationQueue.current(e);r&&r.onError(t)}removeExecutor(e,t,n){let{media:r,mediaSource:i,operationQueue:a,sourceBuffer:o}=this,s=o[e];if(!r||!i||!s){q.warn(`[buffer-controller]: Attempting to remove from the ${e} SourceBuffer, but it does not exist`),a.shiftAndExecuteNext(e);return}let c=XR(r.duration)?r.duration:1/0,l=XR(i.duration)?i.duration:1/0,u=Math.max(0,t),d=Math.min(n,c,l);d>u&&!s.ending?(s.ended=!1,q.log(`[buffer-controller]: Removing [${u},${d}] from the ${e} SourceBuffer`),s.remove(u,d)):a.shiftAndExecuteNext(e)}appendExecutor(e,t){let{operationQueue:n,sourceBuffer:r}=this,i=r[t];if(!i){q.warn(`[buffer-controller]: Attempting to append to the ${t} SourceBuffer, but it does not exist`),n.shiftAndExecuteNext(t);return}i.ended=!1,i.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){q.log(`[buffer-controller]: Blocking operation requested, but no SourceBuffers exist`),Promise.resolve().then(e);return}let{operationQueue:n}=this,r=t.map(e=>n.appendBlocker(e));Promise.all(r).then(()=>{e(),t.forEach(e=>{let t=this.sourceBuffer[e];t!=null&&t.updating||n.shiftAndExecuteNext(e)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){let r=this.sourceBuffer[e];if(!r)return;let i=n.bind(this,e);this.listeners[e].push({event:t,listener:i}),r.addEventListener(t,i)}removeBufferListeners(e){let t=this.sourceBuffer[e];t&&this.listeners[e].forEach(e=>{t.removeEventListener(e.event,e.listener)})}},LV={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},RV=function(e){let t=e;return LV.hasOwnProperty(e)&&(t=LV[e]),String.fromCharCode(t)},zV=15,BV=100,VV={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},HV={17:2,18:4,21:6,22:8,23:10,19:13,20:15},UV={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},WV={25:2,26:4,29:6,30:8,31:10,27:13,28:15},GV=[`white`,`green`,`blue`,`cyan`,`red`,`yellow`,`magenta`,`black`,`transparent`],KV=class{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){let n=typeof t==`function`?t():t;q.log(`${this.time} [${e}] ${n}`)}}},qV=function(e){let t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t},JV=class{constructor(e,t,n,r,i){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||`white`,this.underline=t||!1,this.italics=n||!1,this.background=r||`black`,this.flash=i||!1}reset(){this.foreground=`white`,this.underline=!1,this.italics=!1,this.background=`black`,this.flash=!1}setStyles(e){let t=[`foreground`,`underline`,`italics`,`background`,`flash`];for(let n=0;n<t.length;n++){let r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return this.foreground===`white`&&!this.underline&&!this.italics&&this.background===`black`&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return`color=`+this.foreground+`, underline=`+this.underline+`, italics=`+this.italics+`, background=`+this.background+`, flash=`+this.flash}},YV=class{constructor(e,t,n,r,i,a){this.uchar=void 0,this.penState=void 0,this.uchar=e||` `,this.penState=new JV(t,n,r,i,a)}reset(){this.uchar=` `,this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===` `&&this.penState.isDefault()}},XV=class{constructor(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let e=0;e<BV;e++)this.chars.push(new YV);this.logger=e,this.pos=0,this.currPenState=new JV}equals(e){let t=!0;for(let n=0;n<BV;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t}copy(e){for(let t=0;t<BV;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<BV;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,`Negative cursor position `+this.pos),this.pos=0):this.pos>BV&&(this.logger.log(3,`Too large cursor position `+this.pos),this.pos=BV)}moveCursor(e){let t=this.pos+e;if(e>1)for(let e=this.pos+1;e<t+1;e++)this.chars[e].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(` `,this.currPenState)}insertChar(e){e>=144&&this.backSpace();let t=RV(e);if(this.pos>=BV){this.logger.log(0,()=>`Cannot insert `+e.toString(16)+` (`+t+`) at position `+this.pos+`. Skipping it!`);return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<BV;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){let e=[],t=!0;for(let n=0;n<BV;n++){let r=this.chars[n].uchar;r!==` `&&(t=!1),e.push(r)}return t?``:e.join(``)}setPenStyles(e){this.currPenState.setStyles(e);let t=this.chars[this.pos];t.setPenState(this.currPenState)}},ZV=class{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<zV;t++)this.rows.push(new XV(e));this.logger=e,this.currRow=zV-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let e=0;e<zV;e++)this.rows[e].clear();this.currRow=zV-1}equals(e){let t=!0;for(let n=0;n<zV;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<zV;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<zV;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){let e=this.rows[this.currRow];e.backSpace()}clearToEndOfRow(){let e=this.rows[this.currRow];e.clearToEndOfRow()}insertChar(e){let t=this.rows[this.currRow];t.insertChar(e)}setPen(e){let t=this.rows[this.currRow];t.setPenStyles(e)}moveCursor(e){let t=this.rows[this.currRow];t.moveCursor(e)}setCursor(e){this.logger.log(2,`setCursor: `+e);let t=this.rows[this.currRow];t.setCursor(e)}setPAC(e){this.logger.log(2,()=>`pacData = `+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let e=0;e<zV;e++)this.rows[e].clear();let e=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){let r=n.rows[e].cueStartTime,i=this.logger.time;if(r&&i!==null&&r<i)for(let r=0;r<this.nrRollUpRows;r++)this.rows[t-this.nrRollUpRows+r+1].copy(n.rows[e+r])}}this.currRow=t;let n=this.rows[this.currRow];if(e.indent!==null){let t=e.indent,r=Math.max(t-1,0);n.setCursor(e.indent),e.color=n.chars[r].penState.foreground}let r={foreground:e.color,underline:e.underline,italics:e.italics,background:`black`,flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>`bkgData = `+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,`roll_up but nrRollUpRows not set yet`);return}this.logger.log(1,()=>this.getDisplayText());let e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,`Rolling up`)}getDisplayText(e){e=e||!1;let t=[],n=``,r=-1;for(let n=0;n<zV;n++){let i=this.rows[n].getTextString();i&&(r=n+1,e?t.push(`Row `+r+`: '`+i+`'`):t.push(i.trim()))}return t.length>0&&(n=e?`[`+t.join(` | `)+`]`:t.join(`
`)),n}getTextAndFormat(){return this.rows}},QV=class{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new ZV(n),this.nonDisplayedMemory=new ZV(n),this.lastOutputScreen=new ZV(n),this.currRollUpRow=this.displayedMemory.rows[zV-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[zV-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>`MODE=`+e),this.mode===`MODE_POP-ON`?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!==`MODE_ROLL-UP`&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);let t=this.writeScreen===this.displayedMemory?`DISP`:`NON_DISP`;this.logger.log(2,()=>t+`: `+this.writeScreen.getDisplayText(!0)),(this.mode===`MODE_PAINT-ON`||this.mode===`MODE_ROLL-UP`)&&(this.logger.log(1,()=>`DISPLAYED: `+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,`RCL - Resume Caption Loading`),this.setMode(`MODE_POP-ON`)}ccBS(){this.logger.log(2,`BS - BackSpace`),this.mode!==`MODE_TEXT`&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,`DER- Delete to End of Row`),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,`RU(`+e+`) - Roll Up`),this.writeScreen=this.displayedMemory,this.setMode(`MODE_ROLL-UP`),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,`FON - Flash On`),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,`RDC - Resume Direct Captioning`),this.setMode(`MODE_PAINT-ON`)}ccTR(){this.logger.log(2,`TR`),this.setMode(`MODE_TEXT`)}ccRTD(){this.logger.log(2,`RTD`),this.setMode(`MODE_TEXT`)}ccEDM(){this.logger.log(2,`EDM - Erase Displayed Memory`),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,`CR - Carriage Return`),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,`ENM - Erase Non-displayed Memory`),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,`EOC - End Of Caption`),this.mode===`MODE_POP-ON`){let e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>`DISP: `+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,`TO(`+e+`) - Tab Offset`),this.writeScreen.moveCursor(e)}ccMIDROW(e){let t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground=`white`;else{let n=Math.floor(e/2)-16,r=[`white`,`green`,`blue`,`cyan`,`red`,`yellow`,`magenta`];t.foreground=r[n]}this.logger.log(2,`MIDROW: `+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){let t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}},$V=class{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;let r=new KV;this.channels=[null,new QV(e,t,r),new QV(e+1,n,r)],this.cmdHistory=MR(),this.logger=r}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let n,r,i,a=!1;this.logger.time=e;for(let e=0;e<t.length;e+=2)if(r=t[e]&127,i=t[e+1]&127,!(r===0&&i===0)){if(this.logger.log(3,`[`+qV([t[e],t[e+1]])+`] -> (`+qV([r,i])+`)`),n=this.parseCmd(r,i),n||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),!n&&(a=this.parseChars(r,i),a)){let e=this.currentChannel;if(e&&e>0){let t=this.channels[e];t.insertChars(a)}else this.logger.log(2,`No channel found yet. TEXT-MODE?`)}!n&&!a&&this.logger.log(2,`Couldn't parse cleaned data `+qV([r,i])+` orig: `+qV([t[e],t[e+1]]))}}parseCmd(e,t){let{cmdHistory:n}=this,r=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=33&&t<=35;if(!(r||i))return!1;if(jR(e,t,n))return AR(null,null,n),this.logger.log(3,`Repeated command (`+qV([e,t])+`) is dropped`),!0;let a=e===20||e===21||e===23?1:2,o=this.channels[a];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),AR(e,t,n),this.currentChannel=a,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(n=e===17?1:2,n!==this.currentChannel)return this.logger.log(0,`Mismatch channel in midrow parsing`),!1;let r=this.channels[n];return r?(r.ccMIDROW(t),this.logger.log(3,`MIDROW (`+qV([e,t])+`)`),!0):!1}return!1}parsePAC(e,t){let n,r=this.cmdHistory,i=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,a=(e===16||e===24)&&t>=64&&t<=95;if(!(i||a))return!1;if(jR(e,t,r))return AR(null,null,r),!0;let o=e<=23?1:2;n=t>=64&&t<=95?o===1?VV[e]:UV[e]:o===1?HV[e]:WV[e];let s=this.channels[o];return s?(s.setPAC(this.interpretPAC(n,t)),AR(e,t,r),this.currentChannel=o,!0):!1}interpretPAC(e,t){let n,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=(n&1)==1,n<=13?r.color=[`white`,`green`,`blue`,`cyan`,`red`,`yellow`,`magenta`,`white`][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color=`white`):r.indent=Math.floor((n-16)/2)*4,r}parseChars(e,t){let n,r=null,i=null;if(e>=25?(n=2,i=e-8):(n=1,i=e),i>=17&&i<=19){let e;e=i===17?t+80:i===18?t+112:t+144,this.logger.log(2,`Special char '`+RV(e)+`' in channel `+n),r=[e]}else e>=32&&e<=127&&(r=t===0?[e]:[e,t]);if(r){let n=qV(r);this.logger.log(3,`Char codes =  `+n.join(`,`)),AR(e,t,this.cmdHistory)}return r}parseBackgroundAttributes(e,t){let n=(e===16||e===24)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=45&&t<=47;if(!(n||r))return!1;let i,a={};e===16||e===24?(i=Math.floor((t-32)/2),a.background=GV[i],t%2==1&&(a.background+=`_semi`)):t===45?a.background=`transparent`:(a.foreground=`black`,t===47&&(a.underline=!0));let o=e<=23?1:2,s=this.channels[o];return s.setBkgData(a),AR(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){let t=this.channels[e];t&&t.reset()}this.cmdHistory=MR()}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){let n=this.channels[t];n&&n.cueSplitAtTime(e)}}},eH=class{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}},tH=(function(){if(typeof self<`u`&&self.VTTCue)return self.VTTCue;let e=[``,`lr`,`rl`],t=[`start`,`middle`,`end`,`left`,`right`];function n(e,t){if(typeof t!=`string`||!Array.isArray(e))return!1;let n=t.toLowerCase();return~e.indexOf(n)?n:!1}function r(t){return n(e,t)}function i(e){return n(t,e)}function a(e,...t){let n=1;for(;n<arguments.length;n++){let t=arguments[n];for(let n in t)e[n]=t[n]}return e}function o(e,t,n){let o=this,s={enumerable:!0};o.hasBeenReset=!1;let c=``,l=!1,u=e,d=t,f=n,p=null,m=``,h=!0,g=`auto`,_=`start`,v=50,y=`middle`,b=50,ee=`middle`;Object.defineProperty(o,`id`,a({},s,{get:function(){return c},set:function(e){c=``+e}})),Object.defineProperty(o,`pauseOnExit`,a({},s,{get:function(){return l},set:function(e){l=!!e}})),Object.defineProperty(o,`startTime`,a({},s,{get:function(){return u},set:function(e){if(typeof e!=`number`)throw TypeError(`Start time must be set to a number.`);u=e,this.hasBeenReset=!0}})),Object.defineProperty(o,`endTime`,a({},s,{get:function(){return d},set:function(e){if(typeof e!=`number`)throw TypeError(`End time must be set to a number.`);d=e,this.hasBeenReset=!0}})),Object.defineProperty(o,`text`,a({},s,{get:function(){return f},set:function(e){f=``+e,this.hasBeenReset=!0}})),Object.defineProperty(o,`region`,a({},s,{get:function(){return p},set:function(e){p=e,this.hasBeenReset=!0}})),Object.defineProperty(o,`vertical`,a({},s,{get:function(){return m},set:function(e){let t=r(e);if(t===!1)throw SyntaxError(`An invalid or illegal string was specified.`);m=t,this.hasBeenReset=!0}})),Object.defineProperty(o,`snapToLines`,a({},s,{get:function(){return h},set:function(e){h=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,`line`,a({},s,{get:function(){return g},set:function(e){if(typeof e!=`number`&&e!==`auto`)throw SyntaxError(`An invalid number or illegal string was specified.`);g=e,this.hasBeenReset=!0}})),Object.defineProperty(o,`lineAlign`,a({},s,{get:function(){return _},set:function(e){let t=i(e);if(!t)throw SyntaxError(`An invalid or illegal string was specified.`);_=t,this.hasBeenReset=!0}})),Object.defineProperty(o,`position`,a({},s,{get:function(){return v},set:function(e){if(e<0||e>100)throw Error(`Position must be between 0 and 100.`);v=e,this.hasBeenReset=!0}})),Object.defineProperty(o,`positionAlign`,a({},s,{get:function(){return y},set:function(e){let t=i(e);if(!t)throw SyntaxError(`An invalid or illegal string was specified.`);y=t,this.hasBeenReset=!0}})),Object.defineProperty(o,`size`,a({},s,{get:function(){return b},set:function(e){if(e<0||e>100)throw Error(`Size must be between 0 and 100.`);b=e,this.hasBeenReset=!0}})),Object.defineProperty(o,`align`,a({},s,{get:function(){return ee},set:function(e){let t=i(e);if(!t)throw SyntaxError(`An invalid or illegal string was specified.`);ee=t,this.hasBeenReset=!0}})),o.displayState=void 0}return o.prototype.getCueAsHTML=function(){let e=self.WebVTT;return e.convertCueToDOMTree(self,this.text)},o})(),nH=class{decode(e,t){if(!e)return``;if(typeof e!=`string`)throw Error(`Error - expected string data.`);return decodeURIComponent(encodeURIComponent(e))}},rH=class{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==``&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){let n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}},iH=new tH(0,0,``),aH=iH.align===`middle`?`middle`:`center`,oH=class{constructor(){this.state=`INITIAL`,this.buffer=``,this.decoder=new nH,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){let t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let e=t.buffer,n=0;for(e=FR(e);n<e.length&&e[n]!==`\r`&&e[n]!==`
`;)++n;let r=e.slice(0,n);return e[n]===`\r`&&++n,e[n]===`
`&&++n,t.buffer=e.slice(n),r}function r(e){PR(e,function(e,t){},/:/)}try{let e=``;if(t.state===`INITIAL`){if(!/\r\n|\n/.test(t.buffer))return this;e=n();let r=e.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(r!=null&&r[0]))throw Error(`Malformed WebVTT signature.`);t.state=`HEADER`}let i=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(i?i=!1:e=n(),t.state){case`HEADER`:/:/.test(e)?r(e):e||(t.state=`ID`);continue;case`NOTE`:e||(t.state=`ID`);continue;case`ID`:if(/^NOTE($|[ \t])/.test(e)){t.state=`NOTE`;break}if(!e)continue;if(t.cue=new tH(0,0,``),t.state=`CUE`,e.indexOf(`-->`)===-1){t.cue.id=e;continue}case`CUE`:if(!t.cue){t.state=`BADCUE`;continue}try{ife(e,t.cue,t.regionList)}catch(e){t.cue=null,t.state=`BADCUE`;continue}t.state=`CUETEXT`;continue;case`CUETEXT`:{let n=e.indexOf(`-->`)!==-1;if(!e||n&&(i=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state=`ID`;continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=e}continue;case`BADCUE`:e||(t.state=`ID`)}}}catch(e){t.state===`CUETEXT`&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state===`INITIAL`?`BADWEBVTT`:`BADCUE`}return this}flush(){let e=this;try{if((e.cue||e.state===`HEADER`)&&(e.buffer+=`

`,e.parse()),e.state===`INITIAL`||e.state===`BADWEBVTT`)throw Error(`Malformed WebVTT signature.`)}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}},sH=/\r\n|\n\r|\n|\r/g,cH=function(e,t,n=0){return e.slice(n,n+t.length)===t},lH=function(e){let t=parseInt(e.slice(-3)),n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),i=e.length>9?parseInt(e.substring(0,e.indexOf(`:`))):0;if(!XR(t)||!XR(n)||!XR(r)||!XR(i))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*r,t+=3600*1e3*i,t},uH=function(e){let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return(t>>>0).toString()},dH=function(e,t,n){let r=e[t],i=e[r.prevCC];if(!i||!i.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;(a=i)!=null&&a.new;){var a;e.ccOffset+=r.start-i.start,r.new=!1,r=i,i=e[r.prevCC]}e.presentationOffset=n},fH=`stpp.ttml.im1t`,pH=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,mH=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,hH={left:`start`,center:`center`,right:`end`,start:`start`,end:`end`},gH=class{constructor(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=WR(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){let e=new eH(this,`textTrack1`),t=new eH(this,`textTrack2`),n=new eH(this,`textTrack3`),r=new eH(this,`textTrack4`);this.cea608Parser1=new $V(1,e,t),this.cea608Parser2=new $V(3,n,r)}e.on(G.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(G.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(G.FRAG_LOADING,this.onFragLoading,this),e.on(G.FRAG_LOADED,this.onFragLoaded,this),e.on(G.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(G.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(G.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(G.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(G.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){let{hls:e}=this;e.off(G.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(G.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(G.FRAG_LOADING,this.onFragLoading,this),e.off(G.FRAG_LOADED,this.onFragLoaded,this),e.off(G.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(G.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(G.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(G.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(G.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(e,t,n,r,i){let a=!1;for(let e=i.length;e--;){let r=i[e],o=dfe(r[0],r[1],t,n);if(o>=0&&(r[0]=Math.min(r[0],t),r[1]=Math.max(r[1],n),a=!0,o/(n-t)>.5))return}if(a||i.push([t,n]),this.config.renderTextTracksNatively){let i=this.captionsTracks[e];this.Cues.newCue(i,t,n,r)}else{let i=this.Cues.newCue(null,t,n,r);this.hls.trigger(G.CUES_PARSED,{type:`captions`,cues:i,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:i}){let{unparsedVttFrags:a}=this;n===`main`&&(this.initPTS[t.cc]={baseTime:r,timescale:i}),a.length&&(this.unparsedVttFrags=[],a.forEach(e=>{this.onFragLoaded(G.FRAG_LOADED,e)}))}getExistingTrack(e){let{media:t}=this;if(t)for(let n=0;n<t.textTracks.length;n++){let r=t.textTracks[n];if(r[e])return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;let{captionsProperties:t,captionsTracks:n,media:r}=this,{label:i,languageCode:a}=t[e],o=this.getExistingTrack(e);if(o)n[e]=o,AL(n[e]),OL(n[e],r);else{let t=this.createTextTrack(`captions`,i,a);t&&(t[e]=!0,n[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;let t=this.captionsProperties[e];if(!t)return;let n=t.label,r={_id:e,label:n,kind:`captions`,default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(G.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,n){let r=this.media;if(r)return r.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){let{captionsTracks:e}=this;Object.keys(e).forEach(t=>{AL(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=WR(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){let{media:e}=this;if(!e)return;let t=e.textTracks;if(t)for(let e=0;e<t.length;e++)AL(t[e])}onSubtitleTracksUpdated(e,t){let n=t.subtitleTracks||[],r=n.some(e=>e.textCodec===fH);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){let e=OR(this.tracks,n);if(e){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){let e=this.media?this.media.textTracks:null;this.tracks.forEach((t,n)=>{let r;if(e&&n<e.length){let n=null;for(let r=0;r<e.length;r++)if(ufe(e[r],t)){n=e[r];break}n&&(r=n)}if(r)AL(r);else{let e=this._captionsOrSubtitlesFromCharacteristics(t);r=this.createTextTrack(e,t.name,t.lang),r&&(r.mode=`disabled`)}r&&(r.groupId=t.groupId,this.textTracks.push(r))})}else if(this.tracks.length){let e=this.tracks.map(e=>({label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}));this.hls.trigger(G.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}_captionsOrSubtitlesFromCharacteristics(e){if(e.attrs.CHARACTERISTICS){let t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),n=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&n)return`captions`}return`subtitles`}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(e=>{let t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;let n=`textTrack${t[1]}`,r=this.captionsProperties[n];r&&(r.label=e.name,e.lang&&(r.languageCode=e.lang),r.media=e)})}closedCaptionsForLevel(e){let t=this.hls.levels[e.level];return t==null?void 0:t.attrs[`CLOSED-CAPTIONS`]}onFragLoading(e,t){let{cea608Parser1:n,cea608Parser2:r,lastSn:i,lastPartIndex:a}=this;if(!(!this.enabled||!(n&&r))&&t.frag.type===Jz.MAIN){var o,s;let e=t.frag.sn,c=(o=t==null||(s=t.part)==null?void 0:s.index)==null?-1:o;e===i+1||e===i&&c===a+1||(n.reset(),r.reset()),this.lastSn=e,this.lastPartIndex=c}}onFragLoaded(e,t){let{frag:n,payload:r}=t;if(n.type===Jz.SUBTITLE)if(r.byteLength){let e=n.decryptdata,i=`stats`in t;if(e==null||!e.encrypted||i){let e=this.tracks[n.level],i=this.vttCCs;i[n.cc]||(i[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),e&&e.textCodec===fH?this._parseIMSC1(n,r):this._parseVTTs(t)}}else this.hls.trigger(G.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:Error(`Empty subtitle payload`)})}_parseIMSC1(e,t){let n=this.hls;LR(t,this.initPTS[e.cc],t=>{this._appendCues(t,e.level),n.trigger(G.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},t=>{q.log(`Failed to parse IMSC1: ${t}`),n.trigger(G.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})})}_parseVTTs(e){var t;let{frag:n,payload:r}=e,{initPTS:i,unparsedVttFrags:a}=this,o=i.length-1;if(!i[n.cc]&&o===-1){a.push(e);return}let s=this.hls,c=(t=n.initSegment)!=null&&t.data?uL(n.initSegment.data,new Uint8Array(r)):r;afe(c,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,e=>{this._appendCues(e,n.level),s.trigger(G.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},t=>{let i=t.message===`Missing initPTS for VTT MPEGTS`;i?a.push(e):this._fallbackToIMSC1(n,r),q.log(`Failed to parse VTT cue: ${t}`),!(i&&o>n.cc)&&s.trigger(G.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})})}_fallbackToIMSC1(e,t){let n=this.tracks[e.level];n.textCodec||LR(t,this.initPTS[e.cc],()=>{n.textCodec=fH,this._parseIMSC1(e,t)},()=>{n.textCodec=`wvtt`})}_appendCues(e,t){let n=this.hls;if(this.config.renderTextTracksNatively){let n=this.textTracks[t];if(!n||n.mode===`disabled`)return;e.forEach(e=>kL(n,e))}else{let r=this.tracks[t];if(!r)return;let i=r.default?`default`:`subtitles`+t;n.trigger(G.CUES_PARSED,{type:`subtitles`,cues:e,track:i})}}onFragDecrypted(e,t){let{frag:n}=t;n.type===Jz.SUBTITLE&&this.onFragLoaded(G.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){let{cea608Parser1:n,cea608Parser2:r}=this;if(!this.enabled||!(n&&r))return;let{frag:i,samples:a}=t;if(!(i.type===Jz.MAIN&&this.closedCaptionsForLevel(i)===`NONE`))for(let e=0;e<a.length;e++){let t=a[e].bytes;if(t){let i=this.extractCea608Data(t);n.addData(a[e].pts,i[0]),r.addData(a[e].pts,i[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:r,type:i}){let{media:a}=this;if(!(!a||a.currentTime<n)){if(!i||i===`video`){let{captionsTracks:e}=this;Object.keys(e).forEach(r=>jL(e[r],t,n))}if(this.config.renderTextTracksNatively&&t===0&&r!==void 0){let{textTracks:e}=this;Object.keys(e).forEach(n=>jL(e[n],t,r))}}}extractCea608Data(e){let t=[[],[]],n=e[0]&31,r=2;for(let i=0;i<n;i++){let n=e[r++],i=127&e[r++],a=127&e[r++];if(i===0&&a===0)continue;let o=(4&n)!=0;if(o){let e=3&n;(e===0||e===1)&&(t[e].push(i),t[e].push(a))}}return t}},_H=class e{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=1/0,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){let{hls:e}=this;e.on(G.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(G.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(G.MANIFEST_PARSED,this.onManifestParsed,this),e.on(G.BUFFER_CODECS,this.onBufferCodecs,this),e.on(G.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){let{hls:e}=this;e.off(G.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(G.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(G.MANIFEST_PARSED,this.onManifestParsed,this),e.off(G.BUFFER_CODECS,this.onBufferCodecs,this),e.off(G.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){let n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null}onManifestParsed(e,t){let n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onBufferCodecs(e,t){let n=this.hls;n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){let e=this.hls.levels;if(e.length){let t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(t){let n=this.hls.levels;if(!n.length)return-1;let r=n.filter((e,n)=>this.isLevelAllowed(e)&&n<=t);return this.clientRect=null,e.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=1/0,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=1/0,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;let e=this.media,t={width:0,height:0};if(e){let n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return e}isLevelAllowed(e){let t=this.restrictedLevels;return!t.some(t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;let r=(e,t)=>t?e.width!==t.width||e.height!==t.height:!0,i=e.length-1;for(let a=0;a<e.length;a+=1){let o=e[a];if((o.width>=t||o.height>=n)&&r(o,e[a+1])){i=a;break}}return i}},vH=class{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(G.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(G.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){let n=this.hls.config;if(n.capLevelOnFPSDrop){let e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&typeof e.getVideoPlaybackQuality==`function`&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){let r=performance.now();if(t){if(this.lastTime){let e=r-this.lastTime,i=n-this.lastDroppedFrames,a=t-this.lastDecodedFrames,o=1e3*i/e,s=this.hls;if(s.trigger(G.FPS_DROP,{currentDropped:i,currentDecoded:a,totalDroppedFrames:n}),o>0&&i>s.config.fpsDroppedMonitoringThreshold*a){let e=s.currentLevel;q.warn(`drop FPS ratio greater than max allowed value for currentLevel: `+e),e>0&&(s.autoLevelCapping===-1||s.autoLevelCapping>=e)&&(--e,s.trigger(G.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:s.currentLevel}),s.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){let e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){let t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}},yH=`[eme]`,bH=class e{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=e.CDMCleanupPromise?[e.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=q.debug.bind(q,yH),this.log=q.log.bind(q,yH),this.warn=q.warn.bind(q,yH),this.error=q.error.bind(q,yH),this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();let e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(G.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(G.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(G.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(G.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(G.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(G.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){let{drmSystems:t,widevineLicenseUrl:n}=this.config,r=t[e];if(r)return r.licenseUrl;if(e===fz.WIDEVINE&&n)return n;throw Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){let{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){let t=this.hls.levels,n=(e,t,n)=>!!e&&n.indexOf(e)===t,r=t.map(e=>e.audioCodec).filter(n),i=t.map(e=>e.videoCodec).filter(n);return r.length+i.length===0&&i.push(`avc1.42e01e`),new Promise((t,n)=>{let a=e=>{let o=e.shift();this.getMediaKeysPromise(o,r,i).then(e=>t({keySystem:o,mediaKeys:e})).catch(t=>{e.length?a(e):t instanceof xH?n(t):n(new xH({type:ZR.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))})};a(e)})}requestMediaKeySystemAccess(e,t){let{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!=`function`){let e=`Configured requestMediaKeySystemAccess is not a function ${n}`;return hz===null&&self.location.protocol===`http:`&&(e=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(Error(e))}return n(e,t)}getMediaKeysPromise(e,t,n){let r=Yue(e,t,n,this.config.drmSystemOptions),i=this.keySystemAccessPromises[e],a=i==null?void 0:i.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(r)}`),a=this.requestMediaKeySystemAccess(e,r);let t=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(t=>{this.log(`Failed to obtain access to key-system "${e}": ${t}`)}),a.then(n=>{this.log(`Access for key-system "${n.keySystem}" obtained`);let r=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),t.mediaKeys=n.createMediaKeys().then(t=>(this.log(`Media-keys created for "${e}"`),r.then(n=>n?this.setMediaKeysServerCertificate(t,e,n):t))),t.mediaKeys.catch(t=>{this.error(`Failed to create media-keys for "${e}"}: ${t}`)}),t.mediaKeys})}return a.then(()=>i.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${Mz.hexDump(e.keyId||[])}`);let r=n.createSession(),i={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:r,keyStatus:`status-pending`};return this.mediaKeySessions.push(i),i}renewKeySession(e){let t=e.decryptdata;if(t.pssh){let n=this.createMediaKeySessionContext(e),r=this.getKeyIdString(t);this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(n,`cenc`,t.pssh,`expired`)}else this.warn(`Could not renew expired session. Missing pssh initData.`);this.removeSession(e)}getKeyIdString(e){if(!e)throw Error(`Could not read keyId of undefined decryptdata`);if(e.keyId===null)throw Error(`keyId is null`);return Mz.hexDump(e.keyId)}updateKeySession(e,t){var n;let r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyID ${Mz.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),r.update(t)}selectKeySystemFormat(e){let t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(`, `)}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{let r=eL(this.config),i=e.map(QI).filter(e=>!!e&&r.indexOf(e)!==-1);return this.getKeySystemSelectionPromise(i).then(({keySystem:e})=>{let r=$I(e);r?t(r):n(Error(`Unable to find format for key-system "${e}"`))}).catch(n)})}loadKey(e){let t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),r=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${r}`);let i=this.keyIdToKeySessionPromise[n];return i||(i=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then(({keySystem:n,mediaKeys:i})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${r}`),this.attemptSetMediaKeys(n,i).then(()=>{this.throwIfDestroyed();let e=this.createMediaKeySessionContext({keySystem:n,mediaKeys:i,decryptdata:t});return this.generateRequestWithPreferredKeySession(e,`cenc`,t.pssh,`playlist-key`)}))),i.catch(e=>this.handleError(e))),i}throwIfDestroyed(e=`Invalid state`){if(!this.hls)throw Error(`invalid state`)}handleError(e){this.hls&&(this.error(e.message),e instanceof xH?this.hls.trigger(G.ERROR,e.data):this.hls.trigger(G.ERROR,{type:ZR.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){let t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){let t=QI(e.keyFormat),n=t?[t]:eL(this.config);return this.attemptKeySystemAccess(n)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=eL(this.config)),e.length===0)throw new xH({type:ZR.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){let{initDataType:t,initData:n}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),n===null)return;let r,i;if(t===`sinf`&&this.config.drmSystems[fz.FAIRPLAY]){let e=nL(new Uint8Array(n));try{let t=XI(JSON.parse(e).sinf),n=lL(new Uint8Array(t));if(!n)return;r=n.subarray(8,24),i=fz.FAIRPLAY}catch(e){this.warn(`Failed to parse sinf "encrypted" event message initData`);return}}else{let e=ude(n);if(e===null)return;e.version===0&&e.systemId===mz.WIDEVINE&&e.data&&(r=e.data.subarray(8,24)),i=Jue(e.systemId)}if(!i||!r)return;let a=Mz.hexDump(r),{keyIdToKeySessionPromise:o,mediaKeySessions:s}=this,c=o[a];for(let e=0;e<s.length;e++){let i=s[e],l=i.decryptdata;if(l.pssh||!l.keyId)continue;let u=Mz.hexDump(l.keyId);if(a===u||l.uri.replace(/-/g,``).indexOf(a)!==-1){c=o[u],delete o[u],l.pssh=new Uint8Array(n),l.keyId=r,c=o[a]=c.then(()=>this.generateRequestWithPreferredKeySession(i,t,n,`encrypted-event-key-match`));break}}c||(c=o[a]=this.getKeySystemSelectionPromise([i]).then(({keySystem:e,mediaKeys:i})=>{var o;this.throwIfDestroyed();let s=new Lz(`ISO-23001-7`,a,(o=$I(e))==null?``:o);return s.pssh=new Uint8Array(n),s.keyId=r,this.attemptSetMediaKeys(e,i).then(()=>{this.throwIfDestroyed();let r=this.createMediaKeySessionContext({decryptdata:s,keySystem:e,mediaKeys:i});return this.generateRequestWithPreferredKeySession(r,t,n,`encrypted-event-no-match`)})})),c.catch(e=>this.handleError(e))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){let n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);let r=Promise.all(n).then(()=>{if(!this.media)throw Error(`Attempted to set mediaKeys without media element attached`);return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(e=>n.indexOf(e)===-1)})}generateRequestWithPreferredKeySession(e,t,n,r){var i,a;let o=(i=this.config.drmSystems)==null||(a=i[e.keySystem])==null?void 0:a.generateRequest;if(o)try{let r=o.call(this.hls,t,n,e);if(!r)throw Error(`Invalid response from configured generateRequest filter`);t=r.initDataType,n=e.decryptdata.pssh=r.initData?new Uint8Array(r.initData):null}catch(e){var s;if(this.warn(e.message),(s=this.hls)!=null&&s.config.debug)throw e}if(n===null)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);let c=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${r}": ${c} (init data type: ${t} length: ${n?n.byteLength:null})`);let l=new fV;e.mediaKeysSession.onmessage=t=>{let n=e.mediaKeysSession;if(!n){l.emit(`error`,Error(`invalid state`));return}let{messageType:r,message:i}=t;this.log(`"${r}" message event for session "${n.sessionId}" message size: ${i.byteLength}`),r===`license-request`||r===`license-renewal`?this.renewLicense(e,i).catch(e=>{this.handleError(e),l.emit(`error`,e)}):r===`license-release`?e.keySystem===fz.FAIRPLAY&&(this.updateKeySession(e,ZI(`acknowledged`)),this.removeSession(e)):this.warn(`unhandled media key message type "${r}"`)},e.mediaKeysSession.onkeystatuseschange=t=>{let n=e.mediaKeysSession;if(!n){l.emit(`error`,Error(`invalid state`));return}this.onKeyStatusChange(e);let r=e.keyStatus;l.emit(`keyStatus`,r),r===`expired`&&(this.warn(`${e.keySystem} expired for key ${c}`),this.renewKeySession(e))};let u=new Promise((e,t)=>{l.on(`error`,t),l.on(`keyStatus`,n=>{n.startsWith(`usable`)?e():n===`output-restricted`?t(new xH({type:ZR.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},`HDCP level output restricted`)):n===`internal-error`?t(new xH({type:ZR.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${n}"`)):n===`expired`?t(Error(`key expired while generating request`)):this.warn(`unhandled key status change "${n}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var t;this.log(`Request generated for key-session "${(t=e.mediaKeysSession)==null?void 0:t.sessionId}" keyId: ${c}`)}).catch(e=>{throw new xH({type:ZR.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},`Error generating key-session request: ${e}`)}).then(()=>u).catch(t=>{throw l.removeAllListeners(),this.removeSession(e),t}).then(()=>(l.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${Mz.hexDump(`buffer`in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${Mz.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){let t=this.config,n=t.loader,r=new n(t),i=this.getServerCertificateUrl(e);return i?(this.log(`Fetching serverCertificate for "${e}"`),new Promise((n,a)=>{let o={responseType:`arraybuffer`,url:i},s=t.certLoadPolicy.default,c={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},l={onSuccess:(e,t,r,i)=>{n(e.data)},onError:(t,n,r,s)=>{a(new xH({type:ZR.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:JI({url:o.url,data:void 0},t)},`"${e}" certificate request failed (${i}). Status: ${t.code} (${t.text})`))},onTimeout:(t,n,r)=>{a(new xH({type:ZR.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:{url:o.url,data:void 0}},`"${e}" certificate request timed out (${i})`))},onAbort:(e,t,n)=>{a(Error(`aborted`))}};r.load(o,c,l)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((r,i)=>{e.setServerCertificate(n).then(i=>{this.log(`setServerCertificate ${i?`success`:`not supported by CDM`} (${n==null?void 0:n.byteLength}) on "${t}"`),r(e)}).catch(e=>{i(new xH({type:ZR.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(t=>this.updateKeySession(e,new Uint8Array(t)).catch(e=>{throw new xH({type:ZR.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))}setupLicenseXHR(e,t,n,r){let i=this.config.licenseXhrSetup;return i?Promise.resolve().then(()=>{if(!n.decryptdata)throw Error(`Key removed`);return i.call(this.hls,e,t,n,r)}).catch(a=>{if(!n.decryptdata)throw a;return e.open(`POST`,t,!0),i.call(this.hls,e,t,n,r)}).then(n=>{e.readyState||e.open(`POST`,t,!0);let i=n||r;return{xhr:e,licenseChallenge:i}}):(e.open(`POST`,t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){let n=this.config.keyLoadPolicy.default;return new Promise((r,i)=>{let a=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${a}`);let o=new XMLHttpRequest;o.responseType=`arraybuffer`,o.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return i(Error(`invalid state`));if(o.readyState===4)if(o.status===200){this._requestLicenseFailureCount=0;let t=o.response;this.log(`License received ${t instanceof ArrayBuffer?t.byteLength:t}`);let n=this.config.licenseResponseCallback;if(n)try{t=n.call(this.hls,o,a,e)}catch(e){this.error(e)}r(t)}else{let s=n.errorRetry,c=s?s.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>c||o.status>=400&&o.status<500)i(new xH({type:ZR.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:a,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${a}). Status: ${o.status} (${o.statusText})`));else{let n=c-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${n} attempts left`),this.requestLicense(e,t).then(r,i)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,a,e,t).then(({xhr:e,licenseChallenge:t})=>{e.send(t)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;let n=t.media;this.media=n,n.addEventListener(`encrypted`,this.onMediaEncrypted),n.addEventListener(`waitingforkey`,this.onWaitingForKey)}onMediaDetached(){let t=this.media,n=this.mediaKeySessions;t&&(t.removeEventListener(`encrypted`,this.onMediaEncrypted),t.removeEventListener(`waitingforkey`,this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Lz.clearKeyUriToKeyIdMap();let r=n.length;e.CDMCleanupPromise=Promise.all(n.map(e=>this.removeSession(e)).concat(t==null?void 0:t.setMediaKeys(null).catch(e=>{this.log(`Could not clear media keys: ${e}. media.src: ${t==null?void 0:t.src}`)}))).then(()=>{r&&(this.log(`finished closing key sessions and clearing media keys`),n.length=0)}).catch(e=>{this.log(`Could not close sessions and clear media keys: ${e}. media.src: ${t==null?void 0:t.src}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){let e=t.reduce((e,t)=>(e.indexOf(t.keyFormat)===-1&&e.push(t.keyFormat),e),[]);this.log(`Selecting key-system from session-keys ${e.join(`, `)}`),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){let{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),t.onmessage=null,t.onkeystatuseschange=null,n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;let r=this.mediaKeySessions.indexOf(e);return r>-1&&this.mediaKeySessions.splice(r,1),t.remove().catch(e=>{this.log(`Could not remove session: ${e}`)}).then(()=>t.close()).catch(e=>{this.log(`Could not close session: ${e}`)})}}},bH.CDMCleanupPromise=void 0,xH=class extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=Error(t)),this.data=e,e.err=e.error}},SH=1,CH={MANIFEST:`m`,AUDIO:`a`,VIDEO:`v`,MUXED:`av`,INIT:`i`,CAPTION:`c`,TIMED_TEXT:`tt`,KEY:`k`,OTHER:`o`},wH=`h`,TH=class e{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=e=>{try{this.apply(e,{ot:CH.MANIFEST,su:!this.initialized})}catch(e){q.warn(`Could not generate manifest CMCD data.`,e)}},this.applyFragmentData=e=>{try{let t=e.frag,n=this.hls.levels[t.level],r=this.getObjectType(t),i={d:t.duration*1e3,ot:r};(r===CH.VIDEO||r===CH.AUDIO||r==CH.MUXED)&&(i.br=n.bitrate/1e3,i.tb=this.getTopBandwidth(r)/1e3,i.bl=this.getBufferLength(r)),this.apply(e,i)}catch(e){q.warn(`Could not generate segment CMCD data.`,e)}},this.hls=t;let n=this.config=t.config,{cmcd:r}=n;r!=null&&(n.pLoader=this.createPlaylistLoader(),n.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||e.uuid(),this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.registerListeners())}registerListeners(){let e=this.hls;e.on(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(G.MEDIA_DETACHED,this.onMediaDetached,this),e.on(G.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){let e=this.hls;e.off(G.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(G.MEDIA_DETACHED,this.onMediaDetached,this),e.off(G.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener(`waiting`,this.onWaiting),this.media.addEventListener(`playing`,this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener(`waiting`,this.onWaiting),this.media.removeEventListener(`playing`,this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,r;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(r=t.tracks.video)==null?void 0:r.buffer}createData(){var e;return{v:SH,sf:wH,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t,n={}){YI(n,this.createData());let r=n.ot===CH.INIT||n.ot===CH.VIDEO||n.ot===CH.MUXED;if(this.starved&&r&&(n.bs=!0,n.su=!0,this.starved=!1),n.su==null&&(n.su=this.buffering),this.useHeaders){let r=e.toHeaders(n);if(!Object.keys(r).length)return;t.headers||(t.headers={}),YI(t.headers,r)}else{let r=e.toQuery(n);if(!r)return;t.url=e.appendQueryToUri(t.url,r)}}getObjectType(e){let{type:t}=e;if(t===`subtitle`)return CH.TIMED_TEXT;if(e.sn===`initSegment`)return CH.INIT;if(t===`audio`)return CH.AUDIO;if(t===`main`)return this.hls.audioTracks.length?CH.VIDEO:CH.MUXED}getTopBandwidth(e){let t=0,n,r=this.hls;if(e===CH.AUDIO)n=r.audioTracks;else{let e=r.maxAutoLevel,t=e>-1?e+1:r.levels.length;n=r.levels.slice(0,t)}for(let e of n)e.bitrate>t&&(t=e.bitrate);return t>0?t:NaN}getBufferLength(e){let t=this.hls.media,n=e===CH.AUDIO?this.audioBuffer:this.videoBuffer;if(!n||!t)return NaN;let r=xB.bufferInfo(n,t.currentTime,this.config.maxBufferHole);return r.len*1e3}createPlaylistLoader(){let{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,r){t(e),this.loader.load(e,n,r)}}}createFragmentLoader(){let{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,r){t(e),this.loader.load(e,n,r)}}}static uuid(){let e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf(`/`)+1)}static serialize(e){let t=[],n=e=>!Number.isNaN(e)&&e!=null&&e!==``&&e!==!1,r=e=>Math.round(e),i=e=>r(e/100)*100,a=e=>encodeURIComponent(e),o={br:r,d:r,bl:i,dl:i,mtp:i,nor:a,rtp:i,tb:r},s=Object.keys(e||{}).sort();for(let r of s){let i=e[r];if(!n(i)||r===`v`&&i===1||r==`pr`&&i===1)continue;let a=o[r];a&&(i=a(i));let s=typeof i,c;c=r===`ot`||r===`sf`||r===`st`?`${r}=${i}`:s===`boolean`?r:s===`number`?`${r}=${i}`:`${r}=${JSON.stringify(i)}`,t.push(c)}return t.join(`,`)}static toHeaders(t){let n=Object.keys(t),r={},i=[`Object`,`Request`,`Session`,`Status`],a=[{},{},{},{}],o={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(let e of n){let n=o[e]==null?1:o[e];a[n][e]=t[e]}for(let t=0;t<a.length;t++){let n=e.serialize(a[t]);n&&(r[`CMCD-${i[t]}`]=n)}return r}static toQuery(t){return`CMCD=${encodeURIComponent(e.serialize(t))}`}static appendQueryToUri(e,t){if(!t)return e;let n=e.includes(`?`)?`&`:`?`;return`${e}${n}${t}`}},EH=3e5,DH=class{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=`.`,this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=q.log.bind(q,`[content-steering]:`),this.registerListeners()}registerListeners(){let e=this.hls;e.on(G.MANIFEST_LOADING,this.onManifestLoading,this),e.on(G.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(G.MANIFEST_PARSED,this.onManifestParsed,this),e.on(G.ERROR,this.onError,this)}unregisterListeners(){let e=this.hls;e&&(e.off(G.MANIFEST_LOADING,this.onManifestLoading,this),e.off(G.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(G.MANIFEST_PARSED,this.onManifestParsed,this),e.off(G.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){let e=Math.max(this.timeToLoad*1e3-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){let t=this.levels;t&&(this.levels=t.filter(t=>t!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=`.`,this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){let{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){let{errorAction:n}=t;if((n==null?void 0:n.action)===sB.SendAlternateToPenaltyBox&&n.flags===cB.MoveAllAlternatesMatchingHost){let e=this.pathwayPriority,t=this.pathwayId;this.penalizedPathways[t]||(this.penalizedPathways[t]=performance.now()),!e&&this.levels&&(e=this.levels.reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])),e&&e.length>1&&(this.updatePathwayPriority(e),n.resolved=this.pathwayId!==t)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){let n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length===e.length?e:(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t)}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t,n=this.penalizedPathways,r=performance.now();Object.keys(n).forEach(e=>{r-n[e]>EH&&delete n[e]});for(let r=0;r<e.length;r++){let i=e[r];if(n[i])continue;if(i===this.pathwayId)return;let a=this.hls.nextLoadLevel,o=this.hls.levels[a];if(t=this.getLevelsForPathway(i),t.length>0){this.log(`Setting Pathway to "${i}"`),this.pathwayId=i,this.hls.trigger(G.LEVELS_UPDATED,{levels:t});let e=this.hls.levels[a];o&&e&&this.levels&&(e.attrs[`STABLE-VARIANT-ID`]!==o.attrs[`STABLE-VARIANT-ID`]&&e.bitrate!==o.bitrate&&this.log(`Unstable Pathways change from bitrate ${o.bitrate} to ${e.bitrate}`),this.hls.nextLoadLevel=a);break}}}clonePathways(e){let t=this.levels;if(!t)return;let n={},r={};e.forEach(e=>{let{ID:i,"BASE-ID":a,"URI-REPLACEMENT":o}=e;if(t.some(e=>e.pathwayId===i))return;let s=this.getLevelsForPathway(a).map(e=>{let t=YI({},e);t.details=void 0,t.url=KR(e.uri,e.attrs[`STABLE-VARIANT-ID`],`PER-VARIANT-URIS`,o);let a=new rz(e.attrs);a[`PATHWAY-ID`]=i;let s=a.AUDIO&&`${a.AUDIO}_clone_${i}`,c=a.SUBTITLES&&`${a.SUBTITLES}_clone_${i}`;s&&(n[a.AUDIO]=s,a.AUDIO=s),c&&(r[a.SUBTITLES]=c,a.SUBTITLES=c),t.attrs=a;let l=new iB(t);return qL(l,`audio`,s),qL(l,`text`,c),l});t.push(...s),GR(this.audioTracks,n,o,i),GR(this.subtitleTracks,r,o,i)})}loadSteeringManifest(e){let t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let r;try{r=new self.URL(e)}catch(t){this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(r.protocol!==`data:`){let e=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;r.searchParams.set(`_HLS_pathway`,this.pathwayId),r.searchParams.set(`_HLS_throughput`,``+e)}let i={responseType:`json`,url:r.href},a=t.steeringManifestLoadPolicy.default,o=a.errorRetry||a.timeoutRetry||{},s={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},c={onSuccess:(e,t,n,i)=>{this.log(`Loaded steering manifest: "${r}"`);let a=e.data;if(a.VERSION!==1){this.log(`Steering VERSION ${a.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=a.TTL;let{"RELOAD-URI":o,"PATHWAY-CLONES":s,"PATHWAY-PRIORITY":c}=a;if(o)try{this.uri=new self.URL(o,r).href}catch(e){this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${o}`);return}this.scheduleRefresh(this.uri||n.url),s&&this.clonePathways(s),c&&this.updatePathwayPriority(c)},onError:(e,t,n,r)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),this.stopLoad(),e.code===410){this.enabled=!1,this.log(`Steering manifest ${t.url} no longer available`);return}let i=this.timeToLoad*1e3;if(e.code===429){let e=this.loader;if(typeof(e==null?void 0:e.getResponseHeader)==`function`){let t=e.getResponseHeader(`Retry-After`);t&&(i=parseFloat(t)*1e3)}this.log(`Steering manifest ${t.url} rate limited`);return}this.scheduleRefresh(this.uri||t.url,i)},onTimeout:(e,t,n)=>{this.log(`Timeout loading steering manifest (${t.url})`),this.scheduleRefresh(this.uri||t.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(i,s,c)}scheduleRefresh(e,t=this.timeToLoad*1e3){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout(()=>{this.loadSteeringManifest(e)},t)}},OH=/^age:\s*[\d.]+\s*$/im,kH=class{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new az,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){let e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw Error(`Loader can only be used once.`);this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){let{config:e,context:t}=this;if(!e)return;let n=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;let i=this.xhrSetup;i?Promise.resolve().then(()=>{if(!this.stats.aborted)return i(n,t.url)}).catch(e=>(n.open(`GET`,t.url,!0),i(n,t.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(e=>{this.callbacks.onError({code:n.status,text:e.message},t,n,r)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open(`GET`,t.url,!0);let r=this.context.headers,{maxTimeToFirstByteMs:i,maxLoadTimeMs:a}=n.loadPolicy;if(r)for(let t in r)e.setRequestHeader(t,r[t]);t.rangeEnd&&e.setRequestHeader(`Range`,`bytes=`+t.rangeStart+`-`+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=i&&XR(i)?i:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){let{context:e,loader:t,stats:n}=this;if(!e||!t)return;let r=t.readyState,i=this.config;if(!n.aborted&&r>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),i.timeout!==i.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),i.timeout=i.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;let r=t.status,a=t.responseType!==`text`;if(r>=200&&r<300&&(a&&t.response||t.responseText!==null)){n.loading.end=Math.max(self.performance.now(),n.loading.first);let i=a?t.response:t.responseText,o=t.responseType===`arraybuffer`?i.byteLength:i.length;if(n.loaded=n.total=o,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first),!this.callbacks)return;let s=this.callbacks.onProgress;if(s&&s(n,e,i,t),!this.callbacks)return;let c={url:t.responseURL,data:i,code:r};this.callbacks.onSuccess(c,n,e,t)}else{let a=i.loadPolicy.errorRetry,o=n.retry;WL(a,o,!1,r)?this.retry(a):(q.error(`${r} while loading ${e.url}`),this.callbacks.onError({code:r,text:t.statusText},e,t,n))}}}loadtimeout(){var e;let t=(e=this.config)==null?void 0:e.loadPolicy.timeoutRetry,n=this.stats.retry;if(WL(t,n,!0))this.retry(t);else{q.warn(`timeout while loading ${this.context.url}`);let e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){let{context:t,stats:n}=this;this.retryDelay=HL(e,n.retry),n.retry++,q.warn(`${status?`HTTP Status `+status:`Timeout`} while loading ${t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){let t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&OH.test(this.loader.getAllResponseHeaders())){let t=this.loader.getResponseHeader(`age`);e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&RegExp(`^${e}:\\s*[\\d.]+\\s*$`,`im`).test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}},AH=/(\d+)-(\d+)\/(\d+)/,jH=class{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||gfe,this.controller=new self.AbortController,this.stats=new az}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){let e=this.response;e!=null&&e.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){let r=this.stats;if(r.loading.start)throw Error(`Loader can only be used once.`);r.loading.start=self.performance.now();let i=pfe(e,this.controller.signal),a=n.onProgress,o=e.responseType===`arraybuffer`,s=o?`byteLength`:`length`,{maxTimeToFirstByteMs:c,maxLoadTimeMs:l}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,i),self.clearTimeout(this.requestTimeout),t.timeout=c&&XR(c)?c:l,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(r,e,this.response)},t.timeout),self.fetch(this.request).then(i=>{this.response=this.loader=i;let s=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=l,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(r,e,this.response)},l-(s-r.loading.start)),!i.ok){let{status:e,statusText:t}=i;throw new MH(t||`fetch, bad network response`,e,i)}return r.loading.first=s,r.total=hfe(i.headers)||r.total,a&&XR(t.highWaterMark)?this.loadProgressively(i,r,e,t.highWaterMark,a):o?i.arrayBuffer():e.responseType===`json`?i.json():i.text()}).then(i=>{let{response:o}=this;self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);let c=i[s];c&&(r.loaded=r.total=c);let l={url:o.url,data:i,code:o.status};a&&!XR(t.highWaterMark)&&a(r,e,i,o),n.onSuccess(l,r,e,o)}).catch(t=>{if(self.clearTimeout(this.requestTimeout),r.aborted)return;let i=t&&t.code||0,a=t?t.message:null;n.onError({code:i,text:a},e,t?t.details:null,r)})}getCacheAge(){let e=null;if(this.response){let t=this.response.headers.get(`age`);e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,r=0,i){let a=new TV,o=e.body.getReader(),s=()=>o.read().then(o=>{if(o.done)return a.dataLength&&i(t,n,a.flush(),e),Promise.resolve(new ArrayBuffer(0));let c=o.value,l=c.length;return t.loaded+=l,l<r||a.dataLength?(a.push(c),a.dataLength>=r&&i(t,n,a.flush(),e)):i(t,n,c,e),s()}).catch(()=>Promise.reject());return s()}},MH=class extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}},NH=/\s/,PH={newCue(e,t,n,r){let i=[],a,o,s,c,l,u=self.VTTCue||self.TextTrackCue;for(let f=0;f<r.rows.length;f++)if(a=r.rows[f],s=!0,c=0,l=``,!a.isEmpty()){var d;for(let e=0;e<a.chars.length;e++)NH.test(a.chars[e].uchar)&&s?c++:(l+=a.chars[e].uchar,s=!1);a.cueStartTime=t,t===n&&(n+=1e-4),c>=16?c--:c++;let r=FR(l.trim()),p=IR(t,n,r);e!=null&&(d=e.cues)!=null&&d.getCueById(p)||(o=new u(t,n,r),o.id=p,o.line=f+1,o.align=`left`,o.position=10+Math.min(80,Math.floor(c*8/32)*10),i.push(o))}return e&&i.length&&(i.sort((e,t)=>e.line===`auto`||t.line===`auto`?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line),i.forEach(t=>kL(e,t))),i}},FH={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},IH=JI(JI({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:kH,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:wV,bufferController:IV,capLevelController:_H,errorController:lB,fpsController:vH,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:hz,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:FH},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:`linear`},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:`linear`}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},_fe()),{},{subtitleStreamController:AV,subtitleTrackController:MV,timelineController:gH,audioStreamController:DV,audioTrackController:OV,emeController:bH,cmcdController:TH,contentSteeringController:DH}),LH=class e{static get version(){return`1.4.12`}static isSupported(){return Lde()}static get Events(){return G}static get ErrorTypes(){return ZR}static get ErrorDetails(){return K}static get DefaultConfig(){return e.defaultConfig?e.defaultConfig:IH}static set DefaultConfig(t){e.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new fV,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,Hue(t.debug||!1,`Hls instance`);let n=this.config=vfe(e.DefaultConfig,t);this.userConfig=t,this._autoLevelCapping=-1,n.progressive&&yfe(n);let{abrController:r,bufferController:i,capLevelController:a,errorController:o,fpsController:s}=n,c=new o(this),l=this.abrController=new r(this),u=this.bufferController=new i(this),d=this.capLevelController=new a(this),f=new s(this),p=new Yz(this),m=new $z(this),h=n.contentSteeringController,g=h?new h(this):null,_=this.levelController=new fB(this,g),v=new mB(this),y=new vB(this.config),b=this.streamController=new xV(this,v,y);d.setStreamController(b),f.setStreamController(b);let ee=[p,_,b];g&&ee.splice(1,0,g),this.networkControllers=ee;let te=[l,u,d,f,m,v];this.audioTrackController=this.createController(n.audioTrackController,ee);let ne=n.audioStreamController;ne&&ee.push(new ne(this,v,y)),this.subtitleTrackController=this.createController(n.subtitleTrackController,ee);let re=n.subtitleStreamController;re&&ee.push(new re(this,v,y)),this.createController(n.timelineController,te),y.emeController=this.emeController=this.createController(n.emeController,te),this.cmcdController=this.createController(n.cmcdController,te),this.latencyController=this.createController(eB,te),this.coreComponents=te,ee.push(c);let ie=c.onErrorOut;typeof ie==`function`&&this.on(G.ERROR,ie,c)}createController(e,t){if(e){let n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,r){this._emitter.off(e,t,n,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){q.error(`An internal error happened while handling event `+e+`. Error message: "`+t.message+`". Here is a stacktrace:`,t),this.trigger(G.ERROR,{type:ZR.OTHER_ERROR,details:K.INTERNAL_EXCEPTION,fatal:!1,event:e,error:t})}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){q.log(`destroy`),this.trigger(G.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(e=>e.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(e=>e.destroy()),this.coreComponents.length=0;let e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){q.log(`attachMedia`),this._media=e,this.trigger(G.MEDIA_ATTACHING,{media:e})}detachMedia(){q.log(`detachMedia`),this.trigger(G.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();let t=this.media,n=this.url,r=this.url=YR.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});q.log(`loadSource:${r}`),t&&n&&(n!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(G.MANIFEST_LOADING,{url:e})}startLoad(e=-1){q.log(`startLoad(${e})`),this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){q.log(`stopLoad`),this.networkControllers.forEach(e=>{e.stopLoad()})}swapAudioCodec(){q.log(`swapAudioCodec`),this.streamController.swapAudioCodec()}recoverMediaError(){q.log(`recoverMediaError`);let e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e,t=0){this.levelController.removeLevel(e,t)}get levels(){let e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){q.log(`set currentLevel:${e}`),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){q.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){q.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){q.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){return this.levelController.startLevel}set startLevel(e){q.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){let t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){let{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}get ttfbEstimate(){let{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(q.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){tB.indexOf(e)>-1&&(this._maxHdcpLevel=e)}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){let{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;let n=e.length;for(let r=0;r<n;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){let{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this,r;if(r=t===-1&&e&&e.length?e.length-1:t,n)for(let t=r;t--;){let r=e[t].attrs[`HDCP-LEVEL`];if(r&&r<=n)return t}return r}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){let e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){let e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){let t=this.audioTrackController;t&&(t.audioTrack=e)}get subtitleTracks(){let e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){let e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){let t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){let e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){let t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}},LH.defaultConfig=void 0})),RH,xfe=o((()=>{bfe(),$(),E(),RH=class{constructor(e){T(this,`_config`,void 0),T(this,`_fatalErrorCallback`,void 0),T(this,`_hls`,void 0),T(this,`_logPrefix`,`HlsManager`),T(this,`_videoEl`,void 0),T(this,`_setupComplete`,!1),this._config=e.config,this._fatalErrorCallback=e.fatalErrorCallback,this._videoEl=e.videoEl,this._hls=new LH(this._getConfig())}isSupported(){return LH.isSupported()}loadSource(e){this._hls.loadSource(e),this._hls.attachMedia(this._videoEl),this._registerEvents()}setMaxBufferLength(e){!this._config.maxMaxBufferReset&&this._hls.config.maxMaxBufferLength!==e&&(this._hls.config.maxBufferLength=e)}reset(){this._hls.destroy(),this._hls=new LH,this._setupComplete=!1}_getConfig(){let e={backBufferLength:this._config.backBufferLength,maxMaxBufferLength:this._config.maxMaxBufferLength,maxBufferSize:this._config.maxBufferSize,maxBufferLength:this._config.maxBufferLength,frontBufferFlushThreshold:this._config.frontBufferThreshold};return e}_registerEvents(){this._setupComplete||(this.setMaxBufferLength(1),this._hls.on(LH.Events.ERROR,this._onError.bind(this)),this._setupComplete=!0)}_onError(e,t){t.fatal&&(M.error(this._logPrefix,`_onError`,{event:e,data:t}),this._handleFatalHLSError(e,t))}_handleFatalHLSError(e,t){switch(M.error(this._logPrefix,`_handleFatalHLSError`,{event:e,data:t}),t.type){case LH.ErrorTypes.MEDIA_ERROR:this._hls.recoverMediaError();break;case LH.ErrorTypes.NETWORK_ERROR:default:this._fatalErrorCallback();break}}}})),zH,Sfe=o((()=>{zH={AWAITING_START:1,AWAITING_FETCH_AD:2,AWAITING_SHOW_BUTTONS:3,AWAITING_ADVANCE:4}})),BH,VH,HH,UH,WH,Cfe=o((()=>{wp(),$(),Sfe(),E(),BH=200,VH=.5,HH=10,UH=5,WH=class{constructor(e,t,n,r,i,a,o,s){this._parentElement=e,this._wasAdFetched=t,this._fetchAd=n,this._advanceToAd=r,this._advanceToContent=i,this._nextButtonClick=a,this._stayButtonClick=o,this._cancel=s,T(this,`_logPrefix`,`AdvancePlaylist`),T(this,`_buttons`,void 0),T(this,`_isVisible`,!1),T(this,`_state`,zH.AWAITING_FETCH_AD),T(this,`_lastVisibilityState`,document.visibilityState),T(this,`_intervalId`,void 0),T(this,`_startTime`,0),T(this,`_elapsedTime`,0),T(this,`_hiddenStartTime`,0),T(this,`_defaultAdvancePlaylistDuration`,30),T(this,`_fetchAdThreshold`,0),T(this,`_showButtonsThreshold`,0),T(this,`_advanceThreshold`,0),T(this,`_shouldAdvanceToContent`,!1),T(this,`_nextAdvancePlaylistDuration`,void 0),T(this,`_shouldUseCumulativeContentDuration`,!1),T(this,`_cumulativeContentDuration`,0),T(this,`_interactionHandler`,this._handleInteractation.bind(this)),T(this,`_adPodDuration`,0),T(this,`_adPodSize`,0),T(this,`_stateHandlers`,{[zH.AWAITING_START]:this._handleAwaitingStart.bind(this),[zH.AWAITING_FETCH_AD]:this._handleAwaitingFetchAd.bind(this),[zH.AWAITING_SHOW_BUTTONS]:this._handleAwaitingShowButtons.bind(this),[zH.AWAITING_ADVANCE]:this._handleAwaitingAdvance.bind(this)}),T(this,`_throttledKeydownHandler`,Sp((e,t)=>{[`Space`,`Enter`].includes(e.code)&&(e.preventDefault(),t())},100)),this._buttons=this._createButtons(),this._parentElement.appendChild(this._buttons),this._parentElement.addEventListener(`click`,this._interactionHandler),this._parentElement.addEventListener(`keyup`,this._interactionHandler)}start(e,t=30,n=1){this.isActive()||(this.reset(),this._startTime=Date.now(),e<this._defaultAdvancePlaylistDuration&&(M.event(this._logPrefix,`_shouldUseCumulativeContentDuration`,{contentDuration:e}),this._shouldUseCumulativeContentDuration=!0),this._adPodDuration||(this._adPodDuration=Math.floor(t)),this._adPodSize||(this._adPodSize=n),this._setupShouldAdvanceToContent(e,this._adPodDuration,this._adPodSize),this._setupThresholds(e,this._adPodDuration,this._adPodSize),document.addEventListener(`visibilitychange`,this._handleVisibilityChange.bind(this)),this._intervalId=window.setInterval(()=>this._handleTimeInterval(),BH))}show(){this._buttons&&(this._buttons.style.display=`flex`,this._buttons.classList.add(`active`),this._isVisible=!0)}reset(e=!1){this._clearInterval(),this._hide(),this._state=zH.AWAITING_START,this._elapsedTime=0,this._startTime=0,this._hiddenStartTime=0,document.removeEventListener(`visibilitychange`,this._handleVisibilityChange.bind(this)),e&&(this._adPodDuration=0,this._adPodSize=0,this._nextAdvancePlaylistDuration=void 0,this._shouldAdvanceToContent=!1,this._shouldUseCumulativeContentDuration=!1,this._cumulativeContentDuration=0)}destroy(){var e;this._parentElement.removeEventListener(`click`,this._interactionHandler),this._parentElement.removeEventListener(`keyup`,this._interactionHandler),(e=this._buttons)==null||(e=e.parentNode)==null||e.removeChild(this._buttons),this._buttons=void 0,document.removeEventListener(`visibilitychange`,this._handleVisibilityChange.bind(this))}isActive(){return this._intervalId!==void 0}_setupShouldAdvanceToContent(e,t,n){let r=n>1,i=t>this._defaultAdvancePlaylistDuration,a=t>e,o=!this._nextAdvancePlaylistDuration,s=t>e+this._cumulativeContentDuration;this._shouldAdvanceToContent=this._shouldUseCumulativeContentDuration?r&&s:r&&i&&a&&o,this._shouldAdvanceToContent&&!this._shouldUseCumulativeContentDuration&&(this._nextAdvancePlaylistDuration=Math.max(t-this._defaultAdvancePlaylistDuration,10))}_handleTimeInterval(){var e,t;this._updateElapsedTime(),(e=(t=this._stateHandlers)[this._state])==null||e.call(t)}_handleAwaitingStart(){this._state=this._shouldAdvanceToContent?zH.AWAITING_SHOW_BUTTONS:zH.AWAITING_FETCH_AD}_handleAwaitingFetchAd(){this._shouldFetchAd()&&(this._fetchAd(),this._state=zH.AWAITING_SHOW_BUTTONS)}_handleAwaitingShowButtons(){this._shouldShowButtons()&&(this.show(),this._state=zH.AWAITING_ADVANCE)}_handleAwaitingAdvance(){this._shouldAdvance()&&(this._shouldAdvanceToContent?(this._advanceToContent(),this.reset()):(this._advanceToAd(),this.reset(!0)))}_getAdvancePlaylistDuration(e,t,n){if(this._shouldAdvanceToContent){let t=this._shouldUseCumulativeContentDuration?Math.min(this._defaultAdvancePlaylistDuration,e):this._defaultAdvancePlaylistDuration;return this._shouldUseCumulativeContentDuration&&(this._cumulativeContentDuration+=t),t}if(this._nextAdvancePlaylistDuration){let e=this._nextAdvancePlaylistDuration;return e}if(t&&n&&n>1&&this._shouldUseCumulativeContentDuration&&this._cumulativeContentDuration>0){let e=Math.max(10,t-this._cumulativeContentDuration);return e}if(t&&n&&n>1){let e=Math.max(15,t);return e}if(t){let n=Math.max(15,Math.min(t,this._defaultAdvancePlaylistDuration)),r=Math.min(e,n);return r}let r=Math.min(e,this._defaultAdvancePlaylistDuration);return r}_setupThresholds(e,t,n){let r=this._getAdvancePlaylistDuration(e,t,n);this._fetchAdThreshold=r-HH,this._showButtonsThreshold=r-UH,this._advanceThreshold=r}_thresholdReached(e){return this._elapsedTime>=e-this._thresholdBufferForCumulativeDuration()&&this._elapsedTime<=e+VH}_thresholdBufferForCumulativeDuration(){return this._shouldUseCumulativeContentDuration&&this._state===zH.AWAITING_ADVANCE?.5:0}_shouldFetchAd(){return this._thresholdReached(this._fetchAdThreshold)&&!this._shouldAdvanceToContent&&!this._isVisible&&!this._wasAdFetched()}_shouldShowButtons(){return this._thresholdReached(this._showButtonsThreshold)&&!this._isVisible}_shouldAdvance(){return this._thresholdReached(this._advanceThreshold)&&this._isVisible}_getAdvanceType(){return this._shouldAdvanceToContent?`content`:`ad`}_updateElapsedTime(){let e=Date.now();this._elapsedTime=(e-this._startTime)/1e3}_clearInterval(){this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0)}_handleVisibilityHidden(){this._hiddenStartTime=Date.now(),this._clearInterval()}_handleVisibilityVisible(){if(this._startTime===0)return;let e=Date.now()-this._hiddenStartTime;this._startTime+=e,this._updateElapsedTime(),this._intervalId=window.setInterval(()=>this._handleTimeInterval(),BH)}_handleVisibilityChange(){let e=document.visibilityState;e!==this._lastVisibilityState&&(this._lastVisibilityState=e,e===`hidden`?this._handleVisibilityHidden():this._handleVisibilityVisible())}_createButtons(){let e=document.createElement(`div`);e.id=`next-stay-container`,e.style.display=`none`;let t=this._createButton(`next`,()=>this._nextButtonClick(this._shouldAdvanceToContent)),n=this._createButton(`stay`,()=>this._stayButtonClick());return e.appendChild(t),e.appendChild(n),e}_createButton(e,t){let n=document.createElement(`div`),r=document.createElement(`span`);return n.id=this._getButtonId(e),r.textContent=e,n.appendChild(r),n.onclick=t,n.onkeydown=e=>this._throttledKeydownHandler(e,t),n}_getButtonId(e){return`${e}-video`}_hide(){this._buttons&&(this._buttons.style.display=`none`,this._buttons.classList.remove(`active`),this._isVisible=!1)}_handleInteractation(e){if(e instanceof MouseEvent&&e.type!==`click`||e instanceof KeyboardEvent&&![`Space`,`Enter`,`ArrowLeft`,`ArrowRight`].includes(e.code)||!this.isActive())return;let t=e.composedPath(),n=[this._getButtonId(`next`),this._getButtonId(`stay`)],r=t.some(e=>n.includes(e.id));r||this._cancel()}}})),GH,KH=o((()=>{$(),j(),E(),O(),GH=class{constructor({optimizeVideoPlayersForEarnings:e,isCollapsible:t,maxAdsInPod:n,adPodAuctionCutoffSeconds:r,isMax30SecPodFeatureEnabled:i}){T(this,`_isCollapsible`,void 0),T(this,`_optimizeVideoPlayersForEarnings`,!1),T(this,`_isMax30SecPodFeatureEnabled`,!1),T(this,`_adPlayMap`,new Map),T(this,`_prerollNumber`,0),T(this,`_prerollAdCountInPod`,1),T(this,`_maxNumberOfAdsInPod`,2),T(this,`_adPodAuctionCutoffSeconds`,0),T(this,`_logPrefix`,`AdPodManager`),T(this,`_currentAdPodFetchesCompleted`,!1),T(this,`_numberOfVideoContentPlayed`,0),T(this,`_totalAdPodDuration`,0),T(this,`vpodnum`,0),this._optimizeVideoPlayersForEarnings=e,this._isCollapsible=!!t,this._maxNumberOfAdsInPod=n==null?this._maxNumberOfAdsInPod:n,this._adPodAuctionCutoffSeconds=r,this._currentAdPodFetchesCompleted=this._maxNumberOfAdsInPod===1,this._isMax30SecPodFeatureEnabled=i}get adPlayMap(){return this._adPlayMap}get prerollNumber(){return this._prerollNumber}get adPodDuration(){return this._totalAdPodDuration}get adPodSize(){return this._prerollAdCountInPod}get maxAdPodSize(){return this._maxNumberOfAdsInPod}get canFallBackAuction(){return!this._isMax30SecPodFeatureEnabled&&this.adPodDuration<=30||this._isMax30SecPodFeatureEnabled&&this._prerollAdCountInPod===1}setAdPlayMap(e,t){this._adPlayMap.set(e,t)}reset(){this._adPlayMap=new Map,this.resetAdCountInPod()}resetAdCountInPod(){this._prerollAdCountInPod=0,this._totalAdPodDuration=0,this._numberOfVideoContentPlayed=0,this._currentAdPodFetchesCompleted=!1}prepareForNextAdPod(){this.resetAdCountInPod(),this.incrementSessionPrerollNumber(),this.vpodnum++}_incrementPrerollAdCountInPod(){this._prerollAdCountInPod++,this._prerollAdCountInPod>=this._maxNumberOfAdsInPod&&(this._currentAdPodFetchesCompleted=!0)}incrementSessionPrerollNumber(){this._prerollNumber++,this._incrementPrerollAdCountInPod()}incrementVideoContentPlayCount(){this._numberOfVideoContentPlayed++}canApplyAdPodExperience(){return this._optimizeVideoPlayersForEarnings&&this._isCollapsible}canFetchNextAdInPod(){let e=this._currentAdPodFetchesCompleted,t=this.adPodDuration>=this._adPodAuctionCutoffSeconds,n=!e&&!t;return this._logCanFetchStatus(n,e,t),n}_logCanFetchStatus(e,t,n){}canPlayAdPodPrerollAd(){return!this._adPlayMap.has(this.prerollNumber)}isFirstInAdPod(){return this._prerollAdCountInPod===1}isLastInAdPod(){return this._prerollAdCountInPod>=this._maxNumberOfAdsInPod}get shouldFetchNextAd(){return this._maxNumberOfAdsInPod===1||this.shouldFetchNextAdAfterAdvancing()}shouldFetchNextAdAfterAdvancing(){return this._numberOfVideoContentPlayed>1||this.adPodDuration<=30}addCreativeDuration(e=30){this._totalAdPodDuration+=e}},GH=D([Q(`AdPodManager`),A(`design:paramtypes`,[Object])],GH)})),qH,JH=o((()=>{w(),_W(),E(),qH=class{constructor(e,t,n,r){T(this,`_isCollapsible`,void 0),T(this,`_name`,void 0),T(this,`_prebidMethods`,void 0),T(this,`_fallbackDuration`,void 0),T(this,`_firstBidDuration`,15),T(this,`_currentAuctionNumber`,0),T(this,`_amzBids`,[]),T(this,`_prebidBids`,[]),T(this,`_prioritizeShorterVideoAds`,!1),T(this,`_optimizeForEarnings`,!1),T(this,`_hasFallenBack`,!1),T(this,`_enabledViaExperiment`,!1),T(this,`_logPrefix`,`VideoAuctionManager`),T(this,`_amznAdUnitName`,void 0),T(this,`_config`,void 0),this._isCollapsible=!!r,this._name=e,this._config=n,this._prebidMethods=t,this._fallbackDuration=n.video.maxDuration,this._prioritizeShorterVideoAds=!n.gdpr.enabled&&n.adOptions.prioritizeShorterVideoAds,this._optimizeForEarnings=n.adOptions.optimizeVideoPlayersForEarnings,this._enabledViaExperiment=x.resolve(fW).result,this._amznAdUnitName=this._getInitialAmznAdUnitName()}beforeBidRequest(e=!1,t=!0){this.enabled&&(!e&&this._currentAuctionNumber===1?this._setupFirstAuctionAdUnits():this._isSecondAuctionWithFallback(e,t)&&this._setupSecondAuctionAdUnits())}get enabled(){return this._enabledViaExperiment&&this._optimizeForEarnings&&this._prioritizeShorterVideoAds&&this._isCollapsible}get currentAuctionNumber(){return this._currentAuctionNumber}get hasFallenBack(){return this._hasFallenBack}get amznAdUnitName(){return this._amznAdUnitName}setAmznBids(e){this._amzBids=e}setPrebidBids(e){this._prebidBids=e}incrementCurrentAuctionNumber(){this._currentAuctionNumber++}reset(){this._hasFallenBack=!1,this._currentAuctionNumber=0,this._amzBids=[],this._prebidBids=[],this._amznAdUnitName=this._getInitialAmznAdUnitName()}_getAmazonHighestBidData(e){let t=this._config.amazon.availableBids.get(e);if(!t)return;let n=t.pmpCpm&&t.cpm<t.pmpCpm,{amznbid:r,amzniid:i,bidder:a,cpm:o,mediaType:s,size:c,slotID:l,pmpAmznBid:u,pmpAmazoniid:d,pmpBidder:f,pmpCpm:p,pmpDeal:m,pmpMediaType:h,pmpSize:g}=t;return{amznbid:n?u:r,amzniid:n?d:i,bidder:n?f:a,cpm:n?p:o,mediaType:n?h:s,size:n?g:c,slotID:l,...n&&m&&{deal:m}}}getTopVideoBid(e,t){var n,r;let i=(this._prebidMethods.getBidResponsesForAdUnitCode(t)||{}).bids,a=i.filter(t=>{let n=t.ttl||300,r=t.responseTimestamp+n*1e3>new Date().getTime(),i=t&&t.status!==`rendered`,a=!0;return e&&t.maxDuration&&(a=t.maxDuration===e.max_ad_duration/1e3),r&&i&&a}).sort((e,t)=>t.cpm-e.cpm),o=a[0],s=this._getAmazonHighestBidData(this._name),c=(n=s==null?void 0:s.cpm)==null?0:n,l=(r=o==null?void 0:o.cpm)==null?0:r;return c>l?s:o}_setupFirstAuctionAdUnits(){let e=this._getInitialAmznAdUnitName();this._updatePrebidAdUnitForNextAuction(this._firstBidDuration),this._updateAmznAdUnitForNextAuction(e)}_setupSecondAuctionAdUnits(){this._updatePrebidAdUnitForNextAuction(this._fallbackDuration),this._updateAmznAdUnitForNextAuction(this._name),this._hasFallenBack=!0}_getInitialAmznAdUnitName(){return this.enabled?`${this._name}_15s`:this._name}_updateAmznAdUnitForNextAuction(e){this._amznAdUnitName=e}_updatePrebidAdUnitForNextAuction(e){var t;let n=this._prebidMethods.getAdUnit(this._name);!(n==null||(t=n.mediaTypes)==null)&&t.video&&(n.mediaTypes.video.maxduration=e)}_shouldIncrementMaxDuration(){if(this._currentAuctionNumber===0)return!1;let e=this._prebidBids.length===0,t=this._amzBids.length===0;return e&&t}_isSecondAuctionWithFallback(e,t){return e||this._currentAuctionNumber===2&&this._shouldIncrementMaxDuration()&&t}}})),YH,wfe=o((()=>{E(),YH=class{constructor(){T(this,`promise`,void 0),T(this,`_resolve`,void 0),T(this,`_reject`,void 0),this.promise=new Promise((e,t)=>{this._resolve=e,this._reject=t})}resolve(e){this._resolve(e)}reject(e){this._reject(e)}}})),XH,Tfe=o((()=>{Na(),w(),E(),XH=class{constructor(){T(this,`_orientationListener`,null),T(this,`_pageManager`,x.resolve(ja))}setupListener(e,t,n){let{tablet:r,desktop:i}=n,a=window.innerHeight>window.innerWidth;this._orientationListener=this._setResizeListener.bind(this,{device:t,desktopBreakpoint:i,tabletBreakpoint:r,originallyPortraitView:a,pageElement:e}),this._pageManager.resize.on(this._orientationListener)}_removeCLSMinHeight(e){var t;(t=e.parentElement)==null||t.style.removeProperty(`min-height`)}_setResizeListener({device:e,desktopBreakpoint:t,tabletBreakpoint:n,originallyPortraitView:r,pageElement:i}){let a=e===`phone`&&window.innerWidth>=n,o=e===`tablet`&&(window.innerWidth<=n||window.innerWidth>=t),s=e===`desktop`&&window.innerWidth<=t,c=a||o||s,l=r&&window.innerWidth>window.innerHeight,u=!r&&window.innerHeight>window.innerWidth,d=l||u;(c||d)&&(this._removeCLSMinHeight(i),this._orientationListener&&this._pageManager.resize.off(this._orientationListener),this._orientationListener=null)}}})),ZH,Efe=o((()=>{E(),ZH=class e{constructor(e){T(this,`_logPrefix`,`RaptivePlayer`),T(this,`_jsonld`,null),T(this,`_mediaid`,null),T(this,`_el`,null),this._mediaid=e.mediaid,this._jsonld=this.transform(e)}render(e=document.head){this._el&&this._el.remove(),this._el=document.createElement(`script`),this._el.type=`application/ld+json`,this._el.dataset.mediaid=this._mediaid||``,this._el.textContent=JSON.stringify(this._jsonld,null,2),e.appendChild(this._el)}transform(t){var n,r;return{"@context":`https://schema.org`,"@type":`VideoObject`,name:t.title||`Untitled`,description:t.description||``,thumbnailUrl:((n=t.images)==null?void 0:n.map(e=>e.src))||[],uploadDate:e.formatDate(t.pubdate||0),duration:e.formatDuration(t.duration||0),contentUrl:((r=t.sources)==null||(r=r.find(e=>e.type===`video/mp4`))==null?void 0:r.file)||``,embedUrl:t.link||``}}static formatDuration(e){let t=Math.floor(e/60),n=e%60;return`PT${t}M${n}S`}static formatDate(e){return new Date(e*1e3).toISOString()}}})),QH,$H=o((()=>{X(),$(),Rm(),jue(),oC(),Ff(),Z(),dC(),AF(),Mue(),_W(),rU(),Hf(),w(),$T(),RI(),KI(),xfe(),Cfe(),KH(),JH(),wfe(),al(),Tfe(),Efe(),kC(),E(),QH=class e extends uC{constructor(t,n,r=1,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v,y,b,ee){var te;super(n,i,a,o,s,c,u,d,t,v,ee),this._id=t,this._mediaIdCount=r,this._mediaOrPlaylistId=i,this._context=l,this.name=f,this._isCollapsible=p,this._prebidMethods=m,this._auctionManagers=h,this._prebidEventBus=g,this._videoEventBus=_,this._playerNumber=v,this._collapseSettings=y,this._playlistPlayerMediaId=b,T(this,`type`,`RaptivePlayer`),T(this,`collapseCollection`,null),T(this,`nextMediaId`,void 0),T(this,`jwPlayerSegments`,void 0),T(this,`plcmt`,void 0),T(this,`impressionId`,NK()),T(this,`_logPrefix`,`RaptivePlayer`),T(this,`_adCountDown`,void 0),T(this,`_winningBidDetails`,null),T(this,`_adDurationLogged`,!1),T(this,`_adFetched`,!1),T(this,`_adKickoffCompletePromise`,new YH),T(this,`_adsDisabled`,!1),T(this,`_advancePlaylist`,void 0),T(this,`_auctionManager`,void 0),T(this,`_stalePlayerTimeoutBuffer`,void 0),T(this,`_adDetails`,null),T(this,`_adPlaying`,!1),T(this,`_bidMarkedOnCurrentAd`,!1),T(this,`_canTearDown`,!1),T(this,`_didTearDown`,!1),T(this,`_closeButton`,void 0),T(this,`_contentSpecificPlaylistId`,null),T(this,`_currentAdDurationWithBuffer`,0),T(this,`_currentAdTime`,0),T(this,`_defaultAdDuration`,30),T(this,`_disableAdsEventBus`,void 0),T(this,`_eventsToSkipLogging`,[`volume`]),T(this,`_hlsManager`,void 0),T(this,`_isAdvancePlaylistEnabled`,!1),T(this,`_isProgrammaticPause`,!0),T(this,`_isProgrammaticPlay`,!0),T(this,`_isVideoEnded`,!1),T(this,`_jwBoostExperiment`,void 0),T(this,`_loadingSpinner`,void 0),T(this,`_mobileStickyPlayerPositionSiteExperiment`,void 0),T(this,`_mobileStickyPlayerPositionCoreExperiment`,void 0),T(this,`_playerState`,Y.Unstarted),T(this,`_videoContentObject`,void 0),T(this,`_playlistIndex`,0),T(this,`_prebidAuctionManager`,void 0),T(this,`_prerollAdUrl`,``),T(this,`_reInitAttempts`,0),T(this,`_spaListeners`,[]),T(this,`_state`,Y.Unstarted),T(this,`_stalePlayerTimeoutId`,null),T(this,`_stickyElement`,void 0),T(this,`_tearDownAfterNextAd`,!1),T(this,`_tearDownPlayerTimeout`,0),T(this,`_tearDownTimer`,null),T(this,`_topBackgroundElement`,null),T(this,`_topCollapseVideoTitleElement`,void 0),T(this,`_transactionId`,``),T(this,`_userIdTargetingData`,[]),T(this,`_userIdComponent`,void 0),T(this,`_sspUserSyncComponent`,void 0),T(this,`_videoAdUnit`,void 0),T(this,`_videoCloseButtonComponent`,void 0),T(this,`_videoLink`,``),T(this,`_videoStarted`,!1),T(this,`_videoTitle`,``),T(this,`_videoTitleElement`,void 0),T(this,`_wasSeeking`,!1),T(this,`_wrapperBar`,void 0),T(this,`_wrapperText`,void 0),T(this,`_raptiveInstreamRerequestOnErrorResult`,void 0),T(this,`_retryAttempts`,0),T(this,`_maxRetries`,void 0),T(this,`_playlistMaxRetries`,4),T(this,`_relatedPlayerMaxRetries`,2),T(this,`_stalePlayerBufferTimeExperiment`,void 0),T(this,`_erroredOutCreativeIds`,new Map),T(this,`_topCenterBackgroundColor`,`black`),T(this,`_adPodManager`,void 0),T(this,`_handlingAdError`,!1),T(this,`_adDurationControlExperiment`,void 0),T(this,`_slickHeartbeatPresent`,!1),T(this,`_translateX`,0),T(this,`_translateY`,0),T(this,`_lastAuctionBidDetails`,void 0),T(this,`_isGamCalled`,!1),T(this,`_outsideGamRenderTriggered`,!1),T(this,`_bidWonData`,{topBid:{},vprenum:0,vastErrorCode:0}),T(this,`_metadata`,null),T(this,`_isMetadataEnabled`,!1),T(this,`_isMax30SecPodFeatureEnabled`,!1),T(this,`_eligibleFloorComponents`,[]),T(this,`_appliedFloorComponents`,[]),T(this,`_isAcAlwaysStickyEnabled`,!1),T(this,`_makeGamCall`,async()=>{await this._videoEventBus.auctionsCompleted.legacyEmit([this]),this._prerollAdUrl=await this._getPrerollAdUrl(),this.imaManager.requestAd({adTagUrl:this._prerollAdUrl}),this._adPodManager.setAdPlayMap(this.prerollNum,!0),this._isGamCalled=!0,this._outsideGamRenderTriggered=!1}),this._isRelatedPlayer()&&this._config.video.setupAdvanceRelatedExperiment(!1),this.plcmt=(te=OC(this._config.video.plcmtUnits,this))==null?2:te,this._disableAdsEventBus=x.resolve(vr),this._isMetadataEnabled=!il.isRolloutEnabled(`disableJwpSeo`),this._isMax30SecPodFeatureEnabled=!this._config.adOptions.longerVideoAdPod,this._stalePlayerBufferTimeExperiment=x.resolve($U),this._stalePlayerTimeoutBuffer=N(this._stalePlayerBufferTimeExperiment.result,10),this._isAcAlwaysStickyEnabled=il.isRolloutEnabled(`ac-always-sticky`),this._raptiveInstreamRerequestOnErrorResult=x.resolve(GU).result,this._maxRetries=this._isAutoInjectedPlayer()?this._playlistMaxRetries:this._relatedPlayerMaxRetries,this._userIdComponent=x.resolve(QT),this._sspUserSyncComponent=x.resolve(kF),this._videoCloseButtonComponent=x.resolve(LI),this._mobileStickyPlayerPositionSiteExperiment=x.resolve(IU),this._mobileStickyPlayerPositionCoreExperiment=x.resolve(NU),this._jwBoostExperiment=x.resolve(SU),this._prebidAuctionManager=this._auctionManagers.getPrebidAuctionManager(),this._adCountDown=x.resolve(NI),this._adDurationControlExperiment=x.resolve(hU),this._auctionManager=new qH(f,m,c,this._isCollapsible),this._hlsManager=this._createHlsManager(),this._onBeforeRequestBids(),this._setupPlayer(),this._setupListeners(),this._loadingSpinner=new jI(this._playerContainer);let ne=1;c.adOptions.optimizeVideoPlayersForEarnings&&(ne=this._isMax30SecPodFeatureEnabled?e.MAX_ADS_IN_30SEC_POD:e.DEFAULT_MAX_NUMBER_OF_ADS_IN_POD),this._adPodManager=new GH({optimizeVideoPlayersForEarnings:c.adOptions.optimizeVideoPlayersForEarnings,isCollapsible:this._isCollapsible,maxAdsInPod:ne,adPodAuctionCutoffSeconds:this._isMax30SecPodFeatureEnabled?16:46,isMax30SecPodFeatureEnabled:this._isMax30SecPodFeatureEnabled}),this.ready.on(()=>this._handlePlayerReady())}get prerollNum(){return this._adPodManager.prerollNumber}get eligibleFloorComponents(){return this._eligibleFloorComponents}set eligibleFloorComponents(e){this._eligibleFloorComponents=e}get appliedFloorComponents(){return this._appliedFloorComponents}set appliedFloorComponents(e){this._appliedFloorComponents=e}get muted(){var e;return(e=this._videoPlayerControls)==null?void 0:e.muted}hide(){this._playerContainer.classList.add(`raptive-player-hidden`)}show(){this._playerContainer.classList.remove(`raptive-player-hidden`)}refreshImpressionId(){let e=NK();this.impressionId=e}_isAutoInjectedPlayer(){return this._playerType===rC.AutoInjected}async _handlePlayerReady(){if(await this.getPlayerContent(),this._setupMetadata(),this._logRaptivePlayerEvent(`Embed`),this._isAutoInjectedPlayer()){let e=new XH;e.setupListener(this._pageElement,this._context.device,this._config.site.breakpoints)}this._autoplay&&this._kickoffAdPlayback()}async _kickoffAdPlayback(){this._loadingSpinner.show();let e=this._didTearDown,t=this._config.gdpr;!t.consentCaptured&&t.enabled&&await this.waitForConsent(),this._startTearDownTimer(),this._autoplay?this._loadingSpinner.show():this._logRaptivePlayerEvent(`CTP-initiated`),e||await this._fetchLinearAd(),this.collapseCollection?this.triggerPlayInView():this._programmaticPlayVideo(),this._checkVideoClose()&&(this._state=Y.Closed)}_setupPlayer(){this._setupCollapseListeners(),this._setupContentSpecificPlaylists(),this._setupMatchMedia(),this._handleLoadedMetaData(),this._setupCollapse(),this._setupAdvancePlaylist(),this._adCountDown.addAdTimer(this._playerContainer),this._setupTearDown(),this._setupDataAttributes()}_createHlsManager(){return new RH({videoEl:this._videoElement,config:this._config.video,fatalErrorCallback:this._hlsFatalErrorCallback.bind(this)})}_isRelatedPlayer(){return this._isEmbeddedStationary()||this._playerType===rC.RelatedSticky}_isFirstRelatedPlayerVideo(){return this._isRelatedPlayer()&&this._playlistIndex===0}_getPlaylistIdForLogger(){return this._isFirstRelatedPlayerVideo()?null:this._playlistId}_setupMetadata(){if(!this._isMetadataEnabled||this._metadata||!this._isRelatedPlayer()||!this._videoContentObject)return;let e=this._videoContentObject.playlist[0];this._metadata=new ZH(e),this._metadata.render()}_setupTearDown(){let e=this._playerType===rC.Related&&this._config.video.advancePlaylist||this._isCollapsible;if(e){var t;this._tearDownPlayerTimeout=(t=x.resolve(qU).result)==null?0:t,this._canTearDown=this._tearDownPlayerTimeout>0,this._getPlaylistIdForLogger()}}_setupDataAttributes(){this._playerId&&(this._playerContainer.dataset.playerId=this._playerId,this._playerContainer.dataset.name=this.name)}_setupCollapse(){if(this._collapseSettings){this._isTopCenterWithTitle()||this._playerContainer.appendChild(this._createPlayerCloseButton()),this._handleTitleContainerOnCollapseAndUnCollapse(),this._collapsePlayerLogic();let e=this._collapseSettings.title;if(this._isAutoInjectedPlayer()&&e){let t=document.createElement(`h3`);t.innerText=e,t.className=`adthrive-player-title`,t.id=`adthrive-collapse-title`;let n=this._container.firstChild;n?this._container.insertBefore(t,n):this._container.appendChild(t)}}}_setupMatchMedia(){if(window.matchMedia){let e=window.matchMedia(`only screen and (max-width: ${this._config.site.breakpoints.desktop-1}px)`);e.addListener(this._handleWidthBreak.bind(this)),this._handleWidthBreak(e)}}_setupAdvancePlaylist(){let{playlistPlayer:e,relatedPlayer:t}=this._config.video.advancePlaylist;this._isAdvancePlaylistEnabled=this._isAutoInjectedPlayer()?e.enabled:t.enabled,!(!this._isAdvancePlaylistEnabled||this._adsDisabled)&&(this._advancePlaylist=new WH(this._playerContainer,()=>this._adFetched,()=>void this._handleAdvancePlaylistFetchAd(),this._handleAdvancePlaylistAdvanceToAd.bind(this),this._handleAdvancePlaylistAdvanceToContent.bind(this),this._handleAdvancePlaylistNextButtonClick.bind(this),this._handleAdvancePlaylistStayButtonClick.bind(this),this._handleAdvancePlaylistCancel.bind(this)))}_setupContentSpecificPlaylists(){let e=this._config.video.contentSpecificPlaylists,t=e&&Vf(e);this._getPlaylistIdForLogger(),t&&t.playlistId&&(this._contentSpecificPlaylistId=t.playlistId)}_handleTitleContainerOnCollapseAndUnCollapse(){this._videoEventBus.videoCollapsed.on(e=>{var t;e.playerContainer===((t=this.collapseCollection)==null?void 0:t.playerContainer)&&(this._videoDescriptionDiv.classList.add(`adthrive-display-none`),this._videoTitleDiv.classList.add(`adthrive-small-text`))}),this._videoEventBus.videoUnCollapsed.on(()=>{this._videoDescriptionDiv.classList.remove(`adthrive-display-none`),this._videoTitleDiv.classList.remove(`adthrive-small-text`)})}_handleLoadedMetaData(){this.loadedMetaData.once(()=>{this._config.video.removeVideoTitleWrapper?this._playerContainer.classList.add(`adthrive-player-without-wrapper-text`):this._createVideoContentTitle(),this._collapseSettings&&this._createCollapsibleCollection()})}async _handleAdvancePlaylistFetchAd(){let e=this._adPodManager;e.prepareForNextAdPod(),this._reInitAttempts=0,await this._fetchLinearAd()}_handleAdvancePlaylistAdvanceToAd(){this._handleVideoElementEnded()}_handleAdvancePlaylistAdvanceToContent(){this._programmaticPauseVideo({pauseContent:!0,logEvent:!1}),this._continuePlayingNextContent()}_handleAdvancePlaylistNextButtonClick(e=!1){let t={playerType:this._playerType,mediaId:this.mediaOrPlaylistId,playlistIndex:this._playlistIndex};M.event(this._logPrefix,`nextButtonClicked`,t),e?this._handleAdvancePlaylistAdvanceToContent():this._handleAdvancePlaylistAdvanceToAd()}_handleAdvancePlaylistStayButtonClick(){var e;let t={playerType:this._playerType,mediaId:this.mediaOrPlaylistId,playlistIndex:this._playlistIndex};M.event(this._logPrefix,`stayButtonClicked`,t),(e=this._advancePlaylist)==null||e.reset()}_handleAdvancePlaylistCancel(){var e;if(this._adPlaying)return;let t={playerType:this._playerType,mediaId:this.mediaOrPlaylistId,playlistIndex:this._playlistIndex};M.event(this._logPrefix,`advancePlaylistCancelled`,t),(e=this._advancePlaylist)==null||e.reset()}_setWrapperBar(){this._wrapperBar=this._playerPosition.querySelector(`.adthrive-wrapper-bar`)}_shouldStartAdvancePlaylist(){return this._isAdvancePlaylistEnabled?this.isFirstPlay&&this._isRelatedPlayer()?this._isEmbeddedStationary()?!1:this._config.video.advancePlaylist.relatedPlayer.applyToFirst:!0:!1}_isEmbeddedStationary(){return this._playerType===rC.EmbeddedStationary}_createVideoContentTitle(){this._isMobileTopCenterCollapse()?this._addTopCenterWrapper():this._addPlayerWithoutWrapper()}_isTopCenterWithTitle(){return!this._config.video.removeVideoTitleWrapper&&this._isMobileTopCenterCollapse()}_checkVideoClose(){return this._collapseSettings&&this._collapseSettings.saveVideoCloseState&&this._config.video.videoWasClosed}_prepareToPausePlayer(){var e,t;this._handleAdvancePlaylistCancel(),this._loadingSpinner.hide(),(e=this._videoPlayerControls)==null||e.toggleControlsFullWidth(!0),(t=this._videoPlayerControls)==null||t.setPlayButtonState(`play`),this.collapseCollection&&GI.handleOtherVideoPlaying(this.collapseCollection)}triggerPlayInView(){this.loadedMetaData.once(()=>{this.collapseCollection&&GI.handleScroll(this.collapseCollection)}),this.loadedMetaData.emitted&&this.collapseCollection&&GI.handleScroll(this.collapseCollection)}_collapsePlayerLogic(){this.collapsible&&(this._setWrapperBar(),this._wrapperBar&&this._wrapperBar.style.setProperty(`display`,`flex`),this._isMobileTopCenterCollapse()&&this._createTopCenterBackground(this._playerPosition),this._stickyElement=null)}_shouldShufflePlaylist(){let{hasContentSpecificPlaylist:e,contentSpecificPlaylistshuffle:t,defaultPlaylistShuffle:n}=this._config.video.jwPlaylistObj;return e&&t||!e&&n}_shuffleKeepingFirstItem(e){let[t,...n]=e,r=Pf.shufflePlaylist(n);return[t,...r]}_updatePlaylistItemsWithShuffle(){if(!this._videoContentObject||!this._videoContentObject.playlist||this._videoContentObject.playlist.length<2||!this._shouldShufflePlaylist())return;let e=this._videoContentObject.playlist;this._videoContentObject.playlist=this._isRelatedPlayer()||this._playlistPlayerMediaId?this._shuffleKeepingFirstItem(e):Pf.shufflePlaylist(e)}async getPlayerContent(){this._videoContentObject=await this._getVideoContent(),this._updatePlaylistItemsWithShuffle(),this._setVideoElementAttributesAndSource()}_initializeHlsOrMp4(e){var t;let n=(t=e.find(e=>e.type===`application/vnd.apple.mpegurl`))==null?void 0:t.file;n&&this._hlsManager.isSupported()?this._hlsManager.loadSource(n):n&&this._videoElement.canPlayType(`application/vnd.apple.mpegurl`)?this._videoElement.src=n:(M.event(this._logPrefix,`_initializeHlsOrMp4`,{message:`Hls is not supported, falling back to mp4`}),this._setMp4Source(e))}_setMp4Source(e){let t=this._getLowestBitrateMp4Rendition(e);if(t){this._videoElement.src=t;return}M.error(this._logPrefix,`_setMp4Source`,{message:`No mp4 sources found`})}_getLowestBitrateMp4Rendition(e){let t;for(let n of e){if(n.type!==`video/mp4`)continue;(!t||n.bitrate&&t.bitrate&&n.bitrate<t.bitrate)&&(t=n)}return t==null?void 0:t.file}_hlsFatalErrorCallback(){let e=this._getVideoUsingIndex();if(!e){M.error(this._logPrefix,`_hlsFatalErrorCallback`,{message:`No video found`});return}let t=e.sources.filter(e=>e.type===`video/mp4`),n=this._videoElement.currentTime;this._hlsManager.reset(),t.length>0&&this._switchToMp4Source(n,t)}_switchToMp4Source(e,t){var n;this._setMp4Source(t),this._videoElement.currentTime=e,this._videoElement.load(),(n=this._advancePlaylist)==null||n.reset(),this._programmaticPlayVideo({logEvent:!1}).then(()=>{var e,t,n;(this._isMobile||this._isTablet)&&((e=this._videoPlayerControls)==null||e.hideControls()),this._shouldStartAdvancePlaylist()&&((t=this._advancePlaylist)==null||t.start(this._videoElement.duration)),this._toggleTitle(!0),(n=this._videoPlayerControls)==null||n.toggleProgressBar(!0)}).catch(()=>{})}_getVideoUsingIndex(e=this._playlistIndex){let t=this._videoContentObject;if(t)return t?t.playlist[e]:void 0}_getNextIndex(){let e=this._videoContentObject;if(!e)return;let t=e.playlist.length-1===this._playlistIndex;return t||this.isFirstPlay?0:this._playlistIndex+1}_incrementPlaylistIndex(){let e=this._getNextIndex();e!==void 0&&(this._playlistIndex=e)}setNextVideo(){this._videoContentObject&&(this._incrementPlaylistIndex(),this._setVideoElementAttributesAndSource())}_setVideoElementAttributesAndSource(){var e;if(!this._videoContentObject)return;let t=this._getVideoUsingIndex(),n=t.sources;(e=this._videoPlayerControls)==null||e.setTracks(t.tracks),this._config.video.removeVideoTitleWrapper||this._setVideoTitle(t),this._videoElement.poster=this.isFirstPlay?t.image:``,this._videoElement.controls=!1,this._videoElement.preload=`metadata`,this._initializeHlsOrMp4(n)}_setVideoTitle(e){let{title:t,link:n}=e;this._videoTitle=t,this._videoLink=n,this._topCollapseVideoTitleElement&&(this._topCollapseVideoTitleElement.innerHTML=this._videoTitle),this._videoTitleDiv.innerHTML=`<span class='adthrive-video-text-cutoff'>${t}</span>`,this._videoDescriptionDiv.innerHTML=`<span class='adthrive-video-text-cutoff'>${e.description}</span>`;let r=this._linkProvidedByPublisher(this._videoLink);if(this._toggleLearnMoreLink(r),r&&this._wrapperTitleWrapperElement){var i;(i=this._wrapperTitleWrapperElement)==null||(i=i.querySelector(`svg`))==null||i.remove();let e=this._createLinkIcon(this._playlistId);this._wrapperTitleWrapperElement.appendChild(e),this._wrapperTitleWrapperElement.href=n,this._wrapperTitleWrapperElement.target=`_blank`,this._wrapperTitleWrapperElement.onclick=this._handleTitleClick.bind(this),this._videoTitleOverlayContainer.prepend(this._wrapperTitleWrapperElement),this._wrapperTitleWrapperElement.classList.remove(`adthrive-no-pointer-events`)}else if(this._wrapperTitleWrapperElement){var a;(a=this._wrapperTitleWrapperElement)==null||(a=a.querySelector(`svg`))==null||a.remove(),this._wrapperTitleWrapperElement.classList.add(`adthrive-no-pointer-events`)}}_toggleLearnMoreLink(e){let t=document.getElementById(`${this._playlistId}-learn-more-link`);if(!t)return;let n=`raptive-player-learn-more-link-active`;e?t.classList.add(n):t.classList.remove(n)}_updateAdUnitMediaId(e){var t,n;let r={playerID:this._playerId,mediaID:this.nextMediaId};e.ortb2Imp={...e.ortb2Imp,ext:{...(t=e.ortb2Imp)==null?void 0:t.ext,data:{...(n=e.ortb2Imp)==null||(n=n.ext)==null?void 0:n.data,jwTargeting:r}}},this._prebidMethods.updateAdUnit(e.code,e)}_onBeforeRequestBids(){this._prebidEventBus.beforeRequestBids.on(e=>{e.forEach(e=>{this._prebidMethods.addToQueue(()=>this._setTargetingData(e))})})}_setTargetingData(e){var t;let n=e.code===this.name;if(!n)return;let r=this._userIdComponent.getTargetingData(),i=this._sspUserSyncComponent.getTargetingData(),a=[...r,...i];a&&(this.userIdTargetingData=a);let o=(t=e.ortb2Imp&&e.ortb2Imp.ext&&e.ortb2Imp.ext.tid)==null?``:t;n&&o&&(this.transactionId=o)}_setupCollapseListeners(){this._collapseSettings&&(GI.classesToggled.on(()=>{this._handleResizeAd()}),GI.collapseEvent.on(()=>{this._handleResizeAd(),this._handleTransformForCollapse()}),GI.uncollapseEvent.on(()=>{this._handleResizeAd()}))}_setupListeners(){var e;if(this.collapsible){let e=x.resolve(xr);e.footerResponseReceived.on(this._handleFooterResponseReceivedEvent.bind(this));let t=this._getCollapseMobileSubType().includes(`bottom`);t&&e.footerHeightChanged.on(e=>this._handleFooterHeightChange(e))}this._disableAdsEventBus.disableAds.on(e=>void this._disableAds(e),{handleEventsAlreadyEmitted:!0}),this.kickoffAdPlayback.on(this._kickoffAdPlayback.bind(this)),this.imaManager.adLoaded.on(this._handleAdLoaded.bind(this)),this.imaManager.adStarted.on(this._handleAdStart.bind(this)),this.imaManager.adProgress.on(this._handleAdProgress.bind(this)),this.imaManager.adPause.on(this._handleAdPause.bind(this)),this.imaManager.adPlay.on(this._handleAdPlay.bind(this)),this.imaManager.adError.on(this._handleAdError.bind(this)),this.imaManager.adImpression.on(this._handleAdImpression.bind(this)),this.imaManager.log.on(this._handleLogEvent.bind(this)),this.play.on(this._handleVideoElementPlay.bind(this)),this.pause.on(this._handleVideoElementPause.bind(this)),this.seeked.on(this._handleVideoElementSeeked.bind(this)),this.seeking.on(this._handleVideoElementSeeking.bind(this)),this.timeupdate.on(this._handleVideoElementTimeUpdate.bind(this)),this.ended.on(this._handleVideoElementEnded.bind(this)),this.imaManager.allAdsCompleted.on(this._handleAllAdsComplete.bind(this)),this.imaManager.contentResumeRequested.on(this._handleContentResumeRequested.bind(this)),this._spaListeners.push(this._eventProxy.resize.on(this._handleResizeAd.bind(this))),this._collapseSettings&&this._spaListeners.push(this._eventProxy.scroll.on(this._handleScroll.bind(this))),(e=this._videoPlayerControls)==null||e.videoActionEvents.on(e=>this._listenForPlayerEventsToLog(e)),this._spaListeners.push(this._eventProxy.pageVisibility.on(this._handlePageVisibilityChange.bind(this))),this._listenForLargeVastError()}_listenForLargeVastError(){this._prebidEventBus.vastExceededLimit.on(e=>{var t;let n=(t=e.bids)==null?void 0:t[0];if(!n)return;let{adId:r,bidder:i,creativeId:a,meta:o}=n,{maxSizeAllowed:s,responseSize:c}=e,l={meta:o,bidder:i,adId:r,creativeId:a,responseSize:c,maxSizeAllowed:s};M.error(this._logPrefix,`listenForLargeVastError`,l)})}_listenForPlayerEventsToLog(e){var t;let{action:n,context:r,details:i}=e,a=this._getPlaylistIdForLogger(),o=(t=this._videoContentObject)==null||(t=t.playlist)==null||(t=t[this._playlistIndex])==null?void 0:t.mediaid,s={mediaId:o,playlistId:a,siteId:this._config.site.id,playerId:this._playerId,mediaIdCount:`${this._mediaIdCount||0}`,context:r,...i};this._eventsToSkipLogging.includes(n)||M.event(this._logPrefix,n,s)}get collapsible(){return this._isCollapsible}get isPlayerType(){return this._playerType}get transactionId(){return this._transactionId}set transactionId(e){this._transactionId=e}get vp(){return this.prerollNum<=1?this.prerollNum:this.prerollNum<=9?2:3}get retryAttempts(){return this._retryAttempts}set userIdTargetingData(e){this._userIdTargetingData=e}get userIdTargetingData(){return this._userIdTargetingData}set videoAdUnit(e){this._videoAdUnit=e}get videoAdUnit(){return this._videoAdUnit}get mediaOrPlaylistId(){return this._mediaOrPlaylistId}get vpodnum(){return this._adPodManager.canApplyAdPodExperience()?this._adPodManager.vpodnum:void 0}fetchVideoContent(e,t){return pg(Pf.addMaxResolutionQueryParam(`https://cdn.jwplayer.com/v2/${e}/${t}`))}async _prependEmbeddedMedia(e){let t=this._isRelatedPlayer()?this._mediaOrPlaylistId:this._playlistPlayerMediaId;if(t){let n=await this.fetchVideoContent(`media`,t);e.playlist.unshift(n.playlist[0])}}async _handleAdvancePlaylist(e){let t=await this._config.video.jwPlaylistObj.playlist;this._isAdvancePlaylistEnabled&&(e.playlist=e.playlist.concat(t.playlist))}async _getVideoContent(){try{let e=this._isRelatedPlayer()&&!this._contentSpecificPlaylistId?`media`:`playlists`,t=this._contentSpecificPlaylistId||this._mediaOrPlaylistId,n=await this.fetchVideoContent(e,t);return!this._isRelatedPlayer()&&!this._playlistPlayerMediaId||(this._contentSpecificPlaylistId||this._playlistPlayerMediaId?await this._prependEmbeddedMedia(n):await this._handleAdvancePlaylist(n)),n}catch(e){}}_getSegmentsForNextContent(){var e,t;let n=this._getNextIndex();return(e=(t=this._videoContentObject)==null||(t=t.playlist)==null||(t=t[n])==null?void 0:t.jwpseg)==null?[]:e}_enrichBidsWithJwTargeting(){var e;if(this._jwBoostExperiment.result){if(!((e=this._videoAdUnit)!=null&&e.bids)){this._videoEventBus.videoAdUnitAdded.once(()=>{this._enrichBidsWithJwTargeting()});return}this.jwPlayerSegments=this._getSegmentsForNextContent(),this._videoAdUnit.bids.forEach(e=>this._applyJwTargetingToBid(e,this.jwPlayerSegments))}}_applyJwTargetingToBid(e,t){let n=e.rtd||{},r={jwplayer:{...n.jwplayer,targeting:{content:{id:`jw_${this.nextMediaId}`},segments:t}}};e.rtd={...n,...r}}_getFormattedAdDetails(e){let t=this._getAdDetailsFromAd(e);return t?{...this._winningBidDetails,adId:t.adId,wrapperIds:t.adWrapperIds,gamCreativeId:t.adWrapperCreativeIds[t.adWrapperCreativeIds.length-1],gamLineItemId:t.adWrapperIds[t.adWrapperIds.length-1],wrapperCreativeIds:t.adWrapperCreativeIds,vastCreativeId:t.creativeId,mediaFileURL:t.mediaUrl,adUnitName:this.name,tag:this._prerollAdUrl,isEmpty:!1,wrapperSystems:t.adWrapperSystems,duration:t.duration}:null}async _handleAdLoaded(e){var t;if(this._config.video.logAdLifeCycle&&M.event(this._logPrefix,`_handleAdLoaded`,this._playerType,this._getEventInfo(e)),this._addWinningBidDetails(),this._adDetails=this._getFormattedAdDetails(e),this.imaManager.adPlayReady||await this._awaitAdReady(),this._adKickoffCompletePromise.resolve(),this._adsDisabled){this._continuePlayingNextContent();return}if((t=this._videoPlayerControls)==null||t.toggleProgressBar(!1),this.imaManager.prematureAdPlay)return this.imaManager.setPrematureAdPlay(!1),void this._handleContentResumeRequested();this.imaManager.playAdInStream(),this._setStaleAdDetection(`adLoaded`)}async _disableAds(e){if(e.has(`all_page`)){var t,n;this._adsDisabled=!0,await this._adKickoffCompletePromise.promise,(t=this._advancePlaylist)==null||t.destroy(),this._advancePlaylist=void 0,(n=this._videoPlayerControls)==null||n.toggleProgressBar(!0),this.imaManager.disable(),this._adPlaying&&this._continuePlayingNextContent()}}_handleCollapsingPlayer(){this.isFirstPlay&&this.collapseCollection&&!this.collapseCollection.playbackStarted&&!this.collapseCollection.playerCollapsed&&(GI.collapse(this.collapseCollection),this.collapseCollection.playerState=Y.CollapsedPlay)}_handleAdStart(e){var t,n,r,i,a;this._isAcAlwaysStickyEnabled&&this._handleCollapsingPlayer(),this.imaManager.adPlayReady||M.event(this._logPrefix,`_handleAdStart`,`PrematureStart`,this._getEventInfo(e)),(t=this._videoPlayerControls)==null||t.setPlayButtonState(`pause`),this._retryAttempts=0,this._clearStaleTimers(),this._handleResizeAd(),this._adCountDown.setAdTimer(e,!!this._shouldUseHardcodedAdPodDuration,this._adPodManager.maxAdPodSize),this._adCountDown.canStartAdCountDown&&this._adCountDown.displayAdTimer(),this.collapseCollection&&(this.collapseCollection.playbackStarted=!0,this._handleScroll()),(n=this._videoPlayerControls)==null||n.setMediaStarted(!0),(this._isMobile||this._isTablet)&&((r=this._videoPlayerControls)==null||r.showControls()),(i=this._videoPlayerControls)==null||i.toggleControlsFullWidth(!1),this._addWinningBidDetails(),this._adDetails=this._getFormattedAdDetails(e);let o=this._adDetails&&this._adDetails.duration||e.duration||this._defaultAdDuration;this._currentAdDurationWithBuffer=o+this._stalePlayerTimeoutBuffer,this._setStaleAdDetection(`adStart`);let s=this._adDetails||{};this._eventProxy.emitVideoSlotRenderedEvent(s),this._checkRenderedAdDetails(),this._adPlaying=!0,this._adPodManager.addCreativeDuration((a=this._adDetails)==null?void 0:a.duration),this._adPodManager.canApplyAdPodExperience()&&this._requestNextAdAuctionInPod(),this._toggleTitle(!1),this._loadingSpinner.hide()}_handleAdProgress(e){if(!this.canPlay){try{this._prepareToPausePlayer(),this._programmaticPauseVideo({logEvent:!0,pausedByOtherPlayer:!0})}catch(e){M.error(this._logPrefix,`handleAdProgress`,`Error trying to pause player`,e)}return}let{duration:t,position:n}=e;if(this._adCountDown.canStartAdCountDown&&this._adCountDown.updateAdCountdown(t,n),this._currentAdTime=n,this._config.video.logAdDuration&&!this._adDurationLogged){let e={adDuration:t,roundedAdDuration:Math.round(t)};M.event(this._logPrefix,`_handleAdProgress`,`VideoAdDuration`,e),this._adDurationLogged=!0}}_handleAdImpression(e){var t;this._outsideGamRenderTriggered&&this._eventProxy.loggingBidWon.emit(this._bidWonData),this._handlingAdError=!1,this._isGamCalled=!1;let n=(t=this._getFormattedAdDetails(e))==null?{}:t;this._eventProxy.emitVideoImpressionEvent({videoAdDetails:n,player:this}),this._config.video.logAdLifeCycle&&M.event(this._logPrefix,`_handleAdImpression`,this._playerType,this._getEventInfo(e))}_handleAdPause(){if(this._clearStaleTimers(),this.imaManager.adPlay.once(e=>{if(this._currentAdTime!==0){var t;let n=((t=this._getFormattedAdDetails(e))==null?void 0:t.duration)||this._defaultAdDuration;this._currentAdDurationWithBuffer=n+this._stalePlayerTimeoutBuffer,this._setStaleAdDetection()}}),this.collapseCollection){if(this._isProgrammaticPause)this._isProgrammaticPause=!1;else if(this.collapseCollection){var e;let t=((e=this.collapseCollection)==null?void 0:e.playerState)===Y.Closed;if(t)return;this.collapseCollection.playerState=this.collapseCollection.playerCollapsed?Y.UserPauseCollapsed:Y.UserPauseUncollapsed}}}_handleAdPlay(){if(this._isProgrammaticPlay)this._isProgrammaticPlay=!1;else if(this.collapseCollection){var e;let t=((e=this.collapseCollection)==null?void 0:e.playerState)===Y.Closed;if(t)return;this.collapseCollection.playerState=this.collapseCollection.playerCollapsed?Y.CollapsedPlay:Y.UncollapsedPlay}}async _runPrerollAdInAdPod(){this._loadingSpinner.show(),this._adFetched||(this._adPodManager.incrementSessionPrerollNumber(),await this._doubleRequestVideoBids()),this._resetIMA(),await this._makeGamCall(),this._resetAdVars(),this.imaManager.adReady.emit(),this.imaManager.playAd()}_maxRetriesReached(){let e=this._raptiveInstreamRerequestOnErrorResult===`vpr`&&this.prerollNum>5,t=this._raptiveInstreamRerequestOnErrorResult===`vpr2`&&this._retryAttempts>=2,n=this._retryAttempts>=this._maxRetries;return e||t||n}_resetIMA(){this._reInitAttempts=0,this._removeInstream(),this.imaManager.reInitIMA()}async _adFailedLogic(){let e=this._maxRetriesReached(),t=this._adPodManager.canApplyAdPodExperience();if(e||this._raptiveInstreamRerequestOnErrorResult===`off`||t){this._adPodManager.canFetchNextAdInPod()?(this._adFetched=!1,await this._runPrerollAdInAdPod()):this._continuePlayingNextContent();return}this._retryAttempts+=1,this._prebidMethods.getHighestCpmBids(this.name).length||(this._auctionManager.beforeBidRequest(!0),await this.requestVideoBids([this])),this._resetIMA(),this._makeGamCall(),this._loadingSpinner.show()}async _awaitAdReady(){return new Promise(e=>{this.imaManager.adReady.once(()=>{e()})})}_handleAllAdsComplete(){this._shouldUseHardcodedAdPodDuration||this._adCountDown.hideAdTimer()}_handleContentResumeRequested(){if(this._shouldUseHardcodedAdPodDuration||this._adCountDown.hideAdTimer(),this._videoStarted=!1,this._handlingAdError){M.event(this._logPrefix,`_handleContentResumeRequested`,`PrematureContentResumeRequested`,this._playerType);return}if(this._adPodManager.canApplyAdPodExperience()&&this._adPodManager.canPlayAdPodPrerollAd()){this._runPrerollAdInAdPod();return}this._adCountDown.hideAdTimer(),this._adCountDown.reset(),this._hlsManager.setMaxBufferLength(600),this._tearDownAfterNextAd&&(this._incrementPlaylistIndex(),this._tearDownPlayer()),this._continuePlayingNextContent()}_isGAMServerFailure(e){return this._isGamCalled&&e.code===iC.FAILED_TO_REQUEST_ADS}async _handleAdError(e){this._handlingAdError=!0,this.imaManager.adPlayReady||await this._awaitAdReady(),this._adKickoffCompletePromise.resolve(),this._clearStaleTimers();let t=this._prerollAdUrl;this._bidMarkedOnCurrentAd=!1,this._adDetails||(this._addWinningBidDetails(),this._adDetails={...this._winningBidDetails,adUnitName:this.name,tag:t,isEmpty:!0});let n={...e,...this._getPlayerVersions(),...this._getErrorLogAdDetails()};if(M.error(this._logPrefix,`vastError`,this._playerType,n),this._shouldUseHardcodedAdPodDuration||this._adCountDown.hideAdTimer(),this._adsDisabled){this._continuePlayingNextContent();return}if(this._isGAMServerFailure(e)){let t=this.getMinMaxDurationsForGAM(),n=this._auctionManager.getTopVideoBid(t,this.name);if(n){this._bidWonData={topBid:n,vprenum:this.prerollNum,vastErrorCode:e.code||-1},this._isGamCalled=!1,this._outsideGamRenderTriggered=!0,this._videoEventBus.triggerRenderVideoAdOutsideGam.emit({player:this,topBid:n}),n&&`adId`in n&&this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name,adId:n.adId});return}}this._outsideGamRenderTriggered=!1,this._checkRenderedAdDetails(!0),e.code===900&&this._eventProxy.emitVideoSlotRenderedEvent(this._adDetails),this._adFailedLogic()}_handleLogEvent(e){var t,n;let r=(t=e.getAdData())==null||(t=t.adError)==null?void 0:t.getMessage();if(M.event(this._logPrefix,`_handleLogEvent`,`LOG`,`non-fatal error occured for ad id: ${((n=this._adDetails)==null?void 0:n.adId)||`unavailable`}`,{error:r,adDetails:this._adDetails}),!this._adDetails||!this._prebidAuctionManager){M.event(this._logPrefix,`_handleLogEvent`,`LOG`,`no ad details available`,{error:r});return}let i=this._markPrebidBidAsUsed(this._adDetails.gamCreativeId,this._prebidAuctionManager,this._adDetails.wrapperSystems);if(this._bidMarkedOnCurrentAd){let e=i?`marked bid as used for ad id: ${i}`:`marked winning bid as used`;M.event(this._logPrefix,`_handleLogEvent`,`LOG`,e,{error:r,adDetails:this._adDetails})}}_programmaticPlayVideo({logEvent:e}={logEvent:!0}){return new Promise((t,n)=>{if(e&&this._listenForPlayerEventsToLog({action:`programmaticPlay`,context:this._adPlaying?`ad`:`content`}),!this._adPlaying)this._isProgrammaticPlay=!0,this._videoElement.play().then(t).catch(n);else try{this.imaManager.playAd(),t()}catch(e){n(e)}})}_handleVideoElementPlay(){var e,t,n;if((e=this._videoPlayerControls)==null||e.setMediaStarted(!0),!this._adsDisabled&&this._wasSeeking&&(this._isVideoEnded||this._videoElement.currentTime===0)){var r;(r=this._videoPlayerControls)==null||r.toggleProgressBar(!1),this._toggleAdContainer(!0),this._adCountDown.hideAdTimer(),this._programmaticPauseVideo({pauseContent:!0,logEvent:!1});return}if((t=this._videoPlayerControls)==null||t.toggleControlsFullWidth(!0),!this._adsDisabled&&this.isFirstPlay){var i,a;this._programmaticPauseVideo({pauseContent:!0,logEvent:!1}),(i=this._videoPlayerControls)==null||i.toggleProgressBar(!1),this._toggleAdContainer(!0),(a=this._advancePlaylist)==null||a.reset(!0),this.imaManager.adReady.emit()}if((n=this._videoPlayerControls)==null||n.toggleProgressBar(!0),this._isProgrammaticPlay)this._isProgrammaticPlay=!1;else if(this.collapseCollection){var o;let e=((o=this.collapseCollection)==null?void 0:o.playerState)===Y.Closed;if(e)return;this.collapseCollection.playerState=this.collapseCollection.playerCollapsed?Y.CollapsedPlay:Y.UncollapsedPlay}}_programmaticPauseVideo(e={logEvent:!0}){let{pauseContent:t,logEvent:n,pausedByOtherPlayer:r}=e;this._isProgrammaticPause=!0;let i;!this._adPlaying||t?(i=`content`,this._videoElement.pause()):(i=`ad`,this.imaManager.pauseAd({pausedByOtherPlayer:r})),n&&this._listenForPlayerEventsToLog({action:`programmaticPause`,context:i})}_handleVideoElementPause(){if(this._adPlaying||(this._toggleTitle(!0),this._adCountDown.hideAdTimer()),this.collapseCollection){if(this._isProgrammaticPause)this._isProgrammaticPause=!1;else if(this.collapseCollection){var e;let t=((e=this.collapseCollection)==null?void 0:e.playerState)===Y.Closed;if(t)return;this.collapseCollection.playerState=this.collapseCollection.playerCollapsed?Y.UserPauseCollapsed:Y.UserPauseUncollapsed}}}_handleVideoElementSeeking(e){e.type===`seeking`&&(this._wasSeeking=!0)}_handleVideoElementSeeked(e){e.type===`seeked`&&(this._wasSeeking=!1)}async _handleVideoElementTimeUpdate(){let e=this._videoElement,t=e.currentTime,n=e.duration,r=n-t;if(t>=.5&&!this._videoStarted&&(this._videoStarted=!0,this._isVideoEnded=!1,this._loadingSpinner.hide(),this.collapseCollection&&(this.collapseCollection.playbackStarted=!0,this._handleScroll())),!this.canPlay){this._prepareToPausePlayer(),this._programmaticPauseVideo({pauseContent:!0,pausedByOtherPlayer:!0,logEvent:!0});return}t>3&&this._videoTitleOverlayContainer.classList.contains(`active`)&&!this._wasSeeking&&this._toggleTitle(!1),!this._adsDisabled&&r<10&&!this._adFetched&&this._adPodManager.shouldFetchNextAd&&await this._handleAdvancePlaylistFetchAd()}async _getPrerollAdUrl(){if(`rvp_vastOverride`in window){let e=await window.rvp_vastOverride(this.prerollNum);if(e)return e}let e=this._adDurationControlExperiment.result;if(e&&e!==`off`){let t=`https://vast-tags.com/category/${e}?prerollNum=${this.prerollNum}`;return t}return await this._videoEventBus.buildingVastAdURL.legacyEmit([this]),this.buildVideoUrl(this)}_requestNextAdAuctionInPod(){this._adPodManager.canFetchNextAdInPod()&&(this._adPodManager.incrementSessionPrerollNumber(),this._auctionManager.reset(),this._doubleRequestVideoBids())}async _doubleRequestVideoBids(){this._adFetched=!0,await this._requestBids(),await this._requestBids()}async _requestBids(){this._auctionManager.incrementCurrentAuctionNumber(),this._auctionManager.beforeBidRequest(!1,this._adPodManager.canFallBackAuction),await this.requestVideoBids([this])}_setNextMediaId(){var e;let t=this._getVideoUsingIndex(this._getNextIndex());this.nextMediaId=(e=t==null?void 0:t.mediaid)==null?`nf`:e}async _fetchLinearAd(){if(this._setNextMediaId(),this._adsDisabled){this._continuePlayingNextContent();return}this._jwBoostExperiment.result&&this.videoAdUnit&&this._updateAdUnitMediaId(this.videoAdUnit),this._config.ccpa.userOptedOut||this._enrichBidsWithJwTargeting(),await this._doubleRequestVideoBids(),this._makeGamCall()}_handleVideoElementEnded(){var e,t;if(this._isVideoEnded=!0,this._videoStarted=!1,(e=this._advancePlaylist)==null||e.reset(),(t=this._videoPlayerControls)==null||t.toggleProgressBar(!1),this._toggleTitle(!1),this._loadingSpinner.show(),this._adsDisabled){this._continuePlayingNextContent();return}if(this._programmaticPauseVideo({pauseContent:!0,logEvent:!1}),this._adFetched){var n;this._toggleAdContainer(!0),(n=this._advancePlaylist)==null||n.reset(!0),this.imaManager.adReady.emit()}else this._continuePlayingNextContent()}_handleResizeAd(){this.imaManager.resize()}_addWinningBidDetails(){let e=this._prerollAdUrl,t=e&&this._getCustParamsFromQueryString(e),{hb_adid:n,hb_adomain:r,hb_bidder:i,amznp:a,hb_pb:o,amznbid:s,hb_deal:c}=t||{};this._winningBidDetails={hb_adid:`${n}`,adomain:`${r}`,hb_bidder:`${i}`,amznp:`${a}`,hb_pb:`${o}`,amznbid:`${s}`,hb_deal:`${c}`}}_checkRenderedAdDetails(e=!1){let t=this._prebidAuctionManager,n=this._adDetails;if(!t||!n||this._bidMarkedOnCurrentAd)return;let r=n.gamCreativeId,i=n.wrapperSystems;this._markPrebidBidAsUsed(r,t,i,e)}_clearStaleTimers(){this._stalePlayerTimeoutId&&(clearTimeout(this._stalePlayerTimeoutId),this._stalePlayerTimeoutId=null)}_adjustStylesForContentPlayback(){var e,t;(this._isMobile||this._isTablet)&&((e=this._videoPlayerControls)==null||e.hideControls()),this._toggleTitle(!0),this._toggleAdContainer(!1),this._loadingSpinner.hide(),(t=this._videoPlayerControls)==null||t.toggleProgressBar(!0),this._adCountDown.hideAdTimer()}_continuePlayingNextContent(){this._isAcAlwaysStickyEnabled&&this._handleCollapsingPlayer(),this._handlingAdError=!1,this._adPlaying=!1,this._hlsManager.setMaxBufferLength(600),this.isFirstPlay||this.setNextVideo();let e=this._shouldStartAdvancePlaylist();this.isFirstPlay=!1,!this._adsDisabled&&this._reInitAttempts<1&&(this._removeInstream(),this.imaManager.reInitIMA(),this._reInitAttempts++),this._resetAdVars(),this._programmaticPlayVideo({logEvent:!1}).then(async()=>{var t,n;this._adjustStylesForContentPlayback(),this._logRaptivePlayerEvent(`Play`);let{adPodDuration:r,adPodSize:i}=this._adPodManager;e&&((t=this._advancePlaylist)==null||t.start(this._videoElement.duration,r,i)),this._adPodManager.canApplyAdPodExperience()&&this._adPodManager.incrementVideoContentPlayCount(),await qK(1),(n=this.imaManager.adsLoader)==null||n.contentComplete()}).catch(()=>{})}_enableRemoveRaptivePLayer(){this._tearDownAfterNextAd=!0,this._getPlaylistIdForLogger()}_getAdDetailsFromAd(e){return e&&Object.keys(e).length>0?e[Object.keys(e)[0]]:null}_getCustParamsFromQueryString(e){let t=e&&Hh(e.split(`?`)[1]),n=t&&t.get(`cust_params`),r=n&&Uh(this._getDecodedURI(n));return r}_getDecodedURI(e){try{return decodeURIComponent(e)}catch(e){return``}}_getErrorLogAdDetails(){return(({wrapperIds:e,wrapperCreativeIds:t,wrapperSystems:n,vastCreativeId:r,mediaFileURL:i,adId:a,adUnitName:o,adomain:s,hb_bidder:c,amznp:l,hb_pb:u,amznbid:d,hb_deal:f})=>({wrapperIds:e,wrapperCreativeIds:t,wrapperSystems:n,vastCreativeId:r,mediaFileURL:i,adId:a,adUnitName:o,adomain:s&&encodeURIComponent(s),hb_bidder:c,amznp:l,hb_pb:u,amznbid:d,hb_deal:f}))(this._adDetails||{})}_getEventInfo(e){let{adId:t,adSystem:n,adWrapperIds:r,mediaurl:i,adWrapperSystems:a,apiFramework:o,duration:s,height:c,title:l,vpaid:u}=e.ad;return{vprenum:this.prerollNum,playerName:this.name,adId:t,adSystem:n,adWrapperIds:r,mediaurl:i,adWrapperSystems:a,apiFramework:o,duration:s,height:c,title:l,vpaid:u}}_getPlayerVersions(){return{imaSDKVersion:this.imaManager.imaSDKVersion}}_markPrebidBidAsUsed(e=``,t,n=[],r=!1){let i=e&&t.videoCreativeIdMapping.get(e),a=!1,o=!1,s=!1;if(n.forEach(e=>{let t=e.toLowerCase();t===`gdfp`&&(o=!0),t===`prebid.org wrapper`?a=!0:t===`amazon`&&(s=!0)}),i){let e=this._adDetails,t=e&&e.tag&&this._getCustParamsFromQueryString(e.tag),n=(t||{})[`hb_adid_${i}`.substring(0,20)];if(n)return this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name,adId:n,...!r&&{analytics:!0}}),this._bidMarkedOnCurrentAd=!0,r?this._creativeFailureDetection(n):this._logCreativeIdWithPreviousError(n),n}else e?M.event(this._logPrefix,`_markPrebidBidAsUsed`,{message:`Creative Id Not Found`,gamCreativeId:e}):((a||o&&!s||!n.length)&&(this._bidMarkedOnCurrentAd=!0,this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name,...!r&&{analytics:!0}})),M.event(this._logPrefix,`_markPrebidBidAsUsed`,{message:`Missing Creative Id`}))}_creativeFailureDetection(e){let t=this._prebidMethods.getBidResponsesForAdUnitCode(this.name).bids||[],n=this._config,r=n.video.instreamCreativeFailureThreshold;for(let a of t){var i;let t=(i=a.creativeId)==null?void 0:i.toString();if(a.adId===e&&t){let e=this._erroredOutCreativeIds.get(t)||0;e++,this._erroredOutCreativeIds.set(t,e),e>=r&&n.prebid.blockedCreativeIds.push(t);break}}}_logCreativeIdWithPreviousError(e){let t=this._prebidMethods.getBidResponsesForAdUnitCode(this.name).bids||[];for(let n of t)if(n.adId===e&&n.creativeId){let e=this._erroredOutCreativeIds.get(n.creativeId.toString())||0;e&&M.event(this._logPrefix,`_logCreativeIdWithPreviousError`,{creativeId:n.creativeId});break}}_resetAdVars(){this._bidMarkedOnCurrentAd=!1,this._adDetails=null,this._adFetched=!1,this._adDurationLogged=!1,this._currentAdTime=0,this._currentAdDurationWithBuffer=0,this._clearStaleTimers(),this.imaManager.setAdPlayReady(!1),this.imaManager.setPrematureAdPlay(!1),this._retryAttempts=0,this._auctionManager.reset()}_resetPlayerProperties(){var e;this._adPodManager.reset(),this._adPlaying=!1,this._canTearDown=!1,this._isProgrammaticPause=!0,this._isProgrammaticPlay=!0,this._isVideoEnded=!1,this._playerState=Y.Unstarted,this._tearDownAfterNextAd=!1,this._videoStarted=!1,(e=this._videoPlayerControls)==null||e.toggleProgressBar(!0)}_setStaleAdDetection(e=`adPlay`){let t=e===`adLoaded`,n=e===`adStart`,r=n?0:this._currentAdTime,i=t?this._config.video.staleLoadThreshold:this._currentAdDurationWithBuffer-r,a=`RaptivePlayer encountered an unknown error ${t?`attempting to play the ad`:`during ad play`}`;this._stalePlayerTimeoutId||(this._stalePlayerTimeoutId=window.setTimeout(()=>{M.error(this._logPrefix,`stalePlayer`,{message:a,...this._getPlayerVersions(),...this._getErrorLogAdDetails()}),this._tearDownPlayerTimeout===-1?(this._enableRemoveRaptivePLayer(),this._tearDownPlayer()):this._continuePlayingNextContent()},i*1e3))}_startTearDownTimer(){this._didTearDown=!1;let e=this._tearDownPlayerTimeout,t=this._canTearDown;t&&e/1e3,this._getPlaylistIdForLogger(),t&&(this._tearDownTimer=window.setTimeout(this._enableRemoveRaptivePLayer.bind(this),e))}_tearDownPlayer(){var e,t,n,r;let i=this._getPlaylistIdForLogger(),a=(e=this._videoContentObject)==null||(e=e.playlist)==null||(e=e[this._playlistIndex])==null?void 0:e.mediaid,o={adUnit:(t=this._videoAdUnit)==null?void 0:t.code,playerType:this._playerType,playerId:this._playerId,playlistId:i,mediaId:a,state:this._state,collapseState:(n=this.collapseCollection)==null?void 0:n.playerState,vp:this.prerollNum};M.event(this._logPrefix,`_tearDownPlayer`,o),this._tearDownTimer&&clearTimeout(this._tearDownTimer),this._removeInstream(!0),(r=this._advancePlaylist)==null||r.destroy(),this._hlsManager.reset(),this.injectPlayer(),this._hlsManager=this._createHlsManager(),this._setupPlayer(),this.imaManager.reInitIMA(),this._resetAdVars(),this._resetPlayerProperties(),this._handleScroll(),this._didTearDown=!0}_toggleAdContainer(e){let t=this._playerContainer.querySelector(`#adthrive-${this._playerType}-ad-container`);t&&(e?(t.classList.add(`adthrive-player-ad-container-loading`),t.classList.remove(`raptive-player-ad-container-idle`)):(t.classList.remove(`adthrive-player-ad-container-loading`),t.classList.add(`raptive-player-ad-container-idle`)))}_toggleTitle(e){this._config.video.removeVideoTitleWrapper||this._adPlaying||(e?this._videoTitleOverlayContainer.classList.add(`active`):this._videoTitleOverlayContainer.classList.remove(`active`))}_logRaptivePlayerEvent(e){var t;let n=this._playerId,r=this._getPlaylistIdForLogger(),i=this._playerType,a=(t=this._videoContentObject)==null||(t=t.playlist)==null||(t=t[this._playlistIndex])==null?void 0:t.mediaid,o=this._mediaIdCount;M.event(this._logPrefix,e,{playerId:n,playlistId:r,mediaId:a,playerType:i,mediaIdCount:o})}_createCollapsibleCollection(){this.collapseCollection={adContainer:this.imaManager.adContainer,closeButton:this._closeButton,collapseMobileSizeType:this._collapseSettings.collapseMobileSizeType,collapseMobileSubType:this._getCollapseMobileSubType(),collapseSubType:xW.BottomRight,collapseTimer:{timeCollapsed:0,isRunning:!1},collapseType:this._collapseSettings.collapseType,footerElement:this._config.video.footerSelector?document.querySelector(this._config.video.footerSelector):null,forceMobile:this._context.device!==`desktop`,hasPreviouslyCollapsed:!1,playbackStarted:!1,mobileHeaderSelector:this._collapseSettings.mobileHeaderSelector,playerCollapsed:!1,playerContainer:this._playerContainer,playerPosition:this._playerPosition,playerState:this._playerState,playerType:this._playerType,programmaticPause:this._programmaticPauseVideo.bind(this),programmaticPlay:e=>void this._programmaticPlayVideo(e),saveVideoCloseState:this._collapseSettings.saveVideoCloseState,stickyElement:this._stickyElement,title:this._collapseSettings.title,topBackgroundElement:this._topBackgroundElement,showPlayer:this.show.bind(this),hidePlayer:this.hide.bind(this),isAcAlwaysStickyEnabled:this._isAcAlwaysStickyEnabled}}_getCollapseMobileSubType(){var e;return this._mobileStickyPlayerPositionSiteExperiment.enabled&&this._mobileStickyPlayerPositionSiteExperiment.result!==`control`?Pf.setMobileLocation(this._mobileStickyPlayerPositionSiteExperiment.result):this._mobileStickyPlayerPositionCoreExperiment.mobileLocation?Pf.setMobileLocation(this._mobileStickyPlayerPositionCoreExperiment.mobileLocation):(e=this._collapseSettings)==null?void 0:e.mobileLocation}async _handleScroll(){let e=this._config.gdpr;!e.consentCaptured&&e.enabled&&await this.waitForConsent(),this.collapseCollection&&GI.handleScroll(this.collapseCollection)}_handleResize(){this.collapseCollection&&GI.handleResize(this.collapseCollection)}_handlePageVisibilityChange(e){this.collapseCollection&&GI.handlePageVisibilityChange(e,this.collapseCollection)}_handleTransformForCollapse(){var e,t;if(!((e=this.collapseCollection)!=null&&e.playerCollapsed))return;this._handleSlickHeartBeat();let n=this._translateX===0?``:`translateX(${this._translateX}px)`,r=this._translateY===0?``:`translateY(-${this._translateY}px)`,i=`${n} ${r}`.trim();(t=this.collapseCollection)==null||t.playerContainer.style.setProperty(`transform`,i,`important`)}_handleSlickHeartBeat(){if(this._slickHeartbeatPresent)return;let e=this._getCollapseMobileSubType()===`adthrive-collapse-bottom-right`;this._slickHeartbeatPresent=!!document.querySelector(`slick-heartbeat`),this._slickHeartbeatPresent&&e&&(this._translateX=-60)}_handleFooterHeightChange(e){var t;let n=_n();this._translateY=e-n,(t=this.collapseCollection)!=null&&t.playerCollapsed&&(GI.repositionCollapseMobileBottom(this.collapseCollection),this._handleTransformForCollapse())}_displayCloseButton(){this.collapseCollection&&GI.displayCloseButton(this.collapseCollection)}_linkProvidedByPublisher(e){return!e.startsWith(`https://cdn.jwplayer.com`)}_handleClose(){if(this.collapseCollection){if(this._collapseSettings.saveVideoCloseState&&U.setExpirableInternalLocalStorage(`adthrive_video_closed`,!0,{expiry:{value:30,unit:`minutes`}}),this._isAdvancePlaylistEnabled){var e;(e=this._advancePlaylist)==null||e.reset()}GI.handleClose(this.collapseCollection,this.prerollNum)}}_handleWidthBreak(e){this.collapseCollection&&GI.handleWidthBreak(e,this.collapseCollection)}_handleTitleClick(e){var t;(t=this.collapseCollection)!=null&&t.collapseTimer.firstInView&&M.event(this._logPrefix,`_handleTitleClick`,{timeElapsed:Date.now()-this.collapseCollection.collapseTimer.firstInView.valueOf(),link:e.currentTarget.getAttribute(`href`)})}_handleFooterResponseReceivedEvent(){this.collapseCollection&&this.collapseCollection.playerCollapsed&&GI.repositionCollapseMobileBottom(this.collapseCollection)}get _isTopCollapse(){return this._getCollapseMobileSubType()===`adthrive-collapse-top-center`}_createTopCenterBackground(e){this._topBackgroundElement=this._createPlayerCollapseBackgroundElement(),this._topCenterBackgroundColor=this._config.adOptions.bgColor,this._topCenterBackgroundColor&&(this._topBackgroundElement.style.backgroundColor=this._topCenterBackgroundColor),e.appendChild(this._topBackgroundElement)}_createLinkIcon(e){let t=document.createElementNS(`http://www.w3.org/2000/svg`,`svg`);t.setAttribute(`width`,`24`),t.setAttribute(`height`,`24`),t.setAttribute(`style`,`vertical-align:top;margin-right:10px`);let n=document.createElementNS(`http://www.w3.org/2000/svg`,`path`);return n.setAttribute(`d`,`M 16 1 H 23 V 8 Z M 19.5 12.5 V 23 H 1 V 4.5 H 12 l 1 1 H 2 V 22 H 18.5 V 11.5 l 1 1 v 1 M 19 4 L 11.5 11.5 l 1 1 L 20 5`),n.setAttribute(`stroke`,`white`),n.setAttribute(`stroke-width`,`2`),n.setAttribute(`stroke-linejoin`,`round`),t.appendChild(n),t.id=`${e}-svg-link`,t}_addTopCenterWrapper(){this._playerContainer.appendChild(this._createPlayerWrapper()),this._playerContainer.appendChild(this._createTopCollapseWrapper()),this._playerContainer.classList.add(`adthrive-player-with-wrapper-text`)}_addPlayerWithoutWrapper(){this._playerContainer.appendChild(this._createPlayerWrapper()),this._playerContainer.classList.add(`adthrive-player-without-wrapper-text`)}_createPlayerWrapper(){let e=this._videoTitleOverlayContainer;return this._videoTitleElement=document.createElement(`span`),this._videoTitleElement.classList.add(`adthrive-video-text-cutoff`,`adthrive-video-title`),e.classList.add(`adthrive-wrapper-bar`),e}_createLearnMoreLink(e,t){let n=document.createElement(`a`),r=[`raptive-player-learn-more-link`,`adthrive-learn-more-link`,...t?[`raptive-player-learn-more-link-active`]:[]];return n.classList.add(...r),n.innerText=`Tap here to learn more.`,n.id=`${e}-learn-more-link`,n.style.color=this._topCenterBackgroundColor===`#FFFFFF`?`black`:`white`,n}_createTopCollapseWrapper(){let e=this._isAutoInjectedPlayer(),t=document.createElement(`div`);t.className=`adthrive-top-collapse-wrapper-bar`,this._closeButton=this._createPlayerCloseButton();let n=document.createElement(`div`);n.className=`adthrive-top-collapse-close-spacer`,n.appendChild(this._closeButton),t.appendChild(n),this._wrapperText=document.createElement(`a`);let r=this._linkProvidedByPublisher(this._videoLink);r&&e&&(this._wrapperText.href=this._videoLink),this._topCollapseVideoTitleElement=document.createElement(`span`),this._topCollapseVideoTitleElement.classList.add(`adthrive-top-collapse-wrapper-video-title`);let i=this._config.adOptions.secColor;if(i&&(this._topCollapseVideoTitleElement.style.color=i,this._topCollapseVideoTitleElement.innerHTML=this._videoTitle),this._wrapperText.appendChild(this._topCollapseVideoTitleElement),e){let e=this._createLearnMoreLink(this._playlistId,r);this._wrapperText.appendChild(e),this._wrapperText.onclick=this._handleTitleClick.bind(this)}return t.appendChild(this._wrapperText),t}_isMobileTopCenterCollapse(){var e;return((e=this._collapseSettings)==null?void 0:e.collapseType)===yW.Mobile&&this._isTopCollapse}_createPlayerCloseButton(){var e;let t=this._wrapperTitleWrapperElement||this._videoTitleElement;return this._closeButton=this._videoCloseButtonComponent.createPlayerCloseButton(this._handleClose.bind(this),`instream`,`adthrive-collapse-close`,!!t,this._isMobileTopCenterCollapse()?`top-center`:(e=this._collapseSettings)==null?void 0:e.collapseType),this._closeButton}_createPlayerCollapseBackgroundElement(){let e=document.createElement(`div`);return e.classList.add(`adthrive-collapse-mobile-background`),e.style.width=`${window.innerWidth}px`,e.style.display=`inline`,e.style.height=`0`,e}setAmznBids(e){this._auctionManager.setAmznBids(e)}setPrebidBids(e){this._auctionManager.setPrebidBids(e)}get amzName(){return this._auctionManager.amznAdUnitName}getMinMaxDurationsForGAM(){if(this._auctionManager.enabled)return this._auctionManager.hasFallenBack||this._retryAttempts>0?void 0:{min_ad_duration:1e3,max_ad_duration:15e3}}set lastAuctionBidDetails(e){this._lastAuctionBidDetails=e}get lastAuctionBidDetails(){return this._lastAuctionBidDetails}get captionLanguage(){var e;return(e=this._videoPlayerControls)==null?void 0:e.captionLanguage}},T(QH,`DEFAULT_MAX_NUMBER_OF_ADS_IN_POD`,4),T(QH,`MAX_ADS_IN_30SEC_POD`,2)})),eU,tU=o((()=>{bt(),w(),wt(),E(),O(),eU=class extends Ct{constructor(...e){super(...e),T(this,`videoAdUnitAdded`,new k),T(this,`videoPlayerAdded`,new k),T(this,`videoCollapsed`,new k),T(this,`videoUnCollapsed`,new k),T(this,`preRequestVideoBids`,new k),T(this,`requestingVideoBids`,new k),T(this,`buildingVastAdURL`,new k),T(this,`addAPStagSlotBidResponse`,new k),T(this,`topCenterVideoClosed`,new k),T(this,`topCenterVideoCollapsed`,new k),T(this,`topCenterVideoUnCollapsed`,new k),T(this,`amazonVideoBidResponseReceived`,new k),T(this,`auctionsCompleted`,new k),T(this,`settingsUpdated`,new k),T(this,`triggerRenderVideoAdOutsideGam`,new k),T(this,`videoAdRenderingOutsideGam`,new k)}},eU=D([C()],eU)})),nU,Dfe=o((()=>{w(),bt(),wt(),E(),O(),nU=class extends Ct{constructor(...e){super(...e),T(this,`realizedAdDensityCompReady`,new k),T(this,`metricsRequested`,new k)}},nU=D([C()],nU)})),rU=o((()=>{Vee(),hr(),Hee(),Uee(),Wee(),br(),Gee(),Jee(),Fr(),Yee(),Xee(),Zee(),Fr(),Qee(),$ee(),Hr(),Wr(),tU(),Dfe()})),iU,aU=o((()=>{w(),rU(),$(),E(),iU=class{constructor(){T(this,`_siteExperimentEventBus`,x.resolve(Br)),T(this,`_isTargeted`,!1),T(this,`experimentConfig`,void 0)}get result(){return this._isTargeted||(this._siteExperimentEventBus.targetingReady.emit(),this._isTargeted=!0),this._result}get enabled(){return this.experimentConfig!==void 0}_isValidResult(e,t=()=>!0){return t()&&Ym(e)}}})),oU,sU=o((()=>{$(),fr(),aU(),E(),oU=class extends iU{constructor(...e){super(...e),T(this,`_resultValidator`,()=>!0)}_isValidResult(e){return super._isValidResult(e,()=>this._resultValidator(e)||e===`control`)}run(){if(!this.experimentConfig||!this._mappedChoices||this._mappedChoices.length===0)return M.error(`WeightedChoiceSiteExperiment`,`run`,`No experiment config found`),`control`;let e=new dr(this._mappedChoices).get(),t=this._isValidResult(e);return t?e:(M.error(`WeightedChoiceSiteExperiment`,`run`,`Invalid result from experiment choices. Defaulting to control.`,e),`control`)}}})),cU,lU=o((()=>{Z(),E(),cU=class{constructor(e){var t,n;T(this,`siteExperiments`,[]),T(this,`_device`,void 0),this._device=tG()?`mobile`:`desktop`,this.siteExperiments=(t=e==null||(n=e.siteExperiments)==null?void 0:n.filter(t=>{let n=t.key,r=TK(t,this._device),i=aK(e,n,this._device);return r&&i}))==null?[]:t}getSiteExperimentByKey(e){let t=this.siteExperiments.filter(t=>t.key.toLowerCase()===e.toLowerCase())[0],n=UW(`at_site_features`),r=WW(t!=null&&t.variants[1]?t==null?void 0:t.variants[1].value:t==null?void 0:t.variants[0].value,n[e]);return t&&n[e]&&r&&(t.variants=[{displayName:`test`,value:n[e],weight:100,id:0}]),t}}})),uU,dU=o((()=>{w(),lU(),j(),E(),At(),O(),uU=class extends cU{constructor(e){var t;super(e.siteAds),T(this,`_players`,void 0),this._players=(t=e.siteAds.videoPlayers)==null?void 0:t.players}getVideoPlaylistByType(e){var t,n;return(t=(n=this._players)==null?void 0:n.filter(t=>t.type===e))==null?[]:t}},uU=D([C(),A(`design:paramtypes`,[Object]),kt(0,ot(`AdThrive`))],uU)})),fU=o((()=>{nr(),sU(),aU(),dU(),fr()})),pU,mU=o((()=>{fU(),Vi(),pU=class extends Bi{get _choices(){let e=this._coreExperimentConfig.getWeightedChoiceVariants(this.key,this.lookup);return!e||e.length,e}run(){if(this._choices)return new dr(this._choices).get()}}})),hU,Ofe=o((()=>{mU(),w(),O(),hU=class extends pU{init(){this._key=`AdDurationControl`,this._lookup=`ADC`}},hU=D([C()],hU)})),gU,kfe=o((()=>{mU(),w(),O(),gU=class extends pU{init(){this._key=`RaptivePlayerBackBufferLength`,this._lookup=`RPBBL`}},gU=D([C()],gU)})),_U,Afe=o((()=>{Ui(),w(),E(),O(),_U=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`ContentSpecificPlaylists`,this._lookup=`CSP`}},_U=D([C()],_U)})),vU,jfe=o((()=>{mU(),w(),O(),vU=class extends pU{init(){this._key=`RaptivePlayerFrontBufferThreshold`,this._lookup=`RPFBT`}},vU=D([C()],vU)})),yU,Mfe=o((()=>{mU(),w(),O(),yU=class extends pU{init(){this._key=`InstreamCreativeFailureThreshold`,this._lookup=`ICFT`}},yU=D([C()],yU)})),bU,Nfe=o((()=>{mU(),w(),O(),bU=class extends pU{init(){this._key=`InstreamRerequestOnError2`,this._lookup=`IROE2`}},bU=D([C()],bU)})),xU,Pfe=o((()=>{Ui(),w(),E(),O(),xU=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`IOSPlayInline`,this._lookup=`IPLIN`}},xU=D([C()],xU)})),SU,Ffe=o((()=>{Ui(),$(),w(),E(),j(),O(),SU=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`JwBoost`,this._lookup=`JWB`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],SU.prototype,`run`,null),SU=D([C()],SU)})),CU,Ife=o((()=>{mU(),$(),w(),j(),O(),CU=class extends pU{init(){this._key=`JwRequestTimeout`,this._lookup=`REQTO`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],CU.prototype,`run`,null),CU=D([C()],CU)})),wU,Lfe=o((()=>{mU(),$(),w(),O(),wU=class extends pU{init(){this._key=`JWPVersionExperiment`,this._lookup=`JWPV`}},wU=D([Q(`JWPVersionExperiment`),C()],wU)})),TU,Rfe=o((()=>{Ui(),w(),E(),O(),TU=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`LogAdDuration`,this._lookup=`ADDUR`}},TU=D([C()],TU)})),EU,zfe=o((()=>{w(),Ui(),E(),O(),EU=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`LogAdLifeCycle`,this._lookup=`ADLIFECYC`}},EU=D([C()],EU)})),DU,Bfe=o((()=>{mU(),w(),O(),DU=class extends pU{init(){this._key=`IMABitrate`,this._lookup=`IMABR`}},DU=D([C()],DU)})),OU,Vfe=o((()=>{mU(),w(),O(),OU=class extends pU{init(){this._key=`RaptivePlayerMaxBufferLength`,this._lookup=`RPMBL`}},OU=D([C()],OU)})),kU,Hfe=o((()=>{mU(),w(),O(),kU=class extends pU{init(){this._key=`RaptivePlayerMaxBufferSize`,this._lookup=`RPMBS`}},kU=D([C()],kU)})),AU,Ufe=o((()=>{mU(),w(),O(),AU=class extends pU{init(){this._key=`RaptivePlayerMaxMaxBufferLength`,this._lookup=`RPMMBL`}},AU=D([C()],AU)})),jU,Wfe=o((()=>{Ui(),w(),E(),O(),jU=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`MaxMaxBufferReset`,this._lookup=`MMBR`}},jU=D([C()],jU)})),MU,Gfe=o((()=>{Ui(),w(),E(),O(),MU=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`MidrollBugFixExperiment`,this._lookup=`MRBF`}},MU=D([C()],MU)})),NU,Kfe=o((()=>{mU(),w(),E(),O(),NU=class extends pU{constructor(...e){super(...e),T(this,`locationMap`,{tc:`top-center`,bl:`bottom-left`,br:`bottom-right`})}init(){this._key=`VideoCollapsedLocations`,this._lookup=`SPLTV2`}get mobileLocation(){if(this.result&&this.result!==`off`)return this.locationMap[this.result]}},NU=D([C()],NU)})),PU,FU,IU,qfe=o((()=>{w(),$(),ii(),fU(),X(),j(),E(),O(),IU=class extends oU{constructor(e,t){super(),this._siteExperiments=e,this._pubabgroup=t,T(this,`_positions`,[`bottom-left`,`bottom-right`,`bottom-center`,`top-left`,`top-right`,`top-center`]),T(this,`_choices`,[]),T(this,`_mappedChoices`,[]),T(this,`_resultValidator`,e=>this._positions.includes(e)),T(this,`_result`,`control`),T(this,`key`,Xn.MobileStickyPlayerPosition),this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._mappedChoices=this._mapChoices(),this._result=this.run(),this.setExperimentTargeting())}run(){let e=super.run();return e}setExperimentTargeting(){if(!this.enabled||!this.experimentConfig||!this._isValidResult(this._result)){M.error(`MobileStickyPlayerPositionSiteExperiment`,`setExperimentTargeting`,`() => %o`,`Experiment targeting requires an experiment config and valid result`);return}let e=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`,t=`${this._result}`;this._pubabgroup.set(e,t)}_mapChoices(){return this._choices.map(({weight:e,value:t})=>({weight:e,choice:String(t)}))}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],IU.prototype,`run`,null),IU=D([C(),A(`design:paramtypes`,[typeof(PU=uU!==void 0&&uU)==`function`?PU:Object,typeof(FU=ri!==void 0&&ri)==`function`?FU:Object])],IU)})),LU,Jfe=o((()=>{mU(),w(),O(),LU=class extends pU{init(){this._key=`OutstreamCreativeFailureThreshold`,this._lookup=`OCFT`}},LU=D([C()],LU)})),RU,Yfe=o((()=>{mU(),w(),O(),RU=class extends pU{init(){this._key=`OutstreamPlacementExperiment`,this._lookup=`OSP`}run(){return super.run()}},RU=D([C()],RU)})),zU,BU,VU,Xfe=o((()=>{w(),fU(),X(),$(),ii(),Nt(),j(),E(),O(),VU=class extends tr{constructor(e,t){super(),T(this,`_result`,!0),T(this,`key`,`Playbackmethod`),T(this,`lookup`,`PBM`),T(this,`_choices`,[{choice:!0},{choice:!1}]),T(this,`_map`,new Map([[vW.Video_In_Post_ClicktoPlay_SoundOn,[3]],[vW.Video_Collapse_Autoplay_SoundOff,[6]],[vW.Video_Coll_SOff_Smartphone,[6]],[vW.Video_Individual_Autoplay_SOff,[6]]])),T(this,`playbackmethod`,void 0),T(this,`weight`,1);let n=t.getCoreExperimentButMutateWeights(this.key,this.lookup);if(n){this._expConfigABGroup=n.abgroup;let t=n.variants[0];this.weight=t.weight,this._result=this.run(),this.playbackmethod=this._result?this._map:void 0,e.set(n.abgroup,this._result?`on`:`off`)}}get result(){return this._result}run(){return new ar(this.weight).get()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],VU.prototype,`run`,null),VU=D([C(),A(`design:paramtypes`,[typeof(zU=ti!==void 0&&ti)==`function`?zU:Object,typeof(BU=jt!==void 0&&jt)==`function`?BU:Object])],VU)})),HU,Zfe=o((()=>{Ui(),w(),E(),O(),HU=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`PlaylistFix`,this._lookup=`PLFX`}run(){return super.run()}},HU=D([C()],HU)})),UU,Qfe=o((()=>{w(),$(),mU(),j(),O(),UU=class extends pU{init(){this._key=`Protocols`,this._lookup=`PROTO`}setABGroup(){if(this._result){var e;let t=-1;(e=this._choices)==null||e.forEach(e=>{var n;e.choice.value===((n=this._result)==null?void 0:n.value)&&(t=e.weight)}),super.setABGroup(this._result.value,this.abgroup,t)}}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],UU.prototype,`run`,null),UU=D([C()],UU)})),WU,$fe=o((()=>{Ui(),al(),w(),E(),O(),WU=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`RaptivePlayerDesktop`,this._lookup=`RPD`}isEnabled(){let e=il.isRolloutEnabled(`drp`);return super.isEnabled()&&!e}},WU=D([C()],WU)})),GU,epe=o((()=>{mU(),w(),O(),GU=class extends pU{init(){this._key=`RaptiveInstreamRerequestOnError`,this._lookup=`RIROE`}},GU=D([C()],GU)})),KU,tpe=o((()=>{Ui(),al(),w(),E(),O(),KU=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){let e=il.isRolloutEnabled(`erp`),t=il.isRolloutEnabled(`drp`);this._key=`RaptivePlayerMobile`,this._lookup=`RPM`,this._default=e&&!t}isEnabled(){let e=il.isRolloutEnabled(`drp`);return super.isEnabled()&&!e}},KU=D([C()],KU)})),qU,npe=o((()=>{mU(),w(),O(),qU=class extends pU{init(){this._key=`RaptiveTearDownPlayer`,this._lookup=`RPTD`}},qU=D([C()],qU)})),JU,rpe=o((()=>{Ui(),w(),E(),O(),JU=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`RaptivePlayerOverride`,this._lookup=`RP`}},JU=D([C()],JU)})),YU,ipe=o((()=>{mU(),w(),O(),YU=class extends pU{init(){this._key=`RaptivePlayerStaleLoadThreshold`,this._lookup=`RPSLT`}},YU=D([C()],YU)})),XU,ZU,QU,ape=o((()=>{w(),$(),ii(),fU(),X(),j(),E(),O(),QU=class extends iU{constructor(e,t){super(),this._siteExperiments=e,this._pubabgroup=t,T(this,`_choices`,[]),T(this,`_result`,!1),T(this,`key`,Xn.RemoveVideoTitleWrapper),this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}run(){let e=this._choices[0].weight/100,t=new ar(e).get();return t}setExperimentTargeting(){if(!this.enabled||!this.experimentConfig){M.error(`RemoveVideoTitleWrapperSiteExperiment`,`setExperimentTargeting`,`() => %o`,`Experiment targeting requires an experiment config`);return}let e=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`,t=this._result?`on`:`off`;this._pubabgroup.set(e,t)}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],QU.prototype,`run`,null),QU=D([C(),A(`design:paramtypes`,[typeof(XU=uU!==void 0&&uU)==`function`?XU:Object,typeof(ZU=ri!==void 0&&ri)==`function`?ZU:Object])],QU)})),$U,ope=o((()=>{mU(),w(),O(),$U=class extends pU{init(){this._key=`staleBufferTime`,this._lookup=`RPSPDBT`}run(){return super.run()}},$U=D([C()],$U)})),eW,spe=o((()=>{Ui(),w(),E(),O(),eW=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`DisplayBackupRenderer`,this._lookup=`DOFRE`}},eW=D([C()],eW)})),tW,cpe=o((()=>{mU(),$(),w(),E(),j(),O(),tW=class extends pU{constructor(...e){super(...e),T(this,`abgroup`,`socbde`)}init(){this._key=`StickyOutstreamCloseButtonTimeout`,this._lookup=`SOCBDE`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],tW.prototype,`run`,null),tW=D([C()],tW)})),nW,rW=o((()=>{Ui(),w(),E(),O(),nW=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`StickyOutstreamFooterCollision`,this._lookup=`SOFC`}},nW=D([C()],nW)})),iW,aW,oW,lpe=o((()=>{w(),$(),ii(),fU(),X(),j(),E(),O(),oW=class extends iU{constructor(e,t){super(),this._siteExperiments=e,this._pubabgroup=t,T(this,`_choices`,[]),T(this,`_result`,!1),T(this,`key`,Xn.StickyOutstream),this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}run(){let e=this._choices[0].weight/100,t=new ar(e).get();return t}setExperimentTargeting(){if(!this.enabled||!this.experimentConfig){M.error(`StickyOutstreamSiteExperiment`,`setExperimentTargeting`,`() => %o`,`Experiment targeting requires an experiment config`);return}let e=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`,t=this._result?`on`:`off`;this._pubabgroup.set(e,t)}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],oW.prototype,`run`,null),oW=D([C(),A(`design:paramtypes`,[typeof(iW=uU!==void 0&&uU)==`function`?iW:Object,typeof(aW=ri!==void 0&&ri)==`function`?aW:Object])],oW)})),sW,upe=o((()=>{mU(),w(),O(),sW=class extends pU{init(){this._key=`VastTimeoutISV`,this._lookup=`VASTTOISV`}run(){return super.run()}},sW=D([C()],sW)})),cW,dpe=o((()=>{mU(),w(),O(),cW=class extends pU{init(){this._key=`VastTimeoutOSV`,this._lookup=`VASTTOOSV`}run(){return super.run()}},cW=D([C()],cW)})),lW,uW,dW,fpe=o((()=>{w(),$(),ii(),fU(),X(),j(),E(),O(),dW=class extends iU{constructor(e,t){super(),this._siteExperiments=e,this._pubabgroup=t,T(this,`_choices`,[]),T(this,`_result`,!1),T(this,`key`,Xn.VideoAdvancePlaylistRelatedPlayer),this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key);let n=this._siteExperiments.getVideoPlaylistByType(`stickyPlaylist`);this.enabled&&this.experimentConfig&&n.length>0&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}run(){let e=this._choices[0].weight/100,t=new ar(e).get();return t}setExperimentTargeting(){if(!this.enabled||!this.experimentConfig){M.error(`VideoAdvancePlaylistRelatedPlayerSiteExperiment`,`setExperimentTargeting`,`() => %o`,`Experiment targeting requires an experiment config`);return}let e=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`,t=this._result?`on`:`off`;this._pubabgroup.set(e,t)}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],dW.prototype,`run`,null),dW=D([C(),A(`design:paramtypes`,[typeof(lW=uU!==void 0&&uU)==`function`?lW:Object,typeof(uW=ri!==void 0&&ri)==`function`?uW:Object])],dW)})),fW,ppe=o((()=>{Ui(),w(),E(),O(),fW=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`VideoAuctionDurationFallbackExperiment`,this._lookup=`VADF`}},fW=D([C()],fW)})),pW,mpe=o((()=>{w(),mU(),$(),Z(),j(),O(),pW=class extends pU{init(){this._key=`VideoCollapseScrollUpTopCenter`,this._lookup=`COSUFTC`}isEnabled(){return super.isEnabled()&&tG()}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],pW.prototype,`run`,null),pW=D([C()],pW)})),mW,hpe=o((()=>{Ui(),$(),Z(),w(),E(),j(),O(),mW=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`VideoCollapseScrollUp`,this._lookup=`VCSU`}isEnabled(){return super.isEnabled()&&!tG()}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],mW.prototype,`run`,null),mW=D([C()],mW)})),hW,gpe=o((()=>{mU(),w(),E(),O(),hW=class extends pU{constructor(...e){super(...e),T(this,`abgroup`,`vmaxdur`)}init(){this._key=`VideoDuration`,this._lookup=`VMAXDUR`}},hW=D([C()],hW)})),gW,_pe=o((()=>{Ui(),w(),E(),O(),gW=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!0)}init(){this._key=`RaptivePlayerEnablePreloading`,this._lookup=`RPEP`}},gW=D([C()],gW)})),_W=o((()=>{Ofe(),kfe(),Afe(),jfe(),Mfe(),Nfe(),Pfe(),Ffe(),Ife(),Lfe(),Rfe(),zfe(),Bfe(),Vfe(),Hfe(),Ufe(),Wfe(),Gfe(),Kfe(),qfe(),Jfe(),Yfe(),Xfe(),Zfe(),Qfe(),$fe(),epe(),tpe(),npe(),rpe(),ipe(),ape(),ope(),spe(),cpe(),rW(),lpe(),upe(),dpe(),fpe(),ppe(),mpe(),hpe(),gpe(),_pe()})),vW,yW,bW,xW,Y,SW,CW,wW=o((()=>{vW={Video_Collapse_Autoplay_SoundOff:`Video_Collapse_Autoplay_SoundOff`,Video_Individual_Autoplay_SOff:`Video_Individual_Autoplay_SOff`,Video_Coll_SOff_Smartphone:`Video_Coll_SOff_Smartphone`,Video_In_Post_ClicktoPlay_SoundOn:`Video_In-Post_ClicktoPlay_SoundOn`,Video_Collapse_Autoplay_SoundOff_15s:`Video_Collapse_Autoplay_SoundOff_15s`,Video_Individual_Autoplay_SOff_15s:`Video_Individual_Autoplay_SOff_15s`,Video_Coll_SOff_Smartphone_15s:`Video_Coll_SOff_Smartphone_15s`,Video_In_Post_ClicktoPlay_SoundOn_15s:`Video_In-Post_ClicktoPlay_SoundOn_15s`},yW={Float:`adthrive-collapse-float`,Mobile:`adthrive-collapse-mobile`},bW={Small:`adthrive-collapse-small`,Medium:`adthrive-collapse-medium`},xW={BottomRight:`adthrive-collapse-bottom-right`},Y={Unstarted:1,UncollapsedPlay:2,CollapsedPlay:3,UserPauseUncollapsed:4,UserPauseCollapsed:5,PausedNotVisible:6,Overlapped:7,Closed:8,NonLinearAdPlay:9,NonLinearAdPaused:10,NonLinearAdOverlapped:11,UserUnPaused:12},SW={Play:1,UserClick:2,PageSwitch:3,OutOfView:4,InView:5,Close:6,Overlapping:7,OtherVideoPlaying:8},CW={"":`Off`,"ar-SA":`Arabic`,"zh-CN":`Chinese`,"en-US":`English`,"fr-FR":`French`,"de-DE":`German`,"hi-IN":`Hindi`,"pt-PT":`Portuguese`,"es-US":`Spanish`}})),vpe=o((()=>{})),ype=o((()=>{})),TW,EW,DW,bpe=o((()=>{TW=[`17`,`18`,`62`],EW=`mgn`,DW=`bot`})),xpe=o((()=>{})),Spe=o((()=>{})),X=o((()=>{_ee(),Fn(),zn(),See(),Cee(),wee(),Tee(),Eee(),Wn(),Dee(),Oee(),kee(),Aee(),jee(),Yn(),Mee(),Nee(),Pee(),Fee(),Zn(),$n(),Iee(),wW(),vpe(),ype(),bpe(),xpe(),Spe()})),OW,kW,AW,jW,MW=o((()=>{OW=(e,t)=>e.devices.includes(t),kW=(e,t)=>!e.disableAds.locations.has(t.location)&&!e.disableAds.all,AW=e=>e.length===0||!e.split(`,`).some(e=>document.querySelector(e)!==null),jW=e=>e.pageSelector.length===0||document.querySelector(e.pageSelector)!==null})),NW,Cpe=o((()=>{NW=e=>{let t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset,left:t.left+window.pageXOffset,bottom:t.bottom+window.pageYOffset,right:t.right+window.pageXOffset,width:t.right-t.left,height:t.bottom-t.top}}})),PW,FW=o((()=>{PW=e=>{let t=e.clientWidth;if(getComputedStyle){let n=getComputedStyle(e,null);t-=parseFloat(n.paddingLeft||`0`)+parseFloat(n.paddingRight||`0`)}return t}})),IW,LW=o((()=>{IW=e=>{let t=e.offsetHeight,n=e.offsetWidth,r=e.getBoundingClientRect(),i=document.body,a=document.documentElement,o=window.pageYOffset||a.scrollTop||i.scrollTop,s=window.pageXOffset||a.scrollLeft||i.scrollLeft,c=a.clientTop||i.clientTop||0,l=a.clientLeft||i.clientLeft||0,u=Math.round(r.top+o-c),d=Math.round(r.left+s-l);return{top:u,left:d,bottom:u+t,right:d+n,width:n,height:t}}})),RW,zW,wpe=o((()=>{RW=(e,t=50)=>{let n=e.getBoundingClientRect(),r=window.innerHeight||document.documentElement.clientHeight,i=(n.bottom-r)/n.height*100;return i>=t},zW=(e,t=50)=>{let n=e.getBoundingClientRect(),r=(0-n.top)/n.height*100;return r>=t}})),BW,VW,HW,Tpe=o((()=>{BW=e=>{let t=e.match(/([a-zA-Z0-9._!#$%+^&*()[\]<>-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);return t?t[0]:``},VW=e=>e.replace(/\s/g,``),HW=e=>BW(VW(e.toLowerCase()))})),UW,WW,Epe=o((()=>{Wh(),Lt(),UW=e=>{let t={},n=Hh().get(e);if(n)try{let r=decodeURIComponent(n).replace(/\+/g,``);t=JSON.parse(r),M.event(`ExperimentOverridesUtil`,`getExperimentOverrides`,e,t)}catch(e){e instanceof URIError}return t},WW=(e,t)=>typeof e==typeof t})),GW,Dpe=o((()=>{GW=(e,t,n)=>n.indexOf(e)===t})),KW,Ope=o((()=>{KW=(e,t)=>e.reduce((e,n)=>{let r=[];return e.forEach(e=>{n.forEach(n=>{r.push(e+t+n)})}),r}).sort((e,t)=>e.split(`*`).length-t.split(`*`).length)})),qW,JW,YW,XW,ZW,QW,$W,eG,kpe=o((()=>{Ni(),qW=`Facebook`,JW=`Instagram`,YW=`Pinterest`,XW=new Map([[qW,{ios:`com.facebook.Facebook`,android:`com.facebook.katana`}],[YW,{ios:`pinterest`,android:`com.pinterest`}],[JW,{ios:`com.burbn.instagram`,android:`com.instagram.android`}]]),ZW=()=>window.navigator.userAgent.includes(`[Pinterest/iOS]`)||window.navigator.userAgent.includes(`[Pinterest/Android]`),QW=()=>window.navigator.userAgent.includes(`FBAN`)||window.navigator.userAgent.includes(`FBAV`),$W=()=>window.navigator.userAgent.includes(`Instagram`),eG=(e,t)=>{let n=QW()?qW:$W()?JW:ZW()?YW:``,r=XW.get(n);if(r){let i=Oi()?r.ios:ki()?r.android:``;return i?{bundle:i,name:n,domain:e,content:t.content}:void 0}}})),tG,nG=o((()=>{Wt(),tG=Ut(()=>{let e=navigator.userAgent,t=/Tablet|iPad|Playbook|Nook|webOS|Kindle|Android (?!.*Mobile).*Safari|CrOS/i.test(e),n=/Mobi|iP(hone|od)|Opera Mini/i.test(e);return n&&!t})})),rG,iG=o((()=>{rG=()=>{let e=navigator.userAgent,t=/Tablet|iPad|Playbook|Nook|webOS|Kindle|Android (?!.*Mobile).*Safari/i.test(e)||!/iPhone/i.test(e)&&/Mac/i.test(e)&&(navigator.maxTouchPoints>0||`ontouchstart`in window);return t}})),aG,Ape=o((()=>{Di(),nG(),iG(),aG=()=>tG()?`phone`:rG()?`tablet`:Ei()?`desktop`:`other`})),oG,sG=o((()=>{oG=e=>{let t=e.getBoundingClientRect(),n=window.innerHeight;return t.bottom<0?-Math.ceil(Math.abs(t.bottom)/n):t.top>n?Math.ceil((t.top-n)/n):0}})),cG,lG,uG,dG,jpe=o((()=>{X(),nG(),cG=[50,60,70,80],lG=e=>{let t=tG()&&(e==null?void 0:e.location)===F.Content;return t&&(e==null?void 0:e.refreshCount)===1?60:80},uG=e=>(e==null?void 0:e.refreshCount)>0?lG(e):e!=null&&e.viewability?Math.min(Math.floor((e==null?void 0:e.viewability)*100/10)*10,80):0,dG=e=>cG.includes(e)?e:0})),fG,pG,mG,hG,gG=o((()=>{xn(),fG=e=>{let t=document.createElement(`a`);return t.href=e,t.hostname},pG=e=>{let t=e.split(`.`),n=t.length;return n>2&&(e=t[n-2]+`.`+t[n-1],(t[n-2].length===2||t[n-2].length===3)&&t[n-1].length===2&&(e=t[n-3]+`.`+e)),e},mG=()=>{if(document.referrer&&document.referrer.length){let e=fG(document.referrer),t=pG(e),n=pG(window.location.hostname);if(t!==n)return e}},hG=e=>{let t=mG();return N(t,e)}})),_G,vG=o((()=>{_G=()=>{let e=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),t=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);return{width:e,height:t}}})),yG=o((()=>{})),bG,xG=o((()=>{bG=e=>e.id?`id:${e.id}`:e.classList&&e.classList.value?`class:${e.classList.value.split(` `).join(`.`)}`:`node:${e.nodeName.toLowerCase()}`})),SG,CG,Mpe=o((()=>{SG=`div #comments, section .comments`,CG=(e,t=SG)=>{let n=e.querySelector(t);return n?e.offsetHeight-n.offsetHeight:e.offsetHeight}})),wG,TG,EG,DG,OG,Npe=o((()=>{wG=(e=document)=>{let t=e===document?document.body:e;return t.getBoundingClientRect().top},TG=e=>e.includes(`,`)?e.split(`,`):[e],EG=(e=document)=>{let t=e.querySelectorAll(`article`);if(t.length===0)return null;let n=Array.from(t).reduce((e,t)=>t.offsetHeight>e.offsetHeight?t:e);return n&&n.offsetHeight>window.innerHeight*1.5?n:null},DG=(e,t,n=document)=>{let r=EG(n),i=r?[r]:[],a=[];e.forEach(e=>{let r=Array.from(n.querySelectorAll(e.elementSelector)).slice(0,e.skip);TG(e.elementSelector).forEach(o=>{let s=n.querySelectorAll(o);for(let n=0;n<s.length;n++){let o=s[n];if(t.map.some(({el:e})=>e.isEqualNode(o)))continue;let c=o&&o.parentElement;c&&c!==document.body?i.push(c):i.push(o),r.indexOf(o)===-1&&a.push({dynamicAd:e,element:o})}})});let o=wG(n),s=a.sort((e,t)=>e.element.getBoundingClientRect().top-o-(t.element.getBoundingClientRect().top-o));return[i,s]},OG=(e,t,n=document)=>{let[r,i]=DG(e,t,n);if(r.length===0)throw Error(`No Main Content Elements Found`);let a=Array.from(r).reduce((e,t)=>t.offsetHeight>e.offsetHeight?t:e)||document.body;return[a,i]}})),kG,Ppe=o((()=>{kG=()=>{var e;let t=window.navigator.userAgent,n=((e=window.navigator.userAgentData)==null?void 0:e.platform)||window.navigator.platform||``,r=[`macOS`,`Macintosh`,`MacIntel`,`MacPPC`,`Mac68K`],i=[`Win32`,`Win64`,`Windows`,`WinCE`],a=[`iPhone`,`iPad`,`iPod`];return r.includes(n)?`macOS`:a.includes(n)?`iOS`:i.includes(n)?`windows`:/Android/.test(t)?`android`:/Linux/.test(n)?`linux`:`other`}})),AG,jG,Fpe=o((()=>{Rm(),AG=e=>{let t=0;for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);t=(t<<5)-t+r&4294967295}let n=Math.abs(t).toString(16).padStart(8,`0`),r=(n+n+n+n).slice(0,32);return[r.slice(0,8),r.slice(8,12),`4`+r.slice(13,16),(parseInt(r.slice(16,18),16)&63|128).toString(16)+r.slice(18,20),r.slice(20,32)].join(`-`)},jG=e=>{try{let t=U.readExternalLocalStorage(`_pubcid`);e&&(e=AG(e));let n=e||t;return typeof n==`string`?{source:`uuid.raptive-sync.net`,uids:[{id:n,atype:1}]}:void 0}catch(e){return}}})),MG,Ipe=o((()=>{Tr(),MG=e=>{let{source:t,identifierType:n}=e;switch(n){case`truedata`:return t.includes(`${I.PII_SOURCE.PREFIXES.IDG}${I.PII_SOURCE.VALUES.TD}`);case`mediawallah`:return t.includes(`${I.PII_SOURCE.PREFIXES.IDG}${I.PII_SOURCE.VALUES.MW}`);default:return t.includes(I.PII_SOURCE.PREFIXES.IDG)}}})),NG,PG,Lpe=o((()=>{NG=e=>{let t=document.createElement(`link`);t.rel=`stylesheet`,t.type=`text/css`,t.href=e,document.head.appendChild(t)},PG=(e,t,n)=>{let r=document.createElement(`link`);r.rel=t,r.href=e,n&&n.length&&n.forEach(e=>{r.setAttribute(e.name,e.value)}),document.head.appendChild(r)}})),FG,IG,LG,RG,zG,Rpe=o((()=>{FG=[`Refresh`,`PD`,`Source`,`Browser`,`Topic`,`MCMP`,`Sens`],IG=(e,t,n=!1)=>{t.addToQueue(()=>{let r=t.getConfig(`ix`)||{firstPartyData:{}},i={...r.firstPartyData,...e},a={};for(let e in FG.forEach(e=>{e in i&&(a[e]=i[e])}),i)FG.includes(e)||(a[e]=i[e]);r.firstPartyData=a,n&&delete r.firstPartyData.Refresh,t.setConfig({ix:r},!1)})},LG=(e,t)=>{t.addToQueue(()=>{let n=t.getConfig(`ix`)||{};n.largeFormatSizes=e,t.setConfig({ix:n},!1)})},RG=e=>{let t={google:`google`,facebook:`facebook`,instagram:`instagram`,pinterest:`pinterest`},n=e.split(`.`).filter(e=>t[e])[0];return n||`other`},zG=e=>e?RG(e):`direct`})),BG,zpe=o((()=>{BG=({event:e,ignoreOtherCompanyIds:t=!1})=>{let n=new Set([-1,0,1,199612376,2143809321]),r=new Set([4455444655,4460609902,4463579729,4464180925,4466143841,4550726766,4623743690,4623743882,4634020290,4642901988,4697115760,4801442281,4802163255,4805985973,4807636548,4867316569]),i=!e.campaignId||n.has(e.campaignId),a=!e.companyIds||e.companyIds&&!e.companyIds.some(e=>r.has(e));return t?i:i&&a}})),VG,HG=o((()=>{VG=()=>{let e=`python,apis,googleweblight,spider,crawler,curl,wget,ia_archiver,insights,baidu,bot,monitor,scraper,A6-Indexer,addthis,admantx,agentslug,alexa,anderspink,apache-httpclient,apachebench,apis-google,appengine-google,ask jeeves,asynchttpclient,awe.sm,baidu,barkrowler,biglotron,bingpreview,brandverify,bubing,butterfly,buzztalk,cf-uc,chatgpt,check_http,cloudflare,cmradar/0.1,coldfusion,comodo ssl checker,convera,copypants,crowsnest,curl,dap/nethttp,daumoa,deepseek,deepseekbot,developers.google.com/+/web/snippet/,digitalpersona fingerprint software,drupact,duckduck,elb-healthchecker,embedly,eoaagent,europarchive,eventmachine httpclient,evrinid,exaleadcloudview,ezooms,ez publish,facebookexternalhit,feedburner,feedfetcher-google,findlink,findthatfile,flipboardproxy,garlik,genieo,getprismatic.com,ghost,gigablast,go http package,google( page speed insights| web preview|google-site-verification|-structured-data-testing-tool|-structureddatatestingtool),gpt,gptbot,hatena,headless,heritrix,htmlparser,http(_request2|client|s|unit),httrack,hubspot,ichiro,icoreservice,idmarch,in(agist|sieve|stapaper),ips-agent,jack,jakarta commons,java,jetslide,jobseeker,js-kit,kimengi,knows.is,kraken,laconica,libwww,lighthouse,linode,lipperhey,longurl,ltx71,lwp-trivial,mappydata,mastodon,mediapartners-google,megaindex.ru,metauri,mfe_expand,mixnode,mon(tastic|tools),moreover,mrchrome,nberta,net(craft|researchserver|state|vibes),newrelicpinger,newspaper,newsme,ning,nightmare,nmap,nutch,online-domain-tools,openai,paessler,page(peek|sinventory|thing),panopta,peerindex,phantomjs,pingdom,plukkie,proximic,pu_in,publiclibraryarchive.org,python-(httplib2|requests|urllib),quanti,queryseeker,quicklook,qwanti,re-animator,readability,rebelmouse,relateiq,riddler,rssmicro,ruby,scrapy,seo-audit,seodiver,seokicks,shopwiki,shortlinktranslate,siege,sistrix,site24x7,siteexplorer,skypeuripreview,slack,slurp,socialrank,sogou,spinn3r,squider,statuscake,stripe,summify,teeraid,teoma,test certificate info,tineye,traackr,tweetedtimes,twikle,twitjobsearch,twitmunin,twurly,typhoeus,unwindfetch,uptim(e|ia),uptm.io,vagabondo,vb project,vigil,vkshare,wappalyzer,watchsumo,webceo,webdatascout,webmon,webscout,wesee,wget,whatsapp,whatweb,wikido,wordpress,wormly,wotbox,xenu link sleuth,xing-contenttabreceiver,yandex,yanga,yeti,yff35,yourls,zelist.ro,zibb,^Mozilla/5\\.0$,Viv/2`.split(`,`),t=new RegExp(e.join(`|`),`i`),n=window.navigator.userAgent.toLowerCase();return t.test(n)}})),UG,Bpe=o((()=>{E(),UG=class{constructor(){T(this,`runTests`,()=>{let e=!1;if(window&&document){let t=[`webdriver`in window,`_Selenium_IDE_Recorder`in window,`callSelenium`in window,`_selenium`in window,`__webdriver_script_fn`in document,`__driver_evaluate`in document,`__webdriver_evaluate`in document,`__selenium_evaluate`in document,`__fxdriver_evaluate`in document,`__driver_unwrapped`in document,`__webdriver_unwrapped`in document,`__selenium_unwrapped`in document,`__fxdriver_unwrapped`in document,`__webdriver_script_func`in document,document.documentElement.getAttribute(`selenium`)!==null,document.documentElement.getAttribute(`webdriver`)!==null,document.documentElement.getAttribute(`driver`)!==null];e=t.some(e=>e)}return e})}isSelenium(){return this.runTests()}}})),WG,GG,KG,qG,JG,YG,XG,Vpe=o((()=>{vG(),HG(),Bpe(),WG=()=>{if(navigator&&navigator.webdriver)return`wdv`},GG=()=>{if(navigator&&navigator.hardwareConcurrency>32)return`hwv`},KG=()=>{if(navigator&&navigator.userAgent&&VG())return`uav`},qG=()=>{let e=_G();if(e.width>5e3||e.height>5e3)return`vpv`},JG=()=>{let e=document.createElement(`canvas`),t=e.getContext&&e.getContext(`webgl`),n=t&&t.getExtension&&t.getExtension(`WEBGL_debug_renderer_info`);if(n&&n.UNMASKED_RENDERER_WEBGL){let e=t&&t.getParameter(n.UNMASKED_RENDERER_WEBGL);if(e===`Google SwiftShader`)return`wglv`}},YG=()=>{let e=new UG;if(e.isSelenium())return`selenium`},XG=()=>{let e=[qG(),WG(),KG(),GG(),JG(),YG()].filter(e=>!!e);return e.length?e:void 0}})),ZG,Hpe=o((()=>{Rm(),ZG=()=>{let e=0;try{let t=U.readInternalLocalStorage(`adthrive_fpv`);if(t&&(e=Date.now()-Date.parse(t)),!t||e>864e5)return!0}catch(e){}return!1}})),QG,$G=o((()=>{QG=e=>!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)})),eK,Upe=o((()=>{$G(),eK=e=>!QG(e)})),tK,Wpe=o((()=>{tK=e=>e.indexOf(`hbs-q`)===0})),nK,rK,iK,aK,Gpe=o((()=>{X(),nK=(e,t)=>{let n=e.adDensityEnabled,r=e.adDensityLayout.pageOverrides.find(e=>{let n=!!document.querySelector(e.pageSelector)&&(e[t].onePerViewport||typeof e[t].adDensity==`number`);return n});return n?!r:!0},rK=e=>{var t;let n=(t=e.videoPlayers)==null||(t=t.partners)==null||(t=t.stickyOutstream)==null?void 0:t.blockedPageSelectors,r=n?!document.querySelector(n):!0;return r},iK=e=>{let t=e.adOptions.interstitialBlockedPageSelectors,n=t?!document.querySelector(t):!0;return n},aK=(e,t,n)=>{switch(t){case Xn.AdDensity:return nK(e,n);case Xn.StickyOutstream:return rK(e);case Xn.Interstitial:return iK(e);default:return!0}}})),oK,Kpe=o((()=>{oK=(e,t)=>{if(e.length<=1)return 0;if(e.sort((e,t)=>e-t),t<=0)return e[0];if(t>=1)return e[e.length-1];let n=t*(e.length+1),r=Math.floor(n)-1,i=r+1,a=Number((n%1).toFixed(1));return n<1?e[0]:i>=e.length?e[r]:e[r]+a*(e[i]-e[r])}})),sK,qpe=o((()=>{sK=(e,t)=>{let n=n=>{try{let{origin:r,source:i}=n,a=JSON.parse(n.data),o=a&&a.message===t.message,s=r&&r.match(e);if(!s||!o)return;i.postMessage(JSON.stringify(t),r)}catch(e){return}};window.addEventListener(`message`,n)}})),cK,lK,uK,dK,Jpe=o((()=>{cK=(e,t)=>Math.floor(e*1e5).toString(t),lK=(e,t)=>parseInt(e,t)/1e5,uK=(e,t=33)=>{let n=Object.keys(e).reduce((n,r)=>{let i=e[r].map(e=>lK(e,t));return{...n,[r]:[...i]}},{});return n},dK=(e,t=33)=>{let n=Object.keys(e).reduce((n,r)=>{let i=e[r].map(e=>cK(e,t));return{...n,[r]:i}},{});return n}})),fK,Ype=o((()=>{fK=()=>new Promise(e=>{if(document.readyState===`complete`)return e();window.addEventListener(`load`,()=>e())})})),pK,Xpe=o((()=>{pK=(e,t)=>{e.length>=t&&e.splice(Math.floor(Math.random()*e.length),1)}})),mK,Zpe=o((()=>{mK=e=>e.split(`#`)[0]})),hK,Qpe,gK,_K,vK,yK,$pe=o((()=>{Rm(),Tr(),hK=e=>new TextEncoder().encode(e),Qpe=e=>new TextDecoder().decode(e),gK=async e=>{let t=hK(e);return crypto.subtle.importKey(`raw`,t.slice(0,16),{name:`AES-GCM`},!1,[`encrypt`,`decrypt`])},_K=e=>{e=e.replace(/-/g,`+`).replace(/_/g,`/`);let t=(4-e.length%4)%4;e+=`=`.repeat(t);let n=atob(e);return Uint8Array.from(n,e=>e.charCodeAt(0))},vK=async(e,t)=>{let n=await gK(t),r=_K(e),i=r.slice(0,12),a=r.slice(12),o=await crypto.subtle.decrypt({name:`AES-GCM`,iv:i},n,a);return JSON.parse(Qpe(o))},yK=async(e=!0)=>{try{let t=U.readInternalLocalStorage(I.IDENTITY_DATA.KEY);if(typeof t!=`object`)return null;if(t&&e)for(let e of Object.values(t)){if(!e.d)return null;typeof e.d==`string`&&(e.d=await vK(e.d,e.s))}return t}catch(e){return null}}})),bK,xK,eme=o((()=>{bK=e=>e!==void 0,xK=(e,t)=>!!(e&&typeof e==`object`&&t in e)})),SK,tme=o((()=>{SK=e=>{let t=window.location.href;return e.some(e=>{let n=new RegExp(e,`i`);return n.test(t)})}})),CK,wK,TK,nme=o((()=>{Lt(),CK=e=>e.length===1,wK=e=>{let t=e.reduce((e,t)=>t.weight?t.weight+e:e,0),n=e.length>0&&e.every(e=>{let t=e.value,n=e.weight;return!!(t!=null&&!(typeof t==`number`&&isNaN(t))&&n)});return n&&t===100},TK=(e,t)=>{if(!e)return!1;let n=!!e.enabled,r=e.dateStart==null||Date.now()>=e.dateStart,i=e.dateEnd==null||Date.now()<=e.dateEnd,a=e.selector===null||e.selector!==``&&!!document.querySelector(e.selector),o=e.platform===`mobile`&&t===`mobile`,s=e.platform===`desktop`&&t===`desktop`,c=e.platform===null||e.platform===`all`||o||s,l=e.experimentType===`bernoulliTrial`?CK(e.variants):wK(e.variants);return l||M.error(`SiteTest`,`validateSiteExperiment`,`experiment presented invalid choices for key:`,e.key,e.variants),n&&r&&i&&a&&c&&l}})),EK,DK,rme=o((()=>{EK=[`siteId`,`siteName`,`adOptions`,`breakpoints`,`adUnits`],DK=(e,t=EK)=>{if(!e)return window.adthriveCLS&&(window.adthriveCLS.disabled=!0),!1;for(let n=0;n<t.length;n++)if(!e[t[n]])return window.adthriveCLS&&(window.adthriveCLS.disabled=!0),!1;return!0}})),OK,kK,AK,ime=o((()=>{E(),OK=class{constructor(){T(this,`_timeOrigin`,void 0),this._timeOrigin=0}resetTimeOrigin(){var e;this._timeOrigin=(e=window.performance)==null?void 0:e.now()}now(){try{var e;return Math.round(((e=window.performance)==null?void 0:e.now())-this._timeOrigin)}catch(e){return 0}}},window.adthrive.windowPerformance=window.adthrive.windowPerformance||new OK,kK=window.adthrive.windowPerformance,AK=kK.now.bind(kK)})),ame=o((()=>{})),jK,ome=o((()=>{jK=e=>`isAmazon`in e||`amzniid`in e||`amzniid_sp`in e})),MK,NK,sme=o((()=>{MK=()=>`xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx`.replace(/[xy]/g,e=>{let t=Math.random()*16|0,n=e===`x`?t:t&3|8;return n.toString(16)}),NK=()=>{var e,t,n;return(e=(t=window.crypto)==null||(n=t.randomUUID)==null?void 0:n.call(t))==null?MK():e}})),Z=o((()=>{dn(),dee(),fee(),pee(),vn(),bn(),xn(),mee(),hee(),gee(),MW(),Cpe(),FW(),LW(),wpe(),Tpe(),Epe(),Dpe(),Ope(),kpe(),Ape(),sG(),jpe(),Vs(),mg(),gG(),vG(),yG(),xG(),mg(),Mpe(),Npe(),Ppe(),Fpe(),gG(),yG(),vG(),Km(),Ipe(),na(),Lpe(),Rpe(),zpe(),Vpe(),Di(),Hpe(),Upe(),Wpe(),nG(),Gpe(),iG(),HG(),$G(),Ni(),Kpe(),qpe(),Jpe(),km(),Ype(),Wh(),ur(),$m(),fo(),Xpe(),Zpe(),Ta(),$pe(),ei(),GS(),eme(),tme(),Rf(),nme(),rme(),ime(),ame(),ome(),sme()})),PK,FK,Q,IK=o((()=>{Lt(),Z(),PK=(e,t,n,r,i,a)=>{let o=Math.round(a-i),s=[],c=[];s.push(`(`,n.map(()=>`%o`).join(`, `),`)`),c.push(...n),r!==void 0&&(s.push(` => %o`),c.push(r)),s.push(` %c(${o}ms)`),c.push(`color: #999;`)},FK=(e,t,n)=>{let r=n.get===void 0?n.value:n.get;return function(...n){try{let i=AK(),a=r.apply(this,n);if(a instanceof Promise)return a.then(r=>{let a=AK();return PK(e,t,n,r,i,a),Promise.resolve(r)}).catch(n=>{throw n.logged||(M.error(e,t,n),n.logged=!0),n});{let r=AK();return PK(e,t,n,a,i,r),a}}catch(n){throw n.logged||(M.error(e,t,n),n.logged=!0),n}}},Q=(e,t=!1)=>n=>{let r=Object.getOwnPropertyNames(n.prototype),i=r.filter(e=>t||e.indexOf(`_`)!==0).map(e=>[e,Object.getOwnPropertyDescriptor(n.prototype,e)]);for(let[t,r]of i)r!==void 0&&typeof r.value==`function`?n.prototype[t]=FK(e,t,r):r!==void 0&&r.get!==void 0&&typeof r.get==`function`&&Object.defineProperty(n.prototype,t,{...r,get:FK(e,t,r)})}})),LK,RK,zK,BK,VK,HK,UK,WK,GK,KK,cme=o((()=>{Z(),LK=e=>{let t=Error(e);return t.source=`ulid`,t},RK=`0123456789ABCDEFGHJKMNPQRSTVWXYZ`,zK=32,BK=2**48-1,VK=10,HK=16,UK=e=>{let t=Math.floor(e()*zK);return t===zK&&(t=zK-1),RK.charAt(t)},WK=(e,t)=>{if(isNaN(e))throw Error(`${e} must be a number`);if(e>BK)throw LK(`cannot encode time greater than ${BK}`);let n,r=``;for(;t>0;t--)n=e%zK,r=RK.charAt(n)+r,e=(e-n)/zK;return r},GK=(e,t)=>{let n=``;for(;e>0;e--)n=UK(t)+n;return n},KK=()=>WK(Date.now(),VK)+GK(HK,()=>lr())})),qK,JK=o((()=>{qK=e=>new Promise(t=>setTimeout(t,e))})),YK,XK,ZK=o((()=>{JK(),YK=async({condition:e,delay:t=500,maxAttempts:n=10,executedAttempts:r=0})=>{if(!e()){if(r>=n)throw Error(`Max waitFor attempts reached without resolution`);return await qK(t),await YK({condition:e,delay:t,maxAttempts:n,executedAttempts:r+1})}},XK=e=>{let t=!1,n=async()=>{if(!t){try{await YK(e)}catch(e){}t=!0}};return n}})),$=o((()=>{Rt(),lee(),uee(),Ht(),IK(),th(),Xm(),cme(),JK(),ZK()})),QK,lme=o((()=>{w(),Lt(),$h(),j(),E(),At(),O(),QK=class{constructor(e){T(this,`_commands`,void 0),this._commands=e.cmd||[]}init(){if(this._commands.length>0){for(let e of this._commands){let t=this._isGamMethod(e.toString());t?this._addToGamQueue(e):this._call(e)}this._commands=[]}}push(e){if(this._commands.length>0)this._commands.push(e);else{let t=this._isGamMethod(e.toString());t?this._addToGamQueue(e):this._call(e)}}_call(e){try{e.call(void 0)}catch(e){M.error(`CommandQueue`,`_call`,`Error calling command`,e)}}_isGamMethod(e){return e&&(e.includes(`setTargeting(`)||e.includes(`setTargetingFlag(`)||e.includes(`getTargeting(`)||e.includes(`getTargetingMap(`)||e.includes(`googletag`)||e.includes(`pubads`))}_addToGamQueue(e){Zh.pushToQueue(()=>{this._call(e)})}},QK=D([C(),A(`design:paramtypes`,[Object]),kt(0,ot(`AdThrive`))],QK)})),$K,eq,tq,ume=o((()=>{w(),$h(),Ra(),$(),H(),j(),O(),tq=class extends V{constructor(e,t){super(),this._context=e,this._gam=t}init(){if(this._context.querystring.has(`ad_test`)){let e=this._context.querystring.get(`ad_test`);this._gam.setTargeting({key:`sec`,value:e.split(`,`).map(e=>`test${e}`)})}}},tq=D([Q(`AdTestComponent`),S(),A(`design:paramtypes`,[typeof($K=L!==void 0&&L)==`function`?$K:Object,typeof(eq=Zh!==void 0&&Zh)==`function`?eq:Object])],tq)})),dme=o((()=>{ume()})),nq,fme=o((()=>{Lt(),nq=e=>{let t=document.body,n=`adthrive-device-${e}`;if(!t.classList.contains(n))try{t.classList.add(n)}catch(e){M.error(`BodyDeviceClassComponent`,`init`,{message:e.message});let t=`classList`in document.createElement(`_`);M.error(`BodyDeviceClassComponent`,`init.support`,{support:t})}}})),rq,iq,pme=o((()=>{w(),Ra(),IK(),fme(),H(),j(),O(),iq=class extends V{constructor(e){super(),this._context=e}init(){nq(this._context.device)}},iq=D([Q(`BodyDeviceClassComponent`),S(),A(`design:paramtypes`,[typeof(rq=L!==void 0&&L)==`function`?rq:Object])],iq)})),mme=o((()=>{pme()})),aq,hme=o((()=>{w(),Ui(),E(),O(),aq=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!0)}init(){this._key=`BrandMetrics`,this._lookup=`BMETRICS`}},aq=D([C()],aq)})),oq,sq,cq,lq,gme=o((()=>{w(),$(),H(),hme(),$h(),_I(),Z(),j(),E(),O(),lq=class extends V{constructor(e,t,n){super(),this._brandMetricsExperiment=e,this._gam=t,this._prebidAuctionManager=n,T(this,`_url`,`https://cdn.brandmetrics.com/tag/aa466d868b2742ffa2cc31bb6341dc12/cafemedia.js`)}init(){this._prebidAuctionManager.bidsRequested.once(()=>{this._load()})}get enabled(){return this._brandMetricsExperiment.result}_load(){ta(this._url).then(()=>this._monitorSurvey()).catch(()=>{})}_monitorSurvey(){window._brandmetrics=window._brandmetrics||[],window._brandmetrics.push({cmd:`_querySurvey`,val:{callback:(e,t)=>{e&&t&&t.measurementId&&this._gam.setTargeting({key:`bms`,value:[t.measurementId.toString()]})}}})}},lq=D([Q(`BrandMetrics`),S(),A(`design:paramtypes`,[typeof(oq=aq!==void 0&&aq)==`function`?oq:Object,typeof(sq=Zh!==void 0&&Zh)==`function`?sq:Object,typeof(cq=gI!==void 0&&gI)==`function`?cq:Object])],lq)})),_me=o((()=>{gme()})),uq,vme=o((()=>{w(),Ui(),Z(),E(),O(),uq=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`TopicsAPI`,this._lookup=`TPCAPI`}isEnabled(){return super.isEnabled()&&fn()}},uq=D([C()],uq)})),dq,fq,pq,mq,hq,gq,yme=o((()=>{w(),$h(),B(),Ra(),vme(),$(),rU(),H(),j(),E(),O(),gq=class extends V{constructor(e,t,n,r,i){super(),this._config=e,this._context=t,this._gam=n,this._browsingTopicsAPIExperiment=r,this._browsingTopicsAPIEventBus=i,T(this,`_topics`,[]),T(this,`_topicsUrl`,`https://ads.adthrive.com/api/v2/topics`)}get enabled(){return!this._config.gdpr.enabled&&!this._config.ccpa.userOptedOut&&this._context.browsingTopicsSupported&&this._browsingTopicsAPIExperiment.result}get topics(){return this._topics}async start(){let e=await this.fetchTopics(),t=e.map(e=>`${e.id}`);t.length>0&&this._gam.setTargetingFlag(`topicapi`,t),this._topics=e,this._context.browsingTopics=e,this._browsingTopicsAPIEventBus.topicsReceived.emit(e)}async fetchTopics(){try{var e;let t=await window.fetch(`${this._topicsUrl}?ts=${Date.now()}`,{browsingTopics:!0}),n=await t.json(),r=(e=n.topics)==null?[]:e;return r}catch(e){return[]}}async pollForTopics(){let e=await this.fetchTopics();return e.length===0?(await qK(15e3),this.pollForTopics()):e}},gq=D([Q(`BrowsingTopicsAPIComponent`),S(),A(`design:paramtypes`,[typeof(dq=z!==void 0&&z)==`function`?dq:Object,typeof(fq=L!==void 0&&L)==`function`?fq:Object,typeof(pq=Zh!==void 0&&Zh)==`function`?pq:Object,typeof(mq=uq!==void 0&&uq)==`function`?mq:Object,typeof(hq=gr!==void 0&&gr)==`function`?hq:Object])],gq)})),bme=o((()=>{yme()})),xme=o((()=>{})),_q,Sme=o((()=>{_q=()=>{var e,t;let n=(e=(t=window.location.pathname)==null?void 0:t.toLowerCase())==null?``:e,r=[`/privacy`,`/policy`,`/terms`,`/policies`,`/legal`,`/disclaimer`,`/disclosure`];return r.some(e=>n.includes(e))}})),vq,yq,bq,xq,Sq,Cq,Cme=o((()=>{w(),$h(),B(),Ra(),rU(),$(),H(),Z(),xme(),Rm(),Ta(),Sme(),j(),E(),O(),Cq=class extends V{constructor(e,t,n,r,i){super(),this._config=e,this._consentEventBus=t,this._context=n,this._spaEventBus=r,this._gam=i,T(this,`_didSetupListeners`,!1),T(this,`_deviceAccess`,!1),T(this,`_deletionQueue`,[]),T(this,`ccpaRequired`,this._config.ccpa.required),T(this,`privacyString`,this._config.ccpa.privacyString),T(this,`ccpaNotApplicable`,this._config.ccpa.ccpaNotApplicable),T(this,`ccpaOptIn`,this._config.ccpa.ccpaOptIn),T(this,`ccpaOptOut`,this._config.ccpa.ccpaOptOut),T(this,`ccpaOptOutText`,this._config.ccpa.optOutText),T(this,`ccpaOptInText`,this._config.ccpa.optInText),T(this,`usCmpRequired`,this._config.ccpa.usCmpRequired),T(this,`gpcEnabled`,!!this._config.ccpa.gpcEnabled),T(this,`gpcUpdated`,!1),T(this,`globalPrivacyControl`,window.navigator.globalPrivacyControl),T(this,`ccpaLinkText`,this.privacyString===``||this.privacyString===this.ccpaOptIn?this.ccpaOptOutText:this.ccpaOptInText),T(this,`modal`,void 0),T(this,`modalContent`,void 0),T(this,`ccpaATag`,void 0),T(this,`ccpaOptOutDiv`,void 0),T(this,`ccpaOptOutDivId`,`adthrive-ccpa-link`)}init(){if(window.__uspapi=this.uspapi.bind(this),this.ccpaRequired){this._createModalElements(),this._addLocatorFrame(),window.__uspapi(`registerDeletion`,1,this._deleteData.bind(this)),this.setGpcString();let e=this.gpcEnabled||this._config.ccpa.privacyString===this.ccpaOptOut?this.ccpaOptOut:this.ccpaOptIn;this.setPrivacyString(e),this._setDeviceAccess(),this._setupListeners();let t=document.querySelector(`#${this.ccpaOptOutDivId}`),n=this._shouldDisplayOptOutFooterLink();!t&&!this._config.act25.required&&(this.addOptOutElements(n),this.injectFooter());let r=xa(`health-directed-treatment`);this._context.country===`US`&&r&&this._gam.setTargetingFlag(`hmt`,[Ca(this._context.region)?`1`:`0`])}else this.setPrivacyString(this.ccpaNotApplicable);this.usCmpRequired&&this._consentEventBus.usCmpConsentCaptured.on(e=>{this.setPrivacyString(e?this.ccpaOptIn:this.ccpaOptOut),this._setDeviceAccess()},{handleEventsAlreadyEmitted:!0})}_createModalElements(){this.modal=yn(`div`,`adthrive-ccpa-modal`,`adthrive-ccpa-modal`),this.modalContent=yn(`div`,`adthrive-ccpa-modal-content`,`adthrive-ccpa-modal-content`),this.ccpaATag=yn(`a`,`ccpaTag`,void 0,this.ccpaLinkText,`/`)}setPrivacyString(e,t=!1){let n=this.ccpaRequired&&this.privacyString===this.ccpaNotApplicable,r=!this.ccpaRequired&&this.privacyString!==this.ccpaNotApplicable;(e||t===!0||n||r||this.gpcUpdated)&&(this._setPrivacyCookie(e),this.privacyString=e)}_setPrivacyCookie(e){let t=new Date(2147483647*1e3).toUTCString();document.cookie=`usprivacy=${e};path=/;expires=${t}`}setGpcString(){(this.gpcEnabled===null||this.gpcEnabled===!1)&&this.globalPrivacyControl?(U.setInternalLocalStorage(`adthrive_gpc`,`${this.globalPrivacyControl}`),this.gpcEnabled=!!`${this.globalPrivacyControl}`,this.gpcUpdated=!0):this.gpcEnabled===!0&&!this.globalPrivacyControl&&(U.deleteLocalStorage(`adthrive_gpc`),this.gpcEnabled=this.globalPrivacyControl,this.gpcUpdated=!0)}uspapi(e,t,n){switch(e){case`performDeletion`:this._deletionQueue.forEach(e=>e());break;case`registerDeletion`:this._deletionQueue.push(n);break;case`getUSPData`:let r={command:e,version:t,uspString:U.readExternalCookie(`usprivacy`)};return n(r,!0);default:return null}}_addLocatorFrame(){if(document.getElementById(`__uspapiLocator`)===null){let e=document.createElement(`iframe`);e.style.display=`none`,e.id=`__uspapiLocator`,e.name=`__uspapiLocator`,document.body.appendChild(e)}}_setCCPAEventListener(e,t,n,r){n&&this.modal?n.addEventListener(`click`,(()=>{e&&this.optUserInOrOut(),t&&this.modal&&(this.modal.style.display=`none`)}).bind(this)):r&&this.modal&&r.addEventListener(`click`,(e=>{e.target==this.modal&&(this.modal.style.display=`none`)}).bind(this))}optUserInOrOut(){this.privacyString===this.ccpaOptIn&&this.modal&&this.ccpaATag?(this.setPrivacyString(this.ccpaOptOut,!0),window.__uspapi(`performDeletion`,1),this.modal.style.display=`block`,this.ccpaATag.textContent=this.ccpaOptInText,this._config.ccpa.userOptedOut=!0):(this.setPrivacyString(this.ccpaOptIn,!0),this.ccpaATag&&(this.ccpaATag.textContent=this.ccpaOptOutText),this._config.ccpa.userOptedOut=!1),this._config.ccpa.consentChange.emit(this.privacyString),this._setDeviceAccess()}createCCPAModal(){if(!this.modal||!this.modalContent){M.error(`CCPAComponent`,`createCCPAModal`,`Attempt to access modal`);return}let e=document.body;e.append(this.modal),this.modal.append(this.modalContent),this._setCCPAEventListener(!1,!0,void 0,window);let t=yn(`div`,`adthrive-ccpa-modal-close-btn-container`,void 0,`<span>&#10005;</span>`);this.modalContent.append(t),this._setCCPAEventListener(!1,!0,t);let n=yn(`div`,`adthrive-ccpa-modal-title`,void 0,this._config.ccpa.optOutText);this.modalContent.append(n);let r=yn(`span`,`adthrive-ccpa-modal-language`,void 0,`You have chosen to opt-out of the sale or sharing of your information from this site and any of its affiliates. To opt back in please click the "Customize my ad experience" link.<br>
    <br>This site collects information through the use of cookies and other tracking tools. Cookies and these tools do not contain any information that personally identifies a user, but personal information that would be stored about you may be linked to the information stored in and obtained from them. This information would be used and shared for Analytics, Ad Serving, Interest Based Advertising, among other purposes.<br>
    <br>For more information please visit this site's Privacy Policy.`);this.modalContent.append(r)}_createModalLowerButtons(){if(!this.modalContent){M.error(`CCPAComponent`,`_createModalLowerButtons`,`Attempt to access modalContent`);return}let e=yn(`div`,void 0,`adthrive-ccpa-lower-buttons-container`);this.modalContent.append(e);let t=yn(`div`,`adthrive-ccpa-modal-cancel-btn`,`adthrive-ccpa-modal-btn`,`CANCEL`);e.append(t),this._setCCPAEventListener(!0,!0,t);let n=yn(`div`,`adthrive-ccpa-modal-continue-btn`,`adthrive-ccpa-modal-btn`,`CONTINUE`);e.append(n),this._setCCPAEventListener(!1,!0,n)}addOptOutElements(e=!0){if(!this.ccpaATag){M.error(`CCPAComponent`,`addOptOutElements`,`Attempt to access ccpaTag`);return}this.ccpaOptOutDiv=yn(`div`,this.ccpaOptOutDivId,`adthrive-ccpa-link`,`Information from your device can be used to personalize your ad experience. <br><br>`),this.ccpaOptOutDiv.style.display=e&&!this._config.usCMP.required?`block`:`none`,this.ccpaOptOutDiv.appendChild(this.ccpaATag),this._setCCPAEventListener(!0,!1,this.ccpaATag),document.body.appendChild(this.ccpaOptOutDiv),this.createCCPAModal(),this._createModalLowerButtons()}_shouldDisplayOptOutFooterLink(){return this._isHomeOrFPV()||_q()}_isHomeOrFPV(){return window.location.pathname===`/`||this._context.isFirstPageview}_setupListeners(){!this._didSetupListeners&&this._config.adOptions.spa&&(this._spaEventBus.routeChanged.once(()=>{this.init();let e=document.querySelector(`#${this.ccpaOptOutDivId}`),t=this._shouldDisplayOptOutFooterLink()?`block`:`none`;e&&(e.style.display=t)}),this._didSetupListeners=!0)}_deleteData(){}_setDeviceAccess(){this._deviceAccess=this.privacyString===this.ccpaOptIn}injectFooter(){this.ccpaOptOutDiv&&this._config.footer.elements.push({order:1,element:this.ccpaOptOutDiv})}},Cq=D([Q(`CCPAComponent`),S(),A(`design:paramtypes`,[typeof(vq=z!==void 0&&z)==`function`?vq:Object,typeof(yq=_r!==void 0&&_r)==`function`?yq:Object,typeof(bq=L!==void 0&&L)==`function`?bq:Object,typeof(xq=zr!==void 0&&zr)==`function`?xq:Object,typeof(Sq=Zh!==void 0&&Zh)==`function`?Sq:Object])],Cq)})),wq=o((()=>{Cme()})),Tq,Eq,Dq,Oq,kq,wme=o((()=>{H(),$h(),B(),Ra(),X(),$(),Z(),w(),ud(),j(),E(),O(),kq=class extends V{constructor(e,t,n,r){super(),this._config=e,this._gam=t,this._context=n,this._cls=r,T(this,`debug`,!1),this.debug=this._context.debug}_isInApp(){return $W()||QW()||ZW()}_getBrowserCharacter(e=!1){return this._isInApp()&&e?`a`:Zt()?`c`:$t()?`s`:Jt()?`f`:Yt()?`i`:qt()?`e`:`o`}_getOSAndBrowserValue(){let e=kG().slice(0,1).toLowerCase(),t=[`m`,`w`,`i`,`a`];if(!t.includes(e))return`o`;let n=new Set([`m`,`a`]),r=this._getBrowserCharacter(!n.has(e)),i=`${e}${r}`,a=new Set([`mc`,`ms`,`mf`,`wc`,`wi`,`we`,`wf`,`ws`,`ic`,`is`,`ia`,`io`,`ac`,`aa`,`ao`]);return a.has(i)?i:`o`}_getConfigTargeting(){let e=this._config,t=this._context,n=this.debug,r=this._getOSAndBrowserValue(),i=[...this._getConfigGoogleAdManagerTargeting(e.gam.targeting),{key:`abgroup`,value:e.abGroup.groups},{key:`mvab`,value:e.abGroup.multiGroups},{key:`pubab`,value:e.pubAbGroup.groups},{key:`idho_p`,value:e.idho.percentages},{key:`bucket`,value:n?`unsupported`:t.bucket},{key:`sens`,value:e.site.sensitiveCategories},{key:`domain`,value:t.domain},{key:`plugin`,value:t.plugin},{key:`hi_au`,value:e.adTypes.enabledMinified},{key:`vpwxvph`,value:`${window.innerWidth}x${window.innerHeight}`},{key:`ri`,value:t.ri},{key:`st`,value:t.salesThrottle},{key:`rsi`,value:t.rsi},{key:`pvk`,value:t.pageviewKey},{key:`sess`,value:t.sessionKey},{key:`branch`,value:t.branch},{key:`deployment`,value:n||t.invalidTraffic?`unsupported`:t.deployment},{key:`doba`,value:e.displayOpenBidding.bidders},{key:`gptv`,value:window.googletag.getVersion()},{key:`id_region`,value:e.locale.targetingValue},{key:`osb`,value:r}];return e.hbho.filteredBidders.length&&i.push({key:`hbho`,value:e.hbho.filteredBidders}),e.vbho.filteredBidders.length&&i.push({key:`vbho`,value:e.vbho.filteredBidders}),e.prebid.ayServerEnabled&&i.push({key:`enrch_grp`,value:`${e.audienceTargeting.ayEnrichmentGroup}`}),i}_getConfigGoogleAdManagerTargeting(e){let t=`verticals`,n=[];return e.forEach(e=>{e.key===t?n.push({key:t,value:this._fixGamVerticalsValue(e.value)}):n.push({key:e.key,value:e.value})}),n}_fixGamVerticalsValue(e){if(!Array.isArray(e))return this._fixGamVerticalsValue([e])[0];let t=new RegExp(/[";'\^=\(\)!<>\+\[\]#,\*~`]/,`g`);return e.map(e=>e.replace(t,``).replace(/&/g,`and`))}getConditionalTargeting(){let e=[],t=this._context,n=this._config.site,r=this._config.ccpa;return n.sensCategoriesOff.length&&e.push({key:`sens_off`,value:n.sensCategoriesOff}),t.connectionTargeting.length&&e.push({key:`connection`,value:t.connectionTargeting}),r.required&&e.push({key:`ccpaOptOut`,value:r.userOptedOut?`1`:`0`}),e}setConditionalFlagTargeting(){var e,t,n;let r=this._context,i=this._config,a=ln(),o=this._config.prebid.s2s.distributedBidders,s=i.floors.os,c=i.floors.browser,l=i.floors.country;if(this._gam.setTargetingFlag(`co`,[(e=l==null?this._context.country:l)==null?``:e]),this._gam.setTargetingFlag(`os`,[(t=s==null?kG():s)==null?``:t]),this._gam.setTargetingFlag(`br`,[(n=c==null?cn():c)==null?``:n]),`cookieDeprecationLabel`in navigator){var u;this._gam.setTargetingFlag(`cookdep`,[(u=this._config.fledge.cookieDeprecationLabel)==null?``:u])}if(r.invalidTraffic&&this._gam.setTargetingFlag(`bot`,r.invalidTraffic),r.adsMinLoadDuration&&this._gam.setTargetingFlag(`adsmnche`,r.adsMinLoadDuration),this._config.gdpr.enabled&&this._gam.setTargetingFlag(`gdpr`,[`1`]),this._config.locale.region&&this._gam.setTargetingFlag(`region`,[this._config.locale.region]),ln()!==null&&this._gam.setTargetingFlag(`brwsrv`,[`${a}`]),this._config.adOptions.pmp&&this._gam.setTargetingFlag(`pmp_elig`,[`1`]),Ei()&&this._config.adTypes.largeFormatsDesktop&&this._gam.setTargetingFlag(`lf_elig`,[`1`]),!Ei()&&this._config.adTypes.largeFormatsMobile&&this._gam.setTargetingFlag(`lf_elig`,[`1`]),this._cls&&(this._gam.setTargetingFlag(`clson`,[String(!!this._cls.injectedFromPlugin)]),this._gam.setTargetingFlag(`clsBranch`,[this._cls.branch||``]),this._gam.setTargetingFlag(`clsBucket`,[this._cls.bucket||``])),r.integration&&this._gam.setTargetingFlag(`integration`,[r.integration]),r.deliveryVersion&&this._gam.setTargetingFlag(`lmdv`,[r.deliveryVersion]),r.isWordPressLogin&&this._gam.setTargetingFlag(`wpadm`,[`1`]),this._config.trafficShaping.active&&this._gam.setTargetingFlag(`ts`,[this._config.trafficShaping.modelVersion]),o){let e=o.rpbsBidders.filter(e=>!Mn.includes(e)).map(e=>An[e]),t=o.ayBidders.filter(e=>!Mn.includes(e)).map(e=>An[e]);this._gam.setTargetingFlag(`db_r`,e,!0),this._gam.setTargetingFlag(`db_ay`,t,!0)}}init(){Zh.pushToQueue(()=>{this._gam.setTargeting([...this._getConfigTargeting(),...this.getConditionalTargeting()]),this.setConditionalFlagTargeting()})}},kq=D([Q(`ConfigTargetingComponent`),S(),A(`design:paramtypes`,[typeof(Tq=z!==void 0&&z)==`function`?Tq:Object,typeof(Eq=Zh!==void 0&&Zh)==`function`?Eq:Object,typeof(Dq=L!==void 0&&L)==`function`?Dq:Object,typeof(Oq=ld!==void 0&&ld)==`function`?Oq:Object])],kq)})),Tme=o((()=>{wme()})),Aq,jq,Mq,Eme=o((()=>{w(),$h(),$(),vh(),Z(),H(),Bh(),j(),O(),Mq=class extends V{constructor(e,t){super(),this._slots=e,this._gamEventBus=t}init(){this._gamEventBus.slotRenderEnded.on(e=>this.confirmedClickOverlay(e))}confirmedClickOverlay({event:e,slotId:t}){let n=this._slots.get(t);n&&Zh.pushToQueue(()=>{let{id:t,location:r,sequence:i,nref:a}=n.getTargetingMap(),o=this.confirmedClickStatus(this._slots.get(e.slot.getSlotElementId()));BG({event:e,ignoreOtherCompanyIds:!0})&&o&&M.event(`confirmedClickOverlay`,`status`,{id:t,location:r,sequence:i,nref:a,confirmedClick:o})})}confirmedClickStatus(e){let t=[`common_15click_overlay`,`common_15click_anchor`];try{let n=e==null?void 0:e.element.querySelectorAll(`iframe[id^=google_ads_iframe]`),r;return n&&(n==null?void 0:n.length)>0&&(r=n[0]),t.some(e=>{var t;return(r==null||(t=r.contentDocument)==null?void 0:t.getElementById(e))!=null})}catch(e){M.error(`ConfirmedClickComponent`,`confirmedClickStatus`,e)}return!1}},Mq=D([Q(`ConfirmedClicksComponent`),S(),A(`design:paramtypes`,[typeof(Aq=_h!==void 0&&_h)==`function`?Aq:Object,typeof(jq=zh!==void 0&&zh)==`function`?jq:Object])],Mq)})),Dme=o((()=>{Eme()})),Nq,Pq,Fq,Iq,Lq,Ome=o((()=>{w(),$h(),Ra(),$(),FS(),Z(),H(),Zn(),Bh(),Wr(),j(),E(),O(),Lq=class extends V{constructor(e,t,n,r){super(),this._context=e,this._gamEventBus=t,this._slotManager=n,this._slotManagerEventBus=r,T(this,`_device`,void 0),T(this,`_headerDeclared`,!1),T(this,`_sidebarDeclared`,!1),this._device=this._context.device}init(){let e=this._slotManager;if(this._device===`phone`||this._device===`tablet`){this._gamEventBus.slotRenderEnded.on(({event:t,slotId:n})=>{let r=e.getSlot(n);r&&this.isDeclaredRefreshCompliantSlot(r)&&BG({event:t})&&e.updateRefreshTimeout(n,24e4)});let t=this._slotManagerEventBus.added.on(e=>{let t=this._slotManager.getSlots(e);t.forEach(e=>{this.isDeclaredRefreshCompliantSlot(e)&&Zh.pushToQueue(()=>{e.setTargeting({key:`decref`,value:`240`})})})}),n=this._headerDeclared&&this._sidebarDeclared;n&&this._slotManagerEventBus.added.off(t)}}_isSidebarDeclaredRefreshCompliant(e){let t=e.location===F.Sidebar;return t&&(this._sidebarDeclared=!0),t}_isHeaderDeclaredRefreshCompliant(e){let t=e.location===F.Header&&e.sequence===2;return t&&(this._headerDeclared=!0),t}isDeclaredRefreshCompliantSlot(e){return this._isSidebarDeclaredRefreshCompliant(e)||this._isHeaderDeclaredRefreshCompliant(e)}},Lq=D([Q(`DeclaredRefreshComponent`),S(),A(`design:paramtypes`,[typeof(Nq=L!==void 0&&L)==`function`?Nq:Object,typeof(Pq=zh!==void 0&&zh)==`function`?Pq:Object,typeof(Fq=PS!==void 0&&PS)==`function`?Fq:Object,typeof(Iq=Ur!==void 0&&Ur)==`function`?Iq:Object])],Lq)})),kme=o((()=>{Ome()})),Rq,Ame=o((()=>{E(),Rq=class{constructor(){T(this,`_map`,[])}add(e,t,n,r=document){this._map.push({el:e,coords:t,dynamicAd:n,target:r})}get map(){return this._map}sort(){this._map.sort(({coords:e},{coords:t})=>e-t)}filterUsed(){this._map=this._map.filter(({dynamicAd:e})=>!e.used)}reset(){this._map=[]}}})),zq,Bq=o((()=>{w(),Ame(),O(),zq=class extends Rq{},zq=D([C()],zq)})),Vq,Hq,Uq=o((()=>{Vq=e=>e.split(`?`)[0],Hq=()=>window.location.origin+`/`===Vq(window.location.href)})),Wq,Gq,Kq,qq,jme=o((()=>{w(),$(),ii(),fU(),X(),lU(),ud(),j(),E(),At(),O(),qq=class extends oU{constructor(e,t,n,r){var i;super(),this._siteExperiments=e,this._pubabgroup=t,this._cls=n,T(this,`_choices`,[]),T(this,`_mappedChoices`,[]),T(this,`_result`,`control`),T(this,`_resultValidator`,e=>typeof e==`number`),T(this,`key`,Xn.AdDensity),T(this,`abgroup`,Xn.AdDensity),(i=r.siteAds)!=null&&i.siteExperiments?this.experimentConfig=new cU(r.siteAds).getSiteExperimentByKey(this.key):this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this._cls.siteExperimentsWeightedChoice&&this.key in this._cls.siteExperimentsWeightedChoice&&this._isValidResult(this._cls.siteExperimentsWeightedChoice[this.key])?(this._result=this._cls.siteExperimentsWeightedChoice[this.key],this.setExperimentTargeting()):this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._mappedChoices=this._mapChoices(),this._result=this.run(),this.setExperimentTargeting())}run(){if(!this.enabled)return M.error(`TargetAdDensitySiteExperiment`,`run`,`() => %o`,`No experiment config found. Defaulting to control.`),`control`;let e=new dr(this._mappedChoices).get();return this._isValidResult(e)?e:(M.error(`TargetAdDensitySiteExperiment`,`run`,`() => %o`,`Invalid result from experiment choices. Defaulting to control.`),`control`)}setExperimentTargeting(){if(!this.enabled||!this._isValidResult(this._result)){M.error(`TargetAdDensitySiteExperiment`,`setExperimentTargeting`,`() => %o`,`Experiment targeting requires an experiment config and valid result`);return}let e=this.experimentConfig,t=`${e.key.toLowerCase()}-${e.id}`,n=this._result===`control`?`control`:`${Math.round(this._result*100)}`;this._pubabgroup.set(t,n)}_mapChoices(){return this._choices.map(({weight:e,value:t})=>({weight:e,choice:typeof t==`number`?(t||0)/100:`control`}))}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],qq.prototype,`run`,null),qq=D([C(),A(`design:paramtypes`,[typeof(Wq=uU!==void 0&&uU)==`function`?Wq:Object,typeof(Gq=ri!==void 0&&ri)==`function`?Gq:Object,typeof(Kq=ld!==void 0&&ld)==`function`?Kq:Object,Object]),kt(3,ot(`AdThrive`))],qq)})),Jq,Yq=o((()=>{X(),Jq=(e,t,n,r=[],i,a,o=!1,s=!1)=>{if(i===F.Video_StickyOutstream&&s&&o)return null;let c=`<div id="${t}" class="adthrive-ad ${r.join(` `)}"></div>`;if(i===F.Video_StickyOutstream){let e=t.includes(`phone`)?`mobile`:`desktop`;c=`<div class="adthrive-sticky-outstream adthrive-sticky-outstream-${e}">`+c+`</div>`}return a&&a.length&&a.some(e=>e.element.id===t)||e.insertAdjacentHTML(n,c),document.getElementById(t)}})),Xq,Zq=o((()=>{vh(),Xq=({location:e,sequence:t,sticky:n,lazy:r,stickyOverlapSelector:i,special:a,auctionPriority:o},s,c,l,u)=>new gh(e,t,c,s,n,r,o,i,a,!0,l,u||``)})),Qq,$q=o((()=>{Qq=(e,t=document)=>t.querySelectorAll(e)})),eJ,tJ,nJ=o((()=>{eJ=e=>`adthrive-${e.location.replace(`_`,`-`).toLowerCase()}`,tJ=e=>`${eJ(e)}-${e.sequence}`})),rJ,Mme=o((()=>{jme(),X(),$n(),$(),Z(),Yq(),Zq(),$q(),nJ(),w(),al(),E(),rJ=class{constructor(e,t,n){this._adInjectionMap=e,this._context=t,this._cls=n,T(this,`_recipeCount`,0),T(this,`_mainContentHeight`,0),T(this,`_mainContentDiv`,null),T(this,`_totalAvailableElements`,[]),T(this,`_densityDevice`,Qn.Desktop),T(this,`_pubLog`,{onePerViewport:!1,targetDensity:0,targetDensityUnits:0,combinedMax:0}),T(this,`_densityMax`,.99),T(this,`_smallerIncrementAttempts`,0),T(this,`_absoluteMinimumSpacingByDevice`,250),T(this,`_usedAbsoluteMinimum`,!1),T(this,`_isAcAlwaysStickyEnabled`,!1),T(this,`locationMaxLazySequence`,new Map([[F.Recipe,5]])),this._isAcAlwaysStickyEnabled=il.isRolloutEnabled(`ac-always-sticky`)}inject(e,t=document){this._cls.targetDensityLog&&M.event(`BaseDynamicAdsInjector`,`_logDensityInfo`,this._cls.targetDensityLog),this._densityDevice=this._context.device===`desktop`?Qn.Desktop:Qn.Mobile,this._overrideDefaultAdDensitySettingsWithSiteExperiment();let n=this._config.targetDensity.enabled,r=e.filter(e=>n?e.location!==F.Content:e),i=e.filter(e=>n?e.location===F.Content:null),a=r.length?this._injectNonDensitySlots(r,t):[],o=i.length?this._injectDensitySlots(i,t):[];return[...a,...o]}_injectNonDensitySlots(e,t=document){let n=[];for(let r of e)this._insertNonDensityAds(r,n,t);return n}_insertNonDensityAds(e,t,n=document){let r=0,i=0,a=0;e.spacing>0&&(r=window.innerHeight*e.spacing,i=r);let o=this._repeatDynamicAds(e),s=Qq(e.elementSelector,n);e.skip;for(let c=e.skip;c<s.length&&!(a+1>o.length);c+=e.every){let l=s[c];if(r>0){let{bottom:e}=IW(l);if(e<=i)continue;i=e+r}let u=o[a],d=`${u.location}_${u.sequence}`;if(t.some(e=>e.name===d)){a+=1;continue}let f=this.getDynamicElementId(u),p=eJ(e),m=tJ(e),h=e.location===F.Sidebar&&e.sticky&&e.sequence&&e.sequence<=5?`adthrive-sticky-sidebar`:``,g=e.location===F.Recipe&&e.sticky?`adthrive-recipe-sticky-container`:``,_=[h,g,p,m,...e.classNames],v=this._cls.injectedSlots,y=Jq(l,f,e.position,_,e.location,v||[],this._config.video.collapsiblePlayerOnPage,this._isAcAlwaysStickyEnabled);if(y){let r=this._filterAdUnitSizes(u,y);r.length&&(t.push(Xq(u,y,r,n!==document,e.thirdPartyAdUnitName||``)),e.location===F.Recipe&&++this._recipeCount,a+=1),l=y}}}_injectDensitySlots(e,t=document){try{this._calculateMainContentHeightAndAllElements(e,t)}catch(e){return[]}let{onePerViewport:n,targetAll:r,targetDensityUnits:i,combinedMax:a,numberOfUnits:o}=this._getDensitySettings(e,t);return this._absoluteMinimumSpacingByDevice=n?window.innerHeight:this._absoluteMinimumSpacingByDevice,o?(this._adInjectionMap.filterUsed(),this._findElementsForAds(o,n,r,a,i,t),this._insertAds()):[]}_overrideDefaultAdDensitySettingsWithSiteExperiment(){let e=x.resolve(qq);if(!e.enabled)return;let t=e.result;typeof t==`number`&&(this._config.targetDensity.enabled=!0,this._config.targetDensity.settings[this._densityDevice].adDensity=t)}_getDensitySettings(e,t=document){let n=this._config.targetDensity.settings,r=this._determineOverrides(n.pageOverrides),i=r.length?r[0]:n[this._densityDevice],a=i.adDensity,o=i.onePerViewport,s=this._shouldTargetAllEligible(a),c=this._getTargetDensityUnits(a,s),l=this._getCombinedMax(e,t),u=Math.min(this._totalAvailableElements.length,c,...l>0?[l]:[]);return this._pubLog={onePerViewport:o,targetDensity:a,targetDensityUnits:c,combinedMax:l},{onePerViewport:o,targetAll:s,targetDensityUnits:c,combinedMax:l,numberOfUnits:u}}_determineOverrides(e){return e.filter(e=>{let t=Lf(e.pageSelector);return e.pageSelector===``||t.elements&&t.elements.length}).map(e=>e[this._densityDevice])}_shouldTargetAllEligible(e){return e===this._densityMax}_getTargetDensityUnits(e,t){return t?this._totalAvailableElements.length:Math.floor(e*this._mainContentHeight/(1-e)/this._getMinDivHeight())-this._recipeCount}_getMinDivHeight(e=F.Content){return this._config.clsOptimizedAds.getDivHeight(e,this._context.device)}_getCombinedMax(e,t=document){return N(e.filter(e=>{let n;try{n=t.querySelector(e.elementSelector)}catch(e){}return n}).map(e=>Number(e.max)+Number(e.lazyMaxDefaulted?0:e.lazyMax)).sort((e,t)=>t-e)[0],0)}_elementLargerThanMainContent(e){return e.offsetHeight>=this._mainContentHeight&&this._totalAvailableElements.length>1}_elementDisplayNone(e){let t=window.getComputedStyle(e,null).display;return t&&t===`none`||e.style.display===`none`}_isBelowMaxes(e,t){return this._adInjectionMap.map.length<e&&this._adInjectionMap.map.length<t}_findElementsForAds(e,t,n,r,i,a=document){M.event(`BaseDynamicAdsInjector`,`_logDensityInfo`,{onePerViewport:t,combinedMax:r,targetDensityUnits:i,targetDensityPercentage:this._pubLog.targetDensity,mainContentHeight:this._mainContentHeight,recipeCount:this._recipeCount,numberOfEls:this._totalAvailableElements.length});let o=e=>{for(let{dynamicAd:t,element:o}of this._totalAvailableElements){if(this._logDensityInfo(o,t.elementSelector,e),!n&&this._elementLargerThanMainContent(o)||this._elementDisplayNone(o))continue;if(this._isBelowMaxes(r,i))this._checkElementSpacing({dynamicAd:t,element:o,insertEvery:e,targetAll:n,target:a});else break}!this._usedAbsoluteMinimum&&this._smallerIncrementAttempts<5&&(++this._smallerIncrementAttempts,o(this._getSmallerIncrement(e)))},s=this._getInsertEvery(e,t,i);o(s)}_getSmallerIncrement(e){let t=e*.6;return t<=this._absoluteMinimumSpacingByDevice&&(t=this._absoluteMinimumSpacingByDevice,this._usedAbsoluteMinimum=!0),t}_insertAds(){let e=[],t=0;return this._adInjectionMap.filterUsed(),this._adInjectionMap.map.forEach(({el:n,dynamicAd:r,target:i},a)=>{let o=Number(r.sequence)+a,s=r.max,c=r.lazy&&o>s;r.sequence=o,r.lazy=c;let l=this._addContentAd(n,r,i);l&&(r.used=!0,e.push(l),++t)}),e}_getInsertEvery(e,t,n){let r=this._absoluteMinimumSpacingByDevice;return this._moreAvailableElementsThanUnitsToInject(n,e)?(this._usedAbsoluteMinimum=!1,r=this._useWiderSpacing(n,e)):(this._usedAbsoluteMinimum=!0,r=this._useSmallestSpacing(t)),t&&window.innerHeight>r?window.innerHeight:r}_useWiderSpacing(e,t){return this._mainContentHeight/Math.min(e,t)}_useSmallestSpacing(e){return e&&window.innerHeight>this._absoluteMinimumSpacingByDevice?window.innerHeight:this._absoluteMinimumSpacingByDevice}_moreAvailableElementsThanUnitsToInject(e,t){return this._totalAvailableElements.length>e||this._totalAvailableElements.length>t}_logDensityInfo(e,t,n){let{onePerViewport:r,targetDensity:i,targetDensityUnits:a,combinedMax:o}=this._pubLog;this._totalAvailableElements.length}_checkElementSpacing({dynamicAd:e,element:t,insertEvery:n,targetAll:r,target:i=document}){let a=this._isFirstAdInjected()||this._hasProperSpacing(t,e,r,n);a&&this._markSpotForContentAd(t,{...e},i)}_isFirstAdInjected(){return!this._adInjectionMap.map.length}_markSpotForContentAd(e,t,n=document){let r=t.position===`beforebegin`||t.position===`afterbegin`;this._adInjectionMap.add(e,this._getElementCoords(e,r),t,n),this._adInjectionMap.sort()}_hasProperSpacing(e,t,n,r){let i=t.position===`beforebegin`||t.position===`afterbegin`,a=t.position===`beforeend`||t.position===`afterbegin`,o=n||this._isElementFarEnoughFromOtherAdElements(e,r,i),s=a||this._isElementNotInRow(e,i),c=e.id.indexOf(`AdThrive_Below_Post`)===-1,l=o&&s&&c;return l}_isElementFarEnoughFromOtherAdElements(e,t,n){let r=this._getElementCoords(e,n),i=!1;for(let e=0;e<this._adInjectionMap.map.length;e++){let n=this._adInjectionMap.map[e].coords,a=this._adInjectionMap.map[e+1]&&this._adInjectionMap.map[e+1].coords;if(i=r-t>n&&(!a||r+t<a),i)break}return i}_isElementNotInRow(e,t){let n=e.previousElementSibling,r=e.nextElementSibling,i=t?!n&&r||n&&e.tagName!==n.tagName?r:n:r;return i&&e.getBoundingClientRect().height===0?!0:i?e.getBoundingClientRect().top!==i.getBoundingClientRect().top:!0}_calculateMainContentHeightAndAllElements(e,t=document){let[n,r]=OG(e,this._adInjectionMap,t);this._mainContentDiv=n,this._totalAvailableElements=r,this._mainContentHeight=CG(this._mainContentDiv)}_getElementCoords(e,t=!1){let n=e.getBoundingClientRect(),r=t?n.top:n.bottom;return r+window.scrollY}_addContentAd(e,t,n=document){let r=null,i=eJ(t),a=tJ(t),o=this._config.adOptions.stickyContentEnabled?`adthrive-sticky-container`:``,s=Jq(e,this.getDynamicElementId(t),t.position,[o,i,a,...t.classNames],t.location,this._cls.injectedSlots||[]);if(s){let e=this._filterAdUnitSizes(t,s);e.length&&(r=Xq(t,s,e,n!==document,(t==null?void 0:t.thirdPartyAdUnitName)||``))}return r}_filterAdUnitSizes(e,t){let n=PW(t),r=e.sticky&&e.location===F.Sidebar;return e.sizes.filter(t=>{let i=e.autosize?t[0]<=n||t[0]<=320:!0,a=r?t[1]<=window.innerHeight-100:!0;return i&&a})}_repeatDynamicAds(e){let t=[],n=e.location===F.Recipe,r=n?99:this.locationMaxLazySequence.get(e.location),i=e.lazy?N(r,0):0,a=e.max,o=e.lazyMax,s=i===0&&e.lazy?a+o:Math.min(Math.max(i-e.sequence+1,0),a+o),c=Math.max(a,s);for(let n=0;n<c;n++){let r=Number(e.sequence)+n,i=e.lazy&&n>=a,o=r;e.name===`Recipe_1`&&r>=5&&(o=r+1),t.push({...e,sequence:o,lazy:i})}return t}}})),iJ=o((()=>{Mme()})),aJ,oJ,sJ,cJ,lJ,Nme=o((()=>{w(),B(),Ra(),iJ(),$(),Bq(),ud(),j(),O(),lJ=class extends rJ{constructor(e,t,n,r){super(n,t,r),this._config=e,this._context=t,this._adInjectionMap=n,this._cls=r}getDynamicElementId(e){return`${this._config.gam.prefix}_${e.location}_${e.sequence}_${this._context.device}`}},lJ=D([Q(`DynamicAdsInjector`),S(),A(`design:paramtypes`,[typeof(aJ=z!==void 0&&z)==`function`?aJ:Object,typeof(oJ=L!==void 0&&L)==`function`?oJ:Object,typeof(sJ=zq!==void 0&&zq)==`function`?sJ:Object,typeof(cJ=ld!==void 0&&ld)==`function`?cJ:Object])],lJ)}));function uJ(e,t){t===void 0&&(t={});var n=t.insertAt;if(!(!e||typeof document>`u`)){var r=document.head||document.getElementsByTagName(`head`)[0],i=document.createElement(`style`);i.type=`text/css`,n===`top`&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}var dJ=o((()=>{})),fJ,pJ,mJ,hJ,gJ,_J=o((()=>{dJ(),fJ=e=>uJ(`
  .adthrive-device-phone .adthrive-sticky-content {
    height: 450px !important;
    margin-bottom: 100px !important;
  }
  .adthrive-content.adthrive-sticky {
    position: -webkit-sticky;
    position: sticky !important;
    top: 42px !important;
    margin-top: 42px !important;
  }
  .adthrive-content.adthrive-sticky:after {
    content: "— Advertisement. Scroll down to continue. —";
    font-size: 10pt;
    margin-top: 5px;
    margin-bottom: 5px;
    display:block;
    color: #888;
  }
  .adthrive-sticky-container {
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    min-height:${e||400}px;
    margin: 10px 0 10px 0;
    background-color: #FAFAFA;
    padding-bottom:0px;
  }
  `),pJ=e=>{uJ(`
  .adthrive-recipe.adthrive-sticky {
    position: -webkit-sticky;
    position: sticky !important;
    top: 42px !important;
    margin-top: 42px !important;
  }
  .adthrive-recipe-sticky-container {
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    min-height:${e||400}px !important;
    margin: 10px 0 10px 0;
    background-color: #FAFAFA;
    padding-bottom:0px;
  }
  `)},mJ=(e=5)=>{let t=e>5?e:5;uJ(`
      .adthrive-sticky-container > div {
        flex-basis: unset;
        position: sticky !important;
        display: block;
        flex-direction: column;
        top: ${t}px;
      }
    `)},hJ=(e=5)=>{let t=e>5?e:5;uJ(`
      .adthrive-recipe-sticky-container > div {
        flex-basis: unset;
        position: sticky !important;
        display: block;
        flex-direction: column;
        top: ${t}px;
      }
    `)},gJ=(e,t)=>{let n=e==null?1800:e,r=t==null?5:t;uJ(`
    .adthrive-ad.adthrive-sticky-sidebar {
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      min-height: ${n}px !important;
      padding-bottom: 0px;
      margin: 10px 0 10px 0;
    }
    .adthrive-ad.adthrive-sticky-sidebar > div {
      flex-basis: unset;
      position: sticky !important;
      top: ${r}px;
    }
  `)}})),vJ,yJ=o((()=>{LW(),Rf(),vJ=e=>{if(e&&e.length){let t=0;for(let n=0;n<e.length;n++){let r=Lf(e[n]);if(r.valid&&r.elements&&r.elements[0]){t=IW(r.elements[0]).height;break}}return t}else return}})),bJ,xJ=o((()=>{bt(),wt(),w(),E(),O(),bJ=class extends Ct{constructor(...e){super(...e),T(this,`footerSlotAdditionEnabled`,new k)}},bJ=D([C()],bJ)})),SJ,CJ,wJ,TJ=o((()=>{SJ=!1,CJ=()=>{SJ=!0},wJ=()=>SJ})),EJ,DJ,OJ,Pme=o((()=>{LO(),Na(),al(),$(),FS(),Z(),sG(),Ni(),w(),j(),E(),O(),OJ=class{constructor(e,t){this._pageManager=e,this._slotManager=t,T(this,`_observer`,null),T(this,`_lastScroll`,window.scrollY),T(this,`_slotsAboveTheFold`,[]),T(this,`_scrollListenerOff`,()=>{}),this.enabled&&(this._scrollListenerOff=this._pageManager.scroll.on(Sp(()=>this._handleScroll.call(this,window.scrollY),100)))}start(e){if(e.length===0){this._scrollListenerOff();return}this._slotsAboveTheFold=e,this._observer=new IntersectionObserver((e,t)=>{e.forEach(e=>{let n=this._slotsAboveTheFold.findIndex(t=>t.id===e.target.id),r=this._slotsAboveTheFold[n];r&&e.isIntersecting&&(t.unobserve(e.target),this._slotsAboveTheFold.splice(n,1),this._addSlot(r))})},{threshold:[0],rootMargin:`100% 0px -100% 0px`,root:null});for(let t of e)this._observer.observe(t.element)}_handleScroll(e){let t=(e-this._lastScroll)/window.innerHeight;t<=-1&&this._slotsAboveTheFold.forEach(e=>{if(e.element&&oG(e.element)>=-1){var t;(t=this._observer)==null||t.unobserve(e.element),this._addSlot(e)}}),this._lastScroll=e}_addSlot(e){this._slotManager.add(e).catch(e=>{M.error(`DynamicAdsComponent`,`start`,`add`,e)})}get enabled(){return Oi()&&tG()&&il.isRolloutEnabled(`restrict-ads-atf-after-ios-refresh`)}},OJ=D([Q(`AboveTheFoldSlotsIntersectionObserver`),C(),A(`design:paramtypes`,[typeof(EJ=ja!==void 0&&ja)==`function`?EJ:Object,typeof(DJ=PS!==void 0&&PS)==`function`?DJ:Object])],OJ)})),kJ,AJ,jJ,Fme=o((()=>{kJ=(e,t)=>!e||!t?!1:(e==null?void 0:e.length)===(t==null?void 0:t.length)&&(e==null?void 0:e.every((e,n)=>e===t[n])),AJ=(e,t)=>{var n,r,i;let a=kJ(e==null?void 0:e.devices,t==null||(n=t.dynamicAd)==null?void 0:n.devices),o=(e==null||(r=e.dynamic)==null?void 0:r.elementSelector)===(t==null||(i=t.dynamicAd)==null?void 0:i.elementSelector);return a&&o},jJ=(e,t)=>{var n;let r=``,i=``,a=t==null||(n=t.dynamicAd)==null||(n=n.location)==null?void 0:n.replace(`_`,` `);for(let n of e){var o,s,c;let e=(n==null?void 0:n.location)===a,d=(n==null||(o=n.dynamic)==null?void 0:o.position)===(t==null||(s=t.dynamicAd)==null?void 0:s.position),f=AJ(n,t),p=e&&d&&f,m=(n==null?void 0:n.sequence)===(t==null||(c=t.dynamicAd)==null?void 0:c.sequence),h=p&&m;if(h){var l;r=(l=n==null?void 0:n.thirdPartyAdUnitName)==null?``:l;break}if(p){var u;i=(u=n==null?void 0:n.thirdPartyAdUnitName)==null?``:u}}return r||i}})),MJ,NJ,PJ,FJ,IJ,LJ,RJ,zJ,Ime=o((()=>{w(),B(),Ra(),X(),$(),FS(),Uq(),Nme(),H(),MW(),_J(),yJ(),Zq(),Di(),xJ(),TJ(),Pme(),Z(),ud(),Fme(),j(),O(),zJ=class extends V{constructor(e,t,n,r,i,a,o){super(),this._cls=e,this._config=t,this._context=n,this._injector=r,this._slotManager=i,this._skylineAdsEventBus=a,this._aboveTheFoldSlotsIntersectionObserver=o}hasClsInjectedContent(){if(this._cls&&this._cls.injectedSlots){for(let e of this._cls.injectedSlots)if(e.name.includes(F.Content))return!0}return!1}start(e=!1){let t=this.hasClsInjectedContent(),n=this._config.adOptions,r=n.dynamicStickySidebarHeight,i=vJ(n.dynamicStickySidebarHeaderSelectors);gJ(r,i);let a=this._config.dynamicAds.filter(e=>kW(this._config,e)).filter(e=>OW(e,this._context.device)).filter(e=>!t||t&&e.location!==F.Content).filter(e=>e.location===F.Interstitial||e.location===F.Video_StickyOutstream?AW(e.pageSelector):jW(e)).filter(e=>!this.pluginInjected(e)).filter(e=>e.location!==F.Video_StickyOutstream||!this.shouldFilterStickyOutstream()),o=this._injector.inject(a);if(this._cls&&this._cls.enabled&&this._cls.injectedSlots&&this._cls.injectedSlots.length){var s;let e=[];(s=this._cls.injectedSlots)==null||s.forEach(t=>{let n=o.find(e=>e.name===t.name),r=e.find(e=>e.name===t.name);if(!n&&!r){let n=jJ(this._cls.adUnits||[],t);e.push(Xq(t.dynamicAd,t.element,t.sizes,t.infinite,n||``))}}),o=o.concat(e)}let c=t=>{t.length!==0&&this._slotManager.add(t,e).catch(e=>{M.error(`DynamicAdsComponent`,`start`,`add`,e)})};if(wJ()&&this._aboveTheFoldSlotsIntersectionObserver.enabled){let e=[];o=o.filter(t=>oG(t.element)<-1?(e.push(t),!1):!0),M.event(`DynamicAdsComponent`,`start`,`isIOSRefresh`,{slotsAboveTheFold:e.map(e=>e.id),dynamicSlots:o.map(e=>e.id)}),this._aboveTheFoldSlotsIntersectionObserver.start(e)}let l=this._config.adTypes.skylineHeader&&Ei();if(l&&o.some(e=>e.location===F.Header)){let e=o.findIndex(e=>e.location===F.Footer);if(e!==-1){let t=o.splice(e,1)[0];this._skylineAdsEventBus.footerSlotAdditionEnabled.on(()=>{c([t])})}}c(o)}get enabled(){return this._config.dynamicAds.length>0}shouldFilterStickyOutstream(){return this._config.video.preventStickyOutstream||this._config.disableAds.video||!this._config.video.stickyOutstreamSettings.allowOnHomepage&&Hq()?!0:(this._config.video.hasStickyOutstream=!0,!1)}pluginInjected(e){let t={...e};delete t.thirdPartyAdUnitName;let n=JSON.stringify(t);return this._cls&&this._cls.injectedSlots&&this._cls.injectedSlots.length&&this._cls.injectedSlots.some(e=>JSON.stringify(e.clsDynamicAd)===n)}},zJ=D([Q(`DynamicAdsComponent`),S(),A(`design:paramtypes`,[typeof(MJ=ld!==void 0&&ld)==`function`?MJ:Object,typeof(NJ=z!==void 0&&z)==`function`?NJ:Object,typeof(PJ=L!==void 0&&L)==`function`?PJ:Object,typeof(FJ=lJ!==void 0&&lJ)==`function`?FJ:Object,typeof(IJ=PS!==void 0&&PS)==`function`?IJ:Object,typeof(LJ=bJ!==void 0&&bJ)==`function`?LJ:Object,typeof(RJ=OJ!==void 0&&OJ)==`function`?RJ:Object])],zJ)})),BJ=o((()=>{Ime()})),VJ,HJ,UJ,WJ,GJ,KJ,qJ,JJ,YJ,XJ,ZJ,Lme=o((()=>{$(),H(),Na(),B(),Bq(),Eh(),FS(),Z(),_I(),BJ(),jc(),w(),rU(),ud(),j(),O(),ZJ=class extends V{constructor(e,t,n,r,i,a,o,s,c,l){super(),this._pageManager=e,this._config=t,this._adInjectionMap=n,this._intersectionObserverManager=r,this._slotManager=i,this._prebidActionManager=a,this._dynamicAdsComponent=o,this._prebidMethods=s,this._slotEventBus=c,this._cls=l}start(){this._addDeviceOrientationListener()}_addDeviceOrientationListener(){this._pageManager.deviceOrientationChange.on(()=>this._handleDeviceOrientationChange())}_handleDeviceOrientationChange(){var e,t;this._config.disableAds.clear(),this._intersectionObserverManager.unobserveAll(!1),this._adInjectionMap.reset(),this._slotManager.removeAllElements(!1),this._prebidActionManager.reset(!1),this._prebidMethods.clearAllAuctions();let n=this._slotManager.destroyAll(!1);kK.resetTimeOrigin(),this._config.disableAds.init(),M.event(`DeviceOrientationComponent`,`_handleDeviceOrientationChange`),this._config.resetDynamicAds(),(e=this._cls.injectedSlots)==null||e.splice(0,this._cls.injectedSlots.length),(t=this._cls.injectedVideoSlots)==null||t.splice(0,this._cls.injectedVideoSlots.length),this._dynamicAdsComponent.start(!0),this._slotManager.rebuildAll();let r=this._slotEventBus;r.addRebuiltSlots.once(e=>{let t=this._slotManager.getSlots(e);t.forEach(e=>{if(e.rebuild){let t=n.find(t=>t.id===e.id);if(t){let n=t.refreshCount+1;e.refreshCount=n}}}),r.addSlots.emit(e)})}},ZJ=D([Q(`DeviceOrientationComponent`),S(),A(`design:paramtypes`,[typeof(VJ=ja!==void 0&&ja)==`function`?VJ:Object,typeof(HJ=z!==void 0&&z)==`function`?HJ:Object,typeof(UJ=zq!==void 0&&zq)==`function`?UJ:Object,typeof(WJ=Th!==void 0&&Th)==`function`?WJ:Object,typeof(GJ=PS!==void 0&&PS)==`function`?GJ:Object,typeof(KJ=gI!==void 0&&gI)==`function`?KJ:Object,typeof(qJ=zJ!==void 0&&zJ)==`function`?qJ:Object,typeof(JJ=R!==void 0&&R)==`function`?JJ:Object,typeof(YJ=Vr!==void 0&&Vr)==`function`?YJ:Object,typeof(XJ=ld!==void 0&&ld)==`function`?XJ:Object])],ZJ)})),Rme=o((()=>{Lme()})),QJ,$J,eY,tY,nY,rY,zme=o((()=>{B(),Ra(),$(),w(),H(),Bh(),FS(),Z(),HS(),LO(),j(),E(),O(),rY=class extends V{constructor(e,t,n,r,i){super(),this._config=e,this._context=t,this._gamEventBus=n,this._slotManager=r,this._videoEventProxy=i,T(this,`_highEntropyHints`,[`brands`,`mobile`,`platform`,`bitness`,`model`,`platformVersion`,`uaFullVersion`,`fullVersionList`,`wow64`]),T(this,`_auctionTargetingKeys`,[`hb_crid`,`hb_bidder`,`hb_deal`,`hb_pb`,`amz_bidder`,`amz_pb`,`amz_bidder_sp`,`amz_pb_sp`]),T(this,`_highEntropyHintsValues`,{bitness:``,brands:[],fullVersionList:[],mobile:!1,model:``,platform:``,platformVersion:``,uaFullVersion:``,wow64:!1})}init(){this._getHighEntropyHints(),this._videoEventProxy.videoImpression.on(({videoAdDetails:e,player:t})=>{this._eventStreamerImpression(t,e)}),this._gamEventBus.slotRenderEnded.on(({event:e,slotId:t})=>{let n=this._slotManager.getSlot(t);n&&this._eventStreamerImpression(n,e)}),this._gamEventBus.impressionViewable.on(({slotId:e})=>{let t=this._slotManager.getSlot(e);t&&this._eventStreamerViewable(t)})}_eventStreamerImpression(e,t){let n=this._getBaseContext(`raptive.adcode.impression.v1.Impression`),r=this._getSlotContext(e),i=this._getGamContext(e,t),a=this._getAuctionContext(e,t),o=this._getSiteContext(),s=this._getWebContext(),c=this._getAdCodeContext(),l=e.impressionId,u=!t.isEmpty,d={adcodeContext:c,auctionContext:a,baseContext:n,gamContext:i,impressionId:l,isMeasurable:u,siteContext:o,slotContext:r,webContext:s};this._callEventStreamer(d,`impression`)}_eventStreamerViewable(e){let t=this._getBaseContext(`raptive.adcode.impression.v1.ViewableImpression`),n=this._getSiteContext(),r=e.impressionId,i={baseContext:t,impressionId:r,siteContext:n};this._callEventStreamer(i,`viewable`)}_getBaseContext(e){let t=new Date;return{messageId:NK(),eventName:e,sentAt:t.toISOString(),sourceId:`adcode`}}_getWebContext(){return{page:{path:window.location.pathname,referrer:document.referrer,search:window.location.search,title:document.title,url:window.location.href},screen:{height:window.screen.height||0,width:window.screen.width||0,density:window.devicePixelRatio||0},userAgent:navigator.userAgent||``,userAgentData:this._highEntropyHintsValues,campaign:{name:this._context.utm.utm_campaign||``,source:this._context.utm.utm_source||``,term:this._context.utm.utm_term||``,medium:this._context.utm.utm_medium||``,content:this._context.utm.utm_content||``},geo:{country:this._context.country||``,region:this._context.region||``}}}_getSiteContext(){return{siteId:this._config.site.id,sessionKey:this._context.sessionKey,pageViewKey:this._context.pageviewKey,gamAccountId:this._config.gam.account||``}}_getSlotContext(e){let t=`id`in e;return{isLazy:t?e.lazy:!1,refreshes:t?e.refreshCount:0,videoRefreshes:t?0:e.prerollNum}}_getAdCodeContext(){return{abgroup:this._config.abGroup.groups,branch:this._context.branch,bucket:this._context.bucket,deployment:this._context.deployment,plugin:this._context.plugin,hbho:this._config.hbho.bidders,vbho:this._config.vbho.bidders,fpv:this._context.isFirstPageview||!1}}_getGamDisplayContext(e,t){let n=e.getTargetingMap().flag_slot||[];return{adUnitPath:t.slot.getAdUnitPath()||``,creativeId:String(t.creativeId)||``,lineItemId:String(t.lineItemId)||``,size:t.size&&typeof t.size!=`string`?t.size:[],slotElementId:t.slot.getSlotElementId()||``,flagSlot:n,advertiserId:String(t.advertiserId)||``,agnosticCreativeId:String(t.sourceAgnosticCreativeId)||``,agnosticLineItemId:String(t.sourceAgnosticLineItemId)||``,campaignId:String(t.campaignId)||``,companyIds:(t.companyIds||[]).map(String),serviceName:t.serviceName||``,yieldGroupIds:(t.yieldGroupIds||[]).map(String)}}_getGamVideoContext(e,t){let n=decodeURIComponent(this._getVideoTargetingData(t).flag_slot).split(`,`)||[],r=Hh(t.tag.split(`?`)[1]);return{adUnitPath:r.get(`iu`)||``,creativeId:String(t.gamCreativeId)||``,lineItemId:String(t.gamLineItemId)||``,size:e.size||[],slotElementId:t.adUnitName,flagSlot:n,advertiserId:``,agnosticCreativeId:``,agnosticLineItemId:``,campaignId:``,companyIds:[],serviceName:``,yieldGroupIds:[]}}_getGamContext(e,t){let n=`id`in e,r={flag:window.googletag.pubads().getTargeting(`flag`),...n?this._getGamDisplayContext(e,t):this._getGamVideoContext(e,t)};return r}_getAuctionContext(e,t){let n=`id`in e;return this._getAuctionTargetingKeyValues(n?e.getTargetingMap():this._getVideoTargetingData(t))}_getAuctionTargetingKeyValues(e){let t={};return this._auctionTargetingKeys.forEach(n=>{let r=e[n]||``,i=r;i=xv(r)?r[0]:r,[`hb_pb`,`amz_pb`,`amz_pb_sp`].includes(n)&&(i=Number(i)),t[n]=i}),t}async _getHighEntropyHints(){var e;let t=new Promise(e=>{setTimeout(()=>{e(!1)},1e3)}),n=await Promise.race([(e=navigator)==null||(e=e.userAgentData)==null?void 0:e.getHighEntropyValues(this._highEntropyHints),t]);this._highEntropyHintsValues=n||this._highEntropyHintsValues}_getVideoTargetingData(e){let t=e.tag,n=Hh(t.split(`?`)[1]),r=Uh(this._getDecodedURI(n.get(`cust_params`)||``));return r}_getDecodedURI(e){try{return decodeURIComponent(e)}catch(e){return``}}get enabled(){return!1}_callEventStreamer(e,t){fetch(`https://stormgate.production.raptive.com/v1`,{method:`POST`,headers:[[`Content-Type`,`application/json`]],body:JSON.stringify(e),keepalive:!0}).catch(e=>{M.error(`EventStreamerComponent`,`Failed to send ${t} event`,e)})}},rY=D([Q(`EventStreamerComponent`),S(),A(`design:paramtypes`,[typeof(QJ=z!==void 0&&z)==`function`?QJ:Object,typeof($J=L!==void 0&&L)==`function`?$J:Object,typeof(eY=zh!==void 0&&zh)==`function`?eY:Object,typeof(tY=PS!==void 0&&PS)==`function`?tY:Object,typeof(nY=VS!==void 0&&VS)==`function`?nY:Object])],rY)})),Bme=o((()=>{zme()})),iY,aY,oY,Vme=o((()=>{$h(),B(),$(),w(),H(),Bh(),j(),O(),oY=class extends V{constructor(e,t){super(),this._config=e,this._gamEventBus=t}init(){try{this._gamEventBus.slotOnload.once(()=>this.refreshExternal())}catch(e){M.error(`ExternalSlotsComponent`,`init`,e)}}refreshExternal(){Zh.pushToQueue(()=>{let{account:e}=this._config.gam,t=window.googletag.pubads().getSlots(),n=t.filter(t=>RegExp(`^\/?${e}\/`).exec(t.getAdUnitPath())===null).filter(e=>document.getElementById(e.getSlotElementId())!==null);n.length&&window.googletag.pubads().refresh(n)})}},oY=D([Q(`ExternalSlotsComponent`),S(),A(`design:paramtypes`,[typeof(iY=z!==void 0&&z)==`function`?iY:Object,typeof(aY=zh!==void 0&&zh)==`function`?aY:Object])],oY)})),Hme=o((()=>{Vme()})),sY,cY,lY,uY,dY,fY,pY,Ume=o((()=>{w(),$h(),$(),H(),B(),Ra(),cw(),so(),rU(),Rm(),j(),O(),pY=class extends V{constructor(e,t,n,r,i,a){super(),this._gam=e,this._gdprEvents=t,this._config=n,this._context=r,this._gdprEnforcement=i,this._spaEventBus=a}init(){let e=this._context.isFirstPageview?`1`:`0`,t=[1];this._config.gdpr.enabled?this._gdprEvents.consentResponseCaptured.on(()=>{this._gdprEnforcement.checkConsentForVendor(this._config.gdpr.raptiveVendorId,t).then(t=>{t&&this.setFPV(e)}).catch(()=>{})}):this.setFPV(e),this.handleSPARouteChange()}setFPV(e=`0`){+e&&U.setInternalLocalStorage(`adthrive_fpv`,new Date().toString()),this._gam.setTargeting({key:`fpv`,value:e})}handleSPARouteChange(){this._spaEventBus.routeChanged.on(()=>{this._context.isFirstPageview=!1,this.setFPV(`0`),U.setInternalLocalStorage(`adthrive_session_fpv`,U.readInternalLocalStorage(`adthrive_session_fpv`)===null)})}},pY=D([Q(`FirstPageviewComponent`),S(),A(`design:paramtypes`,[typeof(sY=Zh!==void 0&&Zh)==`function`?sY:Object,typeof(cY=oo!==void 0&&oo)==`function`?cY:Object,typeof(lY=z!==void 0&&z)==`function`?lY:Object,typeof(uY=L!==void 0&&L)==`function`?uY:Object,typeof(dY=ow!==void 0&&ow)==`function`?dY:Object,typeof(fY=zr!==void 0&&zr)==`function`?fY:Object])],pY)})),Wme=o((()=>{Ume()})),mY,Gme=o((()=>{w(),mU(),O(),mY=class extends pU{init(){this._key=`PaapiBuyerTimeout`,this._lookup=`PAAPIBTO`}},mY=D([C()],mY)})),hY,Kme=o((()=>{w(),mU(),O(),hY=class extends pU{init(){this._key=`PaapiSellerTimeout`,this._lookup=`PAAPISTO`}},hY=D([C()],hY)})),gY,qme=o((()=>{w(),mU(),O(),gY=class extends pU{init(){this._key=`PaapiReportingTimeout`,this._lookup=`PAAPIRTO`}},gY=D([C()],gY)})),_Y,vY,yY,bY,xY,SY,CY,wY,Jme=o((()=>{w(),H(),$(),$h(),jc(),X(),B(),Ra(),Gme(),Kme(),qme(),j(),E(),O(),wY=class extends V{constructor(e,t,n,r,i,a,o){super(),this._config=e,this._context=t,this._gam=n,this._prebidMethods=r,this._paapiBuyerTimeoutExperiment=i,this._paapiSellerTimeoutExperiment=a,this._paapiReportingTimeoutExperiment=o,T(this,`_ownerUrl`,void 0),T(this,`_sellerUrl`,void 0),T(this,`_decisionLogicUrl`,void 0),T(this,`_bidderCodeList`,[P.Rtbhouse,P.OpenX,P.OpenXServer,P.Criteo,P.IndexExchange,P.Rubicon,P.CriteoServer]),this._ownerUrl=`https://${this._context.host}`,this._sellerUrl=`https://${this._context.privacySandboxHost}`,this._decisionLogicUrl=this._getDecisionLogicUrl()}get enabled(){return this._config.fledge.enabled}init(){this.enabled&&(this._gam.setTargeting({key:`fledge`,value:`true`}),this._setPrebidPAAPIConfig())}_getDecisionLogicUrl(){return`https://${this._context.privacySandboxHost}/decision-logic.js`}_setPrebidPAAPIConfig(){var e,t,n;let r=(e=this._paapiBuyerTimeoutExperiment.result)==null?500:e,i=(t=this._paapiSellerTimeoutExperiment.result)==null?500:t,a=(n=this._paapiReportingTimeoutExperiment.result)==null?500:n,o={seller:this._sellerUrl,decisionLogicUrl:this._decisionLogicUrl,interestGroupBuyers:[this._ownerUrl,`https://grid-mercury.criteo.com`,`https://ads.optable.co`],auctionSignals:{raptive:{...M.data,debug:this._context.debug,chromeLabel:this._config.fledge.cookieDeprecationLabel,siteId:this._config.site.id,siteName:this._config.site.name,pvk:this._context.pageviewKey,sess:this._context.sessionKey,deployment:this._context.deployment,branch:this._context.branch,bucket:this._context.bucket}},perBuyerTimeouts:{"*":r},perBuyerCumulativeTimeouts:{"*":r},sellerTimeout:i,reportingTimeout:a},s={enabled:!0,defaultForSlots:1,bidders:this._bidderCodeList,componentSeller:{auctionConfig:o,separateAuctions:!1},parallel:!1,gpt:{configWithTargeting:!1}};this._prebidMethods.setConfig({paapi:s},!1),this._prebidMethods.setBidderConfig({bidders:[P.Rtbhouse],config:{fledgeEnabled:!0,fledgeConfig:o}},!0)}},wY=D([Q(`FledgeComponent`),C(),A(`design:paramtypes`,[typeof(_Y=z!==void 0&&z)==`function`?_Y:Object,typeof(vY=L!==void 0&&L)==`function`?vY:Object,typeof(yY=Zh!==void 0&&Zh)==`function`?yY:Object,typeof(bY=R!==void 0&&R)==`function`?bY:Object,typeof(xY=mY!==void 0&&mY)==`function`?xY:Object,typeof(SY=hY!==void 0&&hY)==`function`?SY:Object,typeof(CY=gY!==void 0&&gY)==`function`?CY:Object])],wY)})),Yme=o((()=>{Jme()})),TY,EY=o((()=>{H(),X(),LO(),E(),TY=class extends V{constructor(e,t){super(),this._config=e,this._prebidMethods=t,T(this,`_expirationThreshold`,5),T(this,`_host`,window.location.hostname)}_setValues(e,t,n){e.values[`${this._host}|${t}`]=n>0?n:0}_getDefaultFloorConfig(){let e={...nO(this._config.floors.defaultFloorData),modelVersion:`legacy.${this.floorsType}`};return e}_updateBidTTL(e,t,n=``){let r=n?this._prebidMethods.getBidResponsesForBidPoolId(n):this._prebidMethods.getBidResponsesForAdUnitCode(e);r.bids.filter(e=>e.status!==`rendered`&&e.ttl&&!e.expired&&!e.sharedBidInUse).forEach(n=>{let r=n.responseTimestamp,i=n.ttl,a=e.includes(F.Video_StickyOutstream)?this._config.prebid.multistageStickyOutstreamActive:this._config.prebid.multistageActive,o=a?2:1,s=i-this._expirationThreshold*o,c=Number(r)+Number(s)*1e3<t;c&&(n.ttl=0,n.expired=!0)})}}})),DY,OY,kY,AY,jY,Xme=o((()=>{B(),X(),$(),w(),xu(),EY(),br(),jc(),j(),E(),O(),jY=class extends TY{constructor(e,t,n,r){super(e,t),this._config=e,this._prebidMethods=t,this._floorsExperiment=n,this._floorsEventBus=r,T(this,`floorsType`,Hn.raptive)}init(){let e=this._config.floors.floorsData;e?this._createFloorsMap(e):this._config.floors.floorsDataReady.once(()=>{this._createFloorsMap(this._config.floors.floorsData)})}_createFloorsMap(e){if(e&&Object.keys(e).length){var t,n;let r=this._floorsExperiment.result,i=r.fbrap||r.raptive,a=e==null||(t=e.modelGroups)==null?void 0:t[0],o=(a==null||(n=a.schema)==null?void 0:n.fields)||[];this._config.floors.setAdditionalSchemaFields(o),i&&this._floorsEventBus.storeRaptiveFloorData.emit(e)}else M.error(`FloorsRaptiveComponent`,`init`,`Raptive floor data not found`)}get active(){return this.enabled}get enabled(){return this._floorsExperiment.result.raptive}},jY=D([Q(`FloorsRaptiveComponent`),S(),A(`design:paramtypes`,[typeof(DY=z!==void 0&&z)==`function`?DY:Object,typeof(OY=R!==void 0&&R)==`function`?OY:Object,typeof(kY=bu!==void 0&&bu)==`function`?kY:Object,typeof(AY=yr!==void 0&&yr)==`function`?AY:Object])],jY)})),MY,Zme=o((()=>{mU(),w(),O(),MY=class extends pU{init(){this._key=`FloorsStickyOutstreamRefresh`,this._lookup=`REFSOFLR`}},MY=D([C()],MY)})),NY,Qme=o((()=>{Ui(),w(),E(),O(),NY=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`AdditiveRefreshFloors`,this._lookup=`ARF`}},NY=D([C()],NY)})),PY,FY,IY,LY,RY,zY,BY,VY,HY,UY,WY,$me=o((()=>{jc(),B(),X(),Wn(),$(),ei(),Ol(),fg(),w(),xu(),Zme(),vh(),Wr(),EY(),br(),fU(),Qme(),j(),E(),O(),UY={banner:`banner`,instream:`instream`,stickyOutstream:`stickyOutstream`},WY=class extends TY{constructor(e,t,n,r,i,a,o,s,c){var l;super(e,t),this._config=e,this._prebidMethods=t,this._videoRequestManager=n,this._floorsExperiment=r,this._stickyOutstreamExperiment=i,this._slotManagerEventBus=a,this._floorsEventBus=o,this._additiveRefreshFloorsExperiment=s,this._slots=c,T(this,`floorsType`,Hn.refresh),T(this,`_raptiveMLSkipRate`,void 0),T(this,`_stickyOutstreamMLEnabled`,!1),T(this,`_multipliers`,new Map([[UY.banner,{low:1.3,high:1.1}],[UY.instream,{low:1.3,high:1.1}],[UY.stickyOutstream,{low:1.1,high:1}]])),this._raptiveMLSkipRate=(l=this._config.floors.raptiveMLRefreshFloors)==null?void 0:l.skipRate;let u=this._stickyOutstreamExperiment.result;typeof u==`number`&&u>0?this._multipliers.set(UY.stickyOutstream,{low:u,high:u}):u===`ml`&&(this._stickyOutstreamMLEnabled=!0)}init(){this._slotManagerEventBus.refreshAuctionStart.on(e=>this._handleBannerRefreshAuction(e)),this._videoRequestManager.refreshingVideoBids.on(e=>this._handleInstreamRefreshAuction(e))}_handleBannerRefreshAuction(e){let t=this._slots.get(e);this._prebidMethods.addToQueue(()=>{this._setRefreshFloors(t.map(e=>({adUnitCode:e.id,refreshCount:e.refreshCount,bidPoolId:e.bidPoolId,setSlotTargetingFlag:(t,n,r)=>{e.setSlotTargetingFlag(t,n,r)}})))})}_handleInstreamRefreshAuction(e){this._prebidMethods.addToQueue(()=>{this._setRefreshFloors(e.map(e=>({adUnitCode:e.name,refreshCount:e.prerollNum})))})}_getFloorData(e,t,n,r,i){let a,o,s=0,c,l;if(i)({multiplier:o,multiplierWeight:c,addition:s,additionWeight:l}=this._getRefreshInflateMultiplierWithWeight(r,t,n)),a=e&&Math.max(e*o+s,0);else{let i=r<=5?`low`:`high`,s=this._getMultiplierType(t,n);o=this._multipliers.get(s)[i],a=e&&Math.max(e*o,0)}return{floor:a,multiplier:o,addition:s,multiplierWeight:c,additionWeight:l}}_getMultiplierType(e,t){let n=UY.banner;return e?n=UY.instream:t&&(n=UY.stickyOutstream),n}_getHighestCPM(e,t,n){this._updateBidTTL(e,t,n);let[r]=n?this._prebidMethods.getHighestCpmBidsForPoolId(n):this._prebidMethods.getHighestCpmBids(e),i=this._config.floors.amazonSlotCpm.get(e)||0,a=(r==null?void 0:r.cpm)||0;return Math.max(a,i)}_generateFloorData(e){let{adUnitCode:t,bidPoolId:n,refreshCount:r}=e,i=Yr(),a=this._getHighestCPM(t,i,n),o=this._config.video.instreamAdUnits.has(t),s=t.includes(F.Video_StickyOutstream),{shouldUseRaptiveInflators:c,isRaptiveSkipApplied:l,canApplyRaptiveMLRefreshInflators:u}=this._shouldApplyRaptiveMLRefreshFloors(s),{floor:d,multiplier:f,addition:p,multiplierWeight:m,additionWeight:h}=this._getFloorData(a,o,s,r,c);return{cpm:a,floor:d,multiplier:f,addition:p,multiplierWeight:m,additionWeight:h,isInstream:o,shouldUseRaptiveInflators:c,canApplyRaptiveMLRefreshInflators:u}}_setRefreshFloors(e){let t=this._getDefaultFloorConfig();for(let n of e){let e=n.adUnitCode,{cpm:r,floor:i,isInstream:a,multiplier:o,addition:s,shouldUseRaptiveInflators:c,multiplierWeight:l,additionWeight:u,canApplyRaptiveMLRefreshInflators:d}=this._generateFloorData(n);i?(this._setValues(t,e,i),this._setFmlriTargetingFlagSlot(i,n,a,o,s,l,u,!c,d)):r&&this._setFmlriTargetingFlagSlot(r,n,a,o,s,l,u,!c,d),this._floorsEventBus.storeModuleFloorData.emit({floorData:t,type:this.floorsType,code:n.adUnitCode,cpm:r,floor:i})}}_setFmlriTargetingFlagSlot(e,t,n,r,i,a,o,s,c){let{adUnitCode:l,setSlotTargetingFlag:u}=t,d=c?s?`h`:``:`e`,f=a==null?0:a,p=o==null?0:o,m=`${e}@${r}@${i}@${f}@${p}${d}`;u?u(`fmlri`,[m],!0):n&&this._config.video.setVideoFlagSlot(l,{fmlri:m})}_shouldApplyRaptiveMLRefreshFloors(e=!1){var t;let n=e?!this._stickyOutstreamMLEnabled:!1,r=this._floorsExperiment.result.fbrap&&this._raptiveMLSkipRate!==void 0,i=new ar(((t=this._raptiveMLSkipRate)==null?0:t)/100).get(),a=r&&!i&&!n,o=r&&i;return{shouldUseRaptiveInflators:a,isRaptiveSkipApplied:o,canApplyRaptiveMLRefreshInflators:r}}_getRefreshInflateMultiplierWithWeight(e,t,n){let{inflator:r=[],defaultInflatorMultipliers:i=[],defaultInflatorAdditions:a=[],defaultInstreamInflatorMultipliers:o=[],defaultInstreamInflatorAdditions:s=[],defaultStickyOutstreamMultipliers:c=[],defaultStickyOutstreamInflatorAdditions:l=[],inflatorWeights:u}=this._config.floors.raptiveMLRefreshFloors,d=Dl(u),f=Dl(u),p=0;if(d.index===-1)return{multiplier:1,addition:p,multiplierWeight:-1,additionWeight:-1};let m=r.find(t=>e>=t.minRefresh&&e<=t.maxRefresh),h,g;if(t){var _,v;h=(_=m==null?void 0:m.instreamMultipliers)==null?o:_,g=(v=m==null?void 0:m.instreamAdditions)==null?s:v}else if(n){var y,b;h=(y=m==null?void 0:m.stickyOutstreamMultipliers)==null?c:y,g=(b=m==null?void 0:m.stickyOutstreamAdditions)==null?l:b}else{var ee,te;h=(ee=m==null?void 0:m.multipliers)==null?i:ee,g=(te=m==null?void 0:m.additions)==null?a:te}return this._additiveRefreshFloorsExperiment.result&&g[f.index]&&(p=g[f.index]),{multiplier:h[d.index]||1,addition:p,multiplierWeight:d.weight,additionWeight:f.weight}}get active(){return this.enabled}get enabled(){return this._floorsExperiment.result.legacy===!0}},WY=D([Q(`FloorsRefreshComponent`),S(),A(`design:paramtypes`,[typeof(PY=z!==void 0&&z)==`function`?PY:Object,typeof(FY=R!==void 0&&R)==`function`?FY:Object,typeof(IY=ug!==void 0&&ug)==`function`?IY:Object,typeof(LY=bu!==void 0&&bu)==`function`?LY:Object,typeof(RY=MY!==void 0&&MY)==`function`?RY:Object,typeof(zY=Ur!==void 0&&Ur)==`function`?zY:Object,typeof(BY=yr!==void 0&&yr)==`function`?BY:Object,typeof(VY=NY!==void 0&&NY)==`function`?VY:Object,typeof(HY=_h!==void 0&&_h)==`function`?HY:Object])],WY)})),GY,ehe=o((()=>{mU(),w(),O(),GY=class extends pU{init(){this._key=`SessionFloorDisplayPercentileExperiment`,this._lookup=`SESFLRDIS`}get result(){return this._result}},GY=D([C()],GY)})),KY,the=o((()=>{mU(),w(),O(),KY=class extends pU{init(){this._key=`SessionFloorStickyOutstreamPercentileExperiment`,this._lookup=`SESFLRSO`}get result(){return this._result}},KY=D([C()],KY)})),qY,nhe=o((()=>{mU(),w(),O(),qY=class extends pU{init(){this._key=`SessionFloorVideoPercentileExperiment`,this._lookup=`SESFLRVID2`}get result(){return this._result}},qY=D([C()],qY)})),JY,YY,XY,ZY,QY,$Y,eX,tX,nX,rX,iX,aX,oX,rhe=o((()=>{w(),jc(),Wn(),$(),Rm(),vh(),Z(),dg(),xu(),rU(),X(),Wr(),ehe(),the(),nhe(),EY(),B(),br(),j(),E(),O(),oX=class extends TY{constructor(e,t,n,r,i,a,o,s,c,l,u,d){super(e,t),this._config=e,this._prebidMethods=t,this._videoRequestManager=n,this._floorsExperiment=r,this._spaEventBus=i,this._slotManagerEventBus=a,this._slotEventBus=o,this._displaySessionPercentileExperiment=s,this._stickyOutstreamSessionPercentileExperiment=c,this._videoSessionPercentileExperiment=l,this._floorsEventBus=u,this._slots=d,T(this,`floorsType`,Hn.session),T(this,`_savedBids`,void 0),T(this,`_percentile`,.6),T(this,`_rdx`,33),T(this,`_defaultSavedBids`,{Content:[],Recipe:[],Header:[],Below_Post:[],Sidebar:[],Footer:[],"Video_In-Post_ClicktoPlay_SoundOn":[],Video_Collapse_Autoplay_SoundOff:[],Video_Individual_Autoplay_SOff:[],Video_Coll_SOff_Smartphone:[],Video_StickyOutstream_1:[],Video_StickyOutstream:[]}),T(this,`_eventListenersSet`,!1),T(this,`_offEvents`,[()=>{}]),T(this,`_sessionNonFPV`,U.readInternalLocalStorage(`adthrive_session_fpv`)===!1);let f=U.readInternalLocalStorage(`adthrive_bc`);this._savedBids={...this._defaultSavedBids,...f&&uK(f,this._rdx)}}init(){this._eventListenersSet||this._setupEventListeners()}_setupEventListeners(){this._eventListenersSet=!0,this._spaEventBus.routeChanged.on(()=>{this._eventListenersSet=!1,this._offEvents.forEach(e=>{e()}),this._offEvents=[],this.init()}),this._offEvents.push(this._slotManagerEventBus.requestedBids.on(e=>this._handleRequestedBids(e)),this._slotEventBus.amazonBidResponseReceived.on(e=>this._handleAmazonDisplayBidResponse(e)),this._videoRequestManager.requestingVideoBids.on(e=>this._handleRequestingVideoBids(e)),this._videoRequestManager.amazonVideoBidResponseReceived.on(e=>this._handleAmazonVideoBidResponse(e)),...this._sessionNonFPV?[this._slotManagerEventBus.requestingBids.on(e=>this._handleRequestingBids(e))]:[])}_handleRequestingBids(e){let t=this._slots.get(e)||[];t.filter(e=>Object.keys(this._savedBids).includes(e.location)).forEach(e=>{let{floor:t,percentile:n,sessionFloorData:r}=this._getFloorValues(e.location,e.id);e.setSlotTargetingFlag(`fmlsi`,[`${t}@${n}`],!0),this._floorsEventBus.storeModuleFloorData.emit({floorData:r,type:this.floorsType,code:e.id})})}_handleAmazonDisplayBidResponse(e){e.forEach(({location:e,cpm:t,slotId:n})=>{Object.keys(this._savedBids).includes(e)&&t>0&&this._prebidMethods.addToQueue(()=>{this._saveAmazonSlotBid(n,t,e)})}),U.setInternalLocalStorage(`adthrive_bc`,dK(this._savedBids,this._rdx))}_handleRequestingVideoBids(e){e.forEach(e=>{if(Object.keys(this._savedBids).includes(e.name)&&(this._prebidMethods.addToQueue(()=>{this.saveVideoSlotBids(e)}),this._sessionNonFPV)){let{floor:t,percentile:n,sessionFloorData:r}=this._getFloorValues(e.name);this._config.video.setVideoFlagSlot(e.name,{fmlsi:[`${t}@${n}`]}),this._floorsEventBus.storeModuleFloorData.emit({floorData:r,type:this.floorsType,code:e.name})}}),U.setInternalLocalStorage(`adthrive_bc`,dK(this._savedBids,this._rdx))}_handleAmazonVideoBidResponse(e){e.forEach(({video:e,cpm:t})=>{Object.keys(this._savedBids).includes(e.name)&&t>0&&this._prebidMethods.addToQueue(()=>{this._saveAmazonVideoSlotBid(e,t)})}),U.setInternalLocalStorage(`adthrive_bc`,dK(this._savedBids,this._rdx))}_getFloorValues(e,t){let n=this._getDefaultFloorConfig(),r=this._getPercentile(e),i=oK(this._savedBids[e],r);return i>0&&this._setValues(n,t==null?e:t,i),{floor:i,percentile:r,sessionFloorData:n}}_handleRequestedBids(e){let t=this._slots.get(e);t.forEach(e=>{Object.keys(this._savedBids).includes(e.location)&&this._prebidMethods.addToQueue(()=>{this.saveSlotBids(e)})}),U.setInternalLocalStorage(`adthrive_bc`,dK(this._savedBids,this._rdx))}_saveBids(e,t){let n=this._prebidMethods.getBidResponsesForAdUnitCode(e);n.bids.forEach(n=>{pK(this._savedBids[t==null?e:t],1e3),n.cpm&&this._savedBids[t==null?e:t].push(n.cpm)})}saveSlotBids(e){this._saveBids(e.id,e.location)}_saveAmazonSlotBid(e,t,n){pK(this._savedBids[n],1e3),t&&this._savedBids[n].push(t)}saveVideoSlotBids(e){this._saveBids(e.name)}_saveAmazonVideoSlotBid(e,t){pK(this._savedBids[e.name],1e3),t&&this._savedBids[e.name].push(t)}_getPercentile(e){let t;return t=e.includes(F.Video_StickyOutstream)?this._stickyOutstreamSessionPercentileExperiment.result:e.includes(`Video`)?this._videoSessionPercentileExperiment.result:this._displaySessionPercentileExperiment.result,t||this.defaultPercentile}get defaultPercentile(){return this._percentile}get active(){return this.enabled&&this._sessionNonFPV}get enabled(){return this._floorsExperiment.result.legacy===!0}},oX=D([Q(`FloorsSessionComponent`),S(),A(`design:paramtypes`,[typeof(JY=z!==void 0&&z)==`function`?JY:Object,typeof(YY=R!==void 0&&R)==`function`?YY:Object,typeof(XY=ug!==void 0&&ug)==`function`?XY:Object,typeof(ZY=bu!==void 0&&bu)==`function`?ZY:Object,typeof(QY=zr!==void 0&&zr)==`function`?QY:Object,typeof($Y=Ur!==void 0&&Ur)==`function`?$Y:Object,typeof(eX=Vr!==void 0&&Vr)==`function`?eX:Object,typeof(tX=GY!==void 0&&GY)==`function`?tX:Object,typeof(nX=KY!==void 0&&KY)==`function`?nX:Object,typeof(rX=qY!==void 0&&qY)==`function`?rX:Object,typeof(iX=yr!==void 0&&yr)==`function`?iX:Object,typeof(aX=_h!==void 0&&_h)==`function`?aX:Object])],oX)})),sX,ihe=o((()=>{mU(),w(),O(),sX=class extends pU{init(){this._key=`LazyFloorMultiplier`,this._lookup=`BPFLMULT2`}get result(){return this._result}},sX=D([C()],sX)})),cX,lX,uX,dX,fX,pX,mX,hX,ahe=o((()=>{w(),jc(),$(),xu(),ihe(),ei(),Wn(),Zn(),Wr(),EY(),B(),br(),vh(),j(),E(),O(),hX=class extends TY{constructor(e,t,n,r,i,a,o){super(e,t),this._config=e,this._prebidMethods=t,this._floorsExperiment=n,this._slotManagerEventBus=r,this._lazyFloorMultiplierExperiment=i,this._floorsEventBus=a,this._slots=o,T(this,`floorsType`,Hn.lazyBidPool),T(this,`_enabledAdUnits`,[F.Content,F.Recipe,F.Below_Post])}init(){this._slotManagerEventBus.requestingBids.on(e=>this.handleRequestingBids(e))}handleRequestingBids(e){let t=this._slots.get(e)||[];this._prebidMethods.addToQueue(()=>{this._setLazyBidPoolFloors(t.filter(e=>this._enabledAdUnits.includes(e.location)&&!e.refreshCount&&e.lazy&&e.bidPoolId).map(e=>({adUnitCode:e.id,refreshCount:e.refreshCount,bidPoolId:e.bidPoolId})))})}_getLazyMultiplier(){let e=this._lazyFloorMultiplierExperiment.result;return typeof e==`number`?e:1}_getFloorValue(e,t,n,r){this._updateBidTTL(e,t,r);let[i]=r?this._prebidMethods.getHighestCpmBidsForPoolId(r):this._prebidMethods.getHighestCpmBids(e),a=(i==null?void 0:i.cpm)*n;return a}_setLazyBidPoolFloors(e){let t=this._getDefaultFloorConfig(),n=this._getLazyMultiplier();for(let r of e){let{adUnitCode:e,bidPoolId:i}=r,a=Yr(),o=this._getFloorValue(e,a,n,i);o&&this._setValues(t,e,o),this._floorsEventBus.storeModuleFloorData.emit({floorData:t,type:this.floorsType,code:r.adUnitCode})}}get active(){return this.enabled}get enabled(){return this._floorsExperiment.result.legacy===!0}},hX=D([Q(`FloorsLazyBidPoolComponent`),S(),A(`design:paramtypes`,[typeof(cX=z!==void 0&&z)==`function`?cX:Object,typeof(lX=R!==void 0&&R)==`function`?lX:Object,typeof(uX=bu!==void 0&&bu)==`function`?uX:Object,typeof(dX=Ur!==void 0&&Ur)==`function`?dX:Object,typeof(fX=sX!==void 0&&sX)==`function`?fX:Object,typeof(pX=yr!==void 0&&yr)==`function`?pX:Object,typeof(mX=_h!==void 0&&_h)==`function`?mX:Object])],hX)})),gX,_X,vX,yX,bX,xX,SX,CX,wX,TX,EX,DX,OX,ohe=o((()=>{Tu(),w(),H(),Xme(),$me(),rhe(),ahe(),B(),X(),jc(),vh(),rU(),$(),br(),LO(),j(),E(),O(),OX=class extends V{get prioritizedFloorsByUnit(){return this._prioritizedFloorsByUnit}get floorAbbrv(){return this._floorAbbrv}get skipAbbrv(){return this._skipAbbrv}constructor(e,t,n,r,i,a,o,s,c,l,u,d){super(),this._config=e,this._floorsConfig=t,this._prebidMethods=n,this._prebidEventBus=r,this._slotEventBus=i,this._videoEventBus=a,this._floorsEventBus=o,this._slots=d,T(this,`_prioritizedFloorsByUnit`,new Map),T(this,`_raptiveFloors`,void 0),T(this,`_floorPriority`,this._config.floors.cmPriority),T(this,`_floorResetTypes`,[Hn.refresh,Hn.lazyBidPool,Hn.lazy]),T(this,`_vidDiscountRules`,{}),T(this,`_host`,window.location.hostname),T(this,`_floorAbbrv`,{[Hn.refresh]:`lr`,[Hn.lazyBidPool]:`lbp`,[Hn.lazy]:`ll`,[Hn.session]:`ls`}),T(this,`_skipAbbrv`,{random:`sr`,not_found:`se`,session:`sks`,lazy:`sl`}),T(this,`_refreshFloors`,new Map),T(this,`_auctionFloors`,new Map),T(this,`_floorsComponents`,void 0),T(this,`_activeFloorComponentTargeting`,[]),this._floorsComponents=[s,c,l,u].filter(e=>e.enabled)}init(){this._setupEventListeners(),this._setVideoDiscountRules(),this._initiateSubComponents()}_initiateSubComponents(){this._floorsComponents.forEach(e=>{var t;let n=e.floorsType,r=n!==`raptive`;e.init(),e.active&&(this._floorsConfig.addActiveFloorsType(n),r&&this._activeFloorComponentTargeting.push(((t=this._floorAbbrv[n])==null?n:t).slice(0,2)))})}getDefaultFloorConfig(){return{...nO(this._floorsConfig.defaultFloorData)}}_setupEventListeners(){let{fbrap:e,legacy:t}=this._floorsConfig.floorsExperiment,n=t||e,r=n?`on`:`once`;this._handleAuctionRequestEvents(r),this._handleAuctionEndEvents(n),this._handleFloorEvents(),this._handleAddedEvent()}_handleAddedEvent(){let e=this._activeFloorComponentTargeting;this._slotEventBus.addSlots.on(t=>{let n=this._slots.get(t);n.forEach(t=>t.setSlotTargetingFlag(`fle`,e,!0))}),this._videoEventBus.videoPlayerAdded.on(t=>{t.forEach(t=>t.eligibleFloorComponents=e)})}_handleFloorEvents(){this._floorsEventBus.storeModuleFloorData.on(e=>this._storeLegacyFloorData(e)),this._floorsEventBus.storeRaptiveFloorData.on(e=>this._storeRaptiveFloorData(e)),this._floorsEventBus.setAuctionFloorData.on(e=>this._setAuctionFloorData(e)),this._floorsEventBus.clearAllFloorData.on(()=>{this._handleClearAllFloorData()})}_handleAuctionRequestEvents(e){e?(this._slotEventBus.preRequestBids[e](this._setBannerAuctionFloor.bind(this)),this._videoEventBus.preRequestVideoBids[e](this._setVideoAuctionFloor.bind(this))):this._setLocationAuctionFloor()}_handleAuctionEndEvents(e){this._prebidEventBus.auctionEnd.on(t=>this._handleAuctionEnd(t,e)),this._slotEventBus.auctionsCompleted.on(e=>this._handleSlotAuctionComplete(e)),this._videoEventBus.auctionsCompleted.on(e=>this._handleVideoAuctionComplete(e))}_storeLegacyFloorData(e){let t=e.cpm;if(t&&this._refreshFloors.set(e.code,t),!Object.keys(e.floorData.values||{}).length)return;let n=this._prioritizedFloorsByUnit.get(e.code),r={...n,[e.type]:{floorData:e.floorData,...t&&{cpm:t}}};this._prioritizedFloorsByUnit.set(e.code,r)}_storeRaptiveFloorData(e){this._raptiveFloors=e}_setAuctionFloorData({auctionId:e,price:t,floorData:n,bidder:r}){this._auctionFloors.set(e,{price:t,floorData:n,bidder:r})}_handleAuctionEnd(e,t){t&&e.adUnitCodes.forEach(e=>this._clearRefreshFloorValue(`${this._host}|${e}`))}_handleSlotAuctionComplete(e){let t=this._slots.get(e);t.forEach(e=>{this._clearRefreshFloorValue(e.id),this._setSlotFloorTargeting(e)})}_handleVideoAuctionComplete(e){e.forEach(e=>{this._clearRefreshFloorValue(e.name),this._setVideoFloorTargeting(e)})}_handleClearAllFloorData(){this._prioritizedFloorsByUnit=new Map}_setVideoDiscountRules(){Object.keys(vW).forEach(e=>{let t=`${this._host}|${vW[e]}`;this._vidDiscountRules[t]=1e-5})}_getCombinedLegacyData(e,t){let n=this.getDefaultFloorConfig();n.modelVersion=`legacy.${t}`;for(let e of this._prioritizedFloorsByUnit.values())for(let t of this._floorPriority){var r;let i=(r=e[t])==null?void 0:r.floorData;if(i){n.values={...n.values||{},...i.values},n.modelWeight=100;break}}return n.values={...n.values,...e.values},n}_clearRefreshFloorValue(e){this._floorResetTypes.forEach(t=>{var n;let r=this._prioritizedFloorsByUnit.get(e),i=r==null||(n=r[t])==null?void 0:n.floorData,a=i==null?void 0:i.values[e];i&&a&&(delete r[t],this._config.floors.savePriorityFloorData(e,i,t))})}_awaitRaptiveMLFloorsLoaded(){return this._config.floors.raptiveMLFloorsEventPromise}async _setBannerAuctionFloor(e){this._config.floors.raptiveMLFloorsLoaded||await this._awaitRaptiveMLFloorsLoaded();let t=this._slots.get(e);t.forEach(e=>{var t;let n=(t=e.prebidAdUnit)==null||(t=t[0])==null?void 0:t.code;this._setLocationAuctionFloor(n,e)})}async _setVideoAuctionFloor(e){this._config.floors.raptiveMLFloorsLoaded||await this._awaitRaptiveMLFloorsLoaded(),e.videos.forEach(e=>{let t=e.name;this._setLocationAuctionFloor(t,e)})}_setLocationAuctionFloor(e,t){!e||!t||this._setAuctionFloor(e,t)}_setAuctionFloor(e,t){var n;let r={},i=this._raptiveFloors,a=this._floorPriority;this._setLegacyFloorValues(r,a,e,t),r={floors:i,type:Hn.raptive,...r};let o=this._excludeSettingFloors(r.type);(n=r.floors)!=null&&n.modelGroups.length?(this._setAmazonFloors(r.floors,r.floors.currency,r.type,o),this._setPrebidFloors(r.floors,r.type,r.type===Hn.raptive,o)):(this._setPrebidFloors(this._getBackupFloorValues(),Hn.fallback,!1),this._setAmazonFloors(this._getBackupFloorValues(),`USD`,r.type))}_setLegacyFloorValues(e,t,n,r){let i=[],a=!1;for(let r=0;r<=t.length;r++){var o,s;let c=(o=this._prioritizedFloorsByUnit.get(n))==null||(o=o[t[r]])==null?void 0:o.floorData,l=c==null||(s=c.values)==null?void 0:s[`${this._host}|${n}`];l&&(a||(e.floors=this._getLegacyFloorsSchema(c,t[r]),e.type=t[r]),i.push(t[r]),a=!0)}let c=i.map(e=>{var t;return((t=this._floorAbbrv[e])==null?e:t).slice(0,2)});`id`in r?r.setSlotTargetingFlag(`fla`,c.length?c:[`none`],!0):r.appliedFloorComponents=c}_getBackupFloorValues(){let e=this._getLegacyFloorsSchema({values:{...this._vidDiscountRules},schema:{}},Hn.fallback);return e}_getLegacyFloorsSchema(e,t){let n=this._getCombinedLegacyData(e,t),r=Hn.lazy===t||Hn.session===t?1:0,i=this._config.floors,a=!i.floorsExperiment.fbrap&&i.floorsData||{floorProvider:`legacy`,floorProviderType:t,floorsSchemaVersion:2,currency:`USD`,modelGroups:[{modelWeight:100,modelVersion:`legacy`,...n,skipRate:r}]};return a}_excludeSettingFloors(e){if(!e||e&&!this._config.floors.floorsTypeExcludes.has(e))return!1;let{ccpa:t,gdpr:n}=this._config,r=t.enabled&&t.ccpaOptOut===t.privacyString,i=n.enabled&&n.revokedPurposeConsent,a=e&&(r||i);return a}_setPrebidFloors(e,t,n,r=!1){let i=r?{}:{floors:{enforcement:{enforceJS:!1},data:e,...n&&{additionalSchemaFields:this._config.floors.customSchemaFields}}};this._prebidMethods.setConfig(i,!1)}_setAmazonFloors(e,t=`USD`,n=``,r=!1){var i;let a=[],o=(e==null||(i=e.modelGroups)==null?void 0:i[0])||{},s=(o==null?void 0:o.values)||{},c=n===`raptive`;Object.keys(s).forEach(e=>{var n;let i=e.split(`|`),o=i.length&&i[c?(n=this._config.floors.getSchemaFieldOrder(`adUnitCode`))==null?1:n:1]||e,l=o;if(c&&i.length>2){let e=i[this._config.floors.getSchemaFieldOrder(`hvp`)||1];l=`${o}-${e}`}a.push({code:l.toLowerCase(),value:r?0:s[e],currency:t||`USD`})}),this._floorsEventBus.setAmazonFloors.emit(a)}_getTargetingValue(e){var t;let n=e==null?void 0:e.modelVersion,r=(t=e.floorProviderType)==null?n==null?void 0:n.replace(`legacy.`,``):t,i=(e==null?void 0:e.floorProvider)===`legacy`&&(r&&this._floorAbbrv[r]||`L`),a=!1;e!=null&&e.skipped&&(a=this._skipAbbrv[e.skippedReason]||`s`,a===`se`&&M.event(`Floors`,`_getTargetingValue`,`fv:se`));let o=i?-1:n&&(e==null?void 0:e.modelTimestamp)||0,s=a||i||n||`none`;return{modelVersion:s,modelTimestamp:o,isLegacy:i}}_getLoggedFloorValuesForAdUnit(e,t){let n=t?`:`:`%3A`,r=[];return this._config.floors.activeFloorsTypes.forEach(t=>{var i,a,o,s;let c=this._prioritizedFloorsByUnit.get(e),l=c==null||(i=c[t])==null?void 0:i.cpm,u=c==null||(a=c[t])==null?void 0:a.floorData,d=l||((o=u==null||(s=u.values)==null?void 0:s[`${this._host}|${e}`])==null?0:o);d&&r.push(`${Un[t]}${n}${d.toFixed(4)}`)}),r.length,r}_getFloorTargeting(e,t){var n,r;let i=t?(n=t.prebidAdUnit)==null?void 0:n[0]:this._getVideoPlayerPrebidUnit(e),a=this._getLoggedFloorValuesForAdUnit(e,!0),{floorPrice:o,floorData:s,bidder:c}=this.getAuctionFloors(i==null?void 0:i.lastAuctionId),{modelVersion:l,modelTimestamp:u,isLegacy:d}=this._getTargetingValue(s);r=s==null?void 0:s.skipped;let f=!d&&Number(u)>=0;return{bidder:c,fcv:a,floorPrice:o,modelTimestamp:u,modelVersion:l,shouldSendModelTimestamp:f}}_getVideoPlayerPrebidUnit(e){return(this._prebidMethods.isPrebidLoaded()&&this._prebidMethods.getPrebidAdUnits()||[]).filter(t=>t.code===e)[0]}_setSlotFloorTargeting(e){let{bidder:t,fcv:n,floorPrice:r,modelTimestamp:i,modelVersion:a,shouldSendModelTimestamp:o}=this._getFloorTargeting(e.id,e);e.setSlotTargetingFlag(`fv`,[a],!0),e.setSlotTargetingFlag(`hbf`,[r],!0),e.setSlotTargetingFlag(`hbb`,[t==null?`none`:t],!0),o&&e.setSlotTargetingFlag(`flrti`,[`${i}`],!0),n.length&&e.setTargeting({key:`fcv`,value:n})}_setVideoFloorTargeting(e){let t=e.name,{fcv:n,floorPrice:r,modelTimestamp:i,modelVersion:a,shouldSendModelTimestamp:o}=this._getFloorTargeting(t),s={fv:a,hbf:r,...n.length&&{fcv:n},...o&&{flrti:`${i}`}};this._config.video.setVideoFlagSlot(t,s)}getAuctionFloors(e){let{price:t,floorData:n,bidder:r}=e&&this._auctionFloors.get(e)||{},i=n||{},a=n==null?void 0:n.skipped,o=!a&&t?t.toFixed(4):`none`;return{floorPrice:o,floorData:i,bidder:r}}},OX=D([S(),A(`design:paramtypes`,[typeof(gX=z!==void 0&&z)==`function`?gX:Object,typeof(_X=wu!==void 0&&wu)==`function`?_X:Object,typeof(vX=R!==void 0&&R)==`function`?vX:Object,typeof(yX=Pr!==void 0&&Pr)==`function`?yX:Object,typeof(bX=Vr!==void 0&&Vr)==`function`?bX:Object,typeof(xX=eU!==void 0&&eU)==`function`?xX:Object,typeof(SX=yr!==void 0&&yr)==`function`?SX:Object,typeof(CX=hX!==void 0&&hX)==`function`?CX:Object,typeof(wX=jY!==void 0&&jY)==`function`?wX:Object,typeof(TX=WY!==void 0&&WY)==`function`?TX:Object,typeof(EX=oX!==void 0&&oX)==`function`?EX:Object,typeof(DX=_h!==void 0&&_h)==`function`?DX:Object])],OX)})),she=o((()=>{ohe()})),kX,AX,jX,MX,che=o((()=>{w(),B(),$(),H(),rU(),j(),E(),O(),MX=class extends V{constructor(e,t,n){super(),this._config=e,this._spaEventBus=t,this._footerConfigEventBus=n,T(this,`_footerClassNames`,[`adthrive-comscore`,`adthrive-footer-message`]),T(this,`_footer`,{}),this._added()}start(){if(this._config.footer.elements.length){this._footer=document.createElement(`div`),this._footer.classList.add(...this._footerClassNames),this._config.footer.elements.sort((e,t)=>e.order-t.order).forEach(({element:e})=>{e instanceof Element?this._footer.insertAdjacentElement(`beforeend`,e):this._footer.insertAdjacentHTML(`beforeend`,e)});let e=this._config.adOptions.footerSelector===``?`.adthrive-mobile #page-wrapper`:this._config.adOptions.footerSelector,t=document.querySelector(e)||document.body;t.insertAdjacentElement(`beforeend`,this._footer),this._setupListeners()}}_setupListeners(){this._spaEventBus.routeChanged.once(()=>{let e=document.querySelector(`.${this._footerClassNames.join(`.`)}`);e||this.start()})}_added(){this._footerConfigEventBus.footerElementAdded.on(e=>{this._config.footer.elements.push(e)},{handleEventsAlreadyEmitted:!0})}},MX=D([Q(`FooterComponent`),S(),A(`design:paramtypes`,[typeof(kX=z!==void 0&&z)==`function`?kX:Object,typeof(AX=zr!==void 0&&zr)==`function`?AX:Object,typeof(jX=xr!==void 0&&xr)==`function`?jX:Object])],MX)})),lhe=o((()=>{che()})),NX,PX,FX,IX,LX,RX,zX,BX,VX,uhe=o((()=>{w(),B(),$(),jc(),H(),FS(),rU(),X(),Bh(),Yi(),Z(),j(),O(),VX=class extends V{constructor(e,t,n,r,i,a,o,s){super(),this._config=e,this._googleAdManagerEventBus=t,this._prebidMethods=n,this._prebidEventBus=r,this._slotManager=i,this._slotEventBus=a,this._videoEventBus=o,this._amazonMethods=s}init(){this._slotEventBus.triggerRenderOutsideGam.on(this._onTriggerRenderOutsideGam.bind(this)),this._googleAdManagerEventBus.slotRenderEnded.on(this._slotRenderedHandler.bind(this)),this._prebidEventBus.bidWon.on(this._bidWonEventHandler.bind(this)),this._videoEventBus.triggerRenderVideoAdOutsideGam.on(this._onTriggerRenderVideoAdOutsideGam.bind(this))}_slotRenderedHandler({event:e,slotId:t}){let n=this._slotManager.getSlot(t);if(!n)return;let r=[F.Native_Recipe,F.Interstitial],i=this._isGAMDisabled(n);(e.isEmpty||i)&&!r.includes(n.location)&&this._onTriggerRenderOutsideGam(n.id)}_bidWonEventHandler(e){let t=this._getSlot(e);t&&this._isGAMDisabled(t)&&this._handleGptLibFailedToLoad(e,t)}_handleGptLibFailedToLoad(e,t){this._slotEventBus.adRenderedOutsideGAM.emit({bidResponse:e,slotId:t.id})}_getSlot(e){return this._slotManager.getSlot(e.sharedBidInUse||e.adUnitCode)}_isGAMDisabled(e){var t;return!(!(e==null||(t=e.googleTagSlot)==null)&&t.getResponseInformation())}_onTriggerRenderOutsideGam(e){this.clearSharedBidPool(e),this._config.gdpr.enabled||(M.event(`GoogleAdManagerFallbackComponent`,`init`,`slotIsEmpty`,`adding prebid render to queue`),this.renderSlotOutsideGAM(e))}clearSharedBidPool(e){this._prebidMethods.clearTargetingForSharedBidPool(e)}_playVideoAd(e,t){this._videoEventBus.videoAdRenderingOutsideGam.emit(e.name),e.imaManager.requestAd({adTagUrl:t})}_getVideoAdUrl(e){let t=``;if(e&&`vastUrl`in e&&e.vastUrl)t=e.vastUrl,t.includes(`uuid=undefined`)&&`videoCacheKey`in e&&e.videoCacheKey&&(t=t.replace(`uuid=undefined`,`uuid=${e.videoCacheKey}`));else if(e&&`amznbid`in e&&e.amznbid&&e.amzniid){let n=e,r=cr(0,1e9);t=`https://aax.amazon-adsystem.com/e/dtb/vast?b=${n.amzniid}&rnd=${r}&pp=${n.amznbid}`}return t}_onTriggerRenderVideoAdOutsideGam({player:e,topBid:t}){let n=this._getVideoAdUrl(t);n&&this._playVideoAd(e,n)}_createGoogleAdManagerFallbackDiv(e){e.iframe=this._createGoogleAdManagerFallbackIframe();let t=document.createElement(`div`);t.className=`google-ad-manager-fallback-container`,t.style.margin=`auto`,e.location===F.Video_StickyOutstream&&(t.style.height=`0`,e.iframe.style.width=`0`,e.iframe.style.height=`0`),t.appendChild(e.iframe),this._clearSlotDiv(e),e.element.children.length<2&&e.element.appendChild(t),this._slotEventBus.googleAdManagerFallbackDivAdded.emit(e.id)}_createEmptyFallbackDiv(e){var t;let n=document.createElement(`div`);n.className=`google-ad-manager-fallback-container`,n.style.margin=`auto`,n.style.height=`0`,this._clearSlotDiv(e),((t=e.element)==null?void 0:t.children.length)<2&&e.element.appendChild(n),this._slotEventBus.googleAdManagerFallbackDivAdded.emit(e.id)}_clearSlotDiv(e){var t;let n=(t=e.element)==null?void 0:t.firstElementChild;(n==null?void 0:n.className)===`google-ad-manager-fallback-container`&&e.element.removeChild(n)}_createGoogleAdManagerFallbackIframe(){let e=document.createElement(`iframe`);return e.style.border=`0`,e.style.display=`inline!important`,e.scrolling=`no`,e.frameBorder=`0`,e.marginHeight=`0`,e.marginWidth=`0`,e.style.height=`1`,e.style.width=`1`,e}_getTopPrebidBid(e){var t,n,r;let{slotId:i,bidPoolId:a,passiveBidPoolId:o}=e,s=a?((t=this._prebidMethods.getBidResponsesForBidPoolId(a))==null||(t=t.bids.filter(e=>e.status!==`rendered`&&e.mediaType!==`native`&&!e.sharedBidInUse).sort((e,t)=>t.cpm-e.cpm))==null?void 0:t[0])||((n=this._prebidMethods.getHighestCpmBidsForPoolId(a))==null?void 0:n[0]):(r=this._prebidMethods.getHighestCpmBids(i))==null?void 0:r[0];return s&&(a||o)&&(s.sharedBidInUse=i),s}renderSlotOutsideGAM(e){this._prebidMethods.addToQueue(()=>{let t=this._slotManager.getSlot(e);if(!t)return;let n=this._getTopBid(t);if(!n){this._createEmptyFallbackDiv(t),this._slotEventBus.gamEmptyNoBidResponse.emit(e);return}this._createGoogleAdManagerFallbackDiv(t),this._removePreviousSiblingDiv(t),this._setDisplayProperty(t),this._emitEventAndRenderAd(t,n)})}_getAmazonBidData(e){let t=this._config.amazon.availableBids.get(e.id);if(!t)return;let n=t.pmpCpm&&t.cpm<t.pmpCpm;return n?{amznbid:t.pmpAmznBid,amzniid:t.pmpAmazoniid,bidder:t.pmpBidder,cpm:t.pmpCpm,deal:t.pmpDeal,mediaType:t.pmpMediaType,size:t.pmpSize,slotID:t.slotID}:{amznbid:t.amznbid,amzniid:t.amzniid,bidder:t.bidder,cpm:t.cpm,mediaType:t.mediaType,size:t.size,slotID:t.slotID}}_getTopBid(e){let t=this._getTopPrebidBid({slotId:e.id,bidPoolId:e.bidPoolId,passiveBidPoolId:e.passiveBidPoolId}),n=this._getAmazonBidData(e);if(!(!t&&!n))return!t||n&&n.cpm>t.cpm?n:t}_removePreviousSiblingDiv(e){let t=e.iframe&&e.iframe.parentElement;if(t){let e=t.previousSibling;e==null||e.remove()}}_setDisplayProperty(e){let t=document.getElementById(e.element.id);t==null||t.style.setProperty(`display`,`block`)}_emitEventAndRenderAd(e,t){var n;let r=(n=e.iframe)==null||(n=n.contentWindow)==null?void 0:n.document,i=jK(t);if(r){if(this._slotEventBus.adRenderingOutsideGAM.emit({bidResponse:t,slotId:e.id}),e.location===F.Video_StickyOutstream&&i)return;i?this._amazonMethods.renderImp(r,t.amzniid).catch(()=>{M.error(`GoogleAdManagerFallback`,`_emitEventAndRenderAd`,` Failed to render Amazon impression`)}):this._prebidMethods.renderAd(r,t.adId)}}},VX=D([Q(`GoogleAdManagerFallbackComponent`),S(),A(`design:paramtypes`,[typeof(NX=z!==void 0&&z)==`function`?NX:Object,typeof(PX=zh!==void 0&&zh)==`function`?PX:Object,typeof(FX=R!==void 0&&R)==`function`?FX:Object,typeof(IX=Pr!==void 0&&Pr)==`function`?IX:Object,typeof(LX=PS!==void 0&&PS)==`function`?LX:Object,typeof(RX=Vr!==void 0&&Vr)==`function`?RX:Object,typeof(zX=eU!==void 0&&eU)==`function`?zX:Object,typeof(BX=Ji!==void 0&&Ji)==`function`?BX:Object])],VX)})),dhe=o((()=>{uhe()})),HX,fhe=o((()=>{HX={"000000":`A`,"000001":`B`,"000010":`C`,"000011":`D`,"000100":`E`,"000101":`F`,"000110":`G`,"000111":`H`,"001000":`I`,"001001":`J`,"001010":`K`,"001011":`L`,"001100":`M`,"001101":`N`,"001110":`O`,"001111":`P`,"010000":`Q`,"010001":`R`,"010010":`S`,"010011":`T`,"010100":`U`,"010101":`V`,"010110":`W`,"010111":`X`,"011000":`Y`,"011001":`Z`,"011010":`a`,"011011":`b`,"011100":`c`,"011101":`d`,"011110":`e`,"011111":`f`,1e5:`g`,100001:`h`,100010:`i`,100011:`j`,100100:`k`,100101:`l`,100110:`m`,100111:`n`,101e3:`o`,101001:`p`,101010:`q`,101011:`r`,101100:`s`,101101:`t`,101110:`u`,101111:`v`,11e4:`w`,110001:`x`,110010:`y`,110011:`z`,110100:`0`,110101:`1`,110110:`2`,110111:`3`,111e3:`4`,111001:`5`,111010:`6`,111011:`7`,111100:`8`,111101:`9`,111110:`-`,111111:`_`}})),UX,WX,GX,KX,qX,JX,YX,XX,ZX,phe=o((()=>{w(),H(),$(),X(),Ra(),rU(),wq(),ew(),fhe(),Da(),li(),ya(),j(),E(),O(),ZX=class extends V{constructor(e,t,n,r,i,a,o,s){super(),this._gpc=e,this._ccpa=t,this._usCMP=n,this._context=r,this._ccpaComponent=i,this._ortb2=a,this._spaEventBus=o,this._consentEventBus=s,T(this,`ccpaRequired`,this._ccpa.required),T(this,`ccpaNotApplicable`,this._ccpa.ccpaNotApplicable),T(this,`gpcEnabled`,this._gpc.gpcEnabled),T(this,`gpcUpdated`,!1),T(this,`globalPrivacyControl`,window.navigator.globalPrivacyControl),T(this,`_sectionList`,[6,7]),T(this,`_supportedAPIs`,[`6:uspv1`,`7:usnat`]),T(this,`_usnatFieldOrder`,Object.values(Gn)),T(this,`_usnatFields`,new Map([[Gn.Version,{unencodedVal:1,fieldValLength:6}],[Gn.SharingNotice,{unencodedVal:1,fieldValLength:2}],[Gn.SaleOptOutNotice,{unencodedVal:1,fieldValLength:2}],[Gn.SharingOptOutNotice,{unencodedVal:1,fieldValLength:2}],[Gn.TargetedAdvertisingOptOutNotice,{unencodedVal:1,fieldValLength:2}],[Gn.SensitiveDataProcessingOptOutNotice,{unencodedVal:0,fieldValLength:2}],[Gn.SensitiveDataLimitUseNotice,{unencodedVal:0,fieldValLength:2}],[Gn.SaleOptOut,{fieldValLength:2,optIn:Kn.OptedIn,optOut:Kn.OptedOut}],[Gn.SharingOptOut,{fieldValLength:2,optIn:Kn.OptedIn,optOut:Kn.OptedOut}],[Gn.TargetedAdvertisingOptOut,{fieldValLength:2,optIn:Kn.OptedIn,optOut:Kn.OptedOut}],[Gn.SensitiveDataProcessing,{unencodedVal:[0,0,0,0,0,0,0,0,0,0,0,0],fieldValLength:24}],[Gn.KnownChildSensitiveDataConsents,{unencodedVal:[0,0],fieldValLength:4}],[Gn.PersonalDataConsents,{unencodedVal:0,fieldValLength:2}],[Gn.MspaCoveredTransaction,{unencodedVal:2,fieldValLength:2}],[Gn.MspaOptOutOptionMode,{unencodedVal:0,fieldValLength:2}],[Gn.MspaServiceProviderMode,{unencodedVal:0,fieldValLength:2}],[Gn.SubSectionType,{unencodedVal:0,fieldValLength:2}],[Gn.Gpc,{unencodedVal:!!navigator.globalPrivacyControl,fieldValLength:1}]])),T(this,`_pingData`,this._setPingData()),T(this,`_sections`,this._setSections())}init(){var e,t;let n=[...((e=window.__gpp)==null?void 0:e.events)||[]],r=[...((t=window.__gpp)==null?void 0:t.queue)||[]];window.__gpp=this._gpp.bind(this),window.__gpp.queue=r,this._usCMP.required?this._consentEventBus.usCmpConsentCaptured.on(()=>{this._initializeCoreGPPFunctions()},{handleEventsAlreadyEmitted:!0}):this._initializeCoreGPPFunctions(),n.forEach(e=>{this._addEventListener(e.callback,e.parameter||null)}),this._addLocatorFrame(),this._refreshPrivacyStrings(),this._spaEventBus.routeChanged.on(()=>{this._setPrebidGPPString()})}_setPingData(){return{gppVersion:`1.1`,cmpStatus:`loaded`,cmpDisplayStatus:`visible`,cmpId:1,supportedAPIs:this._supportedAPIs,signalStatus:this._usCMP.required&&this._usCMP.consent===null?`not ready`:`ready`,sectionList:this._sectionList,applicableSections:this._sectionList,gppString:this._createGPPString(),parsedSections:this._getParsedSections()}}_setSections(){return{tcfeuv1:null,tcfeuv2:null,"":null,"--":null,tcfca:null,uspv1:this._getParsedSections(),usnat:this._getUSNatObj(),usca:null,usva:null,usco:null,usut:null,usct:null}}_getParsedSections(){return{uspv1:this._ccpa.privacyString||null,usnat:this._getUSNatObj()}}_initializeCoreGPPFunctions(){this._enableEvents(),this._setPrebidGPPString(),this._refreshPingData()}_refreshPrivacyStrings(){this._pingData.gppString=this._createGPPString(),this._pingData.parsedSections&&this._pingData.parsedSections.uspv1&&(this._pingData.parsedSections.uspv1=this._callUSPAPI(`getUSPData`).uspString)}_refreshPingData(){this._usCMP.required?(this._pingData.signalStatus=this._usCMP.consent===null?`not ready`:`ready`,this._pingData.cmpDisplayStatus=this._usCMP.consent===null?`visible`:`hidden`):(this._pingData.signalStatus=`ready`,this._pingData.cmpDisplayStatus=`visible`)}_triggerEventCallbacks(e){let t=window.__gpp.events;if(t&&t.length){this._refreshPrivacyStrings();let n=this._pingData;t.forEach(t=>{let r={eventName:e,listenerId:t.id,data:this._getEventData(e),pingData:n};t.callback(r)})}}_getEventData(e){if(e===`sectionChange`)return this._supportedAPIs;if(e===`signalStatus`)return`ready`}_refreshGppData(){this._pingData=this._setPingData(),this._sections=this._setSections()}_enableEvents(){this._triggerEventCallbacks(`signalStatus`),this._ccpa.consentChange.on(()=>{this._refreshGppData(),this._triggerEventCallbacks(`sectionChange`),this._setPrebidGPPString(),this._triggerEventCallbacks(`signalStatus`)})}_setPrebidGPPString(){let e=this._createGPPString();this._ortb2.addOrtb2Reg(e,this._sectionList)}_addEventListener(e,t){window.__gpp=window.__gpp||{},window.__gpp.events=window.__gpp.events||[],`lastId`in window.__gpp||(window.__gpp.lastId=0),window.__gpp.lastId++;let n=window.__gpp.lastId;window.__gpp.events.push({id:n,callback:e,parameter:t}),e({eventName:`listenerRegistered`,listenerId:n,data:!0,pingData:this._pingData},!0)}_removeEventListener(e,t){let n=!1,r=t;window.__gpp=window.__gpp||{},window.__gpp.events=window.__gpp.events||[];for(let e=0;e<window.__gpp.events.length;e++)if(window.__gpp.events[e].id==r){window.__gpp.events.splice(e,1),n=!0;break}e({eventName:`listenerRemoved`,listenerId:r,data:n},!0)}_createUSNatString(){let e=this._usnatFieldOrder.reduce((e,t)=>`${e}${this._getUSNatData(t,!0)}`,``);if(e.length<66){let t=66-e.length;for(let n=0;n<t;n++)e=`${e}0`}let t=e.match(/.{6}/g);return(t||[]).map(e=>HX[e]||`A`).join(``)}_padStart(e,t){return e.padStart?e.padStart(t,`0`):`${e}${Array(t).join(`0`)}`}_encodedUSNat(e,t){let n=this._usnatFields.get(e)&&this._usnatFields.get(e).fieldValLength||0,r=(t>>>0).toString(2);return this._padStart(r,n)}_getUSNatData(e,t=!1){let n=this._usnatFields.get(e);if(!n)return``;if(n.unencodedVal!==void 0)return t?this._encodedUSNat(e,n.unencodedVal):n.unencodedVal;let r=this._ccpa.privacyString===this._ccpa.ccpaOptOut?n.optOut:n.optIn;return t?this._encodedUSNat(e,r||`0`):r}_getUSNatObj(){return this._usnatFieldOrder.map(e=>{let t=this._getUSNatData(e);return{[e]:t}}).reduce((e,t)=>({...e,...t}),{})}_getGPPData(){return{sectionId:3,gppVersion:1.1,sectionList:this._sectionList,applicableSections:this._sectionList,gppString:this._createGPPString(),pingData:this._pingData}}_hasSection(e){return!!this._sections[e]}_getSection(e){return this._sections[e]?this._sections[e]:null}_callUSPAPI(e){return this._ccpaComponent.uspapi(e,1,(e,t)=>{if(t)return e})}_getField(e){let t=e.split(`.`),n=t[0],r=t[1];if(this._hasSection(n)){if(n===`uspv1`)return this._callUSPAPI(r);if(n===`usnat`)return this._getUSNatData(r)}else return null}_addLocatorFrame(){if(document.getElementById(`__gppLocator`)===null){let e=document.createElement(`iframe`);e.style.display=`none`,e.id=`__gppLocator`,e.name=`__gppLocator`,document.body.appendChild(e),window.__gpp_msghandler=e=>{let t=typeof e.data==`string`,n;try{n=t?JSON.parse(e.data):e.data}catch(e){n=null}if(typeof n==`object`&&n&&`__gppCall`in n){let r=n.__gppCall;window.__gpp(r.command,(n,i)=>{let a={__gppReturn:{returnValue:n,success:i,callId:r.callId}};e.source.postMessage(t?JSON.stringify(a):a,`*`)},r.parameter)}}}(!(`__gpp`in window)||typeof window.__gpp!=`function`)&&(window.__gpp=window.__gpp_stub,window.addEventListener(`message`,window.__gpp_msghandler,!1),window.__gpp_addFrame(`__gppLocator`))}_createGPPString(){let e=this._callUSPAPI(`getUSPData`).uspString,t=this._createUSNatString();return`DBABzw~${e}~${t}`}_gpp(e,t,n){let r=typeof t==`function`;switch(e){case`ping`:return this._refreshGppData(),this._refreshPrivacyStrings(),r?t(this._pingData,!0):this._pingData;case`addEventListener`:return r?this._addEventListener(t,n):null;case`removeEventListener`:return r?this._removeEventListener(t,n):null;case`hasSection`:if(n){let e=this._hasSection(n);return r?t(e,!0):e}case`getSection`:if(n){let e=this._getSection(n);return r?t(e,!0):e}case`getField`:if(n){let e=this._getField(n);return r?t(e,!0):e}case`getGPPData`:return r?t(this._getGPPData()):this._getGPPData();default:break}}get enabled(){return this._context.country===`US`}},ZX=D([Q(`GPPComponent`),S(),A(`design:paramtypes`,[typeof(UX=va!==void 0&&va)==`function`?UX:Object,typeof(WX=Ea!==void 0&&Ea)==`function`?WX:Object,typeof(GX=ci!==void 0&&ci)==`function`?GX:Object,typeof(KX=L!==void 0&&L)==`function`?KX:Object,typeof(qX=Cq!==void 0&&Cq)==`function`?qX:Object,typeof(JX=$C!==void 0&&$C)==`function`?JX:Object,typeof(YX=zr!==void 0&&zr)==`function`?YX:Object,typeof(XX=_r!==void 0&&_r)==`function`?XX:Object])],ZX)})),QX=o((()=>{phe()})),$X,eZ,tZ,mhe=o((()=>{w(),$(),H(),vh(),Zn(),Wr(),j(),O(),tZ=class extends V{constructor(e,t){super(),this._slots=e,this._slotManagerEventBus=t}init(){let e=!1;this._slots.bidServed.on(t=>{t.servedPrebidBidResponse&&t.servedPrebidBidResponse.bidder===`gumgum`&&t.location===F.Footer&&(e=!0)}),this._slotManagerEventBus.refreshing.on(t=>{let n=this._slots.get(t),r=n.filter(e=>e.location===F.Footer);if(r&&e){var i;e=!1,typeof((i=window.GUMGUM)==null?void 0:i.removeISAd)==`function`&&window.GUMGUM.removeISAd()}})}},tZ=D([Q(`GumGumInScreenComponent`),S(),A(`design:paramtypes`,[typeof($X=_h!==void 0&&_h)==`function`?$X:Object,typeof(eZ=Ur!==void 0&&Ur)==`function`?eZ:Object])],tZ)})),hhe=o((()=>{mhe()})),nZ,ghe=o((()=>{$(),Rm(),w(),H(),O(),nZ=class extends V{init(){let e=U.readInternalLocalStorage(`adt_ei`);this._isStoredHemValid(e)||this._cleanUpStoredValue(e)}get enabled(){return!0}_isStoredHemValid(e){var t,n;let r=typeof e==`object`&&typeof(e==null?void 0:e.sha256Hash)==`object`,i=typeof e==`string`&&((t=(n=e.match(/sha256Hash/g))==null?void 0:n.length)==null?!1:t);return!r&&!i}_cleanUpStoredValue(e){let t=JSON.stringify(e),n=``,r=``,i=/sha256Hash":"(\w+)"/.exec(t),a=/sha1Hash":"(\w+)"/.exec(t);i&&i.length===2&&(n=i[1]),a&&a.length===2&&(r=a[1]);let o={sha256Hash:n,sha1Hash:r};U.setInternalLocalStorage(`adt_ei`,o)}},nZ=D([Q(`HemStorageCleanupComponent`),S()],nZ)})),rZ,iZ,aZ,oZ,sZ,_he=o((()=>{w(),B(),$(),Z(),H(),gs(),cw(),Tr(),rU(),j(),E(),O(),sZ=class extends V{constructor(e,t,n,r){super(),this._emailCaptureHandler=e,this._config=t,this._gdprEnforcement=n,this._identityEventBus=r,T(this,`_hasRun`,!1)}init(){this._identityEventBus.identityApiDataSubmitted.on(({data:e,cb:t})=>this.identityOptIn(e,t).catch(()=>{})),window.addEventListener(`message`,e=>{if(window===window.top&&e&&e.origin===window.origin&&e.data&&e.data.message===`adthriveIdentityAPI`&&e.data.info){let t={message:`adthriveIdentityFinished`,response:{}};this.identityOptIn(e.data.info,n=>{if(!(e.source instanceof MessagePort)&&!(e.source instanceof ServiceWorker)){var r;t.response=n,(r=e.source)==null||r.postMessage(t,e.origin)}}).catch(()=>{})}},!1)}start(){this._identityEventBus.identityApiReady.emit()}validateData(e){if(!e.source||typeof e.source!=`string`||e.source.length>20)throw Error(`source required with 20 characters or less`);if(!e.plainText&&!e.sha256&&!e.sha1)throw Error(`plainText, sha256 or sha1 required`);if(e.plainText&&(typeof e.plainText!=`string`||!HW(e.plainText)))throw Error(`plainText not string or not valid email: ${e.plainText}`);if(e.sha256&&(typeof e.sha256!=`string`||e.sha256.length!==64))throw Error(`sha256 not string or not encoded properly: ${e.sha256}`);if(e.sha1&&(typeof e.sha1!=`string`||e.sha1.length!==40))throw Error(`sha256 not string or not encoded properly: ${e.sha1}`)}categorizeSource(e){let t=e.source,n=t!==`slickstream`&&!(t!=null&&t.startsWith(I.PII_SOURCE.PREFIXES.SLICKSTREAM)),r=!(t!=null&&t.startsWith(I.PII_SOURCE.PREFIXES.HEM_CAPTURE)),i=![`url`,`urlh`,`urlhck`].includes(t||``);n&&r&&i&&(M.event(`IdentityAPI`,`optIn`,`source:${t}`),e.source=`api`)}buildPII(e){let t=e.source;t||(t=`api_unknown`,M.error(`IdentityAPI`,`buildPII`,`source not provided with: `,e)),this._emailCaptureHandler.checkSources(t);let n={source:`${t}${I.PII_SOURCE.SUFFIXES.CAPTURE}`,sourceCollectedDate:Bs()};return e.plainText&&(n.email=e.plainText),e.sha256&&(n.sha256Hash=e.sha256),e.sha1&&(n.sha1Hash=e.sha1),n}async identityOptIn(e,t){try{if(this._hasRun)throw Error(`Identity API Already Successfully Called`);if(this._config.ccpa.userOptedOut)throw Error(`User has opted out of CCPA`);if(this._config.gdpr.enabled){let e=await this._gdprEnforcement.checkConsentForVendor(this._config.gdpr.raptiveVendorId,[1]);if(!e)throw Error(`CafeMedia does not have Purpose 1 consent.`)}this.validateData(e),this.categorizeSource(e);let n=this.buildPII(e);this._emailCaptureHandler.emailCaptured.emit({pii:n,identityDataSource:`identityApi`}),t({success:!0,data:{message:`OK`}}),this._hasRun=!0}catch(e){t({success:!1,data:{message:e.message}})}}},sZ=D([Q(`IdentityAPIComponent`),S(),A(`design:paramtypes`,[typeof(rZ=hs!==void 0&&hs)==`function`?rZ:Object,typeof(iZ=z!==void 0&&z)==`function`?iZ:Object,typeof(aZ=ow!==void 0&&ow)==`function`?aZ:Object,typeof(oZ=Nr!==void 0&&Nr)==`function`?oZ:Object])],sZ)})),vhe=o((()=>{_he()})),cZ,lZ,uZ,dZ,fZ,pZ,yhe=o((()=>{w(),$h(),$(),Z(),H(),HS(),Bh(),rU(),vh(),LO(),j(),E(),O(),pZ=class extends V{constructor(e,t,n,r,i){super(),this._gam=e,this._videoEventProxy=t,this._gamEventBus=n,this._slotEventBus=r,this._slots=i,T(this,`_renderedSlotKey`,new Map),T(this,`_filterKeys`,new Set([`abgroup`,`pvk`,`bucket`,`branch`,`deployment`,`siteName`,`siteId`,`site_code`,`mcmp`,`sense`]))}init(){this._gamEventBus.slotRenderEnded.on(e=>this._bannerSlotRenderEnded(e)),this._videoEventProxy.videoSlotRendered.on(this._videoSlotRenderEnded.bind(this)),this._slotEventBus.adRenderedOutsideGAM.on(this._onRenderedOutsideGAM.bind(this)),this._slotEventBus.adRenderingOutsideGAM.on(this._onRenderingOutsideGAM.bind(this)),this._videoEventProxy.loggingBidWon.on(this._onVideoRenderedOutsideGAM.bind(this))}get enabled(){return!0}_onVideoRenderedOutsideGAM({topBid:e,vprenum:t,vastErrorCode:n}){this._onBidWonEvent(e,void 0,t,n)}_onRenderedOutsideGAM(e){this._onBidWonEvent(e.bidResponse,e.slot)}_onBidWonEvent(e,t,n,r){let i=t&&this._slots.get(t),a=this._createEventData(nO(e),i||void 0),o={};n!=null&&(o.vprenum=n),r!=null&&(o.vastErrorCode=r);let s={...a,...o};M.event(`ImpressionLogComponent`,`bidWon`,s)}_onRenderingOutsideGAM(e){jK(e.bidResponse)&&this._onBidWonEvent(e.bidResponse,e.slotId)}_getDecodedURI(e){try{return decodeURIComponent(e)}catch(e){return``}}_getTargetingData(e){let t=Hh(e.split(`?`)[1]);return{custParams:this._getDecodedURI(t.get(`cust_params`)||``),iu:t.get(`iu`)||``,sz:this._sizeStringToArray(t.get(`sz`))||[1,1]}}_sizeStringToArray(e){if(e)return e.split(`x`).map(e=>parseInt(e))}_bannerSlotRenderEnded({event:e,slotId:t}){let n=this._slots.get(t);if(!n)return;let r=e.slot.getAdUnitPath(),i=KK();this._renderedSlotKey.set(r,i);let a={adUnitPath:r,advertiserId:e.advertiserId,agnosticCreativeId:e.sourceAgnosticCreativeId,agnosticLineItemId:e.sourceAgnosticLineItemId,campaignId:e.campaignId,companyIds:e.companyIds,creativeId:e.creativeId,isEmpty:e.isEmpty,lineItemId:e.lineItemId,serviceName:e.serviceName,siteTargeting:this._filterTargeting(this._gam.getTargetingMap()),size:e.size,slotElementId:n.id,slotKey:i,slotTargeting:this._filterTargeting(n.getTargetingMap()),yieldGroupIds:e.yieldGroupIds,transactionId:n.transactionId};this._logImpressionEvent(a)}_videoSlotRenderEnded(e){let t=this._getTargetingData(e.tag),n={adUnitPath:t.iu,creativeId:e.gamCreativeId,isEmpty:e.isEmpty,lineItemId:e.gamLineItemId,size:t.sz,slotElementId:e.adUnitName,slotKey:KK(),slotTargeting:this._filterTargeting(Uh(t.custParams))};this._logImpressionEvent(n)}_filterTargeting(e){return Object.keys(e).filter(t=>!this._filterKeys.has(t)&&e[t].length).reduce((t,n)=>(t[n]=e[n],t),{})}_logImpressionEvent(e){M.event(`SlotRenderEnded`,`adImpression`,e)}_getPrebidData(e,t){let{adUnitCode:n,adserverTargeting:{hb_pb:r},bidder:i,adId:a,auctionId:o,width:s,height:c,cpm:l,meta:u,requestTimestamp:d,responseTimestamp:f,timeToRespond:p,expired:m,dealId:h,size:g,source:_,mediaType:v,ttl:y,originalCpm:b}=e;return{adUnitPath:n,adomain:(u==null?void 0:u.advertiserDomains)||[],hb_pb:r,bidder:i,adId:a,auctionId:o,width:s,height:c,cpm:l,requestTimestamp:d,responseTimestamp:f,timeToRespond:p,expired:m,dealId:h,size:g,source:_,mediaType:v,ttl:y,originalCpm:b,isEmpty:!0,...t&&{location:t.location,sequence:t.sequence,nref:t.refreshCount,...t.googleTagSlot&&{slotTargeting:this._filterTargeting(t.getTargetingMap())}}}}_getAmazonData(e,t){let{amzniid:n,bidder:r,deal:i,cpm:a,mediaType:o,size:s}=e,[c,l]=(s||``).split(`x`);return{amzniid:n,bidder:r,cpm:a,...i&&{deal:i},height:l,isEmpty:!0,mediaType:o===`default`?`banner`:o,size:s,width:c,...t&&{adUnitPath:t.id,location:t.location,sequence:t.sequence,nref:t.refreshCount,...t.googleTagSlot&&{slotTargeting:this._filterTargeting(t.getTargetingMap())}}}}_createEventData(e,t){let n=jK(e);return n?this._getAmazonData(e,t):this._getPrebidData(e,t)}},pZ=D([Q(`ImpressionLogComponent`),S(),A(`design:paramtypes`,[typeof(cZ=Zh!==void 0&&Zh)==`function`?cZ:Object,typeof(lZ=VS!==void 0&&VS)==`function`?lZ:Object,typeof(uZ=zh!==void 0&&zh)==`function`?uZ:Object,typeof(dZ=Vr!==void 0&&Vr)==`function`?dZ:Object,typeof(fZ=_h!==void 0&&_h)==`function`?fZ:Object])],pZ)})),bhe=o((()=>{yhe()})),mZ,xhe=o((()=>{w(),foe(),Lt(),j(),E(),O(),mZ=class extends ab{constructor(){super(),T(this,`selectors`,[`.wprm-recipe-jump-video`]),this.elements=Array.prototype.slice.call(document.querySelectorAll(this.selectors.join()))}start(e){let t=[];if(e){let e=e=>{let t=e.target.classList;M.event(`JumpToTracker`,`_logEvent`,ib.Video.toLowerCase(),t)};t.push(e)}this.init(t)}},mZ=D([S(),A(`design:paramtypes`,[])],mZ)})),hZ,She=o((()=>{w(),Ui(),E(),O(),hZ=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`JumpToTracker`,this._lookup=`JTTE`}},hZ=D([C()],hZ)})),gZ,_Z,vZ,yZ,bZ,xZ,Che=o((()=>{H(),Da(),ya(),sb(),xhe(),$(),w(),She(),j(),E(),O(),xZ=class extends V{constructor(e,t,n,r,i){super(),this._jumpToRecipeTracker=r,this._jumpToVideoTracker=i,T(this,`enableLogging`,void 0),this.enableLogging=!e.gpcEnabled&&!t.userOptedOut&&n.result}start(){this._jumpToRecipeTracker.start(this.enableLogging),this._jumpToVideoTracker.start(this.enableLogging)}},xZ=D([S(),Q(`JumpToTrackerComponent`),A(`design:paramtypes`,[typeof(gZ=va!==void 0&&va)==`function`?gZ:Object,typeof(_Z=Ea!==void 0&&Ea)==`function`?_Z:Object,typeof(vZ=hZ!==void 0&&hZ)==`function`?vZ:Object,typeof(yZ=ob!==void 0&&ob)==`function`?yZ:Object,typeof(bZ=mZ!==void 0&&mZ)==`function`?bZ:Object])],xZ)})),whe=o((()=>{Che()})),SZ,The=o((()=>{mU(),al(),Z(),w(),O(),SZ=class extends pU{init(){this._key=`FooterCloseButtonLocation`,this._lookup=`FCP`}isEnabled(){let e=il.isRolloutEnabled(`mobile-footer-close-button-css-conflict`),t=!(e&&tG());return super.isEnabled()&&t}},SZ=D([C()],SZ)})),CZ,wZ,TZ,EZ,DZ,OZ,kZ,Ehe=o((()=>{w(),$(),B(),Ra(),FS(),H(),Zn(),The(),Z(),Bh(),rU(),Rm(),j(),E(),O(),kZ=class extends V{constructor(e,t,n,r,i,a){super(),this._config=e,this._context=t,this._slotManager=n,this._footerCloseLocationExperiment=r,this._gamEventBus=i,this._slotEventBus=a,T(this,`_locations`,[F.Footer]),T(this,`_closeButton`,null),T(this,`_handleCloseButtonClick`,(e,t,n,r)=>{let i=document.createEvent(`Event`);n===F.Footer&&U.setSessionStorage(`adthrive_footer_closed`,`true`),i.initEvent(`adthrive${n}Close`,!0,!0),e.remove(),this._closeButton=null;let a=t.parentElement;a&&(window.dispatchEvent(i),a.removeChild(t),M.event(`CloseButtonComponent`,`logCloseFooter`,`User clicked footer close button`,{nref:r}),this._slotManager.destroy(t.id))})}init(){this._gamEventBus.slotRenderEnded.on(({slotId:e,event:t})=>{this.slotRenderEnded(e,t)})}slotRenderEnded(e,t){var n;let r=this._slotManager.getSlot(e);r&&!t.isEmpty&&((n=t.size)==null?void 0:n.length)===2&&(r.element&&this._locations.includes(r.location)&&r.sticky&&(r.element.setAttribute(`closable`,`true`),this._addCloseButton(r.id)),this._slotEventBus.adRenderedOutsideGAM.on(e=>{this._addCloseButton(e.slotId)}))}_addCloseButton(e){let t=this._slotManager.getSlot(e);if(!t)return;let{element:n,location:r,refreshCount:i}=t,a=t.element&&this._locations.includes(t.location)&&t.sticky&&n.hasAttribute(`closable`);a&&(this._closeButton===null&&(this._closeButton=this._createButton(n,r,i)),this._changeCloseButtonLocation(n,this._closeButton),n.appendChild(this._closeButton))}_createButton(e,t,n){let r=document.createElement(`span`);r.innerHTML=`&times;`,r.className=`adthrive-close`;let i=()=>this._handleCloseButtonClick(r,e,t,n);return r.addEventListener(`click`,i),r}_changeCloseButtonLocation(e,t){let n=this._footerCloseLocationExperiment.result;if(n&&n.includes(`topLeft`)&&(t.style.right=`initial`,t.style.left=Ei()?`10px`:`5px`,n===`topLeftAboveAd`)){var r;let n=(r=e.firstChild)==null?void 0:r.firstChild,i=n.getBoundingClientRect();t.style.left=(i.left-26).toString()+`px`,t.style.top=`5px`}}get enabled(){return this._config.adOptions.footerCloseButtonMigrated?this._context.device===`phone`?this._config.adOptions.footerCloseButtonMobile:this._config.adOptions.footerCloseButtonDesktop:this._config.adOptions.footerCloseButton}},kZ=D([Q(`CloseButtonComponent`),S(),A(`design:paramtypes`,[typeof(CZ=z!==void 0&&z)==`function`?CZ:Object,typeof(wZ=L!==void 0&&L)==`function`?wZ:Object,typeof(TZ=PS!==void 0&&PS)==`function`?TZ:Object,typeof(EZ=SZ!==void 0&&SZ)==`function`?EZ:Object,typeof(DZ=zh!==void 0&&zh)==`function`?DZ:Object,typeof(OZ=Vr!==void 0&&Vr)==`function`?OZ:Object])],kZ)})),AZ,jZ=o((()=>{w(),Ui(),E(),O(),AZ=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`EnhancedStickySidebarAds`,this._lookup=`ESSA`}},AZ=D([C()],AZ)})),MZ,Dhe=o((()=>{wp(),X(),Z(),E(),MZ=class{constructor(e,t,n){T(this,`_element`,void 0),T(this,`_overlap`,null),T(this,`_stuck`,!1),T(this,`_start`,0),T(this,`_cutoff`,0),T(this,`_cutoffBuffer`,20),T(this,`_stickyClass`,`adthrive-stuck`),T(this,`_stickyOutstreamStyleBottom`,51),T(this,`_onScrollEvent`,()=>{}),T(this,`_onThrottledScrollEvent`,()=>{}),T(this,`_onThrottledResizeEvent`,()=>{}),T(this,`_closed`,!1);let r=e.location===F.Video_StickyOutstream;this._element=e.element;let i=r?n.video.footerSelector:``;if(t){if(e.stickyOverlapSelector)this._overlap=document.querySelector(e.stickyOverlapSelector);else if(i.length){let e=document.querySelector(i);e&&!eK(e)&&(this._overlap=e)}else this._overlap=this._findOverlap(this._element);this._overlap,r&&this._stick(r)}this._setupEventListeners(e,r)}_setupEventListeners(e,t){this._onScrollEvent=()=>{if(!this._element||e.closed){this._removeEventListeners();return}this._check(t)},this._onThrottledScrollEvent=Sp(()=>this._update(),500),this._onThrottledResizeEvent=Sp(()=>{if(!this._element||e.closed){this._removeEventListeners();return}this._unstick(),this._update(),this._check(t)},500),window.addEventListener(`scroll`,this._onThrottledScrollEvent),window.addEventListener(`resize`,this._onThrottledResizeEvent),window.addEventListener(`scroll`,this._onScrollEvent)}_removeEventListeners(){window.removeEventListener(`scroll`,this._onScrollEvent),window.removeEventListener(`scroll`,this._onThrottledScrollEvent),window.removeEventListener(`resize`,this._onThrottledResizeEvent),this._onThrottledScrollEvent&&this._onThrottledScrollEvent.cancel&&this._onThrottledScrollEvent.cancel(),this._onThrottledResizeEvent&&this._onThrottledResizeEvent.cancel&&this._onThrottledResizeEvent.cancel(),this._element=null,this._overlap=null,this._closed=!0}_update(){this._element&&(this._stuck||(this._start=this._getTop(this._element)),this._overlap&&(this._cutoff=this._getTop(this._overlap)))}_updateStickyOutstreamPosition(e){let t=window.pageYOffset+window.innerHeight-this._stickyOutstreamStyleBottom;if(t>=e){let t=`${window.innerHeight+window.pageYOffset-e}px`;this._element.style.bottom=t,this._element.parentElement.style.bottom=t}else{let e=_n();this._element.parentElement.style.bottom=`${e}px`}}_check(e){if(!this._closed){if(this._start!==0){let t=window.pageYOffset,n=this._element.offsetHeight+this._cutoffBuffer,r=this._cutoff!==0&&t+n>this._cutoff;this._start<t&&!r?this._stick(e):e||this._unstick()}if(e&&this._overlap){let e=this._getTop(this._overlap);this._updateStickyOutstreamPosition(e)}}}_stick(e){if(!this._stuck){let t=getComputedStyle(this._element,null),n=this._element.parentElement;if(n){let t=getComputedStyle(n,null);n.style.minHeight=t.getPropertyValue(`height`),e&&n.classList.add(this._stickyClass)}this._element.style.width||(this._element.style.width=t.getPropertyValue(`width`)),e||this._element.classList.add(this._stickyClass),this._stuck=!0}}_unstick(){this._stuck&&(this._element.classList.remove(this._stickyClass),this._stuck=!1)}_getTop(e){let t=e.getBoundingClientRect();return t.top+window.pageYOffset}_findOverlap(e){let t=null;for(;e.parentElement;){e=e.parentElement;let n=e.nextElementSibling;for(;n&&eK(n);)n=n.nextElementSibling;n&&n.offsetTop>0&&(!t||n.offsetTop<t.offsetTop)&&(t=n)}return t}}})),NZ,Ohe=o((()=>{$(),w(),j(),E(),O(),NZ=class{constructor(){T(this,`_headerVisibleEvents`,[]),T(this,`_headerHiddenEvents`,[]),T(this,`_header`,null),T(this,`_isHeaderVisible`,!0),T(this,`_open`,!1),T(this,`handleUncollapse`,()=>{}),T(this,`handleCollapse`,e=>{if(e.mobileHeaderSelector){this.anchorVideoPlayerBelowNavbar(e,e.mobileHeaderSelector);let t=this.siteHeader(e.mobileHeaderSelector);t&&(t.onclick=()=>{this._open=!this._open,this._open?(e.programmaticPause(),e.playerContainer&&(e.playerContainer.style.display=`none`)):(e.programmaticPlay(),e.playerContainer&&(e.playerContainer.style.display=`block`))})}}),T(this,`collapsiblePersistentHeaderObserver`,new IntersectionObserver(e=>{for(let t of e)this._isHeaderVisible=t.isIntersecting,this._isHeaderVisible?this._headerVisibleEvents.forEach(e=>e()):this._headerHiddenEvents.forEach(e=>e())},{threshold:.95}))}applyTransitionToElement(e){e.style.transition=`all 0.2s ease-in-out`}pushElementBelowHeader(e,t){let n=this.getHeaderHeight(t);n!==null&&(e.style.top=`${n}px`)}anchorVideoPlayerBelowNavbar(e,t){let{playerElement:n,topBackgroundElement:r}=e,i=n.querySelector(`.adthrive-top-collapse-wrapper-bar`),a=()=>{let e=this.getHeaderHeight(t);e!==null&&(this.applyTransitionToElement(r),this.applyTransitionToElement(n),this.pushElementBelowHeader(r,t),this.pushElementBelowHeader(n,t),i&&this.pushElementBelowHeader(i,t))},o=()=>{r.style.top=`0`,n.style.top=`0`,i&&(i.style.top=`0`)};this._isHeaderVisible?a():o(),this._headerVisibleEvents.push(a),this._headerHiddenEvents.push(o)}getHeaderHeight(e){let t=this.siteHeader(e);if(!t)return null;let n=this.getElementHeight(t);return n}getElementHeight(e){return e.getBoundingClientRect().height}siteHeader(e){if(this._header)return this._header;let t=document.querySelector(e);return t?(this._header=t,this.collapsiblePersistentHeaderObserver.observe(this._header),this._header):null}},NZ=D([C(),Q(`TopCenterVideoPlayerForPersistentHeaderLegacyUtils`),A(`design:paramtypes`,[])],NZ)})),PZ,FZ,IZ,LZ,RZ=o((()=>{rU(),$(),bt(),Ff(),Z(),w(),X(),Ohe(),O(),E(),FZ=Pf.getScrollTop(),IZ=void 0,LZ=PZ=class{static changeState(e,t){let n=this._shouldCollapse(e),r=this._handleOtherVideoPlaying(t,e);if(!r)switch(e.playerState){case Y.Unstarted:this._handleUnstarted(t,n,e);break;case Y.UncollapsedPlay:this._handleUncollapsedPlay(t,n,e);break;case Y.CollapsedPlay:this._handleCollapsedPlay(t,n,e);break;case Y.NonLinearAdPlay:this._handleNonLinearAdPlay(t,n,e);break;case Y.UserPauseCollapsed:this._handleUserPauseCollapsed(t,n,e);break;case Y.UserPauseUncollapsed:this._handleUserPauseUncollapsed(t,n,e);break;case Y.PausedNotVisible:this._handlePausedNotVisible(t,e);break;case Y.NonLinearAdPaused:this._handleNonLinearAdPaused(t,e);break;case Y.Overlapped:this._handleOverlapped(t,n,e);break;case Y.NonLinearAdOverlapped:this._handleNonLinearAdOverlapped(t,n,e);break;default:return e.playerState}return e.playerState}static _handleUnstarted(e,t,n){this.offsetheight||(this.offsetheight=n.playerContainer.offsetHeight);let r=n.playerInstance;e===SW.InView&&(n.collapseTimer.firstInView||(n.collapseTimer.firstInView=new Date),PZ.startEvent.emit(),t?(this.collapse(n),r.getViewable()&&r.play(!0),n.playerState=r._nonLinearAd?Y.NonLinearAdPlay:Y.CollapsedPlay):n.playerState=r._nonLinearAd?Y.NonLinearAdPlay:Y.UncollapsedPlay)}static _setPlayerClosed(e){e.playerState=Y.Closed,this._isTopCollapse(e)&&x.resolve(eU).topCenterVideoClosed.emit()}static _handleOtherVideoPlaying(e,t){return e===SW.OtherVideoPlaying?(this.uncollapse(t),t.playerInstance.pause(!0),this._setPlayerClosed(t),!0):!1}static _setCollapsedPlay(e,t){PZ.collapse(e),e.playerState=Y.CollapsedPlay,this._isPlayingOrAboutToPlay(t,e)||t.play(!0)}static _isPlayingOrAboutToPlay(e,t){let n=e==null?void 0:e.getState(),r=n===`playing`||n===`buffering`,i=!!(t!=null&&t.getIsRunningAdPlay&&t.getIsRunningAdPlay());return r||i}static _handleUncollapsedPlay(e,t,n){let{playerInstance:r}=n;e===SW.InView?t?this._setCollapsedPlay(n,r):this._isPlayingOrAboutToPlay(r,n)||r.play(!0):e===SW.OutOfView?t?this._setCollapsedPlay(n,r):(r.pause(!0),n.playerState=Y.PausedNotVisible):e===SW.UserClick&&(n.playerState=Y.UserPauseUncollapsed)}static _handleVideoHeight(e){let{playerElement:t,topBackgroundElement:n}=e;n&&t.offsetHeight>=n.offsetHeight&&(n.style.height=`101px`)}static _handleCollapsedPlay(e,t,n){let{playerInstance:r,playerElement:i}=n;e===SW.InView?(t||(this.uncollapse(n),n.playerState=Y.UncollapsedPlay),!this._isPlayingOrAboutToPlay(r,n)&&r.play(!0)):e===SW.OutOfView?t||(this.uncollapse(n),r.pause(!0),n.playerState=Y.PausedNotVisible):e===SW.UserClick?n.playerState=Y.UserPauseCollapsed:e===SW.Overlapping?(n.lastCollapsedClasses=i.className,this.uncollapse(n),r.pause(!0),n.playerState=Y.Overlapped):e===SW.Close&&(this.uncollapse(n),r.pause(!0),this._setPlayerClosed(n))}static _handleNonLinearAdPlay(e,t,n){let{playerInstance:r}=n;e===SW.InView?t&&this.collapse(n):e===SW.OutOfView?(r.pauseAd(!0),n.playerState=Y.NonLinearAdPaused):e===SW.Overlapping&&(this.uncollapse(n),r.pauseAd(!0),n.playerState=Y.NonLinearAdOverlapped)}static _handleUserPauseCollapsed(e,t,n){let{playerInstance:r}=n;e===SW.InView&&!t?(this.uncollapse(n),n.playerState=Y.UserPauseUncollapsed):e===SW.UserClick?n.playerState=Y.CollapsedPlay:e===SW.Close&&(this.uncollapse(n),r.pause(!0),this._setPlayerClosed(n))}static _handleUserPauseUncollapsed(e,t,n){e===SW.InView&&t?(this.collapse(n),n.playerState=Y.UserPauseCollapsed):e===SW.UserClick&&(n.playerState=Y.UncollapsedPlay)}static _handlePausedNotVisible(e,t){let{playerInstance:n}=t;e===SW.InView&&(n.play(!0),t.playerState=Y.UncollapsedPlay)}static _handleNonLinearAdPaused(e,t){let{playerInstance:n}=t;e===SW.InView?(n.pauseAd(!1),t.playerState=Y.NonLinearAdPlay):this.playerWouldOverlapFooter(t)&&(t.playerState=Y.NonLinearAdOverlapped)}static _handleOverlapped(e,t,n){let{playerInstance:r}=n;t&&!this.playerWouldOverlapFooter(n)?(this.collapse(n),r.play(!0),n.playerState=Y.CollapsedPlay):n.playerState=Y.Overlapped}static _handleNonLinearAdOverlapped(e,t,n){let{playerInstance:r}=n;t&&!this.playerWouldOverlapFooter(n)?(this.collapse(n),r.pauseAd(!1),n.playerState=Y.NonLinearAdPlay):(r.pauseAd(!0),n.playerState=Y.NonLinearAdOverlapped)}static handleResize(e){this.isCollapsed(e.playerState)?e.collapseType===yW.Mobile&&e.collapseMobileSubType===`adthrive-collapse-top-center`&&e.topBackgroundElement&&(e.topBackgroundElement.style.height=`${e.playerElement.offsetHeight}px`,e.topBackgroundElement.style.width=`${window.innerWidth}px`):this.resizeContainer(e)}static handleScroll(e){let{playerState:t,playerElement:n,playerContainer:r,mediaStarted:i,mobileCollapseOnScrollUp:a}=e;if(e.collapseMobileSubType===`adthrive-collapse-top-center`&&e.playerContainer.style.display===`none`)return;let o=Pf.getScrollTop(),s=o>FZ;FZ=o;let c=this.playerWouldOverlapFooter(e),l=this._shouldCollapseOnScrollUp(e),u=Pf.playerViewable(n),d=!u&&(l?!i:!0),f=this._isWarmupComplete(e),p=d?SW.OutOfView:c?SW.Overlapping:SW.InView;if(a!==`off`){let n=RW(r)&&t===Y.PausedNotVisible&&!f;this._isTopOfPage()?(p=SW.OutOfView,this.stopCollapseWarmupTimer(e)):s&&n?(this.startCollapseWarmupTimer(e),p=SW.OutOfView,a===`1`&&(clearTimeout(IZ),IZ=setTimeout(()=>{this._isWarmupComplete(e)&&(this.stopCollapseWarmupTimer(e),e.playerState=Y.UncollapsedPlay,this.changeState(e,p))},1e3))):f&&this.stopCollapseWarmupTimer(e)}this.changeState(e,p),e.playerState===Y.CollapsedPlay||e.playerState===Y.UserPauseCollapsed?PZ.startCollapseTimer(e):PZ.stopCollapseTimer(e)}static handleOtherVideoPlaying(e){this.changeState(e,SW.OtherVideoPlaying)}static handlePageVisibilityChange(e,t){t.playerState!==Y.Closed&&t.playerState!==Y.Unstarted&&t.playerState!==Y.UserPauseUncollapsed&&t.playerState!==Y.UserPauseCollapsed&&t.playerState!==Y.PausedNotVisible&&t.playerState!==Y.Overlapped&&(e?t.playerInstance.pause(!0):t.playerInstance.play(!0))}static handleWidthBreak(e,t){t.playerState===Y.Closed||t.playerState===Y.Unstarted||(e.matches?(this.isCollapsed(t.playerState)&&(this.toggleCollapsedPlayerClasses(!1,t),t.forceMobile=!0,this.toggleCollapsedPlayerClasses(!0,t)),t.forceMobile=!0):(this.toggleCollapsedPlayerClasses(!1,t),t.forceMobile=!1,this.isCollapsed(t.playerState)&&this.toggleCollapsedPlayerClasses(!0,t)))}static handleClose(e,t=0){PZ.closeEvent.emit(),this.changeState(e,SW.Close),PZ.stopCollapseTimer(e),M.event(`JwPlayer`,`handleClose`,{timeElapsed:e.collapseTimer.timeCollapsed,device:Ei()?`desktop`:`mobile`,playerType:e.playerType,vp:t})}static handleUserClick(e){this.changeState(e,SW.UserClick)}static collapse(e){let{playerElement:t,topBackgroundElement:n,playerContainer:r}=e;this.disableCollapse||(this.collapseEvent.emit(),this.toggleCollapsedPlayerClasses(!0,e),e.hasPreviouslyCollapsed=!0,n&&(this._handleVideoHeight(e),x.resolve(NZ).handleCollapse({playerElement:t,playerContainer:r,topBackgroundElement:n,programmaticPause:()=>{e.playerInstance.pause(!0)},programmaticPlay:()=>{e.playerInstance.play(!0)},mobileHeaderSelector:e.mobileHeaderSelector})),e.playerInstance.resize(),setTimeout(e=>{this.displayCloseButton(e)},0,e),x.resolve(eU).topCenterVideoCollapsed.emit(e))}static displayCloseButton(e){this.isCollapsed(e.playerState)&&(e.closeButton.style.display=`inline-flex`)}static hideCloseButton(e){e.closeButton.style.display=`none`,e.closeButton.setAttribute(`style`,`display: none!important`)}static uncollapse(e){PZ.uncollapseEvent.emit(),this.toggleCollapsedPlayerClasses(!1,e),this._unstickFromSidebar(e.playerElement),this.hideCloseButton(e),this.resizeContainer(e),x.resolve(NZ).handleUncollapse(),x.resolve(eU).topCenterVideoUnCollapsed.emit()}static _shouldCollapse(e){let{mediaStarted:t,playerContainer:n,mobileCollapseOnScrollUp:r}=e,i=this._shouldCollapseOnScrollUp(e);if(Pf.isMobileLandscape())return!1;let a=this._isTopCollapse(e);if(r!==`off`&&a){let t=!!e.collapseTimer.warmupStartTime,n=this._isWarmupComplete(e);if(this._isTopOfPage()||t&&!n)return!1}let o=Pf.getScrollTop(),s=Pf.getScrollBottom(),c=this.offsetheight,l=IW(n).top,u=l+c,d=t&&(o>=l||i&&s<=u),f=t&&(o>=l+c/2||i&&s<=u-c/2);return a?d:f}static _shouldCollapseOnScrollUp(e){let{desktopCollapseOnScrollUp:t,hasPreviouslyCollapsed:n,mobileCollapseOnScrollUp:r}=e;return n&&(t||r!==`off`)}static isCollapsed(e){return e===Y.CollapsedPlay||e===Y.UserPauseCollapsed}static _isWarmupComplete(e){let{collapseTimer:t,mobileCollapseOnScrollUp:n,playerContainer:r}=e;if(!t.warmupStartTime)return!1;if(n===`1`)return Date.now()-t.warmupStartTime.getTime()>1e3;if(n===`2`)return zW(r)}static _isTopOfPage(){return window.scrollY<1}static _isTopCollapse(e){return e.collapseMobileSubType&&e.collapseMobileSubType===`adthrive-collapse-top-center`}static _stickToSidebar(e){e.stickyElement&&(e.playerElement.style.left=`${e.stickyElement.getBoundingClientRect().left}px`,e.playerElement.style.width=`${e.stickyElement.clientWidth}px`),e.playerElement.style.top=`${e.topMargin}px`}static _unstickFromSidebar(e){e.style.cssText=``}static playerWouldOverlapFooter(e){if(!e.footerElement)return!1;if(e.playerElement.className.includes(`adthrive-collapse-bottom`)||e.lastCollapsedClasses&&e.lastCollapsedClasses.includes(`adthrive-collapse-bottom`)){let t=_n();return!(window.innerHeight-t<e.footerElement.getBoundingClientRect().top)}return!((e.topMargin||0)+e.playerElement.getBoundingClientRect().height<e.footerElement.getBoundingClientRect().top)}static toggleCollapsedPlayerClasses(e,t){let n=t.playerInstance.utils,r=xK(n,`toggleClass`)&&typeof n.toggleClass==`function`?n.toggleClass:()=>{};r(t.playerElement,`adthrive-jw-player-collapse`,e),t.forceMobile?(r(t.playerElement,yW.Mobile,e),r(t.playerElement,t.collapseMobileSizeType,e),r(t.playerElement,t.collapseMobileSubType,e),this.repositionCollapseMobile(t,e)):(r(t.playerElement,t.collapseType,e),t.collapseSubType&&r(t.playerElement,t.collapseSubType,e),t.collapseMobileSizeType&&r(t.playerElement,t.collapseMobileSizeType,e),t.collapseType===yW.Mobile&&(r(t.playerElement,t.collapseMobileSubType,e),this.repositionCollapseMobile(t,e)))}static repositionCollapseMobile(e,t){e.collapseMobileSubType===`adthrive-collapse-bottom-left`||e.collapseMobileSubType===`adthrive-collapse-bottom-right`?this.repositionCollapseMobileBottom(e):e.collapseMobileSubType===`adthrive-collapse-top-center`&&this.repositionCollapseMobileTop(e,t)}static repositionCollapseMobileTop(e,t){e.topBackgroundElement&&(t?e.topBackgroundElement.style.height=`${e.playerElement.offsetHeight}px`:e.topBackgroundElement.style.height=`0`)}static repositionCollapseMobileBottom(e){if(e.playerElement.className.includes(`adthrive-collapse-bottom`)||e.collapseMobileSubType&&e.collapseMobileSubType.indexOf(`bottom`)>-1){let t=_n();e.playerElement.style.setProperty(`top`,`auto`,`important`),e.playerElement.style.setProperty(`bottom`,`${t}px`,`important`)}}static resizeContainer(e){e.playerContainer.style.height=`${e.playerElement.offsetHeight+30}px`}static startCollapseTimer(e){e.collapseTimer.isRunning||(e.collapseTimer.startTime?e.collapseTimer.lastCollapsedTime=new Date:(e.collapseTimer.startTime=new Date,e.collapseTimer.lastCollapsedTime=e.collapseTimer.startTime),e.collapseTimer.isRunning=!0)}static stopCollapseTimer(e){e.collapseTimer.isRunning&&(e.collapseTimer.lastCollapsedTime&&(e.collapseTimer.timeCollapsed+=Yr()-e.collapseTimer.lastCollapsedTime.getTime()),e.collapseTimer.isRunning=!1)}static startCollapseWarmupTimer(e){e.collapseTimer.warmupStartTime||(e.collapseTimer.warmupStartTime=new Date)}static stopCollapseWarmupTimer(e){e.collapseTimer.warmupStartTime&&(e.collapseTimer.warmupStartTime=void 0)}},T(LZ,`collapseEvent`,new k),T(LZ,`uncollapseEvent`,new k),T(LZ,`closeEvent`,new k),T(LZ,`startEvent`,new k),T(LZ,`disableCollapse`,!1),T(LZ,`offsetheight`,0),LZ=PZ=D([Q(`LegacyCollapseUtils`)],LZ)})),zZ,BZ,khe=o((()=>{$(),bt(),vn(),Di(),wp(),Z(),KI(),RZ(),oC(),E(),zZ={firstOnload:`so-fo`,onload:`so-o`,closeBtnVisible:`so-cbv`,closeClicked:`so-cc`,closeSinceFirstImp:`so-csfi`,closeSinceOnload:`so-cso`,closeSinceBtnVisible:`so-csbv`},BZ=class e{constructor(e,t,n,r,i,a,o,s,c){this._config=e,this._context=t,this._slotManager=n,this._slot=r,this._videoCloseButton=i,this._gamEventBus=a,this._footerEventBus=o,this._eventProxy=s,this._slotEventBus=c,T(this,`_isRendered`,!1),T(this,`_isClosed`,!1),T(this,`_removeListener`,void 0),T(this,`_elementClassNamePrefix`,`adthrive-sticky-outstream`),T(this,`_mobileHeaderSelector`,void 0),T(this,`_mobileLocation`,void 0),T(this,`_prebidAmazonAdvertiserIds`,void 0),T(this,`_isMobile`,this._context.device===`phone`),T(this,`_hiddenClassName`,`adthrive-player-hidden`),T(this,`_markNames`,[zZ.firstOnload,zZ.onload,zZ.closeClicked,zZ.closeBtnVisible]),T(this,`_measureNames`,[zZ.closeSinceFirstImp,zZ.closeSinceOnload,zZ.closeSinceBtnVisible]),T(this,`_observer`,void 0),T(this,`_closeButton`,void 0),T(this,`_scrollEventHandler`,()=>{}),T(this,`_footerBottom`,52),T(this,`_isFooterRibbonOnPage`,!1),this._prebidAmazonAdvertiserIds=[e.prebid.advertiserId,e.amazon.advertiserId];let{mobileHeaderSelector:l,mobileLocation:u}=this._config.video.stickyOutstreamSettings;this._mobileHeaderSelector=l,this._mobileLocation=N(u,`bottom-right`),this._addSlickDialogListeners(),this._footerEventBus.footerHeightChanged.on(e=>{this._addOffset(e)})}_listenForStationaryRelatedPlaying(){this._eventProxy.videoPlaying.on(e=>{e.playerType===rC.EmbeddedStationary&&this._handleClose(`stationaryRelatedInitiated`)})}setup(){this._isRendered||(this._isRendered=!0,this._appendCloseButton(),this._activate()),this._slot.setSlotTargetingFlag(`fref`,[`${this._slot.noAdRefreshCount}`],!0),LZ.collapseEvent.on(()=>{this._closeOnRelatedCollapse()}),GI.collapseEvent.on(()=>{this._closeOnRelatedCollapse()}),this._listenForFooterRibbon(),this._listenForStationaryRelatedPlaying()}get renderState(){return this._isRendered}_listenForFooterRibbon(){this._footerEventBus.footerVideoRibbonStateChanged.on(e=>{this._isFooterRibbonOnPage=e,this._hideIfVideoRibbonPresent()})}_hideIfVideoRibbonPresent(){let e=this._slot.element.parentElement;e&&(this._isFooterRibbonOnPage?e.classList.add(`adthrive-hidden`):e.classList.remove(`adthrive-hidden`))}_activate(){this._handleWidthBreak();let e=this._slot.element.parentElement;e&&(e.classList.add(`${this._elementClassNamePrefix}-idle`),this._isMobile&&this._setElementStyle(e),this._gamEventBus.slotRequested.on(this._handleSlotRequested.bind(this)),this._gamEventBus.slotRenderEnded.on(this._handleSlotRenderEnded.bind(this)),this._gamEventBus.slotOnload.on(this._handleSlotOnload.bind(this)))}_setElementStyle(e){if(this._mobileLocation===`top-center`)this._setTopCenterStyle(e);else{let t=this._mobileLocation?this._mobileLocation.split(`-`)[1]:`right`;e.classList.add(`${this._elementClassNamePrefix}-mobile-${t}`)}}_setScrollListener(e,t,n){let r=()=>{let r=t.getBoundingClientRect().bottom,i=n&&n.getBoundingClientRect().bottom,a=r>i?r:i;e.style.setProperty(`top`,`${a}px`)};this._scrollEventHandler=Sp(r,20),window.addEventListener(`scroll`,this._scrollEventHandler)}_setTopCenterStyle(e){let t=this._mobileHeaderSelector?Lf(this._mobileHeaderSelector):null,n=t&&t.valid,r=n&&t.elements&&t.elements[0]||null,i=0;if(r){let t=document.querySelector(`.slick-film-strip`);i=t?t.getBoundingClientRect().bottom:r.getBoundingClientRect().bottom,this._setScrollListener(e,r,t)}e.classList.add(`${this._elementClassNamePrefix}-top-center`);let a=this._config.isStickyOutstreamTopCenterColorsDisabled?`#000000`:this._config.adOptions.bgColor;e.style.setProperty(`background-color`,a),e.style.setProperty(`top`,`${i}px`)}_handleSlotOnload({slotId:e}){let t=this._slotManager.getSlot(e);if((t==null?void 0:t.location)===`Video_StickyOutstream`){performance.mark(zZ.onload);let e=performance.getEntriesByName(zZ.firstOnload).length;e||performance.mark(zZ.firstOnload)}}_handleSlotRenderEnded({event:e,slotId:t}){let n=this._slotManager.getSlot(t);if((n==null?void 0:n.location)===`Video_StickyOutstream`&&!e.isEmpty&&(!e.advertiserId||!this._prebidAmazonAdvertiserIds.includes(e.advertiserId))){this._hideIfVideoRibbonPresent();let e=this._slot.element.parentElement;if(!e)return;e.classList.add(`${this._elementClassNamePrefix}-active`),e.classList.remove(`${this._elementClassNamePrefix}-idle`)}}_handleSlotRequested({slotId:e}){let t=this._slotManager.getSlot(e);if((t==null?void 0:t.location)===`Video_StickyOutstream`){let e=this._slot.element.parentElement;if(!e||e.classList.contains(`${this._elementClassNamePrefix}-idle`))return;e.classList.remove(`${this._elementClassNamePrefix}-active`),e.classList.add(`${this._elementClassNamePrefix}-idle`)}}_createObserver(e){this._observer=new MutationObserver(e=>{e.forEach(e=>{let t=e.target.classList;t.contains(`${this._elementClassNamePrefix}-active`)?this._displayCloseButton():this._hideCloseButton()})}),this._observer.observe(e.parentElement||e,{attributes:!0,attributeFilter:[`class`]})}_hideCloseButton(){let e=this._closeButton;e&&(e.style.display=`none`)}_displayCloseButton(){let e=this._closeButton;e&&setTimeout(()=>{e.style.display=`inline-flex`,performance.mark(zZ.closeBtnVisible)},this._config.video.stickyOutstreamCloseButtonTimeout)}_appendCloseButton(){var e;let t=this._slot.element,n=this._videoCloseButton.createPlayerCloseButton(this._handleCloseClick.bind(this),`sticky outstream`,`${this._elementClassNamePrefix}-close`,!1,this._isMobile?this._mobileLocation:void 0);this._hideCloseButton(),(e=t.parentNode)==null||e.insertBefore(n,t),this._closeButton=n,this._createObserver(t)}_addSlickDialogListeners(){document.addEventListener(`slick-auth-dialog-opened`,()=>{this._slot.element.classList.add(this._hiddenClassName)}),document.addEventListener(`slick-auth-dialog-closed`,()=>{this._slot.element.classList.remove(this._hiddenClassName)})}_getMeasure(e,t,n){try{return(performance.measure(e,t,n).duration/1e3).toFixed(2)}catch(e){return-1}}_getDurations(){let e=this._getMeasure(zZ.closeSinceOnload,zZ.onload,zZ.closeClicked),t=this._getMeasure(zZ.closeSinceBtnVisible,zZ.closeBtnVisible,zZ.closeClicked),n=this._getMeasure(zZ.closeSinceFirstImp,zZ.firstOnload,zZ.closeClicked),r=(performance.now()/1e3).toFixed(2);return{slotTime:e,btnTime:t,firstImp:n,pageLoad:r,refresh:this._slot.refreshCount}}_cleanUpLogging(){var e;(e=this._observer)==null||e.disconnect(),this._markNames.forEach(e=>performance.clearMarks&&performance.clearMarks(e)),this._measureNames.forEach(e=>performance.clearMeasures&&performance.clearMeasures(e))}_logPlayerClose(t){e.closeEvent.emit(),M.event(`StickyOutstream`,`handleClose`,{device:Ei()?`desktop`:`mobile`,closeReason:t,...this._getDurations()}),this._cleanUpLogging(),window.removeEventListener(`scroll`,this._scrollEventHandler)}_closeOnRelatedCollapse(){this._handleClose(`relatedCollapse`)}_handleCloseClick(){performance.mark(zZ.closeClicked),this._handleClose(`closeClick`)}_handleClose(e){if(this._isClosed)return;this._isClosed=!0;let t=this._slot.element,n=t.parentElement;this._logPlayerClose(e),n&&(n.removeChild(t),n.classList.remove(`${this._elementClassNamePrefix}-active`),this._slotManager.destroy(t.id),e===`closeClick`&&this._slotEventBus.stickyOutstreamSlotDestroyedUserClick.emit(this._slot.id),this._removeListener())}_handleWidthBreak(){this._removeListener=this._footerEventBus.footerResponseReceived.on(this._handleFooterResponseReceivedEvent.bind(this)),this._repositionCollapseBottom()}_handleFooterResponseReceivedEvent(){this._repositionCollapseBottom()}_repositionCollapseBottom(){this._isMobile&&this._mobileLocation!==`top-center`&&(this._footerBottom=_n(),this._slot.element.parentElement&&(this._slot.element.parentElement.style.setProperty(`top`,`auto`,`important`),this._slot.element.parentElement.style.setProperty(`bottom`,`${this._footerBottom}px`,`important`)))}_addOffset(e){let t=this._config.video.stickyOutstreamSettings.mobileLocation===`bottom-right`&&document.querySelector(`slick-sticky-toolbar`),n=e-this._footerBottom,r=t?-76:0;this._slot.element.parentElement&&this._slot.element.parentElement.style.setProperty(`transform`,`translate(${r}px, -${n}px)`,`important`),document.querySelectorAll(`.raptive-sales-footer`)&&this._adjustPositionForCeltraAds()}_adjustPositionForCeltraAds(){this._hideIfVideoRibbonPresent();let e=document.querySelector(`#AdThrive_Video_StickyOutstream_1_phone`);if(!e)return;let t=()=>{e.style.position===`fixed`&&e.style.setProperty(`position`,`static`)},n=new MutationObserver(()=>{t()});n.observe(e,{attributes:!0,attributeFilter:[`class`]}),t()}},T(BZ,`closeEvent`,new k)})),VZ,Ahe=o((()=>{Ui(),w(),E(),O(),VZ=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`StickySidebarFeatureFlag`,this._lookup=`SSFF`}},VZ=D([C()],VZ)})),HZ,UZ,WZ,GZ,KZ,qZ,JZ,YZ,XZ,ZZ,QZ,$Z,eQ,tQ,jhe=o((()=>{w(),Yi(),bC(),H(),B(),Ra(),rU(),Bh(),Zn(),$(),FS(),vh(),Z(),jZ(),RI(),Dhe(),khe(),Ahe(),HS(),j(),E(),O(),tQ=class extends V{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f){super(),this._slots=e,this._config=t,this._context=n,this._slotManager=r,this._videoCloseButton=i,this._outstream=a,this._amazonMethods=o,this._gamEventBus=l,this._slotEventBus=u,this._footerEventBus=d,this._videoEventProxy=f,T(this,`_sticky`,[]),T(this,`_stickyOutstream`,void 0),this._slots.added.on(e=>{if((e==null?void 0:e.location)!==F.Recipe&&e&&e.sticky){if(e.element.classList.add(`adthrive-sticky`),e.location===F.Sidebar){let t=s.result&&e.sequence&&e.sequence<=5,n=this._config.adOptions.dynamicStickySidebarEnabled&&c.result,r=n&&e.sequence&&e.sequence>=9;t||r&&e.element.classList.contains(`adthrive-sticky-sidebar`)?gn(e.element):this._sticky.push(new MZ(e,!0,this._config))}e.location===F.Video_StickyOutstream&&(this._stickyOutstream=new BZ(this._config,this._context,this._slotManager,e,this._videoCloseButton,this._gamEventBus,this._footerEventBus,this._videoEventProxy,this._slotEventBus),this._sticky.push(new MZ(e,!0,this._config)))}}),this._amazonMethods.isAmazonLoaded()&&this._config.amazon.enabled&&(this._gamEventBus.slotOnload.on(({slotId:e})=>{let t=this._slots.get(e),n=window.apsBidObject?window.apsBidObject.VAST:null;(t==null?void 0:t.location)===F.Video_StickyOutstream&&n&&(this._outstream.callRendererWithUrl(n,t.id,!0),delete window.apsBidObject)}),this._slotEventBus.adRenderingOutsideGAM.on(({slotId:e,bidResponse:t})=>{this._callAmazonVastEndpoint(e,t)}))}_callAmazonVastEndpoint(e,t){let n=this._slots.get(e);if(!n||!jK(t))return;let r=Math.floor(Math.random()*1e11),i=`https://aax.amazon-adsystem.com/e/dtb/vast?b=${t.amzniid}&rnd=${r}&pp=${t.amznbid}`;this._outstream.callRendererWithUrl(i,n.id,!0)}stickyOutstreamReady(){this._stickyOutstream&&!this._stickyOutstream.renderState&&this._stickyOutstream.setup()}},tQ=D([Q(`StickyComponent`),C(),A(`design:paramtypes`,[typeof(HZ=_h!==void 0&&_h)==`function`?HZ:Object,typeof(UZ=z!==void 0&&z)==`function`?UZ:Object,typeof(WZ=L!==void 0&&L)==`function`?WZ:Object,typeof(GZ=PS!==void 0&&PS)==`function`?GZ:Object,typeof(KZ=LI!==void 0&&LI)==`function`?KZ:Object,typeof(qZ=yC!==void 0&&yC)==`function`?qZ:Object,typeof(JZ=Ji!==void 0&&Ji)==`function`?JZ:Object,typeof(YZ=VZ!==void 0&&VZ)==`function`?YZ:Object,typeof(XZ=AZ!==void 0&&AZ)==`function`?XZ:Object,typeof(ZZ=zh!==void 0&&zh)==`function`?ZZ:Object,typeof(QZ=Vr!==void 0&&Vr)==`function`?QZ:Object,typeof($Z=xr!==void 0&&xr)==`function`?$Z:Object,typeof(eQ=VS!==void 0&&VS)==`function`?eQ:Object])],tQ)})),nQ=o((()=>{Ehe(),jhe()})),rQ,iQ,aQ,oQ,sQ,cQ,Mhe=o((()=>{w(),$h(),$(),FS(),nQ(),H(),Zn(),Eh(),Wr(),sb(),j(),O(),cQ=class extends V{constructor(e,t,n,r,i){super(),this._slotManager=e,this._sticky=t,this._intersectionObserverManager=n,this._slotManagerEventBus=r,this.jumpToRecipeTracker=i}init(){let e=this._slotManager;this.jumpToRecipeTracker.onJumpToRecipeClicked.once(()=>{this._intersectionObserverManager.reobserveAll()}),this._slotManagerEventBus.added.on(t=>{let n=this._slotManager.getSlots(t);for(let t of n)t.lazy?(Zh.pushToQueue(()=>{t.googleTagSlot.setTargeting(`lazy`,`true`)}),this._intersectionObserverManager.observe(t)):t.location===F.Video_StickyOutstream?(this._sticky.stickyOutstreamReady(),e.display([t]).catch(e=>{M.error(`GoogleLazyLoadComponent`,`init`,`display stickyOutstream slot`,e)})):(Zh.pushToQueue(()=>{t.googleTagSlot.setTargeting(`lazy`,`false`)}),e.display(t).catch(e=>{M.error(`GoogleLazyLoadComponent`,`init`,`display non lazy slot`,e)}))})}},cQ=D([Q(`GoogleLazyLoadComponent`),S(),A(`design:paramtypes`,[typeof(rQ=PS!==void 0&&PS)==`function`?rQ:Object,typeof(iQ=tQ!==void 0&&tQ)==`function`?iQ:Object,typeof(aQ=Th!==void 0&&Th)==`function`?aQ:Object,typeof(oQ=Ur!==void 0&&Ur)==`function`?oQ:Object,typeof(sQ=ob!==void 0&&ob)==`function`?sQ:Object])],cQ)})),Nhe=o((()=>{Mhe()})),lQ,Phe=o((()=>{$(),w(),Ui(),E(),j(),O(),lQ=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`MagniteCarbon`,this._lookup=`MGNCRBN`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],lQ.prototype,`run`,null),lQ=D([C()],lQ)})),uQ,dQ,fQ,pQ,mQ,hQ,gQ,_Q,vQ,Fhe=o((()=>{w(),jc(),H(),$(),Rm(),Phe(),rU(),so(),sw(),ya(),Da(),lo(),j(),E(),O(),vQ=class extends V{constructor(e,t,n,r,i,a,o,s){super(),this._gpc=e,this._ccpa=t,this._gdpr=n,this._magniteCarbonExperiment=r,this._prebidMethods=i,this._prebidEventBus=a,this._events=o,this._gdprEnforcement=s,T(this,`ANALYTICS_VERSION`,`v1.0`),T(this,`PROFILE_ID_KEY`,`carbon_ccuid`),T(this,`PROFILE_ID_COOKIE`,`ccuid`),T(this,`SESSION_ID_COOKIE`,`ccsid`),T(this,`MAGNITE_CARBON_GVLID`,493),T(this,`PARENT_ID`,`8fea659f19`),T(this,`ANALYTICS_HOST`,`https://pb-ing.ccgateway.net`),T(this,`pageViewId`,``),T(this,`profileId`,``),T(this,`sessionId`,``),T(this,`_pageEngagement`,{ttl:60,count:0,id:0,startTime:0,timeLastEngage:0}),T(this,`_auctionEndEventCount`,0)}init(){this._gdpr.enabled?this._events.consentResponseCaptured.on(()=>{this._gdprEnforcement.checkConsentForVendor(this.MAGNITE_CARBON_GVLID,[1]).then(e=>{e&&this._beginEventLogging()}).catch(()=>{})}):this._beginEventLogging()}async _beginEventLogging(){this._pageEngagement.id=this._generateUUID(),this._pageEngagement.startTime=Date.now(),this._pageEngagement.timeLastEngage=Date.now(),this.pageViewId=this._generateUUID().toString(),this.profileId=this._getProfileId(),this.sessionId=this._getSessionId();let e=await this._createBaseEngagementEvent();this._sendEngagementEvent(e,`page_load`),this._prebidEventBus.auctionEnd.once(()=>{this._auctionEndEvent()}),this._prebidEventBus.tcf2Enforcement.on(e=>{this.tcf2EnforcementEvent(e)})}async tcf2EnforcementEvent(e){var t,n,r;if(((t=e.storageBlocked)==null?void 0:t.length)>0||((n=e.biddersBlocked)==null?void 0:n.length)>0||((r=e.analyticsBlocked)==null?void 0:r.length)>0){this._registerEngagement();let t=await this._createBaseEngagementEvent();t.tcf_events=e,this._sendEngagementEvent(t,`tcf_enforcement`)}}async _auctionEndEvent(){if(this._auctionEndEventCount++,this._auctionEndEventCount===1){this._registerEngagement();let e=await this._createBaseEngagementEvent();this._sendEngagementEvent(e,`auction_end`)}}async _createBaseEngagementEvent(){let e={profile_id:this.profileId,session_id:this.sessionId,pageview_id:this.pageViewId,engagement_id:this._pageEngagement.id,engagement_count:this._pageEngagement.count,engagement_ttl:this._pageEngagement.ttl,start_time:this._pageEngagement.startTime,end_time:Date.now(),script_id:window.location.host,url:window.location.href,referrer:document.referrer,consent:await this._getConsentData()},t=await this.getExternalIds();return e.external_ids=t,e}_registerEngagement(){let e=Date.now(),t=(e-this._pageEngagement.timeLastEngage)/1e3;this._pageEngagement.timeLastEngage=e,!(t<this._pageEngagement.ttl)&&(this._pageEngagement.count++,this._pageEngagement.startTime=e,this._pageEngagement.id=this._generateUUID())}async _getConsentData(){var e;let t={};if(this._ccpa.required){var n;t.ccpa_consent=(n=this._ccpa.privacyString)==null?``:n}return this._gdpr.enabled&&this._gdpr.consentCaptured&&(e=this._gdpr.consentCapturedData)!=null&&e.consentString?t.gdpr_consent=this._gdpr.consentCapturedData.consentString:this._gdpr.enabled&&typeof window.__tcfapi==`function`&&(t.gdpr_consent=await new Promise(e=>{window.__tcfapi(`getTcData`,2,(t,n)=>{n&&t&&t.tcString&&t.tcString.length?e(t.tcString):e(``)})})),t}async getExternalIds(){let e={},t=[];return await this._prebidMethods.waitForQueue().then(n=>{n===!0&&(t=this._prebidMethods.getUserIdsAsEids()),t.forEach(t=>{t.source&&t!=null&&t.uids.length&&(e[t.source]=t.uids.map(e=>e.id))})}),e}_sendEngagementEvent(e,t){let n=`${this.ANALYTICS_HOST}/${this.ANALYTICS_VERSION}/parent/${this.PARENT_ID}/engagement/trigger/${t}`;fetch(n,{method:`POST`,headers:{"Content-Type":`application/json`},credentials:`include`,body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{try{this._updateProfileId(e)}catch(e){M.error(`MagniteCarbonComponent`,`importScript`,`unable to parse API response`)}}).catch(e=>M.error(`MagniteCarbonComponent`,`importScript`,e))}_updateProfileId(e){e!=null&&e.update&&(e==null?void 0:e.id)!=``&&(U.setExternalCookie(this.PROFILE_ID_COOKIE,e.id,{expiry:{unit:`days`,value:89},sameSite:`Lax`}),U.setExternalLocalStorage(this.PROFILE_ID_KEY,e.id))}_getProfileId(){let e=U.readExternalLocalStorage(this.PROFILE_ID_KEY),t=U.readExternalCookie(this.PROFILE_ID_COOKIE);if(e)return U.setExternalCookie(this.PROFILE_ID_COOKIE,e,{expiry:{unit:`days`,value:89},sameSite:`Lax`}),e;if(t)return U.setExternalLocalStorage(this.PROFILE_ID_KEY,t),t;let n=this._generateUUID();return U.setExternalLocalStorage(this.PROFILE_ID_KEY,n.toString()),U.setExternalCookie(this.PROFILE_ID_COOKIE,n.toString(),{expiry:{unit:`days`,value:89},sameSite:`Lax`}),n.toString()}_getSessionId(){let e=U.readExternalCookie(this.SESSION_ID_COOKIE);if(e&&e!=``)return U.setExternalCookie(this.PROFILE_ID_COOKIE,e,{expiry:{unit:`minutes`,value:5},sameSite:`Lax`}),e;let t=this._generateUUID();return U.setExternalCookie(this.PROFILE_ID_COOKIE,t.toString(),{expiry:{unit:`minutes`,value:5},sameSite:`Lax`}),t.toString()}_generateUUID(e){let t=0;return t=window&&window.crypto&&window.crypto.getRandomValues!==void 0?crypto.getRandomValues(new Uint8Array(1))[0]%16:Math.random()*16,e?(e^t>>e/4).toString(16):`10000000-1000-4000-8000-100000000000`.replace(/[018]/g,this._generateUUID)}get enabled(){return this._magniteCarbonExperiment.result&&!this._gpc.gpcEnabled&&!this._ccpa.userOptedOut}},vQ=D([Q(`MagniteCarbonComponent`),C(),A(`design:paramtypes`,[typeof(uQ=va!==void 0&&va)==`function`?uQ:Object,typeof(dQ=Ea!==void 0&&Ea)==`function`?dQ:Object,typeof(fQ=co!==void 0&&co)==`function`?fQ:Object,typeof(pQ=lQ!==void 0&&lQ)==`function`?pQ:Object,typeof(mQ=R!==void 0&&R)==`function`?mQ:Object,typeof(hQ=Pr!==void 0&&Pr)==`function`?hQ:Object,typeof(gQ=oo!==void 0&&oo)==`function`?gQ:Object,typeof(_Q=ow!==void 0&&ow)==`function`?_Q:Object])],vQ)})),Ihe=o((()=>{Fhe()})),yQ,bQ,xQ,Lhe=o((()=>{w(),$(),$h(),H(),Z(),Wr(),vh(),j(),O(),xQ=class extends V{constructor(e,t){super(),this._slotManagerEventBus=e,this._slots=t}init(){this._slotManagerEventBus.added.on(e=>{let t=this._slots.get(e);Zh.pushToQueue(()=>{for(let e of t){let t=uG(e)||0;e.hvp=t,t>=50&&e.setTargeting({key:`hvp`,value:t.toString()})}})}),this._slotManagerEventBus.refreshing.on(e=>{let t=this._slots.get(e);Zh.pushToQueue(()=>{for(let e of t)if((e==null?void 0:e.refreshCount)<=2&&(!(e!=null&&e.hvp)||(e==null?void 0:e.hvp)<80)){let t=lG(e)||0;e.hvp=t,t>=60&&e.setTargeting({key:`hvp`,value:`${t}`})}})})}},xQ=D([Q(`HvpComponent`),S(),A(`design:paramtypes`,[typeof(yQ=Ur!==void 0&&Ur)==`function`?yQ:Object,typeof(bQ=_h!==void 0&&_h)==`function`?bQ:Object])],xQ)})),SQ,CQ,wQ,Rhe=o((()=>{w(),$(),Z(),B(),vh(),Qh(),j(),O(),wQ=class{constructor(e,t){this._config=e,this._gam=t,this._config.marmalade.selectorMatches=this.filterBasedOnSettings()}inject(){try{return this._config.marmalade.selectorMatches.reduce(this.processMatch.bind(this),[])}catch(e){M.error(`MarmaladeInjector`,`inject`,e)}return[]}filterBasedOnSettings(){let e=this._config.adTypes,t=tG()?e.inRecipeRecommendationMobile:e.inRecipeRecommendationDesktop,n=tG()?e.sponsorTileMobile:e.sponsorTileDesktop;return this._config.marmalade.selectorMatches.filter(({adUnit:e})=>e.location===`Native_Recipe`?(t&&this._gam.setTargetingFlag(`irrEligible`,[`true`],!0),t):e.location===`Sponsor_Tile`?(n&&this._gam.setTargetingFlag(`stEligible`,[`true`],!0),n):!0)}processMatch(e,t){let{adUnit:n,match:r}=t,i=this.getElementId(n.location,n.sequence),a=e.some(e=>e.location===n.location&&e.sequence===n.sequence);if(!a){let t=this.addAd(r,i,n.position,n.classNames);if(t){let r=new gh(n.location,n.sequence,n.size,t,!1,n.lazy);e.push(r)}}return e}getElementId(e,t){return[this._config.gam.prefix,e,t].filter(bK).join(`_`)}addAd(e,t,n,r=[]){let i=`<div id="${t}" class="adthrive-ad ${r.join(` `)}"></div>`;return e.insertAdjacentHTML(n,i),document.getElementById(t)}},wQ=D([Q(`MarmaladeInjector`),S(),A(`design:paramtypes`,[typeof(SQ=z!==void 0&&z)==`function`?SQ:Object,typeof(CQ=Zh!==void 0&&Zh)==`function`?CQ:Object])],wQ)})),TQ,EQ,DQ,OQ,kQ,AQ,jQ,MQ,NQ,PQ,FQ,zhe=o((()=>{w(),$h(),jc(),B(),$(),FS(),Z(),H(),Rhe(),Bh(),rU(),Wr(),vh(),j(),E(),O(),FQ=class extends V{constructor(e,t,n,r,i,a,o,s,c,l){super(),this._config=e,this._marmaladeInjector=t,this._slotManager=n,this._gam=r,this._prebidMethods=i,this.gamEventBus=a,this._marmaladeEventBus=o,this._slotEventBus=s,this._slotManagerEventBus=c,this._slots=l,T(this,`_mcmp`,[]),T(this,`_siteCodes`,[]),T(this,`_filteredSiteCodes`,[]),T(this,`_siteCodeObject`,{}),this._setMarmaladeData()}async _setMarmaladeData(){let e=this._config.marmalade;await e.marmaladeEventPromise,this._mcmp=e.mcmp.filter(GW),this._siteCodes=e.siteCodes,this._filteredSiteCodes=e.filteredSiteCodes,this._siteCodeObject=this._filteredSiteCodes.reduce((e,t)=>(e[t]=`True`,e),{})}init(){this._setup()}async _setup(){await this._config.marmalade.marmaladeEventPromise,this._marmaladeEventBus.marmaladeResponseLoaded.on(()=>{this._initializeMarmalade()}),this._slotEventBus.preRequestBids.on(e=>{let t=this._slots.get(e);t.forEach(e=>{Zh.pushToQueue(()=>{e.setTargeting(this.getMcmpTargeting())})})}),this._addDynamicSlots(),this._addFlpMessaging(),this._setPageLevelTargeting(),this._setIXTargeting();let e=()=>{this._setMcmpTargeting(),this._setIXTargeting()};this._config.marmalade.rfDataProcessed.emitted?e():this._config.marmalade.rfDataProcessed.on(()=>e())}getMcmpTargeting(){let e=[...this._mcmp,...this._getRfCodes(`gam`)],t=this._config.trackScroll,n=t.trackScrollEnabled&&t.getTargetingValue();return n&&e.push(...n),{key:`mcmp`,value:e}}_initializeMarmalade(){this._mcmp=this._config.marmalade.mcmp.filter(GW),this._siteCodes=this._config.marmalade.siteCodes,this._filteredSiteCodes=this._config.marmalade.filteredSiteCodes,this._siteCodeObject=this._filteredSiteCodes.reduce((e,t)=>(e[t]=`True`,e),{}),this.init()}_getRfCodes(e){let t=[];if(e){let n=this._config.marmalade,r=[...n.rfMcmpCodes,...n.rfIabCodes];r.forEach(n=>{let r=n[0],i=n[1];i.includes(e)&&t.push(r)})}return t}_setMcmpTargeting(){let e=this._getRfCodes(`gam`);this._config.marmalade.mcmpTargeting=[...this._mcmp,...e]}_setIXTargeting(){let e=this._getRfCodes(`ix`),t=this._config.trackScroll.getTargetingValue(),n=t?[t]:[];IG({MCMP:[...e,...this._mcmp,...n].join(`#MCMP:`),...this._siteCodeObject},this._prebidMethods)}_setPageLevelTargeting(){this._slotManagerEventBus.requestingBids.once(()=>{this._gam.setTargetingFlag(`rf`,[String(this._marmaladeEventBus.recencyFrequencyDataSet.emitted)])}),this._setMcmpTargeting(),this._gam.setTargeting({key:`site_code`,value:this._siteCodes}),this._gam.setTargeting({key:`marmalade`,value:this._config.marmalade.loaded?`true`:`false`})}_addDynamicSlots(){let e=this._marmaladeInjector.inject();e.forEach(e=>e.refreshInterval=0),e.length>0&&this.gamEventBus.started.on(async()=>{await this._slotManager.add(e).catch(e=>{M.error(`MarmaladeComponent`,`init`,e)})})}_addFlpMessaging(){let e=this._config.marmalade.flpProdIds.filter(GW);if(e){let t=/https:\/\/\S*\.safeframe.googlesyndication.com/i;sK(t,{message:`adthriveFlippData`,flippData:e})}}get enabled(){return!this._config.disableAds.all}},FQ=D([Q(`MarmaladeComponent`),S(),A(`design:paramtypes`,[typeof(TQ=z!==void 0&&z)==`function`?TQ:Object,typeof(EQ=wQ!==void 0&&wQ)==`function`?EQ:Object,typeof(DQ=PS!==void 0&&PS)==`function`?DQ:Object,typeof(OQ=Zh!==void 0&&Zh)==`function`?OQ:Object,typeof(kQ=R!==void 0&&R)==`function`?kQ:Object,typeof(AQ=zh!==void 0&&zh)==`function`?AQ:Object,typeof(jQ=Rr!==void 0&&Rr)==`function`?jQ:Object,typeof(MQ=Vr!==void 0&&Vr)==`function`?MQ:Object,typeof(NQ=Ur!==void 0&&Ur)==`function`?NQ:Object,typeof(PQ=_h!==void 0&&_h)==`function`?PQ:Object])],FQ)})),Bhe=o((()=>{Lhe(),zhe()})),IQ,Vhe=o((()=>{Ui(),w(),E(),O(),IQ=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`OptableId5ResolveHems`,this._lookup=`ROGID5HEM`}},IQ=D([C()],IQ)})),LQ,Hhe=o((()=>{Ui(),w(),E(),O(),LQ=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`OptableId5ResolveRouteTest`,this._lookup=`OPTID5RRT`}},LQ=D([C()],LQ)})),RQ,zQ,BQ,VQ,HQ,UQ,WQ,GQ,KQ,qQ,JQ,YQ,XQ,ZQ,QQ,$Q,e$,t$,n$,Uhe=o((()=>{w(),$(),Rm(),ua(),Ua(),ew(),ao(),$s(),Ra(),Ja(),_a(),Da(),ya(),lo(),Cs(),H(),gs(),Vs(),km(),Tr(),Yw(),rU(),dn(),Vhe(),Hhe(),so(),sw(),j(),O(),t$={thetradedesk:`adserver.org`,appnexus:`adnxs.com`,bidswitch:`bidswitch.net`,indexexchange:`indexexchange.com`,kargo:`kargo.com`,pubmatic:`pubmatic.com`,magnite:`rubiconproject.com`,triplelift:`triplelift.com`,yieldmo:`yieldmo.com`,unknown:``},n$=class extends V{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g){super(),this._context=e,this._siteConfig=t,this._optableConfig=n,this._gpcConfig=r,this._ccpaConfig=i,this._gdpr=a,this._user=o,this._userIds=s,this._optableSdkWrapper=c,this._ortb2=l,this._emailCaptureHandler=u,this._identityEventBus=d,this._optableId5ResolveHemsExperiment=f,this._optableId5ResolveRouteTestExperiment=p,this._gdprEvents=m,this._gdprEnforcement=h,this._prebidEventBus=g}get enabled(){var e;let t=this._optableConfig.enabled&&((e=this._userIds.get(`id5Id`))==null?void 0:e.enabled),n=!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut;return!!t&&!!n}start(){this.enabled&&(this._gdpr.enabled?this._gdprEvents.consentResponseCaptured.on(()=>{this._gdprEnforcement.checkConsentForVendor(this._gdpr.raptiveVendorId,[1]).then(e=>{e&&this._id5Resolution()}).catch(()=>{})},{handleEventsAlreadyEmitted:!0}):this._id5Resolution())}async _id5Resolution(){try{var e,t;$t()||(await Ha(),await this._waitForIdentityIframeSync()),await Ha(),await this._waitForOptableWaterfall(),await Ha();let r=await no(),i=r==null||(e=r.graph3p)==null?void 0:e.d;if(!(i==null||(t=i.alternateIds)==null)&&t.length){var n;this._setAlternateIdsAsEids((n=i.alternateIds)==null?[]:n);return}let a=this._readId5FromStorage();a?await this._resolveAndStoreId5(a,r,i,!0):this._prebidEventBus.id5Resolved.on(async e=>{e!=null&&e.universal_uid&&(a=e.universal_uid,await this._resolveAndStoreId5(a,r,i,!1))})}catch(e){M.error(`OptableID5ResolverComponent`,`start`,e)}}async _resolveAndStoreId5(e,t,n,r){try{var i,a,o;if(e.length===0||!e.toLowerCase().startsWith(`id5`)){M.error(`OptableID5ResolverComponent`,`_resolveAndStoreId5`,`Invalid id5id format`,{id5Id:e});return}let r=t,s=n,c=await this._user.identityData(),l=c&&(c.collectionMethod===`graph1p`||c.collectionMethod===`direct`);if(!(s==null||(i=s.alternateIds)==null)&&i.length&&l)return;r=await no(),s=r==null||(a=r.graph3p)==null?void 0:a.d;let{hem:u,source:d,alternateIds:f}=await this._resolveIdsWithId5Id(e),p=this._optableId5ResolveHemsExperiment.result&&u&&d,m=f!=null&&f.length?f:!(s==null||(o=s.alternateIds)==null)&&o.length?s.alternateIds:[];if(p){let e=!l;await this._storeIdentifiers(u,d,m,e)}m.length&&this._setAlternateIdsAsEids(m)}catch(t){M.error(`OptableID5ResolverComponent`,`_resolveAndStoreId5`,{id5Id:e,ls:r,err:t})}}_readId5FromStorage(){let e=U.readExternalLocalStorage(`id5id`);if(!e)return null;try{let t=JSON.parse(decodeURIComponent(e));return t.universal_uid}catch(e){return M.error(`OptableID5ResolverComponent`,`_readId5IdFromStorage`,`Error parsing id5 id.`,e),null}}async _waitForIdentityIframeSync(){return new Promise(e=>{let t=()=>{this._identityEventBus.iframeDataSynced.off(t),e()};this._identityEventBus.iframeDataSynced.on(t,{handleEventsAlreadyEmitted:!0}),setTimeout(()=>{this._identityEventBus.iframeDataSynced.off(t),e()},3e3)})}async _waitForOptableWaterfall(){return new Promise(e=>{let t=()=>{this._identityEventBus.optableWaterfallCompleted.off(t),e()};this._identityEventBus.optableWaterfallCompleted.on(t,{handleEventsAlreadyEmitted:!0}),setTimeout(()=>{this._identityEventBus.optableWaterfallCompleted.off(t),e()},3e3)})}async _resolveIdsWithId5Id(e){let t=await this._optableSdkWrapper.resolveThirdPartyClusters(`id5:${e}`,this._optableId5ResolveRouteTestExperiment.result),{hem:n,source:r}=Om(t,`e:`),i=this._getAlternateIdsFromGraphResponse(t);return{hem:n,source:r,alternateIds:i}}_getLegacyBridgedHemSource(e){let t={mediawallah:`MW`,truedata:`TD`},n=t[e];if(!n)throw Error(`No legacy mapping found for source: ${e}`);let{PREFIXES:r,VALUES:i,SUFFIXES:a}=I.PII_SOURCE;return`${r.IDG}${i[n]}-${i.ID5ID}${a.CAPTURE}`}_getAlternateIdsFromGraphResponse(e){var t,n;let r=(t=e==null||(n=e.sources)==null||(n=n.id5)==null||(n=n.clusters)==null?void 0:n.map(e=>{var t,n,r;let i=((t=(n=e.ids)==null?void 0:n.find(e=>e.startsWith(`id5:`)))==null?``:t).replace(`id5:`,``),a=e.traits.cookieType,o=(r=e.traits)==null?void 0:r.lastSeen;return{id:i,type:a,lastSeen:o}}))==null?[]:t,i=r.reduce((e,t)=>{let n=e.find(e=>e.type===t.type);return n?t.lastSeen>n.lastSeen&&(e[e.indexOf(n)]=t):e.push(t),e},[]),a=i.map(({id:e,type:t})=>({id:e,type:t}));return a}_setAlternateIdsAsEids(e){if(!e.length)return;let t=e.reduce((e,t)=>{let n=t$[t.type],r=e.find(e=>e.source===n);return r?r.uids.push({atype:3,id:t.id}):n&&e.push({source:n,matcher:`id5-sync.com`,inserter:`cafemedia.com`,mm:5,uids:[{atype:3,id:t.id}]}),e},[]);this._ortb2.addEidsToOrtb2(t)}async _storeIdentifiers(e,t,n,r){let i=this._getLegacyBridgedHemSource(t),a=Bs(),o=e,s=`externalDCN`;if(r)this._emailCaptureHandler.emailCaptured.emit({pii:{sha256Hash:o,source:i,sourceCollectedDate:a,alternateIds:n},identityDataSource:s});else{let e=Ys(s,i,this._siteConfig.id,void 0,{sha256Hash:o},a,n);e&&await io(e,this._siteConfig.id,this._context.querystring.get(`adt_encrypt`)!==`false`)}}},n$=D([Q(`OptableID5ResolverComponent`),S(),A(`design:paramtypes`,[typeof(RQ=L!==void 0&&L)==`function`?RQ:Object,typeof(zQ=qa!==void 0&&qa)==`function`?zQ:Object,typeof(BQ=ga!==void 0&&ga)==`function`?BQ:Object,typeof(VQ=va!==void 0&&va)==`function`?VQ:Object,typeof(HQ=Ea!==void 0&&Ea)==`function`?HQ:Object,typeof(UQ=co!==void 0&&co)==`function`?UQ:Object,typeof(WQ=Ss!==void 0&&Ss)==`function`?WQ:Object,typeof(GQ=Jw!==void 0&&Jw)==`function`?GQ:Object,typeof(KQ=la!==void 0&&la)==`function`?KQ:Object,typeof(qQ=$C!==void 0&&$C)==`function`?qQ:Object,typeof(JQ=hs!==void 0&&hs)==`function`?JQ:Object,typeof(YQ=Nr!==void 0&&Nr)==`function`?YQ:Object,typeof(XQ=IQ!==void 0&&IQ)==`function`?XQ:Object,typeof(ZQ=LQ!==void 0&&LQ)==`function`?ZQ:Object,typeof(QQ=oo!==void 0&&oo)==`function`?QQ:Object,typeof($Q=ow!==void 0&&ow)==`function`?$Q:Object,typeof(e$=Pr!==void 0&&Pr)==`function`?e$:Object])],n$)})),r$,i$=o((()=>{bt(),w(),wt(),E(),O(),r$=class extends Ct{constructor(...e){super(...e),T(this,`stickyContainerContentAdStylingApplied`,new yt)}},r$=D([C()],r$)})),a$,o$=o((()=>{a$=e=>{let t=e.firstChild?e.firstChild:void 0,n=t?getComputedStyle(t).height:`0px`,r=Number(n.slice(0,-2));return r}})),s$,Whe=o((()=>{w(),Ui(),E(),O(),s$=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`ParallaxAdLogError`,this._lookup=`PALE`}},s$=D([C()],s$)})),c$,l$,u$,d$,f$,p$,m$,h$,g$,_$,Ghe=o((()=>{Na(),$(),w(),H(),FS(),X(),i$(),rU(),o$(),B(),Whe(),Bh(),Wr(),j(),E(),O(),_$=class extends V{constructor(e,t,n,r,i,a,o,s,c){super(),this._pageManager=e,this._slotManager=t,this._stickyContainerAdsEventBus=n,this._videoEventBus=r,this._config=i,this._parallaxAdLogErrorExperiment=a,this._gamEventBus=o,this._slotEventBus=s,this._slotManagerEventBus=c,T(this,`_parallaxSlotMap`,new Map),T(this,`_parallaxScrollEventOffMap`,new Map),T(this,`_slotRebuildComplete`,new Map),T(this,`_stickyContainerAdsApplied`,!1),T(this,`_scrollStartPosition`,300),T(this,`_slotScrollStartPosition`,new Map)}get enabled(){return!1}start(){this._setupListeners()}_setupListeners(){this._stickyContainerAdsEventBus.stickyContainerContentAdStylingApplied.on(()=>{this._stickyContainerAdsApplied=!0},{handleEventsAlreadyEmitted:!0}),this._videoEventBus.topCenterVideoCollapsed.on(()=>{this._scrollStartPosition=500}),this._videoEventBus.topCenterVideoUnCollapsed.on(()=>{this._scrollStartPosition=300}),this._gamEventBus.slotOnload.on(({slotId:e})=>this._parallaxSetup(e)),this._slotEventBus.adRenderedOutsideGAM.on(({slotId:e})=>this._parallaxSetup(e)),this._slotManagerEventBus.refreshing.on(e=>{let t=this._slotManager.getSlots(e);t.forEach(e=>{let t=e.element.id;e.location===F.Content&&!this._slotRebuildComplete.get(t)&&!this._parallaxSlotMap.get(t)&&!this._stickyContainerAdsApplied&&this._rebuildSlot(e)})})}_parallaxSetup(e){let t=this._slotManager.getSlot(e);if(t&&t.location===F.Content){let e=t.element;this._stickyContainerAdsApplied&&this._removeParallaxCSS(e),this._removeParallaxScrollEvent(e);let n=this._isParallaxAd(e);if(n){M.event(`ParallaxComponent`,`_setupListeners`,`parallax_rendered`,t.element.id,t.refreshCount);let n=e.firstChild?e.firstChild:null;this._parallaxSlotMap.set(e.id,!0),this._setParallaxSlotCSS(e,n),this._parallaxAdOnScroll(e),this._parallaxAdLogErrorExperiment.result&&this._checkParallaxAdVisibilityPercent(e,n)}}}_setParallaxSlotCSS(e,t){e.classList.add(`adthrive-parallax-slot`),t&&t.classList.add(`adthrive-parallax-ad`)}_removeParallaxCSS(e){e.classList.remove(`adthrive-parallax-slot`);let t=e.firstChild;t&&t.classList.remove(`adthrive-parallax-ad`)}_removeParallaxScrollEvent(e){let t=this._parallaxScrollEventOffMap.get(e.id);t&&t()}_parallaxAdOnScroll(e){let t=Number(e.getBoundingClientRect().top)+window.pageYOffset,n=()=>{let n=e.firstChild?e.firstChild:void 0,r=this._isParallaxAd(e),i=t<window.pageYOffset+window.innerHeight,a=this._getScrollStartPosition(i,e),o=(window.pageYOffset-t+a)*.5,s=o>205?205:o;n&&r&&(n.style.transform=`translateY(-${s}px)`)};this._parallaxScrollEventOffMap.set(e.id,this._pageManager.scroll.on(()=>n()))}_getScrollStartPosition(e,t){return e?this._slotScrollStartPosition.get(t.id)||this._scrollStartPosition:(this._slotScrollStartPosition.get(t.id)!==this._scrollStartPosition&&this._slotScrollStartPosition.set(t.id,this._scrollStartPosition),this._scrollStartPosition)}_isParallaxAd(e){let t=a$(e);return t>=600&&t<=750}_rebuildSlot(e){e.sizes=e.sizes.filter(e=>e[1]<600),this._slotManager.rebuild(e),this._slotRebuildComplete.set(e.element.id,!0)}_checkParallaxAdVisibilityPercent(e,t){let n=new IntersectionObserver(r=>{r.forEach(r=>{let i=r.intersectionRatio*100,a=a$(e),o=400/a*100;o-i>2&&this._logParallaxAdError(e,t,`adVisibility`,Math.floor(o-i)),n.unobserve(r.target)})},{root:e});t&&n.observe(t)}_logParallaxAdError(e,t,n,r){M.error(`ParallaxComponent`,`_logParallaxAdError`,`parallax ad error: ${n}, visibility percent lost:`,r,`siteId: ${this._config.site.id}`,`pageUrl: ${window.location.href}`,`containerId: ${e.id}`,`creativeId: ${t==null?void 0:t.id}`)}},_$=D([S(),Q(`ParallaxAdsComponent`),A(`design:paramtypes`,[typeof(c$=ja!==void 0&&ja)==`function`?c$:Object,typeof(l$=PS!==void 0&&PS)==`function`?l$:Object,typeof(u$=r$!==void 0&&r$)==`function`?u$:Object,typeof(d$=eU!==void 0&&eU)==`function`?d$:Object,typeof(f$=z!==void 0&&z)==`function`?f$:Object,typeof(p$=s$!==void 0&&s$)==`function`?p$:Object,typeof(m$=zh!==void 0&&zh)==`function`?m$:Object,typeof(h$=Vr!==void 0&&Vr)==`function`?h$:Object,typeof(g$=Ur!==void 0&&Ur)==`function`?g$:Object])],_$)})),v$,y$,b$,x$,S$,C$,w$,T$,E$,D$,Khe=o((()=>{w(),_a(),$(),so(),gs(),fo(),$h(),rU(),bt(),Z(),Rm(),ao(),$s(),Ra(),Da(),lo(),B(),j(),E(),O(),D$=class{constructor(e,t,n,r,i,a,o,s,c){this._emailCaptureHandler=e,this._gdprEvents=t,this._ccpa=n,this._gdpr=r,this._site=i,this._context=a,this._gam=o,this._identityEventBus=s,this._optableConfig=c,T(this,`_consent`,``),T(this,`_gdprConsentAccepted`,!1),T(this,`_emailCounted`,!1),T(this,`_dataCapturedEmitted`,!1),T(this,`_emailCaptureQueue`,[]),T(this,`_queuePromise`,Promise.resolve()),T(this,`piiCaptured`,new k)}init(){this._emailCaptureHandler.emailCaptured.on(e=>{this._handleEmailCapture(e)},{handleEventsAlreadyEmitted:!0}),this._gdprEvents.consentResponseCaptured.on(e=>this._handleGdprConsentCapture(e),{handleEventsAlreadyEmitted:!0}),this._ccpa.consentChange.on(e=>this._handleCCPAConsentChange(e==null?``:e))}_handleEmailCapture(e){this._emailCaptureQueue.push(e),(!this._gdpr.enabled||this._gdprConsentAccepted)&&(this._queuePromise=this._queuePromise.then(()=>this._processEmailCaptureQueue()))}_handleGdprConsentCapture(e){this._gdprConsentAccepted=uo(this._gdpr.raptiveVendorId,[1]),this._consent=e,this._gdprConsentAccepted&&this._emailCaptureQueue.length>0?this._queuePromise=this._queuePromise.then(()=>this._processEmailCaptureQueue()):this._gdprConsentAccepted}async _processEmailCaptureQueue(){for(;this._emailCaptureQueue.length>0;){if(this._gdpr.enabled&&!this._gdprConsentAccepted)return;let e=this._emailCaptureQueue.shift();if(!e)return;let{pii:{email:t,source:n,sourceCollectedDate:r,alternateIds:i}={},identityDataSource:a,identityDataMap:o}=e,s=await this._makeHashObject(e),c={email:t,source:n==null?``:n,sourceCollectedDate:r==null?null:r,hashObj:s},l;if(a===`iframe`||a===`browserStorage`){if(o){let e=qs(o);e&&(l=typeof e.d==`string`?await to(e.d,e.s):e.d),a===`iframe`&&(l.iframe=!0),a===`browserStorage`&&(l.collectionSource=`storage`)}}else l=Ys(a,c.source,this._site.id,t,c.hashObj,c.sourceCollectedDate,i);l&&await this._processPii(l,a),this._processPiiLegacy(c)}}_processPiiLegacy(e){this._gdpr.enabled&&!this._gdprConsentAccepted||(U.setInternalLocalStorage(`adt_emsrc`,e.source),U.setInternalLocalStorage(`adt_ei`,e.hashObj),this._setGamTargetingFlags([{key:`emsrc`,value:[e.source]},{key:`hem`,value:[`1`]}]),e.sourceCollectedDate&&(U.setInternalLocalStorage(`adt_emsrc_cd`,e.sourceCollectedDate),this._setGamTargetingFlags([{key:`hem_cd`,value:[e.sourceCollectedDate]}])),this._identityEventBus.dataCapturedLegacy.emit({email:e.email,...e.hashObj,consent:this._consent,source:e.source,sourceCollectedDate:e.sourceCollectedDate}))}async _processPii(e,t){if(this._gdpr.enabled&&!this._gdprConsentAccepted||!e)return;let n=await no(!0),r=this.shouldShareWithPartners(e);if(r){let t=this.shouldCaptureIdentityData(e,n);t&&(this._identityEventBus.dataCaptured.emit(e),this._dataCapturedEmitted=!0,this._setGamTargetingFlags([{key:`hem_shared`,value:[`1`]}])),this._identityEventBus.dataCapturedForIframe.emit(e)}let i=this.shouldStoreIdentityData(e,n);M.log(`PiiManager`,`_processPii`,{identityDataSource:t,shouldShareWithPartners:r,shouldStoreIdentityData:i}),i?await io(e,this._site.id,this._context.querystring.get(`adt_encrypt`)!==`false`).then(n=>{e&&this._setIdentityDataTargeting(e,n,t)}):(this._setIdentityDataTargeting(e,n||{},t),this._context.querystring.get(`adt_encrypt`)===`false`&&Ate()),t===`iframe`&&this._identityEventBus.iframeDataSynced.emit()}_setGamTargetingFlags(e){for(let{key:t,value:n,overwrite:r}of e)this._gam.setTargetingFlag(t,n,r==null?!0:r)}_setIdentityDataTargeting(e,t,n){let r=this._convertIdentityDataToGamTargetingValue(e,t||{});this._gam.setTargeting({key:`adt_i`,value:r})}shouldShareWithPartners(e){return!(e.collectionMethod===`graph3p`&&!this._optableConfig.enabled)}shouldCaptureIdentityData(e,t){if(this._dataCapturedEmitted===!1||!t)return!0;let n=qs(t);if(n){let t=[`direct`,`graph1p`,`graph3p`,`liveIntent`],r=t.findIndex(t=>t===e.collectionMethod);if(typeof n.d!=`string`){let i=t.findIndex(e=>e===(typeof n.d!=`string`&&n.d.collectionMethod));if(r>=0&&i>=0){if(r<i)return!0;if(r===i){if(!n.d.collectionDate)return!0;let t=new Date(e.collectionDate||``),r=new Date(n.d.collectionDate||``);if(t>r)return!0;if(t.getTime()===r.getTime()){if(e.collectionSiteId===n.d.collectionSiteId)return!1;if(e.collectionSiteId===this._site.id)return!0}}}}}return!1}shouldStoreIdentityData(e,t){if(!e)return!1;if(!t||!Object.keys(t).length)return!0;let n=t[e.collectionMethod];if(n&&n.d&&typeof n.d==`object`&&n.d.collectionDate&&e.collectionDate){let t=new Date(n.d.collectionDate),r=new Date(e.collectionDate);if(r<t||r.getTime()===t.getTime()&&(e.collectionSiteId===n.d.collectionSiteId||n.d.collectionSiteId===this._site.id))return!1}return!0}_convertIdentityDataToGamTargetingValue(e,t){let n=[];switch(e.collectionMethod){case`direct`:if(n.push(`cm:d`),e.directSource){let t=Xs(e.directSource);n.push(`ds:${t}`)}break;case`graph1p`:n.push(`cm:dcn1`),e.bridgingMethod&&n.push(`bm1:${e.bridgingMethod}`);break;case`graph3p`:if(n.push(`cm:dcn2`),e.graphSource){let t=Zs(e.graphSource);n.push(`gs:${t}`)}if(e.bridgingMethod){let t=e.bridgingMethod;if(t){let e=Qs(t);n.push(`bm3:${e}`)}}break;case`liveIntent`:n.push(`cm:sdkli`),e.withUid2&&n.push(`u2`);break}switch(e.collectionSource){case`capture`:n.push(`cs:c`);break;case`storage`:n.push(`cs:s`);break}return n.push(`cd:${e.collectionDate}`),e.collectionSiteId!==this._site.id&&n.push(`xs`),e.iframe&&n.push(`if`),t.direct&&n.push(`d`),t.graph1p&&n.push(`dcn1`),t.graph3p&&n.push(`dcn2`),t.liveIntent&&n.push(`sdkli`),n}async _makeHashObject(e){let{pii:{email:t,sha256Hash:n,sha1Hash:r}={}}=e,i={sha256Hash:``,sha1Hash:``};if(n||r)i={sha256Hash:n||``,sha1Hash:r||``};else if(t){let e=await this._getHashObjectFromEmail(t);e&&(i=e)}return i}async _getHashObjectFromEmail(e){if(!(`msCrypto`in window)&&location.protocol===`https:`&&`crypto`in window&&`TextEncoder`in window){let t=new TextEncoder().encode(e),[n,r]=await Promise.all([this._convertToSpecificHashType(`SHA-256`,t),this._convertToSpecificHashType(`SHA-1`,t)]);return{sha256Hash:n,sha1Hash:r}}}async _convertToSpecificHashType(e,t){let n=await crypto.subtle.digest(e,t),r=Array.from(new Uint8Array(n)),i=r.map(e=>(`00`+e.toString(16)).slice(-2)).join(``);return i}_handleCCPAConsentChange(e=``){let t=U.readInternalLocalStorage(`adt_ei`),n=U.readInternalLocalStorage(`adt_emsrc`),r=e===this._ccpa.ccpaOptOut;if(this._consent=e==null?``:e,Qt()){let e=U.readInternalCookie(`adt_ei`),t=U.readInternalCookie(`adt_emsrc`);(e||t)&&r&&(U.deleteCookie(`adt_ei`),U.deleteCookie(`adt_emsrc`),U.deleteCookie(`adt_i`))}(t||n)&&r&&(U.deleteLocalStorage(`adt_ei`),U.deleteLocalStorage(`adt_emsrc`),U.deleteLocalStorage(`adt_emsrc_cd`),U.deleteLocalStorage(`adt_i`))}},D$=D([Q(`PiiManager`),C(),A(`design:paramtypes`,[typeof(v$=hs!==void 0&&hs)==`function`?v$:Object,typeof(y$=oo!==void 0&&oo)==`function`?y$:Object,typeof(b$=Ea!==void 0&&Ea)==`function`?b$:Object,typeof(x$=co!==void 0&&co)==`function`?x$:Object,typeof(S$=qa!==void 0&&qa)==`function`?S$:Object,typeof(C$=L!==void 0&&L)==`function`?C$:Object,typeof(w$=Zh!==void 0&&Zh)==`function`?w$:Object,typeof(T$=Nr!==void 0&&Nr)==`function`?T$:Object,typeof(E$=ga!==void 0&&ga)==`function`?E$:Object])],D$)})),qhe=o((()=>{Khe()})),O$,k$,A$,j$,M$,N$,Jhe=o((()=>{w(),jc(),Yw(),$(),Zw(),ya(),Da(),rU(),j(),E(),O(),N$=class extends Xw{constructor(e,t,n,r,i){super(),this._gpcConfig=e,this._ccpaConfig=t,this._prebidMethods=n,this._userIds=r,this._userIdEventBus=i,T(this,`_name`,`connectId`),T(this,`_userId`,void 0),this._userId=this._userIds.get(this._name)}get enabled(){var e,t;return!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut&&((e=(t=this._userId)==null?void 0:t.enabled)==null?!1:e)}updateUserIds(){var e;let t=(e=this._prebidMethods.getConfig(`userSync.userIds`))==null?[]:e;return t.map(e=>(this._userId&&e.name===this._userId.id.name&&(e=this._userId.id),e))}processPii(e){this._prebidMethods.addToQueue(()=>{this.run(e)})}run(e){if(this._userId&&e.sha256Hash&&this._userId.id.params){this._userId.id.params.he=e.sha256Hash;let t=this.updateUserIds();this._prebidMethods.setConfig({userSync:{userIds:t}},!1),this._userIdEventBus.userIdNeedsRefresh.emit({options:{submoduleNames:[this._name]},callback:()=>void 0})}}},N$=D([Q(`YahooPiiPartner`),S(),A(`design:paramtypes`,[typeof(O$=va!==void 0&&va)==`function`?O$:Object,typeof(k$=Ea!==void 0&&Ea)==`function`?k$:Object,typeof(A$=R!==void 0&&R)==`function`?A$:Object,typeof(j$=Jw!==void 0&&Jw)==`function`?j$:Object,typeof(M$=Lr!==void 0&&Lr)==`function`?M$:Object])],N$)})),P$,F$,I$,L$,R$,z$,B$,Yhe=o((()=>{Zw(),jc(),Yw(),$(),w(),ya(),Da(),rU(),vS(),j(),E(),O(),B$=class extends Xw{constructor(e,t,n,r,i,a){super(),this._gpcConfig=e,this._ccpaConfig=t,this._prebidMethods=n,this._userIds=r,this._userIdEventBus=i,this._id5IdModule=a,T(this,`_name`,`id5Id`),T(this,`_userId`,void 0),this._userId=this._userIds.get(this._name)}get enabled(){var e,t;return!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut&&((e=(t=this._userId)==null?void 0:t.enabled)==null?!1:e)}processPii(e){this._prebidMethods.addToQueue(()=>{this.run(e)})}updateUserIds(){var e;let t=(e=this._prebidMethods.getConfig(`userSync.userIds`))==null?[]:e;return t.map(e=>(this._userId&&e.name===this._userId.id.name&&(e=this._userId.id),e))}async run(e){if(e.sha256Hash&&this._userId&&this._userId.id.params){let t=this.updateUserIds();if(e.collectionMethod===`graph3p`)return;e.sha256Hash&&(this._userId.id.params.pd=await this._id5IdModule.getPdString(e.sha256Hash)),this._prebidMethods.setConfig({userSync:{userIds:t}},!1),this._userIdEventBus.userIdNeedsRefresh.emit({options:{submoduleNames:[this._userId.id.name]},callback:()=>void 0})}}},B$=D([S(),Q(`Id5PiiPartner`),A(`design:paramtypes`,[typeof(P$=va!==void 0&&va)==`function`?P$:Object,typeof(F$=Ea!==void 0&&Ea)==`function`?F$:Object,typeof(I$=R!==void 0&&R)==`function`?I$:Object,typeof(L$=Jw!==void 0&&Jw)==`function`?L$:Object,typeof(R$=Lr!==void 0&&Lr)==`function`?R$:Object,typeof(z$=Db!==void 0&&Db)==`function`?z$:Object])],B$)})),V$,H$,U$,Xhe=o((()=>{Zw(),B(),jc(),$(),w(),Fn(),j(),O(),U$=class extends Xw{constructor(e,t){super(),this._config=e,this._prebidMethods=t}get enabled(){let e=this._config.partners;return!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut&&!!(e.display.get(P.Criteo)||e.video.get(P.Criteo))}processPii(e){this._prebidMethods.addToQueue(()=>{this.run(e)})}run(e){var t;if(e&&((t=e.sha256Hash)==null?e.sha1Hash:t)){var n;this._prebidMethods.setBidderConfig({bidders:[P.Criteo],config:{ortb2:{user:{ext:{data:{eids:[{source:`cafemedia.com`,uids:[{id:(n=e.sha256Hash)==null?e.sha1Hash:n,atype:3,ext:{stype:`hemsha256`}}]}]}}}}}})}}},U$=D([S(),Q(`CriteoBidderPiiPartner`),A(`design:paramtypes`,[typeof(V$=z!==void 0&&z)==`function`?V$:Object,typeof(H$=R!==void 0&&R)==`function`?H$:Object])],U$)})),W$,G$,K$,q$,J$,Y$,Zhe=o((()=>{Zw(),jc(),Yw(),$(),w(),ya(),Da(),rU(),j(),E(),O(),Y$=class extends Xw{constructor(e,t,n,r,i){super(),this._gpcConfig=e,this._ccpaConfig=t,this._prebidMethods=n,this._userIds=r,this._userIdEventBus=i,T(this,`_name`,`fabrickId`),T(this,`_userId`,void 0),this._userId=this._userIds.get(this._name)}get enabled(){var e,t;return!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut&&((e=(t=this._userId)==null?void 0:t.enabled)==null?!1:e)}processPii(e){}_run(e){var t;let n=(t=this._prebidMethods.getConfig(`userSync.userIds`))==null?[]:t,r=n.find(e=>e.name===this._name),i=n.filter(e=>e.name!==this._name),a=!!r,o=this._userId&&this._userId.id.params&&this._userId.id.params.hasOwnProperty(`e`);a&&!o&&(this._prebidMethods.setConfig({userSync:{userIds:[...i,{...r,params:{...r==null?void 0:r.params,e:e.sha256Hash}}]}},!1),this._userIdEventBus.userIdNeedsRefresh.emit({options:{submoduleNames:[this._name]},callback:()=>void 0}))}},Y$=D([S(),Q(`FabrickPiiPartner`),A(`design:paramtypes`,[typeof(W$=va!==void 0&&va)==`function`?W$:Object,typeof(G$=Ea!==void 0&&Ea)==`function`?G$:Object,typeof(K$=R!==void 0&&R)==`function`?K$:Object,typeof(q$=Jw!==void 0&&Jw)==`function`?q$:Object,typeof(J$=Lr!==void 0&&Lr)==`function`?J$:Object])],Y$)})),Qhe=o((()=>{LT()})),X$,Z$,Q$,$$,e1,t1,n1,r1,i1,a1,o1,s1,c1,l1,u1,$he=o((()=>{w(),$(),Zw(),X(),Tr(),ua(),_a(),ya(),Da(),Yw(),rU(),Op(),zd(),Ja(),Z(),Km(),Qhe(),ys(),jc(),Rm(),oT(),ew(),j(),E(),O(),u1=class extends Xw{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p){super(),this._optableConfig=e,this._gpcConfig=t,this._ccpaConfig=n,this._fledgeConfig=r,this._userAgentConfig=i,this._siteConfig=a,this._optableStore=o,this._optableSdkWrapper=s,this._userIds=c,this._userIdTargeting=l,this._identityEventBus=u,this._prebidMethods=d,this._userSyncConfig=f,this._ortb2=p,T(this,`_userIdSources`,[{userId:this._userIds.get(`id5Id`),variant:0},{userId:this._userIds.get(`unifiedId`),variant:5},{userId:this._userIds.get(`sharedId`),variant:6}]),T(this,`_sspSources`,[{source:`liveintent.sovrn.com`,variant:1},{source:`pubmatic.com`,variant:2},{source:`flashtalking.com`,variant:4},{source:`crwdcntrl.net`,variant:7},{source:`openx.net`,variant:8},{source:`rubiconproject.com`,variant:9}]),T(this,`_identityValidators`,{e:Vm,i4:Vm,i6:Vm,p:Vm,c:Wm,c1:Gm(10),c2:Hm,c3:Hm,c4:Um,c5:Hm,c6:Hm,c7:Vm,c8:Hm,c9:Gm(10)})}get enabled(){return this._optableConfig.enabled&&!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.enabled}async init(){if(this.enabled)try{var e;this._setupEventListeners();let t=U.readInternalLocalStorage(`adt_otpgrd`);t&&this._setPubmaticSspIdAsEidFromGraphResponse(t);let[n,r]=await Promise.all([this._collectIdentifiersFromSSP(),this._collectIdentifiersFromUserIds()]);await this._processIdentifiers([...n,...r]);let i={os:this._userAgentConfig.os,browser:this._userAgentConfig.browser,device:this._userAgentConfig.device,cookieDeprecationLabel:(e=this._fledgeConfig.cookieDeprecationLabel)==null?``:e};await this._processTraits(i)}catch(e){}}processPii(e){var t;if(!e||!this.enabled||!((t=window.optable)!=null&&t.auth)||e.collectionMethod===`liveIntent`)return;let n={},r=[];if(e.collectionDate&&(n.hem_cd=e.collectionDate),e.collectionMethod===`direct`||e.collectionMethod===`graph1p`){let t=`${Sr.EMAIL}${e.sha256Hash}`;r.push(t);let i=e.collectionMethod===`direct`&&e.directSource?e.directSource:e.collectionMethod===`graph1p`&&e.bridgingMethod?e.bridgingMethod:`unknown`;n.hem_sources=i==null?`unknown`:i,n.hem_dates=Bs(),n.hem_sites=`s-${this._siteConfig.id}`,this._optableStore.truedataHems.length&&(n.td_hems=this._optableStore.truedataHems.join(`,`))}this._processIdentifiers(r),this._processTraits(n)}_setupEventListeners(){this._identityEventBus.optableIdentitiesCaptured.on(e=>{this._processIdentifiers(e)},{handleEventsAlreadyEmitted:!0}),this._identityEventBus.optableTraitsCaptured.on(e=>{this._processTraits(e)},{handleEventsAlreadyEmitted:!0}),this._identityEventBus.optableUid1Captured.on(e=>{this._handleOptableUid1Captured(e)},{handleEventsAlreadyEmitted:!0}),this._identityEventBus.optableThirdPartyGraphResolved.on(e=>{e&&this._setPubmaticSspIdAsEidFromGraphResponse(e)},{handleEventsAlreadyEmitted:!0})}async _collectIdentifiersFromUserIds(){try{let e=this._userIdSources.reduce((e,{userId:t,variant:n})=>{if(!t)return e;let r=this._userIdTargeting.getParsedUserIdStoredValue(t);return r?[...e,this._optableSdkWrapper.cid(r,n)]:e},[]);return Promise.all(e)}catch(e){return M.error(`OptablePiiPartner`,`_collectIdentifiersFromUserIds`,`Failed to collect identifiers from UserIds`,e),[]}}async _collectIdentifiersFromSSP(){try{await qK(3e3);let e=this._prebidMethods.getUserIdsAsEids(),t=this._sspSources.reduce((t,{source:n,variant:r})=>{if(!n)return t;let i=e==null?void 0:e.find(e=>e.source===n);return i&&i.uids.length>0?[...t,this._optableSdkWrapper.cid(i.uids[0].id,r)]:t},[]);return Promise.all(t)}catch(e){return M.error(`OptablePiiPartner`,`_collectIdentifiersFromSSP`,`Failed to collect identifiers from SSPs`,e),[]}}async _processIdentifiers(e){try{let t=this._santitizeIdentifiers(e);if(!t.length)return;await this._optableSdkWrapper.identify(...t)}catch(t){M.error(`OptablePiiPartner`,`_processIdentifiers`,`Failed to process identifiers`,{identifiers:e,error:t})}}_santitizeIdentifiers(e){return e.filter(e=>{if(typeof e!=`string`||!e.length)return!1;let[t,n]=e.split(`:`,2),r=this._identityValidators[t];return r?r(n):!1})}async _processTraits(e){try{let t=this._sanitizeTraits(e);if(!Object.keys(t).length)return;await this._optableSdkWrapper.profile(t)}catch(t){M.error(`OptablePiiPartner`,`_processTraits`,`Failed to process traits`,{traits:e,error:t})}}_sanitizeTraits(e){return Object.entries(e).reduce((e,[t,n])=>(typeof n==`string`&&n.length&&(e[t]=n),e),{})}_handleOptableUid1Captured(e){this._ortb2.addEidsToOrtb2(e)}async _setPubmaticSspIdAsEidFromGraphResponse(e){var t,n;if(!(!(e==null||(t=e.sources)==null||(t=t.mediawallah)==null||(t=t.clusters)==null)&&t.length)||(await this._prebidMethods.waitForQueue(),this._userSyncConfig.isPubmaticEidSetByLiveIntent))return;let r=e==null||(n=e.sources)==null||(n=n.mediawallah)==null?void 0:n.clusters,i=r.reduce((e,t)=>{var n;let r=(n=t.ids)==null?[]:n;return[...e,...r]},[]),a=i.filter(e=>e.startsWith(Cr.PUBMATIC_SSP_ID));if(!(a!=null&&a.length))return!1;let o=a[Math.floor(Math.random()*a.length)].replace(Cr.PUBMATIC_SSP_ID,``);this._prebidMethods.setBidderConfig({bidders:[P.Pubmatic],config:{ortb2:{user:{ext:{data:{eids:[{source:`mediawallah.com`,uids:[{id:o}]}]}}}}}}),this._userSyncConfig.pubmaticBidderLevelEidSource=`mediawallah-dcn`}},u1=D([Q(`OptablePiiPartner`),S(),A(`design:paramtypes`,[typeof(X$=ga!==void 0&&ga)==`function`?X$:Object,typeof(Z$=va!==void 0&&va)==`function`?Z$:Object,typeof(Q$=Ea!==void 0&&Ea)==`function`?Q$:Object,typeof($$=Ld!==void 0&&Ld)==`function`?$$:Object,typeof(e1=Dp!==void 0&&Dp)==`function`?e1:Object,typeof(t1=qa!==void 0&&qa)==`function`?t1:Object,typeof(n1=vs!==void 0&&vs)==`function`?n1:Object,typeof(r1=la!==void 0&&la)==`function`?r1:Object,typeof(i1=Jw!==void 0&&Jw)==`function`?i1:Object,typeof(a1=IT!==void 0&&IT)==`function`?a1:Object,typeof(o1=Nr!==void 0&&Nr)==`function`?o1:Object,typeof(s1=R!==void 0&&R)==`function`?s1:Object,typeof(c1=iT!==void 0&&iT)==`function`?c1:Object,typeof(l1=$C!==void 0&&$C)==`function`?l1:Object])],u1)})),d1,f1,p1,m1,h1,g1,ege=o((()=>{Zw(),jc(),Yw(),$(),w(),B(),so(),rU(),j(),E(),O(),g1=class extends Xw{constructor(e,t,n,r,i){super(),this._config=e,this._events=t,this._prebidMethods=n,this._userIdEventBus=i,T(this,`_name`,`liveIntentId`),T(this,`_userId`,void 0),this._userId=r.get(this._name),this._config.gdpr.enabled?this._events.consentResponseCaptured.on(e=>void this._pixelSync(e)):this._pixelSync()}get enabled(){var e,t;return!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut&&((e=(t=this._userId)==null?void 0:t.enabled)==null?!1:e)}async _getGdprConsent(){let e=`tcunavailable`;return typeof window.__tcfapi==`function`&&(e=await new Promise(t=>{window.__tcfapi(`getTCData`,2,n=>{n&&n.tcString&&n.tcString.length?t(n.tcString):t(e)})})),`&gdpr=1&gdpr_consent=${e}`}async _pixelSync(e){let t=``;this._config.gdpr.enabled&&(t=e?`&gdpr=1&gdpr_consent=${e}`:await this._getGdprConsent());let n=this._config.ccpa.required?`&us_privacy=${this._config.ccpa.privacyString}`:``,r=`https://pixel.rubiconproject.com/token?pid=49096${t}${n}`,i=new Image;i.src=r,i.style.display=`none`,i.alt=``,document.body.appendChild(i)}processPii(e){this._prebidMethods.addToQueue(()=>{this.run(e)})}run(e){var t;let n=(t=window.liQ_instances)==null?void 0:t[0],r=!!(n!=null&&n.ready);if(r&&e.collectionMethod!==`graph3p`&&e.collectionMethod!==`liveIntent`&&e.sha256Hash&&this._userId&&this._userId.id.params){var i;let t=e.sha256Hash;t&&t.length>64&&(M.event(`LiveIntentPiiPartner`,`run`,`Detected nested sha256Hash value. Attempting to extract value before sending to liveConnect.`),t=this._retrieve64BitString(t)),this._userId.id.params.emailHash=t;let r=this.updateUserIds();this._prebidMethods.setConfig({userSync:{userIds:r}},!1),this._userIdEventBus.userIdNeedsRefresh.emit({options:{submoduleNames:[this._userId.id.name]},callback:()=>void 0}),n.push({hash:(i=t)==null?``:i})}}updateUserIds(){var e;let t=(e=this._prebidMethods.getConfig(`userSync.userIds`))==null?[]:e;return t.map(e=>(this._userId&&e.name===this._userId.id.name&&(e=this._userId.id),e))}_retrieve64BitString(e){let t=e.match(/\w{64}/);return t?t[0]:void 0}},g1=D([S(),Q(`LiveIntentPiiPartner`),A(`design:paramtypes`,[typeof(d1=z!==void 0&&z)==`function`?d1:Object,typeof(f1=oo!==void 0&&oo)==`function`?f1:Object,typeof(p1=R!==void 0&&R)==`function`?p1:Object,typeof(m1=Jw!==void 0&&Jw)==`function`?m1:Object,typeof(h1=Lr!==void 0&&Lr)==`function`?h1:Object])],g1)})),_1,tge=o((()=>{Ui(),w(),E(),O(),_1=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`DeclareBridgedUid2`,this._lookup=`DBUID2`}},_1=D([C()],_1)})),v1,y1,b1,x1,S1,C1,w1,T1,E1,D1,nge=o((()=>{w(),$(),B(),Zw(),jc(),Yw(),rU(),qx(),Rm(),ua(),$s(),kx(),tge(),$h(),Rs(),j(),E(),O(),D1=class extends Xw{constructor(e,t,n,r,i,a,o,s,c){super(),this._config=e,this._prebidMethods=t,this._userIds=n,this._userIdEventBus=r,this._idGraphUid2Experiment=i,this._optableSdkWrapper=a,this._liveIntentUid2HemExperiment=o,this._declareBridgedUid2Experiment=s,this._googleAdManager=c,T(this,`_name`,`uid2`),T(this,`_uid2ServerTokenKey`,`__uid2_server_token`),T(this,`_uid2Url`,`https://ads.adthrive.com/api/v2/uid`),T(this,`_userId`,void 0),this._userId=this._userIds.get(this._name)}get enabled(){var e,t;return!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut&&((e=(t=this._userId)==null?void 0:t.enabled)==null?!1:e)}processPii(e){this._prebidMethods.addToQueue(()=>{this.run(e).catch(t=>{M.error(`Uid2PiiPartner`,`processPii`,`Error processing PII`,{pii:e,error:t})})})}async run(e){let t=e.collectionMethod===`direct`||e.collectionMethod===`graph1p`,n=this._idGraphUid2Experiment.result;if(!(!(this._liveIntentUid2HemExperiment.result&&e.collectionMethod===`liveIntent`&&!e.withUid2)&&e.collectionMethod===`liveIntent`)&&!this._config.gdpr.enabled&&e.sha256Hash){if(t)return this.setTTDUId2ServerToken(e,`raptive`);if(n)return this.setTTDUId2ServerToken(e,`optable`)}}updateUserIds(){var e;let t=(e=this._prebidMethods.getConfig(`userSync.userIds`))==null?[]:e;return t.map(e=>(this._userId&&e.name===this._name&&(e=this._userId.id),e))}async setTTDUId2ServerToken(e,t){let n=U.readExternalLocalStorage(this._uid2ServerTokenKey);if(n)return;let r;try{t===`raptive`?r=await this._getTTDUId2ServerTokenFromRaptive(e):t===`optable`&&(r=await this._getTTDUId2ServerTokenFromOptable(e))}catch(e){return}r?(U.setExternalLocalStorage(this._uid2ServerTokenKey,r),this._setUid2WithUpdatedToken({token:r,declareBridged:this._shouldDeclareBridgedUid2(e)})):M.error(`Uid2PiiPartner`,`setTTDUId2ServerToken`,`No UID2 token returned from ${t}`)}_shouldDeclareBridgedUid2(e){let t=e.collectionMethod===`liveIntent`&&!e.withUid2;return(e.collectionMethod===`graph3p`||t)&&this._declareBridgedUid2Experiment.result}_getMacher(e){if(e.collectionMethod===`liveIntent`&&!e.withUid2)return`liveintent.com`;let t=e.graphSource;if(t===`truedata`)return`truedata.com`;if(t===`mediawallah`)return`mediawallah.com`}async _getTTDUId2ServerTokenFromOptable(e){try{var t,n;let i=await this._optableSdkWrapper.tokenize(`e:${e.sha256Hash}`),a;if(!(i==null||(t=i.refs)==null||(t=t[0])==null)&&t.advertising_token)a=i.refs[0];else if(!(i==null||(n=i.user)==null)&&n.eids){var r;let e=i.user.eids.find(e=>e.source===`uidapi.com`);if(!e){M.error(`Uid2PiiPartner`,`_getTTDUId2ServerTokenFromOptable`,`No uidapi.com EID included in response`);return}if(a=(r=e.uids)==null||(r=r[0])==null?void 0:r.ext,!(a!=null&&a.advertising_token)){M.error(`Uid2PiiPartner`,`_getTTDUId2ServerTokenFromOptable`,`No UID2 token or no advertising token included in response`);return}}else{M.error(`Uid2PiiPartner`,`_getTTDUId2ServerTokenFromOptable`,`No valid UID2 token found in either new or legacy format`,`Identity object is`,i);return}if(a.provider=`optable`,this._shouldDeclareBridgedUid2(e)){a.matcher=this._getMacher(e);let t=Ls(a.matcher);t&&this._googleAdManager.setTargetingFlag(`uid2b`,[t],!0)}return a}catch(e){M.error(`Uid2PiiPartner`,`_getTTDUId2ServerTokenFromOptable`,`Failed to tokenize PII`,e);return}}async _getTTDUId2ServerTokenFromRaptive(e){return new Promise((t,n)=>{if(!Ks(e.sha256Hash))return M.event(`Uid2PiiPartner`,`_getTTDUId2ServerTokenFromRaptive`,`piiData.sha256Hash is invalid type or length`,{sha256Hash:e.sha256Hash}),n();let r=new Date().setUTCHours(0,0,0,0),i=`${this._uid2Url}?format=email_hash&value=${e.sha256Hash}&optout_check=1&ts=${r}`;fetch(i).then(async e=>{let{body:r,status:i}=await e.json(),a=r;return i===`optout`?(U.deleteLocalStorage(this._uid2ServerTokenKey),n()):a!=null&&a.advertising_token?(a.provider=`raptive`,a.matcher=`cafemedia.com`,t(a)):n()}).catch(e=>(M.error(`Uid2PiiPartner`,`_getTTDUId2ServerTokenFromRaptive`,`Failed to fetch uid2 token`,e),n(e)))})}_setUid2WithUpdatedToken(e){if(!e.token)return;let t=this._prebidMethods.getConfig(`userSync.userIds`);this._prebidMethods.setConfig({userSync:{userIds:t.map(t=>(t.name===this._name&&t.params&&(t.params.uid2Token=e.token,e.declareBridged&&(t.params.declareBridged=e.declareBridged)),t))}},!1),this._userIdEventBus.userIdNeedsRefresh.emit({options:{submoduleNames:[this._name]},callback:()=>{this._userIdEventBus.uid2Refreshed.emit()}})}},D1=D([S(),Q(`Uid2PiiPartner`),A(`design:paramtypes`,[typeof(v1=z!==void 0&&z)==`function`?v1:Object,typeof(y1=R!==void 0&&R)==`function`?y1:Object,typeof(b1=Jw!==void 0&&Jw)==`function`?b1:Object,typeof(x1=Lr!==void 0&&Lr)==`function`?x1:Object,typeof(S1=Kx!==void 0&&Kx)==`function`?S1:Object,typeof(C1=la!==void 0&&la)==`function`?C1:Object,typeof(w1=Ox!==void 0&&Ox)==`function`?w1:Object,typeof(T1=_1!==void 0&&_1)==`function`?T1:Object,typeof(E1=Zh!==void 0&&Zh)==`function`?E1:Object])],D1)})),O1,k1,A1,j1,rge=o((()=>{w(),Yi(),B(),X(),$(),Z(),Rm(),rd(),Zw(),j(),E(),O(),j1=class extends Xw{constructor(e,t,n){super(),this._config=e,this._amazonMethods=t,this._bootstrapConfig=n,T(this,`_name`,`amz`),T(this,`_tokenKey`,`AMZN-Token`),T(this,`_gdprEnabled`,this._config.gdpr.enabled),T(this,`_userOptedOut`,this._config.ccpa.userOptedOut)}init(){this._regulatoryValidation()}get enabled(){return!this._config.tkho.tracker.includes(this._name)&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}async processPii(e){let t={...this._getHashedRecords(e.sha256Hash),...this._getGDPRConfig(this._config.gdpr.consentCapturedData.consentString),...this._getOptOut()};await wn().then(async()=>{await this._bootstrapConfig.bootstrapLoaders[Rn.Amazon],await this._amazonMethods.rpa(t)})}_getHashedRecords(e=``){return{hashedRecords:[{type:`email`,record:e}]}}_getGDPRConfig(e){let t=this._gdprEnabled;return{gdpr:{enabled:t,...t&&{consent:e}}}}_getOptOut(){let e=this._userOptedOut;return{optOut:e}}_regulatoryValidation(){let e=U.readExternalCookie(this._tokenKey);e&&this._userOptedOut&&this._optOut()}_optOut(){this._amazonMethods.upa({hashedRecords:[],optOut:!0}).catch(()=>{M.error(`AmazonPIIPartner`,`_optOut`,`Failed to run Amazon optout`)})}},j1=D([Q(`AmazonPublisherAudiencesPiiPartner`),S(),A(`design:paramtypes`,[typeof(O1=z!==void 0&&z)==`function`?O1:Object,typeof(k1=Ji!==void 0&&Ji)==`function`?k1:Object,typeof(A1=Ki!==void 0&&Ki)==`function`?A1:Object])],j1)})),M1,N1,P1,F1,ige=o((()=>{w(),jc(),Yw(),$(),Zw(),rU(),j(),E(),O(),F1=class extends Xw{constructor(e,t,n){super(),this._prebidMethods=e,this._userIds=t,this._userIdEventBus=n,T(this,`_name`,`33acrossId`),T(this,`_userId`,void 0),this._userId=this._userIds.get(this._name)}get enabled(){var e,t;return(e=(t=this._userId)==null?void 0:t.enabled)==null?!1:e}processPii(e){this._prebidMethods.addToQueue(()=>{this.run(e)})}run(e){if(this._userId&&e.sha256Hash&&this._userId.id.params){if(e.collectionMethod===`graph3p`)return;this._userId.id.params.hem=e.sha256Hash;let t=this.updateUserIds();this._prebidMethods.setConfig({userSync:{userIds:t}},!1),this._userIdEventBus.userIdNeedsRefresh.emit({options:{submoduleNames:[this._name]},callback:()=>void 0})}}updateUserIds(){var e;let t=(e=this._prebidMethods.getConfig(`userSync.userIds`))==null?[]:e;return t.map(e=>(this._userId&&e.name===this._userId.id.name&&(e=this._userId.id),e))}},F1=D([Q(`ThirtyThreeAcrossPiiPartner`),S(),A(`design:paramtypes`,[typeof(M1=R!==void 0&&R)==`function`?M1:Object,typeof(N1=Jw!==void 0&&Jw)==`function`?N1:Object,typeof(P1=Lr!==void 0&&Lr)==`function`?P1:Object])],F1)})),I1,L1,R1,z1,B1,V1,H1,U1,W1,G1,K1,q1,J1,Y1,X1,age=o((()=>{w(),H(),$(),qhe(),nT(),Jhe(),Yhe(),Xhe(),Zhe(),rU(),$he(),ege(),nge(),B(),Ra(),rge(),ige(),j(),E(),O(),X1=class extends V{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p){super(),this._config=e,this._context=t,this._piiManager=n,this._identityEventBus=r,T(this,`_partners`,void 0),this._partners=[i,a,o,s,c,l,u,d,f,p].filter(e=>e.enabled&&!this._context.isWordPressLogin),this._identityEventBus.dataCaptured.on(e=>{e.collectionMethod===`liveIntent`&&!this._config.audienceTargeting.liveIntentEnabled||this._partners.forEach(t=>{t.processPii(e)})})}start(){this.enabled&&(this._partners.forEach(e=>e.init&&e.init()),this._piiManager.init())}get enabled(){return!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}},X1=D([Q(`PiiCaptureComponent`),S(),A(`design:paramtypes`,[typeof(I1=z!==void 0&&z)==`function`?I1:Object,typeof(L1=L!==void 0&&L)==`function`?L1:Object,typeof(R1=D$!==void 0&&D$)==`function`?R1:Object,typeof(z1=Nr!==void 0&&Nr)==`function`?z1:Object,typeof(B1=j1!==void 0&&j1)==`function`?B1:Object,typeof(V1=U$!==void 0&&U$)==`function`?V1:Object,typeof(H1=Y$!==void 0&&Y$)==`function`?H1:Object,typeof(U1=B$!==void 0&&B$)==`function`?U1:Object,typeof(W1=g1!==void 0&&g1)==`function`?W1:Object,typeof(G1=tT!==void 0&&tT)==`function`?G1:Object,typeof(K1=u1!==void 0&&u1)==`function`?K1:Object,typeof(q1=N$!==void 0&&N$)==`function`?q1:Object,typeof(J1=D1!==void 0&&D1)==`function`?J1:Object,typeof(Y1=F1!==void 0&&F1)==`function`?Y1:Object])],X1)})),oge=o((()=>{age()})),Z1,Q1=o((()=>{w(),$(),E(),O(),Z1=class{constructor(){T(this,`wasClosed`,!1),T(this,`wasStarted`,!1),T(this,`totalTimeCollapsed`,0),T(this,`startedCollapsedTime`,void 0),T(this,`playerName`,void 0)}},Z1=D([Q(`CollapsibleVideoLoggingStore`),C()],Z1)})),$1,e0,sge=o((()=>{rU(),$(),Rm(),w(),j(),E(),O(),e0=class{constructor(e){this._identityEventBus=e,T(this,`knownCookieKeys`,[`AMZN-Token`,`ccuid`,`ccsid`,`usprivacy`,`_pubcid`,`_pubcid_exp`,`connectId`,`lidid`,`TAPAD`,`panaoramaId`,`panaoramaId_expiry`,`krg_crb`,`krg_uid`,`cto_bundle`,`__li_idex_cache_e30`]),T(this,`cookieEvents`,[]),this._identityEventBus.dataCaptured.on(()=>{setTimeout(()=>this.calculateCookieSizes(`piiSubmitted`),2e3)})}init(){}calculateCookieSizes(e){let t=U.getAllCookies(),n=0,r=0;t.forEach(e=>{let t=new Blob([e.value]).size;this.knownCookieKeys.includes(e.name)?n+=t:r+=t}),this.cookieEvents.push({e,knownSize:n,unknownSize:r})}},e0=D([Q(`CookieDataStorage`),C(),A(`design:paramtypes`,[typeof($1=Nr!==void 0&&Nr)==`function`?$1:Object])],e0)})),t0,cge=o((()=>{w(),Ui(),E(),O(),t0=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`UserPageDataLogging`,this._lookup=`UPL`}},t0=D([C()],t0)})),n0,lge=o((()=>{w(),Ui(),E(),O(),n0=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`UserPageDataPrivacyLogging`,this._lookup=`DATAPRIV`}},n0=D([C()],n0)})),r0,i0,a0,o0,s0,c0,l0,u0,d0,f0,p0,m0,h0,g0,uge=o((()=>{jc(),rd(),H(),B(),Ra(),rU(),Wr(),Na(),$(),Z(),w(),Q1(),sge(),vf(),cge(),lge(),ud(),j(),E(),O(),g0=class extends V{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f){super(),this._bootstrapConfig=e,this._cls=t,this._config=n,this._context=r,this._pageManager=i,this._spaEventBus=a,this._prebidMethods=o,this._userPageDataLoggingExperiment=s,this._userPageDataPrivacyLoggingExperiment=c,this._userPageDataLogEvents=l,this._collapsibleVideoLoggingStore=u,this._cookieDataStorage=d,this._slotManagerEventBus=f,T(this,`_userPrivacyData`,{}),T(this,`_timingData`,void 0),T(this,`_performanceTimingData`,{}),T(this,`_setupSlotManagerEventListeners`,async()=>{let{reasons:e}=this._config.disableAds,t=e.size!==0,n={requestingBids:null,requestedBids:null,displayed:null},r={...n,pageLoaded:!1},i=()=>{r={...r,...n}},a=(e,t)=>{r[e]=t,typeof r.requestingBids==`number`&&typeof r.requestedBids==`number`&&typeof r.displayed==`number`&&r.pageLoaded&&(this._setTimingData(r.requestingBids,r.requestedBids,r.displayed),i())};t?(r.requestedBids=0,r.requestingBids=0,r.displayed=0):(this._slotManagerEventBus.requestingBids.once(()=>a(`requestingBids`,AK())),this._slotManagerEventBus.requestedBids.once(()=>a(`requestedBids`,AK())),this._slotManagerEventBus.displayed.once(()=>a(`displayed`,AK()))),await fK().then(()=>a(`pageLoaded`,!0))}),T(this,`_setupUserPageDataLogEventCallbacks`,()=>{tG()&&this._userPageDataLogEvents.addCallbackToQueue([this._pageManager.visibilityChange],()=>{document.visibilityState===`hidden`&&this._logUserData()}),this._userPageDataLogEvents.addCallbackToQueue([this._pageManager.beforeUnload,this._pageManager.pageHide,this._spaEventBus.routeChanged],()=>void this._logUserData())}),T(this,`_getUserData`,()=>{let e=this._getBuildData();return{...e,device:this._context.device,gptv:googletag&&googletag.getVersion&&googletag.getVersion(),timePageOpen:AK()-this._config.timing.started,timeOnPage:this._config.timing.totalTimeOnPage,viewportWidth:window.innerWidth,viewportHeight:window.innerHeight,video:{nonclose:!this._collapsibleVideoLoggingStore.wasClosed,playerName:this._collapsibleVideoLoggingStore.playerName,totalTimeCollapsed:this._collapsibleVideoLoggingStore.totalTimeCollapsed,wasStarted:this._collapsibleVideoLoggingStore.wasStarted},cookieEvents:this._cookieDataStorage.cookieEvents,...this._userPrivacyData,...!this._config.gdpr.enabled&&!this._config.ccpa.userOptedOut&&{uid1:this._getUIDForSource(`adserver.org`,this._prebidMethods.isPrebidLoaded())}}}),T(this,`_getUIDForSource`,(e,t)=>{if(t){for(let t of this._prebidMethods.getUserIdsAsEids())if(t.source&&t.source===e&&t.uids&&t.uids.length>0&&t.uids[0].id)return t.uids[0].id}return null})}async init(){await this._setupSlotManagerEventListeners(),this._setupUserPageDataLogEventCallbacks(),this._logUserPrivacyData().catch(()=>{M.error(`_logUserPrivacyData: `,`Could not log user privacy.`)}),this._setLoadTimingProperties()}get enabled(){return this._userPageDataLoggingExperiment.result}_getBuildData(){let e=this._cls&&this._cls.buildDate,t=window.adthrive.buildDate;return{bundleBuildDate:t,...e?{clsBuildDate:e}:{}}}_setTimingData(e,t,n){var r;let i=(r=window.performance)==null?void 0:r.timing;if(i&&i.navigationStart!==0){let r={pageLoad:i.loadEventStart-i.navigationStart,domainLookup:i.domainLookupEnd-i.domainLookupStart,connect:i.connectEnd-i.connectStart,request:i.responseStart-i.requestStart,response:i.responseEnd-i.responseStart,navigation:i.fetchStart-i.navigationStart,domInteractive:i.domInteractive-i.navigationStart,domContentLoaded:i.domContentLoadedEventStart-i.navigationStart},o=Object.keys(r).map(e=>r[e]).every(e=>!isNaN(e)&&e>=0&&e<36e5);if(o){var a;this._setNonBlockingLibraryTimingData();let{reasons:i}=this._config.disableAds;this._timingData={...r,...this._config.timing.timingData,disableAds:i.size>0?[...i].join(`,`):`none`,cookieDeprecationLabel:(a=this._config.fledge.cookieDeprecationLabel)==null?`none`:a,auctionStarted:e,auctionFinished:t,displayed:n}}}}_setNonBlockingLibraryTimingData(){this._config.timing.setNonBlockingLibraryTimingData(this._bootstrapConfig.bootstrapResult)}async _logUserData(){await this._prebidMethods.waitForQueue(),this._cookieDataStorage.calculateCookieSizes(`userDataLogged`),this._userPageDataLogEvents.loggingData.emit(),this._userPageDataLogEvents.setUserPageData({...this._timingData&&{UserPageTimingData:this._timingData},UserPageDataLoggingComponent:this._getUserData(),performanceTimingData:this._performanceTimingData})}async _logUserPrivacyData(){this._userPageDataPrivacyLoggingExperiment.result&&(this._userPrivacyData=await this._getUserPrivacyData())}async _getUserPrivacyData(){return{gpc:`navigator`in window&&`globalPrivacyControl`in window.navigator?window.navigator.globalPrivacyControl:null,dcp:await this._getDataConsent()}}async _getDataConsent(){if(`dataConsentPreference`in document)try{return await document.dataConsentPreference()}catch(e){return null}return null}_getEventTiming(e,t){var n,r;let i=((n=window.performance)==null?void 0:n.getEntriesByType(e).filter(t))||[];return(r=i[0])==null?{}:r}_getEventTimingProperties(e,t,n){let r={},i=this._getEventTiming(e,t);return n.forEach(e=>{var t;r[e]=(t=i==null?void 0:i[e])==null?null:t}),r}_getEventRegex(e){switch(e){case`adsmin`:return/ads\.adthrive\.com\/sites\/.*\/ads\.min\.js\?.*/;case`marmalade`:return/ads\.adthrive\.com\/api\/.*\/marmalade\?.*/;case`floors`:return/ads\.adthrive\.com\/api\/.*\/raptiveFloors\.*/}return RegExp(``)}_setLoadTimingProperties(){let{duration:e}=this._getEventTimingProperties(`resource`,e=>e.name.includes(`adthrive.min.js`),[`duration`]),t=this._getEventRegex(`adsmin`),{duration:n,startTime:r}=this._getEventTimingProperties(`resource`,e=>t.test(e.name),[`duration`,`startTime`]),{duration:i,responseEnd:a}=this._getEventTimingProperties(`resource`,e=>e.name.includes(`gpt.js`),[`responseEnd`,`duration`]),o=this._getEventRegex(`marmalade`),{responseEnd:s}=this._getEventTimingProperties(`resource`,e=>o.test(e.name),[`responseEnd`]),c=this._getEventRegex(`floors`),{responseEnd:l}=this._getEventTimingProperties(`resource`,e=>c.test(e.name),[`responseEnd`]),u=Math.max(s,a,l),{domContentLoadedEventEnd:d,startTime:f,responseEnd:p,domInteractive:m,domContentLoadedEventStart:h,domComplete:g,loadEventStart:_,loadEventEnd:v}=this._getEventTimingProperties(`navigation`,e=>!!e,[`domContentLoadedEventEnd`,`startTime`,`responseEnd`,`domInteractive`,`domContentLoadedEventStart`,`domComplete`,`loadEventStart`,`loadEventEnd`]);this._performanceTimingData={durations:{adsMinLoadDuration:n,adCodeLoadDuration:e,gptLoadDuration:i},endTimes:{marmaladeEndTime:s,gptEndTime:a,floorsEndTime:l,domReadyEndTime:d},totalLoadTime:u-r,startTime:f,responseEnd:p,domInteractive:m,domContentLoadedEventStart:h,domContentLoadedEventEnd:d,domComplete:g,loadEventStart:_,loadEventEnd:v}}},g0=D([Q(`UserPageDataLoggingComponent`),S(),A(`design:paramtypes`,[typeof(r0=Ki!==void 0&&Ki)==`function`?r0:Object,typeof(i0=ld!==void 0&&ld)==`function`?i0:Object,typeof(a0=z!==void 0&&z)==`function`?a0:Object,typeof(o0=L!==void 0&&L)==`function`?o0:Object,typeof(s0=ja!==void 0&&ja)==`function`?s0:Object,typeof(c0=zr!==void 0&&zr)==`function`?c0:Object,typeof(l0=R!==void 0&&R)==`function`?l0:Object,typeof(u0=t0!==void 0&&t0)==`function`?u0:Object,typeof(d0=n0!==void 0&&n0)==`function`?d0:Object,typeof(f0=_f!==void 0&&_f)==`function`?f0:Object,typeof(p0=Z1!==void 0&&Z1)==`function`?p0:Object,typeof(m0=e0!==void 0&&e0)==`function`?m0:Object,typeof(h0=Ur!==void 0&&Ur)==`function`?h0:Object])],g0)})),_0=o((()=>{uge(),vf(),Q1(),hf()})),v0,dge=o((()=>{w(),Ui(),E(),O(),v0=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`AdDensity`,this._lookup=`ADDENS`}},v0=D([C()],v0)})),y0,b0,x0,S0,C0,w0,T0,E0,D0,O0,k0,fge=o((()=>{w(),_0(),B(),Na(),$(),vh(),Z(),Uq(),Zn(),Bq(),H(),dge(),o$(),rU(),Bh(),Wr(),Ra(),j(),E(),O(),k0=class extends V{constructor(e,t,n,r,i,a,o,s,c,l){super(),this._config=e,this._realizedAdDensityExperiment=t,this._slots=n,this._pageManager=r,this._userPageDataLogEvents=i,this._adInjectionMap=a,this._realizedAdDensityEventBus=o,this._gamEventBus=s,this._slotManagerEventBus=c,T(this,`_initialSlotsTimeout`,1e4),T(this,`_device`,void 0),T(this,`_addToMainContent`,new Set([F.Below_Post])),T(this,`_slotsForAdDensity`,new Set([F.Content,F.Recipe,F.Footer])),T(this,`_slotsForMainContent`,void 0),T(this,`_slotsForEnd`,void 0),T(this,`_mainContent`,null),T(this,`_commentElem`,null),T(this,`_observer`,void 0),T(this,`_elementBeingObserved`,null),T(this,`_initMainContentHeight`,null),T(this,`_endMainContentHeight`,null),T(this,`_slotsHeightEnd`,null),T(this,`_slotsHeightVideo`,null),this._slotsForMainContent=new Set,this._slotsForEnd=new Set,this._device=l.device}init(){this._realizedAdDensityEventBus.metricsRequested.on(e=>e(this._getAdDensity()));let e=this.getAdDensityDynamicAds();if(e.length===0)return;let[t]=OG(e,this._adInjectionMap);this._mainContent=t,this._mainContent!==null&&(this._gamEventBus.slotOnload.once(()=>{setTimeout(()=>{this._getSlotHeights(),this._mainContent&&this._initObserver(this._mainContent)},this._initialSlotsTimeout)}),this._slotManagerEventBus.added.on(e=>{let t=this._slots.get(e);t.some(e=>e.infinite)||this._addSlots(t)}),this._userPageDataLogEvents.addCallbackToQueue([this._pageManager.beforeUnload],()=>this._logAdDensity()))}getAdDensityDynamicAds(){let e=this._config.dynamicAds.filter(e=>e.location===F.Content).filter(e=>kW(this._config,e)).filter(e=>OW(e,this._device)).filter(e=>jW(e));return e}_getAdDensity(){return this.enabled,{...this._endMainContentHeight&&this._slotsHeightEnd&&{addensend:Math.round(this._slotsHeightEnd/this._endMainContentHeight*100)}}}_logAdDensity(){let e=this._getAdDensity();Object.keys(e).length>0&&this._userPageDataLogEvents.setUserPageData({AdDensityComponent:e})}_addSlots(e){e.filter(e=>this._slotsForAdDensity.has(e.location)).filter(e=>!e.element.classList.contains(`adthrive-slicksearch`)).forEach(e=>{!e.lazy&&this._addToMainContent.has(e.location)&&this._slotsForMainContent.add(e.name),this._slotsForEnd.add(e.name)})}isSlotInMainContent(e){var t;return!!((t=this._mainContent)!=null&&t.querySelector(`#${e.id}`)&&!this.isSlotInComment(e))}isSlotInComment(e){return!!(this._commentElem&&this._commentElem.querySelector(`#${e.id}`))}_getSlotHeights(){let e=0;this._slots.get().forEach(t=>{this._slotsForMainContent.has(t.name)&&(e+=t.element.offsetHeight)}),this._mainContent&&(this._initMainContentHeight=CG(this._mainContent),this._initMainContentHeight+=e)}_commentElementHasAdSlots(e){let t=this._slots.get();return t.some(t=>e.querySelector(`#${t.id}`)&&t.location===F.Below_Post)}_initObserver(e){let t=e.querySelector(SG);this._observer=this.getIntersectionObserver(t),t!==null&&this._commentElementHasAdSlots(t)?(this._commentElem=t,this._elementBeingObserved=`comment`,this._observer.observe(this._commentElem)):(this._elementBeingObserved=`mainContent`,this._observer.observe(e))}getIntersectionObserver(e){let t=t=>{for(let i of t)if(this._initMainContentHeight!==null){if(this._elementBeingObserved===`mainContent`&&i.isIntersecting){var n;this._calculateSlotHeightsAtEnd(),(n=this._observer)==null||n.unobserve(this._mainContent)}if(e!==null&&this._elementBeingObserved===`comment`&&i.boundingClientRect.top>0){var r;this._calculateSlotHeightsAtEnd(),(r=this._observer)==null||r.unobserve(e)}}};return new IntersectionObserver(t,{})}_calculateSlotHeightsAtEnd(){let e=0,t=0;if(this._slots.get().forEach(n=>{if(this._slotsForEnd.has(n.name)&&(n.location!==F.Content||this.isSlotInMainContent(n))){let t=a$(n.element);t&&t>1?e+=t:e+=n.element.offsetHeight}this._slotsForMainContent.has(n.name)&&(t+=n.element.offsetHeight)}),this._slotsHeightEnd=e,this._mainContent&&(this._endMainContentHeight=CG(this._mainContent),this._endMainContentHeight+=t),this._config.video.playlistPlayerAdded){let t=document.querySelector(`.adthrive-collapse-player`);e+=t?t.offsetHeight:0}if(this._config.video.relatedPlayerAdded){let t=document.querySelectorAll(`.adthrive-video-player`);t.forEach(t=>{e+=t.offsetHeight})}this._slotsHeightVideo=e}get enabled(){return this._realizedAdDensityExperiment.result&&`IntersectionObserver`in window&&!(document.querySelector(`body.home`)!==null||document.querySelector(`body.archive`)!==null)&&!Hq()}start(){this._realizedAdDensityEventBus.realizedAdDensityCompReady.emit()}},k0=D([Q(`RealizedAdDensityComponent`),S(),A(`design:paramtypes`,[typeof(y0=z!==void 0&&z)==`function`?y0:Object,typeof(b0=v0!==void 0&&v0)==`function`?b0:Object,typeof(x0=_h!==void 0&&_h)==`function`?x0:Object,typeof(S0=ja!==void 0&&ja)==`function`?S0:Object,typeof(C0=_f!==void 0&&_f)==`function`?C0:Object,typeof(w0=zq!==void 0&&zq)==`function`?w0:Object,typeof(T0=nU!==void 0&&nU)==`function`?T0:Object,typeof(E0=zh!==void 0&&zh)==`function`?E0:Object,typeof(D0=Ur!==void 0&&Ur)==`function`?D0:Object,typeof(O0=L!==void 0&&L)==`function`?O0:Object])],k0)})),pge=o((()=>{fge()})),A0,j0,M0,mge=o((()=>{w(),$(),$h(),H(),Wr(),vh(),j(),E(),O(),M0=class extends V{constructor(e,t){super(),this._slotManagerEventBus=e,this._slots=t,T(this,`_maxSlotRefreshCount`,4)}init(){this._slotManagerEventBus.displaying.on(e=>{let t=this._slots.get(e);Zh.pushToQueue(()=>{t.forEach(e=>{this._setSlotTargeting(e)})})}),this._slotManagerEventBus.refreshing.on(e=>{let t=this._slots.get(e);Zh.pushToQueue(()=>{t.forEach(e=>{this._setSlotTargeting(e)})})})}_setSlotTargeting(e){if(!e||e.refreshCount===void 0||e.setTargeting===void 0)return;let t=`0${Math.min(e.refreshCount,this._maxSlotRefreshCount)}`.slice(-2);e.setTargeting({key:`refresh`,value:t}),e.setTargeting({key:`nref`,value:e.refreshCount.toString()})}},M0=D([Q(`RefreshCountComponent`),S(),A(`design:paramtypes`,[typeof(A0=Ur!==void 0&&Ur)==`function`?A0:Object,typeof(j0=_h!==void 0&&_h)==`function`?j0:Object])],M0)})),N0,hge=o((()=>{w(),$(),Ui(),E(),j(),O(),N0=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!0)}init(){this._key=`RefreshRebuild`,this._lookup=`REBUILDSLOT`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],N0.prototype,`run`,null),N0=D([C()],N0)})),P0,F0,I0,L0,gge=o((()=>{w(),$(),FS(),H(),hge(),Wr(),j(),O(),L0=class extends V{constructor(e,t,n){super(),this._slotManager=e,this._refreshRebuildExperiment=t,this._slotManagerEventBus=n}init(){this._slotManagerEventBus.refreshing.on(e=>{let t=this._slotManager.getSlots(e);t.filter(this.slotHasHighRefreshCountIncrement).forEach(e=>this._slotManager.rebuild(e))})}slotHasHighRefreshCountIncrement(e){return e.refreshCount%100==0}get enabled(){return this._refreshRebuildExperiment.result}},L0=D([Q(`RefreshRebuildComponent`),S(),A(`design:paramtypes`,[typeof(P0=PS!==void 0&&PS)==`function`?P0:Object,typeof(F0=N0!==void 0&&N0)==`function`?F0:Object,typeof(I0=Ur!==void 0&&Ur)==`function`?I0:Object])],L0)})),_ge=o((()=>{mge(),gge()})),R0,z0,B0,V0,vge=o((()=>{w(),$(),H(),B(),jc(),$h(),Rm(),j(),E(),O(),V0=class extends V{constructor(e,t,n){super(),this._config=e,this._prebidMethods=t,this._googleAdManager=n,T(this,`_ids`,[`flashtalking.com`,`neustar.biz`,`media.net`,`liveintent.triplelift.com`,`liveintent.sovrn.com`])}init(){Zh.pushToQueue(async()=>{try{Object.keys(localStorage).filter(e=>e.startsWith(`_GESPSK-`)).forEach(e=>{let t=U.readExternalLocalStorage(e);if(t){let e=JSON.parse(t)[1];e&&typeof e==`string`&&this._googleAdManager.setTargetingFlag(`ssp_len`,[e.length.toString()])}})}catch(e){}await this._prebidMethods.waitForQueue().then(e=>{if(e===!0){let e=this._mapIdsToEids();window.googletag.secureSignalProviders&&window.googletag.secureSignalProviders.push({networkCode:this._config.gam.networkCode,collectorFunction:async()=>{let t=await this.fetchAsyncSignals(e),n=t.obfuscate();return this._googleAdManager.setTargetingFlag(`ssp_len`,[n.length.toString()]),n}})}})})}_mapIdsToEids(){return this._prebidMethods.getUserIdsAsEids().filter(e=>this._ids.includes(e.source)).map(e=>{let{id:t,ext:n}=e.uids[0];return{source:e.source,data:t,...n&&`provider`in n&&{provider:n.provider},isPubCreated:!0}})}fetchAsyncSignals(e){return Promise.resolve({obfuscate:()=>btoa(JSON.stringify({signals:[...e,{source:`mcmp`,data:this._config.marmalade.mcmp,isPubCreated:!0},{source:`sens`,data:this._config.site.sensitiveCategories,isPubCreated:!0}]}))})}},V0=D([Q(`SecureSignalsComponent`),S(),A(`design:paramtypes`,[typeof(R0=z!==void 0&&z)==`function`?R0:Object,typeof(z0=R!==void 0&&R)==`function`?z0:Object,typeof(B0=Zh!==void 0&&Zh)==`function`?B0:Object])],V0)})),yge=o((()=>{vge()})),H0,bge=o((()=>{B(),Ui(),w(),E(),O(),H0=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){let e=x.resolve(z);this._key=`SinglePageAppSupport_`+String(e.site.id),this._lookup=`SPA_`+String(e.site.id).toUpperCase()}},H0=D([C()],H0)})),U0,W0=o((()=>{w(),$(),B(),Ui(),bge(),E(),j(),O(),U0=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){let e=x.resolve(H0),t=e.key,n=e.lookup,r=this._coreExperimentConfig.getCoreExperiment(t,n);this._key=r?t:`SinglePageAppSupport`;let i=x.resolve(z);this._lookup=this._key===`SinglePageAppSupport`?`SPA`:`SPA_`+String(i.site.id).toUpperCase(),this.setABGroup(!!this.isEnabled(),this._key===`SinglePageAppSupport`?`spa`:`spa_`+String(i.site.id))}isEnabled(){let e=x.resolve(z);return e.adOptions.spa===!0&&super.isEnabled()}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,Object)],U0.prototype,`run`,null),U0=D([C()],U0)})),G0,xge=o((()=>{G0=e=>{let t;return t=e instanceof Error?e.message:String(e),t}})),K0,q0,J0,Y0,X0,Z0,Q0,$0,e2,t2,n2,r2,i2,Sge=o((()=>{w(),ss(),$h(),B(),Ra(),rU(),$(),bt(),_I(),FS(),H(),BJ(),Eh(),Z(),W0(),xge(),Bq(),jc(),ud(),j(),E(),O(),i2=class extends V{constructor(e,t,n,r,i,a,o,s,c,l,u,d){super(),this._config=e,this._context=t,this._spaEventBus=n,this._slotManager=r,this._prebidActionManager=i,this._prebidMethods=a,this._singlePageAppManagerExperiment=o,this._dynamicAdsComponent=s,this._intersectionObserverManager=c,this._gam=l,this._adInjectionMap=u,this._cls=d,T(this,`_routeChangeBufferDuration`,500),T(this,`_observerDebounceDuration`,500),T(this,`_observerSettledDuration`,1e3),T(this,`_lastContentMutationTimestamp`,1/0),T(this,`_lastHref`,mK(document.location.href)),T(this,`_isTransitioning`,!1)}start(){this._addRouteChangeObserver(),this._setupRouteChangeListener()}get enabled(){return this._singlePageAppManagerExperiment.result}_setupRouteChangeListener(){this._spaEventBus.routeChanged.on(e=>{this._handleRouteChange().catch(e=>{M.error(`SinglePageAppManagerComponent`,`routeChanged`,e),this._isTransitioning=!1})})}_resetStatefulEmitters(){gt.forEach(e=>{e.resetEmitted(),e.resetOnces()})}async _handleRouteChange(){var e,t;let n=()=>{let e=mK(document.location.href);return e&&e!==this._lastHref};if(this._isTransitioning=!0,this._config.disableAds.clear(),this._intersectionObserverManager.unobserveAll(!1),this._adInjectionMap.reset(),await qK(this._routeChangeBufferDuration),n())throw Error(`Handler canceled after route change buffer.`);if(this._slotManager.removeAllElements(),this._prebidActionManager.reset(),this._prebidMethods.clearAllAuctions(),this._slotManager.destroyAll(),this._refreshPageviewKey(),kK.resetTimeOrigin(),this._config.disableAds.init(),this._context.sessionKey=this._context.setSessionKey(),this._context.isFirstPageview=ZG(),this._context.pageUrl=window.location.href,await this._waitForPageMutations(),n())throw Error(`Handler canceled after page settled.`);this._resetStatefulEmitters(),this._config.resetDynamicAds(),(e=this._cls.injectedSlots)==null||e.splice(0,this._cls.injectedSlots.length),(t=this._cls.injectedVideoSlots)==null||t.splice(0,this._cls.injectedVideoSlots.length),this._dynamicAdsComponent.start(),this._spaEventBus.resetCompleted.emit(),this._gam.setTargetingFlag(`spa_rc`,[`1`]),this._isTransitioning=!1}_refreshPageviewKey(){let e=this._context.pageviewKey,t=KK();return this._context.pageviewKey=t,this._gam.setTargeting({key:`pvk`,value:t}),e}_addRouteChangeObserver(){if(!document.body){M.error(`SinglePageAppManagerComponent`,`_addRouteChangeObserver`,`DOM is not ready`);return}let e=new MutationObserver(ts(e=>{let t=mK(document.location.href);if(t&&this._lastHref!==t){try{this._spaEventBus.routeChanged.emit({to:t,from:this._lastHref})}catch(e){M.error(`SinglePageAppManagerComponent`,`_addRouteChangeObserver`,`Error while emitting "routeChanged" event`,G0(e))}this._lastHref=t}else this._isTransitioning&&this._hasPageContentMutated(e)&&(this._lastContentMutationTimestamp=Date.now())},this._observerDebounceDuration,{leading:!0}));e.observe(document.body,{childList:!0,subtree:!0,attributes:!0})}async _waitForPageMutations(){try{return await YK({condition:()=>Date.now()-this._lastContentMutationTimestamp>this._observerSettledDuration})}catch(e){return}}_hasPageContentMutated(e){return e.some(e=>{let t=e.type===`childList`,n=e.addedNodes.length>0||e.removedNodes.length>0,r=e.target,i=(r==null?void 0:r.id.includes(`AdThrive_`))||(r==null?void 0:r.id.includes(`google_ad`));return t&&n&&!i})}},i2=D([Q(`SinglePageAppManagerComponent`),S(),A(`design:paramtypes`,[typeof(K0=z!==void 0&&z)==`function`?K0:Object,typeof(q0=L!==void 0&&L)==`function`?q0:Object,typeof(J0=zr!==void 0&&zr)==`function`?J0:Object,typeof(Y0=PS!==void 0&&PS)==`function`?Y0:Object,typeof(X0=gI!==void 0&&gI)==`function`?X0:Object,typeof(Z0=R!==void 0&&R)==`function`?Z0:Object,typeof(Q0=U0!==void 0&&U0)==`function`?Q0:Object,typeof($0=zJ!==void 0&&zJ)==`function`?$0:Object,typeof(e2=Th!==void 0&&Th)==`function`?e2:Object,typeof(t2=Zh!==void 0&&Zh)==`function`?t2:Object,typeof(n2=zq!==void 0&&zq)==`function`?n2:Object,typeof(r2=ld!==void 0&&ld)==`function`?r2:Object])],i2)})),Cge=o((()=>{Sge()})),a2,o2,wge=o((()=>{w(),$(),W0(),H(),j(),O(),o2=class extends V{constructor(e){super(),this._singlePageAppManagerExperiment=e}start(){window.camAddRouteObserver&&window.camAddRouteObserver()}get enabled(){return!this._singlePageAppManagerExperiment.result}},o2=D([Q(`CamSinglePageAppManagerComponent`),S(),A(`design:paramtypes`,[typeof(a2=U0!==void 0&&U0)==`function`?a2:Object])],o2)})),s2,c2,l2,Tge=o((()=>{dJ(),w(),B(),Ra(),$(),Z(),H(),j(),O(),l2=class extends V{constructor(e,t){super(),this._config=e,this._context=t}start(){this._config.site.style&&this._config.site.style.length>0?uJ(this._config.site.style):this._context.styleUrl&&NG(this._context.styleUrl)}},l2=D([Q(`SiteStyleComponent`),S(),A(`design:paramtypes`,[typeof(s2=z!==void 0&&z)==`function`?s2:Object,typeof(c2=L!==void 0&&L)==`function`?c2:Object])],l2)})),Ege=o((()=>{Tge()})),u2,d2,f2,Dge=o((()=>{w(),$h(),$(),Rm(),Z(),H(),Ra(),j(),O(),f2=class extends V{constructor(e,t){super(),this._gam=e,this._context=t}init(){let e=this.getReferrer();e!==null&&this._gam.setTargeting({key:`doc_ref`,value:e})}getReferrer(){let e=hG(this._context.savedReferrer);return e&&e.length&&U.setExpirableInternalLocalStorage(`adthrive_referrer`,e,{expiry:{value:30,unit:`minutes`}}),e}},f2=D([Q(`TrafficSourceComponent`),S(),A(`design:paramtypes`,[typeof(u2=Zh!==void 0&&Zh)==`function`?u2:Object,typeof(d2=L!==void 0&&L)==`function`?d2:Object])],f2)})),Oge=o((()=>{Dge()})),p2,m2,h2,kge=o((()=>{w(),$h(),Ra(),$(),Rm(),H(),j(),O(),h2=class extends V{constructor(e,t){super(),this._context=e,this._gam=t}init(){Object.keys(this._context.utm).forEach(e=>{let t=this._context.utm[e];this._gam.setTargeting({key:e,value:t})}),U.setExpirableInternalLocalStorage(`adthrive_utm`,this._context.utm,{expiry:{value:30,unit:`minutes`}})}},h2=D([Q(`UTMComponent`),S(),A(`design:paramtypes`,[typeof(p2=L!==void 0&&L)==`function`?p2:Object,typeof(m2=Zh!==void 0&&Zh)==`function`?m2:Object])],h2)})),Age=o((()=>{kge()})),g2,jge=o((()=>{g2=class{constructor(){}init(e){this.setup(e)}}})),_2,Mge=o((()=>{$(),w(),O(),_2=class{logEvents(e,t){this._logPlayerPlayEvents(e,t),this._logPlayerPauseEvents(e,t),this._logPlayerMuteEvents(e,t),this._logPlayerVolumeEvents(e,t),this._logPlayerSeekEvents(e,t)}_logPlayerPlayEvents(e,t){e.on(`play`,e=>this._onPlayerPlayEvent(e,t))}_logPlayerPauseEvents(e,t){e.on(`pause`,e=>this._onPlayerPauseEvent(e,t))}_logPlayerMuteEvents(e,t){e.on(`mute`,e=>this._onPlayerMuteEvent(e,t))}_logPlayerVolumeEvents(e,t){e.on(`volume`,e=>this._onPlayerVolumeEvent(e,t))}_logPlayerSeekEvents(e,t){e.on(`seek`,e=>this._onPlayerSeekEvent(e,t))}_onPlayerPlayEvent(e,t){e.playReason===`interaction`&&M.event(`JwPlayer`,`play`,t)}_onPlayerPauseEvent(e,t){e.pauseReason===`interaction`&&M.event(`JwPlayer`,`pause`,t)}_onPlayerMuteEvent(e,t){M.event(`JwPlayer`,`mute`,{mute:e.mute,...t})}_onPlayerVolumeEvent(e,t){}_onPlayerSeekEvent(e,t){}},_2=D([C()],_2)})),v2,y2=o((()=>{w(),AF(),KH(),JH(),RZ(),_W(),jge(),rU(),X(),$(),Rm(),oC(),Ff(),Z(),Ni(),$T(),RI(),Mge(),al(),kC(),E(),v2=class extends g2{constructor(e,t=1,n,r,i,a,o,s,c,l=yW.Float,u,d,f,p,m,h,g,_,v,y){var b;super(),this._playerId=e,this._mediaIdCount=t,this._playlistId=n,this._name=r,this._size=i,this._pageElement=a,this._eventProxy=o,this._config=s,this._context=c,this._collapseType=l,this._collapseMobileSizeType=u,this._prebidEventBus=d,this._prebidMethods=f,this._auctionManagers=p,this._playerType=m,this._isCollapsible=h,this._desktopCollapseOnScrollUp=g,this._mobileCollapseOnScrollUp=_,this._saveVideoCloseState=v,this._mobileLocation=y,T(this,`type`,`JwPlayer`),T(this,`initialAuctionPlayer`,!1),T(this,`jwVersion`,``),T(this,`imaVersion`,``),T(this,`nextMediaId`,void 0),T(this,`plcmt`,void 0),T(this,`_lastAdSuccessful`,!0),T(this,`_retryAttempts`,0),T(this,`_maxRetries`,void 0),T(this,`_playlistMaxRetries`,4),T(this,`_relatedPlayerMaxRetries`,2),T(this,`_erroredOutAdIds`,new Set),T(this,`_erroredOutCreativeIds`,new Map),T(this,`impressionId`,NK()),T(this,`requestVideoBids`,()=>(M.error(`VideoPlayerBase`,`requestVideoBids`,`Request video bids not set`),new Promise((e,t)=>t()))),T(this,`buildVideoUrl`,()=>{throw Error(`Build video url not set`)}),T(this,`setPlayerInstance`,()=>{throw Error(`Reset player not set`)}),T(this,`waitForConsent`,()=>{throw Error(`Wait for consent not set`)}),T(this,`playerInstance`,void 0),T(this,`collapseCollection`,null),T(this,`_videoAdUnit`,void 0),T(this,`_defaults`,{}),T(this,`_playerInstance`,void 0),T(this,`_playerContainer`,void 0),T(this,`_state`,Y.Unstarted),T(this,`_videoTitleElement`,void 0),T(this,`_topCollapseVideoTitleElement`,void 0),T(this,`_wrapperTitleWrapperElement`,void 0),T(this,`_wrapperText`,void 0),T(this,`_videoCloseButtonComponent`,void 0),T(this,`_closeButton`,void 0),T(this,`_playerHeaderBar`,void 0),T(this,`_closeTimer`,void 0),T(this,`_nextAdFetched`,!1),T(this,`_adDurationLogged`,!1),T(this,`_isFirstPlay`,!0),T(this,`_skipContainer`,void 0),T(this,`_calledNextVideo`,!1),T(this,`_wasClicked`,!1),T(this,`_canSkip`,!0),T(this,`_isAdvancePlaylist`,!1),T(this,`_adDetails`,null),T(this,`_additionalAdFieldsLegacy`,null),T(this,`_canTearDown`,!1),T(this,`_tearDownAfterNextAd`,!1),T(this,`_tearDownTimer`,null),T(this,`_tearDownPlayerTimeout`,0),T(this,`_stalePlayerTimer`,null),T(this,`_currentAdTime`,0),T(this,`_currentAdDurationWithBuffer`,0),T(this,`_adTimingBuffer`,10),T(this,`_defaultAdDuration`,30),T(this,`_instreamRerequestOnErrorResult`,void 0),T(this,`_autoplayBehaviorConfig`,{mute:!0}),T(this,`_topBackgroundElement`,null),T(this,`_mobileStickyPlayerPositionSiteExperiment`,void 0),T(this,`_mobileStickyPlayerPositionCoreExperiment`,void 0),T(this,`_midrollBugFixExperiment`,void 0),T(this,`_hasPreviouslyCollapsed`,!1),T(this,`_bidMarkedOnCurrentAd`,!1),T(this,`_prebidAuctionManager`,void 0),T(this,`_baseConfig`,{advertising:{adscheduleid:`DmULPHgQ`,client:`googima`,maxRedirects:this._config.video.maxRedirect,requestTimeout:this._config.video.jwRequestTimeout,vastLoadTimeout:this._config.video.vastTimeoutISV,vpaidmode:`insecure`,vpaidcontrols:!0},generateSEOMetadata:!il.isRolloutEnabled(`disableJwpSeo`),preload:`metadata`}),T(this,`_spaListeners`,[]),T(this,`_transactionId`,``),T(this,`_userIdTargetingData`,[]),T(this,`_pendingBidRequests`,[]),T(this,`_mediaOrPlaylistId`,`nf`),T(this,`_hiddenClassName`,`adthrive-hidden`),T(this,`_isRunningAdPlay`,!1),T(this,`_userIdComponent`,void 0),T(this,`_sspUserSyncComponent`,void 0),T(this,`_videoEventBus`,void 0),T(this,`_isMobile`,!1),T(this,`_adPodManager`,void 0),T(this,`_advanceInProgress`,!1),T(this,`_adDurationControlExperiment`,void 0),T(this,`_auctionManager`,void 0),T(this,`_lastAuctionBidDetails`,void 0),T(this,`_eligibleFloorComponents`,[]),T(this,`_appliedFloorComponents`,[]),T(this,`_shouldPlayPrerollAds`,()=>!this._adPodManager.adPlayMap.has(this.prerollNum)&&!this._advanceInProgress),T(this,`_runAdPlay`,async(e=!0)=>{this.setIsRunningAdPlay(!0),await this._videoEventBus.auctionsCompleted.legacyEmit([this]);let t=await this._getPrerollAdUrl();this.playerInstance._nonLinearAd=!1,this._adPodManager.setAdPlayMap(this.prerollNum,!0),this.playerInstance.playAd(t),e&&this._resetAdVars()}),this.plcmt=(b=OC(s.video.plcmtUnits,this))==null?2:b,this._isMobile=this._context.device===`phone`,this._instreamRerequestOnErrorResult=x.resolve(bU).result;let ee=x.resolve(zr);if(ee.routeChanged.on(()=>{this._spaListeners.forEach(e=>e()),this._spaListeners.length=0}),this._videoEventBus=x.resolve(eU),this._maxRetries=this._playerType===rC.Playlist?this._playlistMaxRetries:this._relatedPlayerMaxRetries,this._prebidAuctionManager=this._auctionManagers.getPrebidAuctionManager(),this._mobileStickyPlayerPositionSiteExperiment=x.resolve(IU),this._mobileStickyPlayerPositionCoreExperiment=x.resolve(NU),this._midrollBugFixExperiment=x.resolve(MU),this._videoCloseButtonComponent=x.resolve(LI),window.matchMedia){let e=window.matchMedia(`only screen and (max-width: ${this._config.site.breakpoints.desktop-1}px)`);e.addListener(this._handleWidthBreak.bind(this)),this._handleWidthBreak(e)}let te=this._config.video.advancePlaylist;this._isAdvancePlaylist=this._playerType===rC.Playlist?te.playlistPlayer.enabled:te.relatedPlayer.enabled,(this._playerType!==rC.Related||this._isCollapsible&&te)&&(this._tearDownPlayerTimeout=0,this._canTearDown=this._tearDownPlayerTimeout!==0&&this._tearDownPlayerTimeout!==-1),this._userIdComponent=x.resolve(QT),this._sspUserSyncComponent=x.resolve(kF);let ne={optimizeVideoPlayersForEarnings:s.adOptions.optimizeVideoPlayersForEarnings,isCollapsible:this._isCollapsible,maxAdsInPod:2,adPodAuctionCutoffSeconds:6e3,isMax30SecPodFeatureEnabled:!1};this._adPodManager=new GH(ne),this._adDurationControlExperiment=x.resolve(hU),this._auctionManager=new qH(r,f,s,this._isCollapsible)}get name(){return`${this._name}`}get amzName(){return this._auctionManager.amznAdUnitName}get collapsible(){return this._isCollapsible}get mediaOrPlaylistId(){return this._mediaOrPlaylistId}get playerContainer(){return this._playerContainer}get playerContainerId(){return`${this._playlistId}_${this._mediaIdCount}`}get playerElement(){return this._playerElement}get prerollNum(){return this._adPodManager.prerollNumber}get size(){return this._size}set videoAdUnit(e){this._videoAdUnit=e}get videoAdUnit(){return this._videoAdUnit}set lastAuctionBidDetails(e){this._lastAuctionBidDetails=e}get lastAuctionBidDetails(){return this._lastAuctionBidDetails}get eligibleFloorComponents(){return this._eligibleFloorComponents}set eligibleFloorComponents(e){this._eligibleFloorComponents=e}get appliedFloorComponents(){return this._appliedFloorComponents}set appliedFloorComponents(e){this._appliedFloorComponents=e}refreshImpressionId(){let e=NK();this.impressionId=e}setAmznBids(e){this._auctionManager.setAmznBids(e)}setPrebidBids(e){this._auctionManager.setPrebidBids(e)}getMinMaxDurationsForGAM(){if(this._auctionManager.enabled)return this._auctionManager.hasFallenBack||this._retryAttempts>0?void 0:{min_ad_duration:1e3,max_ad_duration:15e3}}getJwBoostTargeting(){return{playerID:this._playlistId,...(this.name===vW.Video_In_Post_ClicktoPlay_SoundOn||this.name===vW.Video_Individual_Autoplay_SOff)&&{mediaID:this._playlistId}}}get transactionId(){return this._transactionId}set transactionId(e){this._transactionId=e}set userIdTargetingData(e){this._userIdTargetingData=e}get userIdTargetingData(){return this._userIdTargetingData}get vp(){return this.prerollNum<=1?this.prerollNum:this.prerollNum<=9?2:3}get retryAttempts(){return this._retryAttempts}get isPlayerType(){return this._playerType}init(){this.setup()}getDefaults(){return this._defaults}setDefaults(e){this._defaults=e}setIsRunningAdPlay(e){this._isRunningAdPlay=e}getIsRunningAdPlay(){return this._isRunningAdPlay}_createCollapsibleCollection(e){let{playerElement:t,playerContainer:n,footerElement:r,stickyElement:i,mobileHeaderSelector:a}=e;this.collapseCollection={playerInstance:this.playerInstance,playerType:this._playerType,playerState:this._state,playerContainer:n,playerElement:t,topBackgroundElement:this._topBackgroundElement,footerElement:r,stickyElement:i,closeButton:this._closeButton,forceMobile:this._context.device!==`desktop`,isMobile:this._isMobile,collapseType:this._collapseType,collapseMobileSizeType:this._collapseMobileSizeType,collapseSubType:xW.BottomRight,collapseMobileSubType:this._getCollapseMobileSubType(),mobileHeaderSelector:a,collapseTimer:{timeCollapsed:0,isRunning:!1},mediaStarted:!1,desktopCollapseOnScrollUp:this._desktopCollapseOnScrollUp,mobileCollapseOnScrollUp:this._mobileCollapseOnScrollUp,hasPreviouslyCollapsed:this._hasPreviouslyCollapsed,getIsRunningAdPlay:()=>this.getIsRunningAdPlay()}}_resetAdVars(){this._bidMarkedOnCurrentAd=!1,this._adDetails=null,this._nextAdFetched=!1,this._adDurationLogged=!1,this._currentAdTime=0,this._currentAdDurationWithBuffer=0,this._pendingBidRequests.length=0,this._clearStaleTimers(),this._lastAdSuccessful=!0,this._retryAttempts=0,this.setIsRunningAdPlay(!1),this._advanceInProgress=!1,this._auctionManager.reset()}async _handleNextAdFetch(){this._nextAdFetched=!0,this._advanceInProgress=!0,this._adPodManager.canApplyAdPodExperience()&&this._adPodManager.resetAdCountInPod(),await this._doubleFetchBids()}async _checkForConsent(){let e=this._config.gdpr;!e.consentCaptured&&e.enabled&&await this.waitForConsent()}async _inViewPlayAd(){await this._checkForConsent(),await this._fetchBids(),this._triggerAdPlay()}_setPlayerVersions(){let e=RegExp(`^[0-9]+.[0-9]+.[0-9]+`),t=this.playerInstance,n=e.exec(t.version);this.jwVersion=n&&n[0],this.imaVersion=t.plugins&&t.plugins.googima&&t.plugins.googima.version}_getPlayerVersions(){return{imaSDKVersion:this.imaVersion,jwVersion:this.jwVersion}}async _doubleFetchBids(){this._adPodManager.incrementSessionPrerollNumber(),await this._fetchBids(),await this._fetchBids()}_fetchBids(e=!1){if(this._auctionManager.enabled)return this._manageAuction(e);if(this._pendingBidRequests.length<2){let e=this.requestVideoBids([this]);return this._pendingBidRequests.push(e),e}}async _manageAuction(e){if(this._auctionManager.currentAuctionNumber>=2)return;this._auctionManager.incrementCurrentAuctionNumber(),this._auctionManager.currentAuctionNumber===2&&await this._pendingBidRequests[0],this._auctionManager.beforeBidRequest(e);let t=this.requestVideoBids([this]);return this._pendingBidRequests.push(t),t}_playerReady(e){this._startTearDownTimer(),this._configureQuality(),this._setPlayerVersions(),this.playerInstance.on(`playlistItem`,e=>{this._handleTitleLinkWrapper(e)})}_jwSetup(e){let t={...this._defaults,...this._baseConfig,...e};if(this.playerInstance.setup)try{this.playerInstance.setup(t),this._handleNonLinearAd(),this._setupEventListeners()}catch(e){M.error(`InstreamPlayer`,`jwSetup`,`Unexpected issue while setting up JWPlayer`,{playerId:this._playerId,err:e})}else M.error(`InstreamPlayer`,`jwSetup`,`Unexpected issue while setting up JWPlayer`,{playerId:this._playerId})}_handleNonLinearAd(){this.playerInstance.on(`adImpression`,e=>{let t=xK(e.ima,`ad`)?e.ima.ad:null,n=this._getAdDetailsFromAd(t);if(n&&xK(n,`linear`)&&n.linear===!1||e.linear===`nonlinear`){this.playerInstance._nonLinearAd=!0,this.playerInstance.pause();let e=document.getElementById(`${this._playlistId}`),t=e.querySelector(`div > div.jw-overlays.jw-reset`);t.style.backgroundColor=`black`;let n=e.querySelector(`div.jw-wrapper.jw-reset > div.jw-controls.jw-reset`);n.style.zIndex=`-1`,this.playerInstance.once(`adComplete`,()=>{this.playerInstance._nonLinearAd=!1,t.style.backgroundColor=`transparent`,n.style.zIndex=``,this.playerInstance.play()})}})}async _handleScroll(){await this._checkForConsent(),this.collapseCollection&&(this._isFirstPlay&&!this.getIsRunningAdPlay()&&await this._fetchBids(),LZ.handleScroll(this.collapseCollection))}_handleResize(){this.collapseCollection&&LZ.handleResize(this.collapseCollection)}_handlePageVisibilityChange(e){this.collapseCollection&&LZ.handlePageVisibilityChange(e,this.collapseCollection)}_displayCloseButton(){this.collapseCollection&&LZ.displayCloseButton(this.collapseCollection)}_onCloseClick(){this.collapseCollection&&(this._saveVideoCloseState&&U.setExpirableInternalLocalStorage(`adthrive_video_closed`,!0,{expiry:{value:30,unit:`minutes`}}),LZ.handleClose(this.collapseCollection,this.prerollNum))}_handleUserClick(){this.collapseCollection&&LZ.handleUserClick(this.collapseCollection)}_handleWidthBreak(e){this.collapseCollection&&LZ.handleWidthBreak(e,this.collapseCollection)}_handleVideoPlayingEvent({playlistId:e,mediaIdCount:t,wasClicked:n}){e===this._playlistId&&t===this._mediaIdCount||(this.collapseCollection?LZ.handleOtherVideoPlaying(this.collapseCollection):n&&this.playerInstance.pause(!0))}_handleTitleClick(e){this.collapseCollection.collapseTimer.firstInView&&M.event(`jw-player`,`handleTitleClick`,{timeElapsed:Date.now()-this.collapseCollection.collapseTimer.firstInView.valueOf(),link:e.currentTarget.getAttribute(`href`)})}_handleFooterResponseReceivedEvent(){this.collapseCollection&&LZ.repositionCollapseMobileBottom(this.collapseCollection)}_configureQuality(){Ei()||this.playerInstance.on(`levels`,e=>{this.playerInstance.setCurrentQuality(e.levels.length-1)})}_createPlayerCloseButton(){var e;let t=this._wrapperTitleWrapperElement||this._videoTitleElement;return this._closeButton=this._videoCloseButtonComponent.createPlayerCloseButton(this._onCloseClick.bind(this),`instream`,`adthrive-collapse-close`,!!t,this.isTopCenterCollapse()?`top-center`:(e=this.collapseCollection)==null?void 0:e.collapseType),this._closeButton}_createPlayerCollapseBackgroundElement(){let e=document.createElement(`div`);return e.classList.add(`adthrive-collapse-mobile-background`),e.style.backgroundColor=this._config.adOptions.bgColor,e.style.width=`${window.innerWidth}px`,e.style.display=`inline`,e.style.height=`0`,e}_createLinkIcon(e){let t=document.createElementNS(`http://www.w3.org/2000/svg`,`svg`);t.setAttribute(`width`,`24`),t.setAttribute(`height`,`24`),t.setAttribute(`style`,`margin-bottom:6px`);let n=document.createElementNS(`http://www.w3.org/2000/svg`,`path`);return n.setAttribute(`d`,`M 16 1 H 23 V 8 Z M 19.5 12.5 V 23 H 1 V 4.5 H 12 l 1 1 H 2 V 22 H 18.5 V 11.5 l 1 1 v 1 M 19 4 L 11.5 11.5 l 1 1 L 20 5`),n.setAttribute(`stroke`,`white`),n.setAttribute(`stroke-width`,`2`),n.setAttribute(`stroke-linejoin`,`round`),t.appendChild(n),t.id=`${e}-svg-link`,t}_createLearnMoreLink(e){let t=document.createElement(`a`);return t.classList.add(`adthrive-learn-more-link`),t.innerText=`Tap here to learn more.`,t.style.setProperty(`color`,this._config.adOptions.secColor),t.id=`${e}-learn-more-link`,t}_createPlayerWrapper(e){if(e){this._wrapperTitleWrapperElement=document.createElement(`a`);let e=this._createLinkIcon(this._playlistId);this._wrapperTitleWrapperElement.appendChild(e)}else this._wrapperTitleWrapperElement=document.createElement(`div`);this._videoTitleElement=document.createElement(`span`),this._videoTitleElement.id=`video-title-text`;let t=document.createElement(`div`),n=document.createElement(`div`);return n.className=`adthrive-wrapper-title-wrapper`,this._videoTitleElement.classList.add(`adthrive-video-text-cutoff`),this._videoTitleElement.classList.add(`adthrive-video-title`),this._wrapperTitleWrapperElement.className=`adthrive-video-text-cutoff`,this._wrapperTitleWrapperElement.appendChild(this._videoTitleElement),this._wrapperTitleWrapperElement.target=`_blank`,this._wrapperTitleWrapperElement.onclick=this._handleTitleClick.bind(this),this._closeButton=this._createPlayerCloseButton(),n.appendChild(this._wrapperTitleWrapperElement),t.className=`adthrive-wrapper-bar`,t.appendChild(n),t.appendChild(this._closeButton),t}_createTopCollapseWrapper(e=!0){let t=document.createElement(`div`);t.className=`adthrive-top-collapse-wrapper-bar`,this._closeButton=this._createPlayerCloseButton();let n=document.createElement(`div`);n.className=`adthrive-top-collapse-close-spacer`,n.appendChild(this._closeButton),t.appendChild(n);let r=document.createElement(`a`);if(this._topCollapseVideoTitleElement=document.createElement(`span`),this._topCollapseVideoTitleElement.classList.add(`adthrive-top-collapse-wrapper-video-title`),this._topCollapseVideoTitleElement.style.color=this._config.adOptions.secColor,r.appendChild(this._topCollapseVideoTitleElement),e){let e=this._createLearnMoreLink(this._playlistId);r.appendChild(e),r.onclick=this._handleTitleClick.bind(this)}return t.appendChild(r),this._wrapperText=r,t}_trimEventData(e){var t;let n={...e},r=n.ima&&n.ima.ad&&this._getAdDetailsFromAd(n.ima.ad);return n!=null&&n.tag&&delete n.tag,r&&r.traffickingParameters&&delete r.traffickingParameters,!(n==null||(t=n.ima)==null||(t=t.userRequestContext)==null)&&t.adTagUrl&&delete n.ima.userRequestContext.adTagUrl,n!=null&&n.mediaFile&&delete n.mediaFile,n}_handleOneVideoContentPlaylist(){this.playerInstance.pause(),this.playerInstance.seek(0),this.setIsRunningAdPlay(!1),this._adPodManager.canApplyAdPodExperience()&&!this._adPodManager.canPlayAdPodPrerollAd()?this.playerInstance.play():this.playerInstance.once(`firstFrame`,()=>{this._triggerAdPlay()}),this.playerInstance.trigger(`firstFrame`,{loadTime:0,viewable:1}),this._adPodManager.canApplyAdPodExperience()&&this._adPodManager.incrementVideoContentPlayCount()}_handleNextButton(){this._calledNextVideo=!0,this._removeSkipContainer(),this._isAdvancePlaylist&&this.playerInstance.getPlaylist().length===1?this._handleOneVideoContentPlaylist():this.playerInstance.next()}_handleNextButtonClick(){let e={playerType:this._playerType,mediaId:this.mediaOrPlaylistId,playlistIndex:this.playerInstance.getPlaylistIndex()};M.event(`JwPlayer`,`nextButtonClicked`,e),this._handleNextButton()}_handleStayButtonClick(){let e={playerType:this._playerType,mediaId:this.mediaOrPlaylistId,playlistIndex:this.playerInstance.getPlaylistIndex()};M.event(`JwPlayer`,`stayButtonClicked`,e)}_createNavButton(e){let t=document.createElement(`div`),n=document.createElement(`span`);return t.id=`${e}-video`,n.textContent=e,t.appendChild(n),!ji(15)&&!ji(16)&&!Mi()&&t.classList.add(`video-box-shadow`),t}_createSkipContainer(){let e=document.createElement(`div`);e.id=`next-stay-container`,e.classList.add(`active`);let t=this._createNavButton(`next`);t.onclick=this._handleNextButtonClick.bind(this),e.appendChild(t);let n=this._createNavButton(`stay`);return n.onclick=this._handleStayButtonClick.bind(this),e.appendChild(n),e}_initSkipContainer(){this.playerInstance.on(`time`,({position:e,duration:t})=>{if(!this._canSkip||this.playerInstance._nonLinearAd||this._wasClicked||t<5)return;let n=t<40,r=n?e>=t-5:e>=25,i=n?e>=t:e>=30,a=n?e>=t:e>=25,o=!this._skipContainer&&a&&!this._nextAdFetched;if(o){let e=this._adPodManager.canApplyAdPodExperience()?this._adPodManager.shouldFetchNextAdAfterAdvancing():!0;e&&this._handleNextAdFetch()}!this._skipContainer&&r?(this._skipContainer=this._createSkipContainer(),this.playerInstance.getContainer().appendChild(this._skipContainer),getComputedStyle(this._skipContainer).backgroundColor&&this._skipContainer.classList.add(`loaded`)):this._skipContainer&&!this._calledNextVideo&&i&&(this._handleNextButton(),this._advanceInProgress=!1)})}_handleVideoPlayerClicked(e){this._logAdvancePlaylistCancelled(e),this._wasClicked=!0,this._removeSkipContainer()}_logAdvancePlaylistCancelled(e){if(!this._canSkip||this.playerInstance._nonLinearAd||this._wasClicked)return;let t=e.composedPath(),n=t.some(e=>[`next-video`,`stay-video`].includes(e.id));if(n)return;let r={playerType:this._playerType,mediaId:this.mediaOrPlaylistId,playlistIndex:this.playerInstance.getPlaylistIndex()};M.event(`JwPlayer`,`advancePlaylistCancelled`,r)}_removeSkipContainer(){this._skipContainer&&this._skipContainer.parentNode&&(this._skipContainer.parentNode.removeChild(this._skipContainer),this._skipContainer=void 0)}_handleFirstFrame(){this._calledNextVideo=!1,this._wasClicked=!1}_getCollapseMobileSubType(){return this._mobileStickyPlayerPositionSiteExperiment.enabled&&this._mobileStickyPlayerPositionSiteExperiment.result!==`control`?Pf.setMobileLocation(this._mobileStickyPlayerPositionSiteExperiment.result):this._mobileStickyPlayerPositionCoreExperiment.mobileLocation?Pf.setMobileLocation(this._mobileStickyPlayerPositionCoreExperiment.mobileLocation):this._mobileLocation}get _isTopCollapse(){return this._getCollapseMobileSubType()===`adthrive-collapse-top-center`}isTopCenterCollapse(){return this._collapseType===yW.Mobile&&this._isTopCollapse}_createTopCenterBackground(e){this._topBackgroundElement=this._createPlayerCollapseBackgroundElement(),e.appendChild(this._topBackgroundElement)}_clearStaleTimers(){this._stalePlayerTimer&&(clearTimeout(this._stalePlayerTimer),this._stalePlayerTimer=null)}_listenForLargeVastError(){this._prebidEventBus.vastExceededLimit.on(e=>{let t={meta:e.bids[0].meta,bidder:e.bids[0].bidder,adId:e.bids[0].adId,creativeId:e.bids[0].creativeId,responseSize:e.responseSize,maxSizeAllowed:e.maxSizeAllowed};M.error(`JwPlayer`,`listenForLargeVastError`,t)})}_getErrorLogAdDetails(){return(({wrapperIds:e,wrapperCreativeIds:t,wrapperSystems:n,vastCreativeId:r,mediaFileURL:i,adId:a,adUnitName:o,adomain:s,hb_bidder:c,amznp:l,hb_pb:u,hb_crid:d,amznbid:f,hb_deal:p})=>({wrapperIds:e,wrapperCreativeIds:t,wrapperSystems:n,vastCreativeId:r,mediaFileURL:i,adId:a,adUnitName:o,adomain:s&&encodeURIComponent(s),hb_bidder:c,amznp:l,hb_pb:u,hb_crid:d,amznbid:f,hb_deal:p}))(this._adDetails||{})}_setStaleAdDetection(){let e=this._currentAdDurationWithBuffer-this._currentAdTime;this._stalePlayerTimer||(this._stalePlayerTimer=window.setTimeout(()=>{M.error(`JwPlayer`,`stalePlayer`,{message:`JwPlayer encountered an unknown error during ad play`,...this._getPlayerVersions(),...this._getErrorLogAdDetails()}),this._tearDownPlayerTimeout===-1?(this._enableTearDown(),this._tearDownPlayer()):this.playerInstance.playlistItem(this.playerInstance.getPlaylistIndex())},e*1e3))}_getJwEventLog(e){return{playerName:this._name,rawData:this._trimEventData(e)}}_tearDownPlayer(){if(this._tearDownAfterNextAd){var e;let t={adUnit:this._name,playerType:this._playerType,playerId:this._playerId,mediaId:this.mediaOrPlaylistId,state:this._state,collapseState:(e=this.collapseCollection)==null?void 0:e.playerState,vp:this.prerollNum};M.event(`JwPlayer`,`tearDownPlayer`,t),this._tearDownAfterNextAd=!1,this._tearDownTimer&&clearTimeout(this._tearDownTimer),this.playerInstance.remove(),this.setPlayerInstance(this),this._handleScroll(),this._adPodManager.reset(),this.setIsRunningAdPlay(!1)}}_enableTearDown(){this._tearDownAfterNextAd=!0}_startTearDownTimer(){let e=this._tearDownPlayerTimeout,t=this._canTearDown;t&&e/1e3,t&&(this._tearDownTimer=window.setTimeout(this._enableTearDown.bind(this),e))}_excludedErroredOutAdIdsFromGamAuction(){if(this.name){let e=this._prebidMethods.getBidResponsesForAdUnitCode(this.name);e.bids.forEach(e=>{this._erroredOutAdIds.has(e.adId)&&this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name,adId:e.adId})})}}_handleErrors(){[`adError`,`setupError`,`error`].forEach(e=>{this._bidMarkedOnCurrentAd=!1;let t=e===`adError`;this.playerInstance.on(e,n=>{if(this._clearStaleTimers(),!this._adDetails){let e=`tag`in n&&n.tag||``;this._addAdDetailFields(e),this._adDetails={...this._additionalAdFieldsLegacy,adUnitName:this._name,tag:e,isEmpty:!0}}if(n.code===900&&this._eventProxy.emitVideoSlotRenderedEvent(this._adDetails),e===`setupError`&&this._preventCollapse(),M.error(`JwPlayer`,e,{code:n.code,...t&&{message:n.message,adErrorCode:n.adErrorCode},...this._getJwEventLog(n)}),t){let e=this._adPodManager,t=!e.canApplyAdPodExperience()||e.isFirstInAdPod();this._checkRenderedAdDetails(!0),this._adDetails.adId&&this._erroredOutAdIds.add(this._adDetails.adId),this._lastAdSuccessful=!1,e.setAdPlayMap(this.prerollNum,!1),this.setIsRunningAdPlay(!1);let r={message:n.message,code:n.code,adErrorCode:n.adErrorCode,...this._getPlayerVersions(),...this._getErrorLogAdDetails()};M.error(`JwPlayer`,`vastError`,r),t&&this._adFailedLogic()}})})}_handleAdSkipped(){this.setIsRunningAdPlay(!1),this._adPodManager.canApplyAdPodExperience()&&this._adPodManager.canPlayAdPodPrerollAd()&&this._runAdPodPrerollAd()}_handleAdComplete(){this.setIsRunningAdPlay(!1),this._tearDownPlayer(),this._adPodManager.canApplyAdPodExperience()&&this._adPodManager.canPlayAdPodPrerollAd()&&this._runAdPodPrerollAd()}_handleTimeEvents(){this.playerInstance.on(`beforeComplete`,()=>{this._resetAdVars(),this.playerInstance._nonLinearAd=!1}),this.playerInstance.on(`time`,({position:e,duration:t})=>{if(t-e<10&&!this._nextAdFetched){let e=this._adPodManager.canApplyAdPodExperience()?this._adPodManager.shouldFetchNextAdAfterAdvancing():!0;e&&this._handleNextAdFetch()}}),this.playerInstance.on(`adTime`,e=>{if(this._currentAdTime=e.position,this._config.video.logAdDuration&&!this._adDurationLogged){let t={adDuration:e.duration,roundedAdDuration:Math.round(e.duration)};M.event(`VideoManager`,`VideoAdDuration`,t),this._adDurationLogged=!0}}),this.playerInstance.on(`adSkipped`,()=>this._handleAdSkipped()),this.playerInstance.on(`adComplete`,()=>this._handleAdComplete())}_shouldPlayAd(){return this.getIsRunningAdPlay()?!1:this._shouldPlayPrerollAds()}async _triggerAdPlay(){await this._checkForConsent(),this._shouldPlayAd()&&(this._playLinearAd(),this._isFirstPlay=!1)}_handleVideoEvents(){this.playerInstance.on(`playlistItem`,({item:e})=>{var t;this._mediaOrPlaylistId=(t=e.mediaid)==null?`nf`:t,this.setIsRunningAdPlay(!1),this._isFirstPlay||this._adPodManager.incrementVideoContentPlayCount()}),[`play`,`adPlay`,`pause`,`adSkipped`,`adPause`].forEach(e=>{let t=e===`play`,n=e===`adPlay`,r=e===`pause`,i=e===`adPause`,a=e===`adSkipped`;this.playerInstance.on(e,e=>{if((t||i||a)&&(this._clearStaleTimers(),i&&this.playerInstance.once(`adPlay`,()=>{this._currentAdTime!==0&&this._setStaleAdDetection()})),(t||n)&&(this._eventProxy.emitVideoPlayingEvent({playerNumber:0,playlistId:this._playlistId,wasClicked:this._wasClicked,mediaIdCount:this._mediaIdCount,playerType:this._playerType}),n&&this._checkRenderedAdDetails()),t||r){let t=`pauseReason`in e&&e.pauseReason||`playReason`in e&&e.playReason&&!this._calledNextVideo;t&&t===`interaction`&&this._handleUserClick()}}),(t||n)&&this.collapseCollection&&this.playerInstance.once(e,()=>{this.collapseCollection.mediaStarted=!0,this._handleScroll()})}),this.playerInstance.on(`beforePlay`,()=>{this._shouldPlayAd()&&(this.playerInstance.pause(),this._triggerAdPlay())}),document.addEventListener(`slick-auth-dialog-opened`,()=>{this._playerElement.classList.add(this._hiddenClassName),this.collapseCollection&&this.playerInstance.pause()}),document.addEventListener(`slick-auth-dialog-closed`,()=>{var e;this._playerElement.classList.remove(this._hiddenClassName);let t=((e=this.collapseCollection)==null?void 0:e.playerState)!==Y.UserPauseCollapsed;this.collapseCollection&&t&&this.playerInstance.play(!0)})}_checkRenderedAdDetails(e=!1){let t=this._prebidAuctionManager,n=this._adDetails;if(this._instreamRerequestOnErrorResult!==`off`&&(this._bidMarkedOnCurrentAd=!1),!t||!n||this._bidMarkedOnCurrentAd)return;let r=n.gamCreativeId,i=n.wrapperSystems;this._markPrebidBidAsUsed(r,t,i,e)}_markPrebidBidAsUsed(e=``,t,n=[],r=!1){let i=e&&t.videoCreativeIdMapping.get(e),a=!1,o=!1,s=!1;if(n.forEach(e=>{let t=e.toLowerCase();t===`gdfp`&&(o=!0),t===`prebid.org wrapper`?a=!0:t===`amazon`&&(s=!0)}),i){let e=this._adDetails,t=e&&e.tag&&this._getCustParamsFromQueryString(e.tag),n=(t||{})[`hb_adid_${i}`.substring(0,20)];n&&(this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name,adId:n,...!r&&{analytics:!0}}),this._bidMarkedOnCurrentAd=!0,r?this._creativeFailureDetection(n):this._logCreativeIdWithPreviousError(n))}else e||(a||o&&!s||!n.length)&&(this._bidMarkedOnCurrentAd=!0,this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name,...!r&&{analytics:!0}}))}_creativeFailureDetection(e){let t=this._config,n=this._prebidMethods.getBidResponsesForAdUnitCode(this.name).bids||[],r=t.video.instreamCreativeFailureThreshold;for(let o of n){var i;let n=(i=o.creativeId)==null?void 0:i.toString();if(o.adId===e&&n&&!t.prebid.blockedCreativeIds.includes(n)){var a;let e=(a=this._erroredOutCreativeIds.get(n))==null?0:a;e++,this._erroredOutCreativeIds.set(n,e),e>=r&&t.prebid.blockedCreativeIds.push(n);break}}}_logCreativeIdWithPreviousError(e){let t=this._prebidMethods.getBidResponsesForAdUnitCode(this.name).bids||[];for(let n of t)if(n.adId===e&&n.creativeId){let e=this._erroredOutCreativeIds.get(n.creativeId.toString())||0;e&&M.event(`JWPlayer`,`_logCreativeIdWithPreviousError`,{creativeId:n.creativeId});break}}_getCustParamsFromQueryString(e){let t=e&&Hh(e.split(`?`)[1]),n=t&&t.get(`cust_params`),r=n&&Uh(this._getDecodedURI(n));return r}_getDecodedURI(e){try{return decodeURIComponent(e)}catch(e){return``}}_getAdDetailsFromAd(e){return e&&Object.keys(e).length>0?e[Object.keys(e)[0]]:null}_handleAdTrackingEvents(){this.playerInstance.on(`adLoaded`,e=>{let t=e.ima&&e.ima.ad&&this._getAdDetailsFromAd(e.ima.ad),n=t&&t.duration||e.duration||this._defaultAdDuration;this._currentAdDurationWithBuffer=n+this._adTimingBuffer;let r=e.tag;t&&(this._addAdDetailFields(r),this._adDetails={...this._additionalAdFieldsLegacy,wrapperIds:t.adWrapperIds,gamCreativeId:t.adWrapperCreativeIds[t.adWrapperCreativeIds.length-1],gamLineItemId:t.adWrapperIds[t.adWrapperIds.length-1],wrapperCreativeIds:t.adWrapperCreativeIds,vastCreativeId:t.creativeId,mediaFileURL:t.mediaUrl,adUnitName:this._name,tag:e.tag,isEmpty:!1,wrapperSystems:t.adWrapperSystems,duration:n}),this._setStaleAdDetection()}),this.playerInstance.on(`adImpression`,()=>{this._lastAdSuccessful=!0,this._retryAttempts=0;let e=this._adDetails||{};this._eventProxy.emitVideoSlotRenderedEvent(e),this._eventProxy.emitVideoImpressionEvent({videoAdDetails:e,player:this}),this._adPodManager.canApplyAdPodExperience()&&(e.duration&&this._adPodManager.addCreativeDuration(e.duration),this._adPodManager.canFetchNextAdInPod()&&this._doubleFetchBids())}),this._config.video.logAdLifeCycle&&[`adRequest`,`adImpression`,`adStarted`,`adViewableImpression`].forEach(e=>{this.playerInstance.on(e,t=>{e===`adImpression`&&M.event(`JwPlayer`,`adImpression`,this._getJwEventLog(t))})})}_maxRetriesReached(){let e=this._maxRetries,t=this._instreamRerequestOnErrorResult===`vpr`&&this.prerollNum>5,n=this._instreamRerequestOnErrorResult===`vpr2`&&this._retryAttempts>=2,r=this._retryAttempts>=e;return t||n||r}async _runAdPodPrerollAd(){this._pendingBidRequests.length===0&&await this._doubleFetchBids(),this._runAdPlay()}async _adFailedLogic(){let e=this._maxRetriesReached();if(e||this._instreamRerequestOnErrorResult===`off`||this._lastAdSuccessful||!this._midrollBugFixExperiment.result){this._resetAdVars();let e=this._adPodManager;e.canApplyAdPodExperience()&&!e.isLastInAdPod()&&await this._runAdPodPrerollAd();return}this._retryAttempts+=1,this.playerInstance.pause(!0),this.setIsRunningAdPlay(!0),this.playerInstance.seek(0),this._prebidMethods.getHighestCpmBids(this.name).length||await this._fetchBids(!0),this._instreamRerequestOnErrorResult===`dbc`&&this._excludedErroredOutAdIdsFromGamAuction(),this._runAdPlay(!1)}_addAdDetailFields(e){let t=e&&this._getCustParamsFromQueryString(e);t&&(this._additionalAdFieldsLegacy={adId:String(t.hb_adid),adomain:String(t.hb_adomain),hb_bidder:String(t.hb_bidder),amznp:String(t.amznp),hb_pb:String(t.hb_pb),hb_crid:String(t.hb_crid),amznbid:String(t.amznbid),hb_deal:String(t.hb_deal)})}_setupEventProxies(){if(this._collapseType===yW.Mobile){let e=x.resolve(xr);e.footerResponseReceived.on(this._handleFooterResponseReceivedEvent.bind(this))}this._spaListeners.push(this._eventProxy.scroll.on(this._handleScroll.bind(this))),this._spaListeners.push(this._eventProxy.resize.on(this._handleResize.bind(this))),this._spaListeners.push(this._eventProxy.pageVisibility.on(this._handlePageVisibilityChange.bind(this))),this._spaListeners.push(this._eventProxy.videoPlaying.on(this._handleVideoPlayingEvent.bind(this)))}_onBeforeRequestBids(){this._prebidEventBus.beforeRequestBids.on(e=>{e.forEach(e=>{this._prebidMethods.addToQueue(()=>this._setTargetingData(e))})})}_setTargetingData(e){var t;let n=e.code===this.name,r=this._userIdComponent.getTargetingData(),i=this._sspUserSyncComponent.getTargetingData(),a=[...r,...i];n&&a&&(this.userIdTargetingData=a);let o=(t=e.ortb2Imp&&e.ortb2Imp.ext&&e.ortb2Imp.ext.tid)==null?``:t;n&&o&&(this.transactionId=o)}_setupEventListeners(){this._onBeforeRequestBids(),this._handleErrors(),this._listenForLargeVastError(),this._handleTimeEvents(),this._handleVideoEvents(),this._handleAdTrackingEvents(),this._setupEventProxies(),this._listenForPlayerEventsToLog(),this.playerInstance.on(`ready`,this._playerReady.bind(this))}_listenForPlayerEventsToLog(){x.resolve(_2).logEvents(this.playerInstance,{mediaId:this._playlistId,siteId:this._config.site.id,playerId:this._playerId,mediaIdCount:`${this._mediaIdCount||0}`})}_preventCollapse(){LZ.disableCollapse=!0,this.collapseCollection&&LZ.uncollapse(this.collapseCollection)}async _getPrerollAdUrl(){let e=this._adDurationControlExperiment.result;return e&&e!==`off`?`https://vast-tags.com/category/${e}?prerollNum=${this.prerollNum}`:(await this._videoEventBus.buildingVastAdURL.legacyEmit([this]),this.buildVideoUrl(this))}async _playLinearAd(){if(this.setIsRunningAdPlay(!0),this._config.video.logAdLifeCycle&&this._isRunningAdPlay&&M.event(`JwPlayer`,`doubleGAMRequest`,{vprenum:this.prerollNum}),await this._fetchBids(),this._pendingBidRequests.length>0){let e=this._pendingBidRequests.pop();e&&e.then(()=>{this._runAdPlay()}).catch(()=>{this._lastAdSuccessful=!1,this._adPodManager.setAdPlayMap(this.prerollNum,!1),this.setIsRunningAdPlay(!1)})}}_linkProvidedByPublisher(e){return!e.startsWith(`https://cdn.jwplayer.com`)}_updateElementsToIncludeAnchor(){var e,t;let n=document.createElement(`a`);n.id=`video-link`,n.target=`_blank`,n.className=`adthrive-video-text-cutoff`;let r=(e=this._wrapperTitleWrapperElement)==null?void 0:e.parentNode,i=document.getElementById(`video-title-text`);(t=this._wrapperTitleWrapperElement)==null||t.remove(),this._wrapperTitleWrapperElement=n,i&&this._wrapperTitleWrapperElement.appendChild(i),r==null||r.appendChild(this._wrapperTitleWrapperElement)}_updateTitle(e){this._videoTitleElement&&xK(e,`title`)&&typeof e.title==`string`&&(this._videoTitleElement.innerText=e.title),this._topCollapseVideoTitleElement&&xK(e,`title`)&&typeof e.title==`string`&&(this._topCollapseVideoTitleElement.innerText=e.title)}_handleTitleLinkWrapper(e){let t=e.item,n=this._playlistId,r=document.getElementById(`${n}-learn-more-link`),i=document.getElementById(`${n}-svg-link`),a=this._playerType===`related`,o=this._playerType===`related`&&e.index===0,s=!a||!o,c=xK(t,`link`)&&typeof t.link==`string`&&this._linkProvidedByPublisher(t.link),l=this._wrapperTitleWrapperElement&&c&&s,u=this._wrapperText&&c&&s;this._updateTitle(t),l&&(a&&!document.getElementById(`video-link`)&&this._updateElementsToIncludeAnchor(),this._wrapperTitleWrapperElement.href=t.link,i||this._wrapperTitleWrapperElement.prepend(this._createLinkIcon(n))),u&&(this._wrapperText.href=t.link,r||this._wrapperText.append(this._createLearnMoreLink(n))),t&&xK(t,`link`)&&typeof t.link==`string`&&!this._linkProvidedByPublisher(t.link)&&(i==null||i.remove(),r==null||r.remove())}}})),b2,x2,S2,C2,w2,T2,E2,D2,O2,k2,A2,Nge=o((()=>{AI(),jc(),B(),Ra(),X(),$(),Ff(),y2(),HS(),oC(),rU(),j(),E(),O(),A2=class extends v2{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v){super(e,t,n,r,i,a,o,s,c,u,d,f,p,m,rC.Related,l,h,g,void 0,_),this._mobileHeaderSelector=v,T(this,`_playerElement`,void 0),T(this,`_playerContainer`,void 0),T(this,`_topBackgroundElement`,null),T(this,`_stickyElement`,void 0),T(this,`_playerConfig`,{repeat:!0,nextupoffset:-.01,playlist:`https://cdn.jwplayer.com/v2/media/${this._playlistId}`,height:`auto`}),T(this,`_wrapperBarRemoved`,!1),T(this,`_wrapperBar`,void 0),T(this,`_autoplayStationaryPlayer`,void 0),this._playerElement=document.createElement(`div`),this._canSkip=!1,this._autoplayStationaryPlayer=this._shouldStationaryAutoplay(),(l||this._autoplayStationaryPlayer)&&(this._playerConfig={...this._playerConfig,...this._autoplayBehaviorConfig},this.initialAuctionPlayer=!0,this._stickyElement=null,this._playerContainer=this._pageElement)}_appendPlayer(){let e=document.createElement(`div`);e.id=this.playerContainerId,e.className=`adthrive-jw-static-player`,this._isCollapsible?(this._pageElement.id=`adthrive-contextual-container`,this._playerElement.className=`adthrive-player-position`,this._playerElement.id=`adthrive-contextual-position`,this.isTopCenterCollapse()&&this._createTopCenterBackground(this._pageElement),this._config.video.removeVideoTitleWrapper?this._addCloseWithoutWrapper():this.isTopCenterCollapse()?this._addTopCenterWrapper():this._addPlayerWithoutWrapper(),this._playerElement.appendChild(e),this._pageElement.appendChild(this._playerElement)):this._pageElement.appendChild(e)}setup(){if(this._isFirstPlay&&this._appendPlayer(),this.playerInstance=window.jwplayer(this.playerContainerId),this._isCollapsible){let e={playerElement:this._playerElement,playerContainer:this._pageElement,footerElement:this._config.video.footerSelector?document.querySelector(this._config.video.footerSelector):null,stickyElement:this._stickyElement,mobileHeaderSelector:this._mobileHeaderSelector||null};this._createCollapsibleCollection(e),this._playerConfig.playlist=Pf.addMaxResolutionQueryParam(this._playerConfig.playlist)}this._jwSetup(this._playerConfig),this._config.video.relatedPlayerAdded=!0}_handleNextButton(){super._handleNextButton()}_playerReady(e){super._playerReady(e),this._initRelatedPlaylist();let t=this._autoplayStationaryPlayer;(t||this.collapseCollection)&&(e.viewable&&this._inViewPlayAd(),t&&this._logStationaryAutoplay()),this._isCollapsible&&this._setupCollapsible()}_logStationaryAutoplay(){this._config.video.logAdLifeCycle&&M.event(`JwPlayer`,`StaticPlayer`,{message:`Static Player set to autoplay for playlist id ${this._playlistId}`,...this._getPlayerVersions()})}_loadPlaylistPlayerVideos(){let e=this._config.video.jwPlaylistObj.playlist,{hasContentSpecificPlaylist:t,contentSpecificPlaylistshuffle:n}=this._config.video.jwPlaylistObj;e.then(e=>{if(e.playlist&&e.playlist.length){let r=!t||n,i=r?Pf.shufflePlaylist(e.playlist):e.playlist,a=this.playerInstance.getPlaylist().concat(i);this.playerInstance.once(`userInactive`,()=>{var e;!((e=this.collapseCollection)!=null&&e.mediaStarted)&&this._handleScroll().catch(()=>{})}),this.playerInstance.load(a),this._handleScroll().catch(()=>!1)}}).catch(()=>!1)}_setupAllowSkip(){this._config.video.advancePlaylist.relatedPlayer.applyToFirst&&(this._canSkip=!0),this.playerInstance.once(`complete`,()=>{this._canSkip=!0})}_shouldStationaryAutoplay(){return!this._config.video.playlistPlayerAdded&&!!document.querySelector(`body.adthrive-video-autoplay`)}_setWrapperBar(){this._wrapperBar=this._playerElement.querySelector(`.adthrive-wrapper-bar`)}_hideWrapperBar(){let e=this._wrapperBar,t=this._playerElement;this._wrapperBarRemoved||!e||(this._wrapperBarRemoved=!0,e.parentNode&&e.parentNode.removeChild(e),this._wrapperBar=null,t.insertBefore(this._createPlayerCloseButton(),t.firstChild),this.collapseCollection&&(this.collapseCollection.closeButton=this._closeButton,this._displayCloseButton()))}_addCloseWithoutWrapper(){this._playerElement.appendChild(this._createPlayerCloseButton()),this._playerElement.classList.add(`adthrive-player-without-wrapper-text`)}_addTopCenterWrapper(){this._playerElement.appendChild(this._createPlayerWrapper(!1)),this._playerElement.appendChild(this._createTopCollapseWrapper(!1)),this._playerElement.classList.add(`adthrive-player-with-wrapper-text`)}_addPlayerWithoutWrapper(){this._playerElement.appendChild(this._createPlayerWrapper(!1)),this._playerElement.classList.add(`adthrive-player-without-wrapper-text`)}_initRelatedPlaylist(){let e=this._config.video,t=e.advancePlaylist.relatedPlayer;t.shouldRun.then(e=>{e&&(this._loadPlaylistPlayerVideos(),this._setupAllowSkip(),this.playerInstance.on(`firstFrame`,()=>this._handleFirstFrame()),this.playerInstance.getContainer().addEventListener(`click`,e=>this._handleVideoPlayerClicked(e)),this._initSkipContainer())}).catch(()=>!1)}_setupCollapsible(){this._setWrapperBar(),this._wrapperBar&&this._wrapperBar.style.setProperty(`display`,`flex`),this._handleResize()}},A2=D([Q(`RelatedPlayer`),A(`design:paramtypes`,[Object,Number,String,typeof(b2=vW!==void 0&&vW)==`function`?b2:Object,Array,typeof(x2=typeof HTMLElement<`u`&&HTMLElement)==`function`?x2:Object,typeof(S2=VS!==void 0&&VS)==`function`?S2:Object,typeof(C2=z!==void 0&&z)==`function`?C2:Object,typeof(w2=L!==void 0&&L)==`function`?w2:Object,Boolean,typeof(T2=yW!==void 0&&yW)==`function`?T2:Object,typeof(E2=bW!==void 0&&bW)==`function`?E2:Object,typeof(D2=Pr!==void 0&&Pr)==`function`?D2:Object,typeof(O2=R!==void 0&&R)==`function`?O2:Object,typeof(k2=kI!==void 0&&kI)==`function`?k2:Object,Boolean,Object,Object,Object])],A2)})),j2,Pge=o((()=>{Lt(),Z(),H(),E(),j2=class extends V{constructor(e,t,n){super(),this._videoConfig=e,this._component=t,this._context=n,T(this,`_potentialPlayerMap`,void 0),T(this,`_device`,void 0),T(this,`_stickyRelatedOnPage`,!1),T(this,`_relatedMediaIds`,[]),this._device=Ei()?`desktop`:`mobile`,this._potentialPlayerMap=this.setPotentialPlayersMap()}setPotentialPlayersMap(){let e=this._videoConfig.players||[],t=this._filterPlayerMap(),n=e.filter(e=>e.type===`stationaryRelated`&&e.enabled);return t.stationaryRelated=n,this._potentialPlayerMap=t,this._potentialPlayerMap}_filterPlayerMap(){let e=this._videoConfig.players,t={stickyRelated:[],stickyPlaylist:[],stationaryRelated:[]};return e&&e.length?e.filter(e=>{var t;return(t=e.devices)==null?void 0:t.includes(this._device)}).reduce((e,t)=>(e[t.type]||(M.event(this._component,`constructor`,`Unknown Video Player Type detected`,t.type),e[t.type]=[]),t.enabled&&e[t.type].push(t),e),t):t}_checkPlayerSelectorOnPage(e){for(let t of this._potentialPlayerMap[e]){let e=this._getPlacementElement(t);if(e)return{player:t,playerElement:e}}return{player:null,playerElement:null}}_getOverrideElement(e,t,n){if(e&&t){let r=document.createElement(`div`);t.insertAdjacentElement(e.position,r),n=r}else{let{player:e,playerElement:t}=this._checkPlayerSelectorOnPage(`stickyPlaylist`);if(e&&t){let r=document.createElement(`div`);t.insertAdjacentElement(e.position,r),n=r}}return n}_shouldOverrideElement(e){let t=e.getAttribute(`override-embed`);return t===`true`||t===`false`?t===`true`:this._videoConfig.relatedSettings?this._videoConfig.relatedSettings.overrideEmbedLocation:!1}_checkPageSelector(e,t,n=[]){let r=e&&t&&n.length===0;if(r){let t=window.location.pathname===`/`;return!t&&M.event(`VideoUtils`,`getPlacementElement`,Error(`PSNF: ${e} does not exist on the page`)),!1}return!0}_getElementSelector(e,t,n){return t&&t.length>n?t[n]:(M.event(`VideoUtils`,`getPlacementElement`,Error(`ESNF: ${e} does not exist on the page`)),null)}_getPlacementElement(e){let{pageSelector:t,elementSelector:n,skip:r}=e,{valid:i,elements:a,...o}=Lf(t),{valid:s,elements:c,...l}=If(n);if(t!==``&&!i)return M.error(`VideoUtils`,`getPlacementElement`,Error(`${t} is not a valid selector`),o),null;if(!s)return M.error(`VideoUtils`,`getPlacementElement`,Error(`${n} is not a valid selector`),l),null;let u=this._checkPageSelector(t,i,a);if(!u)return null;let d=this._getElementSelector(n,c,r);return d||null}_getEmbeddedPlayerType(e){let t=e.getAttribute(`data-player-type`);return(!t||t===`default`)&&(t=this._videoConfig.relatedSettings?this._videoConfig.relatedSettings.defaultPlayerType:`static`),this._stickyRelatedOnPage&&(t=`static`),t}_getMediaId(e){let t=e.getAttribute(`data-video-id`);return t?(this._relatedMediaIds.push(t),t):!1}_createRelatedPlayer(e,t,n,r){t===`collapse`?this._createCollapsePlayer(e,n):t===`static`&&this._createStaticPlayer(e,n,r)}_createCollapsePlayer(e,t){let{player:n,playerElement:r}=this._checkPlayerSelectorOnPage(`stickyRelated`),i=n||this._potentialPlayerMap.stationaryRelated[0];if(i&&i.playerId){let a=this._shouldOverrideElement(t);a&&(t=this._getOverrideElement(n,r,t)),t=document.querySelector(`#cls-video-container-${e} > div`)||t,this._createStickyRelatedPlayer({...i,mediaId:e},t)}else M.error(this._component,`_createCollapsePlayer`,`No video player found`)}_createStaticPlayer(e,t,n){if(this._potentialPlayerMap.stationaryRelated.length&&this._potentialPlayerMap.stationaryRelated[0].playerId){let r=this._potentialPlayerMap.stationaryRelated[0];this._createStationaryRelatedPlayer({...r,mediaOrPlaylistId:e},t,n)}else M.error(this._component,`_createStaticPlayer`,`No video player found`)}_shouldRunAutoplayPlayers(){return!!(this._isVideoAllowedOnPage()&&(this._potentialPlayerMap.stickyRelated.length||this._potentialPlayerMap.stickyPlaylist.length))}_setPlaylistMediaIdWhenStationaryOnPage(e,t){let n=this._potentialPlayerMap.stationaryRelated.length&&this._potentialPlayerMap.stationaryRelated[0].playerId;if(n&&e&&e.length){let n=e[0],r=n.getAttribute(`data-video-id`);return r?{...t,mediaId:r}:t}return t}_determineAutoplayPlayers(e){let t=this._component,n=t===`VideoManagerComponent`,r=this._context;if(this._stickyRelatedOnPage){M.event(t,`stickyRelatedOnPage`,n&&{device:r&&r.device,isDesktop:this._device}||{});return}let{playerElement:i}=this._checkPlayerSelectorOnPage(`stickyPlaylist`),{player:a}=this._checkPlayerSelectorOnPage(`stickyPlaylist`);a&&a.playerId&&i?(a=this._setPlaylistMediaIdWhenStationaryOnPage(e,a),this._createPlaylistPlayer(a,i)):Math.random()<.01&&setTimeout(()=>{M.event(t,`noStickyPlaylist`,n&&{vendor:`none`,device:r&&r.device,isDesktop:this._device}||{})},1e3)}_initializeRelatedPlayers(e){let t=new Map;for(let n=0;n<e.length;n++){let r=e[n],i=r.offsetParent,a=this._getEmbeddedPlayerType(r),o=this._getMediaId(r);if(i&&o){let e=(t.get(o)||0)+1;t.set(o,e),this._createRelatedPlayer(o,a,r,e)}}}}})),M2,N2,P2,F2,I2,L2,R2,z2,Fge=o((()=>{$h(),jc(),vg(),B(),ii(),Hr(),tU(),X(),$(),Ff(),Ta(),w(),$H(),WC(),oC(),yI(),kC(),j(),E(),O(),z2=class{constructor(e,t,n,r,i,a,o){this._abgroup=e,this._config=t,this._gam=n,this._irisTvTracker=r,this._videoEventBus=i,this._slotEventBus=a,this._prebidMethods=o,T(this,`_apstagSlotBids`,new Map),T(this,`_prebidSlotTargetingMap`,new Map),T(this,`_amazonTargetingKeysToRemove`,[`amznp`,`amznp_sp`]),T(this,`shouldPrebidRun`,!1),this._videoEventBus.addAPStagSlotBidResponse.on(({playlistId:e,bid:t,discounts:n})=>this._addAPStagSlotBidResponse(e,t,n)),this._slotEventBus.addPrebidSlotTargeting.on(({adUnitCode:e,slotTargeting:t})=>this._addPrebidSlotTargeting(e,t))}_addAPStagSlotBidResponse(e,t,n){this._apstagSlotBids.set(e,{bid:t,discounts:n})}_addPrebidSlotTargeting(e,t){this._prebidSlotTargetingMap.set(e,t)}getVideoTargeting(e,t){let n=`imav`,r=this._irisTvTracker.enabled?this._irisTvTracker.irisContextualData:void 0,i={};return Object.keys(t).forEach(e=>{let n=t[e];i[e]=encodeURIComponent(n.toString())}),i.mcmp=this._getMcmpValues(),i.vprenum=String(e.prerollNum),UC(e)?(i.jwv=e.jwVersion||``,i[n]=e.imaVersion||``):i[n]=e.imaManager.imaSDKVersion||``,i.voba=this._config.videoOpenBidding.bidders.toString(),r&&(i.iris_context=r.toString()),i}_extractBidsDuration(e){if(!e||!e.length)return{};let t={};return e.forEach(e=>{if(!e||t[`hb_dur_${e.bidder}`])return;let n=e.duration;n&&!isNaN(n)&&(t[`hb_dur_${e.bidder}`]=n)}),t}_getMcmpValues(){let e=this._getTrackScrollTargeting(),t=[...this._config.marmalade.mcmpTargeting];return e&&t.push(...e),t.toString()}_getTrackScrollTargeting(){let e=this._config.trackScroll,t=e.trackScrollEnabled&&e.getTargetingValue();return t}_getVideoBid(e){let t=this._apstagSlotBids.get(e),n=t==null?void 0:t.bid,r=t==null?void 0:t.discounts;return n?(this._apstagSlotBids.delete(e),{bid:n,discounts:r}):{}}getPrebidNoBidTargeting(e){let t=this.getPrebidSlotTargeting(e),n=t.noBid;if(n)return{hb_bidder:n}}getPrebidSlotTargeting(e){return this._prebidSlotTargetingMap.get(e)||{}}_convertFlagSlotValues(e){let t=[];return Object.keys(e).forEach(n=>{let r=e[n];typeof r==`string`?t.push(`${n}%3A${r}`):Array.isArray(r)&&r.length>0&&t.push(r.map(e=>`${n}%3A${e}`).join(`,`))}),t.join(`,`)}_addAmazonDiscountTargeting(e,t){let{standard:n,pmp:r}=e,i=(e,n)=>{this._config.video.setVideoFlagSlot(t,{[e]:[n.toFixed(6).toString()]})};n.originalCpm&&i(`aop`,n.originalCpm),n.discount&&i(`apd`,n.discount),r.originalCpm&&i(`aopp`,r.originalCpm),r.discount&&i(`appd`,r.discount)}_removeSpecificAmazonTargetingKey(e){this._amazonTargetingKeysToRemove.forEach(t=>{delete e[t]})}_getAmazonBidTargeting(e,t){let{bid:n,discounts:r}=this._getVideoBid(e);if(n){let e={};for(let t in n)if(t===`targeting`)e={...e,...n[t]};else if(this._config.amazon.amznTargetingKeys.includes(t)){let r=n[t];e[t]=r}return this._removeSpecificAmazonTargetingKey(e),r&&this._addAmazonDiscountTargeting(r,t),e}return{}}_setPrebidDiscountTargeting(e){let{cpm:t,responseCpm:n}=this._prebidMethods.getHighestCpmBids(e)[0]||{},r=(n||0)-(t||0);n&&r&&this._config.video.setVideoFlagSlot(e,{pbop:[t.toFixed(6).toString()],pbpd:[r.toFixed(6).toString()]})}_getFloorsTargeting(e){let t=this._config.video.videoFlagSlot[e]||{};return t&&this._config.video.clearVideoFlagSlot(e),t}_getTopCPMValue(e,t){return Number.isFinite(t)&&(!Number.isFinite(e)||t>e)?t:e}_getCPMRange(e,t){var n;let r=e==null||(n=e.adserverTargeting)==null?void 0:n.hb_pb,i=Number(r),a=t==null?void 0:t.amz_pb,o=Number(a),s=t==null?void 0:t.amz_pb_sp,c=Number(s),l=a&&s?Math.max(o,c):o||c,u=this._getTopCPMValue(i,l);return vI(u)}_getCustParams(e,t=!0){var n,r;let i=this._gam.getTargetingMap(),a=this._getAmazonBidTargeting(e._playlistId,e.name),o=t&&this._getActiveBidsInPool(e),s=this._extractBidsDuration(o),c=e.lastAuctionBidDetails,l=c==null?{bic:`0`,tbc:`none`,"2bc":`none`,medb:`none`,bidr:`0`}:c,u=o?o[0]:void 0,d=this._getCPMRange(u,a),f={...(e.isPlayerType===rC.Playlist||e.isPlayerType===rC.AutoInjected)&&{plid:e._playlistId},...e instanceof QH?{jwpid:(n=e._playerId)==null?``:n}:{},jwmid:e.nextMediaId||e.mediaOrPlaylistId,...this._getFloorsTargeting(e.name),tid:`transactionId`in e?e.transactionId:``,iroe:`retryAttempts`in e?e.retryAttempts.toString():`0`,player:UC(e)?`j`:`r`,...e instanceof QH?{cclang:(r=e.captionLanguage)==null?``:r}:{},fle:e.eligibleFloorComponents,fla:e.appliedFloorComponents,...l,...typeof e.vpodnum==`number`&&{vpodnum:e.vpodnum.toString()}},p={...f&&{flag_slot:this._convertFlagSlotValues(f)},...this.getVideoTargeting(e,i),...this.getPrebidNoBidTargeting(e.name),...a,...s,idp:e.userIdTargetingData.join(`,`),...d&&{hb_rpb:d}};return p}_getActiveBidsInPool(e){let t=(this._prebidMethods.getBidResponsesForAdUnitCode(e.name)||{}).bids,n=e.getMinMaxDurationsForGAM();return t&&t.filter(e=>{let t=e.ttl||300,r=e.responseTimestamp+t*1e3>new Date().getTime(),i=e&&e.status!==`rendered`,a=!0;return n&&e.maxDuration&&(a=e.maxDuration===n.max_ad_duration/1e3),r&&i&&a}).sort((e,t)=>t.cpm-e.cpm)}handleGdprConsent(){let e={gdpr:1,gdpr_consent:`tcunavailable`},t=!!this._config.gdpr.consentCapturedData.consentString,n=!!this._config.gdpr.consentCapturedData.additionalConsent,r=typeof window.__tcfapi==`function`;return t&&(e.gdpr_consent=this._config.gdpr.consentCapturedData.consentString),n&&(e.addtl_consent=this._config.gdpr.consentCapturedData.additionalConsent),!t&&r&&window.__tcfapi(`getTCData`,2,t=>{let n=!!(t&&t.tcString),r=!!(t&&t.addtlConsent);n&&(e.gdpr_consent=t.tcString),r&&(e.addtl_consent=t.addtlConsent)}),e}getConsentParams(){if(this._config.gdpr.enabled)return this.handleGdprConsent();if(this._config.ccpa.privacyString)return{us_privacy:this._config.ccpa.privacyString}}getDefaultVideoUrlParams(e){let t=window.location.origin,n=e.getMinMaxDurationsForGAM(),r=e.plcmt||OC(this._config.video.plcmtUnits,e);return{iu:`/${this._config.gam.account}/${this._config.gam.prefix}_${e.name}/${this._config.site.id}`,sz:e.size.join(`x`),hl:`en`,output:`vast`,url:`__page-url__`,vad_type:`linear`,description_url:`${encodeURIComponent(encodeURIComponent(t))}`,pp:`10_VAST%20redirects_video%2Fmp4_VPAID%20JavaScript`,vpos:`preroll`,vpmute:this._getVpmute(e.name),wta:1,tfcd:Sa()||wa()?1:0,...r&&{plcmt:r},...n}}buildGAMVideoUrl(e){let t=this.getConsentParams(),n=Pf.createQueryString(this._getCustParams(e,!1)),r=Pf.createEncodedQueryString({cust_params:n}),i=this.getDefaultVideoUrlParams(e),a={env:`vp`,gdfp_req:`1`,unviewed_position_start:`1`,...i,...t};return`https://securepubads.g.doubleclick.net/gampad/ads?${Pf.createQueryString(a)}&${r}`}buildGAMVideoUrlPrebid(e){var t;let n=e.videoAdUnit||{};this._setPrebidDiscountTargeting(e.name);let r=this._getCustParams(e),i=this.getDefaultVideoUrlParams(e);return(t=this._prebidMethods.buildVideoURL(n,i,r))==null?this.buildGAMVideoUrl(e):t}buildVideoUrl(e){return this.shouldPrebidRun?this.buildGAMVideoUrlPrebid(e):this.buildGAMVideoUrl(e)}_getVpmute(e){return e===vW.Video_In_Post_ClicktoPlay_SoundOn?0:1}},z2=D([Q(`VideoUrlBuilder`),C(),A(`design:paramtypes`,[typeof(M2=ti!==void 0&&ti)==`function`?M2:Object,typeof(N2=z!==void 0&&z)==`function`?N2:Object,typeof(P2=Zh!==void 0&&Zh)==`function`?P2:Object,typeof(F2=_g!==void 0&&_g)==`function`?F2:Object,typeof(I2=eU!==void 0&&eU)==`function`?I2:Object,typeof(L2=Vr!==void 0&&Vr)==`function`?L2:Object,typeof(R2=R!==void 0&&R)==`function`?R2:Object])],z2)})),B2,Ige=o((()=>{B2=e=>{var t,n;return(t=(n=document.querySelector(`meta[name=${e}]`))==null?void 0:n.content)==null?null:t}})),V2,Lge=o((()=>{Ige(),V2=()=>{let e=B2(`generator`)||``;return e.includes(`Wix`)||!!window.wixPerformanceMeasurements||!!window[`wix-perf-measure`]||!!window.wixDevelopersAnalytics}})),H2,Rge=o((()=>{ZK(),H2=XK({condition:()=>!1,delay:500,maxAttempts:8})})),U2,W2,G2,K2,q2,J2,Y2,X2,Z2,Q2,$2,zge=o((()=>{AI(),jc(),y2(),HS(),B(),Ra(),X(),$(),Ff(),_W(),w(),oC(),rU(),j(),E(),O(),$2=class extends v2{constructor(e,t,n,r,i,a,o,s,c,l=yW.Float,u,d,f,p,m,h,g,_,v,y,b){super(e,1,t,n,r,a,o,s,c,l,u,d,f,p,rC.Playlist,!0,m,h,v,g),this._sharedVideoSettings=i,this._title=y,this._shuffle=b,T(this,`_playerElement`,void 0),T(this,`_playerContainer`,void 0),T(this,`_topBackgroundElement`,null),T(this,`_stickyElement`,void 0),T(this,`_footerElement`,void 0),T(this,`_clsPlayerContainer`,void 0),T(this,`_isCollapsible`,!0),T(this,`_playlistFixExperiment`,void 0),T(this,`_playerData`,null),T(this,`_playerConfig`,{repeat:!0,playlist:`https://cdn.jwplayer.com/v2/playlists/${this._playlistId}`,related:{autoplaytimer:0}}),T(this,`_hasContentSpecificPlaylist`,void 0),T(this,`_shuffleContentSpecificPlaylist`,!1),this._clsPlayerContainer=document.querySelector(`#cls-video-container-${this.playerContainerId} > div`)||document.querySelector(`#cls-video-container-${this.playerContainerId.split(`_`)[0]} > div`),this._playerContainer=this._clsPlayerContainer?this._clsPlayerContainer:document.createElement(`div`),this._playerElement=document.createElement(`div`);let ee=this._config.video.jwPlaylistObj;this._hasContentSpecificPlaylist=ee.hasContentSpecificPlaylist,this._shuffleContentSpecificPlaylist=ee.contentSpecificPlaylistshuffle,ee&&ee.playlistId&&(this._playlistId=ee.playlistId,this._playerConfig.playlist=`https://cdn.jwplayer.com/v2/playlists/${this._playlistId}`),this._playerConfig={...this._playerConfig,...this._autoplayBehaviorConfig},this.initialAuctionPlayer=!0,this._stickyElement=null,this._checkVideoClose()&&(this._state=Y.Closed),this._config.video.footerSelector?this._footerElement=document.querySelector(this._config.video.footerSelector):this._footerElement=null,this._playerData={playerElement:this._playerElement,playerContainer:this._playerContainer,footerElement:this._footerElement,stickyElement:this._stickyElement,mobileHeaderSelector:_||null},this._playlistFixExperiment=x.resolve(HU).result,this._playlistFixExperiment||this._createCollapsibleCollection(this._playerData)}setup(){this._isCollapsible&&(this._playerConfig.playlist=Pf.addMaxResolutionQueryParam(this._playerConfig.playlist),this._playlistFixExperiment&&this._createCollapsibleCollection(this._playerData),this.collapseCollection.closeButton=this._closeButton),this._isFirstPlay&&this._appendPlayer(),this.playerInstance=window.jwplayer(this._playlistId),this.collapseCollection&&(this.collapseCollection.playerInstance=this.playerInstance,this.collapseCollection.playerContainer=this._playerContainer,this.collapseCollection.playerElement=this._playerElement,this.collapseCollection.topBackgroundElement=this._topBackgroundElement),this._jwSetup(this._playerConfig),this._config.video.playlistPlayerAdded=!0}_appendPlayer(){let e=document.createElement(`div`);this._playerContainer.classList.add(`adthrive-player-container`),this._playerContainer.classList.add(`adthrive-collapse-player`),this._playerContainer.id=`adthrive-collapse-container`,this._playerElement.className=`adthrive-player-position`,this._playerElement.id=`adthrive-collapse-position`,e.id=this._playlistId;let t=this._getTitle();if(t){let e=document.createElement(`h3`);e.innerText=t,e.className=`adthrive-player-title`,e.id=`adthrive-collapse-title`,this._playerElement.appendChild(e)}this._config.video.removeVideoTitleWrapper?(this._playerElement.appendChild(this._createPlayerCloseButton()),this._playerElement.classList.add(`adthrive-player-without-wrapper-text`)):this._collapseType===yW.Mobile&&this._isTopCollapse?(this._playerElement.appendChild(this._createPlayerWrapper(!0)),this._playerElement.appendChild(this._createTopCollapseWrapper()),this._playerElement.classList.add(`adthrive-player-with-wrapper-text`)):(this._playerElement.appendChild(this._createPlayerWrapper(!0)),this._playerElement.classList.add(`adthrive-player-without-wrapper-text`)),this.collapseCollection.closeButton=this._closeButton,this._playerElement.appendChild(e),this.isTopCenterCollapse()&&this._createTopCenterBackground(this._playerContainer),this._playerContainer.appendChild(this._playerElement),this._clsPlayerContainer||this._pageElement.insertAdjacentElement(this._sharedVideoSettings.position,this._playerContainer)}_linkProvidedByPublisher(e){return!e.startsWith(`https://cdn.jwplayer.com`)}_playerReady(e){var t;super._playerReady(e),(t=this._playerElement.querySelector(`.adthrive-wrapper-bar`))==null||t.style.setProperty(`display`,`flex`);let n=this._getShuffle();if(n||this._hasContentSpecificPlaylist&&this._shuffleContentSpecificPlaylist){let e=this.playerInstance.getPlaylist();this.playerInstance.load(Pf.shufflePlaylist(e))}this._config.video.advancePlaylist.playlistPlayer.enabled&&(this.playerInstance.on(`firstFrame`,()=>this._handleFirstFrame()),this.playerInstance.getContainer().addEventListener(`click`,e=>this._handleVideoPlayerClicked(e)),this._initSkipContainer()),this._handleResize(),this._playlistFixExperiment&&this._handleScroll().catch(()=>!1),e.viewable&&this._inViewPlayAd()}_getShuffle(){return this._shuffle?this._shuffle:!1}_getTitle(){return this._title?this._title:``}_checkVideoClose(){return this._saveVideoCloseState&&this._config.video.videoWasClosed}},$2=D([Q(`PlaylistPlayer`),A(`design:paramtypes`,[String,String,typeof(U2=vW!==void 0&&vW)==`function`?U2:Object,Array,Object,typeof(W2=typeof HTMLElement<`u`&&HTMLElement)==`function`?W2:Object,typeof(G2=VS!==void 0&&VS)==`function`?G2:Object,typeof(K2=z!==void 0&&z)==`function`?K2:Object,typeof(q2=L!==void 0&&L)==`function`?q2:Object,typeof(J2=yW!==void 0&&yW)==`function`?J2:Object,typeof(Y2=bW!==void 0&&bW)==`function`?Y2:Object,typeof(X2=Pr!==void 0&&Pr)==`function`?X2:Object,typeof(Z2=R!==void 0&&R)==`function`?Z2:Object,typeof(Q2=kI!==void 0&&kI)==`function`?Q2:Object,Boolean,Object,Object,Object,Boolean,String,Boolean])],$2)})),e4,Bge=o((()=>{$H(),e4=class extends QH{_setNextVideoTitle(){if(!this._config.video.removeVideoTitleWrapper&&!this.isFirstPlay){let e=this._getVideoUsingIndex(this._getNextIndex());e&&this._setVideoTitle(e)}}_handleAdvancePlaylistAdvanceToAd(){this._setNextVideoTitle(),super._handleAdvancePlaylistAdvanceToAd()}_handleAdvancePlaylistAdvanceToContent(){this._setNextVideoTitle(),super._handleAdvancePlaylistAdvanceToContent()}_handleVideoElementEnded(){this._setNextVideoTitle(),super._handleVideoElementEnded()}_updateWrapperTextForRelatedPlayer(e){if(!this._wrapperText)return;this._wrapperText.href=e.link;let t=this._linkProvidedByPublisher(e.link),n=this._wrapperText.querySelector(`.raptive-player-learn-more-link`);if(!n){let e=this._createLearnMoreLink(this._playlistId,t);this._wrapperText.appendChild(e)}let r=this._playerPosition.querySelector(`.adthrive-top-collapse-wrapper-bar`);r==null||r.appendChild(this._wrapperText)}_isNonInitialRelatedVideo(){return this._getNextIndex()!==0}_updateTopCollapseTitle(e){this._topCollapseVideoTitleElement&&(this._topCollapseVideoTitleElement.innerHTML=e)}_setWrapperTitleAttributes(e){this._wrapperTitleWrapperElement&&(this._wrapperTitleWrapperElement.href=e,this._wrapperTitleWrapperElement.target=`_blank`,this._wrapperTitleWrapperElement.onclick=this._handleTitleClick.bind(this))}_updateWrapperTitleWrapper(e,t){var n;if(this._wrapperTitleWrapperElement)if((n=this._wrapperTitleWrapperElement.querySelector(`svg`))==null||n.remove(),e){let e=this._createLinkIcon(this._playlistId);this._wrapperTitleWrapperElement.appendChild(e),this._isNonInitialRelatedVideo()&&(this._setWrapperTitleAttributes(t),this._videoTitleOverlayContainer.prepend(this._wrapperTitleWrapperElement),this._wrapperTitleWrapperElement.classList.remove(`adthrive-no-pointer-events`))}else this._wrapperTitleWrapperElement.classList.add(`adthrive-no-pointer-events`)}_setVideoTitle(e){this._isNonInitialRelatedVideo()&&this._updateWrapperTextForRelatedPlayer(e);let t=this._getNextIndex()===1;t&&this.createTitleOverlayContainer(!0);let{title:n,link:r}=e;this._videoTitle=n,this._videoLink=r,this._updateTopCollapseTitle(n),this._videoTitleDiv.innerHTML=`<span class='adthrive-video-text-cutoff'>${n}</span>`,this._videoDescriptionDiv.innerHTML=`<span class='adthrive-video-text-cutoff'>${e.description}</span>`;let i=this._linkProvidedByPublisher(this._videoLink);this._toggleLearnMoreLink(i),this._updateWrapperTitleWrapper(i,r)}_createTopCollapseWrapper(){if(this._wrapperText){let e=this._linkProvidedByPublisher(this._videoLink);e&&this._isNonInitialRelatedVideo()&&(this._wrapperText.href=this._videoLink)}return super._createTopCollapseWrapper()}}})),t4,n4,r4,Vge=o((()=>{Od(),ii(),fU(),X(),$(),w(),j(),E(),At(),O(),r4=class extends iU{constructor(e,t,n){super(),this._siteExperiments=e,this._pubabgroup=t,T(this,`storagePrefix`,`se`),T(this,`_choices`,[]),T(this,`_result`,!1),T(this,`key`,Xn.StickyOutstreamOnStickyPlayer),this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this.experimentConfig&&Dd(n)&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}run(){let e=this._choices[0].weight/100,t=new ar(e).get();return t}setExperimentTargeting(){if(!this.enabled||!this.experimentConfig){M.error(`StickyOutstreamOnStickyPlayerPagesSiteExperiment`,`setExperimentTargeting`,`() => %o`,`Experiment targeting requires an experiment config`);return}let e=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`,t=this._result?`on`:`off`;this._pubabgroup.set(e,t)}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],r4.prototype,`run`,null),r4=D([C(),A(`design:paramtypes`,[typeof(t4=uU!==void 0&&uU)==`function`?t4:Object,typeof(n4=ri!==void 0&&ri)==`function`?n4:Object,Object]),kt(2,ot(`AdThrive`))],r4)})),i4,a4,o4,s4,c4,l4,u4,d4,f4,p4,m4,h4,g4,_4,v4,y4,b4,x4,S4,C4,w4,T4,E4,Hge=o((()=>{$h(),AI(),VC(),jc(),rd(),Nge(),B(),Ra(),X(),wW(),$(),Pge(),Z(),fg(),w(),so(),_0(),KI(),vg(),HS(),Fge(),rU(),Lge(),Rge(),ew(),$H(),RZ(),_W(),zge(),oC(),tU(),Bge(),al(),Vge(),j(),E(),O(),E4=class extends j2{async init(){V2()&&await H2(),this._setupSpaListeners(),this._handleCollapsibleVideoLogging(),this._initializePlayers(),this._mediaType.runOneStreamExperiment()}constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v,y,b,ee){super(r.video,`VideoManagerComponent`,i),this._auctionManagers=e,this._bootstrapConfig=t,this._collapsibleVideoLoggingStore=n,this._config=r,this._context=i,this._eventProxy=a,this._events=o,this._irisTvTracker=s,this._jwBoostExperiment=c,this._mediaType=l,this._ortb2=u,this._prebidEventBus=d,this._prebidMethods=f,this._spaEventBus=p,this._videoEventBus=m,this._raptiveDesktopPlayerExperiment=h,this._raptiveMobilePlayerExperiment=g,this._userPageDataLoggingEvent=_,this._videoCollapseScrollUpExperiment=v,this._videoCollapseScrollUpTopCenterExperiment=y,this._videoRequestManager=b,this._videoUrlBuilder=ee,T(this,`_jwPlayers`,[]),T(this,`_html5Players`,[]),T(this,`_spaListeners`,[]),T(this,`_IN_POST_SELECTOR`,`.adthrive-video-player`),T(this,`_desktopCollapseOnScrollUp`,!1),T(this,`_mobileCollapseOnScrollUp`,`off`),T(this,`_desktopRaptivePlayerEnabled`,!1),T(this,`_mobileRaptivePlayerEnabled`,!1),T(this,`_shouldUseHardcodedAdPodDuration`,!1),T(this,`_stickyOutstreamOnStickyPlayerPagesSiteExperiment`,void 0),this._desktopCollapseOnScrollUp=this._videoCollapseScrollUpExperiment.result,this._mobileCollapseOnScrollUp=this._videoCollapseScrollUpTopCenterExperiment.result||`off`;let te=x.resolve(JU).result;this._desktopRaptivePlayerEnabled=te||this._device!==`mobile`&&this._raptiveDesktopPlayerExperiment.result,this._mobileRaptivePlayerEnabled=te||this._device===`mobile`&&this._raptiveMobilePlayerExperiment.result,this._shouldUseHardcodedAdPodDuration=il.isRolloutEnabled(`max-video-ad-duration`),this._eventProxy.videoPlaying.on(this.setPlayerAsPlaying.bind(this)),this._stickyOutstreamOnStickyPlayerPagesSiteExperiment=x.resolve(r4)}setPlayerAsPlaying({playerNumber:e}){this._html5Players.forEach(t=>{t.canPlay=t.playerNumber===e})}_setupSpaListeners(){this._spaEventBus.routeChanged.on(()=>{this._removeExistingSpaListeners(),this._removePlayers(),this._stickyRelatedOnPage=!1,this._relatedMediaIds=[],this.setPotentialPlayersMap()}),this._spaEventBus.resetCompleted.on(()=>{this._handleCollapsibleVideoLogging(),this._initializePlayers()})}_removeExistingSpaListeners(){this._spaListeners.forEach(e=>e()),this._spaListeners.length=0}_removePlayers(){this._jwPlayers.forEach(e=>e.playerInstance.remove()),this._jwPlayers.length=0}_initializePlayers(){let e=document.querySelectorAll(this._IN_POST_SELECTOR);if(e.length&&this._initializeRelatedPlayers(e),!this._shouldRunAutoplayPlayers()){try{this._importScripts(),this._initHtml5Players()}catch(e){M.error(`VideoManagerComponent`,`initializePlayers`,e)}return}this._determineAutoplayPlayers(e);try{this._importScripts(),this._initHtml5Players()}catch(e){M.error(`VideoManagerComponent`,`initializePlayers`,e)}}_createStationaryRelatedPlayer(e,t,n){let r=this._device===`mobile`?[400,225]:[640,360],i=vW.Video_In_Post_ClicktoPlay_SoundOn,a=this._config,o=this._prebidMethods,s=this._prebidEventBus,c=this._context;if(!this._desktopRaptivePlayerEnabled&&!this._mobileRaptivePlayerEnabled){let a=new A2(e.playerId,n||1,e.mediaOrPlaylistId,i,r,t,this._eventProxy,this._config,c,!1,yW.Mobile,bW.Medium,s,o,this._auctionManagers,this._desktopCollapseOnScrollUp,this._mobileCollapseOnScrollUp);this._jwPlayers.push(a)}else{let l=this._html5Players.length+1,u=new QH(e.id.toString(),e.playerId,n||1,e.mediaOrPlaylistId,rC.EmbeddedStationary,t,r,a,c,this._eventProxy,!1,i,!1,o,this._auctionManagers,s,this._videoEventBus,l,this._shouldUseHardcodedAdPodDuration);this._html5Players.push(u)}}_createStickyRelatedPlayer(e,t){let n=this._device===`mobile`?[400,225]:[640,360],r=vW.Video_Individual_Autoplay_SOff,i=this._getCollapseType();this._collapsibleVideoLoggingStore.playerName=r,this._stickyRelatedOnPage=!0,this._config.video.mobileStickyPlayerOnPage=this._device===`mobile`,this._config.video.collapsiblePlayerOnPage=!0;let a=this._prebidEventBus,o=this._getCollapseType();if(!this._desktopRaptivePlayerEnabled&&!this._mobileRaptivePlayerEnabled){let o=new A2(e.playerId,1,e.mediaId,r,n,t,this._eventProxy,this._config,this._context,!0,i,bW.Medium,a,this._prebidMethods,this._auctionManagers,this._desktopCollapseOnScrollUp,this._mobileCollapseOnScrollUp,e.mobileLocation,e.mobileHeaderSelector);this._jwPlayers.push(o)}else{let i={classNames:[],collapseMobileSizeType:bW.Medium,collapseType:o,elementSelector:e.elementSelector,enabled:!0,mobileHeaderSelector:e.mobileHeaderSelector,mobileLocation:e.mobileLocation,pageSelector:e.pageSelector,position:e.position,saveVideoCloseState:e.saveVideoCloseState,skip:e.skip,title:e.title},s=this._html5Players.length+1,c=new e4(e.id.toString(),e.playerId,1,e.mediaId,rC.RelatedSticky,t,n,this._config,this._context,this._eventProxy,!0,r,!0,this._prebidMethods,this._auctionManagers,a,this._videoEventBus,s,i,void 0,this._shouldUseHardcodedAdPodDuration);this._html5Players.push(c)}}_createPlaylistPlayer(e,t){let n=e.playerId,r=e.playlistId,i=this._getCollapseType(),a=i===yW.Mobile?[400,225]:[640,360],o=this._config,s=this._context,c=this._device===`mobile`?vW.Video_Coll_SOff_Smartphone:vW.Video_Collapse_Autoplay_SoundOff,l=this._prebidMethods,u=this._prebidEventBus;if(!this._desktopRaptivePlayerEnabled&&!this._mobileRaptivePlayerEnabled){let o={classNames:[],enabled:!0,pageSelector:e.pageSelector,elementSelector:e.elementSelector,position:e.position,skip:e.skip},s=new $2(n,r,c,a,o,t,this._eventProxy,this._config,this._context,i,bW.Medium,u,l,this._auctionManagers,this._desktopCollapseOnScrollUp,this._mobileCollapseOnScrollUp,e.mobileLocation,e.mobileHeaderSelector,e.saveVideoCloseState,e.title,e.shuffle);this._collapsibleVideoLoggingStore.playerName=c,this._jwPlayers.push(s)}else{let d=document.querySelector(`#cls-video-container-${r} > div`);t=d||t;let f={classNames:[],collapseMobileSizeType:bW.Medium,collapseType:i,elementSelector:e.elementSelector,enabled:!0,mobileHeaderSelector:e.mobileHeaderSelector,mobileLocation:e.mobileLocation,pageSelector:e.pageSelector,position:e.position,saveVideoCloseState:e.saveVideoCloseState,skip:e.skip,title:e.title};this._config.video.mobileStickyPlayerOnPage=!0,this._config.video.collapsiblePlayerOnPage=!0;let p=this._html5Players.length+1,m=new QH(e.id.toString(),n,1,r,rC.AutoInjected,t,a,o,s,this._eventProxy,!0,c,!0,l,this._auctionManagers,u,this._videoEventBus,p,f,e.mediaId,this._shouldUseHardcodedAdPodDuration);this._collapsibleVideoLoggingStore.playerName=c,this._html5Players.push(m)}}_initJwBoost(){this._prebidMethods.setConfig({...this._jwBoostExperiment.result&&this._jwPlayers.length&&{realTimeData:{dataProviders:[{name:`jwplayer`,params:{mediaIDs:this._relatedMediaIds}}]}}},!1)}_setPlayerInstance(e){this._resetPlayer(e)}_resetPlayer(e){e.init()}async _initializePlayer(e,t){let n=this._videoRequestManager;e.setDefaults(window.jwplayer.defaults),window.jwplayer.defaults={},await this._bootstrapConfig.bootstrapLoaders[Rn.Prebid].then(()=>{this._videoUrlBuilder.shouldPrebidRun=!0}).catch(()=>{}),t&&this._relatedMediaIds[0]&&this._irisTvTracker.enabled&&(await this._irisTvTracker.setContextualData(this._relatedMediaIds[0]),this._ortb2.updateOrtb2WithIris(this._irisTvTracker)),n.addVideoSlots([e]),e.setPlayerInstance=this._setPlayerInstance.bind(this),e.requestVideoBids=async e=>await n.requestVideoBids(e),e.waitForConsent=this.gdprConsentWait.bind(this),Zh.pushToQueue(()=>{e.buildVideoUrl=this._videoUrlBuilder.buildVideoUrl.bind(this._videoUrlBuilder),e.init()})}async gdprConsentWait(){return new Promise(e=>{this._events.consentResponseCaptured.on(t=>{t&&e(!0)})})}async _initHtml5Players(){let e=this._videoRequestManager;for(let t of this._html5Players){let n=t.isPlayerType===rC.EmbeddedStationary;await this._bootstrapConfig.bootstrapLoaders[Rn.Prebid].then(()=>{this._videoUrlBuilder.shouldPrebidRun=!0}).catch(()=>{}),n&&this._relatedMediaIds[0]&&await this._irisTvTracker.setContextualData(this._relatedMediaIds[0]),e.addVideoSlots([t]),t.requestVideoBids=async t=>await e.requestVideoBids(t),t.waitForConsent=this.gdprConsentWait.bind(this),Zh.pushToQueue(()=>{t.buildVideoUrl=this._videoUrlBuilder.buildVideoUrl.bind(this._videoUrlBuilder),t.init()})}}_importScripts(){this._config.video.preventStickyOutstream!==!0&&(this._config.video.preventStickyOutstream=this._disableStickyOutstreamInPresenceOfCollapsiblePlayer()),this._jwPlayers.length&&(this._config.ccpa.userOptedOut||this._initJwBoost(),this._config.video.hasJwPlayer=!0,this._jwPlayers.forEach(e=>{let t=e.isPlayerType===rC.Related;t&&this._config.video.setupAdvanceRelatedExperiment(e.collapsible);let n=this._config.video.jwpVersion?`?version_override=${this._config.video.jwpVersion}`:``;ta(`https://content.jwplatform.com/libraries/${e._playerId}.js${n}`).then(async()=>this._initializePlayer(e,t)).catch(e=>M.error(`VideoManagerComponent`,`importScripts`,e))}))}_hasCollapsiblePlayer(e){return e.length?e.some(e=>e.collapsible):!1}_disableStickyOutstreamInPresenceOfCollapsiblePlayer(){if(!this._hasCollapsiblePlayer([...this._jwPlayers,...this._html5Players]))return!1;let e=this._stickyOutstreamOnStickyPlayerPagesSiteExperiment;if(e.enabled)return!e.result;let t=this._config.video.stickyOutstreamSettings.allowForPageWithStickyPlayer.enabled;return!t}_isVideoAllowedOnPage(){return this._config.disableAds.video?(this._config.disableAds.reasons.has(`video_tag`)?M.error(`VideoManagerComponent`,`isVideoAllowedOnPage`,Error(`DBP: Disabled by publisher via video tag`)):this._config.disableAds.reasons.has(`video_plugin`)?M.error(`VideoManagerComponent`,`isVideoAllowedOnPage`,Error(`DBP: Disabled by publisher via video plugin`)):this._config.disableAds.reasons.has(`video_page`)?M.error(`VideoManagerComponent`,`isVideoAllowedOnPage`,Error(`DBP: Disabled by publisher via command queue`)):M.error(`VideoManagerComponent`,`isVideoAllowedOnPage`,Error(`DBP: Disabled by publisher via other`)),!1):!0}_getCollapseType(){return this._device===`mobile`?yW.Mobile:yW.Float}_handleCollapsibleVideoLogging(){this._spaListeners.push(GI.collapseEvent.on(()=>{this._collapsibleVideoLoggingStore.startedCollapsedTime=AK()}),LZ.collapseEvent.on(()=>{this._collapsibleVideoLoggingStore.startedCollapsedTime=AK()})),this._spaListeners.push(GI.uncollapseEvent.on(()=>{this._collapsibleVideoLoggingStore.totalTimeCollapsed+=this._collapsibleVideoLoggingStore.startedCollapsedTime?AK()-this._collapsibleVideoLoggingStore.startedCollapsedTime:0,this._collapsibleVideoLoggingStore.startedCollapsedTime=void 0}),LZ.uncollapseEvent.on(()=>{this._collapsibleVideoLoggingStore.totalTimeCollapsed+=this._collapsibleVideoLoggingStore.startedCollapsedTime?AK()-this._collapsibleVideoLoggingStore.startedCollapsedTime:0,this._collapsibleVideoLoggingStore.startedCollapsedTime=void 0})),this._spaListeners.push(GI.closeEvent.on(()=>{this._collapsibleVideoLoggingStore.wasClosed=!0}),LZ.closeEvent.on(()=>{this._collapsibleVideoLoggingStore.wasClosed=!0})),GI.startEvent.once(()=>{this._collapsibleVideoLoggingStore.wasStarted=!0}),LZ.startEvent.once(()=>{this._collapsibleVideoLoggingStore.wasStarted=!0}),this._spaListeners.push(this._userPageDataLoggingEvent.loggingData.on(()=>{this._collapsibleVideoLoggingStore.startedCollapsedTime&&(this._collapsibleVideoLoggingStore.totalTimeCollapsed+=AK()-this._collapsibleVideoLoggingStore.startedCollapsedTime)}))}},E4=D([Q(`VideoManagerComponent`),S(),A(`design:paramtypes`,[typeof(i4=kI!==void 0&&kI)==`function`?i4:Object,typeof(a4=Ki!==void 0&&Ki)==`function`?a4:Object,typeof(o4=Z1!==void 0&&Z1)==`function`?o4:Object,typeof(s4=z!==void 0&&z)==`function`?s4:Object,typeof(c4=L!==void 0&&L)==`function`?c4:Object,typeof(l4=VS!==void 0&&VS)==`function`?l4:Object,typeof(u4=oo!==void 0&&oo)==`function`?u4:Object,typeof(d4=_g!==void 0&&_g)==`function`?d4:Object,typeof(f4=SU!==void 0&&SU)==`function`?f4:Object,typeof(p4=BC!==void 0&&BC)==`function`?p4:Object,typeof(m4=$C!==void 0&&$C)==`function`?m4:Object,typeof(h4=Pr!==void 0&&Pr)==`function`?h4:Object,typeof(g4=R!==void 0&&R)==`function`?g4:Object,typeof(_4=zr!==void 0&&zr)==`function`?_4:Object,typeof(v4=eU!==void 0&&eU)==`function`?v4:Object,typeof(y4=WU!==void 0&&WU)==`function`?y4:Object,typeof(b4=KU!==void 0&&KU)==`function`?b4:Object,typeof(x4=_f!==void 0&&_f)==`function`?x4:Object,typeof(S4=mW!==void 0&&mW)==`function`?S4:Object,typeof(C4=pW!==void 0&&pW)==`function`?C4:Object,typeof(w4=ug!==void 0&&ug)==`function`?w4:Object,typeof(T4=z2!==void 0&&z2)==`function`?T4:Object])],E4)})),Uge=o((()=>{Hge()})),D4,O4,k4,A4,j4,M4,N4,P4,F4,I4,L4,R4,z4,B4,V4,H4,U4,W4,G4,K4,q4,J4,Y4,X4,Z4,Q4,$4,e3,t3,n3,r3,i3,a3,o3,s3,c3,l3,u3,d3,f3,p3,m3,h3,g3,_3,v3,y3,b3,x3,S3,C3,w3,T3,E3,D3,O3,k3,Wge=o((()=>{M4=-1,N4=function(e){addEventListener(`pageshow`,(function(t){t.persisted&&(M4=t.timeStamp,e(t))}),!0)},P4=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType(`navigation`)[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},F4=function(){var e=P4();return e&&e.activationStart||0},I4=function(e,t){var n=P4(),r=`navigate`;return M4>=0?r=`back-forward-cache`:n&&(document.prerendering||F4()>0?r=`prerender`:document.wasDiscarded?r=`restore`:n.type&&(r=n.type.replace(/_/g,`-`))),{name:e,value:t===void 0?-1:t,rating:`good`,delta:0,entries:[],id:`v4-${Date.now()}-${Math.floor(8999999999999*Math.random())+0xe8d4a51000}`,navigationType:r}},L4=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(e){}},R4=function(e,t,n,r){var i,a;return function(o){t.value>=0&&(o||r)&&((a=t.value-(i||0))||i===void 0)&&(i=t.value,t.delta=a,t.rating=function(e,t){return e>t[1]?`poor`:e>t[0]?`needs-improvement`:`good`}(t.value,n),e(t))}},z4=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},B4=function(e){document.addEventListener(`visibilitychange`,(function(){document.visibilityState===`hidden`&&e()}))},V4=function(e){var t=!1;return function(){t||(e(),t=!0)}},H4=-1,U4=function(){return document.visibilityState!==`hidden`||document.prerendering?1/0:0},W4=function(e){document.visibilityState===`hidden`&&H4>-1&&(H4=e.type===`visibilitychange`?e.timeStamp:0,K4())},G4=function(){addEventListener(`visibilitychange`,W4,!0),addEventListener(`prerenderingchange`,W4,!0)},K4=function(){removeEventListener(`visibilitychange`,W4,!0),removeEventListener(`prerenderingchange`,W4,!0)},q4=function(){return H4<0&&(H4=U4(),G4(),N4((function(){setTimeout((function(){H4=U4(),G4()}),0)}))),{get firstHiddenTime(){return H4}}},J4=function(e){document.prerendering?addEventListener(`prerenderingchange`,(function(){return e()}),!0):e()},Y4=[1800,3e3],X4=function(e,t){t=t||{},J4((function(){var n,r=q4(),i=I4(`FCP`),a=L4(`paint`,(function(e){e.forEach((function(e){e.name===`first-contentful-paint`&&(a.disconnect(),e.startTime<r.firstHiddenTime&&(i.value=Math.max(e.startTime-F4(),0),i.entries.push(e),n(!0)))}))}));a&&(n=R4(e,i,Y4,t.reportAllChanges),N4((function(r){i=I4(`FCP`),n=R4(e,i,Y4,t.reportAllChanges),z4((function(){i.value=performance.now()-r.timeStamp,n(!0)}))})))}))},Z4=function(e){var t=e.nodeName;return e.nodeType===1?t.toLowerCase():t.toUpperCase().replace(/^#/,``)},Q4=function(e,t){var n=``;try{for(;e&&e.nodeType!==9;){var r=e,i=r.id?`#`+r.id:Z4(r)+(r.classList&&r.classList.value&&r.classList.value.trim()&&r.classList.value.trim().length?`.`+r.classList.value.trim().replace(/\s+/g,`.`):``);if(n.length+i.length>(t||100)-1)return n||i;if(n=n?i+`>`+n:i,r.id)break;e=r.parentNode}}catch(e){}return n},$4=[.1,.25],e3=function(e,t,n){t=t||{},X4(V4((function(){var r,i=I4(`CLS`,0),a=0,o=[],s=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=o[0],r=o[o.length-1];a&&e.startTime-r.startTime<1e3&&e.startTime-t.startTime<5e3?(a+=e.value,o.push(e)):(a=e.value,o=[e])}if(n&&typeof n==`function`){var i=e.sources.map((function(e){var t=e.node,n=e.previousRect,r=e.currentRect;return{target:Q4(t),previousRect:n,currentRect:r}}));n(Object.assign(e.toJSON(),{sources:i}))}})),a>i.value&&(i.value=a,i.entries=o,r())},c=L4(`layout-shift`,s);c&&(r=R4(e,i,$4,t.reportAllChanges),B4((function(){s(c.takeRecords()),r(!0)})),N4((function(){a=0,i=I4(`CLS`,0),r=R4(e,i,$4,t.reportAllChanges),z4((function(){return r()}))})),setTimeout(r,0))})))},t3=0,n3=1/0,r3=0,i3=function(e){e.forEach((function(e){e.interactionId&&(n3=Math.min(n3,e.interactionId),r3=Math.max(r3,e.interactionId),t3=r3?(r3-n3)/7+1:0)}))},a3=function(){return D4?t3:performance.interactionCount||0},o3=function(){`interactionCount`in performance||D4||(D4=L4(`event`,i3,{type:`event`,buffered:!0,durationThreshold:0}))},s3=[],c3=new Map,l3=0,u3=function(){var e=Math.min(s3.length-1,Math.floor((a3()-l3)/50));return s3[e]},d3=[],f3=function(e){if(d3.forEach((function(t){return t(e)})),e.interactionId||e.entryType===`first-input`){var t=s3[s3.length-1],n=c3.get(e.interactionId);if(n||s3.length<10||e.duration>t.latency){if(n)e.duration>n.latency?(n.entries=[e],n.latency=e.duration):e.duration===n.latency&&e.startTime===n.entries[0].startTime&&n.entries.push(e);else{var r={id:e.interactionId,latency:e.duration,entries:[e]};c3.set(r.id,r),s3.push(r)}s3.sort((function(e,t){return t.latency-e.latency})),s3.length>10&&s3.splice(10).forEach((function(e){return c3.delete(e.id)}))}}},p3=function(e){var t=self.requestIdleCallback||self.setTimeout,n=-1;return e=V4(e),document.visibilityState===`hidden`?e():(n=t(e),B4(e)),n},m3=[200,500],h3=function(e,t){`PerformanceEventTiming`in self&&`interactionId`in PerformanceEventTiming.prototype&&(t=t||{},J4((function(){var n;o3();var r,i=I4(`INP`),a=function(e){p3((function(){e.forEach(f3);var t=u3();t&&t.latency!==i.value&&(i.value=t.latency,i.entries=t.entries,r())}))},o=L4(`event`,a,{durationThreshold:(n=t.durationThreshold)==null?40:n});r=R4(e,i,m3,t.reportAllChanges),o&&(o.observe({type:`first-input`,buffered:!0}),B4((function(){a(o.takeRecords()),r(!0)})),N4((function(){l3=a3(),s3.length=0,c3.clear(),i=I4(`INP`),r=R4(e,i,m3,t.reportAllChanges)})))})))},g3=[2500,4e3],_3={},v3=function(e,t,n){t=t||{},J4((function(){var r,i=q4(),a=I4(`LCP`),o=function(e){t.reportAllChanges||(e=e.slice(-1)),e.forEach((function(e){e.startTime<i.firstHiddenTime&&(a.value=Math.max(e.startTime-F4(),0),n&&n(e,a.value,Q4(e.element)),a.entries=[e],r())}))},s=L4(`largest-contentful-paint`,o);if(s){r=R4(e,a,g3,t.reportAllChanges);var c=V4((function(){_3[a.id]||(o(s.takeRecords()),s.disconnect(),_3[a.id]=!0,r(!0))}));[`keydown`,`click`].forEach((function(e){addEventListener(e,(function(){return p3(c)}),{once:!0,capture:!0})})),B4(c),N4((function(n){a=I4(`LCP`),r=R4(e,a,g3,t.reportAllChanges),z4((function(){a.value=performance.now()-n.timeStamp,_3[a.id]=!0,r(!0)}))}))}}))},y3=[800,1800],b3=function e(t){document.prerendering?J4((function(){return e(t)})):document.readyState===`complete`?setTimeout(t,0):addEventListener(`load`,(function(){return e(t)}),!0)},x3=function(e,t){t=t||{};var n=I4(`TTFB`),r=R4(e,n,y3,t.reportAllChanges);b3((function(){var i=P4();i&&(n.value=Math.max(i.responseStart-F4(),0),n.entries=[i],r(!0),N4((function(){n=I4(`TTFB`,0),(r=R4(e,n,y3,t.reportAllChanges))(!0)})))}))},S3={passive:!0,capture:!0},C3=new Date,w3=function(e,t){O4||(O4=t,k4=e,A4=new Date,D3(removeEventListener),T3())},T3=function(){if(k4>=0&&k4<A4-C3){var e={entryType:`first-input`,name:O4.type,target:O4.target,cancelable:O4.cancelable,startTime:O4.timeStamp,processingStart:O4.timeStamp+k4};j4.forEach((function(t){t(e)})),j4=[]}},E3=function(e){if(e.cancelable){var t=(e.timeStamp>0xe8d4a51000?new Date:performance.now())-e.timeStamp;e.type==`pointerdown`?function(e,t){var n=function(){w3(e,t),i()},r=function(){i()},i=function(){removeEventListener(`pointerup`,n,S3),removeEventListener(`pointercancel`,r,S3)};addEventListener(`pointerup`,n,S3),addEventListener(`pointercancel`,r,S3)}(t,e):w3(t,e)}},D3=function(e){[`mousedown`,`keydown`,`touchstart`,`pointerdown`].forEach((function(t){return e(t,E3,S3)}))},O3=[100,300],k3=function(e,t){t=t||{},J4((function(){var n,r=q4(),i=I4(`FID`),a=function(e){e.startTime<r.firstHiddenTime&&(i.value=e.processingStart-e.startTime,i.entries.push(e),n(!0))},o=function(e){e.forEach(a)},s=L4(`first-input`,o);n=R4(e,i,O3,t.reportAllChanges),s&&(B4(V4((function(){o(s.takeRecords()),s.disconnect()}))),N4((function(){var r;i=I4(`FID`),n=R4(e,i,O3,t.reportAllChanges),j4=[],k4=-1,O4=null,D3(addEventListener),r=a,j4.push(r),T3()})))}))}})),A3,Gge=o((()=>{fU(),$(),w(),j(),E(),O(),A3=class{constructor(){T(this,`_enabled`,void 0),this._enabled=new ar(.02).get()}handleEvent(e,t,n){M.event(`CustomLCPReporter`,`handleEvent`,{...e.toJSON(),lcpValue:t,elementSelector:n})}get enabled(){return this._enabled}},A3=D([Q(`CustomLCPReporter`),C(),A(`design:paramtypes`,[])],A3)})),j3,Kge=o((()=>{fU(),$(),w(),j(),E(),O(),j3=class{constructor(){T(this,`_enabled`,void 0),this._enabled=new ar(.01).get()}handleEvent(e){M.event(`CustomCLSReporter`,`handleEvent`,e)}get enabled(){return this._enabled}},j3=D([Q(`CustomCLSReporter`),C(),A(`design:paramtypes`,[])],j3)})),M3,N3,P3,F3,I3,qge=o((()=>{rd(),$(),Z(),w(),H(),Wge(),$h(),Gge(),Kge(),j(),E(),O(),I3=class extends V{constructor(e,t,n,r){super(),this._bootstrapConfig=e,this._googleAdManager=t,this._customCLSReporter=n,this._customLCPReporter=r,T(this,`_maxTimeOnPage`,36e5),T(this,`_webVitals`,[]),T(this,`_webVitalsSent`,!1),T(this,`_visibilityChangeOff`,void 0)}init(){wn().then(()=>{let e=this.addWebVital.bind(this);k3(e),e3(e,{reportAllChanges:!0,durationThreshold:0},this._customCLSReporter.enabled?this._customCLSReporter.handleEvent:void 0),v3(e,{reportAllChanges:!0},this._customLCPReporter.enabled?this._customLCPReporter.handleEvent:void 0),X4(e),h3(e,{reportAllChanges:!0}),x3(e),document.addEventListener(`visibilitychange`,()=>this.logWebVitals(),{once:!0})}).catch(()=>!1),setTimeout(()=>{this.logWebVitals()},this._maxTimeOnPage)}addWebVital({name:e,delta:t,value:n,id:r}){this._webVitals.push({name:e,delta:t,value:n,id:r})}_getFlagTargeting(){try{return this._googleAdManager.getTargetingValuesForKey(`flag`)}catch(e){return[]}}logWebVitals(){var e;if(this._webVitalsSent)return;let t=this._getFlagTargeting(),n={webVitals:this._webVitals,DOMSize:document.querySelectorAll(`*`).length,gptLoad:!0,gptv:googletag&&googletag.getVersion&&googletag.getVersion(),flagTargeting:t};this._webVitalsSent=!0,(e=this._visibilityChangeOff)==null||e.call(this),this._bootstrapConfig.gptLibFailedToLoad&&(n.gptLoad=!1),M.fetchEvent(`WebVitalsComponent`,`logWebVital`,n)}get enabled(){return this._bootstrapConfig.webVitalsEnabled}},I3=D([Q(`WebVitalsComponent`),S(),A(`design:paramtypes`,[typeof(M3=Ki!==void 0&&Ki)==`function`?M3:Object,typeof(N3=Zh!==void 0&&Zh)==`function`?N3:Object,typeof(P3=j3!==void 0&&j3)==`function`?P3:Object,typeof(F3=A3!==void 0&&A3)==`function`?F3:Object])],I3)})),L3=o((()=>{qge()})),R3,z3,Jge=o((()=>{B(),$(),w(),H(),j(),O(),z3=class extends V{constructor(e){super(),this._config=e}init(){this.enabled&&(this._config.ccpa.userOptedOut?this._setCCPAListener():(window.dataLayer=window.dataLayer||[],this._grantGTMConsent()))}get enabled(){let e=!!window.dataLayer&&typeof window.gtag==`function`;return e&&this._config.adOptions.consentMode.enabled&&!this._config.gdpr.enabled}_grantGTMConsent(){let e=0,t=setInterval(()=>{typeof window.gtag==`function`?(clearInterval(t),gtag(`consent`,`update`,{analytics_storage:`granted`,ad_storage:`granted`,third_party_storage:`granted`,ad_user_data:`granted`,ad_personalization:`granted`}),window.dataLayer.push({event:`consent-update`,google_consent_mode:!0,consent_analytics:!0,consent_advertising:!0,consent_third_party:!0,consent_ad_user_data:!0,consent_ad_personalization:!0,wait_for_update:0}),window.dataLayer.push({event:`cmpEvent`,cmpConsentVendors:this._config.adOptions.consentMode.customVendorList})):++e>=10&&(M.event(`GoogleConsentModeComponent`,`_grantGTMConsent`,`Failed to find gtag function after 10 attempts`),clearInterval(t))},100)}_setCCPAListener(){this._config.ccpa.consentChange.on(e=>{e===this._config.ccpa.ccpaOptIn&&this._grantGTMConsent()})}},z3=D([Q(`GoogleConsentModeComponent`),C(),A(`design:paramtypes`,[typeof(R3=z!==void 0&&z)==`function`?R3:Object])],z3)})),B3,V3=o((()=>{w(),$(),bt(),E(),O(),B3=class{constructor(){T(this,`contentAdded`,new k)}},B3=D([Q(`InfiniteScrollEvents`),C()],B3)})),H3,U3,W3,Yge=o((()=>{w(),B(),$(),H(),V3(),j(),E(),O(),W3=class extends V{constructor(e,t){super(),this._config=e,this._events=t,T(this,`_ajaxSelector`,`#ajax-load-more`),T(this,`_heightThreshold`,1e3),T(this,`_infiniteScrollElement`,null)}start(){this.detectInfiniteScroll()}detectInfiniteScroll(){let e=(e,t)=>{e.filter(({type:e,addedNodes:t})=>e===`childList`&&t.length>0).reduce((e,{addedNodes:t})=>[...e,...Array.prototype.slice.call(t)],[]).filter(e=>e instanceof HTMLElement&&e.clientHeight>this._heightThreshold).forEach(e=>{e.parentElement&&(t.disconnect(),t.observe(e.parentElement,{childList:!0}),this._infiniteScrollElement&&t.observe(this._infiniteScrollElement,{childList:!0,subtree:!0}));try{this._events.contentAdded.emit(e)}catch(e){M.error(`InfiniteScrollDetectionComponent`,`addMutationObserver`,`added`,e)}})};this.checkForCustomConfig();let t=new MutationObserver(e);this._infiniteScrollElement?t.observe(this._infiniteScrollElement,{childList:!0,subtree:!0}):Array.prototype.slice.call(document.querySelectorAll(`body *`)).filter(e=>e instanceof HTMLElement&&e.offsetHeight>this._heightThreshold).forEach(e=>{t.observe(e,{childList:!0})})}checkForCustomConfig(){let{heightThreshold:e,selector:t}=this._config.adOptions.infiniteScrollOptions,n=t?document.querySelector(t):null;if(n)this._infiniteScrollElement=n;else{let e=document.querySelector(this._ajaxSelector);e&&(this._config.infiniteScroll.ajaxType=!0,this._infiniteScrollElement=e)}e&&e>0&&(this._heightThreshold=e)}get enabled(){return this._config.adOptions.infiniteScroll&&`MutationObserver`in window}},W3=D([Q(`InfiniteScrollDetectionComponent`),S(),A(`design:paramtypes`,[typeof(H3=z!==void 0&&z)==`function`?H3:Object,typeof(U3=B3!==void 0&&B3)==`function`?U3:Object])],W3)})),G3,K3,q3,J3,Y3,Xge=o((()=>{w(),B(),Ra(),iJ(),$(),Bq(),ud(),j(),E(),O(),Y3=class extends rJ{constructor(e,t,n,r){super(t,n,r),this._config=e,this._adInjectionMap=t,this._context=n,this._cls=r,T(this,`_count`,1)}getDynamicElementId(){return`${this._config.gam.prefix}_Infinite_${this._count++}`}},Y3=D([Q(`InfiniteScrollDynamicAdsInjector`),S(),A(`design:paramtypes`,[typeof(G3=z!==void 0&&z)==`function`?G3:Object,typeof(K3=zq!==void 0&&zq)==`function`?K3:Object,typeof(q3=L!==void 0&&L)==`function`?q3:Object,typeof(J3=ld!==void 0&&ld)==`function`?J3:Object])],Y3)})),X3,Z3,Q3,$3,e6,t6,n6,Zge=o((()=>{w(),$h(),B(),Ra(),X(),$(),FS(),H(),Xge(),V3(),MW(),j(),E(),O(),n6=class extends V{constructor(e,t,n,r,i,a){super(),this._config=e,this._context=t,this._events=n,this._injector=r,this._slotManager=i,this._gam=a,T(this,`_page`,1)}init(){this._events.contentAdded.on(e=>{this._page++,this._context.pageviewKey=KK(),this._gam.setTargeting({key:`pvk`,value:this._context.pageviewKey}),this.slotsAlreadyInjectedInElement(e)||this.addSlots(e)})}slotsAlreadyInjectedInElement(e){let t=e.querySelector(`[id*='AdThrive_Content']`);return!!t}addSlots(e){let t=this._config.dynamicAds.filter(e=>!(this._config.infiniteScroll.ajaxType&&e.location===F.Sidebar)).filter(e=>kW(this._config,e)).filter(e=>OW(e,this._context.device)).filter(e=>jW(e)),n=this._injector.inject(t,e);n.length!==0&&this._slotManager.add(n).then(e=>{e.forEach(e=>{Zh.pushToQueue(()=>{e.setTargeting({key:`inf_scroll`,value:this._page.toString()})})})}).catch(e=>{M.error(`InfiniteScrollDynamicAdsComponent`,`addSlots`,e)})}get enabled(){return this._config.adOptions.infiniteScroll}},n6=D([Q(`InfiniteScrollDynamicAdsComponent`),S(),A(`design:paramtypes`,[typeof(X3=z!==void 0&&z)==`function`?X3:Object,typeof(Z3=L!==void 0&&L)==`function`?Z3:Object,typeof(Q3=B3!==void 0&&B3)==`function`?Q3:Object,typeof($3=Y3!==void 0&&Y3)==`function`?$3:Object,typeof(e6=PS!==void 0&&PS)==`function`?e6:Object,typeof(t6=Zh!==void 0&&Zh)==`function`?t6:Object])],n6)})),r6,i6,a6,o6,s6,Qge=o((()=>{w(),B(),$(),FS(),vh(),H(),V3(),j(),E(),O(),s6=class extends V{constructor(e,t,n,r){super(),this._config=e,this._events=t,this._slotManager=n,this._slots=r,T(this,`_observer`,void 0),T(this,`_debounce`,new zt(1e3))}start(){this._observer=this.getIntersectionObserver(),this._events.contentAdded.on(e=>{this._observer&&this._observer.observe(e)})}getIntersectionObserver(){return new IntersectionObserver(e=>{for(let t of e)t.intersectionRatio>0&&t.isIntersecting&&this._debounce.limit(t.target.id).then(()=>this.refresh()).catch(e=>{M.error(`InfiniteScrollRefreshComponent`,`getIntersectionObserver`,`refresh`,e)})},{threshold:[.08]})}refresh(){if(this._config.adOptions.infiniteScrollRefresh){let e=this._slots.get().filter(e=>this._config.infiniteScroll.refreshSlots.has(e.location)&&e.isSticky&&!e.isRefreshing);e.forEach(e=>{this._slotManager.updateRefreshTimeout(e,1001)})}}get enabled(){return this._config.adOptions.infiniteScroll&&`IntersectionObserver`in window}},s6=D([Q(`InfiniteScrollRefreshComponent`),S(),A(`design:paramtypes`,[typeof(r6=z!==void 0&&z)==`function`?r6:Object,typeof(i6=B3!==void 0&&B3)==`function`?i6:Object,typeof(a6=PS!==void 0&&PS)==`function`?a6:Object,typeof(o6=_h!==void 0&&_h)==`function`?o6:Object])],s6)})),$ge=o((()=>{Yge(),Zge(),Qge()})),c6,l6,u6,e_e=o((()=>{w(),$(),vh(),H(),X(),Bh(),j(),O(),u6=class extends V{constructor(e,t){super(),this.gamEventBus=e,this._slots=t}init(){this.gamEventBus.slotResponseReceived.on(({slotId:e})=>{let t=this._slots.get(e);t&&this.slotResponseReceived(t)})}slotResponseReceived(e){e.alwaysInView=e.location===F.Footer||e.location===F.Video_StickyOutstream}},u6=D([Q(`AlwaysInViewComponent`),S(),A(`design:paramtypes`,[typeof(c6=zh!==void 0&&zh)==`function`?c6:Object,typeof(l6=_h!==void 0&&_h)==`function`?l6:Object])],u6)})),d6,f6,t_e=o((()=>{$(),FS(),w(),H(),j(),O(),f6=class extends V{constructor(e){super(),this._slotManager=e;let t=e=>{let t=e&&e.data&&e.data.message===`set_adthrive_slot_timeout`&&e.data.slot_id&&e.data.refresh_interval>=0;t&&this._slotManager.updateRefreshTimeout(e.data.slot_id,e.data.refresh_interval)};window.addEventListener(`message`,t,!1)}},f6=D([Q(`ChangeSlotRefreshComponent`),S(),A(`design:paramtypes`,[typeof(d6=PS!==void 0&&PS)==`function`?d6:Object])],f6)})),p6,m6,h6,g6,n_e=o((()=>{Na(),$(),FS(),vh(),w(),H(),j(),O(),g6=class extends V{constructor(e,t,n){super(),this._slotManager=e,this._slots=t,this._pageManager=n}init(){this._pageManager.visibilityChange.on(()=>this.documentVisibilityChanged())}documentVisibilityChanged(){let e=document.visibilityState,t=this._slots.get();e===`visible`?this._slotManager.resumeRefresh(t):e===`hidden`&&this._slotManager.pauseRefresh(t)}},g6=D([Q(`DocumentHiddenPauseRefreshComponent`),S(),A(`design:paramtypes`,[typeof(p6=PS!==void 0&&PS)==`function`?p6:Object,typeof(m6=_h!==void 0&&_h)==`function`?m6:Object,typeof(h6=ja!==void 0&&ja)==`function`?h6:Object])],g6)})),_6,v6,y6,r_e=o((()=>{w(),$(),FS(),H(),Zn(),Bh(),j(),E(),O(),y6=class extends V{constructor(e,t){super(),this._slotManager=e,this._googleAgManagerEventBus=t,T(this,`_inViewPercentage`,50)}init(){this._googleAgManagerEventBus.impressionViewable.on(({slotId:e})=>{this.processImpressionViewable(e)}),this._googleAgManagerEventBus.slotVisibilityChanged.on(({slotId:e,event:t})=>{this.processVisibilityChanged(e,t)})}processImpressionViewable(e){let t=this._slotManager.getSlot(e);t&&(t.outOfViewGPT=!1,this._slotManager.inView(t))}processVisibilityChanged(e,t){let n=this._slotManager.getSlot(e);n&&this.check(n,t.inViewPercentage)}check(e,t){t&&t>=this._inViewPercentage||e.location===F.Video_StickyOutstream?(e.outOfViewGPT=!1,this._slotManager.inView(e)):(e.outOfViewGPT=!0,this._slotManager.outOfView(e))}},y6=D([Q(`ImpressionViewableRefreshComponent`),S(),A(`design:paramtypes`,[typeof(_6=PS!==void 0&&PS)==`function`?_6:Object,typeof(v6=zh!==void 0&&zh)==`function`?v6:Object])],y6)})),b6,x6,S6,C6,w6,T6,i_e=o((()=>{w(),$(),FS(),vh(),H(),Zn(),Bh(),Wr(),rU(),j(),E(),O(),T6=class extends V{constructor(e,t,n,r,i){super(),this._slotManager=e,this._slots=t,this._gamEventBus=n,this._slotEventBus=r,this._slotManagerEventBus=i,T(this,`_inViewPercentage`,50),T(this,`_observer`,void 0),T(this,`_trackSlotEvents`,new Map)}init(){this._observer=this._getIntersectionObserver(),this._slotEventBus.googleAdManagerFallbackDivAdded.on(e=>{this.slotResponseReceived(e)}),this._gamEventBus.slotResponseReceived.on(({slotId:e})=>{this.slotResponseReceived(e),this._trackSlotEvents.set(e,`slotResponseReceived`)}),this._gamEventBus.slotRenderEnded.on(({slotId:e})=>{this.slotResponseReceived(e),this._trackSlotEvents.delete(e)}),this._gamEventBus.slotRequested.on(({slotId:e})=>{this._trackSlotEvents.set(e,`slotRequested`)}),this._slotManagerEventBus.refreshing.on(e=>{let t=this._slotManager.getSlots(e);for(let e of t)this._trackSlotEvents.get(e.id)&&(this._slotManager.rebuild(e),this._trackSlotEvents.delete(e.id));this.refreshing(t)})}get enabled(){return`IntersectionObserver`in window}slotResponseReceived(e){let t=this._slots.get(e);t&&this._observer&&t.element&&this._observer.observe(t.element)}_googleAdManagerFallbackDivAdded(e){this._observer&&e&&this._observer.observe(e)}refreshing(e){if(this._observer)for(let t of e){t.element&&this._observer.unobserve(t.element);let e=Array.from(t.element.children);e.forEach(e=>{e.classList.contains(`google-ad-manager-fallback-container`)&&this._observer.unobserve(e)})}}_getIntersectionObserver(){return new IntersectionObserver(e=>{for(let t of e){let e=t.target.id.length?this._slots.get(t.target.id):null;if(e)this._check(e,t.intersectionRatio*100);else{let e=t.target.parentElement&&t.target.parentElement.classList.contains(`adthrive-ad`)&&this._slots.get(t.target.parentElement.id);e&&this._check(e,t.intersectionRatio*100)}}},{threshold:[0,this._inViewPercentage/100]})}_check(e,t){t>=this._inViewPercentage||e.location===F.Video_StickyOutstream?(e.outOfViewIO=!1,this._slotManager.inView(e)):(e.outOfViewIO=!0,this._slotManager.outOfView(e))}},T6=D([Q(`IntersectionObserverRefreshComponent`),S(),A(`design:paramtypes`,[typeof(b6=PS!==void 0&&PS)==`function`?b6:Object,typeof(x6=_h!==void 0&&_h)==`function`?x6:Object,typeof(S6=zh!==void 0&&zh)==`function`?S6:Object,typeof(C6=Vr!==void 0&&Vr)==`function`?C6:Object,typeof(w6=Ur!==void 0&&Ur)==`function`?w6:Object])],T6)})),E6,D6,O6,k6,A6,a_e=o((()=>{H(),B(),Ra(),$(),$G(),w(),rU(),rW(),j(),E(),O(),A6=class extends V{constructor(e,t,n,r){super(),this._config=e,this._context=t,this._eventBus=n,this._stickyOutstreamFooterCollisionExperiment=r,T(this,`_lastAdHeight`,void 0),T(this,`_maxRetries`,void 0),this._lastAdHeight=52,this._maxRetries=12}init(){this._eventBus.footerResponseReceived.on(this.pollForFooterAdHeight.bind(this))}get enabled(){let e=this._stickyOutstreamFooterCollisionExperiment.result,t=this._context.device===`phone`,{stickyOutstreamSettings:n,players:r}=this._config.video,i=n.mobile.enabled&&n.mobileLocation!==`top-center`,a=(r==null?void 0:r.some(e=>e.mobileLocation.includes(`bottom`)))||!1,o=i||a;return e&&t&&o}pollForFooterAdHeight(){let e=0,t=setInterval(()=>{this.checkForFooterAdHeightChange(),e++,e>=this._maxRetries&&clearInterval(t)},500)}checkForFooterAdHeightChange(){let e=this.getFooterAdHeight();e!==this._lastAdHeight&&(this._eventBus.footerHeightChanged.emit(e),this._lastAdHeight=e)}isElementAtBottomOfPage(e){let t=e.getBoundingClientRect();if(t.width&&t.height){let e=t.bottom||(t.top||t.y)+t.height;if(Math.abs(window.innerHeight-e)<100)return!0}return!1}getFooterAdHeight(){let e=52;return this._config.footer.footerSelectorsForHeightCheck.forEach(t=>{let n=document.querySelector(t.trim());if(n&&QG(n)&&this.isElementAtBottomOfPage(n)){let t=n.getBoundingClientRect().height;t>e&&(e=t)}}),e}},A6=D([Q(`FooterAdRefreshComponent`),C(),A(`design:paramtypes`,[typeof(E6=z!==void 0&&z)==`function`?E6:Object,typeof(D6=L!==void 0&&L)==`function`?D6:Object,typeof(O6=xr!==void 0&&xr)==`function`?O6:Object,typeof(k6=nW!==void 0&&nW)==`function`?k6:Object])],A6)})),o_e=o((()=>{e_e(),t_e(),n_e(),r_e(),i_e(),a_e()})),j6,s_e=o((()=>{w(),mU(),O(),j6=class extends pU{init(){this._key=`ConfiantProperty`,this._lookup=`CNFTP`}run(){return super.run()}},j6=D([C()],j6)})),M6,N6,P6,F6,I6,L6,c_e=o((()=>{w(),B(),$(),Z(),H(),s_e(),Lu(),al(),zF(),j(),E(),O(),I6=new Map([[1,{type:`manual`,description:`Deprecated`}],[2,{type:`creative`,description:`Creative-based detection`}],[3,{type:`provider_security`,description:`Domain-based detection for unsafe domains`}],[4,{type:`banned_domain`,description:`Domain-based detection for bannded domains`}],[5,{type:`provider_ibv`,description:`Domain-based detection for in-banner-video`}],[6,{type:`unsafejs`,description:`JavaScript-based detection for unsafe ads`}],[7,{type:`hrap`,description:`Domain-based detection for high risk ad platform domains`}],[10,{type:`adv_brand_safety`,description:`Ads that act as placeholders when a brand safety blocklist prohibits the original ad from displaying.`}]]),L6=class extends V{constructor(e,t,n,r){super(),this._config=e,this._confiantPropertyExperiment=t,this._creativeBlockingExperiment=n,this._creativeBlockEventBus=r,T(this,`_name`,`conf`)}init(){var e;let t=(e=this._confiantPropertyExperiment.result)==null?`mOinGM9MTu5v-Lto835XLhlrSPY`:e,n=`https://cdn.confiant-integrations.net/${t}/gpt_and_prebid/config.js`;return window.confiant=window.confiant||{},window.confiant.callback=(e,t,n,r,i,a)=>{let o=I6.get(e),s=typeof a==`object`?a==null?void 0:a.tp_crid:void 0;M.event(`ConfiantTrackerComponent`,`adBlocked`,{blockingTypeIntegerValue:e,blockingType:o?o.type:`unknown`,description:o?o.description:`unknown`,tagId:i,wrapperId:r,blockingId:t,isBlocked:n,...s&&{tpCrid:s}}),(o==null?void 0:o.type)!==`adv_brand_safety`&&s&&this._extractCridForBlocking(s)},ta(n)}get enabled(){let e=this._config,t=!e.gpc.gpcEnabled&&!e.ccpa.userOptedOut,n=!e.tkho.tracker.includes(this._name),r=!0,i=il.isRolloutEnabled(`confiant-blocking-enabled`),a=il.isRolloutEnabled(`confiant-blocking-disabled`),o=this._creativeBlockingExperiment.result==`ct`||this._creativeBlockingExperiment.result==`both`;return r=a?!1:i?!0:o,n&&t&&r}_extractCridForBlocking(e){if(e.startsWith(`PB:`)||e.startsWith(`IM:`)){let t=e.split(`;`),n=t[t.length-1];this._creativeBlockEventBus.blockCreativeIds.emit({source:`confiant`,crids:new Set([n])})}}},L6=D([Q(`ConfiantTrackerComponent`),S(),A(`design:paramtypes`,[typeof(M6=z!==void 0&&z)==`function`?M6:Object,typeof(N6=j6!==void 0&&j6)==`function`?N6:Object,typeof(P6=Iu!==void 0&&Iu)==`function`?P6:Object,typeof(F6=RF!==void 0&&RF)==`function`?F6:Object])],L6)})),R6,z6,l_e=o((()=>{w(),B(),$(),Z(),H(),Rm(),j(),E(),O(),z6=class extends V{constructor(e){super(),this._config=e,T(this,`_name`,`cmscr`),T(this,`_comscoreId`,`6035453`),T(this,`_gdprEnabled`,!1),T(this,`_isValidTraffic`,!1),this._gdprEnabled=this._config.gdpr.enabled,this._isValidTraffic=!window.adthrive.invalidTraffic}init(){let e=this._config.ccpa.comscoreParams||`0`,t={c1:`2`,c2:this._comscoreId,cs_fpid:U.readExternalCookie(`_pubcid`)||U.readExternalLocalStorage(`_pubcid`),cs_fpit:`o`,cs_fpdm:`*null`,cs_fpdt:`*null`,options:{enableFirstPartyCookie:!0},...this._gdprEnabled&&{cs_ucfr:`1`},...this._config.ccpa.required&&{cs_ucfr:e}};window._comscore=window._comscore||[],window._comscore.push(t),this._import()}_import(){let e=`https://sb.scorecardresearch.com/cs/${this._comscoreId}/beacon.js`,t=document.querySelector(`[src^="${e}"]`);if(t){M.event(`ComscoreTrackerComponent`,`init`,`Comscore script already loaded`);return}ta(e).catch(e=>{let t=this._gdprEnabled?`GDPR`:`non-GDPR`;M.error(`ComscoreTrackerComponent`,`init`,`Error during Comscore beacon.js import in ${t} region: `,e)})}get enabled(){return!this._config.tkho.tracker.includes(this._name)&&this._isValidTraffic&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}},z6=D([Q(`ComscoreTrackerComponent`),S(),A(`design:paramtypes`,[typeof(R6=z!==void 0&&z)==`function`?R6:Object])],z6)})),B6,V6,H6,U6,W6,u_e=o((()=>{w(),$h(),B(),Ra(),$(),Z(),H(),Bh(),Rs(),j(),E(),O(),W6=class extends V{constructor(e,t,n,r){super(),this._gam=e,this._config=t,this._gamEventBus=n,this._context=r,T(this,`_name`,`hawk`)}init(){this._gamEventBus.slotOnload.once(()=>{this.import().then(()=>this.syncData()).catch(e=>M.error(`HawkeyeTrackerComponent`,`init`,`slotOnload`,e))})}get enabled(){return!this._config.tkho.tracker.includes(this._name)&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}async import(){return await ta(`https://pghub.io/js/pandg-sdk.js`,!0)}async syncData(){let e={ccpa:this._config.ccpa.privacyString?this._config.ccpa.privacyString:null,bp_id:`cafemedia`},t={name:`P&G`,pixelUrl:`https://pandg.tapad.com/tag`},n=window.Tapad.init(e,t);await n.sync({iabc:this._config.marmalade.ortbSegments.get(`iabc`)||[],iaba:this._config.marmalade.ortbSegments.get(`iaba`)||[],lotamePanoramaId:Is(),gpid:this._context.gpid}),this._gam.setTargetingFlag(`het_sync`,[`1`])}},W6=D([Q(`HawkeyeTrackerComponent`),S(),A(`design:paramtypes`,[typeof(B6=Zh!==void 0&&Zh)==`function`?B6:Object,typeof(V6=z!==void 0&&z)==`function`?V6:Object,typeof(H6=zh!==void 0&&zh)==`function`?H6:Object,typeof(U6=L!==void 0&&L)==`function`?U6:Object])],W6)})),G6,K6,q6,J6,d_e=o((()=>{w(),$(),Z(),B(),H(),cw(),so(),j(),E(),O(),J6=class extends V{constructor(e,t,n){super(),this._config=e,this._gdprEvents=t,this._gdprEnforcement=n,T(this,`_name`,`ats`)}init(){try{this._config.gdpr.enabled?this._gdprEvents.consentResponseCaptured.on(()=>{this._gdprEnforcement.checkConsentForVendor(this._config.gdpr.raptiveVendorId,[1]).then(e=>{e&&this._importATS()}).catch(()=>{M.error(`LiveRampAtsTrackerComponent`,`init`,`Failed to check consent for vendor`)})}):this._importATS()}catch(e){M.error(`LiveRampAtsTrackerComponent`,`init`,e)}}get enabled(){return this._config.liveRampAts.enabled&&!this._config.disableAds.all&&!this._config.tkho.tracker.includes(this._name)&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}_setECSTags(){let e={},t=this._config.marmalade.mcmp;for(let n of t)e[n]=`mcmp`;window.__launchpad(`ecst`,e,e=>{})}_setListener(){window.addEventListener(`lrEnvelopePresent`,()=>{this._setECSTags()})}_importATS(){this._setListener(),ta(this._config.liveRampAts.url).then(()=>{}).catch(e=>{M.error(`LiveRampAtsTrackerComponent`,`error importing liveramp with ATS`,e)})}},J6=D([Q(`LiveRampAtsTrackerComponent`),S(),A(`design:paramtypes`,[typeof(G6=z!==void 0&&z)==`function`?G6:Object,typeof(K6=oo!==void 0&&oo)==`function`?K6:Object,typeof(q6=ow!==void 0&&ow)==`function`?q6:Object])],J6)})),Y6,X6,Z6,Q6,f_e=o((()=>{w(),B(),Ra(),$(),H(),gG(),Z(),Bh(),j(),E(),O(),Q6=class extends V{constructor(e,t,n){super(),this._config=e,this._gamEventBus=t,this._context=n,T(this,`_name`,`nlsn`)}init(){try{this._gamEventBus.slotOnload.once(()=>{this.loadImage()})}catch(e){M.error(`NielsenTrackerComponent`,`init`,e)}}get enabled(){return Zt()&&!this._config.tkho.tracker.includes(this._name)&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}loadImage(){let e=this._context.device,t=`https://secure-gl.imrworldwide.com/cgi-bin/m?am=3&at=view&rt=banner&st=image&cr=adthrive&ce=cafemedia`,n={phone:`nlsn290957`,tablet:`nlsn291137`,desktop:`nlsn291136`},r=n[e],i={phone:`nlsn287186`,tablet:`nlsn287188`,desktop:`nlsn287187`},a=hG(this._context.savedReferrer);a&&(a.toLowerCase().includes(`instagram.com`)||a.toLowerCase().includes(`pinterest.com`))&&(r=i[e]),t+=`&ci=nlsnci542&ca=${r}&pc=${window.location.host}&r=${Date.now()}`,new Image().src=`${t}`}},Q6=D([Q(`NielsenTrackerComponent`),S(),A(`design:paramtypes`,[typeof(Y6=z!==void 0&&z)==`function`?Y6:Object,typeof(X6=zh!==void 0&&zh)==`function`?X6:Object,typeof(Z6=L!==void 0&&L)==`function`?Z6:Object])],Q6)})),$6,e8,t8,n8,r8,i8,p_e=o((()=>{w(),$(),IK(),B(),Z(),H(),Bh(),Wr(),j(),E(),O(),n8=[`.adthrive`,`.adthrive-ad`,`.adthrive-sidebar`],r8=`.raptive-affiliate-ignore`,i8=class extends V{constructor(e,t,n){super(),this._config=e,this._gamEventBus=t,this._slotManagerEventBus=n,T(this,`_name`,`tgtaff`),T(this,`_accountId`,`2773249`),T(this,`_adId`,`81938`),T(this,`_configId`,`2092`),T(this,`_affDomain`,`goto.target.com`),T(this,`_targetDomain`,`target.com`),T(this,`_commonParams`,``),T(this,`_commonPath`,``),this._commonParams=$re({subid1:this._config.site.id,subid2:location.href,sharedid:this._config.site.name}),this._commonPath=`${this._accountId}/${this._adId}/${this._configId}`}init(){try{let e=setTimeout(()=>{this.rewriteAllTargetLinksOnPage()},5e3);this._slotManagerEventBus.added.once(()=>{this._gamEventBus.slotOnload.once(()=>{e&&clearTimeout(e),this.rewriteAllTargetLinksOnPage()})})}catch(e){M.error(`TargetRewriteTrackerComponent`,`getAllTargetLinksOnPage`,e)}}rewriteAllTargetLinksOnPage(){let e=0,t=Array.prototype.map.call(document.querySelectorAll(`a[href*="${this._targetDomain}"]`),e=>e);t.filter(e=>this.isEligibleForRewrite(e)).forEach(t=>{this.fireImpression(t.href),this.replaceTargetLink(t),e++}),e&&M.event(`TargetRewriteTrackerComponent`,`logTargetRewrite`,{message:`targetRewrite`,countRewrite:e})}fireImpression(e){let t=this.getImpressionPixel(e);return new Image().src=t}getImpressionPixel(e){let t=`https://${this._affDomain}/i/${this._commonPath}?`,n=`U1|${this.getUUID()}`;t+=`_ir=${encodeURIComponent(n)}&`+this._commonParams+`&subid3=`+encodeURIComponent(e);let r=e.split(`?`);return r.length>1&&(t+=`&`+r[1]),t}getUUID(){return`${Yr().toString()}.${Math.random().toString(36).substring(2,15)}`}replaceTargetLink(e){let t=this.removeHashtagsFromUrl(e.href),n=encodeURIComponent(t),r=[`noskimlinks`,`norewrite`];e.classList.add(...r),e.href=`https://${this._affDomain}/c/${this._commonPath}?${this._commonParams}&subid3=${n}&u=${n}#donotlink`}removeHashtagsFromUrl(e){return e.split(`#`)[0]}isEligibleForRewrite(e){return this.isTargetLink(e)&&!this.shouldExcludeLink(e)}isTargetLink(e){let t=this.extractDomain(e.href);return t&&!t.includes(this._affDomain)}shouldExcludeLink(e){return n8.some(t=>e.matches(t))||e.matches(r8)}extractDomain(e){let t=/^https?\:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i.exec(e);return t&&t[1]||``}get enabled(){return!this._config.tkho.tracker.includes(this._name)&&!this._config.ccpa.enabled&&this._config.adOptions.targetAff&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}},i8=D([Q(`TargetRewriteTrackerComponent`),S(),A(`design:paramtypes`,[typeof($6=z!==void 0&&z)==`function`?$6:Object,typeof(e8=zh!==void 0&&zh)==`function`?e8:Object,typeof(t8=Ur!==void 0&&Ur)==`function`?t8:Object])],i8)})),a8,o8,s8,c8,l8,m_e=o((()=>{w(),$(),H(),ya(),Da(),Bh(),Ef(),j(),E(),O(),l8=class extends V{constructor(e,t,n,r){super(),this._gpcConfig=e,this._ccpaConfig=t,this._tkho=n,this._gamEventBus=r,T(this,`_name`,`ttdt`)}init(){try{this._gamEventBus.slotOnload.once(()=>{this.loadImage()})}catch(e){M.error(`TheTradeDeskTrackerComponent`,`init`,e)}}get enabled(){return!this._tkho.tracker.includes(this._name)&&!this._gpcConfig.gpcEnabled&&!this._ccpaConfig.userOptedOut}loadImage(){new Image().src=`https://insight.adsrvr.org/track/evnt/?adv=z127r4i&ct=0:p21aj7j&fmt=3`}},l8=D([Q(`TheTradeDeskTrackerComponent`),S(),A(`design:paramtypes`,[typeof(a8=va!==void 0&&va)==`function`?a8:Object,typeof(o8=Ea!==void 0&&Ea)==`function`?o8:Object,typeof(s8=Tf!==void 0&&Tf)==`function`?s8:Object,typeof(c8=zh!==void 0&&zh)==`function`?c8:Object])],l8)})),u8,d8,h_e=o((()=>{w(),B(),$(),Z(),H(),j(),E(),O(),d8=class extends V{constructor(e){super(),this._config=e,T(this,`_name`,`pbmss`),T(this,`_publisherId`,`157333`),T(this,`_scriptUrl`,`https://ads.pubmatic.com/AdServer/js/publisher-esp.js`)}get enabled(){return!this._config.tkho.tracker.includes(this._name)&&!this._config.gpc.gpcEnabled&&!this._config.ccpa.userOptedOut}init(){this._importTrackerScript().then(e=>{e instanceof HTMLScriptElement}).catch(e=>{M.error(`PubmaticTrackerComponent`,`init`,`Error importing Pubmatic script`,{error:e&&e.message})})}_importTrackerScript(){return window.pubmatic_esp=window.pubmatic_esp||{p:this._publisherId},ta(this._scriptUrl)}},d8=D([Q(`PubmaticTrackerComponent`),C(),A(`design:paramtypes`,[typeof(u8=z!==void 0&&z)==`function`?u8:Object])],d8)})),g_e=o((()=>{c_e(),l_e(),u_e(),d_e(),f_e(),p_e(),m_e(),h_e()})),f8,p8=o((()=>{f8=e=>{let t=/^[-_a-zA-Z]+[-_a-zA-Z0-9]*$/;return t.test(e)}})),m8,h8,g8,_8,__e=o((()=>{ii(),lU(),fr(),dU(),sU(),X(),$(),Lt(),p8(),w(),ud(),j(),E(),At(),O(),_8=class extends oU{constructor(e,t,n,r){var i;super(),this._siteExperiments=e,this._pubabgroup=t,this._cls=n,T(this,`_choices`,[]),T(this,`_mappedChoices`,[]),T(this,`_result`,``),T(this,`key`,Xn.AdLayout),T(this,`_resultValidator`,e=>{if(typeof e!=`string`)return!1;let t=e.startsWith(`.`)?e.substring(1):e;return f8(t)}),(i=r.siteAds)!=null&&i.siteExperiments?this.experimentConfig=new cU(r.siteAds).getSiteExperimentByKey(this.key):this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key),this.enabled&&this._cls.siteExperimentsWeightedChoice&&this.key in this._cls.siteExperimentsWeightedChoice&&this._isValidResult(this._cls.siteExperimentsWeightedChoice[this.key])?(this._result=this._cls.siteExperimentsWeightedChoice[this.key],this.setExperimentTargeting()):this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._mappedChoices=this._mapChoices(),this._result=this.run(),this.setExperimentTargeting())}run(){if(!this.enabled)return M.error(`AdLayoutSiteExperiment`,`run`,`() => %o`,`No experiment config found. Defaulting to empty class name.`),``;let e=new dr(this._mappedChoices).get();return this._isValidResult(e)?e:(M.error(`AdLayoutSiteExperiment`,`run`,`() => %o`,`Invalid result from experiment choices. Defaulting to empty class name for result`,e),``)}setExperimentTargeting(){if(!this.enabled||!this._isValidResult(this._result)){M.error(`AdLayoutSiteExperiment`,`setExperimentTargeting`,`() => %o`,`Experiment targeting requires an experiment config and valid result`);return}let e=this.experimentConfig,t=`${e.key.toLowerCase()}-${e.id}`,n=this._result;this._pubabgroup.set(t,n)}_mapChoices(){return this._choices.map(({weight:e,value:t})=>({weight:e,choice:t}))}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],_8.prototype,`run`,null),_8=D([C(),A(`design:paramtypes`,[typeof(m8=uU!==void 0&&uU)==`function`?m8:Object,typeof(h8=ri!==void 0&&ri)==`function`?h8:Object,typeof(g8=ld!==void 0&&ld)==`function`?g8:Object,Object]),kt(3,ot(`AdThrive`))],_8)})),v8,y8,v_e=o((()=>{__e(),$(),p8(),w(),H(),j(),O(),y8=class extends V{constructor(e){super(),this._adLayoutSiteExperiment=e}get enabled(){return this._adLayoutSiteExperiment.enabled}init(){let e=this._adLayoutSiteExperiment.result,t=e.startsWith(`.`)?e.substring(1):e;if(f8(t))try{document.body.classList.add(t)}catch(e){M.error(`AdLayoutComponent`,`init`,`Uncaught CSS Class Name error: ${e}`)}else M.error(`AdLayoutComponent`,`init`,`Invalid class name: ${e}`)}},y8=D([Q(`AdLayoutComponent`),S(),A(`design:paramtypes`,[typeof(v8=_8!==void 0&&_8)==`function`?v8:Object])],y8)})),b8,x8,S8,C8,y_e=o((()=>{w(),$(),wp(),cw(),H(),QX(),B(),j(),E(),O(),C8=class extends V{constructor(e,t,n){super(),this._gdprEnforcement=e,this.gppComponent=t,this._config=n,T(this,`_cb`,null),T(this,`_facebookVendorId`,`s7`),T(this,`_fbEventsUrlPattern`,/connect\.facebook\.net\/en_US\/fbevents.js/),T(this,`_userInteractionEvents`,[`mousemove`,`keydown`,`touchstart`,`wheel`]),T(this,`_consent`,`revoke`),T(this,`_throttleInterval`,500)}init(){this.checkGPPConsentForFacebook(),this._config.gdpr.enabled&&this._gdprEnforcement.checkConsentOnLoad().then(e=>{let t=e&&e.tcString;t?this.checkGDPRConsentForFacebook():this.listenForUserActionComplete()}).catch(()=>{})}checkGPPConsentForFacebook(){this.gppComponent.enabled&&(this._consent=this.gppComponent.gpcEnabled?`revoke`:`grant`,this._config.ccpa.consentChange.on(e=>{let t=e===this._config.ccpa.ccpaOptOut;this._consent=t?`revoke`:`grant`,this.handleFacebookPixelConsent()}),this.handleFacebookPixelConsent())}checkGDPRConsentForFacebook(){this._gdprEnforcement.checkConsentForVendor(this._facebookVendorId,[1]).then(e=>{this._consent=e?`grant`:`revoke`,this.handleFacebookPixelConsent()}).catch(()=>{})}listenForUserActionComplete(){window.__tcfapi(`addEventListener`,2,(e,t)=>{t&&e&&e.eventStatus===`useractioncomplete`&&this.checkGDPRConsentForFacebook()})}checkFBEventsJSExists(){return Array.from(document.querySelectorAll(`head > script:not([src]), body > script:not([src])`)).some(e=>this._fbEventsUrlPattern.test(e.innerHTML))}removeUserInteractionListeners(){this._cb&&(this._userInteractionEvents.forEach(e=>window.removeEventListener(e,this._cb)),this._cb=null)}addUserInteractionListeners(e){let t=()=>{e()&&this.removeUserInteractionListeners()};this._cb=Sp(t,this._throttleInterval,{leading:!1}),this._userInteractionEvents.forEach(e=>window.addEventListener(e,this._cb))}handleFacebookPixelConsent(){window.fbq&&typeof window.fbq==`function`?(window.fbq(`consent`,this._consent),this.removeUserInteractionListeners()):!this._cb&&this.checkFBEventsJSExists()&&this.addUserInteractionListeners(this.handleFacebookPixelConsent.bind(this))}get enabled(){return this._config.gdpr.enabled||this.gppComponent.enabled}},C8=D([Q(`FacebookPixelComponent`),S(),A(`design:paramtypes`,[typeof(b8=ow!==void 0&&ow)==`function`?b8:Object,typeof(x8=ZX!==void 0&&ZX)==`function`?x8:Object,typeof(S8=z!==void 0&&z)==`function`?S8:Object])],C8)})),b_e=o((()=>{y_e()})),w8,x_e=o((()=>{Lt(),w8=e=>{let t=encodeURIComponent(location.href),n=`https://ads.adthrive.com/api/v1/marmalade?siteid=${e}&url=${t}&experiments=recencyFrequency`;return fetch?fetch(n).then(e=>e.json()).catch(e=>(M.error(`getMarmaladeData`,`Unable to get marmalade data. Error:`,e),null)):new Promise(e=>{let t=new XMLHttpRequest;t.onload=()=>{t.status===200&&e(t.response)},t.open(`GET`,n,!0),t.responseType=`json`,t.send()})}})),T8,E8,D8,O8,S_e=o((()=>{w(),H(),$(),B(),rU(),x_e(),j(),E(),O(),O8=class extends V{constructor(e,t,n){super(),this._spaEventBus=e,this._marmaladeEventBus=t,this._config=n,T(this,`_siteId`,void 0),this._siteId=this._config.site.id}init(){this._spaEventBus.routeChanged.on(async()=>{let e=await w8(this._siteId);e&&(this._config.marmalade.updateMarmalade(e),this._marmaladeEventBus.marmaladeResponseLoaded.emit(e))})}get enabled(){return!0}},O8=D([Q(`SPAMarmaladeComponent`),S(),A(`design:paramtypes`,[typeof(T8=zr!==void 0&&zr)==`function`?T8:Object,typeof(E8=Rr!==void 0&&Rr)==`function`?E8:Object,typeof(D8=z!==void 0&&z)==`function`?D8:Object])],O8)})),k8,C_e=o((()=>{w(),Ui(),E(),O(),k8=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`SlickstreamAdUnits`,this._lookup=`SSAU`}},k8=D([C()],k8)})),A8,j8=o((()=>{A8=(e,t,n=0)=>{let r=[];for(let i=0;i<t;i++){let t=n+i;r.push({...e,sequence:t})}return r}})),M8,N8,P8,F8,I8,w_e=o((()=>{B(),Ra(),ud(),iJ(),Bq(),$(),Yq(),Zq(),$q(),j8(),w(),j(),E(),O(),I8=class extends rJ{constructor(e,t,n,r){super(t,n,r),this._config=e,this._adInjectionMap=t,this._context=n,this._cls=r,T(this,`_count`,0)}injectSlickstreamAdSlots(e,t=document,n){let r=[],i=Qq(`.slick-search-ad-slot div`,t);this._count=n+1;let a=A8(e,i.length,this._count).map(e=>(e.lazy=!0,e));for(let t=0;t<i.length;t++){let n=i.item(t),o=a[t],s=`${o.location}_${o.sequence}`;if(r.some(e=>e.name===s))continue;let c=this.getDynamicElementId(),l=`adthrive-${o.location.replace(`_`,`-`).toLowerCase()}`,u=`${l}-${o.sequence}`,d=[l,u,...o.classNames,`adthrive-slicksearch`],f=this._cls.injectedSlots,p=Jq(n,c,o.position,d,o.location,f||[]);if(p){let t=this._filterAdUnitSizes(o,p);t.length&&(r.push(Xq(o,p,t,!1,e.thirdPartyAdUnitName||``)),this._count++)}}return r}getDynamicElementId(){return`${this._config.gam.prefix}_Content_${this._count}_${this._context.device}`}},I8=D([Q(`SlickstreamAdsInjector`),S(),A(`design:paramtypes`,[typeof(M8=z!==void 0&&z)==`function`?M8:Object,typeof(N8=zq!==void 0&&zq)==`function`?N8:Object,typeof(P8=L!==void 0&&L)==`function`?P8:Object,typeof(F8=ld!==void 0&&ld)==`function`?F8:Object])],I8)})),L8,R8,z8,B8,V8,H8,U8,T_e=o((()=>{Qh(),B(),Ra(),X(),$(),FS(),MW(),w(),H(),C_e(),w_e(),Wr(),j(),E(),O(),U8=class extends V{constructor(e,t,n,r,i,a){super(),this._config=e,this._context=t,this._injector=n,this._slotManager=r,this._slickstreamAdsExperiment=i,this._slotManagerEventBus=a,T(this,`_slickstreamAdSlots`,[]),T(this,`_contentSlotsCount`,0)}get enabled(){return this._slickstreamAdsExperiment.result}init(){document.addEventListener(`slick-search-panel-show`,()=>{let e=document.querySelector(`slick-search-panel`);e&&!this.slotsAlreadyInjectedInElement(e)&&this._addSlots(e)}),document.addEventListener(`slick-search-panel-hide`,()=>{this._slickstreamAdSlots.length>0&&this._removeSlots()}),this._slotManagerEventBus.added.on(e=>{let t=this._slotManager.getSlots(e);for(let e of t)e.location===F.Content&&this._contentSlotsCount++})}_addSlots(e){let t=this._config.dynamicAds.filter(e=>e.location===F.Content).filter(e=>kW(this._config,e)).filter(e=>OW(e,this._context.device));if(t.length>0){let n=this._injector.injectSlickstreamAdSlots(t[0],e,this._contentSlotsCount);if(n.length===0)return;this._slotManager.add(n).then(e=>{e.forEach(e=>{this._slickstreamAdSlots.push(e),Zh.pushToQueue(()=>{e.setTargeting({key:`slicksearch`,value:`true`}),e.setSlotTargetingFlag(`slicksearch`,[`true`])})})}).catch(e=>{M.error(`SlickstreamAdsComponent`,`_addSlots`,e)})}}_removeSlots(){this._slotManager.destroy(this._slickstreamAdSlots),this._slotManager.removeElement(this._slickstreamAdSlots),this._contentSlotsCount-=this._slickstreamAdSlots.length,this._slickstreamAdSlots.length=0}slotsAlreadyInjectedInElement(e){let t=e.querySelector(`[id*='AdThrive_Content']`);return!!t}},U8=D([Q(`SlickstreamAdsComponent`),S(),A(`design:paramtypes`,[typeof(L8=z!==void 0&&z)==`function`?L8:Object,typeof(R8=L!==void 0&&L)==`function`?R8:Object,typeof(z8=I8!==void 0&&I8)==`function`?z8:Object,typeof(B8=PS!==void 0&&PS)==`function`?B8:Object,typeof(V8=k8!==void 0&&k8)==`function`?V8:Object,typeof(H8=Ur!==void 0&&Ur)==`function`?H8:Object])],U8)})),E_e=o((()=>{T_e()})),W8,D_e=o((()=>{w(),Ui(),E(),O(),W8=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`SlotResize`,this._lookup=`SRE`}},W8=D([C()],W8)})),G8,K8,q8,J8,Y8,O_e=o((()=>{B(),$(),vh(),w(),H(),D_e(),Bh(),j(),E(),O(),Y8=class extends V{constructor(e,t,n,r){super(),this.slotResizeExperiment=t,this._slots=r,T(this,`_gamSlotOnLoad`,void 0),T(this,`_slotSizeMap`,new Map),T(this,`_stickyContentEnabled`,void 0),this._gamSlotOnLoad=n.slotOnload,this._stickyContentEnabled=e.adOptions.stickyContentEnabled||!1}get enabled(){return this.slotResizeExperiment.result}start(){this._setupListeners()}_setupListeners(){this._gamSlotOnLoad.on(({slotId:e})=>{let t=this._slots.get(e);(t==null?void 0:t.location)===`Content`&&this._compareSlot(t)})}_compareSlot(e){let t=this._slotSizeMap.get(e.id),n=getComputedStyle(e.element).height,r=Number(n.slice(0,-2));(!t||t<r)&&(this._resize(e.element,n),this._setSlotSizeMap(e.element.id,r)),this._stickyContentEnabled||this._align(e.element)}_resize(e,t){e.style.minHeight=t}_setSlotSizeMap(e,t){this._slotSizeMap.set(e,t)}_align(e){let{top:t,bottom:n}=e.getBoundingClientRect(),r=t,i=window.innerHeight-n;e.style.alignContent=r<i?`end`:`start`}},Y8=D([S(),Q(`SlotResizeComponent`),A(`design:paramtypes`,[typeof(G8=z!==void 0&&z)==`function`?G8:Object,typeof(K8=W8!==void 0&&W8)==`function`?K8:Object,typeof(q8=zh!==void 0&&zh)==`function`?q8:Object,typeof(J8=_h!==void 0&&_h)==`function`?J8:Object])],Y8)})),k_e=o((()=>{O_e()})),X8,Z8=o((()=>{X8=e=>e.some(e=>document.querySelector(e)!==null)})),Q8,$8,e5=o((()=>{B(),$(),yJ(),w(),Z(),j(),E(),O(),$8=class{constructor(e){T(this,`stickyHeaderHeight`,void 0),T(this,`stickyBlockedSelectors`,[]),this.stickyHeaderHeight=vJ(e.adOptions.stickyHeaderSelectors),this.stickyBlockedSelectors=e.adOptions.stickyBlockedSelectors||[]}logOverflow(e){let t=document.querySelector(e);t&&gn(t)}getStickyAdTopProperty(e){let{playerContainer:t,topBackgroundElement:n,collapseMobileSubType:r,mobileHeaderSelector:i}=e;if(r===`adthrive-collapse-bottom-left`||r===`adthrive-collapse-bottom-right`)return this.stickyHeaderHeight;{let e=n?Number(n.getBoundingClientRect().height):Number(t.getBoundingClientRect().height),r=vJ([i||``]);return r?Number(r)+e:e}}},$8=D([Q(`StickyContainerAdsUtil`),S(),A(`design:paramtypes`,[typeof(Q8=z!==void 0&&z)==`function`?Q8:Object])],$8)})),t5,n5=o((()=>{Ui(),Z(),w(),E(),O(),t5=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`StickyContainerAdsTopCenterVideoDependency`,this._lookup=`SCATCVE`}isEnabled(){return super.isEnabled()&&tG()}},t5=D([S()],t5)})),r5,i5,a5,o5,s5,A_e=o((()=>{B(),rU(),$(),_J(),w(),H(),Z8(),i$(),e5(),n5(),Z(),j(),E(),O(),s5=class extends V{constructor(e,t,n,r){super(),this._videoEventBus=t,this._stickyContainerAdEventBus=n,this._stickyContainerTopCenterVideoDependencyExperiment=r,T(this,`_stickyContainerTopCenterVideoDependencyExperimentResult`,!1),T(this,`_stickyContentHeight`,void 0),T(this,`_stickyAdTopProperty`,void 0),T(this,`_stickyContainerAdsUtil`,void 0),T(this,`_stickyContentEnabled`,!1),this._stickyContainerAdsUtil=new $8(e),this._stickyContentHeight=Ei()?250:e.adOptions.stickyContentHeight,this._stickyContainerTopCenterVideoDependencyExperimentResult=this._stickyContainerTopCenterVideoDependencyExperiment.result,this._stickyContentEnabled=e.adOptions.stickyContentEnabled||!1}get enabled(){return this._stickyContentEnabled&&!X8(this._stickyContainerAdsUtil.stickyBlockedSelectors)}start(){this.setCSS(),this._stickyContainerAdsUtil.logOverflow(`.adthrive-sticky-container`),this._stickyContainerAdEventBus.stickyContainerContentAdStylingApplied.emit()}setCSS(){fJ(this._stickyContentHeight),mJ(this._stickyContainerAdsUtil.stickyHeaderHeight),this._stickyContainerTopCenterVideoDependencyExperimentResult&&this.addListeners()}addListeners(){this._videoEventBus.topCenterVideoCollapsed.on(e=>{this._stickyAdTopProperty||(this._stickyAdTopProperty=this._stickyContainerAdsUtil.getStickyAdTopProperty(e)),mJ(this._stickyAdTopProperty)}),this._videoEventBus.topCenterVideoUnCollapsed.on(()=>{mJ(this._stickyContainerAdsUtil.stickyHeaderHeight)})}},s5=D([Q(`StickyContainerContentAdsComponent`),S(),A(`design:paramtypes`,[typeof(r5=z!==void 0&&z)==`function`?r5:Object,typeof(i5=eU!==void 0&&eU)==`function`?i5:Object,typeof(a5=r$!==void 0&&r$)==`function`?a5:Object,typeof(o5=t5!==void 0&&t5)==`function`?o5:Object])],s5)})),c5,l5,u5,d5,j_e=o((()=>{B(),rU(),$(),_J(),w(),H(),Z8(),e5(),n5(),j(),E(),O(),d5=class extends V{constructor(e,t,n){super(),this._videoEventBus=t,this._stickyContainerTopCenterVideoDependencyExperiment=n,T(this,`_stickyContainerTopCenterVideoDependencyExperimentResult`,!1),T(this,`_stickyRecipeHeight`,void 0),T(this,`_stickyAdTopProperty`,void 0),T(this,`_stickyContainerAdsUtil`,void 0),this._stickyContainerAdsUtil=new $8(e),this._stickyRecipeHeight=e.adOptions.stickyRecipeHeight,this._stickyContainerTopCenterVideoDependencyExperimentResult=this._stickyContainerTopCenterVideoDependencyExperiment.result}get enabled(){return!X8(this._stickyContainerAdsUtil.stickyBlockedSelectors)}start(){this.setCSS(),this._stickyContainerAdsUtil.logOverflow(`.adthrive-recipe-sticky-container`)}setCSS(){pJ(this._stickyRecipeHeight),hJ(this._stickyContainerAdsUtil.stickyHeaderHeight),this._stickyContainerTopCenterVideoDependencyExperimentResult&&this.addListeners()}addListeners(){this._videoEventBus.topCenterVideoCollapsed.on(e=>{this._stickyAdTopProperty||(this._stickyAdTopProperty=this._stickyContainerAdsUtil.getStickyAdTopProperty(e)),hJ(this._stickyAdTopProperty)}),this._videoEventBus.topCenterVideoUnCollapsed.on(()=>{hJ(this._stickyContainerAdsUtil.stickyHeaderHeight)})}},d5=D([Q(`StickyContainerRecipeAdsComponent`),S(),A(`design:paramtypes`,[typeof(c5=z!==void 0&&z)==`function`?c5:Object,typeof(l5=eU!==void 0&&eU)==`function`?l5:Object,typeof(u5=t5!==void 0&&t5)==`function`?u5:Object])],d5)})),f5,p5,m5,M_e=o((()=>{w(),H(),kp(),zF(),Lt(),j(),E(),O(),m5=class extends V{constructor(e,t){super(),this._creativeBlock=e,this._creativeBlockEventBus=t,T(this,`_previouslyBlockedCrids`,new Set)}init(){this._creativeBlockEventBus.blockCreativeIds.on(e=>void this._blockCreativeIds(e))}get enabled(){return this._creativeBlock.creativeBlockEnabled}async _blockCreativeIds(e){let t=Array.from(e.crids).filter(e=>!this._previouslyBlockedCrids.has(e));if(t.length!==0)return t.forEach(e=>this._previouslyBlockedCrids.add(e)),window.fetch(`https://api.adthrive.com/crid`,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({crids:t})}).then(()=>{e.source===`confiant`&&M.event(`CreativeBlockComponent`,`_blockCreativeIds`,`Blocked creative IDs from Confiant`,t)}).catch(n=>{M.error(`CreativeBlockComponent`,`_blockCreativeIds`,`Error blocking creative IDs`,e.source,t,n)})}},m5=D([C(),A(`design:paramtypes`,[typeof(f5=Bu!==void 0&&Bu)==`function`?f5:Object,typeof(p5=RF!==void 0&&RF)==`function`?p5:Object])],m5)})),h5,g5,_5,v5,y5,b5,x5,N_e=o((()=>{H(),uh(),xJ(),Bh(),X(),IK(),Z(),w(),rU(),FS(),j(),E(),O(),x5=class extends V{constructor(e,t,n,r,i,a){super(),this._adTypes=e,this._gamEventBus=t,this._skylineEventBus=n,this._slotManagerEventBus=r,this._slotManager=i,this._slotEventBus=a,T(this,`_footerSlotAdded`,!1),T(this,`_skylineSearchDelayAfterRender`,750),T(this,`_skylineRenderDuration`,6e4),T(this,`_skylineUnitClassName`,`raptive-sales-sky`)}init(){let e=this._slotManagerEventBus.added.on(t=>{let n=this._slotManager.getSlots(t),r=n.find(e=>this._isHeaderSlot(e));r&&(this._setSkylineTargetingOnSlot(r),e())}),t=this._gamEventBus.slotOnload.on(({slotId:e})=>{let n=this._slotManager.getSlot(e);n&&this._isHeaderSlot(n)&&setTimeout(()=>{this._isSkylineAdUnit(n)?this._handleSkylineHeaderRender(n):this._enableFooterSlotAddition(),n.clearSlotTargetingFlag([`skl`]),t()},this._skylineSearchDelayAfterRender)})}_setSkylineTargetingOnSlot(e){e.setSlotTargetingFlag(`skl`,[`1`])}_isSkylineAdUnit(e){return this._isHeaderSlot(e)&&!!e.element.getElementsByClassName(this._skylineUnitClassName).length}_handleSkylineHeaderRender(e){this._slotManager.updateRefreshTimeout(e,this._skylineRenderDuration),this._listenForSkylineClosed();let t=this._slotEventBus.beforeGoogleAdManagerRefreshSlots.on(e=>{let n=this._slotManager.getSlots(e);n.some(e=>this._isHeaderSlot(e))&&(this._enableFooterSlotAddition(),t())});this._handleSkylineAfter60Seconds(e)}_listenForSkylineClosed(){window.addEventListener(`message`,e=>{this._isSkylineClosedMessage(e)&&this._enableFooterSlotAddition()})}_isSkylineClosedMessage(e){let t=e.data;return!!t&&typeof t==`object`&&`type`in t&&typeof t.type==`string`&&t.type===`CeltraSkyline`&&`action`in t&&typeof t.action==`string`&&t.action===`closed`}_handleSkylineAfter60Seconds(e){setTimeout(()=>{this._footerSlotAdded||this._slotManager.refresh(e)},this._skylineRenderDuration)}_enableFooterSlotAddition(){this._footerSlotAdded=!0,this._skylineEventBus.footerSlotAdditionEnabled.emit()}get enabled(){return this._adTypes.skylineHeader&&Ei()}_isHeaderSlot(e){return e.location===F.Header}},x5=D([Q(`SkylineAdsComponent`),C(),A(`design:paramtypes`,[typeof(h5=lh!==void 0&&lh)==`function`?h5:Object,typeof(g5=zh!==void 0&&zh)==`function`?g5:Object,typeof(_5=bJ!==void 0&&bJ)==`function`?_5:Object,typeof(v5=Ur!==void 0&&Ur)==`function`?v5:Object,typeof(y5=PS!==void 0&&PS)==`function`?y5:Object,typeof(b5=Vr!==void 0&&Vr)==`function`?b5:Object])],x5)})),S5,P_e=o((()=>{H(),al(),w(),O(),S5=class extends V{get enabled(){return il.isRolloutEnabled(`ad-fit-width`)}start(){document.body.classList.add(`adthrive-fit-content`)}},S5=D([S()],S5)})),C5,w5,F_e=o((()=>{w(),H(),rU(),j(),O(),w5=class extends V{constructor(e){super(),this._footerConfigEventBus=e}init(){this._footerConfigEventBus.comscoreInitialized.on(e=>{e&&this._footerConfigEventBus.footerElementAdded.emit({order:3,element:`<span>A Raptive Partner Site</span>`})},{handleEventsAlreadyEmitted:!0})}},w5=D([S(),A(`design:paramtypes`,[typeof(C5=xr!==void 0&&xr)==`function`?C5:Object])],w5)})),I_e=o((()=>{F_e()})),T5,E5=o((()=>{T5=(e,...t)=>{let n=e.reduce((e,n,r)=>e+n+(t[r]||``),``);return n.split(`
`).map(e=>e.trim()).join(` `).replace(/\s+/g,` `).replace(/(\s+)?>\s+/g,`>`).replace(/(\s+)?\s+</g,`<`).trim()}})),D5,O5,k5,L_e=o((()=>{w(),H(),rU(),B(),E5(),j(),E(),O(),k5=class extends V{constructor(e,t){super(),this._footerConfigEventBus=e,this._adOptions=t,T(this,`_cssPrefix`,`raptive-content-terms`),T(this,`_modal`,document.querySelector(`.raptive-content-terms-modal`)),T(this,`_handleModalDismiss`,e=>{if(e.target===this._modal){var t;(t=this._modal)==null||t.close()}})}get enabled(){return this._adOptions.contentTermsFooterEnabled}start(){this._createModal(),this._footerConfigEventBus.footerElementAdded.emit({order:2,element:this._createFooterElement()})}_createFooterElement(){let e=document.createElement(`div`);e.className=`${this._cssPrefix}-footer`;let t=document.createElement(`a`);return t.text=`Terms of Content Use`,t.className=`${this._cssPrefix}-footer-link`,t.addEventListener(`click`,this._handleFooterLinkClick.bind(this)),e.appendChild(t),e}_createModal(){if(this._modal)return this._modal;let e=document.createElement(`dialog`);e.className=`${this._cssPrefix}-modal`,e.innerHTML=T5`
      <div class="${this._cssPrefix}-modal-content">
        <div class="${this._cssPrefix}-modal-header">
          <h2 class="${this._cssPrefix}-modal-title">Your Use of Our Content</h2>
          <span class="${this._cssPrefix}-modal-close">&#x2715;</span>
        </div>
        <div class="${this._cssPrefix}-modal-body">
          <p>
            The content we make available on this website [and through our other channels] (the “Service”) was created, developed, compiled, prepared,
            revised, selected, and/or arranged by us, using our own methods and judgment, and through the expenditure of substantial time and effort.
            This Service and the content we make available are proprietary, and are protected by these Terms of Service (which is a contract between
            us and you), copyright laws, and other intellectual property laws and treaties. This Service is also protected as a collective work or
            compilation under U.S. copyright and other laws and treaties. We provide it for your personal, non-commercial use only.
          </p>
          <p>
            You may not use, and may not authorize any third party to use, this Service or any content we make available on this Service in any manner
            that (i) is a source of or substitute for the Service or the content; (ii) affects our ability to earn money in connection with the
            Service or the content; or (iii) competes with the Service we provide. These restrictions apply to any robot, spider, scraper, web
            crawler, or other automated means or any similar manual process, or any software used to access the Service. You further agree not to
            violate the restrictions in any robot exclusion headers of this Service, if any, or bypass or circumvent other measures employed to
            prevent or limit access to the Service by automated means.
          </p>
        </div>
      </div>
    `;let t=e.querySelector(`.${this._cssPrefix}-modal-close`);return t==null||t.addEventListener(`click`,this._handleModalClose.bind(this)),document.body.appendChild(e),e.addEventListener(`click`,this._handleModalDismiss.bind(this)),this._modal=e,e}_handleModalClose(){var e;(e=this._modal)==null||e.close()}_handleFooterLinkClick(){var e;(e=this._modal)==null||e.showModal()}},k5=D([S(),A(`design:paramtypes`,[typeof(D5=xr!==void 0&&xr)==`function`?D5:Object,typeof(O5=Ci!==void 0&&Ci)==`function`?O5:Object])],k5)})),R_e=o((()=>{L_e()})),A5,z_e=o((()=>{w(),Ui(),E(),O(),A5=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`ContentSizeLogging`,this._lookup=`CSL`}},A5=D([C()],A5)})),j5,M5,N5,P5,F5,I5,L5,R5,B_e=o((()=>{w(),$(),H(),z_e(),Z(),Bq(),X(),Md(),B(),FS(),rU(),j(),E(),O(),R5=class extends V{constructor(e,t,n,r,i,a,o){super(),this._dynamicAdsMapper=e,this._adInjectionMap=t,this._contentSizeLoggingExperiment=n,this._slotManager=r,this._slotManagerEventBus=i,this._clsOptimizedAds=a,this._site=o,T(this,`_slotsForMainContent`,new Map),T(this,`_slotsForEnd`,new Map),T(this,`_mainContentSlot`,new Set([F.Content,F.Recipe])),T(this,`_initMainContentHeight`,null)}async start(){let[e]=OG(this._dynamicAdsMapper.get(),this._adInjectionMap);this._initMainContentHeight=e.scrollHeight,this._calculateAndLogTotalSlotHeight(),await fK().then(()=>{M.event(`ContentSizeLoggingComponent`,`init`,{fullPageHeight:this._pageContentHeight(),mainContentHeight:this._initMainContentHeight}),this._logImageData()})}_calculateAndLogTotalSlotHeight(){this._slotManagerEventBus.displaying.once(()=>{let e=this._slotManager.getSlots();e.forEach(e=>{if(this._shouldAddHeightToTotal(e)){let t=this._clsOptimizedAds.getDivHeight(e.name,tG()?`phone`:`desktop`);this._mainContentSlot.has(e.location)?this._slotsForMainContent.set(e.id,t):this._slotsForEnd.set(e.id,t)}this._logSlotHeights()})})}_logSlotHeights(){let e=Array.from(this._slotsForMainContent.values()).reduce((e,t)=>e+t,0),t=e+Array.from(this._slotsForEnd.values()).reduce((e,t)=>e+t,0);M.event(`ContentSizeLoggingComponent`,`_logSlotHeights`,{mainAdSlotHeight:e,fullPageAdSlotHeight:t})}_shouldAddHeightToTotal(e){return!e.infinite&&!e.element.classList.contains(`adthrive-slicksearch`)&&!this._slotsForMainContent.has(e.name)&&!this._slotsForEnd.has(e.name)}_logImageData(){if(typeof performance>`u`)return;let e=performance.getEntriesByType(`resource`),t=0,n=0,r=0,i=0;e.forEach(e=>{e.initiatorType===`img`&&(e.encodedBodySize===0?n++:t++,r+=e.encodedBodySize,i+=e.decodedBodySize)});let a={zeroByteImagesCount:n,nonZeroByteImageCount:t,imagesCompressedSize:`${(r/(1024*1024)).toFixed(2)} MB`,imagesUncompressedSize:`${(i/(1024*1024)).toFixed(2)} MB`},o=JSON.stringify(a).length;if(o>8e3){M.error(`ContentSizeLoggingComponent`,`_logImageData`,`log size too large`,`siteId: ${this._site.id}`,`pageUrl: ${window.location.href}`);return}M.event(`ContentSizeLoggingComponent`,`_logImageData`,a)}_pageContentHeight(){let e=document.body,t=document.documentElement;return Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)}get enabled(){return this._contentSizeLoggingExperiment.result}},R5=D([Q(`ContentSizeLoggingComponent`),S(),A(`design:paramtypes`,[typeof(j5=jd!==void 0&&jd)==`function`?j5:Object,typeof(M5=zq!==void 0&&zq)==`function`?M5:Object,typeof(N5=A5!==void 0&&A5)==`function`?N5:Object,typeof(P5=PS!==void 0&&PS)==`function`?P5:Object,typeof(F5=Ur!==void 0&&Ur)==`function`?F5:Object,typeof(I5=_d!==void 0&&_d)==`function`?I5:Object,typeof(L5=qa!==void 0&&qa)==`function`?L5:Object])],R5)})),z5,B5,V5,H5,U5,W5,G5,V_e=o((()=>{wp(),rU(),Hr(),$(),vh(),X(),Na(),w(),H(),sG(),Ni(),Z(),hoe(),al(),FS(),Bh(),j(),E(),O(),G5=class extends V{constructor(e,t,n,r,i,a){super(),this._slotManager=e,this._slotEventBus=t,this._slotManagerEventBus=n,this._pageManager=r,this._jumpToSlotManager=i,this._gamEventBus=a,T(this,`_destroyedSlots`,new Map),T(this,`_observerForDestroyingSlots`,null),T(this,`_observerForRestoringSlots`,null),T(this,`_lastScroll`,window.scrollY),T(this,`_featureRolloutEnabled`,!1),T(this,`_slotFilter`,void 0),T(this,`_shouldRestoreSlots`,!0),T(this,`_slotsRenderedFor30Seconds`,new Set),T(this,`_destructionVpThreshold`,-3),this._featureRolloutEnabled=il.isRolloutEnabled(`ios-manage-content-slots`);let o=il.getSiteRolloutConfig(`ios-manage-content-slots`);`restoreSlots`in o&&typeof o.restoreSlots==`boolean`&&(this._shouldRestoreSlots=o.restoreSlots);let s=e=>e.location===F.Content;this._slotFilter=this._featureRolloutEnabled?e=>!!s(e):e=>!!(s(e)&&e.sequence&&e.sequence<=3)}init(){this._shouldRestoreSlots?this._listenForSlotsAdded():this._listenForSlotsRendered(),this._featureRolloutEnabled?this._setScrollListenerAndCreateObservers():this._jumpToSlotManager.enabled&&(this._jumpToSlotManager._onJumpToRecipeTrackerClicked.once(()=>{this._setScrollListenerAndCreateObservers()}),this._jumpToSlotManager.preventedSlotsFromBeingAdded.on(e=>{e.forEach(e=>{this._storeSlotDataAndObserveForRestore(e.element,e)})}))}_setScrollListenerAndCreateObservers(){this._pageManager.scroll.on(Sp(()=>this._handleScroll.call(this,window.scrollY),100)),this._observerForDestroyingSlots=this._createObserverForDestroyingSlots(),this._shouldRestoreSlots&&(this._observerForRestoringSlots=this._createObserverForRestoringSlots())}_listenForSlotsAdded(){this._slotManagerEventBus.added.on(e=>{let t=this._slotManager.getSlots(e);t.forEach(e=>{this._slotFilter(e)&&this._observerForDestroyingSlots&&!this._destroySlotIfAboveByTwoViewports(e)&&this._observerForDestroyingSlots.observe(e.element)})})}_listenForSlotsRendered(){this._gamEventBus.slotRenderEnded.on(({slotId:e})=>{let t=this._slotManager.getSlot(e);t&&t.location===F.Content&&setTimeout(()=>{if(t.getPositionFromViewport()<=this._destructionVpThreshold)this._destroySlot(t.element,t);else{var e;this._slotsRenderedFor30Seconds.add(t.id),(e=this._observerForDestroyingSlots)==null||e.observe(t.element)}},3e4)})}async _handleScroll(e){let t=(e-this._lastScroll)/window.innerHeight;if(t<=-1)for(let[e,t]of this._destroyedSlots){let n=document.getElementById(e);n&&oG(n)>=0&&await this._restoreSlot(n,t)}else t>=1&&this._slotManager.getSlots().forEach(e=>this._slotFilter(e)&&this._destroySlotIfAboveByTwoViewports(e));this._lastScroll=e}_destroySlotIfAboveByTwoViewports(e){return e.getPositionFromViewport()<=-3&&!this._destroyedSlots.has(e.id)?(this._destroySlot(e.element,e),!0):!1}_createObserverForDestroyingSlots(){return new IntersectionObserver(this._processSlotsForDeletion.bind(this),{root:null,rootMargin:`300% 0px -300% 0px`,threshold:[0]})}_createObserverForRestoringSlots(){return new IntersectionObserver(e=>{this._processSlotsForRestoration(e).catch(e=>M.error(`ContentSlotsIntersectionObserverComponent`,`_processSlotsForRestoration`,e))},{root:null,rootMargin:`200% 0px -200% 0px`,threshold:[0]})}_storeContentSlotConfig(e,t){let{location:n,sequence:r,sticky:i,lazy:a,stickyOverlapSelector:o,special:s,auctionPriority:c,element:l,sizes:u,infinite:d,thirdPartyAdUnitName:f}=t;this._destroyedSlots.set(e,{location:n,sequence:r,sticky:i,lazy:a,stickyOverlapSelector:o,special:s,auctionPriority:c,element:l,sizes:u,infinite:d,thirdPartyAdUnitName:f})}_processSlotsForDeletion(e){e.forEach(e=>{let t=this._slotManager.getSlot(e.target.id);t&&e.isIntersecting&&this._lastScroll<window.scrollY&&this._destroySlot(e.target,t)})}_destroySlot(e,t){this._observerForDestroyingSlots&&(this._observerForDestroyingSlots.unobserve(e),this._storeSlotDataAndObserveForRestore(e,t),this._slotEventBus.adSlotScrolledFarOutOfView.emit(t.id))}_storeSlotDataAndObserveForRestore(e,t){this._shouldRestoreSlots&&(this._storeContentSlotConfig(e.id,t),this._observerForRestoringSlots&&this._observerForRestoringSlots.observe(e))}async _processSlotsForRestoration(e){for(let t of e){let e=this._destroyedSlots.get(t.target.id);e&&t.isIntersecting&&this._lastScroll>window.scrollY&&await this._restoreSlot(t.target,e)}}async _restoreSlot(e,t){this._observerForRestoringSlots&&(this._observerForRestoringSlots.unobserve(e),this._destroyedSlots.delete(e.id),await this._slotManager.add(new gh(t.location,t.sequence,t.sizes,t.element,t.sticky,t.lazy,t.auctionPriority,t.stickyOverlapSelector,t.special,!0,t.infinite,t.thirdPartyAdUnitName||``)))}get enabled(){return Oi()&&tG()&&(this._jumpToSlotManager.enabled||this._featureRolloutEnabled)&&`IntersectionObserver`in window&&`IntersectionObserverEntry`in window&&`intersectionRatio`in IntersectionObserverEntry.prototype}},G5=D([Q(`ContentSlotsIntersectionObserverComponent`),C(),A(`design:paramtypes`,[typeof(z5=PS!==void 0&&PS)==`function`?z5:Object,typeof(B5=Vr!==void 0&&Vr)==`function`?B5:Object,typeof(V5=Ur!==void 0&&Ur)==`function`?V5:Object,typeof(H5=ja!==void 0&&ja)==`function`?H5:Object,typeof(U5=cb!==void 0&&cb)==`function`?U5:Object,typeof(W5=zh!==void 0&&zh)==`function`?W5:Object])],G5)})),H_e,K5,q5,J5,U_e=o((()=>{X(),FW(),H_e=new Map([[F.Footer,1],[F.Header,2],[F.Sidebar,3],[F.Content,4],[F.Recipe,5],[`Sidebar_sticky`,6],[`Below Post`,7]]),K5=(e,t)=>{let n=PW(t),r=e.sticky&&e.location===F.Sidebar;return e.sizes.filter(t=>{let i=e.autosize?t[0]<=n||t[0]<=320:!0,a=r?t[1]<=window.innerHeight-100:!0;return i&&a})},q5=(e,t)=>e.devices.includes(t),J5=e=>e.pageSelector.length===0||document.querySelector(e.pageSelector)!==null})),Y5,W_e=o((()=>{w(),$(),mU(),O(),Y5=class extends pU{init(){this._key=`DynamicSidebarSlotsCap`,this._lookup=`DSSC2`}},Y5=D([Q(`DynamicSidebarSlotsCapExperiment`),C()],Y5)})),X5,Z5,G_e=o((()=>{Lt(),X5=e=>{let t=e.lastChild;if(t instanceof HTMLElement)return t.offsetTop+t.offsetHeight;if(t instanceof Text){let n=t.previousElementSibling;return n?n.offsetTop+n.offsetHeight:e.offsetTop}else return M.error(`util`,`determineSidebar9ElementTop`,`Could not determine the top of the sidebar9 child element`),e.offsetTop},Z5=(e,t,n=1200,r=25)=>{let i=t.hasChildNodes()?X5(t):t.offsetTop,a=e-i,o=Math.floor(a/(n+10)),s=Math.min(o,r);return s}})),Q5,$5,e7,t7,n7,r7,i7,K_e=o((()=>{H(),U_e(),W_e(),B(),Ra(),X(),$(),FS(),Z(),Yq(),Zq(),$q(),nJ(),j8(),G_e(),w(),jZ(),Z8(),ud(),j(),O(),i7=class extends V{constructor(e,t,n,r,i,a){super(),this._config=e,this._context=t,this._slotManager=n,this._dynamicSidebarSlotsCapExperiment=r,this._essaExperiment=i,this._cls=a}get enabled(){let e=this._config.adOptions.dynamicStickySidebarBlockedSelectors||[],t=X8(e);return!t&&!!this._config.adOptions.dynamicStickySidebarEnabled&&this._essaExperiment.result}async start(){let e=this._config.dynamicAds.filter(e=>e.location===F.Sidebar).filter(e=>e.sequence===9).filter(e=>kW(this._config,e)).filter(e=>q5(e,this._context.device)).filter(e=>J5(e)),t=e[0];if(!t)return;let n=this.insertDynamicStickySidebarAds(t);n.length!==0&&await this._slotManager.add(n)}updateStylingForExistingStickySidebarAd(e){let t=this.getDynamicElementId(e),n=document.getElementById(t);n==null||n.classList.add(`adthrive-sticky-sidebar`)}getSidebarElement(e){let t=Qq(e.elementSelector,document).item(e.skip);return t}insertDynamicStickySidebarAds(e){let t=[],n=Qq(e.elementSelector,document).item(e.skip);if(n===null)return t;let r=this.repeatDynamicStickySidebar(e).filter(e=>{let t=document.querySelector(`#${this.getDynamicElementId(e)}`);return t===null});if(r.length<2)return t;this.updateStylingForExistingStickySidebarAd(e);for(let i=0;i<r.length;i++){let a=r[i],o=`${a.location}_${a.sequence}`;if(t.some(e=>e.name===o))continue;let s=this.getDynamicElementId(a),c=eJ(a),l=tJ(a),u=i===r.length-1,d=[u?``:`adthrive-sticky-sidebar`,c,l,...a.classNames],f=this._cls.injectedSlots,p=Jq(n,s,a.position,d,e.location,f||[]);if(p){let n=K5(a,p);n.length&&t.push(Xq(a,p,n,!1,e.thirdPartyAdUnitName||``))}}return t}getSidebarSlotHeight(){let e=this._config.adOptions.dynamicStickySidebarHeight;return e===0||e===void 0?(M.error(`EnhancedStickySidebarComponent`,`_getSidebarSlotHeight`,`Dynamic sticky sidebar height is not set in config`),1800):e}calculateNumberOfDynamicStickySidebars(e){var t;let n=this.getSidebarElement(e);if(!n)return 0;let r=this.getSidebarSlotHeight(),i=e.stickyOverlapSelector&&((t=document.querySelector(e.stickyOverlapSelector))==null?void 0:t.offsetTop)||document.body.scrollHeight,a=this._dynamicSidebarSlotsCapExperiment.result||0,o=Z5(i,n,r,a);return o}repeatDynamicStickySidebar(e){if(e.location!==F.Sidebar||e.sequence!==9||!e.sticky)return[e];let t=this.calculateNumberOfDynamicStickySidebars(e);return A8(e,t,9).map(e=>(e.sequence!==9&&(e.lazy=!0),e))}getDynamicElementId(e){return`${this._config.gam.prefix}_${e.location}_${e.sequence}_${this._context.device}`}},i7=D([Q(`EnhancedStickySidebarComponent`),S(),A(`design:paramtypes`,[typeof(Q5=z!==void 0&&z)==`function`?Q5:Object,typeof($5=L!==void 0&&L)==`function`?$5:Object,typeof(e7=PS!==void 0&&PS)==`function`?e7:Object,typeof(t7=Y5!==void 0&&Y5)==`function`?t7:Object,typeof(n7=AZ!==void 0&&AZ)==`function`?n7:Object,typeof(r7=ld!==void 0&&ld)==`function`?r7:Object])],i7)})),q_e=o((()=>{})),a7,J_e=o((()=>{$(),w(),E(),O(),a7=class{constructor(){T(this,`_apiUrl`,`https://hem-router.production.raptive.com`)}async subscribe(e){try{let t=await fetch(`${this._apiUrl}/subscribe`,{method:`POST`,headers:{"Content-Type":`application/json`,Accept:`application/json`},referrerPolicy:`no-referrer-when-downgrade`,body:JSON.stringify(e)}),n=await t.json();if(!t.ok)throw n;return M.event(`EmailServiceProviderAPI`,`subscribe`,`Successfully subscribed user`),n}catch(e){let t=(e==null?void 0:e.message)||`Unknown error`;return M.error(`EmailServiceProviderAPI`,`subscribe`,`Error subscribing user`,t),!1}}},a7=D([Q(`EmailServiceProviderAPI`),S()],a7)})),o7,Y_e=o((()=>{Ui(),$(),w(),E(),j(),O(),o7=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`HemCaptureGatedPrint`,this._lookup=`HCGP`}run(){return super.run()}},D([eh(),A(`design:type`,Function),A(`design:paramtypes`,[]),A(`design:returntype`,void 0)],o7.prototype,`run`,null),o7=D([C()],o7)})),s7,c7,l7,u7,d7,f7,p7,m7,X_e=o((()=>{q_e(),B(),$(),Z(),bn(),E5(),w(),H(),J_e(),Y_e(),cw(),so(),fo(),j(),E(),O(),m7=class extends V{constructor(e,t,n,r,i,a,o){super(),this._site=e,this._adOptions=t,this._emailServiceProviderAPI=n,this._gatedPrintExperiment=r,this._config=i,this._gdprEnforcement=a,this._gdprEvents=o,T(this,`_startTask`,void 0)}get enabled(){var e;return this._forceTest||this._gatedPrintExperiment.result&&!!((e=this._adOptions.gatedPrint)!=null&&e.enabled)}start(){this._startTask=this.isIdentified().then(e=>{(this._forceTest||this.isPrintPage()&&!e)&&(this._config.gdpr.enabled?this._gdprEvents.consentResponseCaptured.on(()=>{let e=uo(this._config.gdpr.raptiveVendorId,[1]);e&&this.createModal()}):this.createModal())})}started(){var e;return(e=this._startTask)==null?Promise.resolve():e}get _forceTest(){let e=Hh().get(`test_gated_print`);return e===`true`||e===`1`}get gatedPrintClasses(){var e,t;return[`wprm-print`,`wprm-print-recipe`,`tasty-recipes-print-view`,`dr-print-outer-wrap`,`mv-create-print-view`,...(e=(t=this._adOptions.gatedPrint)==null?void 0:t.printClasses)==null?[]:e]}isPrintPage(){return this.gatedPrintClasses.some(e=>!!document.querySelector(`.${e}`))}async isIdentified(){var e,t;let n=await yK(!0);if(!n)return!1;let r=((e=n.graph1p)==null||(e=e.d)==null?void 0:e.bridgingMethod)===`rcid`,i=((t=n.direct)==null||(t=t.d)==null?void 0:t.collectionMethod)===`direct`;return r||i}createModal(){var e,t,n;let r=(e=(t=this._adOptions.gatedPrint)==null?void 0:t.newsletterPromptEnabled)==null?!1:e,i=r&&((n=this._adOptions.gatedPrint)==null?void 0:n.defaultOptIn);M.event(`GatedPrintComponent`,`createModal`,`Gated print modal is enabled`);let a=r?`
      <div class="raptive-gated-print-modal-checkbox-container">
        <input
          id="raptive-gated-print-modal-checkbox"
          class="raptive-gated-print-modal-checkbox"
          type="checkbox"
          name="newsletter"
          ${i?`checked`:``}
        />
        <label
          for="raptive-gated-print-modal-checkbox"
          class="raptive-gated-print-modal-checkbox-label"
        >
          Subscribe to newsletter 
        </label>
      </div>
      `:`<span></span>`,o=T5`
      <div class="raptive-gated-print-modal-container" style="display: block">
        <div class="raptive-gated-print-modal-content">
          <span class="raptive-gated-print-modal-title">
            Get instant access to printable posts
          </span>
          <span class="raptive-gated-print-modal-body">
            Enter your email below to access the printable version of every post on my
            site.
          </span>
          <form id="raptive-gated-print-modal-form" novalidate>
            <input
              id="raptive-gated-print-modal-input"
              class="raptive-gated-print-modal-input"
              type="email"
              name="email"
              inputmode="email"
              autocomplete="email"
              placeholder="Email*"
              required
            />

            <div id="raptive-gated-print-modal-actions" class="raptive-gated-print-modal-actions">
              ${a}
              <button
                id="raptive-gated-print-modal-button"
                class="raptive-gated-print-modal-button"
                type="submit"
                disabled
              >
                PRINT
              </button>
            </div>
          </form>
        </div>
      </div>
      `,s=yn(`div`,void 0,void 0,o),c=s.querySelector(`.raptive-gated-print-modal-container`),l=s.querySelector(`#raptive-gated-print-modal-form`),u=l==null?void 0:l.querySelector(`#raptive-gated-print-modal-input`),d=l==null?void 0:l.querySelector(`#raptive-gated-print-modal-button`),f=l==null?void 0:l.querySelector(`#raptive-gated-print-modal-checkbox`);if(!c||!u||!d||!l){M.error(`GatedPrintComponent`,`createModal`,`Failed to create gated print modal`);return}l.onsubmit=e=>{var t;e.preventDefault();let n=u.value;d&&(d.disabled=!0,d.innerText=`Submitting...`),this._submitEmail(n,(t=f==null?void 0:f.checked)==null?!1:t).then(()=>{c&&(c.style.display=`none`)})},u.oninput=()=>{d.disabled=!HW(u.value)},document.body.appendChild(s)}async _submitEmail(e,t){if(!HW(e)){M.error(`GatedPrintComponent`,`_submitEmail`,`Invalid email address`,this._site.id);return}if(!t){M.event(`GatedPrintComponent`,`_submitEmail`,`Newsletter checkbox is not checked, not subscribing user`,this._site.id);return}let n=0;for(;n<=1;)try{var r;await this._emailServiceProviderAPI.subscribe({email:e,source:`gated-print`,site_esp_id:(r=this._adOptions.gatedPrint)==null?void 0:r.siteEmailServiceProviderId,site_id:this._site.id}),M.event(`GatedPrintComponent`,`_submitEmail`,`Successfully registered email for newsletter`,this._site.id);return}catch(e){M.error(`GatedPrintComponent`,`_submitEmail`,`Error registering email for print on site ${this._site.id}`,e),n++,n<=1&&await new Promise(e=>setTimeout(e,1e3))}M.error(`GatedPrintComponent`,`_submitEmail`,`Failed to register email for print on site ${this._site.id} after 1 attempts`)}},m7=D([Q(`GatedPrintComponent`),S(),A(`design:paramtypes`,[typeof(s7=qa!==void 0&&qa)==`function`?s7:Object,typeof(c7=Ci!==void 0&&Ci)==`function`?c7:Object,typeof(l7=a7!==void 0&&a7)==`function`?l7:Object,typeof(u7=o7!==void 0&&o7)==`function`?u7:Object,typeof(d7=z!==void 0&&z)==`function`?d7:Object,typeof(f7=ow!==void 0&&ow)==`function`?f7:Object,typeof(p7=oo!==void 0&&oo)==`function`?p7:Object])],m7)})),h7,Z_e=o((()=>{w(),mU(),O(),h7=class extends pU{init(){this._key=`RefreshUserIdsDebounce`,this._lookup=`REFDEB`}},h7=D([C()],h7)})),g7,_7,v7,y7,Q_e=o((()=>{rU(),H(),jc(),w(),IK(),Lt(),Z_e(),j(),E(),O(),y7=class extends V{constructor(e,t,n){super(),this._userIdEventBus=e,this._prebidMethods=t,this._debounceExperiment=n,T(this,`_requestQueue`,[]),T(this,`_isProcessingQueue`,!1),T(this,`_pendingSubmodules`,new Set),T(this,`_debounceTimer`,null),T(this,`_callbackMap`,new Map),T(this,`_debounceTimeout`,150),this._debounceTimeout=this._debounceExperiment.result}init(){this._userIdEventBus.userIdNeedsRefresh.on(e=>{this._collectRefreshRequest(e)})}_collectRefreshRequest(e){e.options.submoduleNames.forEach(t=>{this._pendingSubmodules.add(t),e.callback&&this._callbackMap.set(t,e.callback)}),this._debounceTimer==null&&(this._debounceTimer=window.setTimeout(()=>{let e=Array.from(this._pendingSubmodules),t=Array.from(this._callbackMap.values());this._pendingSubmodules.clear(),this._callbackMap.clear(),this._debounceTimer=null,this._enqueueRequest({options:{submoduleNames:e},callback:()=>t.forEach(e=>e==null?void 0:e())})},this._debounceTimeout))}_enqueueRequest(e){this._requestQueue.push(e),this._isProcessingQueue||this._processQueue().catch(e=>{M.error(`RefreshUserIdsComponent`,`_enqueueRequest`,`Error processing request queue`,e)})}async _processQueue(){if(this._requestQueue.length===0){this._isProcessingQueue=!1;return}let e=this._requestQueue.shift();if(!e){this._isProcessingQueue=!1;return}return this._isProcessingQueue=!0,await this._prebidMethods.refreshUserIds(e.options,e.callback),this._processQueue()}},y7=D([Q(`RefreshUserIdsComponent`),C(),A(`design:paramtypes`,[typeof(g7=Lr!==void 0&&Lr)==`function`?g7:Object,typeof(_7=R!==void 0&&R)==`function`?_7:Object,typeof(v7=h7!==void 0&&h7)==`function`?v7:Object])],y7)})),b7,$_e=o((()=>{bt(),w(),wt(),E(),O(),b7=class extends Ct{constructor(...e){super(...e),T(this,`velocityChange`,new k)}},b7=D([C()],b7)})),x7,S7,C7,eve=o((()=>{w(),H(),Na(),$_e(),j(),E(),O(),C7=class extends V{constructor(e,t){super(),this._pageManager=e,this._scrollVelocityTrackerEventBus=t,T(this,`_lastScrollTop`,0),T(this,`_lastTimestamp`,0),T(this,`_scrollVelocityPxPerMs`,0),T(this,`_scrollStopTimeout`,null)}get enabled(){return!1}init(){this._lastScrollTop=window.scrollY,this._lastTimestamp=performance.now(),this._pageManager.scroll.on(()=>this._handleScroll())}_handleScroll(){this._calculateScrollVelocity(),this._scrollStopTimeout&&clearTimeout(this._scrollStopTimeout),this._scrollStopTimeout=setTimeout(()=>{this._scrollVelocityPxPerMs=0,this._scrollVelocityTrackerEventBus.velocityChange.emit(this._scrollVelocityPxPerMs)},200)}_calculateScrollVelocity(){let e=performance.now(),t=window.scrollY,n=e-this._lastTimestamp,r=t-this._lastScrollTop;if(this._userScrolled(n,r)){let e=r/n;this._scrollVelocityPxPerMs=.5*this._scrollVelocityPxPerMs+.5*e,this._scrollVelocityTrackerEventBus.velocityChange.emit(this._scrollVelocityPxPerMs)}this._lastScrollTop=t,this._lastTimestamp=e}get scrollVelocityPxPerMs(){return this._scrollVelocityPxPerMs}_userScrolled(e,t){return e>0&&t!==0}},C7=D([S(),A(`design:paramtypes`,[typeof(x7=ja!==void 0&&ja)==`function`?x7:Object,typeof(S7=b7!==void 0&&b7)==`function`?S7:Object])],C7)})),w7,T7,E7,tve=o((()=>{H(),Wr(),$(),vh(),Ia(),w(),j(),O(),E7=class extends V{constructor(e,t){super(),this._slotManagerEventBus=e,this._slots=t}init(){this._slotManagerEventBus.added.on(e=>{let t=this._slots.get(e);t.forEach(e=>{e.element.classList.add(`adthrive-ad-debug`),e.element.addEventListener(`click`,()=>{console.warn(`%c Debug Info for ${e.id}`,`background: #6B65FF; color: #F0EDEB; padding: 1px; border-radius: 3px;`,e)})})})}get enabled(){let e=Fa(`at_ui_debug`);return e===`true`||e===`1`}},E7=D([Q(`UIDebugComponent`),C(),A(`design:paramtypes`,[typeof(w7=Ur!==void 0&&Ur)==`function`?w7:Object,typeof(T7=_h!==void 0&&_h)==`function`?T7:Object])],E7)})),D7,O7,nve=o((()=>{w(),H(),rU(),Z(),j(),O(),O7=class extends V{constructor(e){super(),this._footerEventBus=e}init(){this._footerEventBus.footerRenderEnded.on(e=>{e&&setTimeout(()=>{this._checkIsFooterRibbon()},500)})}_checkIsFooterRibbon(){let e=document.querySelectorAll(`.raptive-sales.raptive-sales-footer.raptive-sales-vidrbn`);e.length?this._footerEventBus.footerVideoRibbonStateChanged.emit(!0):this._footerEventBus.footerVideoRibbonStateChanged.emit(!1)}get enabled(){return tG()}},O7=D([S(),A(`design:paramtypes`,[typeof(D7=xr!==void 0&&xr)==`function`?D7:Object])],O7)})),k7,A7,j7,M7,rve=o((()=>{w(),H(),Bh(),vh(),$(),X(),Z(),us(),j(),E(),O(),M7=class extends V{constructor(e,t,n){super(),this._gamEventBus=e,this._emailCaptureEventBus=t,this._slots=n,T(this,`_adsOfInterest`,new Set([F.Footer,F.Video_StickyInstream,F.Video_StickyOutstream])),T(this,`_viewportSize`,[window.innerWidth,window.innerHeight]),T(this,`_slickstreamHeartbeat`,null),T(this,`_emailServiceProviderSelectors`,new Set([`div[id$="-optin"]`])),T(this,`_loggedEmailPopups`,new Set(`div[id$="-optin"]`)),T(this,`_deviceType`,aG()),T(this,`operatingSystem`,kG())}init(){this._gamEventBus.slotOnload.on(({slotId:e})=>this._getAdCoverage(e)),this._slickstreamHeartbeat=document.querySelector(`slick-heartbeat`),this._addOptinMonsterPopupEventListener()}start(){this._getSlickstreamCoverage()}_getSlickstreamCoverage(){let e=this._slickstreamHeartbeat&&this._slickstreamHeartbeat.shadowRoot;if(e){let t=e.querySelector(`#iconsPanel`);t&&this._logCoverage(`slickstream`,{panelSize:this._getSizeFromElement(t)})}}_addOptinMonsterPopupEventListener(){this._emailCaptureEventBus.selectorFound.on(e=>{this._emailServiceProviderSelectors.has(e.selector)&&this._getEmailCoverage(e)})}_getEmailCoverage(e){let{selector:t,providerName:n,divs:r}=e;r.length&&r.forEach(e=>{if(!this._loggedEmailPopups.has(e.id)){let r=this._getSizeFromElement(e);this._logCoverage(`email`,{divSelector:t,size:r,divId:e.id,providerName:n}),this._loggedEmailPopups.add(e.id)}})}_getAdCoverage(e){let t=this._slots.get(e);t&&this._adsOfInterest.has(t.location)&&setTimeout(()=>{let e=this._getAdDimensions(t);this._logCoverage(`ad`,e)},2e3)}_getAdDimensions(e){var t,n,r,i;let a=(t=e.googleTagSlot.getTargeting(`hb_size`)[0])==null?``:t,o=(n=e.googleTagSlot.getTargeting(`hb_bidder`)[0])==null?``:n,s=this._getSizeFromElement(e.element),c=(r=e.element.firstElementChild)==null?void 0:r.cloneNode(!0),l=this._getSizeFromElement(c),u=(i=c.firstElementChild)==null?void 0:i.cloneNode(!0),d=this._getSizeFromElement(u);return e.location.includes(F.Video_StickyOutstream)?{adSlotSize:s,hbSize:a,gptContainerSize:l,iframeSize:d,stickyOutstreamContainerSize:this._getStickyOutstreamContainerSize(),hbBidder:o,location:e.location}:{adSlotSize:s,hbSize:a,gptContainerSize:l,iframeSize:d,hbBidder:o,location:e.location}}_getSizeFromElement(e){let t=[this._getSizeFromRectangle.bind(this),this._getSizeFromOffsetProperties.bind(this),this._getSizeFromNamedWidthAndHeightAttributes.bind(this),this._getSizeFromNamedStyleAttribute.bind(this)];for(let n of t){let t=n(e);if(!this._invalidSize(t))return t}return[-1,-1]}_getSizeFromRectangle(e){let t=e.getBoundingClientRect(),n=t.height,r=t.width;return[r,n]}_getSizeFromOffsetProperties(e){return[e.offsetWidth,e.offsetHeight]}_getSizeFromNamedWidthAndHeightAttributes(e){var t,n,r,i;let a=+((t=(n=e.attributes.getNamedItem(`width`))==null?void 0:n.nodeValue)==null?-1:t),o=+((r=(i=e.attributes.getNamedItem(`height`))==null?void 0:i.nodeValue)==null?-1:r);return[a,o]}_getSizeFromNamedStyleAttribute(e){var t;let n=(t=e.attributes.getNamedItem(`style`))==null?void 0:t.nodeValue,r=[-1,-1];return n==null||n.replace(/\s/g,``).split(`;`).forEach(e=>{let[t,n]=e.split(`:`);t===`width`?r[0]=parseInt(n):t===`height`&&(r[1]=parseInt(n))}),r}_getStickyOutstreamContainerSize(){let e=document.querySelector(`#adthrive-stickyoutstream-container`);if(e){let t=this._getSizeFromElement(e);return t}}_logCoverage(e,t){M.event(`ViewportCoverageComponent`,`_logCoverage`,this._constructLog(e,t))}_constructLog(e,t){return{coverageType:e,data:t,viewportSize:this._viewportSize,deviceType:this._deviceType,operatingSystem:this.operatingSystem}}_invalidSize(e){let[t,n]=e;return n===t&&t<=1||!n||!t}},M7=D([C(),A(`design:paramtypes`,[typeof(k7=zh!==void 0&&zh)==`function`?k7:Object,typeof(A7=ls!==void 0&&ls)==`function`?A7:Object,typeof(j7=_h!==void 0&&_h)==`function`?j7:Object])],M7)})),N7,P7,F7,ive=o((()=>{B(),Ma(),IK(),Z(),w(),H(),j(),E(),O(),F7=class extends V{constructor(e,t){super(),this._pageManager=e,this._adOptions=t,T(this,`_wakeLock`,null),T(this,`_timeoutId`,null),T(this,`_mobileDefaultDuration`,15),T(this,`_desktopDefaultDuration`,30),T(this,`convertMinutesToMilliseconds`,e=>e*60*1e3)}init(){this._pageManager.visibilityChange.on(this._handleVisibilityChange.bind(this))}async start(){$t()?this._pageManager.setupOnceEvent(`click`,()=>void this._acquireWakeLock()):await this._acquireWakeLock()}async _handleVisibilityChange(){this._wakeLock!==null&&document.visibilityState===`visible`&&await this._acquireWakeLock()}_getMaxDurationMinutes(){if(Ei()){var e,t;return(e=(t=this._adOptions.wakeLock)==null?void 0:t.desktopValue)==null?this._desktopDefaultDuration:e}else{var n,r;return(n=(r=this._adOptions.wakeLock)==null?void 0:r.mobileValue)==null?this._mobileDefaultDuration:n}}async _acquireWakeLock(){try{this._wakeLock=await navigator.wakeLock.request(`screen`),this._wakeLock.addEventListener(`release`,()=>{this._timeoutId&&clearTimeout(this._timeoutId)});let e=this._getMaxDurationMinutes()*1.1;this._timeoutId=setTimeout(()=>{this._wakeLock&&this._wakeLock.release().then(()=>{this._wakeLock=null})},this.convertMinutesToMilliseconds(e))}catch(e){}}get enabled(){let e=`wakeLock`in navigator;return e&&this._wakeLockEnabledInAdOptions()}_wakeLockEnabledInAdOptions(){return this._adOptions.wakeLock===void 0?!0:this._adOptions.wakeLock===null?!1:tG()||rG()?this._adOptions.wakeLock.mobileEnabled:Ei()?this._adOptions.wakeLock.desktopEnabled:!0}},F7=D([C(),Q(`WakeLockComponent`),A(`design:paramtypes`,[typeof(N7=ja!==void 0&&ja)==`function`?N7:Object,typeof(P7=Ci!==void 0&&Ci)==`function`?P7:Object])],F7)})),I7,L7,R7,z7,B7,V7,H7,U7,W7,G7,K7,q7,J7,Y7,X7,Z7,Q7,$7,e9,t9,ave,n9,r9,i9,a9,o9,ove,sve,s9,c9,l9,cve,u9,lve,d9,f9,p9,uve,m9,dve,h9,g9,fve,_9,v9,y9,b9,x9,S9,pve,C9,mve,w9,T9,hve,E9,D9,gve,O9,k9,_ve,A9,vve,yve,bve,j9,xve,M9,N9,Sve,P9,F9,Cve,wve,Tve=o((()=>{R7=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType(`navigation`)[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},z7=function(e){if(document.readyState===`loading`)return`loading`;var t=R7();if(t){if(e<t.domInteractive)return`loading`;if(t.domContentLoadedEventStart===0||e<t.domContentLoadedEventStart)return`dom-interactive`;if(t.domComplete===0||e<t.domComplete)return`dom-content-loaded`}return`complete`},B7=function(e){var t=e.nodeName;return e.nodeType===1?t.toLowerCase():t.toUpperCase().replace(/^#/,``)},V7=function(e,t){var n=``;try{for(;e&&e.nodeType!==9;){var r=e,i=r.id?`#`+r.id:B7(r)+(r.classList&&r.classList.value&&r.classList.value.trim()&&r.classList.value.trim().length?`.`+r.classList.value.trim().replace(/\s+/g,`.`):``);if(n.length+i.length>(t||100)-1)return n||i;if(n=n?i+`>`+n:i,r.id)break;e=r.parentNode}}catch(e){}return n},H7=-1,U7=function(){return H7},W7=function(e){addEventListener(`pageshow`,(function(t){t.persisted&&(H7=t.timeStamp,e(t))}),!0)},G7=function(){var e=R7();return e&&e.activationStart||0},K7=function(e,t){var n=R7(),r=`navigate`;return U7()>=0?r=`back-forward-cache`:n&&(document.prerendering||G7()>0?r=`prerender`:document.wasDiscarded?r=`restore`:n.type&&(r=n.type.replace(/_/g,`-`))),{name:e,value:t===void 0?-1:t,rating:`good`,delta:0,entries:[],id:`v4-${Date.now()}-${Math.floor(8999999999999*Math.random())+0xe8d4a51000}`,navigationType:r}},q7=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(e){}},J7=function(e,t,n,r){var i,a;return function(o){t.value>=0&&(o||r)&&((a=t.value-(i||0))||i===void 0)&&(i=t.value,t.delta=a,t.rating=function(e,t){return e>t[1]?`poor`:e>t[0]?`needs-improvement`:`good`}(t.value,n),e(t))}},Y7=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},X7=function(e){document.addEventListener(`visibilitychange`,(function(){document.visibilityState===`hidden`&&e()}))},Z7=function(e){var t=!1;return function(){t||(e(),t=!0)}},Q7=-1,$7=function(){return document.visibilityState!==`hidden`||document.prerendering?1/0:0},e9=function(e){document.visibilityState===`hidden`&&Q7>-1&&(Q7=e.type===`visibilitychange`?e.timeStamp:0,ave())},t9=function(){addEventListener(`visibilitychange`,e9,!0),addEventListener(`prerenderingchange`,e9,!0)},ave=function(){removeEventListener(`visibilitychange`,e9,!0),removeEventListener(`prerenderingchange`,e9,!0)},n9=function(){return Q7<0&&(Q7=$7(),t9(),W7((function(){setTimeout((function(){Q7=$7(),t9()}),0)}))),{get firstHiddenTime(){return Q7}}},r9=function(e){document.prerendering?addEventListener(`prerenderingchange`,(function(){return e()}),!0):e()},i9=[1800,3e3],a9=function(e,t){t=t||{},r9((function(){var n,r=n9(),i=K7(`FCP`),a=q7(`paint`,(function(e){e.forEach((function(e){e.name===`first-contentful-paint`&&(a.disconnect(),e.startTime<r.firstHiddenTime&&(i.value=Math.max(e.startTime-G7(),0),i.entries.push(e),n(!0)))}))}));a&&(n=J7(e,i,i9,t.reportAllChanges),W7((function(r){i=K7(`FCP`),n=J7(e,i,i9,t.reportAllChanges),Y7((function(){i.value=performance.now()-r.timeStamp,n(!0)}))})))}))},o9=[.1,.25],ove=function(e,t){(function(e,t,n){t=t||{},a9(Z7((function(){var r,i=K7(`CLS`,0),a=0,o=[],s=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=o[0],r=o[o.length-1];a&&e.startTime-r.startTime<1e3&&e.startTime-t.startTime<5e3?(a+=e.value,o.push(e)):(a=e.value,o=[e])}if(n&&typeof n==`function`){var i=e.sources.map((function(e){var t=e.node,n=e.previousRect,r=e.currentRect;return{target:V7(t),previousRect:n,currentRect:r}}));n(Object.assign(e.toJSON(),{sources:i}))}})),a>i.value&&(i.value=a,i.entries=o,r())},c=q7(`layout-shift`,s);c&&(r=J7(e,i,o9,t.reportAllChanges),X7((function(){s(c.takeRecords()),r(!0)})),W7((function(){a=0,i=K7(`CLS`,0),r=J7(e,i,o9,t.reportAllChanges),Y7((function(){return r()}))})),setTimeout(r,0))})))})((function(t){var n=function(e){var t,n={};if(e.entries.length){var r=e.entries.reduce((function(e,t){return e&&e.value>t.value?e:t}));if(r&&r.sources&&r.sources.length){var i=(t=r.sources).find((function(e){return e.node&&e.node.nodeType===1}))||t[0];i&&(n={largestShiftTarget:V7(i.node),largestShiftTime:r.startTime,largestShiftValue:r.value,largestShiftSource:i,largestShiftEntry:r,loadState:z7(r.startTime)})}}return Object.assign(e,{attribution:n})}(t);e(n)}),t)},sve=function(e,t){a9((function(t){var n=function(e){var t={timeToFirstByte:0,firstByteToFCP:e.value,loadState:z7(U7())};if(e.entries.length){var n=R7(),r=e.entries[e.entries.length-1];if(n){var i=n.activationStart||0,a=Math.max(0,n.responseStart-i);t={timeToFirstByte:a,firstByteToFCP:e.value-a,loadState:z7(e.entries[0].startTime),navigationEntry:n,fcpEntry:r}}}return Object.assign(e,{attribution:t})}(t);e(n)}),t)},s9=0,c9=1/0,l9=0,cve=function(e){e.forEach((function(e){e.interactionId&&(c9=Math.min(c9,e.interactionId),l9=Math.max(l9,e.interactionId),s9=l9?(l9-c9)/7+1:0)}))},u9=function(){return I7?s9:performance.interactionCount||0},lve=function(){`interactionCount`in performance||I7||(I7=q7(`event`,cve,{type:`event`,buffered:!0,durationThreshold:0}))},d9=[],f9=new Map,p9=0,uve=function(){var e=Math.min(d9.length-1,Math.floor((u9()-p9)/50));return d9[e]},m9=[],dve=function(e){if(m9.forEach((function(t){return t(e)})),e.interactionId||e.entryType===`first-input`){var t=d9[d9.length-1],n=f9.get(e.interactionId);if(n||d9.length<10||e.duration>t.latency){if(n)e.duration>n.latency?(n.entries=[e],n.latency=e.duration):e.duration===n.latency&&e.startTime===n.entries[0].startTime&&n.entries.push(e);else{var r={id:e.interactionId,latency:e.duration,entries:[e]};f9.set(r.id,r),d9.push(r)}d9.sort((function(e,t){return t.latency-e.latency})),d9.length>10&&d9.splice(10).forEach((function(e){return f9.delete(e.id)}))}}},h9=function(e){var t=self.requestIdleCallback||self.setTimeout,n=-1;return e=Z7(e),document.visibilityState===`hidden`?e():(n=t(e),X7(e)),n},g9=[200,500],fve=function(e,t){`PerformanceEventTiming`in self&&`interactionId`in PerformanceEventTiming.prototype&&(t=t||{},r9((function(){var n;lve();var r,i=K7(`INP`),a=function(e){h9((function(){e.forEach(dve);var t=uve();t&&t.latency!==i.value&&(i.value=t.latency,i.entries=t.entries,r())}))},o=q7(`event`,a,{durationThreshold:(n=t.durationThreshold)==null?40:n});r=J7(e,i,g9,t.reportAllChanges),o&&(o.observe({type:`first-input`,buffered:!0}),X7((function(){a(o.takeRecords()),r(!0)})),W7((function(){p9=u9(),d9.length=0,f9.clear(),i=K7(`INP`),r=J7(e,i,g9,t.reportAllChanges)})))})))},_9=[],v9=[],y9=0,b9=new WeakMap,x9=new Map,S9=-1,pve=function(e){_9=_9.concat(e),C9()},C9=function(){S9<0&&(S9=h9(mve))},mve=function(){x9.size>10&&x9.forEach((function(e,t){f9.has(t)||x9.delete(t)}));var e=d9.map((function(e){return b9.get(e.entries[0])})),t=v9.length-50;v9=v9.filter((function(n,r){return r>=t||e.includes(n)}));for(var n=new Set,r=0;r<v9.length;r++){var i=v9[r];D9(i.startTime,i.processingEnd).forEach((function(e){n.add(e)}))}var a=_9.length-1-50;_9=_9.filter((function(e,t){return e.startTime>y9&&t>a||n.has(e)})),S9=-1},m9.push((function(e){e.interactionId&&e.target&&!x9.has(e.interactionId)&&x9.set(e.interactionId,e.target)}),(function(e){var t,n=e.startTime+e.duration;y9=Math.max(y9,e.processingEnd);for(var r=v9.length-1;r>=0;r--){var i=v9[r];if(Math.abs(n-i.renderTime)<=8){(t=i).startTime=Math.min(e.startTime,t.startTime),t.processingStart=Math.min(e.processingStart,t.processingStart),t.processingEnd=Math.max(e.processingEnd,t.processingEnd),t.entries.push(e);break}}t||(t={startTime:e.startTime,processingStart:e.processingStart,processingEnd:e.processingEnd,renderTime:n,entries:[e]},v9.push(t)),(e.interactionId||e.entryType===`first-input`)&&b9.set(e,t),C9()})),D9=function(e,t){for(var n,r=[],i=0;n=_9[i];i++)if(!(n.startTime+n.duration<e)){if(n.startTime>t)break;r.push(n)}return r},gve=function(e,t){L7||(L7=q7(`long-animation-frame`,pve)),fve((function(t){var n=function(e){var t=e.entries[0],n=b9.get(t),r=t.processingStart,i=n.processingEnd,a=n.entries.sort((function(e,t){return e.processingStart-t.processingStart})),o=D9(t.startTime,i),s=e.entries.find((function(e){return e.target})),c=s&&s.target||x9.get(t.interactionId),l=[t.startTime+t.duration,i].concat(o.map((function(e){return e.startTime+e.duration}))),u=Math.max.apply(Math,l),d={interactionTarget:V7(c),interactionTargetElement:c,interactionType:t.name.startsWith(`key`)?`keyboard`:`pointer`,interactionTime:t.startTime,nextPaintTime:u,processedEventEntries:a,longAnimationFrameEntries:o,inputDelay:r-t.startTime,processingDuration:i-r,presentationDelay:Math.max(u-i,0),loadState:z7(t.startTime)};return Object.assign(e,{attribution:d})}(t);e(n)}),t)},O9=[2500,4e3],k9={},_ve=function(e,t){(function(e,t,n){t=t||{},r9((function(){var r,i=n9(),a=K7(`LCP`),o=function(e){t.reportAllChanges||(e=e.slice(-1)),e.forEach((function(e){e.startTime<i.firstHiddenTime&&(a.value=Math.max(e.startTime-G7(),0),n&&n(e,a.value,V7(e.element)),a.entries=[e],r())}))},s=q7(`largest-contentful-paint`,o);if(s){r=J7(e,a,O9,t.reportAllChanges);var c=Z7((function(){k9[a.id]||(o(s.takeRecords()),s.disconnect(),k9[a.id]=!0,r(!0))}));[`keydown`,`click`].forEach((function(e){addEventListener(e,(function(){return h9(c)}),{once:!0,capture:!0})})),X7(c),W7((function(n){a=K7(`LCP`),r=J7(e,a,O9,t.reportAllChanges),Y7((function(){a.value=performance.now()-n.timeStamp,k9[a.id]=!0,r(!0)}))}))}}))})((function(t){var n=function(e){var t={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:e.value};if(e.entries.length){var n=R7();if(n){var r=n.activationStart||0,i=e.entries[e.entries.length-1],a=i.url&&performance.getEntriesByType(`resource`).filter((function(e){return e.name===i.url}))[0],o=Math.max(0,n.responseStart-r),s=Math.max(o,a?(a.requestStart||a.startTime)-r:0),c=Math.max(s,a?a.responseEnd-r:0),l=Math.max(c,i.startTime-r);t={element:V7(i.element),timeToFirstByte:o,resourceLoadDelay:s-o,resourceLoadDuration:c-s,elementRenderDelay:l-c,navigationEntry:n,lcpEntry:i},i.url&&(t.url=i.url),a&&(t.lcpResourceEntry=a)}}return Object.assign(e,{attribution:t})}(t);e(n)}),t)},A9=[800,1800],vve=function e(t){document.prerendering?r9((function(){return e(t)})):document.readyState===`complete`?setTimeout(t,0):addEventListener(`load`,(function(){return e(t)}),!0)},yve=function(e,t){t=t||{};var n=K7(`TTFB`),r=J7(e,n,A9,t.reportAllChanges);vve((function(){var i=R7();i&&(n.value=Math.max(i.responseStart-G7(),0),n.entries=[i],r(!0),W7((function(){n=K7(`TTFB`,0),(r=J7(e,n,A9,t.reportAllChanges))(!0)})))}))},bve=function(e,t){yve((function(t){var n=function(e){var t={waitingDuration:0,cacheDuration:0,dnsDuration:0,connectionDuration:0,requestDuration:0};if(e.entries.length){var n=e.entries[0],r=n.activationStart||0,i=Math.max((n.workerStart||n.fetchStart)-r,0),a=Math.max(n.domainLookupStart-r,0),o=Math.max(n.connectStart-r,0),s=Math.max(n.connectEnd-r,0);t={waitingDuration:i,cacheDuration:a-i,dnsDuration:o-a,connectionDuration:s-o,requestDuration:e.value-s,navigationEntry:n}}return Object.assign(e,{attribution:t})}(t);e(n)}),t)},j9={passive:!0,capture:!0},xve=new Date,M9=function(e,t){w9||(w9=t,T9=e,hve=new Date,P9(removeEventListener),N9())},N9=function(){if(T9>=0&&T9<hve-xve){var e={entryType:`first-input`,name:w9.type,target:w9.target,cancelable:w9.cancelable,startTime:w9.timeStamp,processingStart:w9.timeStamp+T9};E9.forEach((function(t){t(e)})),E9=[]}},Sve=function(e){if(e.cancelable){var t=(e.timeStamp>0xe8d4a51000?new Date:performance.now())-e.timeStamp;e.type==`pointerdown`?function(e,t){var n=function(){M9(e,t),i()},r=function(){i()},i=function(){removeEventListener(`pointerup`,n,j9),removeEventListener(`pointercancel`,r,j9)};addEventListener(`pointerup`,n,j9),addEventListener(`pointercancel`,r,j9)}(t,e):M9(t,e)}},P9=function(e){[`mousedown`,`keydown`,`touchstart`,`pointerdown`].forEach((function(t){return e(t,Sve,j9)}))},F9=[100,300],Cve=function(e,t){t=t||{},r9((function(){var n,r=n9(),i=K7(`FID`),a=function(e){e.startTime<r.firstHiddenTime&&(i.value=e.processingStart-e.startTime,i.entries.push(e),n(!0))},o=function(e){e.forEach(a)},s=q7(`first-input`,o);n=J7(e,i,F9,t.reportAllChanges),s&&(X7(Z7((function(){o(s.takeRecords()),s.disconnect()}))),W7((function(){var r;i=K7(`FID`),n=J7(e,i,F9,t.reportAllChanges),E9=[],T9=-1,w9=null,P9(addEventListener),r=a,E9.push(r),N9()})))}))},wve=function(e,t){Cve((function(t){var n=function(e){var t=e.entries[0],n={eventTarget:V7(t.target),eventType:t.name,eventTime:t.startTime,eventEntry:t,loadState:z7(t.startTime)};return Object.assign(e,{attribution:n})}(t);e(n)}),t)}})),I9,Eve=o((()=>{w(),Ui(),E(),O(),I9=class extends Hi{constructor(...e){super(...e),T(this,`_default`,!1)}init(){this._key=`INPExperiment`,this._lookup=`INP`}},I9=D([C()],I9)})),Dve,L9,Ove=o((()=>{w(),Tve(),Eve(),H(),dn(),$(),j(),O(),L9=class extends V{constructor(e){super(),this.inpExperiment=e}init(){gve(this.logInpWithAttribution.bind(this),{reportAllChanges:!0})}logInpWithAttribution(e){M.event(`AttributionINPComponent`,`logInpWithAttribution`,e)}get enabled(){return Zt()&&this.inpExperiment.result}},L9=D([Q(`AttributionINPComponent`),C(),A(`design:paramtypes`,[typeof(Dve=I9!==void 0&&I9)==`function`?Dve:Object])],L9)})),kve,Ave,jve,R9,z9,Mve=o((()=>{w(),$(),H(),Na(),xG(),Ft(),Eve(),j(),E(),O(),R9={good:`good`,needsImprovement:`needs improvement`,poor:`poor`},z9=class extends V{constructor(e,t,n){super(),this._pageManager=e,this._loggerEventBus=t,this._inpExperiment=n,T(this,`_existingInteractions`,new Map),T(this,`_totalInteractionEvents`,0),T(this,`_observer`,void 0),T(this,`_maxCharsAvailableInSendEvent`,0),T(this,`_currentContextualDataSize`,0),T(this,`_lengthOfCurrentLogRequest`,0),T(this,`_logData`,{INPData:[]})}init(){this._observer=this._createPerformanceObserver(),this._observer.observe({type:`event`,buffered:!0,durationThreshold:0}),this._pageManager.pageHide.on(()=>{this._logINPEventsData(),this._logINPCounts()}),this._currentContextualDataSize=encodeURIComponent(JSON.stringify(M.data)).length,this._setMaxCharsAvailableToLog(),this._loggerEventBus.newContextDataEncodingSize.on(e=>this._updateCharLimits(e))}_createPerformanceObserver(){return new PerformanceObserver(e=>{e.getEntries().forEach(e=>{this._isEntryPerformanceEventTimingType(e)&&this._hasNonZeroInteractionId(e)&&this._processEntry(e)})})}_processEntry(e){let t=e.interactionId,n=this._getInteractionEventInfo(e),r=this._existingInteractions.get(t);(!r||n.inp>r.maxINP)&&this._updateINPForInteraction(t,n);let i={...n,interactionId:t};this._updateINPLog(i),this._totalInteractionEvents++}_isEntryPerformanceEventTimingType(e){return e.entryType===`event`}_hasNonZeroInteractionId(e){return!!e.interactionId&&e.interactionId!==0}_getInteractionEventInfo(e){let t=e.duration,n=e.startTime,r=e.processingStart,i=e.processingEnd,a=e.target;return{inp:t,startTime:n,startDelay:r-n,processingStart:r,processingEnd:i,processingTime:i-r,...this._getTargetIdentifiers(a),qualitativeScore:this._getQualitativeINPScore(t),eventType:e.name}}_updateINPForInteraction(e,t){let n={maxINP:t.inp,qualitativeScore:t.qualitativeScore};this._existingInteractions.set(e,n)}_setMaxCharsAvailableToLog(){let e=M.buildRequestUrl(`event`,`INPComponent`,`_logINPEventsData`,[]).length,t=this._calculateCharsOfEncodedDataObject(this._logData)+this._calculateCharsFromEncodedCommas(1);this._maxCharsAvailableInSendEvent=M.maxCloudFrontUrlSize-e-t}_updateCharLimits(e){let t=this._maxCharsAvailableInSendEvent;this._maxCharsAvailableInSendEvent+=this._currentContextualDataSize-e,this._currentContextualDataSize=e,this._maxCharsAvailableInSendEvent<t&&this._lengthOfCurrentLogRequest>=this._maxCharsAvailableInSendEvent&&this._saveExcessEventsAndLogRemaining()}_saveExcessEventsAndLogRemaining(){let e=[];for(;this._lengthOfCurrentLogRequest>=this._maxCharsAvailableInSendEvent;){let t=this._logData.INPData.pop();if(t){e.push(t);let n=this._countAdditionalEncodedChars(t);this._lengthOfCurrentLogRequest-=n}}e.forEach(e=>this._updateINPLog(e))}_countAdditionalEncodedChars(e){let t=!!this._logData.INPData.length,n=this._calculateCharsOfEncodedDataObject(e)+(t?this._calculateCharsFromEncodedCommas(1):0);return n}_updateINPLog(e){let t=this._countAdditionalEncodedChars(e);t+this._lengthOfCurrentLogRequest>this._maxCharsAvailableInSendEvent&&(this._logINPEventsData(),this._clearLogData(),this._lengthOfCurrentLogRequest=0),this._addINPData(e),this._lengthOfCurrentLogRequest+=t}_addINPData(e){this._logData.INPData.push(e)}_logINPEventsData(){M.event(`INPComponent`,`_logINPEventsData`,this._logData)}_logINPCounts(){let e=-1/0;for(let[,t]of this._existingInteractions.entries())t.maxINP>e&&(e=t.maxINP);M.event(`INPComponent`,`_logINPCounts`,{...this._getNumberOfEventsAndInteractions(),maxINP:e})}_clearLogData(){this._logData.INPData.length=0}_calculateCharsOfEncodedDataObject(e){return encodeURIComponent(JSON.stringify(e)).length}_calculateCharsFromEncodedCommas(e){return e*3}_getTargetIdentifiers(e){let t={nodeIdentifier:``,innerText:``};return e instanceof HTMLElement?(t.nodeIdentifier=bG(e),t.innerText=e.innerText&&e.innerText.length<300?e.innerText:``,t):(e instanceof Node&&(t.nodeIdentifier=`node:${e.nodeName}`),t)}_getQualitativeINPScore(e){return e<=200?R9.good:e<=500?R9.needsImprovement:R9.poor}_getNumberOfEventsAndInteractions(){let e=this._existingInteractions.size;return{totalInteractions:e,totalInteractionEvents:this._totalInteractionEvents}}get enabled(){return`PerformanceObserver`in window&&PerformanceObserver&&PerformanceObserver.supportedEntryTypes.includes(`event`)&&`interactionId`in PerformanceEventTiming.prototype&&this._inpExperiment.result}},z9=D([Q(`INPComponent`),S(),A(`design:paramtypes`,[typeof(kve=ja!==void 0&&ja)==`function`?kve:Object,typeof(Ave=Pt!==void 0&&Pt)==`function`?Ave:Object,typeof(jve=I9!==void 0&&I9)==`function`?jve:Object])],z9)})),Nve,Pve,Fve,B9,Ive=o((()=>{$(),H(),B(),_a(),ua(),w(),Ua(),j(),O(),B9=class extends V{constructor(e,t,n){super(),this._marmalade=e,this._optableConfig=t,this._optableSdkWrapper=n}get enabled(){return this._optableConfig.enabled}start(){this._sendIABAToOptable()}async _sendIABAToOptable(){let e=this._marmalade.ortbSegments.get(`iaba`);if(!e||e.length===0)return;let t=e.map(e=>e.id).join(`,`);return await Ha(),await this._optableSdkWrapper.profile({iaba_segments:t})}},B9=D([Q(`OptableSidekickComponent`),S(),A(`design:paramtypes`,[typeof(Nve=mh!==void 0&&mh)==`function`?Nve:Object,typeof(Pve=ga!==void 0&&ga)==`function`?Pve:Object,typeof(Fve=la!==void 0&&la)==`function`?Fve:Object])],B9)})),Lve,Rve,zve,Bve,Vve,Hve,Uve,Wve,Gve,Kve,qve,Jve,Yve,Xve,Zve,Qve,$ve,eye,tye,nye,rye,iye,aye,oye,sye,cye,lye,uye,dye,fye,pye,mye,hye,gye,_ye,vye,yye,bye,xye,Sye,Cye,wye,Tye,Eye,Dye,Oye,kye,Aye,jye,Mye,Nye,Pye,Fye,Iye,Lye,Rye,zye,Bye,Vye,Hye,Uye,Wye,Gye,Kye,qye,Jye,Yye,Xye,Zye,Qye,$ye,ebe,tbe,nbe,rbe,ibe,abe,obe,sbe,cbe,lbe,ube,dbe,fbe,pbe,mbe,hbe,gbe,_be,vbe,ybe,bbe,V9,xbe=o((()=>{w(),$(),Yre(),dme(),mme(),_me(),bme(),wq(),Tme(),Dme(),kme(),Rme(),BJ(),Bme(),Hme(),Wme(),Vg(),Yme(),she(),lhe(),dhe(),QX(),hhe(),ghe(),vhe(),bhe(),whe(),Nhe(),Ihe(),Bhe(),Uhe(),Ghe(),oge(),Fre(),pge(),_ge(),yge(),Cge(),wge(),Ege(),AF(),nQ(),Oge(),$T(),_0(),Age(),Uge(),L3(),Jge(),$ge(),o_e(),g_e(),v_e(),b_e(),S_e(),E_e(),k_e(),A_e(),j_e(),M_e(),N_e(),P_e(),I_e(),R_e(),B_e(),V_e(),K_e(),X_e(),Q_e(),eve(),tve(),nve(),rve(),ive(),Ove(),Mve(),Ive(),j(),E(),O(),V9=class{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v,y,b,ee,te,ne,re,ie,ae,oe,se,ce,le,ue,de,fe,pe,me,he,ge,_e,ve,ye,be,xe,Se,Ce,we,Te,Ee,De,Oe,ke,eee,Ae,je,Me,Ne,Pe,Fe,Ie,Le,Re,ze,Be,Ve,He,Ue,We,Ge,Ke,qe,Je,Ye,Xe,Ze,Qe,$e,et,tt,nt,rt,x,it,at,ot,st,S,ct,lt,C,ut,dt,ft){T(this,`_components`,void 0),T(this,`_deferrableComponents`,void 0),this._components=[t,n,r,i,a,o,c,l,u,d,f,p,m,h,_,v,y,b,ee,te,ne,re,ie,ae,oe,se,ce,le,de,pe,ue,me,he,ge,_e,ve,ye,be,xe,Se,Ce,we,Te,nt,Ee,De,Oe,ke,eee,je,Me,Ne,Ae,Pe,Re,ft,ze,Be,Ve,fe,Ue,He,We,Ge,Ke,qe,Je,Xe,et,tt,x,ot,it,at,lt,C,dt],this._deferrableComponents=[s,S,g,Qe,Ye,e,ut,ct,Fe,Ie,Le,Ze,$e,st,rt]}init(e=!1){let t=e?this._deferrableComponents:this._components;t.forEach(e=>{try{e.init&&e.enabled&&e.init()}catch(t){M.error(`Components`,`init`,`${e.constructor.name} failed to initialize:`,t)}})}start(e=!1){let t=e?this._deferrableComponents:this._components;t.forEach(e=>{try{e.start&&e.enabled&&e.start()}catch(t){M.error(`Components`,`start`,`${e.constructor.name} failed to start:`,t)}})}},V9=D([Q(`Components`),S(),A(`design:paramtypes`,[typeof(Lve=k0!==void 0&&k0)==`function`?Lve:Object,typeof(Rve=tq!==void 0&&tq)==`function`?Rve:Object,typeof(zve=u6!==void 0&&u6)==`function`?zve:Object,typeof(Bve=lq!==void 0&&lq)==`function`?Bve:Object,typeof(Vve=iq!==void 0&&iq)==`function`?Vve:Object,typeof(Hve=Cq!==void 0&&Cq)==`function`?Hve:Object,typeof(Uve=f6!==void 0&&f6)==`function`?Uve:Object,typeof(Wve=kZ!==void 0&&kZ)==`function`?Wve:Object,typeof(Gve=w5!==void 0&&w5)==`function`?Gve:Object,typeof(Kve=k5!==void 0&&k5)==`function`?Kve:Object,typeof(qve=z6!==void 0&&z6)==`function`?qve:Object,typeof(Jve=kq!==void 0&&kq)==`function`?Jve:Object,typeof(Yve=Mq!==void 0&&Mq)==`function`?Yve:Object,typeof(Xve=L6!==void 0&&L6)==`function`?Xve:Object,typeof(Zve=Lq!==void 0&&Lq)==`function`?Zve:Object,typeof(Qve=ZJ!==void 0&&ZJ)==`function`?Qve:Object,typeof($ve=g6!==void 0&&g6)==`function`?$ve:Object,typeof(eye=zJ!==void 0&&zJ)==`function`?eye:Object,typeof(tye=rY!==void 0&&rY)==`function`?tye:Object,typeof(nye=pZ!==void 0&&pZ)==`function`?nye:Object,typeof(rye=oY!==void 0&&oY)==`function`?rye:Object,typeof(iye=C8!==void 0&&C8)==`function`?iye:Object,typeof(aye=pY!==void 0&&pY)==`function`?aye:Object,typeof(oye=Bg!==void 0&&Bg)==`function`?oye:Object,typeof(sye=OX!==void 0&&OX)==`function`?sye:Object,typeof(cye=MX!==void 0&&MX)==`function`?cye:Object,typeof(lye=A6!==void 0&&A6)==`function`?lye:Object,typeof(uye=VX!==void 0&&VX)==`function`?uye:Object,typeof(dye=cQ!==void 0&&cQ)==`function`?dye:Object,typeof(fye=ZX!==void 0&&ZX)==`function`?fye:Object,typeof(pye=tZ!==void 0&&tZ)==`function`?pye:Object,typeof(mye=sZ!==void 0&&sZ)==`function`?mye:Object,typeof(hye=W6!==void 0&&W6)==`function`?hye:Object,typeof(gye=nZ!==void 0&&nZ)==`function`?gye:Object,typeof(_ye=xQ!==void 0&&xQ)==`function`?_ye:Object,typeof(vye=y6!==void 0&&y6)==`function`?vye:Object,typeof(yye=W3!==void 0&&W3)==`function`?yye:Object,typeof(bye=n6!==void 0&&n6)==`function`?bye:Object,typeof(xye=s6!==void 0&&s6)==`function`?xye:Object,typeof(Sye=T6!==void 0&&T6)==`function`?Sye:Object,typeof(Cye=xZ!==void 0&&xZ)==`function`?Cye:Object,typeof(wye=J6!==void 0&&J6)==`function`?wye:Object,typeof(Tye=FQ!==void 0&&FQ)==`function`?Tye:Object,typeof(Eye=vQ!==void 0&&vQ)==`function`?Eye:Object,typeof(Dye=Q6!==void 0&&Q6)==`function`?Dye:Object,typeof(Oye=gq!==void 0&&gq)==`function`?Oye:Object,typeof(kye=wY!==void 0&&wY)==`function`?kye:Object,typeof(Aye=X1!==void 0&&X1)==`function`?Aye:Object,typeof(jye=M0!==void 0&&M0)==`function`?jye:Object,typeof(Mye=L0!==void 0&&L0)==`function`?Mye:Object,typeof(Nye=V0!==void 0&&V0)==`function`?Nye:Object,typeof(Pye=l2!==void 0&&l2)==`function`?Pye:Object,typeof(Fye=Y8!==void 0&&Y8)==`function`?Fye:Object,typeof(Iye=i2!==void 0&&i2)==`function`?Iye:Object,typeof(Lye=o2!==void 0&&o2)==`function`?Lye:Object,typeof(Rye=O8!==void 0&&O8)==`function`?Rye:Object,typeof(zye=kF!==void 0&&kF)==`function`?zye:Object,typeof(Bye=tQ!==void 0&&tQ)==`function`?Bye:Object,typeof(Vye=s5!==void 0&&s5)==`function`?Vye:Object,typeof(Hye=d5!==void 0&&d5)==`function`?Hye:Object,typeof(Uye=i8!==void 0&&i8)==`function`?Uye:Object,typeof(Wye=l8!==void 0&&l8)==`function`?Wye:Object,typeof(Gye=d8!==void 0&&d8)==`function`?Gye:Object,typeof(Kye=f2!==void 0&&f2)==`function`?Kye:Object,typeof(qye=g0!==void 0&&g0)==`function`?qye:Object,typeof(Jye=QT!==void 0&&QT)==`function`?Jye:Object,typeof(Yye=h2!==void 0&&h2)==`function`?Yye:Object,typeof(Xye=E4!==void 0&&E4)==`function`?Xye:Object,typeof(Zye=O7!==void 0&&O7)==`function`?Zye:Object,typeof(Qye=I3!==void 0&&I3)==`function`?Qye:Object,typeof($ye=U8!==void 0&&U8)==`function`?$ye:Object,typeof(ebe=_$!==void 0&&_$)==`function`?ebe:Object,typeof(tbe=y8!==void 0&&y8)==`function`?tbe:Object,typeof(nbe=Lh!==void 0&&Lh)==`function`?nbe:Object,typeof(rbe=i7!==void 0&&i7)==`function`?rbe:Object,typeof(ibe=E7!==void 0&&E7)==`function`?ibe:Object,typeof(abe=z9!==void 0&&z9)==`function`?abe:Object,typeof(obe=L9!==void 0&&L9)==`function`?obe:Object,typeof(sbe=y7!==void 0&&y7)==`function`?sbe:Object,typeof(cbe=F7!==void 0&&F7)==`function`?cbe:Object,typeof(lbe=Nm!==void 0&&Nm)==`function`?lbe:Object,typeof(ube=n$!==void 0&&n$)==`function`?ube:Object,typeof(dbe=B9!==void 0&&B9)==`function`?dbe:Object,typeof(fbe=S5!==void 0&&S5)==`function`?fbe:Object,typeof(pbe=M7!==void 0&&M7)==`function`?pbe:Object,typeof(mbe=R5!==void 0&&R5)==`function`?mbe:Object,typeof(hbe=x5!==void 0&&x5)==`function`?hbe:Object,typeof(gbe=G5!==void 0&&G5)==`function`?gbe:Object,typeof(_be=m7!==void 0&&m7)==`function`?_be:Object,typeof(vbe=C7!==void 0&&C7)==`function`?vbe:Object,typeof(ybe=z3!==void 0&&z3)==`function`?ybe:Object,typeof(bbe=m5!==void 0&&m5)==`function`?bbe:Object])],V9)})),Sbe=o((()=>{xbe()})),Cbe=o((()=>{})),H9,wbe=o((()=>{fa(),w(),O(),H9=class extends da{init(){this._setAbGroup=!1,this._key=`DialDownLogsExperiment2`,this._lookup=`DSLE2`,this._default=[`none`]}},H9=D([C()],H9)})),Tbe,Ebe,Dbe,Obe,kbe,U9,Abe=o((()=>{rU(),HS(),Bh(),Na(),$(),Z(),w(),j(),E(),O(),U9=class{constructor(e,t,n,r,i){this._slotEventBus=e,this._pageManager=t,this._prebidEventBus=n,this._gamEventBus=r,this._videoEventProxy=i,T(this,`_adRequests`,0),T(this,`_adSlots`,0),T(this,`_prebidResponses`,0),T(this,`_prebidResponseCPMs`,[]),T(this,`_domContentLoaded`,-1/0),T(this,`_timeOnPage`,-1/0),T(this,`_timeToFirstAdReq`,-1/0),T(this,`_displayImpressions`,0),T(this,`_videoImpressions`,0)}init(){this._slotEventBus.requestingBids.once(()=>this._setTimeToFirstAdRequest()),this._slotEventBus.requestingBids.on(()=>this._adRequested()),this._slotEventBus.addSlots.on(e=>this._addSlots(e.length)),this._gamEventBus.slotRenderEnded.on(({event:e})=>{e&&!e.isEmpty&&this._addDisplaySlotImpression()}),this._videoEventProxy.videoSlotRendered.on(e=>{e&&!e.isEmpty&&this._addVideoSlotImpression()}),this._trackDomContentLoaded(),this._pageManager.beforeUnload.on(()=>{this._calculateTimeOnPage(),this._sendCounts()}),this._prebidEventBus.bidWon.on(e=>{this._prebidResponses++,this._prebidResponseCPMs.push(Number(e.cpm.toFixed(2)))})}_setTimeToFirstAdRequest(){this._timeToFirstAdReq=this._domContentLoaded===-1/0?-1/0:kK.now()-this._domContentLoaded}_adRequested(){this._adRequests++}_addSlots(e){this._adSlots+=e}_addDisplaySlotImpression(){this._displayImpressions++}_addVideoSlotImpression(){this._videoImpressions++}_trackDomContentLoaded(){var e;let t=(e=window.performance)==null?void 0:e.getEntriesByType(`navigation`);t&&t[0]&&t[0].domContentLoadedEventEnd&&(this._domContentLoaded=t[0].domContentLoadedEventEnd)}_calculateTimeOnPage(){this._timeOnPage=this._domContentLoaded===-1/0?-1/0:kK.now()-this._domContentLoaded}_sendCounts(){Vt.event(`SystemPulse`,`counts`,{adRequests:this._adRequests,prebidsWon:this._prebidResponses,prebidCPMs:this._prebidResponseCPMs,adSlots:this._adSlots,displayImps:this._displayImpressions,videoImps:this._videoImpressions,timeToFirstAdReq:this._timeToFirstAdReq,timeOnPage:this._timeOnPage})}},U9=D([C(),A(`design:paramtypes`,[typeof(Tbe=Vr!==void 0&&Vr)==`function`?Tbe:Object,typeof(Ebe=ja!==void 0&&ja)==`function`?Ebe:Object,typeof(Dbe=Pr!==void 0&&Pr)==`function`?Dbe:Object,typeof(Obe=zh!==void 0&&zh)==`function`?Obe:Object,typeof(kbe=VS!==void 0&&VS)==`function`?kbe:Object])],U9)})),jbe=o((()=>{})),Mbe,Nbe,W9,Pbe=o((()=>{w(),H(),B(),$(),Rm(),rU(),jbe(),j(),E(),O(),W9=class extends V{constructor(e,t){super(),this._config=e,this._consentEventBus=t,T(this,`_consented`,void 0),T(this,`_cssPrefix`,`adthrive-act25`),T(this,`_modal`,null),T(this,`_footer`,null),T(this,`_footerLink`,null),T(this,`_footerLinkOptOutText`,`Ne vendez pas ou ne partagez pas mes informations personnelles / Do not sell or share my personal information`),T(this,`_footerLinkOptInText`,`Personnalisez mon expérience publicitaire / Customize my ad experience`),T(this,`_storageKey`,`adthrive_act25-consent`),T(this,`_timer`,null),T(this,`_timeout`,3e4),T(this,`_storageTimeout`,13),this._consented=this._config.act25.consented}get consented(){return this._consented}get modal(){return this._modal}get footer(){return this._footer}init(){if(this._modal=this._createConsentModal(),this._footer=this._createFooterElement(),this._consented===null){var e;(e=this._modal)==null||e.classList.add(`show`),this._startTimer()}else this._consentEventBus.act25consentCaptured.emit(this._consented);this._injectFooterElement()}checkConsent(){return new Promise(e=>{this._consented!==null&&e(this._consented),this._consentEventBus.act25consentCaptured.on(t=>{this._timer&&(clearTimeout(this._timer),this._timer=null),e(t)})})}_createConsentModal(){if(this._modal)return this._modal;let e=document.createElement(`div`);e.className=`${this._cssPrefix}-modal`;let t=document.createElement(`div`);t.className=`${this._cssPrefix}-modal-content`;let n=document.createElement(`span`);n.className=`${this._cssPrefix}-modal-close`,n.innerText=`✕`,n.addEventListener(`click`,()=>this._handleClose());let r=document.createElement(`div`);r.className=`${this._cssPrefix}-modal-body`,r.innerHTML=`
    <p>
    Soucieux d’offrir une expérience optimale, nous et nos partenaires utilisons des technologies telles que les cookies pour enregistrer et/ou accéder
    aux informations des appareils. Le consentement à ces technologies nous permettra, à nous et à nos partenaires, de traiter des données personnelles
    telles que le comportement de navigation ou les identifiants uniques sur ce site. Les cookies déposés par nos partenaires ou fournisseurs tiers sont
    des cookies tiers déposés dans le but de placer des publicités sur nos produits et Services sur d’autres sites web. L’utilisation des cookies par
    ces tiers est régie par leurs politiques de confidentialité.
    </p>
    <p>
    Cliquez sur « accepter » ou « déclin » ci-dessous. Vous pouvez mettre à jour vos choix à tout moment en cliquant sur ne vendez pas en
    bas de la page.
    </p>

    <br />

    <p>
    To provide the best experiences, we and our partners use technologies like cookies to store and/or access device information.
    Consenting to these technologies will allow us and our partners to process personal data such as browsing behavior or unique IDs on this site.
    Cookies placed by our partners or third-party suppliers are third-party cookies placed for the purpose of placing advertisements on our products
    and Services on other websites. The use of cookies by these third parties is governed by their privacy policies.
    </p>
    <p>
    Click "accept" or “decline" below. You can update your choices at any time by clicking on the Do not sell link in the bottom of the page.
    </p>
    `;let i=document.createElement(`div`);i.className=`${this._cssPrefix}-modal-footer`;let a=document.createElement(`button`);a.className=`${this._cssPrefix}-modal-accept`,a.innerText=`Accepter/Accept`,a.addEventListener(`click`,()=>this._handleAccept());let o=document.createElement(`button`);return o.className=`${this._cssPrefix}-modal-decline`,o.innerText=`Déclin/Decline`,o.addEventListener(`click`,()=>this._handleDecline()),r.appendChild(n),i.appendChild(o),i.appendChild(a),t.appendChild(r),t.appendChild(i),e.appendChild(t),document.body.appendChild(e),e}_createFooterElement(){if(this._footer)return this._footer;let e=document.createElement(`div`);e.className=`${this._cssPrefix}-footer`;let t=document.createElement(`p`);t.className=`${this._cssPrefix}-footer-text`,t.innerText=`
    Les informations de votre appareil peuvent être utilisées pour personnaliser votre expérience publicitaire. /
      Information from your device can be used to personalize your ad experience.`;let n=document.createElement(`a`);return n.innerText=this._consented?this._footerLinkOptOutText:this._footerLinkOptInText,n.className=`${this._cssPrefix}-footer-link`,n.addEventListener(`click`,()=>{var e;return this._handleFooterLinkClick((e=this._consented)==null?!1:e)}),this._footerLink=n,e.appendChild(t),e.appendChild(n),e}_injectFooterElement(){let e=this._config.footer.elements,t=!!this._footer&&e.find(e=>e.element===this._footer);t||e.push({order:1,element:this._footer})}_destroyConsentModal(){var e;(e=this._modal)==null||e.classList.remove(`show`)}_handleAccept(){this._toggleConsent(!0),M.event(`Act25EnforcementComponent`,`handleUserAction`,`qbccmp:acc`)}_handleDecline(){this._toggleConsent(!1),M.event(`Act25EnforcementComponent`,`handleUserAction`,`qbccmp:dec`)}_handleClose(){this._toggleConsent(!1),M.event(`Act25EnforcementComponent`,`handleUserAction`,`qbccmp:clo`)}_handleTimeout(){this._toggleConsent(!1),M.event(`Act25EnforcementComponent`,`handleUserAction`,`qbccmp:tim`)}_handleFooterLinkClick(e){if(e)this._handleDecline();else{var t;(t=this._modal)==null||t.classList.add(`show`)}}_toggleConsent(e){U.setExpirableInternalLocalStorage(this._storageKey,e,{expiry:{value:this._storageTimeout,unit:`months`}}),this._consented=e,this._destroyConsentModal(),this._updateFooterLink(e),this._consentEventBus.act25consentCaptured.emit(e)}_updateFooterLink(e){this._footerLink&&(this._footerLink.innerText=e?this._footerLinkOptOutText:this._footerLinkOptInText)}_startTimer(){this._timer=window.setTimeout(()=>{this._handleTimeout()},this._timeout)}},W9=D([Q(`Act25EnforcementComponent`),C(),A(`design:paramtypes`,[typeof(Mbe=z!==void 0&&z)==`function`?Mbe:Object,typeof(Nbe=_r!==void 0&&_r)==`function`?Nbe:Object])],W9)})),Fbe=o((()=>{Pbe()})),Ibe=o((()=>{})),Lbe,Rbe,G9,zbe=o((()=>{w(),H(),$(),Ibe(),B(),rU(),j(),E(),O(),G9=class extends V{constructor(e,t){super(),this._config=e,this._consentEventBus=t,T(this,`_cssPrefix`,`adthrive-us-cmp`),T(this,`_modal`,null),T(this,`_footer`,null),T(this,`_footerLink`,null),T(this,`_footerLinkOptOutText`,`Do not sell or share my personal information.`),T(this,`_footerLinkOptInText`,`Customize my ad experience.`),T(this,`_timer`,null),T(this,`_timeout`,25e3)}get modal(){return this._modal}get footer(){return this._footer}init(){if(this._modal=this._createConsentModal(),this._footer=this._createFooterElement(),this._config.usCMP.consent===null){var e;(e=this._modal)==null||e.classList.add(`show`),this._startTimer(),this._config.usCMP.defaultOptIn&&this._consentEventBus.usCmpConsentCaptured.emit(!0)}else this._consentEventBus.usCmpConsentCaptured.emit(this._config.usCMP.consent);this._injectFooterElement()}checkConsent(){return new Promise(e=>{this._config.usCMP.consent!==null&&e(this._config.usCMP.consent),this._consentEventBus.usCmpConsentCaptured.on(t=>{this._timer&&(clearTimeout(this._timer),this._timer=null),e(t)},{handleEventsAlreadyEmitted:!0})})}_createConsentModal(){if(this._modal)return this._modal;let e=document.createElement(`div`);e.className=`${this._cssPrefix}-modal`;let t=document.createElement(`div`);t.className=`${this._cssPrefix}-modal-content`;let n=document.createElement(`span`);n.className=`${this._cssPrefix}-modal-close`,n.innerText=`✕`,n.addEventListener(`click`,()=>this._handleClose());let r=document.createElement(`div`);r.className=`${this._cssPrefix}-modal-body`,r.innerHTML=`
      <p>
    To provide the best experiences, we and our partners use technologies like cookies to store and/or access device information.
    Consenting to these technologies will allow us and our partners to process personal data such as browsing behavior or unique IDs on this site.
    Cookies placed by our partners or third-party suppliers are third-party cookies placed for the purpose of placing advertisements on our products
    and Services on other websites. The use of cookies by these third parties is governed by their privacy policies.
    </p>
    <p>
    Click "accept" or “decline" below. You can update your choices at any time by clicking on the Do not sell link in the bottom of the page.
    </p>
    `;let i=document.createElement(`div`);i.className=`${this._cssPrefix}-modal-footer`;let a=document.createElement(`button`);a.className=`${this._cssPrefix}-modal-accept`,a.innerText=`Accept`,a.addEventListener(`click`,()=>this._handleAccept());let o=document.createElement(`button`);return o.className=`${this._cssPrefix}-modal-decline`,o.innerText=`Decline`,o.addEventListener(`click`,()=>this._handleDecline()),r.appendChild(n),i.appendChild(o),i.appendChild(a),t.appendChild(r),t.appendChild(i),e.appendChild(t),document.body.appendChild(e),e}_createFooterElement(){if(this._footer)return this._footer;let e=document.createElement(`div`);e.className=`${this._cssPrefix}-footer`;let t=document.createElement(`p`);t.className=`${this._cssPrefix}-footer-text`,t.innerText=`Information from your device can be used to personalize your ad experience.`;let n=document.createElement(`a`),r=this._config.usCMP.defaultOptIn?!0:this._config.usCMP.consent;return n.innerText=r?this._footerLinkOptOutText:this._footerLinkOptInText,n.className=`${this._cssPrefix}-footer-link`,n.addEventListener(`click`,()=>this._handleFooterLinkClick(r==null?!1:r)),this._footerLink=n,e.appendChild(t),e.appendChild(n),e}_injectFooterElement(){let e=this._config.footer.elements,t=!!this._footer&&e.find(e=>e.element===this._footer);t||e.push({order:1,element:this._footer})}_destroyConsentModal(){var e;(e=this._modal)==null||e.classList.remove(`show`)}_handleAccept(){this._toggleConsent(!0),M.event(`USCMPEnforcementComponent`,`handleUserAction`,`uscmp:acc`)}_handleDecline(){this._toggleConsent(!1),M.event(`USCMPEnforcementComponent`,`handleUserAction`,`uscmp:dec`)}_handleClose(){this._toggleConsent(!1),M.event(`USCMPEnforcementComponent`,`handleUserAction`,`uscmp:clo`)}_handleTimeout(){this._toggleConsent(!0),M.event(`USCMPEnforcementComponent`,`handleUserAction`,`uscmp:tim`)}_handleFooterLinkClick(e){if(e)this._handleDecline();else{var t;(t=this._modal)==null||t.classList.add(`show`)}}_toggleConsent(e){this._consentEventBus.usCmpConsentCaptured.emit(e),this._destroyConsentModal(),this._updateFooterLink(e)}_updateFooterLink(e){this._footerLink&&(this._footerLink.innerText=e?this._footerLinkOptOutText:this._footerLinkOptInText)}_startTimer(){this._timer=window.setTimeout(()=>{this._handleTimeout()},this._timeout)}},G9=D([Q(`USCMPEnforcementComponent`),C(),A(`design:paramtypes`,[typeof(Lbe=z!==void 0&&z)==`function`?Lbe:Object,typeof(Rbe=_r!==void 0&&_r)==`function`?Rbe:Object])],G9)})),Bbe=o((()=>{zbe()})),Vbe,K9,Hbe=o((()=>{$(),ei(),w(),Ma(),Rm(),TJ(),j(),At(),O(),K9=class{constructor(e,t){this.pageviewKey=e,this.pageManager=t}start(){let e=U.readSessionStorage(`previousUrl`),t=U.readSessionStorage(`previousPVK`),n=U.readSessionStorage(`previousPageHide`),r=U.readSessionStorage(`previousUnload`),i=U.readSessionStorage(`previousBeforeUnload`);this.pageManager.beforeUnload.on(()=>{U.setSessionStorage(`previousBeforeUnload`,!0)}),window.addEventListener(`unload`,()=>{U.setSessionStorage(`previousUnload`,!0)}),this.pageManager.pageHide.on(()=>{U.setSessionStorage(`previousPageHide`,!0)});let a=Zr();if(e&&e===window.location.href){var o,s;let e=U.readSessionStorage(`previousLoadTime`),c=e?Qr(e,a):void 0,l=(o=performance.getEntriesByType(`navigation`)[0])==null?void 0:o.type;l===`navigate`&&n===!1&&CJ(),M.event(`PageRefreshMonitor`,`refresh`,{timeSinceLastLoad:c,navigationType:l,legacyNavigationType:(s=window.performance)==null||(s=s.navigation)==null?void 0:s.type,previousPVK:t,previousPageHide:n,previousUnload:r,previousBeforeUnload:i})}U.setSessionStorage(`previousUrl`,window.location.href),U.setSessionStorage(`previousLoadTime`,a),U.setSessionStorage(`previousPVK`,this.pageviewKey),U.setSessionStorage(`previousPageHide`,!1),U.setSessionStorage(`previousUnload`,!1),U.setSessionStorage(`previousBeforeUnload`,!1)}},K9=D([S(),A(`design:paramtypes`,[String,typeof(Vbe=ja!==void 0&&ja)==`function`?Vbe:Object]),kt(0,ot(`PageviewKey`))],K9)})),Ube,Wbe,Gbe,Kbe,qbe,Jbe,Ybe,Xbe,Zbe,Qbe,$be,exe,txe,q9,nxe=o((()=>{w(),$(),$h(),AI(),lme(),Sbe(),B(),vh(),FS(),Cbe(),Z(),Nt(),rU(),wbe(),Ft(),Abe(),Rm(),Ra(),Kh(),Fbe(),Bbe(),Ua(),Hbe(),al(),TJ(),ud(),j(),E(),O(),q9=class{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f){this.cls=e,this.config=t,this.context=n,this.cmd=r,this.slotManager=i,this.slots=a,this._auctionManagers=o,this._coreExperimentConfig=s,this._googleAdManager=c,this._components=l,this._siteExperimentEventBus=u,this._realizedAdDensityEventBus=d,this._identityEventBus=f,T(this,`branch`,void 0),T(this,`bucket`,void 0),T(this,`invalidTraffic`,void 0),T(this,`deployment`,void 0),T(this,`abgroup`,void 0),T(this,`pubab`,void 0),T(this,`plugin`,void 0),T(this,`siteAds`,void 0),T(this,`buildDate`,void 0),T(this,`coreExperiments`,void 0),T(this,`windowPerformance`,void 0),T(this,`deliveryFeatures`,void 0),T(this,`cookieDeprecationLabel`,void 0),T(this,`marmalade`,{mcmp:null}),T(this,`marmaladeFinished`,e=>e),T(this,`additiveRaptiveFloorsFinished`,e=>e),T(this,`rubiconFloorsFinished`,e=>e),T(this,`trafficShapingFinished`,e=>e),T(this,`rbcridFinished`,e=>e),T(this,`api`,{browserStorage:{setLocalStorage:U.setExternalLocalStorage.bind(U),readLocalStorage:U.readExternalLocalStorage.bind(U),setInternalLocalStorage:U.setInternalLocalStorage.bind(U)}}),T(this,`_identipyApiReady`,new Promise(e=>e(!1))),T(this,`_adDensityReady`,new Promise(e=>e(!1))),this.bucket=this.context.bucket,this.branch=this.context.branch,this.invalidTraffic=this.context.invalidTraffic,this.deployment=this.context.deployment,this.abgroup=this.config.abGroup.groups,this.pubab=this.config.pubAbGroup.groups,this.siteAds=window.adthrive.siteAds,this.buildDate=window.adthrive.buildDate,this.windowPerformance=window.adthrive.windowPerformance,this.marmaladeFinished=window.adthrive.marmaladeFinished||this.marmaladeFinished,this.additiveRaptiveFloorsFinished=window.adthrive.additiveRaptiveFloorsFinished||this.additiveRaptiveFloorsFinished,this.trafficShapingFinished=window.adthrive.trafficShapingFinished||this.trafficShapingFinished,this.rbcridFinished=window.adthrive.rbcridFinished||this.rbcridFinished,this.coreExperiments=this._coreExperimentConfig.coreExperiments,this.deliveryFeatures=window.adthrive.deliveryFeatures,this.cookieDeprecationLabel=window.adthrive.cookieDeprecationLabel,this.siteAds.targeting={push:e=>this._googleAdManager.setTargeting(e)},this._siteExperimentEventBus.targetingReady.on(()=>{this.pubab=this.config.pubAbGroup.groups,this._googleAdManager.setTargeting({key:`pubab`,value:this.pubab})});let p=Hh().get(`at_sticky`);p===`off`&&this.clearSticky()}async init(){let e=Gh.markStartTask(`microtask`,[`index`,`setupAdthrive`,`after-yield`,`1`]),t=tK(window.adthrive.bucket)||Math.random()<.01;t&&this.cmd.push(()=>Vt.event(`AdThrive`,`init`,`hcstart`)),this._identipyApiReady=new Promise(e=>this._identityEventBus.identityApiReady.on(()=>e(!0),{handleEventsAlreadyEmitted:!0})),this._adDensityReady=new Promise(e=>this._realizedAdDensityEventBus.realizedAdDensityCompReady.on(()=>e(!0)));let n=e=>{e.data={abgroup:this.config.abGroup.groupsAsObject,pubab:this.config.pubAbGroup.groupsAsObject,sess:this.context.sessionKey,pvk:this.context.pageviewKey,hbho:this.config.hbho.bidders,vbho:this.config.vbho.bidders,spa:this.config.adOptions.spa,...this.context.deliveryVersion&&{lmdv:this.context.deliveryVersion},...this.cls&&this.cls.branch&&{clsBranch:this.cls.branch},...this.cls&&this.cls.bucket&&{clsBucket:this.cls.bucket}}},r=x.resolve(H9),i=x.resolve(Pt);i.dialDownLogs.emit({result:r.result,choices:r._choices}),n(M),M.sending.on(()=>n(M)),Vt.sending.on(()=>n(Vt)),e.markEndTask(),await Ha();let a=Gh.markStartTask(`microtask`,[`index`,`setupAdthrive`,`after-yield`,`2`]);this.cmd.init(),this._auctionManagers.init(),this._googleAdManager.init();let o=x.resolve(U9);if(o.init(),this.config.act25.required){let e=x.resolve(W9);e.init();let t=e.checkConsent();a.markEndTask(),await t}else if(this.config.usCMP.required){let e=x.resolve(G9);if(e.init(),this.config.usCMP.defaultOptIn)a.markEndTask();else{let t=e.checkConsent();a.markEndTask(),await t}}else a.markEndTask();await Ha();let s=x.resolve(K9);s.start(),Oi()&&wJ()&&il.isRolloutEnabled(`disable-sticky-outstream-ios-refresh`)&&(this.config.video.preventStickyOutstream=!0);let c=Gh.markStartTask(`microtask`,[`index`,`setupAdthrive`,`after-yield`,`3`]);this._components.init(),c.markEndTask(),await Ha();let l=Gh.markStartTask(`microtask`,[`index`,`setupAdthrive`,`after-yield`,`3b`]);this._components.init(!0),l.markEndTask(),await Ha();let u=Gh.markStartTask(`microtask`,[`index`,`setupAdthrive`,`after-yield`,`4`]);this._googleAdManager.start(),this._components.start(),this._components.start(!0),this.cls&&this.cls.error&&M.error(`AdThrive`,`init`,`Problem with AdThriveCLS SiteAds. CLS Disabled`),t&&Vt.event(`AdThrive`,`init`,`hcend`),u.markEndTask(),await Ha();let d=Gh.markStartTask(`microtask`,[`index`,`setupAdthrive`,`after-yield`,`5`]),f=new URLSearchParams(window.location.search);f.get(`womm`)===`true`&&ta(`https://ads.adthrive.com/debug/womm.js`).then(()=>{}).catch(()=>{M.error(`AdThrive`,`init`,`Error loading womm`)}),d.markEndTask()}identityApi(e,t){return this._identipyApiReady.then(()=>{this._identityEventBus.identityApiDataSubmitted.emit({data:e,cb:t})})}disableAds(e){this.config.disableAds.disableAllAds(e)}disableContentAds(e){this.config.disableAds.disableContentAds(e)}disablePlaylistPlayers(e){this.config.disableAds.disablePlaylistPlayers(e)}showPrivacyPreferences(){window.__tcfapi&&window.__tcfapi(`showGDPRScreenAdvanced`)}getConsentData(){window.__tcfapi&&window.__tcfapi(`getTCData`,2,e=>{})}getAdthriveFlippData(){return this.config.marmalade.flpProdIds.filter(GW)}setTargetingFlag(e,t,n=!1){!e||typeof e!=`string`||!t||!Array.isArray(t)||t.length===0||this._googleAdManager.setTargetingFlag(e,t,n)}setTargeting(e){this._googleAdManager.setTargeting(e)}getTargeting(){return this._googleAdManager.getTargeting()}getTargetingMap(){return this._googleAdManager.getTargetingMap()}logError(e,t,n){M.error(e,t,n)}log(e,t,n,r){switch(e){case`error`:M.error(t,n,r);break;case`info`:break;case`log`:M.log(t,n,r);break;case`warn`:break}}refreshSlots(e){let t=this.slots.get();e&&e.length&&(t=t.filter(t=>e.includes(t.id))),t.forEach(e=>{this.slotManager.refresh(e,!1).then(()=>{this.slotManager.clearRefreshTimeout(e,!0)}).catch(()=>{})})}nmr(){return M.event(`adthrive`,`nmr`,`adthrive.nmr() has been called`),this.slotManager.updateRefreshTimeout(this.slots.get(),0)}clearSticky(){M.event(`adthrive`,`clearSticky`,`adthrive.clearSticky() has been called`),U.deleteLocalStorage(`adthrive_abgroup`),U.deleteLocalStorage(`adt_pe`)}async getAdDensity(){let e=null;return await this._adDensityReady.then(()=>{this._realizedAdDensityEventBus.metricsRequested.emit(t=>e=t)}).catch(()=>{}),e}logAdDensity(){this._adDensityReady.then(()=>{this._realizedAdDensityEventBus.metricsRequested.emit(e=>{})}).catch(()=>{})}},q9=D([Q(`AdThrive`),C(),A(`design:paramtypes`,[typeof(Ube=ld!==void 0&&ld)==`function`?Ube:Object,typeof(Wbe=z!==void 0&&z)==`function`?Wbe:Object,typeof(Gbe=L!==void 0&&L)==`function`?Gbe:Object,typeof(Kbe=QK!==void 0&&QK)==`function`?Kbe:Object,typeof(qbe=PS!==void 0&&PS)==`function`?qbe:Object,typeof(Jbe=_h!==void 0&&_h)==`function`?Jbe:Object,typeof(Ybe=kI!==void 0&&kI)==`function`?Ybe:Object,typeof(Xbe=jt!==void 0&&jt)==`function`?Xbe:Object,typeof(Zbe=Zh!==void 0&&Zh)==`function`?Zbe:Object,typeof(Qbe=V9!==void 0&&V9)==`function`?Qbe:Object,typeof($be=Br!==void 0&&Br)==`function`?$be:Object,typeof(exe=nU!==void 0&&nU)==`function`?exe:Object,typeof(txe=Nr!==void 0&&Nr)==`function`?txe:Object])],q9)})),rxe,ixe=o((()=>{rxe={domain:`ads.adthrive.com`,branch:`main`,bucket:`prod`,cmp:!0}})),J9,axe=o((()=>{w(),fU(),j(),E(),O(),J9=class extends tr{constructor(){super(),T(this,`classList`,[`EmailCaptureHandler`]),T(this,`_result`,!1),T(this,`_choices`,[{choice:!0},{choice:!1}]),T(this,`abgroup`,`logfltr`),T(this,`key`,`LoggerFilter`),T(this,`lookup`,`LOGFLTR`),this._result=this.run()}get result(){return this._result}run(){return new ar(0).get()}},J9=D([C(),A(`design:paramtypes`,[])],J9)})),oxe,sxe,cxe=o((()=>{oxe=()=>{let e=[`__nativePromise`,`__nativeURL`,`__nativePerformance`,`__nativeFetch`,`__ElementMatches`,`__HTMLElementBoundingClientRect`];return e.some(e=>window.hasOwnProperty(e))},sxe=()=>navigator.userAgent&&(navigator.userAgent.search(/GTmetrix/i)>-1||navigator.userAgent.search(/pingdom/i)>-1||navigator.userAgent.search(/Google Page Speed Insights/i)>-1||navigator.userAgent.search(/Chrome-Lighthouse/i)>-1)?!0:!!oxe()})),lxe,uxe=o((()=>{lxe={SetInterestGroupsData:`adthrive_SetInterestGroupsData`}})),dxe,fxe,pxe,mxe,hxe,Y9,gxe=o((()=>{w(),qi(),IK(),Lt(),rU(),uxe(),Rd(),j(),E(),O(),Y9=class{constructor(e,t,n,r,i){this._bootstrapConfig=e,this._fledgeConfig=t,this._privacySandboxEventBus=n,this._browserTopicsAPIEventBus=r,this._marmaladeEventBus=i,T(this,`_host`,`https://${this._bootstrapConfig.host}`),T(this,`_frame`,document.createElement(`iframe`)),T(this,`_baseUrl`,this._bootstrapConfig.baseUrl),T(this,`_frameSrc`,`${this._baseUrl.replace(`/gdpr`,``)}/html/ps.html`),this.enabled&&this._addIframeToPage().then(()=>{this._privacySandboxEventBus.iframeReady.emit(),this._setupEventListeners()}).catch(e=>{M.error(`PrivacySandboxIframeManager`,`constructor`,`Failed to initialize Privacy Sandbox iframe`,e)})}get enabled(){return this._fledgeConfig.enabled}setInterestGroups(e){try{if(this._frame.contentWindow){let t={action:lxe.SetInterestGroupsData,groupNames:e};this._frame.contentWindow.postMessage(t,this._host)}}catch(e){M.error(`PrivacySandboxIframeManager`,`setInterestGroups`,`Failed to set interest groups.`,e)}}_addIframeToPage(){return new Promise(e=>{this._frame.src=this._frameSrc,this._frame.id=`adthrive-privacy-sandbox`,this._frame.style.display=`none`,this._frame.onload=()=>{e()},document.body.appendChild(this._frame)})}_setupEventListeners(){this._browserTopicsAPIEventBus.topicsReceived.on(e=>{let t=e.map(e=>`${e.id}`);this.setInterestGroups(t)},{handleEventsAlreadyEmitted:!0}),this._marmaladeEventBus.marmaladeResponseLoaded.on(({recencyFrequency:e})=>{var t;let n=(t=e==null?void 0:e.map(({rf_code:e})=>e))==null?[]:t;this.setInterestGroups(n)},{handleEventsAlreadyEmitted:!0})}},Y9=D([Q(`PrivacySandboxIframeManager`),C(),A(`design:paramtypes`,[typeof(dxe=Ki!==void 0&&Ki)==`function`?dxe:Object,typeof(fxe=Ld!==void 0&&Ld)==`function`?fxe:Object,typeof(pxe=Ir!==void 0&&Ir)==`function`?pxe:Object,typeof(mxe=gr!==void 0&&gr)==`function`?mxe:Object,typeof(hxe=Rr!==void 0&&Rr)==`function`?hxe:Object])],Y9)})),_xe,vxe=o((()=>{_xe=e=>{let t={index:-1,weight:-1};if(!e||e.length===0)return t;let n=e.reduce((e,t)=>e+t,0);if(n===0)return t;let r=Math.random()*n,i=0,a=e[i];for(;r>a;)a+=e[++i];return{index:i,weight:e[i]}}})),X9,yxe=o((()=>{$(),Rm(),vxe(),E(),X9=class{static isValidExperiment(e){return e.reduce((e,t)=>e+t,0)===100}static setExperimentABGroup(e,t){let n=`${e}_${t.id}`;this._experimentABGroup=n}static getExperimentConfig(e){let t=e.experimentChoices,n=this.getStickyResult(e);if(n)return this.setExperimentABGroup(e.id,n),n;let r=t.map(e=>e.weight);if(!this.isValidExperiment(r))return;let i=_xe(r);this.setExperimentABGroup(e.id,t[i.index]);let a=t[i.index];return this.setStickyResult(e.id,a),a}static get experimentABGroup(){return this._experimentABGroup}static getStickyResult(e){try{let t=U.readInternalLocalStorage(this._localStorageKey);if(!t)return null;let n=t[e.id];return!n||!e.experimentChoices.find(e=>e.id===n.id)?null:n}catch(e){return M.error(`ProfileExperimentsUtil`,`unabled to parse sticky experiment value`),null}}static setStickyResult(e,t){let n=U.readInternalLocalStorage(this._localStorageKey)||{};n[e]=t,U.setInternalLocalStorage(this._localStorageKey,n)}},T(X9,`_localStorageKey`,`adt_pe`),T(X9,`_experimentABGroup`,null)})),bxe,xxe=o((()=>{dn(),Di(),nG(),bxe=()=>{let e=tG()?`mobile`:`tablet`;return Ei(Kt)?`desktop`:e}})),Sxe,Cxe=o((()=>{dn(),xxe(),Sxe=e=>{let t=un(),n=bxe(),r=e.siteAdsProfiles,i=null;if(r&&r.length)for(let e of r){let r=e.targeting.device,a=e.targeting.browserEngine,o=r&&r.length&&r.includes(n),s=a&&a.length&&a.includes(t);o&&s&&(i=e)}return i}})),Z9,wxe=o((()=>{yxe(),ii(),w(),Cxe(),E(),Z9=class{static _getSiteAdsProfile(e){let t=Sxe(e);return t&&(this._profileID=t.profileId),t}static updateSiteAds(e){let t=this._getSiteAdsProfile(e.siteAds),n=t&&t.experiment?X9.getExperimentConfig(t.experiment):void 0;if(t){let r={adOptions:t.adOptions,adTypes:t.adTypes,videoPlayers:t.videoPlayers};e.siteAds.adOptions=Object.assign(e.siteAds.adOptions,r.adOptions,n==null?void 0:n.adOptions),e.siteAds.adTypes&&Object.assign(e.siteAds.adTypes,r.adTypes,n==null?void 0:n.adTypes),e.siteAds.videoPlayers&&t.videoPlayers&&(e.siteAds.videoPlayers=Object.assign(e.siteAds.videoPlayers,t.videoPlayers,n==null?void 0:n.videoPlayers)),this._profileID=t.profileId.toString(),this.setTargeting(n)}}static get profileID(){return this._profileID}static setTargeting(e){let t=x.resolve(ti);t.set(`aprf`,this._profileID),e&&X9.experimentABGroup&&t.set(`pe`,X9.experimentABGroup)}static updateBodyClass(){let e=`raptive-profile-${this._profileID}`;this._profileID!==`def`&&!document.body.classList.contains(e)&&document.body.classList.add(e)}},T(Z9,`_profileID`,`def`)})),Txe,Exe=o((()=>{Txe=()=>{var e;let t=(e=window)==null||(e=e.location)==null?void 0:e.host;if(!t)return!0;let n=`megadiscounts.world,securedspot.vip,inrk.info,stealthedealz.world,jiyin.info,groug.com,lifesfouhealth.com,2hihkhkthrg.com,trybox.cyou,andrewgreenbaumdesign.com,lolitatops.com,goapplydeal.com,nexofrost.com,soldes-vetements.store,egobhps.info,negozio-di-valigi.com,zlqwrm.info,flavorjourney.blog,sweethomedigest.com,bakerycakesprices.com,bevvy.co,natureplusme.com,petjurni.com,lifevacs.com,showbizcast.com,metromindful.com,dmnews.com,natureofhome.com,drinkstack.com,hairmotive.com,fluffyplanet.com,hairstylesecrets.com,dogdorable.com,theabsolutefoodie.com,anorganizedchaos.com,mealprepify.com,sawshub.com,photographyforrealestate.net,terrierhub.com,softwaretesttips.com,scripturesavvy.com,stealthygaming.com,androidnature.com,otakusnotes.com,seinenmanga.com,unitopten.com,worldanimalfoundation.org,manthatlooksgood.com,wineandmommytime.org,uvindextoday.com,playerassist.com,factualamerica.com,corexbox.com,linuxways.net,linuxhint.com,brightstuffs.com,hellolidy.com,indoorgardenweb.co,indiagardening.com,cradiori.co,castoroil-guide.com,crocht.com,balconygardenweb.com,parentswonder.net,rennieorchards.com,trickyfish.co,websitebuilderinsider.com,addrecipes.com,skillsrecipes.com,blog.gaminguides.com,fictiontalk.com,farmsunseed.com,petedu.net,wordselector.com,melodyinsight.com,synonympro.com`.split(`,`),r=!!n.find(e=>t.includes(e));return!r}})),Dxe,Q9,Oxe,kxe,Axe,jxe,Mxe,Nxe,Pxe,Fxe,Ixe,Lxe,Rxe,zxe,Bxe,Vxe,$9,Hxe=o((()=>{oe(),w(),nxe(),rd(),ixe(),L3(),So(),Na(),$(),Z(),Ht(),Sf(),axe(),cxe(),gxe(),Ua(),wxe(),Rm(),Kh(),B(),FS(),$h(),AI(),Exe(),ud(),bee(),Dxe=e=>e instanceof q9||e instanceof Promise,Q9=x.resolve(xf),Oxe=(e,t)=>{Q9.loading=e,Q9.bootstrapFinished=t},kxe=(e,t)=>{Q9.gamStarted=e.started,Q9.gamFinished=e.finished,Q9.gamDuration=e.duration,Q9.marmaladeStarted=t.started,Q9.marmaladeFinished=t.finished,Q9.marmaladeDuration=t.duration},Axe=async()=>{await Ha();let e=Gh.markStartTask(`microtask`,[`index`,`resolveLongAdThriveDependencies`,`1`]),t=x.resolve(z);x.resolve(PS),e.markEndTask(),await Ha();let n=Gh.markStartTask(`microtask`,[`index`,`resolveLongAdThriveDependencies`,`2`]);return x.resolve(Zh),x.resolve(kI),n.markEndTask(),await Ha(),t},jxe=async(e,t,n)=>{Oxe(t,n);let r=await e.gam.gamEventPromise,i=await e.marmalade.marmaladeEventPromise;kxe(r,i)},Mxe=async e=>{let t=Gh.markStartTask(`microtask`,[`index`,`setupAdthrive`,`before-yield`,`1`]),n=AK();t.markEndTask();let r=await Axe(),i=Gh.markStartTask(`microtask`,[`index`,`setupAdthrive`,`before-yield`,`2`]);return window.adthrive=x.resolve(q9),jxe(r,e,n),i.markEndTask(),await Ha(),window.adthrive.init()},Nxe=async e=>{let t=e.marmalade,n=e.message||e;t&&Object.prototype.hasOwnProperty.call(t,`result`)&&x.register(`RecencyFrequencyMarmaladeResponse`,{useValue:t.result});let r=x.resolve(I3);return r.init(),window.adthrive=x.resolve(q9),await window.adthrive.init(),Promise.reject(n)},Pxe=async e=>{let t=AK(),n=window.adthrive.branch,r=U.readInternalLocalStorage(`adthrive_branch`),i=n===(r==null?void 0:r.branch);U.setInternalLocalStorage(`adthrive_branch`,{branch:n,enabled:i}),U.setInternalLocalStorage(`adthrive_session_fpv`,U.readInternalLocalStorage(`adthrive_session_fpv`)===null),x.register(`Build`,{useValue:rxe}),x.register(`AdThrive`,{useValue:e}),x.resolve(xo),x.resolve(Y9);let a=x.resolve(Lc);M.gamAccountId=a.account;let o=x.resolve(nd);return await o.run().then(()=>Mxe(t)).catch(e=>void Nxe(e))},Fxe=({gdpr:e,baseUrl:t})=>e===`true`?`${t}/gdpr`:t,Ixe=()=>{let e=window.adthrive.siteAds,t=window.adthriveCLS,n=t&&t.siteAds,r=window.adthrive.siteAds.videoPlayers&&window.adthrive.siteAds.videoPlayers.contentSpecificPlaylists,i=r?[...r]:[];return n&&DK(n)&&(e.adUnits=n.adUnits,e.video=n.video,e.videoPlayers=n.videoPlayers,e.breakpoints=n.breakpoints,e.videoPlayers&&(e.videoPlayers.contentSpecificPlaylists=i.filter(e=>!e.isDraft))),e},Lxe=e=>{let t=x.resolve(ja),n=t.setupOnceEventWithPromise,r=[n(`scroll`),n(`mousemove`),n(`keyup`)];Ei()||r.push(n(`touchstart`));let i=[n(`load`).then(()=>Sn(e))];return sxe()?r:i.concat(r)},Rxe=e=>{let t,n=N(e.siteAds.adOptions.delayLoading,!1);if(n){let n=e.siteAds.adOptions.delayLoadingTime,r=n?n*1e3:50,i=Lxe(r);t=Promise.race(i)}else t=Promise.resolve();return t},zxe=()=>{let e=Bn(),t={};if(e){var n;t.error=e.error,t.injectedSlots=e.injectedSlots,t.injectedVideoSlots=e.injectedVideoSlots,t.experiments=e.experiments,t.experimentsWeightedChoice=e.experimentsWeightedChoice,t.siteExperiments=e.siteExperiments,t.siteExperimentsWeightedChoice=e.siteExperimentsWeightedChoice,t.targetDensityLog=e.targetDensityLog,t.buildDate=e.buildDate,t.branch=e.branch,t.bucket=e.bucket,t.injectedFromPlugin=e.injectedFromPlugin,t.injectedFromSiteAds=e.injectedFromSiteAds,t.disabled=e.disabled,t.adUnits=(n=e.siteAds)==null?void 0:n.adUnits}return t},Bxe=()=>{window.location.search.includes(`padCLS`)||(window.adthriveCLS=void 0)},Vxe=()=>{if(!Txe())return;x.register(`PageviewKey`,{useValue:KK()}),window.adthrive.siteAds=Ixe();let e=window.adthrive;x.register(`CoreExperimentValues`,{useValue:e.core.coreExperiments});let t=Fxe(e),n=XG(),r=tK(e.bucket),i=n||r?`unsupported`:e.bucket,a=x.resolve(J9),o=a.result?[]:a.classList,s=x.resolve(ld),c=zxe();Bxe();let l={...e,bucket:i,baseUrl:t,invalidTraffic:n,loggerFilters:o};U.init(l),Vt.init(l),M.init(l),s.init(c),Z9.updateSiteAds(l),Z9.updateBodyClass();let u=AK();Rxe(l).then(()=>{let e=Gh.markStartTask(`microtask`,[`handleDelayLoading`]),t=AK()-u;Q9.delay=t;let n=Pxe(l);return e.markEndTask(),n}).then(()=>void 0).catch(e=>{typeof e==`string`?M.error(`index`,`load`,Error(e)):M.error(`index`,`load`,e)})};try{Dxe(window.adthrive)||Vxe()}catch(e){M.error(`index`,`pre-init`,e)}$9=window.adthrive}));return Hxe(),$9})();if(adtpm){let t=Date.now();adtpm.duration=t-adtpm.startTime;let n=[{timingData:adtpm,taskMetadata:{}},{abgroup:`taskmonitor-log`,pubab:`taskmonitor-log`,sess:`taskmonitor-log`,pvk:`taskmonitor-log`,hbho:[`taskmonitor-log`],vbho:[`taskmonitor-log`],spa:!1}],r=encodeURIComponent(window.adthrive.siteAds.siteId||``),i=encodeURIComponent(window.adthrive.siteAds.siteName||``),a=encodeURIComponent(window.adthrive.bucket||``),o=encodeURIComponent(window.adthrive.branch||``),s=encodeURIComponent(window.adthrive.deployment||``),c=encodeURIComponent(window.location.origin+window.location.pathname),l=encodeURIComponent(JSON.stringify(n)),u=[`siteId=`+r,`siteName=`+i,`bucket=`+a,`branch=`+o,`deployment=`+s,`message=TaskMonitor%3A%3A_logData`,`pageurl=`+c,`body=`+l].join(`&`),d=`https://logger.adthrive.com/event?`+u,f=new XMLHttpRequest;f.open(`get`,d,!0),f.send()};